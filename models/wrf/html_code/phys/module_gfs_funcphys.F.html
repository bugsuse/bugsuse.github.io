<HTML> <BODY BGCOLOR=#ddddee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2'></font>
<A NAME='MODULE_GFS_FUNCPHYS'><A href='../../html_code/phys/module_gfs_funcphys.F.html#MODULE_GFS_FUNCPHYS' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='3'>
<font color=#993300>module </font><font color=#cc0000>module_gfs_funcphys</font> <A href='../../call_to/MODULE_GFS_FUNCPHYS.html' TARGET='index'>14</A><a name='4'>
<font color=#447700>!$$$  Module Documentation Block<a name='5'></font>
<font color=#447700>!<a name='6'></font>
<font color=#447700>! Module:    funcphys        API for basic thermodynamic physics<a name='7'></font>
<font color=#447700>!   Author: Iredell          Org: W/NX23     Date: 1999-03-01<a name='8'></font>
<font color=#447700>!<a name='9'></font>
<font color=#447700>! Abstract: This module provides an Application Program Interface<a name='10'></font>
<font color=#447700>!   for computing basic thermodynamic physics functions, in particular<a name='11'></font>
<font color=#447700>!     (1) saturation vapor pressure as a function of temperature,<a name='12'></font>
<font color=#447700>!     (2) dewpoint temperature as a function of vapor pressure,<a name='13'></font>
<font color=#447700>!     (3) equivalent potential temperature as a function of temperature<a name='14'></font>
<font color=#447700>!         and scaled pressure to the kappa power,<a name='15'></font>
<font color=#447700>!     (4) temperature and specific humidity along a moist adiabat<a name='16'></font>
<font color=#447700>!         as functions of equivalent potential temperature and<a name='17'></font>
<font color=#447700>!         scaled pressure to the kappa power,<a name='18'></font>
<font color=#447700>!     (5) scaled pressure to the kappa power as a function of pressure, and<a name='19'></font>
<font color=#447700>!     (6) temperature at the lifting condensation level as a function<a name='20'></font>
<font color=#447700>!         of temperature and dewpoint depression.<a name='21'></font>
<font color=#447700>!   The entry points required to set up lookup tables start with a "g".<a name='22'></font>
<font color=#447700>!   All the other entry points are functions starting with an "f" or<a name='23'></font>
<font color=#447700>!   are subroutines starting with an "s".  These other functions and<a name='24'></font>
<font color=#447700>!   subroutines are elemental; that is, they return a scalar if they<a name='25'></font>
<font color=#447700>!   are passed only scalars, but they return an array if they are passed<a name='26'></font>
<font color=#447700>!   an array.  These other functions and subroutines can be inlined, too.<a name='27'></font>
<font color=#447700>!   <a name='28'></font>
<font color=#447700>! Program History Log:<a name='29'></font>
<font color=#447700>!   1999-03-01  Mark Iredell<a name='30'></font>
<font color=#447700>!   1999-10-15  Mark Iredell  SI unit for pressure (Pascals)<a name='31'></font>
<font color=#447700>!   2001-02-26  Mark Iredell  Ice phase changes of Hong and Moorthi<a name='32'></font>
<font color=#447700>!<a name='33'></font>
<font color=#447700>! Public Variables:<a name='34'></font>
<font color=#447700>!   krealfp         Integer parameter kind or length of reals (=kind_phys)<a name='35'></font>
<font color=#447700>!<a name='36'></font>
<font color=#447700>! Public Subprograms:<a name='37'></font>
<font color=#447700>!   gpvsl            Compute saturation vapor pressure over liquid table<a name='38'></font>
<font color=#447700>!<a name='39'></font>
<font color=#447700>!   fpvsl           Elementally compute saturation vapor pressure over liquid<a name='40'></font>
<font color=#447700>!     function result Real(krealfp) saturation vapor pressure in Pascals<a name='41'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='42'></font>
<font color=#447700>!<a name='43'></font>
<font color=#447700>!   fpvslq          Elementally compute saturation vapor pressure over liquid<a name='44'></font>
<font color=#447700>!     function result Real(krealfp) saturation vapor pressure in Pascals<a name='45'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='46'></font>
<font color=#447700>!<a name='47'></font>
<font color=#447700>!   fpvslx          Elementally compute saturation vapor pressure over liquid<a name='48'></font>
<font color=#447700>!     function result Real(krealfp) saturation vapor pressure in Pascals<a name='49'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='50'></font>
<font color=#447700>!<a name='51'></font>
<font color=#447700>!   gpvsi            Compute saturation vapor pressure over ice table<a name='52'></font>
<font color=#447700>!<a name='53'></font>
<font color=#447700>!   fpvsi           Elementally compute saturation vapor pressure over ice<a name='54'></font>
<font color=#447700>!     function result Real(krealfp) saturation vapor pressure in Pascals<a name='55'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='56'></font>
<font color=#447700>!<a name='57'></font>
<font color=#447700>!   fpvsiq          Elementally compute saturation vapor pressure over ice<a name='58'></font>
<font color=#447700>!     function result Real(krealfp) saturation vapor pressure in Pascals<a name='59'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='60'></font>
<font color=#447700>!<a name='61'></font>
<font color=#447700>!   fpvsix          Elementally compute saturation vapor pressure over ice<a name='62'></font>
<font color=#447700>!     function result Real(krealfp) saturation vapor pressure in Pascals<a name='63'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='64'></font>
<font color=#447700>!<a name='65'></font>
<font color=#447700>!   gpvs            Compute saturation vapor pressure table<a name='66'></font>
<font color=#447700>!<a name='67'></font>
<font color=#447700>!   fpvs            Elementally compute saturation vapor pressure<a name='68'></font>
<font color=#447700>!     function result Real(krealfp) saturation vapor pressure in Pascals<a name='69'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='70'></font>
<font color=#447700>!<a name='71'></font>
<font color=#447700>!   fpvsq           Elementally compute saturation vapor pressure<a name='72'></font>
<font color=#447700>!     function result Real(krealfp) saturation vapor pressure in Pascals<a name='73'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='74'></font>
<font color=#447700>!<a name='75'></font>
<font color=#447700>!   fpvsx           Elementally compute saturation vapor pressure<a name='76'></font>
<font color=#447700>!     function result Real(krealfp) saturation vapor pressure in Pascals<a name='77'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='78'></font>
<font color=#447700>!<a name='79'></font>
<font color=#447700>!   gtdpl           Compute dewpoint temperature over liquid table<a name='80'></font>
<font color=#447700>!<a name='81'></font>
<font color=#447700>!   ftdpl           Elementally compute dewpoint temperature over liquid<a name='82'></font>
<font color=#447700>!     function result Real(krealfp) dewpoint temperature in Kelvin<a name='83'></font>
<font color=#447700>!     pv              Real(krealfp) vapor pressure in Pascals<a name='84'></font>
<font color=#447700>!<a name='85'></font>
<font color=#447700>!   ftdplq          Elementally compute dewpoint temperature over liquid<a name='86'></font>
<font color=#447700>!     function result Real(krealfp) dewpoint temperature in Kelvin<a name='87'></font>
<font color=#447700>!     pv              Real(krealfp) vapor pressure in Pascals<a name='88'></font>
<font color=#447700>!<a name='89'></font>
<font color=#447700>!   ftdplx          Elementally compute dewpoint temperature over liquid<a name='90'></font>
<font color=#447700>!     function result Real(krealfp) dewpoint temperature in Kelvin<a name='91'></font>
<font color=#447700>!     pv              Real(krealfp) vapor pressure in Pascals<a name='92'></font>
<font color=#447700>!<a name='93'></font>
<font color=#447700>!   ftdplxg         Elementally compute dewpoint temperature over liquid<a name='94'></font>
<font color=#447700>!     function result Real(krealfp) dewpoint temperature in Kelvin<a name='95'></font>
<font color=#447700>!     t               Real(krealfp) guess dewpoint temperature in Kelvin<a name='96'></font>
<font color=#447700>!     pv              Real(krealfp) vapor pressure in Pascals<a name='97'></font>
<font color=#447700>!<a name='98'></font>
<font color=#447700>!   gtdpi           Compute dewpoint temperature table over ice<a name='99'></font>
<font color=#447700>!<a name='100'></font>
<font color=#447700>!   ftdpi           Elementally compute dewpoint temperature over ice<a name='101'></font>
<font color=#447700>!     function result Real(krealfp) dewpoint temperature in Kelvin<a name='102'></font>
<font color=#447700>!     pv              Real(krealfp) vapor pressure in Pascals<a name='103'></font>
<font color=#447700>!<a name='104'></font>
<font color=#447700>!   ftdpiq          Elementally compute dewpoint temperature over ice<a name='105'></font>
<font color=#447700>!     function result Real(krealfp) dewpoint temperature in Kelvin<a name='106'></font>
<font color=#447700>!     pv              Real(krealfp) vapor pressure in Pascals<a name='107'></font>
<font color=#447700>!<a name='108'></font>
<font color=#447700>!   ftdpix          Elementally compute dewpoint temperature over ice<a name='109'></font>
<font color=#447700>!     function result Real(krealfp) dewpoint temperature in Kelvin<a name='110'></font>
<font color=#447700>!     pv              Real(krealfp) vapor pressure in Pascals<a name='111'></font>
<font color=#447700>!<a name='112'></font>
<font color=#447700>!   ftdpixg         Elementally compute dewpoint temperature over ice<a name='113'></font>
<font color=#447700>!     function result Real(krealfp) dewpoint temperature in Kelvin<a name='114'></font>
<font color=#447700>!     t               Real(krealfp) guess dewpoint temperature in Kelvin<a name='115'></font>
<font color=#447700>!     pv              Real(krealfp) vapor pressure in Pascals<a name='116'></font>
<font color=#447700>!<a name='117'></font>
<font color=#447700>!   gtdp            Compute dewpoint temperature table<a name='118'></font>
<font color=#447700>!<a name='119'></font>
<font color=#447700>!   ftdp            Elementally compute dewpoint temperature<a name='120'></font>
<font color=#447700>!     function result Real(krealfp) dewpoint temperature in Kelvin<a name='121'></font>
<font color=#447700>!     pv              Real(krealfp) vapor pressure in Pascals<a name='122'></font>
<font color=#447700>!<a name='123'></font>
<font color=#447700>!   ftdpq           Elementally compute dewpoint temperature<a name='124'></font>
<font color=#447700>!     function result Real(krealfp) dewpoint temperature in Kelvin<a name='125'></font>
<font color=#447700>!     pv              Real(krealfp) vapor pressure in Pascals<a name='126'></font>
<font color=#447700>!<a name='127'></font>
<font color=#447700>!   ftdpx           Elementally compute dewpoint temperature<a name='128'></font>
<font color=#447700>!     function result Real(krealfp) dewpoint temperature in Kelvin<a name='129'></font>
<font color=#447700>!     pv              Real(krealfp) vapor pressure in Pascals<a name='130'></font>
<font color=#447700>!<a name='131'></font>
<font color=#447700>!   ftdpxg          Elementally compute dewpoint temperature<a name='132'></font>
<font color=#447700>!     function result Real(krealfp) dewpoint temperature in Kelvin<a name='133'></font>
<font color=#447700>!     t               Real(krealfp) guess dewpoint temperature in Kelvin<a name='134'></font>
<font color=#447700>!     pv              Real(krealfp) vapor pressure in Pascals<a name='135'></font>
<font color=#447700>!<a name='136'></font>
<font color=#447700>!   gthe            Compute equivalent potential temperature table<a name='137'></font>
<font color=#447700>!<a name='138'></font>
<font color=#447700>!   fthe            Elementally compute equivalent potential temperature<a name='139'></font>
<font color=#447700>!     function result Real(krealfp) equivalent potential temperature in Kelvin<a name='140'></font>
<font color=#447700>!     t               Real(krealfp) LCL temperature in Kelvin<a name='141'></font>
<font color=#447700>!     pk              Real(krealfp) LCL pressure over 1e5 Pa to the kappa power<a name='142'></font>
<font color=#447700>!<a name='143'></font>
<font color=#447700>!   ftheq           Elementally compute equivalent potential temperature<a name='144'></font>
<font color=#447700>!     function result Real(krealfp) equivalent potential temperature in Kelvin<a name='145'></font>
<font color=#447700>!     t               Real(krealfp) LCL temperature in Kelvin<a name='146'></font>
<font color=#447700>!     pk              Real(krealfp) LCL pressure over 1e5 Pa to the kappa power<a name='147'></font>
<font color=#447700>!<a name='148'></font>
<font color=#447700>!   fthex           Elementally compute equivalent potential temperature<a name='149'></font>
<font color=#447700>!     function result Real(krealfp) equivalent potential temperature in Kelvin<a name='150'></font>
<font color=#447700>!     t               Real(krealfp) LCL temperature in Kelvin<a name='151'></font>
<font color=#447700>!     pk              Real(krealfp) LCL pressure over 1e5 Pa to the kappa power<a name='152'></font>
<font color=#447700>!<a name='153'></font>
<font color=#447700>!   gtma            Compute moist adiabat tables<a name='154'></font>
<font color=#447700>!<a name='155'></font>
<font color=#447700>!   stma            Elementally compute moist adiabat temperature and moisture<a name='156'></font>
<font color=#447700>!     the             Real(krealfp) equivalent potential temperature in Kelvin<a name='157'></font>
<font color=#447700>!     pk              Real(krealfp) pressure over 1e5 Pa to the kappa power<a name='158'></font>
<font color=#447700>!     tma             Real(krealfp) parcel temperature in Kelvin<a name='159'></font>
<font color=#447700>!     qma             Real(krealfp) parcel specific humidity in kg/kg<a name='160'></font>
<font color=#447700>!<a name='161'></font>
<font color=#447700>!   stmaq           Elementally compute moist adiabat temperature and moisture<a name='162'></font>
<font color=#447700>!     the             Real(krealfp) equivalent potential temperature in Kelvin<a name='163'></font>
<font color=#447700>!     pk              Real(krealfp) pressure over 1e5 Pa to the kappa power<a name='164'></font>
<font color=#447700>!     tma             Real(krealfp) parcel temperature in Kelvin<a name='165'></font>
<font color=#447700>!     qma             Real(krealfp) parcel specific humidity in kg/kg<a name='166'></font>
<font color=#447700>!<a name='167'></font>
<font color=#447700>!   stmax           Elementally compute moist adiabat temperature and moisture<a name='168'></font>
<font color=#447700>!     the             Real(krealfp) equivalent potential temperature in Kelvin<a name='169'></font>
<font color=#447700>!     pk              Real(krealfp) pressure over 1e5 Pa to the kappa power<a name='170'></font>
<font color=#447700>!     tma             Real(krealfp) parcel temperature in Kelvin<a name='171'></font>
<font color=#447700>!     qma             Real(krealfp) parcel specific humidity in kg/kg<a name='172'></font>
<font color=#447700>!<a name='173'></font>
<font color=#447700>!   stmaxg          Elementally compute moist adiabat temperature and moisture<a name='174'></font>
<font color=#447700>!     tg              Real(krealfp) guess parcel temperature in Kelvin<a name='175'></font>
<font color=#447700>!     the             Real(krealfp) equivalent potential temperature in Kelvin<a name='176'></font>
<font color=#447700>!     pk              Real(krealfp) pressure over 1e5 Pa to the kappa power<a name='177'></font>
<font color=#447700>!     tma             Real(krealfp) parcel temperature in Kelvin<a name='178'></font>
<font color=#447700>!     qma             Real(krealfp) parcel specific humidity in kg/kg<a name='179'></font>
<font color=#447700>!<a name='180'></font>
<font color=#447700>!   gpkap           Compute pressure to the kappa table<a name='181'></font>
<font color=#447700>!<a name='182'></font>
<font color=#447700>!   fpkap           Elementally raise pressure to the kappa power.<a name='183'></font>
<font color=#447700>!     function result Real(krealfp) p over 1e5 Pa to the kappa power<a name='184'></font>
<font color=#447700>!     p               Real(krealfp) pressure in Pascals<a name='185'></font>
<font color=#447700>!<a name='186'></font>
<font color=#447700>!   fpkapq          Elementally raise pressure to the kappa power.<a name='187'></font>
<font color=#447700>!     function result Real(krealfp) p over 1e5 Pa to the kappa power<a name='188'></font>
<font color=#447700>!     p               Real(krealfp) pressure in Pascals<a name='189'></font>
<font color=#447700>!<a name='190'></font>
<font color=#447700>!   fpkapo          Elementally raise pressure to the kappa power.<a name='191'></font>
<font color=#447700>!     function result Real(krealfp) p over 1e5 Pa to the kappa power<a name='192'></font>
<font color=#447700>!     p               Real(krealfp) surface pressure in Pascals<a name='193'></font>
<font color=#447700>!<a name='194'></font>
<font color=#447700>!   fpkapx          Elementally raise pressure to the kappa power.<a name='195'></font>
<font color=#447700>!     function result Real(krealfp) p over 1e5 Pa to the kappa power<a name='196'></font>
<font color=#447700>!     p               Real(krealfp) pressure in Pascals<a name='197'></font>
<font color=#447700>!<a name='198'></font>
<font color=#447700>!   grkap           Compute pressure to the 1/kappa table<a name='199'></font>
<font color=#447700>!<a name='200'></font>
<font color=#447700>!   frkap           Elementally raise pressure to the 1/kappa power.<a name='201'></font>
<font color=#447700>!     function result Real(krealfp) pressure in Pascals<a name='202'></font>
<font color=#447700>!     pkap            Real(krealfp) p over 1e5 Pa to the 1/kappa power<a name='203'></font>
<font color=#447700>!<a name='204'></font>
<font color=#447700>!   frkapq          Elementally raise pressure to the kappa power.<a name='205'></font>
<font color=#447700>!     function result Real(krealfp) pressure in Pascals<a name='206'></font>
<font color=#447700>!     pkap            Real(krealfp) p over 1e5 Pa to the kappa power<a name='207'></font>
<font color=#447700>!<a name='208'></font>
<font color=#447700>!   frkapx          Elementally raise pressure to the kappa power.<a name='209'></font>
<font color=#447700>!     function result Real(krealfp) pressure in Pascals<a name='210'></font>
<font color=#447700>!     pkap            Real(krealfp) p over 1e5 Pa to the kappa power<a name='211'></font>
<font color=#447700>!<a name='212'></font>
<font color=#447700>!   gtlcl           Compute LCL temperature table<a name='213'></font>
<font color=#447700>!<a name='214'></font>
<font color=#447700>!   ftlcl           Elementally compute LCL temperature.<a name='215'></font>
<font color=#447700>!     function result Real(krealfp) temperature at the LCL in Kelvin<a name='216'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='217'></font>
<font color=#447700>!     tdpd            Real(krealfp) dewpoint depression in Kelvin<a name='218'></font>
<font color=#447700>!<a name='219'></font>
<font color=#447700>!   ftlclq          Elementally compute LCL temperature.<a name='220'></font>
<font color=#447700>!     function result Real(krealfp) temperature at the LCL in Kelvin<a name='221'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='222'></font>
<font color=#447700>!     tdpd            Real(krealfp) dewpoint depression in Kelvin<a name='223'></font>
<font color=#447700>!<a name='224'></font>
<font color=#447700>!   ftlclo          Elementally compute LCL temperature.<a name='225'></font>
<font color=#447700>!     function result Real(krealfp) temperature at the LCL in Kelvin<a name='226'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='227'></font>
<font color=#447700>!     tdpd            Real(krealfp) dewpoint depression in Kelvin<a name='228'></font>
<font color=#447700>!<a name='229'></font>
<font color=#447700>!   ftlclx          Elementally compute LCL temperature.<a name='230'></font>
<font color=#447700>!     function result Real(krealfp) temperature at the LCL in Kelvin<a name='231'></font>
<font color=#447700>!     t               Real(krealfp) temperature in Kelvin<a name='232'></font>
<font color=#447700>!     tdpd            Real(krealfp) dewpoint depression in Kelvin<a name='233'></font>
<font color=#447700>!<a name='234'></font>
<font color=#447700>!   gfuncphys       Compute all physics function tables<a name='235'></font>
<font color=#447700>!<a name='236'></font>
<font color=#447700>! Attributes:<a name='237'></font>
<font color=#447700>!   Language: Fortran 90<a name='238'></font>
<font color=#447700>!<a name='239'></font>
<font color=#447700>!$$$<a name='240'></font>
  use <A href='../../html_code/phys/module_gfs_machine.F.html#MODULE_GFS_MACHINE'>module_gfs_machine</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#module_gfs_funcphys.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_GFS_MACHINE_26">,only:kind_phys<a name='241'>
  use <A href='../../html_code/phys/module_gfs_physcons.F.html#MODULE_GFS_PHYSCONS'>module_gfs_physcons</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#module_gfs_funcphys.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_GFS_PHYSCONS_18"><a name='242'>
  implicit none<a name='243'>
  private<a name='244'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='245'></font>
<font color=#447700>! Public Variables<a name='246'></font>
<font color=#447700>! integer,public,parameter:: krealfp=selected_real_kind(15,45)<a name='247'></font>
  integer,public,parameter:: krealfp=kind_phys<a name='248'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='249'></font>
<font color=#447700>! Private Variables<a name='250'></font>
  real(krealfp),parameter:: psatb=con_psat*1.e-5<a name='251'>
  integer,parameter:: nxpvsl=7501<a name='252'>
  real(krealfp) c1xpvsl,c2xpvsl,tbpvsl(nxpvsl)<a name='253'>
  integer,parameter:: nxpvsi=7501<a name='254'>
  real(krealfp) c1xpvsi,c2xpvsi,tbpvsi(nxpvsi)<a name='255'>
  integer,parameter:: nxpvs=7501<a name='256'>
  real(krealfp) c1xpvs,c2xpvs,tbpvs(nxpvs)<a name='257'>
  integer,parameter:: nxtdpl=5001<a name='258'>
  real(krealfp) c1xtdpl,c2xtdpl,tbtdpl(nxtdpl)<a name='259'>
  integer,parameter:: nxtdpi=5001<a name='260'>
  real(krealfp) c1xtdpi,c2xtdpi,tbtdpi(nxtdpi)<a name='261'>
  integer,parameter:: nxtdp=5001<a name='262'>
  real(krealfp) c1xtdp,c2xtdp,tbtdp(nxtdp)<a name='263'>
  integer,parameter:: nxthe=241,nythe=151<a name='264'>
  real(krealfp) c1xthe,c2xthe,c1ythe,c2ythe,tbthe(nxthe,nythe)<a name='265'>
  integer,parameter:: nxma=151,nyma=121<a name='266'>
  real(krealfp) c1xma,c2xma,c1yma,c2yma,tbtma(nxma,nyma),tbqma(nxma,nyma)<a name='267'>
<font color=#447700>! integer,parameter:: nxpkap=5501<a name='268'></font>
  integer,parameter:: nxpkap=11001<a name='269'>
  real(krealfp) c1xpkap,c2xpkap,tbpkap(nxpkap)<a name='270'>
  integer,parameter:: nxrkap=5501<a name='271'>
  real(krealfp) c1xrkap,c2xrkap,tbrkap(nxrkap)<a name='272'>
  integer,parameter:: nxtlcl=151,nytlcl=61<a name='273'>
  real(krealfp) c1xtlcl,c2xtlcl,c1ytlcl,c2ytlcl,tbtlcl(nxtlcl,nytlcl)<a name='274'>
  logical, private :: initialized=.false.<a name='275'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='276'></font>
<font color=#447700>! Public Subprograms<a name='277'></font>
  public gpvsl,fpvsl,fpvslq,fpvslx<a name='278'>
  public gpvsi,fpvsi,fpvsiq,fpvsix<a name='279'>
  public gpvs,fpvs,fpvsq,fpvsx<a name='280'>
  public gtdpl,ftdpl,ftdplq,ftdplx,ftdplxg<a name='281'>
  public gtdpi,ftdpi,ftdpiq,ftdpix,ftdpixg<a name='282'>
  public gtdp,ftdp,ftdpq,ftdpx,ftdpxg<a name='283'>
  public gthe,fthe,ftheq,fthex<a name='284'>
  public gtma,stma,stmaq,stmax,stmaxg<a name='285'>
  public gpkap,fpkap,fpkapq,fpkapo,fpkapx<a name='286'>
  public grkap,frkap,frkapq,frkapx<a name='287'>
  public gtlcl,ftlcl,ftlclq,ftlclo,ftlclx<a name='288'>
  public gfuncphys<a name='289'>
contains<a name='290'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='291'></font>
<A NAME='GPVSL'><A href='../../html_code/phys/module_gfs_funcphys.F.html#GPVSL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='292'>
  <font color=#993300>subroutine </font><font color=#cc0000>gpvsl</font> <A href='../../call_to/GPVSL.html' TARGET='index'>1</A>,<A href='../../call_from/GPVSL.html' TARGET='index'>1</A><a name='293'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='294'></font>
<font color=#447700>!<a name='295'></font>
<font color=#447700>! Subprogram: gpvsl        Compute saturation vapor pressure table over liquid<a name='296'></font>
<font color=#447700>!   Author: N Phillips            W/NMC2X2   Date: 30 dec 82<a name='297'></font>
<font color=#447700>!<a name='298'></font>
<font color=#447700>! Abstract: Computes saturation vapor pressure table as a function of<a name='299'></font>
<font color=#447700>!   temperature for the table lookup function fpvsl.<a name='300'></font>
<font color=#447700>!   Exact saturation vapor pressures are calculated in subprogram fpvslx.<a name='301'></font>
<font color=#447700>!   The current implementation computes a table with a length<a name='302'></font>
<font color=#447700>!   of 7501 for temperatures ranging from 180. to 330. Kelvin.<a name='303'></font>
<font color=#447700>!<a name='304'></font>
<font color=#447700>! Program History Log:<a name='305'></font>
<font color=#447700>!   91-05-07  Iredell<a name='306'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='307'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='308'></font>
<font color=#447700>!<a name='309'></font>
<font color=#447700>! Usage:  call gpvsl<a name='310'></font>
<font color=#447700>!<a name='311'></font>
<font color=#447700>! Subprograms called:<a name='312'></font>
<font color=#447700>!   (fpvslx)   inlinable function to compute saturation vapor pressure<a name='313'></font>
<font color=#447700>!<a name='314'></font>
<font color=#447700>! Attributes:<a name='315'></font>
<font color=#447700>!   Language: Fortran 90.<a name='316'></font>
<font color=#447700>!<a name='317'></font>
<font color=#447700>!$$$<a name='318'></font>
    implicit none<a name='319'>
    integer jx<a name='320'>
    real(krealfp) xmin,xmax,xinc,x,t<a name='321'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='322'></font>
    xmin=180.0_krealfp<a name='323'>
    xmax=330.0_krealfp<a name='324'>
    xinc=(xmax-xmin)/(nxpvsl-1)<a name='325'>
<font color=#447700>!   c1xpvsl=1.-xmin/xinc<a name='326'></font>
    c2xpvsl=1./xinc<a name='327'>
    c1xpvsl=1.-xmin*c2xpvsl<a name='328'>
    do jx=1,nxpvsl<a name='329'>
      x=xmin+(jx-1)*xinc<a name='330'>
      t=x<a name='331'>
      tbpvsl(jx)=<A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSLX'>fpvslx</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GPVSL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FPVSLX_1">(t)<a name='332'>
    enddo<a name='333'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='334'></font>
  end subroutine<a name='335'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='336'></font>
<font color=#447700>! elemental function fpvsl(t)<a name='337'></font>
<A NAME='FPVSL'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSL' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='338'>
  <font color=#993300>function </font><font color=#cc0000>fpvsl</font>(t),<A href='../../call_from/FPVSL.html' TARGET='index'>1</A><a name='339'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='340'></font>
<font color=#447700>!<a name='341'></font>
<font color=#447700>! Subprogram: fpvsl        Compute saturation vapor pressure over liquid<a name='342'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='343'></font>
<font color=#447700>!<a name='344'></font>
<font color=#447700>! Abstract: Compute saturation vapor pressure from the temperature.<a name='345'></font>
<font color=#447700>!   A linear interpolation is done between values in a lookup table<a name='346'></font>
<font color=#447700>!   computed in gpvsl. See documentation for fpvslx for details.<a name='347'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='348'></font>
<font color=#447700>!   The interpolation accuracy is almost 6 decimal places.<a name='349'></font>
<font color=#447700>!   On the Cray, fpvsl is about 4 times faster than exact calculation.<a name='350'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='351'></font>
<font color=#447700>!<a name='352'></font>
<font color=#447700>! Program History Log:<a name='353'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='354'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='355'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='356'></font>
<font color=#447700>!<a name='357'></font>
<font color=#447700>! Usage:   pvsl=fpvsl(t)<a name='358'></font>
<font color=#447700>!<a name='359'></font>
<font color=#447700>!   Input argument list:<a name='360'></font>
<font color=#447700>!     t          Real(krealfp) temperature in Kelvin<a name='361'></font>
<font color=#447700>!<a name='362'></font>
<font color=#447700>!   Output argument list:<a name='363'></font>
<font color=#447700>!     fpvsl      Real(krealfp) saturation vapor pressure in Pascals<a name='364'></font>
<font color=#447700>!<a name='365'></font>
<font color=#447700>! Attributes:<a name='366'></font>
<font color=#447700>!   Language: Fortran 90.<a name='367'></font>
<font color=#447700>!<a name='368'></font>
<font color=#447700>!$$$<a name='369'></font>
    implicit none<a name='370'>
    real(krealfp) fpvsl<a name='371'>
    real(krealfp),intent(in):: t<a name='372'>
    integer jx<a name='373'>
    real(krealfp) xj<a name='374'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='375'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_4">()<a name='376'>
    xj=min(max(c1xpvsl+c2xpvsl*t,1._krealfp),real(nxpvsl,krealfp))<a name='377'>
    jx=min(xj,nxpvsl-1._krealfp)<a name='378'>
    fpvsl=tbpvsl(jx)+(xj-jx)*(tbpvsl(jx+1)-tbpvsl(jx))<a name='379'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='380'></font>
  end function<a name='381'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='382'></font>
<font color=#447700>! elemental function fpvslq(t)<a name='383'></font>
<A NAME='FPVSLQ'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSLQ' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='384'>
  <font color=#993300>function </font><font color=#cc0000>fpvslq</font>(t),<A href='../../call_from/FPVSLQ.html' TARGET='index'>1</A><a name='385'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='386'></font>
<font color=#447700>!<a name='387'></font>
<font color=#447700>! Subprogram: fpvslq       Compute saturation vapor pressure over liquid<a name='388'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='389'></font>
<font color=#447700>!<a name='390'></font>
<font color=#447700>! Abstract: Compute saturation vapor pressure from the temperature.<a name='391'></font>
<font color=#447700>!   A quadratic interpolation is done between values in a lookup table<a name='392'></font>
<font color=#447700>!   computed in gpvsl. See documentation for fpvslx for details.<a name='393'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='394'></font>
<font color=#447700>!   The interpolation accuracy is almost 9 decimal places.<a name='395'></font>
<font color=#447700>!   On the Cray, fpvslq is about 3 times faster than exact calculation.<a name='396'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='397'></font>
<font color=#447700>!<a name='398'></font>
<font color=#447700>! Program History Log:<a name='399'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='400'></font>
<font color=#447700>!   94-12-30  Iredell             quadratic interpolation<a name='401'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='402'></font>
<font color=#447700>!<a name='403'></font>
<font color=#447700>! Usage:   pvsl=fpvslq(t)<a name='404'></font>
<font color=#447700>!<a name='405'></font>
<font color=#447700>!   Input argument list:<a name='406'></font>
<font color=#447700>!     t          Real(krealfp) temperature in Kelvin<a name='407'></font>
<font color=#447700>!<a name='408'></font>
<font color=#447700>!   Output argument list:<a name='409'></font>
<font color=#447700>!     fpvslq     Real(krealfp) saturation vapor pressure in Pascals<a name='410'></font>
<font color=#447700>!<a name='411'></font>
<font color=#447700>! Attributes:<a name='412'></font>
<font color=#447700>!   Language: Fortran 90.<a name='413'></font>
<font color=#447700>!<a name='414'></font>
<font color=#447700>!$$$<a name='415'></font>
    implicit none<a name='416'>
    real(krealfp) fpvslq<a name='417'>
    real(krealfp),intent(in):: t<a name='418'>
    integer jx<a name='419'>
    real(krealfp) xj,dxj,fj1,fj2,fj3<a name='420'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='421'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSLQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_5">()<a name='422'>
    xj=min(max(c1xpvsl+c2xpvsl*t,1._krealfp),real(nxpvsl,krealfp))<a name='423'>
    jx=min(max(nint(xj),2),nxpvsl-1)<a name='424'>
    dxj=xj-jx<a name='425'>
    fj1=tbpvsl(jx-1)<a name='426'>
    fj2=tbpvsl(jx)<a name='427'>
    fj3=tbpvsl(jx+1)<a name='428'>
    fpvslq=(((fj3+fj1)/2-fj2)*dxj+(fj3-fj1)/2)*dxj+fj2<a name='429'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='430'></font>
  end function<a name='431'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='432'></font>
<font color=#447700>! elemental function fpvslx(t)<a name='433'></font>
<A NAME='FPVSLX'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSLX' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='434'>
  <font color=#993300>function </font><font color=#cc0000>fpvslx</font>(t) <A href='../../call_to/FPVSLX.html' TARGET='index'>1</A>,<A href='../../call_from/FPVSLX.html' TARGET='index'>1</A><a name='435'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='436'></font>
<font color=#447700>!<a name='437'></font>
<font color=#447700>! Subprogram: fpvslx       Compute saturation vapor pressure over liquid<a name='438'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='439'></font>
<font color=#447700>!<a name='440'></font>
<font color=#447700>! Abstract: Exactly compute saturation vapor pressure from temperature.<a name='441'></font>
<font color=#447700>!   The water model assumes a perfect gas, constant specific heats<a name='442'></font>
<font color=#447700>!   for gas and liquid, and neglects the volume of the liquid.<a name='443'></font>
<font color=#447700>!   The model does account for the variation of the latent heat<a name='444'></font>
<font color=#447700>!   of condensation with temperature.  The ice option is not included.<a name='445'></font>
<font color=#447700>!   The Clausius-Clapeyron equation is integrated from the triple point<a name='446'></font>
<font color=#447700>!   to get the formula<a name='447'></font>
<font color=#447700>!       pvsl=con_psat*(tr**xa)*exp(xb*(1.-tr))<a name='448'></font>
<font color=#447700>!   where tr is ttp/t and other values are physical constants.<a name='449'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='450'></font>
<font color=#447700>!<a name='451'></font>
<font color=#447700>! Program History Log:<a name='452'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='453'></font>
<font color=#447700>!   94-12-30  Iredell             exact computation<a name='454'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='455'></font>
<font color=#447700>!<a name='456'></font>
<font color=#447700>! Usage:   pvsl=fpvslx(t)<a name='457'></font>
<font color=#447700>!<a name='458'></font>
<font color=#447700>!   Input argument list:<a name='459'></font>
<font color=#447700>!     t          Real(krealfp) temperature in Kelvin<a name='460'></font>
<font color=#447700>!<a name='461'></font>
<font color=#447700>!   Output argument list:<a name='462'></font>
<font color=#447700>!     fpvslx     Real(krealfp) saturation vapor pressure in Pascals<a name='463'></font>
<font color=#447700>!<a name='464'></font>
<font color=#447700>! Attributes:<a name='465'></font>
<font color=#447700>!   Language: Fortran 90.<a name='466'></font>
<font color=#447700>!<a name='467'></font>
<font color=#447700>!$$$<a name='468'></font>
    implicit none<a name='469'>
    real(krealfp) fpvslx<a name='470'>
    real(krealfp),intent(in):: t<a name='471'>
    real(krealfp),parameter:: dldt=con_cvap-con_cliq<a name='472'>
    real(krealfp),parameter:: heat=con_hvap<a name='473'>
    real(krealfp),parameter:: xpona=-dldt/con_rv<a name='474'>
    real(krealfp),parameter:: xponb=-dldt/con_rv+heat/(con_rv*con_ttp)<a name='475'>
    real(krealfp) tr<a name='476'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='477'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSLX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_6">()<a name='478'>
    tr=con_ttp/t<a name='479'>
    fpvslx=con_psat*(tr**xpona)*exp(xponb*(1.-tr))<a name='480'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='481'></font>
  end function<a name='482'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='483'></font>
<A NAME='GPVSI'><A href='../../html_code/phys/module_gfs_funcphys.F.html#GPVSI' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='484'>
  <font color=#993300>subroutine </font><font color=#cc0000>gpvsi</font> <A href='../../call_to/GPVSI.html' TARGET='index'>1</A>,<A href='../../call_from/GPVSI.html' TARGET='index'>2</A><a name='485'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='486'></font>
<font color=#447700>!<a name='487'></font>
<font color=#447700>! Subprogram: gpvsi        Compute saturation vapor pressure table over ice<a name='488'></font>
<font color=#447700>!   Author: N Phillips            W/NMC2X2   Date: 30 dec 82<a name='489'></font>
<font color=#447700>!<a name='490'></font>
<font color=#447700>! Abstract: Computes saturation vapor pressure table as a function of<a name='491'></font>
<font color=#447700>!   temperature for the table lookup function fpvsi.<a name='492'></font>
<font color=#447700>!   Exact saturation vapor pressures are calculated in subprogram fpvsix.<a name='493'></font>
<font color=#447700>!   The current implementation computes a table with a length<a name='494'></font>
<font color=#447700>!   of 7501 for temperatures ranging from 180. to 330. Kelvin.<a name='495'></font>
<font color=#447700>!<a name='496'></font>
<font color=#447700>! Program History Log:<a name='497'></font>
<font color=#447700>!   91-05-07  Iredell<a name='498'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='499'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='500'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='501'></font>
<font color=#447700>!<a name='502'></font>
<font color=#447700>! Usage:  call gpvsi<a name='503'></font>
<font color=#447700>!<a name='504'></font>
<font color=#447700>! Subprograms called:<a name='505'></font>
<font color=#447700>!   (fpvsix)   inlinable function to compute saturation vapor pressure<a name='506'></font>
<font color=#447700>!<a name='507'></font>
<font color=#447700>! Attributes:<a name='508'></font>
<font color=#447700>!   Language: Fortran 90.<a name='509'></font>
<font color=#447700>!<a name='510'></font>
<font color=#447700>!$$$<a name='511'></font>
    implicit none<a name='512'>
    integer jx<a name='513'>
    real(krealfp) xmin,xmax,xinc,x,t<a name='514'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='515'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GPVSI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_7">()<a name='516'>
    xmin=180.0_krealfp<a name='517'>
    xmax=330.0_krealfp<a name='518'>
    xinc=(xmax-xmin)/(nxpvsi-1)<a name='519'>
<font color=#447700>!   c1xpvsi=1.-xmin/xinc<a name='520'></font>
    c2xpvsi=1./xinc<a name='521'>
    c1xpvsi=1.-xmin*c2xpvsi<a name='522'>
    do jx=1,nxpvsi<a name='523'>
      x=xmin+(jx-1)*xinc<a name='524'>
      t=x<a name='525'>
      tbpvsi(jx)=<A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSIX'>fpvsix</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GPVSI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FPVSIX_1">(t)<a name='526'>
    enddo<a name='527'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='528'></font>
  end subroutine<a name='529'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='530'></font>
<font color=#447700>! elemental function fpvsi(t)<a name='531'></font>
<A NAME='FPVSI'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSI' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='532'>
  <font color=#993300>function </font><font color=#cc0000>fpvsi</font>(t),<A href='../../call_from/FPVSI.html' TARGET='index'>1</A><a name='533'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='534'></font>
<font color=#447700>!<a name='535'></font>
<font color=#447700>! Subprogram: fpvsi        Compute saturation vapor pressure over ice<a name='536'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='537'></font>
<font color=#447700>!<a name='538'></font>
<font color=#447700>! Abstract: Compute saturation vapor pressure from the temperature.<a name='539'></font>
<font color=#447700>!   A linear interpolation is done between values in a lookup table<a name='540'></font>
<font color=#447700>!   computed in gpvsi. See documentation for fpvsix for details.<a name='541'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='542'></font>
<font color=#447700>!   The interpolation accuracy is almost 6 decimal places.<a name='543'></font>
<font color=#447700>!   On the Cray, fpvsi is about 4 times faster than exact calculation.<a name='544'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='545'></font>
<font color=#447700>!<a name='546'></font>
<font color=#447700>! Program History Log:<a name='547'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='548'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='549'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='550'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='551'></font>
<font color=#447700>!<a name='552'></font>
<font color=#447700>! Usage:   pvsi=fpvsi(t)<a name='553'></font>
<font color=#447700>!<a name='554'></font>
<font color=#447700>!   Input argument list:<a name='555'></font>
<font color=#447700>!     t          Real(krealfp) temperature in Kelvin<a name='556'></font>
<font color=#447700>!<a name='557'></font>
<font color=#447700>!   Output argument list:<a name='558'></font>
<font color=#447700>!     fpvsi      Real(krealfp) saturation vapor pressure in Pascals<a name='559'></font>
<font color=#447700>!<a name='560'></font>
<font color=#447700>! Attributes:<a name='561'></font>
<font color=#447700>!   Language: Fortran 90.<a name='562'></font>
<font color=#447700>!<a name='563'></font>
<font color=#447700>!$$$<a name='564'></font>
    implicit none<a name='565'>
    real(krealfp) fpvsi<a name='566'>
    real(krealfp),intent(in):: t<a name='567'>
    integer jx<a name='568'>
    real(krealfp) xj<a name='569'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='570'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_8">()<a name='571'>
    xj=min(max(c1xpvsi+c2xpvsi*t,1._krealfp),real(nxpvsi,krealfp))<a name='572'>
    jx=min(xj,nxpvsi-1._krealfp)<a name='573'>
    fpvsi=tbpvsi(jx)+(xj-jx)*(tbpvsi(jx+1)-tbpvsi(jx))<a name='574'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='575'></font>
  end function<a name='576'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='577'></font>
<font color=#447700>! elemental function fpvsiq(t)<a name='578'></font>
<A NAME='FPVSIQ'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSIQ' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='579'>
  <font color=#993300>function </font><font color=#cc0000>fpvsiq</font>(t),<A href='../../call_from/FPVSIQ.html' TARGET='index'>1</A><a name='580'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='581'></font>
<font color=#447700>!<a name='582'></font>
<font color=#447700>! Subprogram: fpvsiq       Compute saturation vapor pressure over ice<a name='583'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='584'></font>
<font color=#447700>!<a name='585'></font>
<font color=#447700>! Abstract: Compute saturation vapor pressure from the temperature.<a name='586'></font>
<font color=#447700>!   A quadratic interpolation is done between values in a lookup table<a name='587'></font>
<font color=#447700>!   computed in gpvsi. See documentation for fpvsix for details.<a name='588'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='589'></font>
<font color=#447700>!   The interpolation accuracy is almost 9 decimal places.<a name='590'></font>
<font color=#447700>!   On the Cray, fpvsiq is about 3 times faster than exact calculation.<a name='591'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='592'></font>
<font color=#447700>!<a name='593'></font>
<font color=#447700>! Program History Log:<a name='594'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='595'></font>
<font color=#447700>!   94-12-30  Iredell             quadratic interpolation<a name='596'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='597'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='598'></font>
<font color=#447700>!<a name='599'></font>
<font color=#447700>! Usage:   pvsi=fpvsiq(t)<a name='600'></font>
<font color=#447700>!<a name='601'></font>
<font color=#447700>!   Input argument list:<a name='602'></font>
<font color=#447700>!     t          Real(krealfp) temperature in Kelvin<a name='603'></font>
<font color=#447700>!<a name='604'></font>
<font color=#447700>!   Output argument list:<a name='605'></font>
<font color=#447700>!     fpvsiq     Real(krealfp) saturation vapor pressure in Pascals<a name='606'></font>
<font color=#447700>!<a name='607'></font>
<font color=#447700>! Attributes:<a name='608'></font>
<font color=#447700>!   Language: Fortran 90.<a name='609'></font>
<font color=#447700>!<a name='610'></font>
<font color=#447700>!$$$<a name='611'></font>
    implicit none<a name='612'>
    real(krealfp) fpvsiq<a name='613'>
    real(krealfp),intent(in):: t<a name='614'>
    integer jx<a name='615'>
    real(krealfp) xj,dxj,fj1,fj2,fj3<a name='616'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='617'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSIQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_9">()<a name='618'>
    xj=min(max(c1xpvsi+c2xpvsi*t,1._krealfp),real(nxpvsi,krealfp))<a name='619'>
    jx=min(max(nint(xj),2),nxpvsi-1)<a name='620'>
    dxj=xj-jx<a name='621'>
    fj1=tbpvsi(jx-1)<a name='622'>
    fj2=tbpvsi(jx)<a name='623'>
    fj3=tbpvsi(jx+1)<a name='624'>
    fpvsiq=(((fj3+fj1)/2-fj2)*dxj+(fj3-fj1)/2)*dxj+fj2<a name='625'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='626'></font>
  end function<a name='627'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='628'></font>
<font color=#447700>! elemental function fpvsix(t)<a name='629'></font>
<A NAME='FPVSIX'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSIX' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='630'>
  <font color=#993300>function </font><font color=#cc0000>fpvsix</font>(t) <A href='../../call_to/FPVSIX.html' TARGET='index'>1</A>,<A href='../../call_from/FPVSIX.html' TARGET='index'>1</A><a name='631'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='632'></font>
<font color=#447700>!<a name='633'></font>
<font color=#447700>! Subprogram: fpvsix       Compute saturation vapor pressure over ice<a name='634'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='635'></font>
<font color=#447700>!<a name='636'></font>
<font color=#447700>! Abstract: Exactly compute saturation vapor pressure from temperature.<a name='637'></font>
<font color=#447700>!   The water model assumes a perfect gas, constant specific heats<a name='638'></font>
<font color=#447700>!   for gas and ice, and neglects the volume of the ice.<a name='639'></font>
<font color=#447700>!   The model does account for the variation of the latent heat<a name='640'></font>
<font color=#447700>!   of condensation with temperature.  The liquid option is not included.<a name='641'></font>
<font color=#447700>!   The Clausius-Clapeyron equation is integrated from the triple point<a name='642'></font>
<font color=#447700>!   to get the formula<a name='643'></font>
<font color=#447700>!       pvsi=con_psat*(tr**xa)*exp(xb*(1.-tr))<a name='644'></font>
<font color=#447700>!   where tr is ttp/t and other values are physical constants.<a name='645'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='646'></font>
<font color=#447700>!<a name='647'></font>
<font color=#447700>! Program History Log:<a name='648'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='649'></font>
<font color=#447700>!   94-12-30  Iredell             exact computation<a name='650'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='651'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='652'></font>
<font color=#447700>!<a name='653'></font>
<font color=#447700>! Usage:   pvsi=fpvsix(t)<a name='654'></font>
<font color=#447700>!<a name='655'></font>
<font color=#447700>!   Input argument list:<a name='656'></font>
<font color=#447700>!     t          Real(krealfp) temperature in Kelvin<a name='657'></font>
<font color=#447700>!<a name='658'></font>
<font color=#447700>!   Output argument list:<a name='659'></font>
<font color=#447700>!     fpvsix     Real(krealfp) saturation vapor pressure in Pascals<a name='660'></font>
<font color=#447700>!<a name='661'></font>
<font color=#447700>! Attributes:<a name='662'></font>
<font color=#447700>!   Language: Fortran 90.<a name='663'></font>
<font color=#447700>!<a name='664'></font>
<font color=#447700>!$$$<a name='665'></font>
    implicit none<a name='666'>
    real(krealfp) fpvsix<a name='667'>
    real(krealfp),intent(in):: t<a name='668'>
    real(krealfp),parameter:: dldt=con_cvap-con_csol<a name='669'>
    real(krealfp),parameter:: heat=con_hvap+con_hfus<a name='670'>
    real(krealfp),parameter:: xpona=-dldt/con_rv<a name='671'>
    real(krealfp),parameter:: xponb=-dldt/con_rv+heat/(con_rv*con_ttp)<a name='672'>
    real(krealfp) tr<a name='673'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='674'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSIX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_10">()<a name='675'>
    tr=con_ttp/t<a name='676'>
    fpvsix=con_psat*(tr**xpona)*exp(xponb*(1.-tr))<a name='677'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='678'></font>
  end function<a name='679'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='680'></font>
<A NAME='GPVS'><A href='../../html_code/phys/module_gfs_funcphys.F.html#GPVS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='681'>
  <font color=#993300>subroutine </font><font color=#cc0000>gpvs</font> <A href='../../call_to/GPVS.html' TARGET='index'>6</A>,<A href='../../call_from/GPVS.html' TARGET='index'>8</A><a name='682'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='683'></font>
<font color=#447700>!<a name='684'></font>
<font color=#447700>! Subprogram: gpvs         Compute saturation vapor pressure table<a name='685'></font>
<font color=#447700>!   Author: N Phillips            W/NMC2X2   Date: 30 dec 82<a name='686'></font>
<font color=#447700>!<a name='687'></font>
<font color=#447700>! Abstract: Computes saturation vapor pressure table as a function of<a name='688'></font>
<font color=#447700>!   temperature for the table lookup function fpvs.<a name='689'></font>
<font color=#447700>!   Exact saturation vapor pressures are calculated in subprogram fpvsx.<a name='690'></font>
<font color=#447700>!   The current implementation computes a table with a length<a name='691'></font>
<font color=#447700>!   of 7501 for temperatures ranging from 180. to 330. Kelvin.<a name='692'></font>
<font color=#447700>!<a name='693'></font>
<font color=#447700>! Program History Log:<a name='694'></font>
<font color=#447700>!   91-05-07  Iredell<a name='695'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='696'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='697'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='698'></font>
<font color=#447700>!<a name='699'></font>
<font color=#447700>! Usage:  call gpvs<a name='700'></font>
<font color=#447700>!<a name='701'></font>
<font color=#447700>! Subprograms called:<a name='702'></font>
<font color=#447700>!   (fpvsx)    inlinable function to compute saturation vapor pressure<a name='703'></font>
<font color=#447700>!<a name='704'></font>
<font color=#447700>! Attributes:<a name='705'></font>
<font color=#447700>!   Language: Fortran 90.<a name='706'></font>
<font color=#447700>!<a name='707'></font>
<font color=#447700>!$$$<a name='708'></font>
    implicit none<a name='709'>
    integer jx<a name='710'>
    real(krealfp) xmin,xmax,xinc,x,t<a name='711'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='712'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_mp_HWRF.F.html#GPVS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_11">()<a name='713'>
    xmin=180.0_krealfp<a name='714'>
    xmax=330.0_krealfp<a name='715'>
    xinc=(xmax-xmin)/(nxpvs-1)<a name='716'>
<font color=#447700>!   c1xpvs=1.-xmin/xinc<a name='717'></font>
    c2xpvs=1./xinc<a name='718'>
    c1xpvs=1.-xmin*c2xpvs<a name='719'>
    do jx=1,nxpvs<a name='720'>
      x=xmin+(jx-1)*xinc<a name='721'>
      t=x<a name='722'>
      tbpvs(jx)=<A href='../../html_code/phys/module_shcu_grims.F.html#FPVSX'>fpvsx</A><A href='../../html_code/phys/module_mp_HWRF.F.html#GPVS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FPVSX_1">(t)<a name='723'>
    enddo<a name='724'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='725'></font>
  end subroutine<a name='726'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='727'></font>
<font color=#447700>! elemental function fpvs(t)<a name='728'></font>
<A NAME='FPVS'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVS' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='729'>
  <font color=#993300>function </font><font color=#cc0000>fpvs</font>(t) <A href='../../call_to/FPVS.html' TARGET='index'>9</A>,<A href='../../call_from/FPVS.html' TARGET='index'>1</A><a name='730'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='731'></font>
<font color=#447700>!<a name='732'></font>
<font color=#447700>! Subprogram: fpvs         Compute saturation vapor pressure<a name='733'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='734'></font>
<font color=#447700>!<a name='735'></font>
<font color=#447700>! Abstract: Compute saturation vapor pressure from the temperature.<a name='736'></font>
<font color=#447700>!   A linear interpolation is done between values in a lookup table<a name='737'></font>
<font color=#447700>!   computed in gpvs. See documentation for fpvsx for details.<a name='738'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='739'></font>
<font color=#447700>!   The interpolation accuracy is almost 6 decimal places.<a name='740'></font>
<font color=#447700>!   On the Cray, fpvs is about 4 times faster than exact calculation.<a name='741'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='742'></font>
<font color=#447700>!<a name='743'></font>
<font color=#447700>! Program History Log:<a name='744'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='745'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='746'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='747'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='748'></font>
<font color=#447700>!<a name='749'></font>
<font color=#447700>! Usage:   pvs=fpvs(t)<a name='750'></font>
<font color=#447700>!<a name='751'></font>
<font color=#447700>!   Input argument list:<a name='752'></font>
<font color=#447700>!     t          Real(krealfp) temperature in Kelvin<a name='753'></font>
<font color=#447700>!<a name='754'></font>
<font color=#447700>!   Output argument list:<a name='755'></font>
<font color=#447700>!     fpvs       Real(krealfp) saturation vapor pressure in Pascals<a name='756'></font>
<font color=#447700>!<a name='757'></font>
<font color=#447700>! Attributes:<a name='758'></font>
<font color=#447700>!   Language: Fortran 90.<a name='759'></font>
<font color=#447700>!<a name='760'></font>
<font color=#447700>!$$$<a name='761'></font>
    implicit none<a name='762'>
    real(krealfp) fpvs<a name='763'>
    real(krealfp),intent(in):: t<a name='764'>
    integer jx<a name='765'>
    real(krealfp) xj<a name='766'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='767'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_mp_wsm6.F.html#FPVS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_12">()<a name='768'>
    xj=min(max(c1xpvs+c2xpvs*t,1._krealfp),real(nxpvs,krealfp))<a name='769'>
    jx=min(xj,nxpvs-1._krealfp)<a name='770'>
    fpvs=tbpvs(jx)+(xj-jx)*(tbpvs(jx+1)-tbpvs(jx))<a name='771'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='772'></font>
  end function<a name='773'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='774'></font>
<font color=#447700>! elemental function fpvsq(t)<a name='775'></font>
<A NAME='FPVSQ'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSQ' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='776'>
  <font color=#993300>function </font><font color=#cc0000>fpvsq</font>(t),<A href='../../call_from/FPVSQ.html' TARGET='index'>1</A><a name='777'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='778'></font>
<font color=#447700>!<a name='779'></font>
<font color=#447700>! Subprogram: fpvsq        Compute saturation vapor pressure<a name='780'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='781'></font>
<font color=#447700>!<a name='782'></font>
<font color=#447700>! Abstract: Compute saturation vapor pressure from the temperature.<a name='783'></font>
<font color=#447700>!   A quadratic interpolation is done between values in a lookup table<a name='784'></font>
<font color=#447700>!   computed in gpvs. See documentation for fpvsx for details.<a name='785'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='786'></font>
<font color=#447700>!   The interpolation accuracy is almost 9 decimal places.<a name='787'></font>
<font color=#447700>!   On the Cray, fpvsq is about 3 times faster than exact calculation.<a name='788'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='789'></font>
<font color=#447700>!<a name='790'></font>
<font color=#447700>! Program History Log:<a name='791'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='792'></font>
<font color=#447700>!   94-12-30  Iredell             quadratic interpolation<a name='793'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='794'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='795'></font>
<font color=#447700>!<a name='796'></font>
<font color=#447700>! Usage:   pvs=fpvsq(t)<a name='797'></font>
<font color=#447700>!<a name='798'></font>
<font color=#447700>!   Input argument list:<a name='799'></font>
<font color=#447700>!     t          Real(krealfp) temperature in Kelvin<a name='800'></font>
<font color=#447700>!<a name='801'></font>
<font color=#447700>!   Output argument list:<a name='802'></font>
<font color=#447700>!     fpvsq      Real(krealfp) saturation vapor pressure in Pascals<a name='803'></font>
<font color=#447700>!<a name='804'></font>
<font color=#447700>! Attributes:<a name='805'></font>
<font color=#447700>!   Language: Fortran 90.<a name='806'></font>
<font color=#447700>!<a name='807'></font>
<font color=#447700>!$$$<a name='808'></font>
    implicit none<a name='809'>
    real(krealfp) fpvsq<a name='810'>
    real(krealfp),intent(in):: t<a name='811'>
    integer jx<a name='812'>
    real(krealfp) xj,dxj,fj1,fj2,fj3<a name='813'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='814'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_13">()<a name='815'>
    xj=min(max(c1xpvs+c2xpvs*t,1._krealfp),real(nxpvs,krealfp))<a name='816'>
    jx=min(max(nint(xj),2),nxpvs-1)<a name='817'>
    dxj=xj-jx<a name='818'>
    fj1=tbpvs(jx-1)<a name='819'>
    fj2=tbpvs(jx)<a name='820'>
    fj3=tbpvs(jx+1)<a name='821'>
    fpvsq=(((fj3+fj1)/2-fj2)*dxj+(fj3-fj1)/2)*dxj+fj2<a name='822'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='823'></font>
  end function<a name='824'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='825'></font>
<font color=#447700>! elemental function fpvsx(t)<a name='826'></font>
<A NAME='FPVSX'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPVSX' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='827'>
  <font color=#993300>function </font><font color=#cc0000>fpvsx</font>(t) <A href='../../call_to/FPVSX.html' TARGET='index'>5</A>,<A href='../../call_from/FPVSX.html' TARGET='index'>1</A><a name='828'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='829'></font>
<font color=#447700>!<a name='830'></font>
<font color=#447700>! Subprogram: fpvsx        Compute saturation vapor pressure<a name='831'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='832'></font>
<font color=#447700>!<a name='833'></font>
<font color=#447700>! Abstract: Exactly compute saturation vapor pressure from temperature.<a name='834'></font>
<font color=#447700>!   The saturation vapor pressure over either liquid and ice is computed<a name='835'></font>
<font color=#447700>!   over liquid for temperatures above the triple point,<a name='836'></font>
<font color=#447700>!   over ice for temperatures 20 degress below the triple point,<a name='837'></font>
<font color=#447700>!   and a linear combination of the two for temperatures in between.<a name='838'></font>
<font color=#447700>!   The water model assumes a perfect gas, constant specific heats<a name='839'></font>
<font color=#447700>!   for gas, liquid and ice, and neglects the volume of the condensate.<a name='840'></font>
<font color=#447700>!   The model does account for the variation of the latent heat<a name='841'></font>
<font color=#447700>!   of condensation and sublimation with temperature.<a name='842'></font>
<font color=#447700>!   The Clausius-Clapeyron equation is integrated from the triple point<a name='843'></font>
<font color=#447700>!   to get the formula<a name='844'></font>
<font color=#447700>!       pvsl=con_psat*(tr**xa)*exp(xb*(1.-tr))<a name='845'></font>
<font color=#447700>!   where tr is ttp/t and other values are physical constants.<a name='846'></font>
<font color=#447700>!   The reference for this computation is Emanuel(1994), pages 116-117.<a name='847'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='848'></font>
<font color=#447700>!<a name='849'></font>
<font color=#447700>! Program History Log:<a name='850'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='851'></font>
<font color=#447700>!   94-12-30  Iredell             exact computation<a name='852'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='853'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='854'></font>
<font color=#447700>!<a name='855'></font>
<font color=#447700>! Usage:   pvs=fpvsx(t)<a name='856'></font>
<font color=#447700>!<a name='857'></font>
<font color=#447700>!   Input argument list:<a name='858'></font>
<font color=#447700>!     t          Real(krealfp) temperature in Kelvin<a name='859'></font>
<font color=#447700>!<a name='860'></font>
<font color=#447700>!   Output argument list:<a name='861'></font>
<font color=#447700>!     fpvsx      Real(krealfp) saturation vapor pressure in Pascals<a name='862'></font>
<font color=#447700>!<a name='863'></font>
<font color=#447700>! Attributes:<a name='864'></font>
<font color=#447700>!   Language: Fortran 90.<a name='865'></font>
<font color=#447700>!<a name='866'></font>
<font color=#447700>!$$$<a name='867'></font>
    implicit none<a name='868'>
    real(krealfp) fpvsx<a name='869'>
    real(krealfp),intent(in):: t<a name='870'>
    real(krealfp),parameter:: tliq=con_ttp<a name='871'>
    real(krealfp),parameter:: tice=con_ttp-20.0<a name='872'>
    real(krealfp),parameter:: dldtl=con_cvap-con_cliq<a name='873'>
    real(krealfp),parameter:: heatl=con_hvap<a name='874'>
    real(krealfp),parameter:: xponal=-dldtl/con_rv<a name='875'>
    real(krealfp),parameter:: xponbl=-dldtl/con_rv+heatl/(con_rv*con_ttp)<a name='876'>
    real(krealfp),parameter:: dldti=con_cvap-con_csol<a name='877'>
    real(krealfp),parameter:: heati=con_hvap+con_hfus<a name='878'>
    real(krealfp),parameter:: xponai=-dldti/con_rv<a name='879'>
    real(krealfp),parameter:: xponbi=-dldti/con_rv+heati/(con_rv*con_ttp)<a name='880'>
    real(krealfp) tr,w,pvl,pvi<a name='881'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='882'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_shcu_grims.F.html#FPVSX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_14">()<a name='883'>
    tr=con_ttp/t<a name='884'>
    if(t.ge.tliq) then<a name='885'>
      fpvsx=con_psat*(tr**xponal)*exp(xponbl*(1.-tr))<a name='886'>
    elseif(t.lt.tice) then<a name='887'>
      fpvsx=con_psat*(tr**xponai)*exp(xponbi*(1.-tr))<a name='888'>
    else<a name='889'>
      w=(t-tice)/(tliq-tice)<a name='890'>
      pvl=con_psat*(tr**xponal)*exp(xponbl*(1.-tr))<a name='891'>
      pvi=con_psat*(tr**xponai)*exp(xponbi*(1.-tr))<a name='892'>
      fpvsx=w*pvl+(1.-w)*pvi<a name='893'>
    endif<a name='894'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='895'></font>
  end function<a name='896'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='897'></font>
<A NAME='GTDPL'><A href='../../html_code/phys/module_gfs_funcphys.F.html#GTDPL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='898'>
  <font color=#993300>subroutine </font><font color=#cc0000>gtdpl</font> <A href='../../call_to/GTDPL.html' TARGET='index'>1</A>,<A href='../../call_from/GTDPL.html' TARGET='index'>1</A><a name='899'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='900'></font>
<font color=#447700>!<a name='901'></font>
<font color=#447700>! Subprogram: gtdpl        Compute dewpoint temperature over liquid table<a name='902'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='903'></font>
<font color=#447700>!<a name='904'></font>
<font color=#447700>! Abstract: Compute dewpoint temperature table as a function of<a name='905'></font>
<font color=#447700>!   vapor pressure for inlinable function ftdpl.<a name='906'></font>
<font color=#447700>!   Exact dewpoint temperatures are calculated in subprogram ftdplxg.<a name='907'></font>
<font color=#447700>!   The current implementation computes a table with a length<a name='908'></font>
<font color=#447700>!   of 5001 for vapor pressures ranging from 1 to 10001 Pascals<a name='909'></font>
<font color=#447700>!   giving a dewpoint temperature range of 208 to 319 Kelvin.<a name='910'></font>
<font color=#447700>!<a name='911'></font>
<font color=#447700>! Program History Log:<a name='912'></font>
<font color=#447700>!   91-05-07  Iredell<a name='913'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='914'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='915'></font>
<font color=#447700>!<a name='916'></font>
<font color=#447700>! Usage:  call gtdpl<a name='917'></font>
<font color=#447700>!<a name='918'></font>
<font color=#447700>! Subprograms called:<a name='919'></font>
<font color=#447700>!   (ftdplxg)  inlinable function to compute dewpoint temperature over liquid<a name='920'></font>
<font color=#447700>!<a name='921'></font>
<font color=#447700>! Attributes:<a name='922'></font>
<font color=#447700>!   Language: Fortran 90.<a name='923'></font>
<font color=#447700>!<a name='924'></font>
<font color=#447700>!$$$<a name='925'></font>
    implicit none<a name='926'>
    integer jx<a name='927'>
    real(krealfp) xmin,xmax,xinc,t,x,pv<a name='928'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='929'></font>
    xmin=1<a name='930'>
    xmax=10001<a name='931'>
    xinc=(xmax-xmin)/(nxtdpl-1)<a name='932'>
    c1xtdpl=1.-xmin/xinc<a name='933'>
    c2xtdpl=1./xinc<a name='934'>
    t=208.0<a name='935'>
    do jx=1,nxtdpl<a name='936'>
      x=xmin+(jx-1)*xinc<a name='937'>
      pv=x<a name='938'>
      t=<A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPLXG'>ftdplxg</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GTDPL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FTDPLXG_1">(t,pv)<a name='939'>
      tbtdpl(jx)=t<a name='940'>
    enddo<a name='941'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='942'></font>
  end subroutine<a name='943'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='944'></font>
<font color=#447700>! elemental function ftdpl(pv)<a name='945'></font>
<A NAME='FTDPL'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPL' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='946'>
  <font color=#993300>function </font><font color=#cc0000>ftdpl</font>(pv) <A href='../../call_to/FTDPL.html' TARGET='index'>1</A>,<A href='../../call_from/FTDPL.html' TARGET='index'>1</A><a name='947'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='948'></font>
<font color=#447700>!<a name='949'></font>
<font color=#447700>! Subprogram: ftdpl        Compute dewpoint temperature over liquid<a name='950'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='951'></font>
<font color=#447700>!<a name='952'></font>
<font color=#447700>! Abstract: Compute dewpoint temperature from vapor pressure.<a name='953'></font>
<font color=#447700>!   A linear interpolation is done between values in a lookup table<a name='954'></font>
<font color=#447700>!   computed in gtdpl. See documentation for ftdplxg for details.<a name='955'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='956'></font>
<font color=#447700>!   The interpolation accuracy is better than 0.0005 Kelvin<a name='957'></font>
<font color=#447700>!   for dewpoint temperatures greater than 250 Kelvin,<a name='958'></font>
<font color=#447700>!   but decreases to 0.02 Kelvin for a dewpoint around 230 Kelvin.<a name='959'></font>
<font color=#447700>!   On the Cray, ftdpl is about 75 times faster than exact calculation.<a name='960'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='961'></font>
<font color=#447700>!<a name='962'></font>
<font color=#447700>! Program History Log:<a name='963'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='964'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='965'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='966'></font>
<font color=#447700>!<a name='967'></font>
<font color=#447700>! Usage:   tdpl=ftdpl(pv)<a name='968'></font>
<font color=#447700>!<a name='969'></font>
<font color=#447700>!   Input argument list:<a name='970'></font>
<font color=#447700>!     pv         Real(krealfp) vapor pressure in Pascals<a name='971'></font>
<font color=#447700>!<a name='972'></font>
<font color=#447700>!   Output argument list:<a name='973'></font>
<font color=#447700>!     ftdpl      Real(krealfp) dewpoint temperature in Kelvin<a name='974'></font>
<font color=#447700>!<a name='975'></font>
<font color=#447700>! Attributes:<a name='976'></font>
<font color=#447700>!   Language: Fortran 90.<a name='977'></font>
<font color=#447700>!<a name='978'></font>
<font color=#447700>!$$$<a name='979'></font>
    implicit none<a name='980'>
    real(krealfp) ftdpl<a name='981'>
    real(krealfp),intent(in):: pv<a name='982'>
    integer jx<a name='983'>
    real(krealfp) xj<a name='984'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='985'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_15">()<a name='986'>
    xj=min(max(c1xtdpl+c2xtdpl*pv,1._krealfp),real(nxtdpl,krealfp))<a name='987'>
    jx=min(xj,nxtdpl-1._krealfp)<a name='988'>
    ftdpl=tbtdpl(jx)+(xj-jx)*(tbtdpl(jx+1)-tbtdpl(jx))<a name='989'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='990'></font>
  end function<a name='991'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='992'></font>
<font color=#447700>! elemental function ftdplq(pv)<a name='993'></font>
<A NAME='FTDPLQ'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPLQ' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='994'>
  <font color=#993300>function </font><font color=#cc0000>ftdplq</font>(pv),<A href='../../call_from/FTDPLQ.html' TARGET='index'>1</A><a name='995'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='996'></font>
<font color=#447700>!<a name='997'></font>
<font color=#447700>! Subprogram: ftdplq       Compute dewpoint temperature over liquid<a name='998'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='999'></font>
<font color=#447700>!<a name='1000'></font>
<font color=#447700>! Abstract: Compute dewpoint temperature from vapor pressure.<a name='1001'></font>
<font color=#447700>!   A quadratic interpolation is done between values in a lookup table<a name='1002'></font>
<font color=#447700>!   computed in gtdpl. see documentation for ftdplxg for details.<a name='1003'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='1004'></font>
<font color=#447700>!   the interpolation accuracy is better than 0.00001 Kelvin<a name='1005'></font>
<font color=#447700>!   for dewpoint temperatures greater than 250 Kelvin,<a name='1006'></font>
<font color=#447700>!   but decreases to 0.002 Kelvin for a dewpoint around 230 Kelvin.<a name='1007'></font>
<font color=#447700>!   On the Cray, ftdplq is about 60 times faster than exact calculation.<a name='1008'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='1009'></font>
<font color=#447700>!<a name='1010'></font>
<font color=#447700>! Program History Log:<a name='1011'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1012'></font>
<font color=#447700>!   94-12-30  Iredell             quadratic interpolation<a name='1013'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1014'></font>
<font color=#447700>!<a name='1015'></font>
<font color=#447700>! Usage:   tdpl=ftdplq(pv)<a name='1016'></font>
<font color=#447700>!<a name='1017'></font>
<font color=#447700>!   Input argument list:<a name='1018'></font>
<font color=#447700>!     pv         Real(krealfp) vapor pressure in Pascals<a name='1019'></font>
<font color=#447700>!<a name='1020'></font>
<font color=#447700>!   Output argument list:<a name='1021'></font>
<font color=#447700>!     ftdplq     Real(krealfp) dewpoint temperature in Kelvin<a name='1022'></font>
<font color=#447700>!<a name='1023'></font>
<font color=#447700>! Attributes:<a name='1024'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1025'></font>
<font color=#447700>!<a name='1026'></font>
<font color=#447700>!$$$<a name='1027'></font>
    implicit none<a name='1028'>
    real(krealfp) ftdplq<a name='1029'>
    real(krealfp),intent(in):: pv<a name='1030'>
    integer jx<a name='1031'>
    real(krealfp) xj,dxj,fj1,fj2,fj3<a name='1032'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1033'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPLQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_16">()<a name='1034'>
    xj=min(max(c1xtdpl+c2xtdpl*pv,1._krealfp),real(nxtdpl,krealfp))<a name='1035'>
    jx=min(max(nint(xj),2),nxtdpl-1)<a name='1036'>
    dxj=xj-jx<a name='1037'>
    fj1=tbtdpl(jx-1)<a name='1038'>
    fj2=tbtdpl(jx)<a name='1039'>
    fj3=tbtdpl(jx+1)<a name='1040'>
    ftdplq=(((fj3+fj1)/2-fj2)*dxj+(fj3-fj1)/2)*dxj+fj2<a name='1041'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1042'></font>
  end function<a name='1043'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1044'></font>
<font color=#447700>! elemental function ftdplx(pv)<a name='1045'></font>
<A NAME='FTDPLX'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPLX' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1046'>
  <font color=#993300>function </font><font color=#cc0000>ftdplx</font>(pv),<A href='../../call_from/FTDPLX.html' TARGET='index'>3</A><a name='1047'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1048'></font>
<font color=#447700>!<a name='1049'></font>
<font color=#447700>! Subprogram: ftdplx       Compute dewpoint temperature over liquid<a name='1050'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1051'></font>
<font color=#447700>!<a name='1052'></font>
<font color=#447700>! Abstract: exactly compute dewpoint temperature from vapor pressure.<a name='1053'></font>
<font color=#447700>!   An approximate dewpoint temperature for function ftdplxg<a name='1054'></font>
<font color=#447700>!   is obtained using ftdpl so gtdpl must be already called.<a name='1055'></font>
<font color=#447700>!   See documentation for ftdplxg for details.<a name='1056'></font>
<font color=#447700>!<a name='1057'></font>
<font color=#447700>! Program History Log:<a name='1058'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1059'></font>
<font color=#447700>!   94-12-30  Iredell             exact computation<a name='1060'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1061'></font>
<font color=#447700>!<a name='1062'></font>
<font color=#447700>! Usage:   tdpl=ftdplx(pv)<a name='1063'></font>
<font color=#447700>!<a name='1064'></font>
<font color=#447700>!   Input argument list:<a name='1065'></font>
<font color=#447700>!     pv         Real(krealfp) vapor pressure in Pascals<a name='1066'></font>
<font color=#447700>!<a name='1067'></font>
<font color=#447700>!   Output argument list:<a name='1068'></font>
<font color=#447700>!     ftdplx     Real(krealfp) dewpoint temperature in Kelvin<a name='1069'></font>
<font color=#447700>!<a name='1070'></font>
<font color=#447700>! Subprograms called:<a name='1071'></font>
<font color=#447700>!   (ftdpl)    inlinable function to compute dewpoint temperature over liquid<a name='1072'></font>
<font color=#447700>!   (ftdplxg)  inlinable function to compute dewpoint temperature over liquid<a name='1073'></font>
<font color=#447700>!<a name='1074'></font>
<font color=#447700>! Attributes:<a name='1075'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1076'></font>
<font color=#447700>!<a name='1077'></font>
<font color=#447700>!$$$<a name='1078'></font>
    implicit none<a name='1079'>
    real(krealfp) ftdplx<a name='1080'>
    real(krealfp),intent(in):: pv<a name='1081'>
    real(krealfp) tg<a name='1082'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1083'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPLX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_17">()<a name='1084'>
    tg=<A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPL'>ftdpl</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPLX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FTDPL_1">(pv)<a name='1085'>
    ftdplx=<A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPLXG'>ftdplxg</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPLX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FTDPLXG_2">(tg,pv)<a name='1086'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1087'></font>
  end function<a name='1088'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1089'></font>
<font color=#447700>! elemental function ftdplxg(tg,pv)<a name='1090'></font>
<A NAME='FTDPLXG'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPLXG' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1091'>
  <font color=#993300>function </font><font color=#cc0000>ftdplxg</font>(tg,pv) <A href='../../call_to/FTDPLXG.html' TARGET='index'>2</A>,<A href='../../call_from/FTDPLXG.html' TARGET='index'>1</A><a name='1092'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1093'></font>
<font color=#447700>!<a name='1094'></font>
<font color=#447700>! Subprogram: ftdplxg      Compute dewpoint temperature over liquid<a name='1095'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1096'></font>
<font color=#447700>!<a name='1097'></font>
<font color=#447700>! Abstract: Exactly compute dewpoint temperature from vapor pressure.<a name='1098'></font>
<font color=#447700>!   A guess dewpoint temperature must be provided.<a name='1099'></font>
<font color=#447700>!   The water model assumes a perfect gas, constant specific heats<a name='1100'></font>
<font color=#447700>!   for gas and liquid, and neglects the volume of the liquid.<a name='1101'></font>
<font color=#447700>!   The model does account for the variation of the latent heat<a name='1102'></font>
<font color=#447700>!   of condensation with temperature.  The ice option is not included.<a name='1103'></font>
<font color=#447700>!   The Clausius-Clapeyron equation is integrated from the triple point<a name='1104'></font>
<font color=#447700>!   to get the formula<a name='1105'></font>
<font color=#447700>!       pvs=con_psat*(tr**xa)*exp(xb*(1.-tr))<a name='1106'></font>
<font color=#447700>!   where tr is ttp/t and other values are physical constants.<a name='1107'></font>
<font color=#447700>!   The formula is inverted by iterating Newtonian approximations<a name='1108'></font>
<font color=#447700>!   for each pvs until t is found to within 1.e-6 Kelvin.<a name='1109'></font>
<font color=#447700>!   This function can be expanded inline in the calling routine.<a name='1110'></font>
<font color=#447700>!<a name='1111'></font>
<font color=#447700>! Program History Log:<a name='1112'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1113'></font>
<font color=#447700>!   94-12-30  Iredell             exact computation<a name='1114'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1115'></font>
<font color=#447700>!<a name='1116'></font>
<font color=#447700>! Usage:   tdpl=ftdplxg(tg,pv)<a name='1117'></font>
<font color=#447700>!<a name='1118'></font>
<font color=#447700>!   Input argument list:<a name='1119'></font>
<font color=#447700>!     tg         Real(krealfp) guess dewpoint temperature in Kelvin<a name='1120'></font>
<font color=#447700>!     pv         Real(krealfp) vapor pressure in Pascals<a name='1121'></font>
<font color=#447700>!<a name='1122'></font>
<font color=#447700>!   Output argument list:<a name='1123'></font>
<font color=#447700>!     ftdplxg    Real(krealfp) dewpoint temperature in Kelvin<a name='1124'></font>
<font color=#447700>!<a name='1125'></font>
<font color=#447700>! Attributes:<a name='1126'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1127'></font>
<font color=#447700>!<a name='1128'></font>
<font color=#447700>!$$$<a name='1129'></font>
    implicit none<a name='1130'>
    real(krealfp) ftdplxg<a name='1131'>
    real(krealfp),intent(in):: tg,pv<a name='1132'>
    real(krealfp),parameter:: terrm=1.e-6<a name='1133'>
    real(krealfp),parameter:: dldt=con_cvap-con_cliq<a name='1134'>
    real(krealfp),parameter:: heat=con_hvap<a name='1135'>
    real(krealfp),parameter:: xpona=-dldt/con_rv<a name='1136'>
    real(krealfp),parameter:: xponb=-dldt/con_rv+heat/(con_rv*con_ttp)<a name='1137'>
    real(krealfp) t,tr,pvt,el,dpvt,terr<a name='1138'>
    integer i<a name='1139'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1140'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPLXG' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_18">()<a name='1141'>
    t=tg<a name='1142'>
    do i=1,100<a name='1143'>
      tr=con_ttp/t<a name='1144'>
      pvt=con_psat*(tr**xpona)*exp(xponb*(1.-tr))<a name='1145'>
      el=heat+dldt*(t-con_ttp)<a name='1146'>
      dpvt=el*pvt/(con_rv*t**2)<a name='1147'>
      terr=(pvt-pv)/dpvt<a name='1148'>
      t=t-terr<a name='1149'>
      if(abs(terr).le.terrm) exit<a name='1150'>
    enddo<a name='1151'>
    ftdplxg=t<a name='1152'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1153'></font>
  end function<a name='1154'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1155'></font>
<A NAME='GTDPI'><A href='../../html_code/phys/module_gfs_funcphys.F.html#GTDPI' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1156'>
  <font color=#993300>subroutine </font><font color=#cc0000>gtdpi</font> <A href='../../call_to/GTDPI.html' TARGET='index'>1</A>,<A href='../../call_from/GTDPI.html' TARGET='index'>1</A><a name='1157'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1158'></font>
<font color=#447700>!<a name='1159'></font>
<font color=#447700>! Subprogram: gtdpi        Compute dewpoint temperature over ice table<a name='1160'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1161'></font>
<font color=#447700>!<a name='1162'></font>
<font color=#447700>! Abstract: Compute dewpoint temperature table as a function of<a name='1163'></font>
<font color=#447700>!   vapor pressure for inlinable function ftdpi.<a name='1164'></font>
<font color=#447700>!   Exact dewpoint temperatures are calculated in subprogram ftdpixg.<a name='1165'></font>
<font color=#447700>!   The current implementation computes a table with a length<a name='1166'></font>
<font color=#447700>!   of 5001 for vapor pressures ranging from 0.1 to 1000.1 Pascals<a name='1167'></font>
<font color=#447700>!   giving a dewpoint temperature range of 197 to 279 Kelvin.<a name='1168'></font>
<font color=#447700>!<a name='1169'></font>
<font color=#447700>! Program History Log:<a name='1170'></font>
<font color=#447700>!   91-05-07  Iredell<a name='1171'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='1172'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1173'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='1174'></font>
<font color=#447700>!<a name='1175'></font>
<font color=#447700>! Usage:  call gtdpi<a name='1176'></font>
<font color=#447700>!<a name='1177'></font>
<font color=#447700>! Subprograms called:<a name='1178'></font>
<font color=#447700>!   (ftdpixg)  inlinable function to compute dewpoint temperature over ice<a name='1179'></font>
<font color=#447700>!<a name='1180'></font>
<font color=#447700>! Attributes:<a name='1181'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1182'></font>
<font color=#447700>!<a name='1183'></font>
<font color=#447700>!$$$<a name='1184'></font>
    implicit none<a name='1185'>
    integer jx<a name='1186'>
    real(krealfp) xmin,xmax,xinc,t,x,pv<a name='1187'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1188'></font>
    xmin=0.1<a name='1189'>
    xmax=1000.1<a name='1190'>
    xinc=(xmax-xmin)/(nxtdpi-1)<a name='1191'>
    c1xtdpi=1.-xmin/xinc<a name='1192'>
    c2xtdpi=1./xinc<a name='1193'>
    t=197.0<a name='1194'>
    do jx=1,nxtdpi<a name='1195'>
      x=xmin+(jx-1)*xinc<a name='1196'>
      pv=x<a name='1197'>
      t=<A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPIXG'>ftdpixg</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GTDPI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FTDPIXG_1">(t,pv)<a name='1198'>
      tbtdpi(jx)=t<a name='1199'>
    enddo<a name='1200'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1201'></font>
  end subroutine<a name='1202'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1203'></font>
<font color=#447700>! elemental function ftdpi(pv)<a name='1204'></font>
<A NAME='FTDPI'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPI' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1205'>
  <font color=#993300>function </font><font color=#cc0000>ftdpi</font>(pv) <A href='../../call_to/FTDPI.html' TARGET='index'>1</A>,<A href='../../call_from/FTDPI.html' TARGET='index'>1</A><a name='1206'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1207'></font>
<font color=#447700>!<a name='1208'></font>
<font color=#447700>! Subprogram: ftdpi        Compute dewpoint temperature over ice<a name='1209'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1210'></font>
<font color=#447700>!<a name='1211'></font>
<font color=#447700>! Abstract: Compute dewpoint temperature from vapor pressure.<a name='1212'></font>
<font color=#447700>!   A linear interpolation is done between values in a lookup table<a name='1213'></font>
<font color=#447700>!   computed in gtdpi. See documentation for ftdpixg for details.<a name='1214'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='1215'></font>
<font color=#447700>!   The interpolation accuracy is better than 0.0005 Kelvin<a name='1216'></font>
<font color=#447700>!   for dewpoint temperatures greater than 250 Kelvin,<a name='1217'></font>
<font color=#447700>!   but decreases to 0.02 Kelvin for a dewpoint around 230 Kelvin.<a name='1218'></font>
<font color=#447700>!   On the Cray, ftdpi is about 75 times faster than exact calculation.<a name='1219'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='1220'></font>
<font color=#447700>!<a name='1221'></font>
<font color=#447700>! Program History Log:<a name='1222'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1223'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='1224'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1225'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='1226'></font>
<font color=#447700>!<a name='1227'></font>
<font color=#447700>! Usage:   tdpi=ftdpi(pv)<a name='1228'></font>
<font color=#447700>!<a name='1229'></font>
<font color=#447700>!   Input argument list:<a name='1230'></font>
<font color=#447700>!     pv         Real(krealfp) vapor pressure in Pascals<a name='1231'></font>
<font color=#447700>!<a name='1232'></font>
<font color=#447700>!   Output argument list:<a name='1233'></font>
<font color=#447700>!     ftdpi      Real(krealfp) dewpoint temperature in Kelvin<a name='1234'></font>
<font color=#447700>!<a name='1235'></font>
<font color=#447700>! Attributes:<a name='1236'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1237'></font>
<font color=#447700>!<a name='1238'></font>
<font color=#447700>!$$$<a name='1239'></font>
    implicit none<a name='1240'>
    real(krealfp) ftdpi<a name='1241'>
    real(krealfp),intent(in):: pv<a name='1242'>
    integer jx<a name='1243'>
    real(krealfp) xj<a name='1244'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1245'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_19">()<a name='1246'>
    xj=min(max(c1xtdpi+c2xtdpi*pv,1._krealfp),real(nxtdpi,krealfp))<a name='1247'>
    jx=min(xj,nxtdpi-1._krealfp)<a name='1248'>
    ftdpi=tbtdpi(jx)+(xj-jx)*(tbtdpi(jx+1)-tbtdpi(jx))<a name='1249'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1250'></font>
  end function<a name='1251'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1252'></font>
<font color=#447700>! elemental function ftdpiq(pv)<a name='1253'></font>
<A NAME='FTDPIQ'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPIQ' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1254'>
  <font color=#993300>function </font><font color=#cc0000>ftdpiq</font>(pv),<A href='../../call_from/FTDPIQ.html' TARGET='index'>1</A><a name='1255'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1256'></font>
<font color=#447700>!<a name='1257'></font>
<font color=#447700>! Subprogram: ftdpiq       Compute dewpoint temperature over ice<a name='1258'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1259'></font>
<font color=#447700>!<a name='1260'></font>
<font color=#447700>! Abstract: Compute dewpoint temperature from vapor pressure.<a name='1261'></font>
<font color=#447700>!   A quadratic interpolation is done between values in a lookup table<a name='1262'></font>
<font color=#447700>!   computed in gtdpi. see documentation for ftdpixg for details.<a name='1263'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='1264'></font>
<font color=#447700>!   the interpolation accuracy is better than 0.00001 Kelvin<a name='1265'></font>
<font color=#447700>!   for dewpoint temperatures greater than 250 Kelvin,<a name='1266'></font>
<font color=#447700>!   but decreases to 0.002 Kelvin for a dewpoint around 230 Kelvin.<a name='1267'></font>
<font color=#447700>!   On the Cray, ftdpiq is about 60 times faster than exact calculation.<a name='1268'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='1269'></font>
<font color=#447700>!<a name='1270'></font>
<font color=#447700>! Program History Log:<a name='1271'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1272'></font>
<font color=#447700>!   94-12-30  Iredell             quadratic interpolation<a name='1273'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1274'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='1275'></font>
<font color=#447700>!<a name='1276'></font>
<font color=#447700>! Usage:   tdpi=ftdpiq(pv)<a name='1277'></font>
<font color=#447700>!<a name='1278'></font>
<font color=#447700>!   Input argument list:<a name='1279'></font>
<font color=#447700>!     pv         Real(krealfp) vapor pressure in Pascals<a name='1280'></font>
<font color=#447700>!<a name='1281'></font>
<font color=#447700>!   Output argument list:<a name='1282'></font>
<font color=#447700>!     ftdpiq     Real(krealfp) dewpoint temperature in Kelvin<a name='1283'></font>
<font color=#447700>!<a name='1284'></font>
<font color=#447700>! Attributes:<a name='1285'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1286'></font>
<font color=#447700>!<a name='1287'></font>
<font color=#447700>!$$$<a name='1288'></font>
    implicit none<a name='1289'>
    real(krealfp) ftdpiq<a name='1290'>
    real(krealfp),intent(in):: pv<a name='1291'>
    integer jx<a name='1292'>
    real(krealfp) xj,dxj,fj1,fj2,fj3<a name='1293'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1294'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPIQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_20">()<a name='1295'>
    xj=min(max(c1xtdpi+c2xtdpi*pv,1._krealfp),real(nxtdpi,krealfp))<a name='1296'>
    jx=min(max(nint(xj),2),nxtdpi-1)<a name='1297'>
    dxj=xj-jx<a name='1298'>
    fj1=tbtdpi(jx-1)<a name='1299'>
    fj2=tbtdpi(jx)<a name='1300'>
    fj3=tbtdpi(jx+1)<a name='1301'>
    ftdpiq=(((fj3+fj1)/2-fj2)*dxj+(fj3-fj1)/2)*dxj+fj2<a name='1302'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1303'></font>
  end function<a name='1304'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1305'></font>
<font color=#447700>! elemental function ftdpix(pv)<a name='1306'></font>
<A NAME='FTDPIX'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPIX' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1307'>
  <font color=#993300>function </font><font color=#cc0000>ftdpix</font>(pv),<A href='../../call_from/FTDPIX.html' TARGET='index'>3</A><a name='1308'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1309'></font>
<font color=#447700>!<a name='1310'></font>
<font color=#447700>! Subprogram: ftdpix       Compute dewpoint temperature over ice<a name='1311'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1312'></font>
<font color=#447700>!<a name='1313'></font>
<font color=#447700>! Abstract: exactly compute dewpoint temperature from vapor pressure.<a name='1314'></font>
<font color=#447700>!   An approximate dewpoint temperature for function ftdpixg<a name='1315'></font>
<font color=#447700>!   is obtained using ftdpi so gtdpi must be already called.<a name='1316'></font>
<font color=#447700>!   See documentation for ftdpixg for details.<a name='1317'></font>
<font color=#447700>!<a name='1318'></font>
<font color=#447700>! Program History Log:<a name='1319'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1320'></font>
<font color=#447700>!   94-12-30  Iredell             exact computation<a name='1321'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1322'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='1323'></font>
<font color=#447700>!<a name='1324'></font>
<font color=#447700>! Usage:   tdpi=ftdpix(pv)<a name='1325'></font>
<font color=#447700>!<a name='1326'></font>
<font color=#447700>!   Input argument list:<a name='1327'></font>
<font color=#447700>!     pv         Real(krealfp) vapor pressure in Pascals<a name='1328'></font>
<font color=#447700>!<a name='1329'></font>
<font color=#447700>!   Output argument list:<a name='1330'></font>
<font color=#447700>!     ftdpix     Real(krealfp) dewpoint temperature in Kelvin<a name='1331'></font>
<font color=#447700>!<a name='1332'></font>
<font color=#447700>! Subprograms called:<a name='1333'></font>
<font color=#447700>!   (ftdpi)    inlinable function to compute dewpoint temperature over ice<a name='1334'></font>
<font color=#447700>!   (ftdpixg)  inlinable function to compute dewpoint temperature over ice<a name='1335'></font>
<font color=#447700>!<a name='1336'></font>
<font color=#447700>! Attributes:<a name='1337'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1338'></font>
<font color=#447700>!<a name='1339'></font>
<font color=#447700>!$$$<a name='1340'></font>
    implicit none<a name='1341'>
    real(krealfp) ftdpix<a name='1342'>
    real(krealfp),intent(in):: pv<a name='1343'>
    real(krealfp) tg<a name='1344'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1345'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPIX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_21">()<a name='1346'>
    tg=<A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPI'>ftdpi</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPIX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FTDPI_1">(pv)<a name='1347'>
    ftdpix=<A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPIXG'>ftdpixg</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPIX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FTDPIXG_2">(tg,pv)<a name='1348'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1349'></font>
  end function<a name='1350'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1351'></font>
<font color=#447700>! elemental function ftdpixg(tg,pv)<a name='1352'></font>
<A NAME='FTDPIXG'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPIXG' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1353'>
  <font color=#993300>function </font><font color=#cc0000>ftdpixg</font>(tg,pv) <A href='../../call_to/FTDPIXG.html' TARGET='index'>2</A>,<A href='../../call_from/FTDPIXG.html' TARGET='index'>1</A><a name='1354'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1355'></font>
<font color=#447700>!<a name='1356'></font>
<font color=#447700>! Subprogram: ftdpixg      Compute dewpoint temperature over ice<a name='1357'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1358'></font>
<font color=#447700>!<a name='1359'></font>
<font color=#447700>! Abstract: Exactly compute dewpoint temperature from vapor pressure.<a name='1360'></font>
<font color=#447700>!   A guess dewpoint temperature must be provided.<a name='1361'></font>
<font color=#447700>!   The water model assumes a perfect gas, constant specific heats<a name='1362'></font>
<font color=#447700>!   for gas and ice, and neglects the volume of the ice.<a name='1363'></font>
<font color=#447700>!   The model does account for the variation of the latent heat<a name='1364'></font>
<font color=#447700>!   of sublimation with temperature.  The liquid option is not included.<a name='1365'></font>
<font color=#447700>!   The Clausius-Clapeyron equation is integrated from the triple point<a name='1366'></font>
<font color=#447700>!   to get the formula<a name='1367'></font>
<font color=#447700>!       pvs=con_psat*(tr**xa)*exp(xb*(1.-tr))<a name='1368'></font>
<font color=#447700>!   where tr is ttp/t and other values are physical constants.<a name='1369'></font>
<font color=#447700>!   The formula is inverted by iterating Newtonian approximations<a name='1370'></font>
<font color=#447700>!   for each pvs until t is found to within 1.e-6 Kelvin.<a name='1371'></font>
<font color=#447700>!   This function can be expanded inline in the calling routine.<a name='1372'></font>
<font color=#447700>!<a name='1373'></font>
<font color=#447700>! Program History Log:<a name='1374'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1375'></font>
<font color=#447700>!   94-12-30  Iredell             exact computation<a name='1376'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1377'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='1378'></font>
<font color=#447700>!<a name='1379'></font>
<font color=#447700>! Usage:   tdpi=ftdpixg(tg,pv)<a name='1380'></font>
<font color=#447700>!<a name='1381'></font>
<font color=#447700>!   Input argument list:<a name='1382'></font>
<font color=#447700>!     tg         Real(krealfp) guess dewpoint temperature in Kelvin<a name='1383'></font>
<font color=#447700>!     pv         Real(krealfp) vapor pressure in Pascals<a name='1384'></font>
<font color=#447700>!<a name='1385'></font>
<font color=#447700>!   Output argument list:<a name='1386'></font>
<font color=#447700>!     ftdpixg    Real(krealfp) dewpoint temperature in Kelvin<a name='1387'></font>
<font color=#447700>!<a name='1388'></font>
<font color=#447700>! Attributes:<a name='1389'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1390'></font>
<font color=#447700>!<a name='1391'></font>
<font color=#447700>!$$$<a name='1392'></font>
    implicit none<a name='1393'>
    real(krealfp) ftdpixg<a name='1394'>
    real(krealfp),intent(in):: tg,pv<a name='1395'>
    real(krealfp),parameter:: terrm=1.e-6<a name='1396'>
    real(krealfp),parameter:: dldt=con_cvap-con_csol<a name='1397'>
    real(krealfp),parameter:: heat=con_hvap+con_hfus<a name='1398'>
    real(krealfp),parameter:: xpona=-dldt/con_rv<a name='1399'>
    real(krealfp),parameter:: xponb=-dldt/con_rv+heat/(con_rv*con_ttp)<a name='1400'>
    real(krealfp) t,tr,pvt,el,dpvt,terr<a name='1401'>
    integer i<a name='1402'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1403'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPIXG' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_22">()<a name='1404'>
    t=tg<a name='1405'>
    do i=1,100<a name='1406'>
      tr=con_ttp/t<a name='1407'>
      pvt=con_psat*(tr**xpona)*exp(xponb*(1.-tr))<a name='1408'>
      el=heat+dldt*(t-con_ttp)<a name='1409'>
      dpvt=el*pvt/(con_rv*t**2)<a name='1410'>
      terr=(pvt-pv)/dpvt<a name='1411'>
      t=t-terr<a name='1412'>
      if(abs(terr).le.terrm) exit<a name='1413'>
    enddo<a name='1414'>
    ftdpixg=t<a name='1415'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1416'></font>
  end function<a name='1417'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1418'></font>
<A NAME='GTDP'><A href='../../html_code/phys/module_gfs_funcphys.F.html#GTDP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1419'>
  <font color=#993300>subroutine </font><font color=#cc0000>gtdp</font> <A href='../../call_to/GTDP.html' TARGET='index'>1</A>,<A href='../../call_from/GTDP.html' TARGET='index'>1</A><a name='1420'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1421'></font>
<font color=#447700>!<a name='1422'></font>
<font color=#447700>! Subprogram: gtdp         Compute dewpoint temperature table<a name='1423'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1424'></font>
<font color=#447700>!<a name='1425'></font>
<font color=#447700>! Abstract: Compute dewpoint temperature table as a function of<a name='1426'></font>
<font color=#447700>!   vapor pressure for inlinable function ftdp.<a name='1427'></font>
<font color=#447700>!   Exact dewpoint temperatures are calculated in subprogram ftdpxg.<a name='1428'></font>
<font color=#447700>!   The current implementation computes a table with a length<a name='1429'></font>
<font color=#447700>!   of 5001 for vapor pressures ranging from 0.5 to 1000.5 Pascals<a name='1430'></font>
<font color=#447700>!   giving a dewpoint temperature range of 208 to 319 Kelvin.<a name='1431'></font>
<font color=#447700>!<a name='1432'></font>
<font color=#447700>! Program History Log:<a name='1433'></font>
<font color=#447700>!   91-05-07  Iredell<a name='1434'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='1435'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1436'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='1437'></font>
<font color=#447700>!<a name='1438'></font>
<font color=#447700>! Usage:  call gtdp<a name='1439'></font>
<font color=#447700>!<a name='1440'></font>
<font color=#447700>! Subprograms called:<a name='1441'></font>
<font color=#447700>!   (ftdpxg)   inlinable function to compute dewpoint temperature<a name='1442'></font>
<font color=#447700>!<a name='1443'></font>
<font color=#447700>! Attributes:<a name='1444'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1445'></font>
<font color=#447700>!<a name='1446'></font>
<font color=#447700>!$$$<a name='1447'></font>
    implicit none<a name='1448'>
    integer jx<a name='1449'>
    real(krealfp) xmin,xmax,xinc,t,x,pv<a name='1450'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1451'></font>
    xmin=0.5<a name='1452'>
    xmax=10000.5<a name='1453'>
    xinc=(xmax-xmin)/(nxtdp-1)<a name='1454'>
    c1xtdp=1.-xmin/xinc<a name='1455'>
    c2xtdp=1./xinc<a name='1456'>
    t=208.0<a name='1457'>
    do jx=1,nxtdp<a name='1458'>
      x=xmin+(jx-1)*xinc<a name='1459'>
      pv=x<a name='1460'>
      t=<A href='../../html_code/phys/module_shcu_grims.F.html#FTDPXG'>ftdpxg</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GTDP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FTDPXG_1">(t,pv)<a name='1461'>
      tbtdp(jx)=t<a name='1462'>
    enddo<a name='1463'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1464'></font>
  end subroutine<a name='1465'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1466'></font>
<font color=#447700>! elemental function ftdp(pv)<a name='1467'></font>
<A NAME='FTDP'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDP' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1468'>
  <font color=#993300>function </font><font color=#cc0000>ftdp</font>(pv) <A href='../../call_to/FTDP.html' TARGET='index'>1</A>,<A href='../../call_from/FTDP.html' TARGET='index'>1</A><a name='1469'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1470'></font>
<font color=#447700>!<a name='1471'></font>
<font color=#447700>! Subprogram: ftdp         Compute dewpoint temperature <a name='1472'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1473'></font>
<font color=#447700>!<a name='1474'></font>
<font color=#447700>! Abstract: Compute dewpoint temperature from vapor pressure.<a name='1475'></font>
<font color=#447700>!   A linear interpolation is done between values in a lookup table<a name='1476'></font>
<font color=#447700>!   computed in gtdp. See documentation for ftdpxg for details.<a name='1477'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='1478'></font>
<font color=#447700>!   The interpolation accuracy is better than 0.0005 Kelvin<a name='1479'></font>
<font color=#447700>!   for dewpoint temperatures greater than 250 Kelvin,<a name='1480'></font>
<font color=#447700>!   but decreases to 0.02 Kelvin for a dewpoint around 230 Kelvin.<a name='1481'></font>
<font color=#447700>!   On the Cray, ftdp is about 75 times faster than exact calculation.<a name='1482'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='1483'></font>
<font color=#447700>!<a name='1484'></font>
<font color=#447700>! Program History Log:<a name='1485'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1486'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='1487'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1488'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='1489'></font>
<font color=#447700>!<a name='1490'></font>
<font color=#447700>! Usage:   tdp=ftdp(pv)<a name='1491'></font>
<font color=#447700>!<a name='1492'></font>
<font color=#447700>!   Input argument list:<a name='1493'></font>
<font color=#447700>!     pv         Real(krealfp) vapor pressure in Pascals<a name='1494'></font>
<font color=#447700>!<a name='1495'></font>
<font color=#447700>!   Output argument list:<a name='1496'></font>
<font color=#447700>!     ftdp       Real(krealfp) dewpoint temperature in Kelvin<a name='1497'></font>
<font color=#447700>!<a name='1498'></font>
<font color=#447700>! Attributes:<a name='1499'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1500'></font>
<font color=#447700>!<a name='1501'></font>
<font color=#447700>!$$$<a name='1502'></font>
    implicit none<a name='1503'>
    real(krealfp) ftdp<a name='1504'>
    real(krealfp),intent(in):: pv<a name='1505'>
    integer jx<a name='1506'>
    real(krealfp) xj<a name='1507'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1508'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_shcu_grims.F.html#FTDP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_23">()<a name='1509'>
    xj=min(max(c1xtdp+c2xtdp*pv,1._krealfp),real(nxtdp,krealfp))<a name='1510'>
    jx=min(xj,nxtdp-1._krealfp)<a name='1511'>
    ftdp=tbtdp(jx)+(xj-jx)*(tbtdp(jx+1)-tbtdp(jx))<a name='1512'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1513'></font>
  end function<a name='1514'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1515'></font>
<font color=#447700>! elemental function ftdpq(pv)<a name='1516'></font>
<A NAME='FTDPQ'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPQ' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1517'>
  <font color=#993300>function </font><font color=#cc0000>ftdpq</font>(pv),<A href='../../call_from/FTDPQ.html' TARGET='index'>1</A><a name='1518'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1519'></font>
<font color=#447700>!<a name='1520'></font>
<font color=#447700>! Subprogram: ftdpq        Compute dewpoint temperature<a name='1521'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1522'></font>
<font color=#447700>!<a name='1523'></font>
<font color=#447700>! Abstract: Compute dewpoint temperature from vapor pressure.<a name='1524'></font>
<font color=#447700>!   A quadratic interpolation is done between values in a lookup table<a name='1525'></font>
<font color=#447700>!   computed in gtdp. see documentation for ftdpxg for details.<a name='1526'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='1527'></font>
<font color=#447700>!   the interpolation accuracy is better than 0.00001 Kelvin<a name='1528'></font>
<font color=#447700>!   for dewpoint temperatures greater than 250 Kelvin,<a name='1529'></font>
<font color=#447700>!   but decreases to 0.002 Kelvin for a dewpoint around 230 Kelvin.<a name='1530'></font>
<font color=#447700>!   On the Cray, ftdpq is about 60 times faster than exact calculation.<a name='1531'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='1532'></font>
<font color=#447700>!<a name='1533'></font>
<font color=#447700>! Program History Log:<a name='1534'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1535'></font>
<font color=#447700>!   94-12-30  Iredell             quadratic interpolation<a name='1536'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1537'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='1538'></font>
<font color=#447700>!<a name='1539'></font>
<font color=#447700>! Usage:   tdp=ftdpq(pv)<a name='1540'></font>
<font color=#447700>!<a name='1541'></font>
<font color=#447700>!   Input argument list:<a name='1542'></font>
<font color=#447700>!     pv         Real(krealfp) vapor pressure in Pascals<a name='1543'></font>
<font color=#447700>!<a name='1544'></font>
<font color=#447700>!   Output argument list:<a name='1545'></font>
<font color=#447700>!     ftdpq      Real(krealfp) dewpoint temperature in Kelvin<a name='1546'></font>
<font color=#447700>!<a name='1547'></font>
<font color=#447700>! Attributes:<a name='1548'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1549'></font>
<font color=#447700>!<a name='1550'></font>
<font color=#447700>!$$$<a name='1551'></font>
    implicit none<a name='1552'>
    real(krealfp) ftdpq<a name='1553'>
    real(krealfp),intent(in):: pv<a name='1554'>
    integer jx<a name='1555'>
    real(krealfp) xj,dxj,fj1,fj2,fj3<a name='1556'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1557'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_24">()<a name='1558'>
    xj=min(max(c1xtdp+c2xtdp*pv,1._krealfp),real(nxtdp,krealfp))<a name='1559'>
    jx=min(max(nint(xj),2),nxtdp-1)<a name='1560'>
    dxj=xj-jx<a name='1561'>
    fj1=tbtdp(jx-1)<a name='1562'>
    fj2=tbtdp(jx)<a name='1563'>
    fj3=tbtdp(jx+1)<a name='1564'>
    ftdpq=(((fj3+fj1)/2-fj2)*dxj+(fj3-fj1)/2)*dxj+fj2<a name='1565'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1566'></font>
  end function<a name='1567'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1568'></font>
<font color=#447700>! elemental function ftdpx(pv)<a name='1569'></font>
<A NAME='FTDPX'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPX' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1570'>
  <font color=#993300>function </font><font color=#cc0000>ftdpx</font>(pv),<A href='../../call_from/FTDPX.html' TARGET='index'>3</A><a name='1571'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1572'></font>
<font color=#447700>!<a name='1573'></font>
<font color=#447700>! Subprogram: ftdpx        Compute dewpoint temperature<a name='1574'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1575'></font>
<font color=#447700>!<a name='1576'></font>
<font color=#447700>! Abstract: exactly compute dewpoint temperature from vapor pressure.<a name='1577'></font>
<font color=#447700>!   An approximate dewpoint temperature for function ftdpxg<a name='1578'></font>
<font color=#447700>!   is obtained using ftdp so gtdp must be already called.<a name='1579'></font>
<font color=#447700>!   See documentation for ftdpxg for details.<a name='1580'></font>
<font color=#447700>!<a name='1581'></font>
<font color=#447700>! Program History Log:<a name='1582'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1583'></font>
<font color=#447700>!   94-12-30  Iredell             exact computation<a name='1584'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1585'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='1586'></font>
<font color=#447700>!<a name='1587'></font>
<font color=#447700>! Usage:   tdp=ftdpx(pv)<a name='1588'></font>
<font color=#447700>!<a name='1589'></font>
<font color=#447700>!   Input argument list:<a name='1590'></font>
<font color=#447700>!     pv         Real(krealfp) vapor pressure in Pascals<a name='1591'></font>
<font color=#447700>!<a name='1592'></font>
<font color=#447700>!   Output argument list:<a name='1593'></font>
<font color=#447700>!     ftdpx      Real(krealfp) dewpoint temperature in Kelvin<a name='1594'></font>
<font color=#447700>!<a name='1595'></font>
<font color=#447700>! Subprograms called:<a name='1596'></font>
<font color=#447700>!   (ftdp)     inlinable function to compute dewpoint temperature<a name='1597'></font>
<font color=#447700>!   (ftdpxg)   inlinable function to compute dewpoint temperature<a name='1598'></font>
<font color=#447700>!<a name='1599'></font>
<font color=#447700>! Attributes:<a name='1600'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1601'></font>
<font color=#447700>!<a name='1602'></font>
<font color=#447700>!$$$<a name='1603'></font>
    implicit none<a name='1604'>
    real(krealfp) ftdpx<a name='1605'>
    real(krealfp),intent(in):: pv<a name='1606'>
    real(krealfp) tg<a name='1607'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1608'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_25">()<a name='1609'>
    tg=<A href='../../html_code/phys/module_shcu_grims.F.html#FTDP'>ftdp</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FTDP_1">(pv)<a name='1610'>
    ftdpx=<A href='../../html_code/phys/module_shcu_grims.F.html#FTDPXG'>ftdpxg</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FTDPXG_2">(tg,pv)<a name='1611'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1612'></font>
  end function<a name='1613'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1614'></font>
<font color=#447700>! elemental function ftdpxg(tg,pv)<a name='1615'></font>
<A NAME='FTDPXG'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTDPXG' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1616'>
  <font color=#993300>function </font><font color=#cc0000>ftdpxg</font>(tg,pv) <A href='../../call_to/FTDPXG.html' TARGET='index'>3</A>,<A href='../../call_from/FTDPXG.html' TARGET='index'>1</A><a name='1617'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1618'></font>
<font color=#447700>!<a name='1619'></font>
<font color=#447700>! Subprogram: ftdpxg       Compute dewpoint temperature<a name='1620'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1621'></font>
<font color=#447700>!<a name='1622'></font>
<font color=#447700>! Abstract: Exactly compute dewpoint temperature from vapor pressure.<a name='1623'></font>
<font color=#447700>!   A guess dewpoint temperature must be provided.<a name='1624'></font>
<font color=#447700>!   The saturation vapor pressure over either liquid and ice is computed<a name='1625'></font>
<font color=#447700>!   over liquid for temperatures above the triple point,<a name='1626'></font>
<font color=#447700>!   over ice for temperatures 20 degress below the triple point,<a name='1627'></font>
<font color=#447700>!   and a linear combination of the two for temperatures in between.<a name='1628'></font>
<font color=#447700>!   The water model assumes a perfect gas, constant specific heats<a name='1629'></font>
<font color=#447700>!   for gas, liquid and ice, and neglects the volume of the condensate.<a name='1630'></font>
<font color=#447700>!   The model does account for the variation of the latent heat<a name='1631'></font>
<font color=#447700>!   of condensation and sublimation with temperature.<a name='1632'></font>
<font color=#447700>!   The Clausius-Clapeyron equation is integrated from the triple point<a name='1633'></font>
<font color=#447700>!   to get the formula<a name='1634'></font>
<font color=#447700>!       pvsl=con_psat*(tr**xa)*exp(xb*(1.-tr))<a name='1635'></font>
<font color=#447700>!   where tr is ttp/t and other values are physical constants.<a name='1636'></font>
<font color=#447700>!   The reference for this decision is Emanuel(1994), pages 116-117.<a name='1637'></font>
<font color=#447700>!   The formula is inverted by iterating Newtonian approximations<a name='1638'></font>
<font color=#447700>!   for each pvs until t is found to within 1.e-6 Kelvin.<a name='1639'></font>
<font color=#447700>!   This function can be expanded inline in the calling routine.<a name='1640'></font>
<font color=#447700>!<a name='1641'></font>
<font color=#447700>! Program History Log:<a name='1642'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1643'></font>
<font color=#447700>!   94-12-30  Iredell             exact computation<a name='1644'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1645'></font>
<font color=#447700>! 2001-02-26  Iredell             ice phase<a name='1646'></font>
<font color=#447700>!<a name='1647'></font>
<font color=#447700>! Usage:   tdp=ftdpxg(tg,pv)<a name='1648'></font>
<font color=#447700>!<a name='1649'></font>
<font color=#447700>!   Input argument list:<a name='1650'></font>
<font color=#447700>!     tg         Real(krealfp) guess dewpoint temperature in Kelvin<a name='1651'></font>
<font color=#447700>!     pv         Real(krealfp) vapor pressure in Pascals<a name='1652'></font>
<font color=#447700>!<a name='1653'></font>
<font color=#447700>!   Output argument list:<a name='1654'></font>
<font color=#447700>!     ftdpxg     Real(krealfp) dewpoint temperature in Kelvin<a name='1655'></font>
<font color=#447700>!<a name='1656'></font>
<font color=#447700>! Attributes:<a name='1657'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1658'></font>
<font color=#447700>!<a name='1659'></font>
<font color=#447700>!$$$<a name='1660'></font>
    implicit none<a name='1661'>
    real(krealfp) ftdpxg<a name='1662'>
    real(krealfp),intent(in):: tg,pv<a name='1663'>
    real(krealfp),parameter:: terrm=1.e-6<a name='1664'>
    real(krealfp),parameter:: tliq=con_ttp<a name='1665'>
    real(krealfp),parameter:: tice=con_ttp-20.0<a name='1666'>
    real(krealfp),parameter:: dldtl=con_cvap-con_cliq<a name='1667'>
    real(krealfp),parameter:: heatl=con_hvap<a name='1668'>
    real(krealfp),parameter:: xponal=-dldtl/con_rv<a name='1669'>
    real(krealfp),parameter:: xponbl=-dldtl/con_rv+heatl/(con_rv*con_ttp)<a name='1670'>
    real(krealfp),parameter:: dldti=con_cvap-con_csol<a name='1671'>
    real(krealfp),parameter:: heati=con_hvap+con_hfus<a name='1672'>
    real(krealfp),parameter:: xponai=-dldti/con_rv<a name='1673'>
    real(krealfp),parameter:: xponbi=-dldti/con_rv+heati/(con_rv*con_ttp)<a name='1674'>
    real(krealfp) t,tr,w,pvtl,pvti,pvt,ell,eli,el,dpvt,terr<a name='1675'>
    integer i<a name='1676'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1677'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_shcu_grims.F.html#FTDPXG' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_26">()<a name='1678'>
    t=tg<a name='1679'>
    do i=1,100<a name='1680'>
      tr=con_ttp/t<a name='1681'>
      if(t.ge.tliq) then<a name='1682'>
        pvt=con_psat*(tr**xponal)*exp(xponbl*(1.-tr))<a name='1683'>
        el=heatl+dldtl*(t-con_ttp)<a name='1684'>
        dpvt=el*pvt/(con_rv*t**2)<a name='1685'>
      elseif(t.lt.tice) then<a name='1686'>
        pvt=con_psat*(tr**xponai)*exp(xponbi*(1.-tr))<a name='1687'>
        el=heati+dldti*(t-con_ttp)<a name='1688'>
        dpvt=el*pvt/(con_rv*t**2)<a name='1689'>
      else<a name='1690'>
        w=(t-tice)/(tliq-tice)<a name='1691'>
        pvtl=con_psat*(tr**xponal)*exp(xponbl*(1.-tr))<a name='1692'>
        pvti=con_psat*(tr**xponai)*exp(xponbi*(1.-tr))<a name='1693'>
        pvt=w*pvtl+(1.-w)*pvti<a name='1694'>
        ell=heatl+dldtl*(t-con_ttp)<a name='1695'>
        eli=heati+dldti*(t-con_ttp)<a name='1696'>
        dpvt=(w*ell*pvtl+(1.-w)*eli*pvti)/(con_rv*t**2)<a name='1697'>
      endif<a name='1698'>
      terr=(pvt-pv)/dpvt<a name='1699'>
      t=t-terr<a name='1700'>
      if(abs(terr).le.terrm) exit<a name='1701'>
    enddo<a name='1702'>
    ftdpxg=t<a name='1703'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1704'></font>
  end function<a name='1705'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1706'></font>
<A NAME='GTHE'><A href='../../html_code/phys/module_gfs_funcphys.F.html#GTHE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1707'>
  <font color=#993300>subroutine </font><font color=#cc0000>gthe</font> <A href='../../call_to/GTHE.html' TARGET='index'>1</A>,<A href='../../call_from/GTHE.html' TARGET='index'>1</A><a name='1708'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1709'></font>
<font color=#447700>!<a name='1710'></font>
<font color=#447700>! Subprogram: gthe        Compute equivalent potential temperature table<a name='1711'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1712'></font>
<font color=#447700>!<a name='1713'></font>
<font color=#447700>! Abstract: Compute equivalent potential temperature table<a name='1714'></font>
<font color=#447700>!   as a function of LCL temperature and pressure over 1e5 Pa<a name='1715'></font>
<font color=#447700>!   to the kappa power for function fthe.<a name='1716'></font>
<font color=#447700>!   Equivalent potential temperatures are calculated in subprogram fthex<a name='1717'></font>
<font color=#447700>!   the current implementation computes a table with a first dimension<a name='1718'></font>
<font color=#447700>!   of 241 for temperatures ranging from 183.16 to 303.16 Kelvin<a name='1719'></font>
<font color=#447700>!   and a second dimension of 151 for pressure over 1e5 Pa<a name='1720'></font>
<font color=#447700>!   to the kappa power ranging from 0.04**rocp to 1.10**rocp.<a name='1721'></font>
<font color=#447700>!<a name='1722'></font>
<font color=#447700>! Program History Log:<a name='1723'></font>
<font color=#447700>!   91-05-07  Iredell<a name='1724'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='1725'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1726'></font>
<font color=#447700>!<a name='1727'></font>
<font color=#447700>! Usage:  call gthe<a name='1728'></font>
<font color=#447700>!<a name='1729'></font>
<font color=#447700>! Subprograms called:<a name='1730'></font>
<font color=#447700>!   (fthex)    inlinable function to compute equiv. pot. temperature<a name='1731'></font>
<font color=#447700>!<a name='1732'></font>
<font color=#447700>! Attributes:<a name='1733'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1734'></font>
<font color=#447700>!<a name='1735'></font>
<font color=#447700>!$$$<a name='1736'></font>
    implicit none<a name='1737'>
    integer jx,jy<a name='1738'>
    real(krealfp) xmin,xmax,ymin,ymax,xinc,yinc,x,y,pk,t<a name='1739'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1740'></font>
    xmin=con_ttp-90._krealfp<a name='1741'>
    xmax=con_ttp+30._krealfp<a name='1742'>
    ymin=0.04_krealfp**con_rocp<a name='1743'>
    ymax=1.10_krealfp**con_rocp<a name='1744'>
    xinc=(xmax-xmin)/(nxthe-1)<a name='1745'>
    c1xthe=1.-xmin/xinc<a name='1746'>
    c2xthe=1./xinc<a name='1747'>
    yinc=(ymax-ymin)/(nythe-1)<a name='1748'>
    c1ythe=1.-ymin/yinc<a name='1749'>
    c2ythe=1./yinc<a name='1750'>
    do jy=1,nythe<a name='1751'>
      y=ymin+(jy-1)*yinc<a name='1752'>
      pk=y<a name='1753'>
      do jx=1,nxthe<a name='1754'>
        x=xmin+(jx-1)*xinc<a name='1755'>
        t=x<a name='1756'>
        tbthe(jx,jy)=<A href='../../html_code/phys/module_shcu_grims.F.html#FTHEX'>fthex</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GTHE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FTHEX_1">(t,pk)<a name='1757'>
      enddo<a name='1758'>
    enddo<a name='1759'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1760'></font>
  end subroutine<a name='1761'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1762'></font>
<font color=#447700>! elemental function fthe(t,pk)<a name='1763'></font>
<A NAME='FTHE'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTHE' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1764'>
  <font color=#993300>function </font><font color=#cc0000>fthe</font>(t,pk) <A href='../../call_to/FTHE.html' TARGET='index'>3</A>,<A href='../../call_from/FTHE.html' TARGET='index'>1</A><a name='1765'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1766'></font>
<font color=#447700>!<a name='1767'></font>
<font color=#447700>! Subprogram: fthe         Compute equivalent potential temperature<a name='1768'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1769'></font>
<font color=#447700>!<a name='1770'></font>
<font color=#447700>! Abstract: Compute equivalent potential temperature at the LCL<a name='1771'></font>
<font color=#447700>!   from temperature and pressure over 1e5 Pa to the kappa power.<a name='1772'></font>
<font color=#447700>!   A bilinear interpolation is done between values in a lookup table<a name='1773'></font>
<font color=#447700>!   computed in gthe. see documentation for fthex for details.<a name='1774'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema,<a name='1775'></font>
<font color=#447700>!   except zero is returned for too cold or high LCLs.<a name='1776'></font>
<font color=#447700>!   The interpolation accuracy is better than 0.01 Kelvin.<a name='1777'></font>
<font color=#447700>!   On the Cray, fthe is almost 6 times faster than exact calculation.<a name='1778'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='1779'></font>
<font color=#447700>!<a name='1780'></font>
<font color=#447700>! Program History Log:<a name='1781'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1782'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='1783'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1784'></font>
<font color=#447700>!<a name='1785'></font>
<font color=#447700>! Usage:   the=fthe(t,pk)<a name='1786'></font>
<font color=#447700>!<a name='1787'></font>
<font color=#447700>!   Input argument list:<a name='1788'></font>
<font color=#447700>!     t          Real(krealfp) LCL temperature in Kelvin<a name='1789'></font>
<font color=#447700>!     pk         Real(krealfp) LCL pressure over 1e5 Pa to the kappa power<a name='1790'></font>
<font color=#447700>!<a name='1791'></font>
<font color=#447700>!   Output argument list:<a name='1792'></font>
<font color=#447700>!     fthe       Real(krealfp) equivalent potential temperature in Kelvin<a name='1793'></font>
<font color=#447700>!<a name='1794'></font>
<font color=#447700>! Attributes:<a name='1795'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1796'></font>
<font color=#447700>!<a name='1797'></font>
<font color=#447700>!$$$<a name='1798'></font>
    implicit none<a name='1799'>
    real(krealfp) fthe<a name='1800'>
    real(krealfp),intent(in):: t,pk<a name='1801'>
    integer jx,jy<a name='1802'>
    real(krealfp) xj,yj,ftx1,ftx2<a name='1803'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1804'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_shcu_grims.F.html#FTHE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_27">()<a name='1805'>
    xj=min(c1xthe+c2xthe*t,real(nxthe,krealfp))<a name='1806'>
    yj=min(c1ythe+c2ythe*pk,real(nythe,krealfp))<a name='1807'>
    if(xj.ge.1..and.yj.ge.1.) then<a name='1808'>
      jx=min(xj,nxthe-1._krealfp)<a name='1809'>
      jy=min(yj,nythe-1._krealfp)<a name='1810'>
      ftx1=tbthe(jx,jy)+(xj-jx)*(tbthe(jx+1,jy)-tbthe(jx,jy))<a name='1811'>
      ftx2=tbthe(jx,jy+1)+(xj-jx)*(tbthe(jx+1,jy+1)-tbthe(jx,jy+1))<a name='1812'>
      fthe=ftx1+(yj-jy)*(ftx2-ftx1)<a name='1813'>
    else<a name='1814'>
      fthe=0.<a name='1815'>
    endif<a name='1816'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1817'></font>
  end function<a name='1818'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1819'></font>
<font color=#447700>! elemental function ftheq(t,pk)<a name='1820'></font>
<A NAME='FTHEQ'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTHEQ' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1821'>
  <font color=#993300>function </font><font color=#cc0000>ftheq</font>(t,pk),<A href='../../call_from/FTHEQ.html' TARGET='index'>1</A><a name='1822'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1823'></font>
<font color=#447700>!<a name='1824'></font>
<font color=#447700>! Subprogram: ftheq        Compute equivalent potential temperature<a name='1825'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1826'></font>
<font color=#447700>!<a name='1827'></font>
<font color=#447700>! Abstract: Compute equivalent potential temperature at the LCL<a name='1828'></font>
<font color=#447700>!   from temperature and pressure over 1e5 Pa to the kappa power.<a name='1829'></font>
<font color=#447700>!   A biquadratic interpolation is done between values in a lookup table<a name='1830'></font>
<font color=#447700>!   computed in gthe. see documentation for fthex for details.<a name='1831'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema,<a name='1832'></font>
<font color=#447700>!   except zero is returned for too cold or high LCLs.<a name='1833'></font>
<font color=#447700>!   The interpolation accuracy is better than 0.0002 Kelvin.<a name='1834'></font>
<font color=#447700>!   On the Cray, ftheq is almost 3 times faster than exact calculation.<a name='1835'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='1836'></font>
<font color=#447700>!<a name='1837'></font>
<font color=#447700>! Program History Log:<a name='1838'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1839'></font>
<font color=#447700>!   94-12-30  Iredell             quadratic interpolation<a name='1840'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1841'></font>
<font color=#447700>!<a name='1842'></font>
<font color=#447700>! Usage:   the=ftheq(t,pk)<a name='1843'></font>
<font color=#447700>!<a name='1844'></font>
<font color=#447700>!   Input argument list:<a name='1845'></font>
<font color=#447700>!     t          Real(krealfp) LCL temperature in Kelvin<a name='1846'></font>
<font color=#447700>!     pk         Real(krealfp) LCL pressure over 1e5 Pa to the kappa power<a name='1847'></font>
<font color=#447700>!<a name='1848'></font>
<font color=#447700>!   Output argument list:<a name='1849'></font>
<font color=#447700>!     ftheq      Real(krealfp) equivalent potential temperature in Kelvin<a name='1850'></font>
<font color=#447700>!<a name='1851'></font>
<font color=#447700>! Attributes:<a name='1852'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1853'></font>
<font color=#447700>!<a name='1854'></font>
<font color=#447700>!$$$<a name='1855'></font>
    implicit none<a name='1856'>
    real(krealfp) ftheq<a name='1857'>
    real(krealfp),intent(in):: t,pk<a name='1858'>
    integer jx,jy<a name='1859'>
    real(krealfp) xj,yj,dxj,dyj<a name='1860'>
    real(krealfp) ft11,ft12,ft13,ft21,ft22,ft23,ft31,ft32,ft33<a name='1861'>
    real(krealfp) ftx1,ftx2,ftx3<a name='1862'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1863'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTHEQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_28">()<a name='1864'>
    xj=min(c1xthe+c2xthe*t,real(nxthe,krealfp))<a name='1865'>
    yj=min(c1ythe+c2ythe*pk,real(nythe,krealfp))<a name='1866'>
    if(xj.ge.1..and.yj.ge.1.) then<a name='1867'>
      jx=min(max(nint(xj),2),nxthe-1)<a name='1868'>
      jy=min(max(nint(yj),2),nythe-1)<a name='1869'>
      dxj=xj-jx<a name='1870'>
      dyj=yj-jy<a name='1871'>
      ft11=tbthe(jx-1,jy-1)<a name='1872'>
      ft12=tbthe(jx-1,jy)<a name='1873'>
      ft13=tbthe(jx-1,jy+1)<a name='1874'>
      ft21=tbthe(jx,jy-1)<a name='1875'>
      ft22=tbthe(jx,jy)<a name='1876'>
      ft23=tbthe(jx,jy+1)<a name='1877'>
      ft31=tbthe(jx+1,jy-1)<a name='1878'>
      ft32=tbthe(jx+1,jy)<a name='1879'>
      ft33=tbthe(jx+1,jy+1)<a name='1880'>
      ftx1=(((ft31+ft11)/2-ft21)*dxj+(ft31-ft11)/2)*dxj+ft21<a name='1881'>
      ftx2=(((ft32+ft12)/2-ft22)*dxj+(ft32-ft12)/2)*dxj+ft22<a name='1882'>
      ftx3=(((ft33+ft13)/2-ft23)*dxj+(ft33-ft13)/2)*dxj+ft23<a name='1883'>
      ftheq=(((ftx3+ftx1)/2-ftx2)*dyj+(ftx3-ftx1)/2)*dyj+ftx2<a name='1884'>
    else<a name='1885'>
      ftheq=0.<a name='1886'>
    endif<a name='1887'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1888'></font>
  end function<a name='1889'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1890'></font>
<font color=#447700>! elemental function fthex(t,pk)<a name='1891'></font>
<A NAME='FTHEX'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTHEX' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='1892'>
            <font color=#993300>function </font><font color=#cc0000>fthex</font>(t,pk) <A href='../../call_to/FTHEX.html' TARGET='index'>2</A>,<A href='../../call_from/FTHEX.html' TARGET='index'>1</A><a name='1893'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1894'></font>
<font color=#447700>!<a name='1895'></font>
<font color=#447700>! Subprogram: fthex        Compute equivalent potential temperature<a name='1896'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1897'></font>
<font color=#447700>!<a name='1898'></font>
<font color=#447700>! Abstract: Exactly compute equivalent potential temperature at the LCL<a name='1899'></font>
<font color=#447700>!   from temperature and pressure over 1e5 Pa to the kappa power.<a name='1900'></font>
<font color=#447700>!   Equivalent potential temperature is constant for a saturated parcel<a name='1901'></font>
<font color=#447700>!   rising adiabatically up a moist adiabat when the heat and mass<a name='1902'></font>
<font color=#447700>!   of the condensed water are neglected.  Ice is also neglected.<a name='1903'></font>
<font color=#447700>!   The formula for equivalent potential temperature (Holton) is<a name='1904'></font>
<font color=#447700>!       the=t*(pd**(-rocp))*exp(el*eps*pv/(cp*t*pd))<a name='1905'></font>
<font color=#447700>!   where t is the temperature, pv is the saturated vapor pressure,<a name='1906'></font>
<font color=#447700>!   pd is the dry pressure p-pv, el is the temperature dependent<a name='1907'></font>
<font color=#447700>!   latent heat of condensation hvap+dldt*(t-ttp), and other values<a name='1908'></font>
<font color=#447700>!   are physical constants defined in parameter statements in the code.<a name='1909'></font>
<font color=#447700>!   Zero is returned if the input values make saturation impossible.<a name='1910'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='1911'></font>
<font color=#447700>!<a name='1912'></font>
<font color=#447700>! Program History Log:<a name='1913'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='1914'></font>
<font color=#447700>!   94-12-30  Iredell             exact computation<a name='1915'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1916'></font>
<font color=#447700>!<a name='1917'></font>
<font color=#447700>! Usage:   the=fthex(t,pk)<a name='1918'></font>
<font color=#447700>!<a name='1919'></font>
<font color=#447700>!   Input argument list:<a name='1920'></font>
<font color=#447700>!     t          Real(krealfp) LCL temperature in Kelvin<a name='1921'></font>
<font color=#447700>!     pk         Real(krealfp) LCL pressure over 1e5 Pa to the kappa power<a name='1922'></font>
<font color=#447700>!<a name='1923'></font>
<font color=#447700>!   Output argument list:<a name='1924'></font>
<font color=#447700>!     fthex      Real(krealfp) equivalent potential temperature in Kelvin<a name='1925'></font>
<font color=#447700>!<a name='1926'></font>
<font color=#447700>! Attributes:<a name='1927'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1928'></font>
<font color=#447700>!<a name='1929'></font>
<font color=#447700>!$$$<a name='1930'></font>
    implicit none<a name='1931'>
    real(krealfp) fthex<a name='1932'>
    real(krealfp),intent(in):: t,pk<a name='1933'>
    real(krealfp) p,tr,pv,pd,el,expo,expmax<a name='1934'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1935'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_shcu_grims.F.html#FTHEX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_29">()<a name='1936'>
    p=pk**con_cpor<a name='1937'>
    tr=con_ttp/t<a name='1938'>
    pv=psatb*(tr**con_xpona)*exp(con_xponb*(1.-tr))<a name='1939'>
    pd=p-pv<a name='1940'>
    if(pd.gt.pv) then<a name='1941'>
      el=con_hvap+con_dldt*(t-con_ttp)<a name='1942'>
      expo=el*con_eps*pv/(con_cp*t*pd)<a name='1943'>
      fthex=t*pd**(-con_rocp)*exp(expo)<a name='1944'>
    else<a name='1945'>
      fthex=0.<a name='1946'>
    endif<a name='1947'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1948'></font>
  end function<a name='1949'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='1950'></font>
<A NAME='GTMA'><A href='../../html_code/phys/module_gfs_funcphys.F.html#GTMA' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1951'>
  <font color=#993300>subroutine </font><font color=#cc0000>gtma</font> <A href='../../call_to/GTMA.html' TARGET='index'>1</A>,<A href='../../call_from/GTMA.html' TARGET='index'>1</A><a name='1952'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='1953'></font>
<font color=#447700>!<a name='1954'></font>
<font color=#447700>! Subprogram: gtma         Compute moist adiabat tables<a name='1955'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='1956'></font>
<font color=#447700>!<a name='1957'></font>
<font color=#447700>! Abstract: Compute temperature and specific humidity tables<a name='1958'></font>
<font color=#447700>!   as a function of equivalent potential temperature and<a name='1959'></font>
<font color=#447700>!   pressure over 1e5 Pa to the kappa power for subprogram stma.<a name='1960'></font>
<font color=#447700>!   Exact parcel temperatures are calculated in subprogram stmaxg.<a name='1961'></font>
<font color=#447700>!   The current implementation computes a table with a first dimension<a name='1962'></font>
<font color=#447700>!   of 151 for equivalent potential temperatures ranging from 200 to 500<a name='1963'></font>
<font color=#447700>!   Kelvin and a second dimension of 121 for pressure over 1e5 Pa<a name='1964'></font>
<font color=#447700>!   to the kappa power ranging from 0.01**rocp to 1.10**rocp.<a name='1965'></font>
<font color=#447700>!<a name='1966'></font>
<font color=#447700>! Program History Log:<a name='1967'></font>
<font color=#447700>!   91-05-07  Iredell<a name='1968'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='1969'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='1970'></font>
<font color=#447700>!<a name='1971'></font>
<font color=#447700>! Usage:  call gtma<a name='1972'></font>
<font color=#447700>!<a name='1973'></font>
<font color=#447700>! Subprograms called:<a name='1974'></font>
<font color=#447700>!   (stmaxg)   inlinable subprogram to compute parcel temperature<a name='1975'></font>
<font color=#447700>!<a name='1976'></font>
<font color=#447700>! Attributes:<a name='1977'></font>
<font color=#447700>!   Language: Fortran 90.<a name='1978'></font>
<font color=#447700>!<a name='1979'></font>
<font color=#447700>!$$$<a name='1980'></font>
    implicit none<a name='1981'>
    integer jx,jy<a name='1982'>
    real(krealfp) xmin,xmax,ymin,ymax,xinc,yinc,x,y,pk,the,t,q,tg<a name='1983'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='1984'></font>
    xmin=200._krealfp<a name='1985'>
    xmax=500._krealfp<a name='1986'>
    ymin=0.01_krealfp**con_rocp<a name='1987'>
    ymax=1.10_krealfp**con_rocp<a name='1988'>
    xinc=(xmax-xmin)/(nxma-1)<a name='1989'>
    c1xma=1.-xmin/xinc<a name='1990'>
    c2xma=1./xinc<a name='1991'>
    yinc=(ymax-ymin)/(nyma-1)<a name='1992'>
    c1yma=1.-ymin/yinc<a name='1993'>
    c2yma=1./yinc<a name='1994'>
    do jy=1,nyma<a name='1995'>
      y=ymin+(jy-1)*yinc<a name='1996'>
      pk=y<a name='1997'>
      tg=xmin*y<a name='1998'>
      do jx=1,nxma<a name='1999'>
        x=xmin+(jx-1)*xinc<a name='2000'>
        the=x<a name='2001'>
        call <A href='../../html_code/phys/module_gfs_funcphys.F.html#STMAXG'>stmaxg</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GTMA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="STMAXG_1">(tg,the,pk,t,q)<a name='2002'>
        tbtma(jx,jy)=t<a name='2003'>
        tbqma(jx,jy)=q<a name='2004'>
        tg=t<a name='2005'>
      enddo<a name='2006'>
    enddo<a name='2007'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2008'></font>
  end subroutine<a name='2009'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2010'></font>
<font color=#447700>! elemental subroutine stma(the,pk,tma,qma)<a name='2011'></font>
<A NAME='STMA'><A href='../../html_code/phys/module_gfs_funcphys.F.html#STMA' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2012'>
  <font color=#993300>subroutine </font><font color=#cc0000>stma</font>(the,pk,tma,qma) <A href='../../call_to/STMA.html' TARGET='index'>3</A>,<A href='../../call_from/STMA.html' TARGET='index'>1</A><a name='2013'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='2014'></font>
<font color=#447700>!<a name='2015'></font>
<font color=#447700>! Subprogram: stma         Compute moist adiabat temperature<a name='2016'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='2017'></font>
<font color=#447700>!<a name='2018'></font>
<font color=#447700>! Abstract: Compute temperature and specific humidity of a parcel<a name='2019'></font>
<font color=#447700>!   lifted up a moist adiabat from equivalent potential temperature<a name='2020'></font>
<font color=#447700>!   at the LCL and pressure over 1e5 Pa to the kappa power.<a name='2021'></font>
<font color=#447700>!   Bilinear interpolations are done between values in a lookup table<a name='2022'></font>
<font color=#447700>!   computed in gtma. See documentation for stmaxg for details.<a name='2023'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='2024'></font>
<font color=#447700>!   The interpolation accuracy is better than 0.01 Kelvin<a name='2025'></font>
<font color=#447700>!   and 5.e-6 kg/kg for temperature and humidity, respectively.<a name='2026'></font>
<font color=#447700>!   On the Cray, stma is about 35 times faster than exact calculation.<a name='2027'></font>
<font color=#447700>!   This subprogram should be expanded inline in the calling routine.<a name='2028'></font>
<font color=#447700>!<a name='2029'></font>
<font color=#447700>! Program History Log:<a name='2030'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='2031'></font>
<font color=#447700>!   94-12-30  Iredell             expand table<a name='2032'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2033'></font>
<font color=#447700>!<a name='2034'></font>
<font color=#447700>! Usage:  call stma(the,pk,tma,qma)<a name='2035'></font>
<font color=#447700>!<a name='2036'></font>
<font color=#447700>!   Input argument list:<a name='2037'></font>
<font color=#447700>!     the        Real(krealfp) equivalent potential temperature in Kelvin<a name='2038'></font>
<font color=#447700>!     pk         Real(krealfp) pressure over 1e5 Pa to the kappa power<a name='2039'></font>
<font color=#447700>!<a name='2040'></font>
<font color=#447700>!   Output argument list:<a name='2041'></font>
<font color=#447700>!     tma        Real(krealfp) parcel temperature in Kelvin<a name='2042'></font>
<font color=#447700>!     qma        Real(krealfp) parcel specific humidity in kg/kg<a name='2043'></font>
<font color=#447700>!<a name='2044'></font>
<font color=#447700>! Attributes:<a name='2045'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2046'></font>
<font color=#447700>!<a name='2047'></font>
<font color=#447700>!$$$<a name='2048'></font>
    implicit none<a name='2049'>
    real(krealfp),intent(in):: the,pk<a name='2050'>
    real(krealfp),intent(out):: tma,qma<a name='2051'>
    integer jx,jy<a name='2052'>
    real(krealfp) xj,yj,ftx1,ftx2,qx1,qx2<a name='2053'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2054'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#STMA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_30">()<a name='2055'>
    xj=min(max(c1xma+c2xma*the,1._krealfp),real(nxma,krealfp))<a name='2056'>
    yj=min(max(c1yma+c2yma*pk,1._krealfp),real(nyma,krealfp))<a name='2057'>
    jx=min(xj,nxma-1._krealfp)<a name='2058'>
    jy=min(yj,nyma-1._krealfp)<a name='2059'>
    ftx1=tbtma(jx,jy)+(xj-jx)*(tbtma(jx+1,jy)-tbtma(jx,jy))<a name='2060'>
    ftx2=tbtma(jx,jy+1)+(xj-jx)*(tbtma(jx+1,jy+1)-tbtma(jx,jy+1))<a name='2061'>
    tma=ftx1+(yj-jy)*(ftx2-ftx1)<a name='2062'>
    qx1=tbqma(jx,jy)+(xj-jx)*(tbqma(jx+1,jy)-tbqma(jx,jy))<a name='2063'>
    qx2=tbqma(jx,jy+1)+(xj-jx)*(tbqma(jx+1,jy+1)-tbqma(jx,jy+1))<a name='2064'>
    qma=qx1+(yj-jy)*(qx2-qx1)<a name='2065'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2066'></font>
  end subroutine<a name='2067'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2068'></font>
<font color=#447700>! elemental subroutine stmaq(the,pk,tma,qma)<a name='2069'></font>
<A NAME='STMAQ'><A href='../../html_code/phys/module_gfs_funcphys.F.html#STMAQ' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2070'>
  <font color=#993300>subroutine </font><font color=#cc0000>stmaq</font>(the,pk,tma,qma),<A href='../../call_from/STMAQ.html' TARGET='index'>1</A><a name='2071'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='2072'></font>
<font color=#447700>!<a name='2073'></font>
<font color=#447700>! Subprogram: stmaq        Compute moist adiabat temperature<a name='2074'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='2075'></font>
<font color=#447700>!<a name='2076'></font>
<font color=#447700>! Abstract: Compute temperature and specific humidity of a parcel<a name='2077'></font>
<font color=#447700>!   lifted up a moist adiabat from equivalent potential temperature<a name='2078'></font>
<font color=#447700>!   at the LCL and pressure over 1e5 Pa to the kappa power.<a name='2079'></font>
<font color=#447700>!   Biquadratic interpolations are done between values in a lookup table<a name='2080'></font>
<font color=#447700>!   computed in gtma. See documentation for stmaxg for details.<a name='2081'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='2082'></font>
<font color=#447700>!   the interpolation accuracy is better than 0.0005 Kelvin<a name='2083'></font>
<font color=#447700>!   and 1.e-7 kg/kg for temperature and humidity, respectively.<a name='2084'></font>
<font color=#447700>!   On the Cray, stmaq is about 25 times faster than exact calculation.<a name='2085'></font>
<font color=#447700>!   This subprogram should be expanded inline in the calling routine.<a name='2086'></font>
<font color=#447700>!<a name='2087'></font>
<font color=#447700>! Program History Log:<a name='2088'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='2089'></font>
<font color=#447700>!   94-12-30  Iredell             quadratic interpolation<a name='2090'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2091'></font>
<font color=#447700>!<a name='2092'></font>
<font color=#447700>! Usage:  call stmaq(the,pk,tma,qma)<a name='2093'></font>
<font color=#447700>!<a name='2094'></font>
<font color=#447700>!   Input argument list:<a name='2095'></font>
<font color=#447700>!     the        Real(krealfp) equivalent potential temperature in Kelvin<a name='2096'></font>
<font color=#447700>!     pk         Real(krealfp) pressure over 1e5 Pa to the kappa power<a name='2097'></font>
<font color=#447700>!<a name='2098'></font>
<font color=#447700>!   Output argument list:<a name='2099'></font>
<font color=#447700>!     tmaq       Real(krealfp) parcel temperature in Kelvin<a name='2100'></font>
<font color=#447700>!     qma        Real(krealfp) parcel specific humidity in kg/kg<a name='2101'></font>
<font color=#447700>!<a name='2102'></font>
<font color=#447700>! Attributes:<a name='2103'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2104'></font>
<font color=#447700>!<a name='2105'></font>
<font color=#447700>!$$$<a name='2106'></font>
    implicit none<a name='2107'>
    real(krealfp),intent(in):: the,pk<a name='2108'>
    real(krealfp),intent(out):: tma,qma<a name='2109'>
    integer jx,jy<a name='2110'>
    real(krealfp) xj,yj,dxj,dyj<a name='2111'>
    real(krealfp) ft11,ft12,ft13,ft21,ft22,ft23,ft31,ft32,ft33<a name='2112'>
    real(krealfp) ftx1,ftx2,ftx3<a name='2113'>
    real(krealfp) q11,q12,q13,q21,q22,q23,q31,q32,q33,qx1,qx2,qx3<a name='2114'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2115'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#STMAQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_31">()<a name='2116'>
    xj=min(max(c1xma+c2xma*the,1._krealfp),real(nxma,krealfp))<a name='2117'>
    yj=min(max(c1yma+c2yma*pk,1._krealfp),real(nyma,krealfp))<a name='2118'>
    jx=min(max(nint(xj),2),nxma-1)<a name='2119'>
    jy=min(max(nint(yj),2),nyma-1)<a name='2120'>
    dxj=xj-jx<a name='2121'>
    dyj=yj-jy<a name='2122'>
    ft11=tbtma(jx-1,jy-1)<a name='2123'>
    ft12=tbtma(jx-1,jy)<a name='2124'>
    ft13=tbtma(jx-1,jy+1)<a name='2125'>
    ft21=tbtma(jx,jy-1)<a name='2126'>
    ft22=tbtma(jx,jy)<a name='2127'>
    ft23=tbtma(jx,jy+1)<a name='2128'>
    ft31=tbtma(jx+1,jy-1)<a name='2129'>
    ft32=tbtma(jx+1,jy)<a name='2130'>
    ft33=tbtma(jx+1,jy+1)<a name='2131'>
    ftx1=(((ft31+ft11)/2-ft21)*dxj+(ft31-ft11)/2)*dxj+ft21<a name='2132'>
    ftx2=(((ft32+ft12)/2-ft22)*dxj+(ft32-ft12)/2)*dxj+ft22<a name='2133'>
    ftx3=(((ft33+ft13)/2-ft23)*dxj+(ft33-ft13)/2)*dxj+ft23<a name='2134'>
    tma=(((ftx3+ftx1)/2-ftx2)*dyj+(ftx3-ftx1)/2)*dyj+ftx2<a name='2135'>
    q11=tbqma(jx-1,jy-1)<a name='2136'>
    q12=tbqma(jx-1,jy)<a name='2137'>
    q13=tbqma(jx-1,jy+1)<a name='2138'>
    q21=tbqma(jx,jy-1)<a name='2139'>
    q22=tbqma(jx,jy)<a name='2140'>
    q23=tbqma(jx,jy+1)<a name='2141'>
    q31=tbqma(jx+1,jy-1)<a name='2142'>
    q32=tbqma(jx+1,jy)<a name='2143'>
    q33=tbqma(jx+1,jy+1)<a name='2144'>
    qx1=(((q31+q11)/2-q21)*dxj+(q31-q11)/2)*dxj+q21<a name='2145'>
    qx2=(((q32+q12)/2-q22)*dxj+(q32-q12)/2)*dxj+q22<a name='2146'>
    qx3=(((q33+q13)/2-q23)*dxj+(q33-q13)/2)*dxj+q23<a name='2147'>
    qma=(((qx3+qx1)/2-qx2)*dyj+(qx3-qx1)/2)*dyj+qx2<a name='2148'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2149'></font>
  end subroutine<a name='2150'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2151'></font>
<font color=#447700>! elemental subroutine stmax(the,pk,tma,qma)<a name='2152'></font>
<A NAME='STMAX'><A href='../../html_code/phys/module_gfs_funcphys.F.html#STMAX' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2153'>
  <font color=#993300>subroutine </font><font color=#cc0000>stmax</font>(the,pk,tma,qma),<A href='../../call_from/STMAX.html' TARGET='index'>3</A><a name='2154'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='2155'></font>
<font color=#447700>!<a name='2156'></font>
<font color=#447700>! Subprogram: stmax        Compute moist adiabat temperature<a name='2157'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='2158'></font>
<font color=#447700>!<a name='2159'></font>
<font color=#447700>! Abstract: Exactly compute temperature and humidity of a parcel<a name='2160'></font>
<font color=#447700>!   lifted up a moist adiabat from equivalent potential temperature<a name='2161'></font>
<font color=#447700>!   at the LCL and pressure over 1e5 Pa to the kappa power.<a name='2162'></font>
<font color=#447700>!   An approximate parcel temperature for subprogram stmaxg<a name='2163'></font>
<font color=#447700>!   is obtained using stma so gtma must be already called.<a name='2164'></font>
<font color=#447700>!   See documentation for stmaxg for details.<a name='2165'></font>
<font color=#447700>!<a name='2166'></font>
<font color=#447700>! Program History Log:<a name='2167'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='2168'></font>
<font color=#447700>!   94-12-30  Iredell             exact computation<a name='2169'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2170'></font>
<font color=#447700>!<a name='2171'></font>
<font color=#447700>! Usage:  call stmax(the,pk,tma,qma)<a name='2172'></font>
<font color=#447700>!<a name='2173'></font>
<font color=#447700>!   Input argument list:<a name='2174'></font>
<font color=#447700>!     the        Real(krealfp) equivalent potential temperature in Kelvin<a name='2175'></font>
<font color=#447700>!     pk         Real(krealfp) pressure over 1e5 Pa to the kappa power<a name='2176'></font>
<font color=#447700>!<a name='2177'></font>
<font color=#447700>!   Output argument list:<a name='2178'></font>
<font color=#447700>!     tma        Real(krealfp) parcel temperature in Kelvin<a name='2179'></font>
<font color=#447700>!     qma        Real(krealfp) parcel specific humidity in kg/kg<a name='2180'></font>
<font color=#447700>!<a name='2181'></font>
<font color=#447700>! Subprograms called:<a name='2182'></font>
<font color=#447700>!   (stma)     inlinable subprogram to compute parcel temperature<a name='2183'></font>
<font color=#447700>!   (stmaxg)   inlinable subprogram to compute parcel temperature<a name='2184'></font>
<font color=#447700>!<a name='2185'></font>
<font color=#447700>! Attributes:<a name='2186'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2187'></font>
<font color=#447700>!<a name='2188'></font>
<font color=#447700>!$$$<a name='2189'></font>
    implicit none<a name='2190'>
    real(krealfp),intent(in):: the,pk<a name='2191'>
    real(krealfp),intent(out):: tma,qma<a name='2192'>
    real(krealfp) tg,qg<a name='2193'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2194'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#STMAX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_32">()<a name='2195'>
    call <A href='../../html_code/phys/module_gfs_funcphys.F.html#STMA'>stma</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#STMAX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="STMA_3">(the,pk,tg,qg)<a name='2196'>
    call <A href='../../html_code/phys/module_gfs_funcphys.F.html#STMAXG'>stmaxg</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#STMAX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="STMAXG_2">(tg,the,pk,tma,qma)<a name='2197'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2198'></font>
  end subroutine<a name='2199'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2200'></font>
<font color=#447700>! elemental subroutine stmaxg(tg,the,pk,tma,qma)<a name='2201'></font>
<A NAME='STMAXG'><A href='../../html_code/phys/module_gfs_funcphys.F.html#STMAXG' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2202'>
  <font color=#993300>subroutine </font><font color=#cc0000>stmaxg</font>(tg,the,pk,tma,qma) <A href='../../call_to/STMAXG.html' TARGET='index'>2</A>,<A href='../../call_from/STMAXG.html' TARGET='index'>1</A><a name='2203'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='2204'></font>
<font color=#447700>!<a name='2205'></font>
<font color=#447700>! Subprogram: stmaxg       Compute moist adiabat temperature<a name='2206'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='2207'></font>
<font color=#447700>!<a name='2208'></font>
<font color=#447700>! Abstract: exactly compute temperature and humidity of a parcel<a name='2209'></font>
<font color=#447700>!   lifted up a moist adiabat from equivalent potential temperature<a name='2210'></font>
<font color=#447700>!   at the LCL and pressure over 1e5 Pa to the kappa power.<a name='2211'></font>
<font color=#447700>!   A guess parcel temperature must be provided.<a name='2212'></font>
<font color=#447700>!   Equivalent potential temperature is constant for a saturated parcel<a name='2213'></font>
<font color=#447700>!   rising adiabatically up a moist adiabat when the heat and mass<a name='2214'></font>
<font color=#447700>!   of the condensed water are neglected.  Ice is also neglected.<a name='2215'></font>
<font color=#447700>!   The formula for equivalent potential temperature (Holton) is<a name='2216'></font>
<font color=#447700>!       the=t*(pd**(-rocp))*exp(el*eps*pv/(cp*t*pd))<a name='2217'></font>
<font color=#447700>!   where t is the temperature, pv is the saturated vapor pressure,<a name='2218'></font>
<font color=#447700>!   pd is the dry pressure p-pv, el is the temperature dependent<a name='2219'></font>
<font color=#447700>!   latent heat of condensation hvap+dldt*(t-ttp), and other values<a name='2220'></font>
<font color=#447700>!   are physical constants defined in parameter statements in the code.<a name='2221'></font>
<font color=#447700>!   The formula is inverted by iterating Newtonian approximations<a name='2222'></font>
<font color=#447700>!   for each the and p until t is found to within 1.e-4 Kelvin.<a name='2223'></font>
<font color=#447700>!   The specific humidity is then computed from pv and pd.<a name='2224'></font>
<font color=#447700>!   This subprogram can be expanded inline in the calling routine.<a name='2225'></font>
<font color=#447700>!<a name='2226'></font>
<font color=#447700>! Program History Log:<a name='2227'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='2228'></font>
<font color=#447700>!   94-12-30  Iredell             exact computation<a name='2229'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2230'></font>
<font color=#447700>!<a name='2231'></font>
<font color=#447700>! Usage:  call stmaxg(tg,the,pk,tma,qma)<a name='2232'></font>
<font color=#447700>!<a name='2233'></font>
<font color=#447700>!   Input argument list:<a name='2234'></font>
<font color=#447700>!     tg         Real(krealfp) guess parcel temperature in Kelvin<a name='2235'></font>
<font color=#447700>!     the        Real(krealfp) equivalent potential temperature in Kelvin<a name='2236'></font>
<font color=#447700>!     pk         Real(krealfp) pressure over 1e5 Pa to the kappa power<a name='2237'></font>
<font color=#447700>!<a name='2238'></font>
<font color=#447700>!   Output argument list:<a name='2239'></font>
<font color=#447700>!     tma        Real(krealfp) parcel temperature in Kelvin<a name='2240'></font>
<font color=#447700>!     qma        Real(krealfp) parcel specific humidity in kg/kg<a name='2241'></font>
<font color=#447700>!<a name='2242'></font>
<font color=#447700>! Attributes:<a name='2243'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2244'></font>
<font color=#447700>!<a name='2245'></font>
<font color=#447700>!$$$<a name='2246'></font>
    implicit none<a name='2247'>
    real(krealfp),intent(in):: tg,the,pk<a name='2248'>
    real(krealfp),intent(out):: tma,qma<a name='2249'>
    real(krealfp),parameter:: terrm=1.e-4<a name='2250'>
    real(krealfp) t,p,tr,pv,pd,el,expo,thet,dthet,terr<a name='2251'>
    integer i<a name='2252'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2253'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#STMAXG' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_33">()<a name='2254'>
    t=tg<a name='2255'>
    p=pk**con_cpor<a name='2256'>
    do i=1,100<a name='2257'>
      tr=con_ttp/t<a name='2258'>
      pv=psatb*(tr**con_xpona)*exp(con_xponb*(1.-tr))<a name='2259'>
      pd=p-pv<a name='2260'>
      el=con_hvap+con_dldt*(t-con_ttp)<a name='2261'>
      expo=el*con_eps*pv/(con_cp*t*pd)<a name='2262'>
      thet=t*pd**(-con_rocp)*exp(expo)<a name='2263'>
      dthet=thet/t*(1.+expo*(con_dldt*t/el+el*p/(con_rv*t*pd)))<a name='2264'>
      terr=(thet-the)/dthet<a name='2265'>
      t=t-terr<a name='2266'>
      if(abs(terr).le.terrm) exit<a name='2267'>
    enddo<a name='2268'>
    tma=t<a name='2269'>
    tr=con_ttp/t<a name='2270'>
    pv=psatb*(tr**con_xpona)*exp(con_xponb*(1.-tr))<a name='2271'>
    pd=p-pv<a name='2272'>
    qma=con_eps*pv/(pd+con_eps*pv)<a name='2273'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2274'></font>
  end subroutine<a name='2275'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2276'></font>
<A NAME='GPKAP'><A href='../../html_code/phys/module_gfs_funcphys.F.html#GPKAP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2277'>
  <font color=#993300>subroutine </font><font color=#cc0000>gpkap</font> <A href='../../call_to/GPKAP.html' TARGET='index'>1</A>,<A href='../../call_from/GPKAP.html' TARGET='index'>1</A><a name='2278'>
<font color=#447700>!$$$   Subprogram  documentation  block<a name='2279'></font>
<font color=#447700>!<a name='2280'></font>
<font color=#447700>! Subprogram: gpkap        Compute coefficients for p**kappa<a name='2281'></font>
<font color=#447700>!   Author: Phillips         org: w/NMC2X2   Date: 29 dec 82<a name='2282'></font>
<font color=#447700>!<a name='2283'></font>
<font color=#447700>! Abstract: Computes pressure to the kappa table as a function of pressure<a name='2284'></font>
<font color=#447700>!   for the table lookup function fpkap.<a name='2285'></font>
<font color=#447700>!   Exact pressure to the kappa values are calculated in subprogram fpkapx.<a name='2286'></font>
<font color=#447700>!   The current implementation computes a table with a length<a name='2287'></font>
<font color=#447700>!   of 5501 for pressures ranging up to 110000 Pascals.<a name='2288'></font>
<font color=#447700>!<a name='2289'></font>
<font color=#447700>! Program History Log:<a name='2290'></font>
<font color=#447700>!   94-12-30  Iredell<a name='2291'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2292'></font>
<font color=#447700>! 1999-03-24  Iredell             table lookup<a name='2293'></font>
<font color=#447700>!<a name='2294'></font>
<font color=#447700>! Usage:  call gpkap<a name='2295'></font>
<font color=#447700>!<a name='2296'></font>
<font color=#447700>! Subprograms called:<a name='2297'></font>
<font color=#447700>!   fpkapx     function to compute exact pressure to the kappa<a name='2298'></font>
<font color=#447700>!<a name='2299'></font>
<font color=#447700>! Attributes:<a name='2300'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2301'></font>
<font color=#447700>!<a name='2302'></font>
<font color=#447700>!$$$<a name='2303'></font>
    implicit none<a name='2304'>
    integer jx<a name='2305'>
    real(krealfp) xmin,xmax,xinc,x,p<a name='2306'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2307'></font>
    xmin=0._krealfp<a name='2308'>
    xmax=110000._krealfp<a name='2309'>
    xinc=(xmax-xmin)/(nxpkap-1)<a name='2310'>
    c1xpkap=1.-xmin/xinc<a name='2311'>
    c2xpkap=1./xinc<a name='2312'>
    do jx=1,nxpkap<a name='2313'>
      x=xmin+(jx-1)*xinc<a name='2314'>
      p=x<a name='2315'>
      tbpkap(jx)=<A href='../../html_code/phys/module_gfs_funcphys.F.html#FPKAPX'>fpkapx</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GPKAP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FPKAPX_1">(p)<a name='2316'>
    enddo<a name='2317'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2318'></font>
  end subroutine<a name='2319'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2320'></font>
<font color=#447700>! elemental function fpkap(p)<a name='2321'></font>
<A NAME='FPKAP'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPKAP' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='2322'>
  <font color=#993300>function </font><font color=#cc0000>fpkap</font>(p),<A href='../../call_from/FPKAP.html' TARGET='index'>1</A><a name='2323'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='2324'></font>
<font color=#447700>!<a name='2325'></font>
<font color=#447700>! Subprogram: fpkap        raise pressure to the kappa power.<a name='2326'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='2327'></font>
<font color=#447700>!<a name='2328'></font>
<font color=#447700>! Abstract: Raise pressure over 1e5 Pa to the kappa power.<a name='2329'></font>
<font color=#447700>!   A linear interpolation is done between values in a lookup table<a name='2330'></font>
<font color=#447700>!   computed in gpkap. See documentation for fpkapx for details.<a name='2331'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='2332'></font>
<font color=#447700>!   The interpolation accuracy ranges from 9 decimal places<a name='2333'></font>
<font color=#447700>!   at 100000 Pascals to 5 decimal places at 1000 Pascals.<a name='2334'></font>
<font color=#447700>!   On the Cray, fpkap is over 5 times faster than exact calculation.<a name='2335'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='2336'></font>
<font color=#447700>!<a name='2337'></font>
<font color=#447700>! Program History Log:<a name='2338'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='2339'></font>
<font color=#447700>!   94-12-30  Iredell             standardized kappa,<a name='2340'></font>
<font color=#447700>!                                 increased range and accuracy<a name='2341'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2342'></font>
<font color=#447700>! 1999-03-24  Iredell             table lookup<a name='2343'></font>
<font color=#447700>!<a name='2344'></font>
<font color=#447700>! Usage:   pkap=fpkap(p)<a name='2345'></font>
<font color=#447700>!<a name='2346'></font>
<font color=#447700>!   Input argument list:<a name='2347'></font>
<font color=#447700>!     p          Real(krealfp) pressure in Pascals<a name='2348'></font>
<font color=#447700>!<a name='2349'></font>
<font color=#447700>!   Output argument list:<a name='2350'></font>
<font color=#447700>!     fpkap      Real(krealfp) p over 1e5 Pa to the kappa power<a name='2351'></font>
<font color=#447700>!<a name='2352'></font>
<font color=#447700>! Attributes:<a name='2353'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2354'></font>
<font color=#447700>!<a name='2355'></font>
<font color=#447700>!$$$<a name='2356'></font>
    implicit none<a name='2357'>
    real(krealfp) fpkap<a name='2358'>
    real(krealfp),intent(in):: p<a name='2359'>
    integer jx<a name='2360'>
    real(krealfp) xj<a name='2361'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2362'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPKAP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_34">()<a name='2363'>
    xj=min(max(c1xpkap+c2xpkap*p,1._krealfp),real(nxpkap,krealfp))<a name='2364'>
    jx=min(xj,nxpkap-1._krealfp)<a name='2365'>
    fpkap=tbpkap(jx)+(xj-jx)*(tbpkap(jx+1)-tbpkap(jx))<a name='2366'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2367'></font>
  end function<a name='2368'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2369'></font>
<font color=#447700>! elemental function fpkapq(p)<a name='2370'></font>
<A NAME='FPKAPQ'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPKAPQ' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='2371'>
  <font color=#993300>function </font><font color=#cc0000>fpkapq</font>(p),<A href='../../call_from/FPKAPQ.html' TARGET='index'>1</A><a name='2372'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='2373'></font>
<font color=#447700>!<a name='2374'></font>
<font color=#447700>! Subprogram: fpkapq       raise pressure to the kappa power.<a name='2375'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='2376'></font>
<font color=#447700>!<a name='2377'></font>
<font color=#447700>! Abstract: Raise pressure over 1e5 Pa to the kappa power.<a name='2378'></font>
<font color=#447700>!   A quadratic interpolation is done between values in a lookup table<a name='2379'></font>
<font color=#447700>!   computed in gpkap. see documentation for fpkapx for details.<a name='2380'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='2381'></font>
<font color=#447700>!   The interpolation accuracy ranges from 12 decimal places<a name='2382'></font>
<font color=#447700>!   at 100000 Pascals to 7 decimal places at 1000 Pascals.<a name='2383'></font>
<font color=#447700>!   On the Cray, fpkap is over 4 times faster than exact calculation.<a name='2384'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='2385'></font>
<font color=#447700>!<a name='2386'></font>
<font color=#447700>! Program History Log:<a name='2387'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='2388'></font>
<font color=#447700>!   94-12-30  Iredell             standardized kappa,<a name='2389'></font>
<font color=#447700>!                                 increased range and accuracy<a name='2390'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2391'></font>
<font color=#447700>! 1999-03-24  Iredell             table lookup<a name='2392'></font>
<font color=#447700>!<a name='2393'></font>
<font color=#447700>! Usage:   pkap=fpkapq(p)<a name='2394'></font>
<font color=#447700>!<a name='2395'></font>
<font color=#447700>!   Input argument list:<a name='2396'></font>
<font color=#447700>!     p          Real(krealfp) pressure in Pascals<a name='2397'></font>
<font color=#447700>!<a name='2398'></font>
<font color=#447700>!   Output argument list:<a name='2399'></font>
<font color=#447700>!     fpkapq     Real(krealfp) p over 1e5 Pa to the kappa power<a name='2400'></font>
<font color=#447700>!<a name='2401'></font>
<font color=#447700>! Attributes:<a name='2402'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2403'></font>
<font color=#447700>!<a name='2404'></font>
<font color=#447700>!$$$<a name='2405'></font>
    implicit none<a name='2406'>
    real(krealfp) fpkapq<a name='2407'>
    real(krealfp),intent(in):: p<a name='2408'>
    integer jx<a name='2409'>
    real(krealfp) xj,dxj,fj1,fj2,fj3<a name='2410'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2411'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPKAPQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_35">()<a name='2412'>
    xj=min(max(c1xpkap+c2xpkap*p,1._krealfp),real(nxpkap,krealfp))<a name='2413'>
    jx=min(max(nint(xj),2),nxpkap-1)<a name='2414'>
    dxj=xj-jx<a name='2415'>
    fj1=tbpkap(jx-1)<a name='2416'>
    fj2=tbpkap(jx)<a name='2417'>
    fj3=tbpkap(jx+1)<a name='2418'>
    fpkapq=(((fj3+fj1)/2-fj2)*dxj+(fj3-fj1)/2)*dxj+fj2<a name='2419'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2420'></font>
  end function<a name='2421'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2422'></font>
<A NAME='FPKAPO'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPKAPO' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='2423'>
  <font color=#993300>function </font><font color=#cc0000>fpkapo</font>(p),<A href='../../call_from/FPKAPO.html' TARGET='index'>1</A><a name='2424'>
<font color=#447700>!$$$   Subprogram  documentation  block<a name='2425'></font>
<font color=#447700>!<a name='2426'></font>
<font color=#447700>! Subprogram: fpkapo       raise surface pressure to the kappa power.<a name='2427'></font>
<font color=#447700>!   Author: Phillips         org: w/NMC2X2   Date: 29 dec 82<a name='2428'></font>
<font color=#447700>!<a name='2429'></font>
<font color=#447700>! Abstract: Raise surface pressure over 1e5 Pa to the kappa power<a name='2430'></font>
<font color=#447700>!   using a rational weighted chebyshev approximation.<a name='2431'></font>
<font color=#447700>!   The numerator is of order 2 and the denominator is of order 4.<a name='2432'></font>
<font color=#447700>!   The pressure range is 40000-110000 Pa and kappa is defined in fpkapx.<a name='2433'></font>
<font color=#447700>!   The accuracy of this approximation is almost 8 decimal places.<a name='2434'></font>
<font color=#447700>!   On the Cray, fpkap is over 10 times faster than exact calculation.<a name='2435'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='2436'></font>
<font color=#447700>!<a name='2437'></font>
<font color=#447700>! Program History Log:<a name='2438'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='2439'></font>
<font color=#447700>!   94-12-30  Iredell             standardized kappa,<a name='2440'></font>
<font color=#447700>!                                 increased range and accuracy<a name='2441'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2442'></font>
<font color=#447700>!<a name='2443'></font>
<font color=#447700>! Usage:  pkap=fpkapo(p)<a name='2444'></font>
<font color=#447700>!<a name='2445'></font>
<font color=#447700>!   Input argument list:<a name='2446'></font>
<font color=#447700>!     p          Real(krealfp) surface pressure in Pascals<a name='2447'></font>
<font color=#447700>!                p should be in the range 40000 to 110000<a name='2448'></font>
<font color=#447700>!<a name='2449'></font>
<font color=#447700>!   Output argument list:<a name='2450'></font>
<font color=#447700>!     fpkapo     Real(krealfp) p over 1e5 Pa to the kappa power<a name='2451'></font>
<font color=#447700>!<a name='2452'></font>
<font color=#447700>! Attributes:<a name='2453'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2454'></font>
<font color=#447700>!<a name='2455'></font>
<font color=#447700>!$$$<a name='2456'></font>
    implicit none<a name='2457'>
    real(krealfp) fpkapo<a name='2458'>
    real(krealfp),intent(in):: p<a name='2459'>
    integer,parameter:: nnpk=2,ndpk=4<a name='2460'>
    real(krealfp):: cnpk(0:nnpk)=(/3.13198449e-1,5.78544829e-2,&amp;<a name='2461'>
                                         8.35491871e-4/)<a name='2462'>
    real(krealfp):: cdpk(0:ndpk)=(/1.,8.15968401e-2,5.72839518e-4,&amp;<a name='2463'>
                                         -4.86959812e-7,5.24459889e-10/)<a name='2464'>
    integer n<a name='2465'>
    real(krealfp) pkpa,fnpk,fdpk<a name='2466'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2467'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPKAPO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_36">()<a name='2468'>
    pkpa=p*1.e-3_krealfp<a name='2469'>
    fnpk=cnpk(nnpk)<a name='2470'>
    do n=nnpk-1,0,-1<a name='2471'>
      fnpk=pkpa*fnpk+cnpk(n)<a name='2472'>
    enddo<a name='2473'>
    fdpk=cdpk(ndpk)<a name='2474'>
    do n=ndpk-1,0,-1<a name='2475'>
      fdpk=pkpa*fdpk+cdpk(n)<a name='2476'>
    enddo<a name='2477'>
    fpkapo=fnpk/fdpk<a name='2478'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2479'></font>
  end function<a name='2480'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2481'></font>
<font color=#447700>! elemental function fpkapx(p)<a name='2482'></font>
<A NAME='FPKAPX'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPKAPX' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='2483'>
  <font color=#993300>function </font><font color=#cc0000>fpkapx</font>(p) <A href='../../call_to/FPKAPX.html' TARGET='index'>2</A>,<A href='../../call_from/FPKAPX.html' TARGET='index'>1</A><a name='2484'>
<font color=#447700>!$$$   Subprogram  documentation  block<a name='2485'></font>
<font color=#447700>!<a name='2486'></font>
<font color=#447700>! Subprogram: fpkapx       raise pressure to the kappa power.<a name='2487'></font>
<font color=#447700>!   Author: Phillips         org: w/NMC2X2   Date: 29 dec 82<a name='2488'></font>
<font color=#447700>!<a name='2489'></font>
<font color=#447700>! Abstract: raise pressure over 1e5 Pa to the kappa power.<a name='2490'></font>
<font color=#447700>!   Kappa is equal to rd/cp where rd and cp are physical constants.<a name='2491'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='2492'></font>
<font color=#447700>!<a name='2493'></font>
<font color=#447700>! Program History Log:<a name='2494'></font>
<font color=#447700>!   94-12-30  Iredell             made into inlinable function<a name='2495'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2496'></font>
<font color=#447700>!<a name='2497'></font>
<font color=#447700>! Usage:  pkap=fpkapx(p)<a name='2498'></font>
<font color=#447700>!<a name='2499'></font>
<font color=#447700>!   Input argument list:<a name='2500'></font>
<font color=#447700>!     p          Real(krealfp) pressure in Pascals<a name='2501'></font>
<font color=#447700>!<a name='2502'></font>
<font color=#447700>!   Output argument list:<a name='2503'></font>
<font color=#447700>!     fpkapx     Real(krealfp) p over 1e5 Pa to the kappa power<a name='2504'></font>
<font color=#447700>!<a name='2505'></font>
<font color=#447700>! Attributes:<a name='2506'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2507'></font>
<font color=#447700>!<a name='2508'></font>
<font color=#447700>!$$$<a name='2509'></font>
    implicit none<a name='2510'>
    real(krealfp) fpkapx<a name='2511'>
    real(krealfp),intent(in):: p<a name='2512'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2513'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FPKAPX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_37">()<a name='2514'>
    fpkapx=(p/1.e5_krealfp)**con_rocp<a name='2515'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2516'></font>
  end function<a name='2517'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2518'></font>
<A NAME='GRKAP'><A href='../../html_code/phys/module_gfs_funcphys.F.html#GRKAP' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2519'>
  <font color=#993300>subroutine </font><font color=#cc0000>grkap</font> <A href='../../call_to/GRKAP.html' TARGET='index'>1</A>,<A href='../../call_from/GRKAP.html' TARGET='index'>3</A><a name='2520'>
<font color=#447700>!$$$   Subprogram  documentation  block<a name='2521'></font>
<font color=#447700>!<a name='2522'></font>
<font color=#447700>! Subprogram: grkap        Compute coefficients for p**(1/kappa)<a name='2523'></font>
<font color=#447700>!   Author: Phillips         org: w/NMC2X2   Date: 29 dec 82<a name='2524'></font>
<font color=#447700>!<a name='2525'></font>
<font color=#447700>! Abstract: Computes pressure to the 1/kappa table as a function of pressure<a name='2526'></font>
<font color=#447700>!   for the table lookup function frkap.<a name='2527'></font>
<font color=#447700>!   Exact pressure to the 1/kappa values are calculated in subprogram frkapx.<a name='2528'></font>
<font color=#447700>!   The current implementation computes a table with a length<a name='2529'></font>
<font color=#447700>!   of 5501 for pressures ranging up to 110000 Pascals.<a name='2530'></font>
<font color=#447700>!<a name='2531'></font>
<font color=#447700>! Program History Log:<a name='2532'></font>
<font color=#447700>!   94-12-30  Iredell<a name='2533'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2534'></font>
<font color=#447700>! 1999-03-24  Iredell             table lookup<a name='2535'></font>
<font color=#447700>!<a name='2536'></font>
<font color=#447700>! Usage:  call grkap<a name='2537'></font>
<font color=#447700>!<a name='2538'></font>
<font color=#447700>! Subprograms called:<a name='2539'></font>
<font color=#447700>!   frkapx     function to compute exact pressure to the 1/kappa<a name='2540'></font>
<font color=#447700>!<a name='2541'></font>
<font color=#447700>! Attributes:<a name='2542'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2543'></font>
<font color=#447700>!<a name='2544'></font>
<font color=#447700>!$$$<a name='2545'></font>
    implicit none<a name='2546'>
    integer jx<a name='2547'>
    real(krealfp) xmin,xmax,xinc,x,p<a name='2548'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2549'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GRKAP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_38">()<a name='2550'>
    xmin=0._krealfp<a name='2551'>
    xmax=<A href='../../html_code/phys/module_gfs_funcphys.F.html#FPKAPX'>fpkapx</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GRKAP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FPKAPX_2">(110000._krealfp)<a name='2552'>
    xinc=(xmax-xmin)/(nxrkap-1)<a name='2553'>
    c1xrkap=1.-xmin/xinc<a name='2554'>
    c2xrkap=1./xinc<a name='2555'>
    do jx=1,nxrkap<a name='2556'>
      x=xmin+(jx-1)*xinc<a name='2557'>
      p=x<a name='2558'>
      tbrkap(jx)=<A href='../../html_code/phys/module_gfs_funcphys.F.html#FRKAPX'>frkapx</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GRKAP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FRKAPX_1">(p)<a name='2559'>
    enddo<a name='2560'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2561'></font>
  end subroutine<a name='2562'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2563'></font>
<font color=#447700>! elemental function frkap(pkap)<a name='2564'></font>
<A NAME='FRKAP'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FRKAP' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='2565'>
  <font color=#993300>function </font><font color=#cc0000>frkap</font>(pkap),<A href='../../call_from/FRKAP.html' TARGET='index'>1</A><a name='2566'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='2567'></font>
<font color=#447700>!<a name='2568'></font>
<font color=#447700>! Subprogram: frkap        raise pressure to the 1/kappa power.<a name='2569'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='2570'></font>
<font color=#447700>!<a name='2571'></font>
<font color=#447700>! Abstract: Raise pressure over 1e5 Pa to the 1/kappa power.<a name='2572'></font>
<font color=#447700>!   A linear interpolation is done between values in a lookup table<a name='2573'></font>
<font color=#447700>!   computed in grkap. See documentation for frkapx for details.<a name='2574'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='2575'></font>
<font color=#447700>!   The interpolation accuracy is better than 7 decimal places.<a name='2576'></font>
<font color=#447700>!   On the IBM, fpkap is about 4 times faster than exact calculation.<a name='2577'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='2578'></font>
<font color=#447700>!<a name='2579'></font>
<font color=#447700>! Program History Log:<a name='2580'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='2581'></font>
<font color=#447700>!   94-12-30  Iredell             standardized kappa,<a name='2582'></font>
<font color=#447700>!                                 increased range and accuracy<a name='2583'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2584'></font>
<font color=#447700>! 1999-03-24  Iredell             table lookup<a name='2585'></font>
<font color=#447700>!<a name='2586'></font>
<font color=#447700>! Usage:   p=frkap(pkap)<a name='2587'></font>
<font color=#447700>!<a name='2588'></font>
<font color=#447700>!   Input argument list:<a name='2589'></font>
<font color=#447700>!     pkap       Real(krealfp) p over 1e5 Pa to the kappa power<a name='2590'></font>
<font color=#447700>!<a name='2591'></font>
<font color=#447700>!   Output argument list:<a name='2592'></font>
<font color=#447700>!     frkap      Real(krealfp) pressure in Pascals<a name='2593'></font>
<font color=#447700>!<a name='2594'></font>
<font color=#447700>! Attributes:<a name='2595'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2596'></font>
<font color=#447700>!<a name='2597'></font>
<font color=#447700>!$$$<a name='2598'></font>
    implicit none<a name='2599'>
    real(krealfp) frkap<a name='2600'>
    real(krealfp),intent(in):: pkap<a name='2601'>
    integer jx<a name='2602'>
    real(krealfp) xj<a name='2603'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2604'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FRKAP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_39">()<a name='2605'>
    xj=min(max(c1xrkap+c2xrkap*pkap,1._krealfp),real(nxrkap,krealfp))<a name='2606'>
    jx=min(xj,nxrkap-1._krealfp)<a name='2607'>
    frkap=tbrkap(jx)+(xj-jx)*(tbrkap(jx+1)-tbrkap(jx))<a name='2608'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2609'></font>
  end function<a name='2610'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2611'></font>
<font color=#447700>! elemental function frkapq(pkap)<a name='2612'></font>
<A NAME='FRKAPQ'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FRKAPQ' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='2613'>
  <font color=#993300>function </font><font color=#cc0000>frkapq</font>(pkap),<A href='../../call_from/FRKAPQ.html' TARGET='index'>1</A><a name='2614'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='2615'></font>
<font color=#447700>!<a name='2616'></font>
<font color=#447700>! Subprogram: frkapq       raise pressure to the 1/kappa power.<a name='2617'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='2618'></font>
<font color=#447700>!<a name='2619'></font>
<font color=#447700>! Abstract: Raise pressure over 1e5 Pa to the 1/kappa power.<a name='2620'></font>
<font color=#447700>!   A quadratic interpolation is done between values in a lookup table<a name='2621'></font>
<font color=#447700>!   computed in grkap. see documentation for frkapx for details.<a name='2622'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='2623'></font>
<font color=#447700>!   The interpolation accuracy is better than 11 decimal places.<a name='2624'></font>
<font color=#447700>!   On the IBM, fpkap is almost 4 times faster than exact calculation.<a name='2625'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='2626'></font>
<font color=#447700>!<a name='2627'></font>
<font color=#447700>! Program History Log:<a name='2628'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='2629'></font>
<font color=#447700>!   94-12-30  Iredell             standardized kappa,<a name='2630'></font>
<font color=#447700>!                                 increased range and accuracy<a name='2631'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2632'></font>
<font color=#447700>! 1999-03-24  Iredell             table lookup<a name='2633'></font>
<font color=#447700>!<a name='2634'></font>
<font color=#447700>! Usage:   p=frkapq(pkap)<a name='2635'></font>
<font color=#447700>!<a name='2636'></font>
<font color=#447700>!   Input argument list:<a name='2637'></font>
<font color=#447700>!     pkap       Real(krealfp) p over 1e5 Pa to the kappa power<a name='2638'></font>
<font color=#447700>!<a name='2639'></font>
<font color=#447700>!   Output argument list:<a name='2640'></font>
<font color=#447700>!     frkapq     Real(krealfp) pressure in Pascals<a name='2641'></font>
<font color=#447700>!<a name='2642'></font>
<font color=#447700>! Attributes:<a name='2643'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2644'></font>
<font color=#447700>!<a name='2645'></font>
<font color=#447700>!$$$<a name='2646'></font>
    implicit none<a name='2647'>
    real(krealfp) frkapq<a name='2648'>
    real(krealfp),intent(in):: pkap<a name='2649'>
    integer jx<a name='2650'>
    real(krealfp) xj,dxj,fj1,fj2,fj3<a name='2651'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2652'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FRKAPQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_40">()<a name='2653'>
    xj=min(max(c1xrkap+c2xrkap*pkap,1._krealfp),real(nxrkap,krealfp))<a name='2654'>
    jx=min(max(nint(xj),2),nxrkap-1)<a name='2655'>
    dxj=xj-jx<a name='2656'>
    fj1=tbrkap(jx-1)<a name='2657'>
    fj2=tbrkap(jx)<a name='2658'>
    fj3=tbrkap(jx+1)<a name='2659'>
    frkapq=(((fj3+fj1)/2-fj2)*dxj+(fj3-fj1)/2)*dxj+fj2<a name='2660'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2661'></font>
  end function<a name='2662'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2663'></font>
<font color=#447700>! elemental function frkapx(pkap)<a name='2664'></font>
<A NAME='FRKAPX'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FRKAPX' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='2665'>
  <font color=#993300>function </font><font color=#cc0000>frkapx</font>(pkap) <A href='../../call_to/FRKAPX.html' TARGET='index'>1</A>,<A href='../../call_from/FRKAPX.html' TARGET='index'>1</A><a name='2666'>
<font color=#447700>!$$$   Subprogram  documentation  block<a name='2667'></font>
<font color=#447700>!<a name='2668'></font>
<font color=#447700>! Subprogram: frkapx       raise pressure to the 1/kappa power.<a name='2669'></font>
<font color=#447700>!   Author: Phillips         org: w/NMC2X2   Date: 29 dec 82<a name='2670'></font>
<font color=#447700>!<a name='2671'></font>
<font color=#447700>! Abstract: raise pressure over 1e5 Pa to the 1/kappa power.<a name='2672'></font>
<font color=#447700>!   Kappa is equal to rd/cp where rd and cp are physical constants.<a name='2673'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='2674'></font>
<font color=#447700>!<a name='2675'></font>
<font color=#447700>! Program History Log:<a name='2676'></font>
<font color=#447700>!   94-12-30  Iredell             made into inlinable function<a name='2677'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2678'></font>
<font color=#447700>!<a name='2679'></font>
<font color=#447700>! Usage:  p=frkapx(pkap)<a name='2680'></font>
<font color=#447700>!<a name='2681'></font>
<font color=#447700>!   Input argument list:<a name='2682'></font>
<font color=#447700>!     pkap       Real(krealfp) p over 1e5 Pa to the kappa power<a name='2683'></font>
<font color=#447700>!<a name='2684'></font>
<font color=#447700>!   Output argument list:<a name='2685'></font>
<font color=#447700>!     frkapx     Real(krealfp) pressure in Pascals<a name='2686'></font>
<font color=#447700>!<a name='2687'></font>
<font color=#447700>! Attributes:<a name='2688'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2689'></font>
<font color=#447700>!<a name='2690'></font>
<font color=#447700>!$$$<a name='2691'></font>
    implicit none<a name='2692'>
    real(krealfp) frkapx<a name='2693'>
    real(krealfp),intent(in):: pkap<a name='2694'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2695'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FRKAPX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_41">()<a name='2696'>
    frkapx=pkap**(1/con_rocp)*1.e5_krealfp<a name='2697'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2698'></font>
  end function<a name='2699'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2700'></font>
<A NAME='GTLCL'><A href='../../html_code/phys/module_gfs_funcphys.F.html#GTLCL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2701'>
  <font color=#993300>subroutine </font><font color=#cc0000>gtlcl</font> <A href='../../call_to/GTLCL.html' TARGET='index'>1</A>,<A href='../../call_from/GTLCL.html' TARGET='index'>1</A><a name='2702'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='2703'></font>
<font color=#447700>!<a name='2704'></font>
<font color=#447700>! Subprogram: gtlcl        Compute equivalent potential temperature table<a name='2705'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='2706'></font>
<font color=#447700>!<a name='2707'></font>
<font color=#447700>! Abstract: Compute lifting condensation level temperature table<a name='2708'></font>
<font color=#447700>!   as a function of temperature and dewpoint depression for function ftlcl.<a name='2709'></font>
<font color=#447700>!   Lifting condensation level temperature is calculated in subprogram ftlclx<a name='2710'></font>
<font color=#447700>!   The current implementation computes a table with a first dimension<a name='2711'></font>
<font color=#447700>!   of 151 for temperatures ranging from 180.0 to 330.0 Kelvin<a name='2712'></font>
<font color=#447700>!   and a second dimension of 61 for dewpoint depression ranging from<a name='2713'></font>
<font color=#447700>!   0 to 60 Kelvin.<a name='2714'></font>
<font color=#447700>!<a name='2715'></font>
<font color=#447700>! Program History Log:<a name='2716'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2717'></font>
<font color=#447700>!<a name='2718'></font>
<font color=#447700>! Usage:  call gtlcl<a name='2719'></font>
<font color=#447700>!<a name='2720'></font>
<font color=#447700>! Subprograms called:<a name='2721'></font>
<font color=#447700>!   (ftlclx)    inlinable function to compute LCL temperature<a name='2722'></font>
<font color=#447700>!<a name='2723'></font>
<font color=#447700>! Attributes:<a name='2724'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2725'></font>
<font color=#447700>!<a name='2726'></font>
<font color=#447700>!$$$<a name='2727'></font>
    implicit none<a name='2728'>
    integer jx,jy<a name='2729'>
    real(krealfp) xmin,xmax,ymin,ymax,xinc,yinc,x,y,tdpd,t<a name='2730'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2731'></font>
    xmin=180._krealfp<a name='2732'>
    xmax=330._krealfp<a name='2733'>
    ymin=0._krealfp<a name='2734'>
    ymax=60._krealfp<a name='2735'>
    xinc=(xmax-xmin)/(nxtlcl-1)<a name='2736'>
    c1xtlcl=1.-xmin/xinc<a name='2737'>
    c2xtlcl=1./xinc<a name='2738'>
    yinc=(ymax-ymin)/(nytlcl-1)<a name='2739'>
    c1ytlcl=1.-ymin/yinc<a name='2740'>
    c2ytlcl=1./yinc<a name='2741'>
    do jy=1,nytlcl<a name='2742'>
      y=ymin+(jy-1)*yinc<a name='2743'>
      tdpd=y<a name='2744'>
      do jx=1,nxtlcl<a name='2745'>
        x=xmin+(jx-1)*xinc<a name='2746'>
        t=x<a name='2747'>
        tbtlcl(jx,jy)=<A href='../../html_code/phys/module_gfs_funcphys.F.html#FTLCLX'>ftlclx</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GTLCL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FTLCLX_1">(t,tdpd)<a name='2748'>
      enddo<a name='2749'>
    enddo<a name='2750'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2751'></font>
  end subroutine<a name='2752'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2753'></font>
<font color=#447700>! elemental function ftlcl(t,tdpd)<a name='2754'></font>
<A NAME='FTLCL'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTLCL' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='2755'>
  <font color=#993300>function </font><font color=#cc0000>ftlcl</font>(t,tdpd) <A href='../../call_to/FTLCL.html' TARGET='index'>3</A>,<A href='../../call_from/FTLCL.html' TARGET='index'>1</A><a name='2756'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='2757'></font>
<font color=#447700>!<a name='2758'></font>
<font color=#447700>! Subprogram: ftlcl        Compute LCL temperature<a name='2759'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='2760'></font>
<font color=#447700>!<a name='2761'></font>
<font color=#447700>! Abstract: Compute temperature at the lifting condensation level<a name='2762'></font>
<font color=#447700>!   from temperature and dewpoint depression.<a name='2763'></font>
<font color=#447700>!   A bilinear interpolation is done between values in a lookup table<a name='2764'></font>
<font color=#447700>!   computed in gtlcl. See documentation for ftlclx for details.<a name='2765'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='2766'></font>
<font color=#447700>!   The interpolation accuracy is better than 0.0005 Kelvin.<a name='2767'></font>
<font color=#447700>!   On the Cray, ftlcl is ? times faster than exact calculation.<a name='2768'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='2769'></font>
<font color=#447700>!<a name='2770'></font>
<font color=#447700>! Program History Log:<a name='2771'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2772'></font>
<font color=#447700>!<a name='2773'></font>
<font color=#447700>! Usage:   tlcl=ftlcl(t,tdpd)<a name='2774'></font>
<font color=#447700>!<a name='2775'></font>
<font color=#447700>!   Input argument list:<a name='2776'></font>
<font color=#447700>!     t          Real(krealfp) LCL temperature in Kelvin<a name='2777'></font>
<font color=#447700>!     tdpd       Real(krealfp) dewpoint depression in Kelvin<a name='2778'></font>
<font color=#447700>!<a name='2779'></font>
<font color=#447700>!   Output argument list:<a name='2780'></font>
<font color=#447700>!     ftlcl      Real(krealfp) temperature at the LCL in Kelvin<a name='2781'></font>
<font color=#447700>!<a name='2782'></font>
<font color=#447700>! Attributes:<a name='2783'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2784'></font>
<font color=#447700>!<a name='2785'></font>
<font color=#447700>!$$$<a name='2786'></font>
    implicit none<a name='2787'>
    real(krealfp) ftlcl<a name='2788'>
    real(krealfp),intent(in):: t,tdpd<a name='2789'>
    integer jx,jy<a name='2790'>
    real(krealfp) xj,yj,ftx1,ftx2<a name='2791'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2792'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_shcu_grims.F.html#FTLCL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_42">()<a name='2793'>
    xj=min(max(c1xtlcl+c2xtlcl*t,1._krealfp),real(nxtlcl,krealfp))<a name='2794'>
    yj=min(max(c1ytlcl+c2ytlcl*tdpd,1._krealfp),real(nytlcl,krealfp))<a name='2795'>
    jx=min(xj,nxtlcl-1._krealfp)<a name='2796'>
    jy=min(yj,nytlcl-1._krealfp)<a name='2797'>
    ftx1=tbtlcl(jx,jy)+(xj-jx)*(tbtlcl(jx+1,jy)-tbtlcl(jx,jy))<a name='2798'>
    ftx2=tbtlcl(jx,jy+1)+(xj-jx)*(tbtlcl(jx+1,jy+1)-tbtlcl(jx,jy+1))<a name='2799'>
    ftlcl=ftx1+(yj-jy)*(ftx2-ftx1)<a name='2800'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2801'></font>
  end function<a name='2802'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2803'></font>
<font color=#447700>! elemental function ftlclq(t,tdpd)<a name='2804'></font>
<A NAME='FTLCLQ'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTLCLQ' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='2805'>
  <font color=#993300>function </font><font color=#cc0000>ftlclq</font>(t,tdpd),<A href='../../call_from/FTLCLQ.html' TARGET='index'>1</A><a name='2806'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='2807'></font>
<font color=#447700>!<a name='2808'></font>
<font color=#447700>! Subprogram: ftlclq       Compute LCL temperature<a name='2809'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='2810'></font>
<font color=#447700>!<a name='2811'></font>
<font color=#447700>! Abstract: Compute temperature at the lifting condensation level<a name='2812'></font>
<font color=#447700>!   from temperature and dewpoint depression.<a name='2813'></font>
<font color=#447700>!   A biquadratic interpolation is done between values in a lookup table<a name='2814'></font>
<font color=#447700>!   computed in gtlcl. see documentation for ftlclx for details.<a name='2815'></font>
<font color=#447700>!   Input values outside table range are reset to table extrema.<a name='2816'></font>
<font color=#447700>!   The interpolation accuracy is better than 0.000003 Kelvin.<a name='2817'></font>
<font color=#447700>!   On the Cray, ftlclq is ? times faster than exact calculation.<a name='2818'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='2819'></font>
<font color=#447700>!<a name='2820'></font>
<font color=#447700>! Program History Log:<a name='2821'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2822'></font>
<font color=#447700>!<a name='2823'></font>
<font color=#447700>! Usage:   tlcl=ftlclq(t,tdpd)<a name='2824'></font>
<font color=#447700>!<a name='2825'></font>
<font color=#447700>!   Input argument list:<a name='2826'></font>
<font color=#447700>!     t          Real(krealfp) LCL temperature in Kelvin<a name='2827'></font>
<font color=#447700>!     tdpd       Real(krealfp) dewpoint depression in Kelvin<a name='2828'></font>
<font color=#447700>!<a name='2829'></font>
<font color=#447700>!   Output argument list:<a name='2830'></font>
<font color=#447700>!     ftlcl      Real(krealfp) temperature at the LCL in Kelvin<a name='2831'></font>
<font color=#447700>!<a name='2832'></font>
<font color=#447700>! Attributes:<a name='2833'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2834'></font>
<font color=#447700>!<a name='2835'></font>
<font color=#447700>!$$$<a name='2836'></font>
    implicit none<a name='2837'>
    real(krealfp) ftlclq<a name='2838'>
    real(krealfp),intent(in):: t,tdpd<a name='2839'>
    integer jx,jy<a name='2840'>
    real(krealfp) xj,yj,dxj,dyj<a name='2841'>
    real(krealfp) ft11,ft12,ft13,ft21,ft22,ft23,ft31,ft32,ft33<a name='2842'>
    real(krealfp) ftx1,ftx2,ftx3<a name='2843'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2844'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTLCLQ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_43">()<a name='2845'>
    xj=min(max(c1xtlcl+c2xtlcl*t,1._krealfp),real(nxtlcl,krealfp))<a name='2846'>
    yj=min(max(c1ytlcl+c2ytlcl*tdpd,1._krealfp),real(nytlcl,krealfp))<a name='2847'>
    jx=min(max(nint(xj),2),nxtlcl-1)<a name='2848'>
    jy=min(max(nint(yj),2),nytlcl-1)<a name='2849'>
    dxj=xj-jx<a name='2850'>
    dyj=yj-jy<a name='2851'>
    ft11=tbtlcl(jx-1,jy-1)<a name='2852'>
    ft12=tbtlcl(jx-1,jy)<a name='2853'>
    ft13=tbtlcl(jx-1,jy+1)<a name='2854'>
    ft21=tbtlcl(jx,jy-1)<a name='2855'>
    ft22=tbtlcl(jx,jy)<a name='2856'>
    ft23=tbtlcl(jx,jy+1)<a name='2857'>
    ft31=tbtlcl(jx+1,jy-1)<a name='2858'>
    ft32=tbtlcl(jx+1,jy)<a name='2859'>
    ft33=tbtlcl(jx+1,jy+1)<a name='2860'>
    ftx1=(((ft31+ft11)/2-ft21)*dxj+(ft31-ft11)/2)*dxj+ft21<a name='2861'>
    ftx2=(((ft32+ft12)/2-ft22)*dxj+(ft32-ft12)/2)*dxj+ft22<a name='2862'>
    ftx3=(((ft33+ft13)/2-ft23)*dxj+(ft33-ft13)/2)*dxj+ft23<a name='2863'>
    ftlclq=(((ftx3+ftx1)/2-ftx2)*dyj+(ftx3-ftx1)/2)*dyj+ftx2<a name='2864'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2865'></font>
  end function<a name='2866'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2867'></font>
<A NAME='FTLCLO'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTLCLO' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='2868'>
  <font color=#993300>function </font><font color=#cc0000>ftlclo</font>(t,tdpd),<A href='../../call_from/FTLCLO.html' TARGET='index'>1</A><a name='2869'>
<font color=#447700>!$$$   Subprogram  documentation  block<a name='2870'></font>
<font color=#447700>!<a name='2871'></font>
<font color=#447700>! Subprogram: ftlclo       Compute LCL temperature.<a name='2872'></font>
<font color=#447700>!   Author: Phillips         org: w/NMC2X2   Date: 29 dec 82<a name='2873'></font>
<font color=#447700>!<a name='2874'></font>
<font color=#447700>! Abstract: Compute temperature at the lifting condensation level<a name='2875'></font>
<font color=#447700>!   from temperature and dewpoint depression.  the formula used is<a name='2876'></font>
<font color=#447700>!   a polynomial taken from Phillips mstadb routine which empirically<a name='2877'></font>
<font color=#447700>!   approximates the original exact implicit relationship.<a name='2878'></font>
<font color=#447700>!   (This kind of approximation is customary (inman, 1969), but<a name='2879'></font>
<font color=#447700>!   the original source for this particular one is not yet known. -MI)<a name='2880'></font>
<font color=#447700>!   Its accuracy is about 0.03 Kelvin for a dewpoint depression of 30.<a name='2881'></font>
<font color=#447700>!   This function should be expanded inline in the calling routine.<a name='2882'></font>
<font color=#447700>!<a name='2883'></font>
<font color=#447700>! Program History Log:<a name='2884'></font>
<font color=#447700>!   91-05-07  Iredell             made into inlinable function<a name='2885'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2886'></font>
<font color=#447700>!<a name='2887'></font>
<font color=#447700>! Usage:  tlcl=ftlclo(t,tdpd)<a name='2888'></font>
<font color=#447700>!<a name='2889'></font>
<font color=#447700>!   Input argument list:<a name='2890'></font>
<font color=#447700>!     t          Real(krealfp) temperature in Kelvin<a name='2891'></font>
<font color=#447700>!     tdpd       Real(krealfp) dewpoint depression in Kelvin<a name='2892'></font>
<font color=#447700>!<a name='2893'></font>
<font color=#447700>!   Output argument list:<a name='2894'></font>
<font color=#447700>!     ftlclo     Real(krealfp) temperature at the LCL in Kelvin<a name='2895'></font>
<font color=#447700>!<a name='2896'></font>
<font color=#447700>! Attributes:<a name='2897'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2898'></font>
<font color=#447700>!<a name='2899'></font>
<font color=#447700>!$$$<a name='2900'></font>
    implicit none<a name='2901'>
    real(krealfp) ftlclo<a name='2902'>
    real(krealfp),intent(in):: t,tdpd<a name='2903'>
    real(krealfp),parameter:: clcl1= 0.954442e+0,clcl2= 0.967772e-3,&amp;<a name='2904'>
                                    clcl3=-0.710321e-3,clcl4=-0.270742e-5<a name='2905'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2906'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTLCLO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_44">()<a name='2907'>
    ftlclo=t-tdpd*(clcl1+clcl2*t+tdpd*(clcl3+clcl4*t))<a name='2908'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2909'></font>
  end function<a name='2910'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2911'></font>
<font color=#447700>! elemental function ftlclx(t,tdpd)<a name='2912'></font>
<A NAME='FTLCLX'><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTLCLX' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='2913'>
  <font color=#993300>function </font><font color=#cc0000>ftlclx</font>(t,tdpd) <A href='../../call_to/FTLCLX.html' TARGET='index'>1</A>,<A href='../../call_from/FTLCLX.html' TARGET='index'>1</A><a name='2914'>
<font color=#447700>!$$$   Subprogram  documentation  block<a name='2915'></font>
<font color=#447700>!<a name='2916'></font>
<font color=#447700>! Subprogram: ftlclx       Compute LCL temperature.<a name='2917'></font>
<font color=#447700>!   Author: Iredell          org: w/NMC2X2   Date: 25 March 1999<a name='2918'></font>
<font color=#447700>!<a name='2919'></font>
<font color=#447700>! Abstract: Compute temperature at the lifting condensation level<a name='2920'></font>
<font color=#447700>!   from temperature and dewpoint depression.  A parcel lifted<a name='2921'></font>
<font color=#447700>!   adiabatically becomes saturated at the lifting condensation level.<a name='2922'></font>
<font color=#447700>!   The water model assumes a perfect gas, constant specific heats<a name='2923'></font>
<font color=#447700>!   for gas and liquid, and neglects the volume of the liquid.<a name='2924'></font>
<font color=#447700>!   The model does account for the variation of the latent heat<a name='2925'></font>
<font color=#447700>!   of condensation with temperature.  The ice option is not included.<a name='2926'></font>
<font color=#447700>!   The Clausius-Clapeyron equation is integrated from the triple point<a name='2927'></font>
<font color=#447700>!   to get the formulas<a name='2928'></font>
<font color=#447700>!       pvlcl=con_psat*(trlcl**xa)*exp(xb*(1.-trlcl))<a name='2929'></font>
<font color=#447700>!       pvdew=con_psat*(trdew**xa)*exp(xb*(1.-trdew))<a name='2930'></font>
<font color=#447700>!   where pvlcl is the saturated parcel vapor pressure at the LCL,<a name='2931'></font>
<font color=#447700>!   pvdew is the unsaturated parcel vapor pressure initially,<a name='2932'></font>
<font color=#447700>!   trlcl is ttp/tlcl and trdew is ttp/tdew.  The adiabatic lifting<a name='2933'></font>
<font color=#447700>!   of the parcel is represented by the following formula<a name='2934'></font>
<font color=#447700>!       pvdew=pvlcl*(t/tlcl)**(1/kappa)<a name='2935'></font>
<font color=#447700>!   This formula is inverted by iterating Newtonian approximations<a name='2936'></font>
<font color=#447700>!   until tlcl is found to within 1.e-6 Kelvin.  Note that the minimum<a name='2937'></font>
<font color=#447700>!   returned temperature is 180 Kelvin.<a name='2938'></font>
<font color=#447700>!<a name='2939'></font>
<font color=#447700>! Program History Log:<a name='2940'></font>
<font color=#447700>! 1999-03-25  Iredell<a name='2941'></font>
<font color=#447700>!<a name='2942'></font>
<font color=#447700>! Usage:  tlcl=ftlclx(t,tdpd)<a name='2943'></font>
<font color=#447700>!<a name='2944'></font>
<font color=#447700>!   Input argument list:<a name='2945'></font>
<font color=#447700>!     t          Real(krealfp) temperature in Kelvin<a name='2946'></font>
<font color=#447700>!     tdpd       Real(krealfp) dewpoint depression in Kelvin<a name='2947'></font>
<font color=#447700>!<a name='2948'></font>
<font color=#447700>!   Output argument list:<a name='2949'></font>
<font color=#447700>!     ftlclx     Real(krealfp) temperature at the LCL in Kelvin<a name='2950'></font>
<font color=#447700>!<a name='2951'></font>
<font color=#447700>! Attributes:<a name='2952'></font>
<font color=#447700>!   Language: Fortran 90.<a name='2953'></font>
<font color=#447700>!<a name='2954'></font>
<font color=#447700>!$$$<a name='2955'></font>
    implicit none<a name='2956'>
    real(krealfp) ftlclx<a name='2957'>
    real(krealfp),intent(in):: t,tdpd<a name='2958'>
    real(krealfp),parameter:: terrm=1.e-4,tlmin=180.,tlminx=tlmin-5.<a name='2959'>
    real(krealfp) tr,pvdew,tlcl,ta,pvlcl,el,dpvlcl,terr,terrp<a name='2960'>
    integer i<a name='2961'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2962'></font>
    if(.not.initialized) call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS'>gfuncphys</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#FTLCLX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFUNCPHYS_45">()<a name='2963'>
    tr=con_ttp/(t-tdpd)<a name='2964'>
    pvdew=con_psat*(tr**con_xpona)*exp(con_xponb*(1.-tr))<a name='2965'>
    tlcl=t-tdpd<a name='2966'>
    do i=1,100<a name='2967'>
      tr=con_ttp/tlcl<a name='2968'>
      ta=t/tlcl<a name='2969'>
      pvlcl=con_psat*(tr**con_xpona)*exp(con_xponb*(1.-tr))*ta**(1/con_rocp)<a name='2970'>
      el=con_hvap+con_dldt*(tlcl-con_ttp)<a name='2971'>
      dpvlcl=(el/(con_rv*t**2)+1/(con_rocp*tlcl))*pvlcl<a name='2972'>
      terr=(pvlcl-pvdew)/dpvlcl<a name='2973'>
      tlcl=tlcl-terr<a name='2974'>
      if(abs(terr).le.terrm.or.tlcl.lt.tlminx) exit<a name='2975'>
    enddo<a name='2976'>
    ftlclx=max(tlcl,tlmin)<a name='2977'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='2978'></font>
  end function<a name='2979'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='2980'></font>
<A NAME='GFUNCPHYS'><A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2981'>
  <font color=#993300>subroutine </font><font color=#cc0000>gfuncphys</font> <A href='../../call_to/GFUNCPHYS.html' TARGET='index'>46</A>,<A href='../../call_from/GFUNCPHYS.html' TARGET='index'>11</A><a name='2982'>
<font color=#447700>!$$$     Subprogram Documentation Block<a name='2983'></font>
<font color=#447700>!<a name='2984'></font>
<font color=#447700>! Subprogram: gfuncphys    Compute all physics function tables<a name='2985'></font>
<font color=#447700>!   Author: N Phillips            w/NMC2X2   Date: 30 dec 82<a name='2986'></font>
<font color=#447700>!<a name='2987'></font>
<font color=#447700>! Abstract: Compute all physics function tables.  Lookup tables are<a name='2988'></font>
<font color=#447700>!   set up for computing saturation vapor pressure, dewpoint temperature,<a name='2989'></font>
<font color=#447700>!   equivalent potential temperature, moist adiabatic temperature and humidity,<a name='2990'></font>
<font color=#447700>!   pressure to the kappa, and lifting condensation level temperature.<a name='2991'></font>
<font color=#447700>!<a name='2992'></font>
<font color=#447700>! Program History Log:<a name='2993'></font>
<font color=#447700>! 1999-03-01  Iredell             f90 module<a name='2994'></font>
<font color=#447700>!<a name='2995'></font>
<font color=#447700>! Usage:  call gfuncphys<a name='2996'></font>
<font color=#447700>!<a name='2997'></font>
<font color=#447700>! Subprograms called:<a name='2998'></font>
<font color=#447700>!   gpvsl       compute saturation vapor pressure over liquid table<a name='2999'></font>
<font color=#447700>!   gpvsi       compute saturation vapor pressure over ice table<a name='3000'></font>
<font color=#447700>!   gpvs        compute saturation vapor pressure table<a name='3001'></font>
<font color=#447700>!   gtdpl       compute dewpoint temperature over liquid table<a name='3002'></font>
<font color=#447700>!   gtdpi       compute dewpoint temperature over ice table<a name='3003'></font>
<font color=#447700>!   gtdp        compute dewpoint temperature table<a name='3004'></font>
<font color=#447700>!   gthe        compute equivalent potential temperature table<a name='3005'></font>
<font color=#447700>!   gtma        compute moist adiabat tables<a name='3006'></font>
<font color=#447700>!   gpkap       compute pressure to the kappa table<a name='3007'></font>
<font color=#447700>!   grkap       compute pressure to the 1/kappa table<a name='3008'></font>
<font color=#447700>!   gtlcl       compute LCL temperature table<a name='3009'></font>
<font color=#447700>!<a name='3010'></font>
<font color=#447700>! Attributes:<a name='3011'></font>
<font color=#447700>!   Language: Fortran 90.<a name='3012'></font>
<font color=#447700>!<a name='3013'></font>
<font color=#447700>!$$$<a name='3014'></font>
    implicit none<a name='3015'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='3016'></font>
    initialized=.true.<a name='3017'>
    call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GPVSL'>gpvsl</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GPVSL_1"><a name='3018'>
    call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GPVSI'>gpvsi</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GPVSI_1"><a name='3019'>
    call <A href='../../html_code/phys/module_mp_HWRF.F.html#GPVS'>gpvs</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GPVS_2"><a name='3020'>
    call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GTDPL'>gtdpl</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GTDPL_1"><a name='3021'>
    call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GTDPI'>gtdpi</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GTDPI_1"><a name='3022'>
    call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GTDP'>gtdp</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GTDP_1"><a name='3023'>
    call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GTHE'>gthe</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GTHE_1"><a name='3024'>
    call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GTMA'>gtma</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GTMA_1"><a name='3025'>
    call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GPKAP'>gpkap</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GPKAP_1"><a name='3026'>
    call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GRKAP'>grkap</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GRKAP_1"><a name='3027'>
    call <A href='../../html_code/phys/module_gfs_funcphys.F.html#GTLCL'>gtlcl</A><A href='../../html_code/phys/module_gfs_funcphys.F.html#GFUNCPHYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GTLCL_1"><a name='3028'>
<font color=#447700>! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -<a name='3029'></font>
  end subroutine<a name='3030'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='3031'></font>
end module module_gfs_funcphys<a name='3032'>
</pre></body></html>