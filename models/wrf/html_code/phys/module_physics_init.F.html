<HTML> <BODY BGCOLOR=#ddddee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!WRF:MODEL_LAYER:INITIALIZATION<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<a name='4'>
<font color=#447700>!  This MODULE holds the routines which are used to perform model start-up operations<a name='5'></font>
<font color=#447700>!  for the individual domains.  This is the stage after inputting wrfinput and before<a name='6'></font>
<font color=#447700>!  calling 'integrate'.<a name='7'></font>
<a name='8'>
<font color=#447700>!  This MODULE CONTAINS the following routines:<a name='9'></font>
<a name='10'>
<a name='11'>
<A NAME='MODULE_PHYSICS_INIT'><A href='../../html_code/phys/module_physics_init.F.html#MODULE_PHYSICS_INIT' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='12'>
<font color=#993300>MODULE </font><font color=#cc0000>module_physics_init</font> <A href='../../call_to/MODULE_PHYSICS_INIT.html' TARGET='index'>2</A><a name='13'>
<a name='14'>
   USE <A href='../../html_code/frame/module_state_description.F.html#MODULE_STATE_DESCRIPTION'>module_state_description</A><A href='../../html_code/phys/module_physics_init.F.html#module_physics_init.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_STATE_DESCRIPTION_141"><a name='15'>
   USE <A href='../../html_code/share/module_model_constants.F.html#MODULE_MODEL_CONSTANTS'>module_model_constants</A><A href='../../html_code/phys/module_physics_init.F.html#module_physics_init.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MODEL_CONSTANTS_80"><a name='16'>
   USE <A href='../../html_code/frame/module_configure.F.html#MODULE_CONFIGURE'>module_configure</A><A href='../../html_code/phys/module_physics_init.F.html#module_physics_init.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CONFIGURE_159">, ONLY : grid_config_rec_type<a name='17'>
<font color=#447700>!  USE module_ssib_veg , ONLY : init_module_ssib_veg !fds (SSiB constants)<a name='18'></font>
   <font color=#447700>!Local data for CAM's MG MP scheme<a name='19'></font>
   integer  :: ixcldliq, ixcldice, ixnumliq, ixnumice<a name='20'>
   LOGICAL  :: CAM_INITIALIZED = .FALSE.<a name='21'>
   LOGICAL  :: WINDFARM_INITIALIZED = .FALSE.<a name='22'>
<a name='23'>
<a name='24'>
CONTAINS<a name='25'>
<a name='26'>
<a name='27'>
<font color=#447700>!=================================================================<a name='28'></font>
<A NAME='PHY_INIT'><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='29'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>phy_init</font> ( id, config_flags, DT, restart, zfull, zhalf,     &amp; <A href='../../call_to/PHY_INIT.html' TARGET='index'>2</A>,<A href='../../call_from/PHY_INIT.html' TARGET='index'>22</A><a name='30'>
                         p_top, TSK,RADT,BLDT,CUDT,MPDT,         &amp;<a name='31'>
                         RUCUTEN, RVCUTEN,                       &amp;<a name='32'>
                         RTHCUTEN, RQVCUTEN, RQRCUTEN,           &amp;<a name='33'>
                         RQCCUTEN, RQSCUTEN, RQICUTEN,           &amp;<a name='34'>
                         RUSHTEN,  RVSHTEN,  RTHSHTEN,           &amp;<a name='35'>
                         RQVSHTEN, RQRSHTEN, RQCSHTEN,           &amp;<a name='36'>
                         RQSSHTEN, RQISHTEN, RQGSHTEN,           &amp;<a name='37'>
                         RUBLTEN,RVBLTEN,RTHBLTEN,               &amp;<a name='38'>
                         RQVBLTEN,RQCBLTEN,RQIBLTEN,             &amp;<a name='39'>
                         RTHRATEN,RTHRATENLW,RTHRATENSW,         &amp;<a name='40'>
#if ( EM_CORE == 1 )<a name='41'>
                         <font color=#447700>!BSINGH - For WRFCuP scheme(11/12/2013)<a name='42'></font>
                         cupflag,cldfra_cup,cldfratend_cup,      &amp; <font color=#447700>!wig, 18-Sep-2006<a name='43'></font>
                         shall,                                  &amp; <font color=#447700>!wig, 18-Sep-2006<a name='44'></font>
                         tcloud_cup,                             &amp; <font color=#447700>!rce, 18-apr-2012<a name='45'></font>
                         <font color=#447700>!BSINGH - ENDS<a name='46'></font>
#endif<a name='47'>
                         STEPBL,STEPRA,STEPCU,                   &amp;<a name='48'>
                         W0AVG, RAINNC, RAINC, RAINCV, RAINNCV,  &amp;<a name='49'>
                         SNOWNC, SNOWNCV, GRAUPELNC, GRAUPELNCV, &amp;<a name='50'>
                         z_at_q, qnwfa2d, scalar, num_sc,        &amp; <font color=#447700>! G. Thompson<a name='51'></font>
                         re_cloud, re_ice, re_snow,              &amp; <font color=#447700>! G. Thompson<a name='52'></font>
                         has_reqc, has_reqi, has_reqs,           &amp; <font color=#447700>! G. Thompson<a name='53'></font>
                         NCA,swrad_scat,                         &amp;<a name='54'>
                         CLDEFI,LOWLYR,                          &amp;<a name='55'>
                         MASS_FLUX,                              &amp;<a name='56'>
                         RTHFTEN, RQVFTEN,                       &amp;<a name='57'>
                         CLDFRA,CLDFRA_OLD,GLW,GSW,EMISS,EMBCK,  &amp; <font color=#447700>!EMBCK new<a name='58'></font>
                         LU_INDEX,                               &amp;<a name='59'>
                         landuse_ISICE, landuse_LUCATS,          &amp;<a name='60'>
                         landuse_LUSEAS, landuse_ISN,            &amp;<a name='61'>
                         lu_state,                               &amp;<a name='62'>
                         XLAT,XLONG,xlong_u,xlat_v,ALBEDO,ALBBCK,GMT,JULYR,JULDAY,&amp;<a name='63'>
                         levsiz, n_ozmixm, n_aerosolc, paerlev,  &amp;<a name='64'>
                         alevsiz, no_src_types,                  &amp;<a name='65'>
                         TMN,XLAND,ZNT,Z0,UST,MOL,PBLH,TKE_PBL,  &amp;<a name='66'>
                         EXCH_H,THC,SNOWC,MAVAIL,HFX,QFX,RAINBL, &amp;<a name='67'>
                         TSLB,ZS,DZS,num_soil_layers,warm_rain,  &amp;<a name='68'>
                         adv_moist_cond,is_CAMMGMP_used,         &amp;<a name='69'>
                         APR_GR,APR_W,APR_MC,APR_ST,APR_AS,      &amp;<a name='70'>
                         APR_CAPMA,APR_CAPME,APR_CAPMI,          &amp;<a name='71'>
                         XICE,XICEM,VEGFRA,SNOW,CANWAT,SMSTAV,   &amp;<a name='72'>
                         SMSTOT, SFCRUNOFF,UDRUNOFF,GRDFLX,ACSNOW,&amp;<a name='73'>
                         ACSNOM,IVGTYP,ISLTYP, SFCEVP, SMOIS,    &amp;<a name='74'>
                         SH2O, SNOWH, SMFR3D,                    &amp;  <font color=#447700>! temporary<a name='75'></font>
                         SNOALB,                                 &amp;<a name='76'>
                         DX,DY,F_ICE_PHY,F_RAIN_PHY,F_RIMEF_PHY, &amp;<a name='77'>
                         mp_restart_state,tbpvs_state,tbpvs0_state,&amp;<a name='78'>
                         allowed_to_read, moved, start_of_simulation,&amp;<a name='79'>
                         LAGDAY,                                 &amp;<a name='80'>
                         ids, ide, jds, jde, kds, kde,           &amp;<a name='81'>
                         ims, ime, jms, jme, kms, kme,           &amp;<a name='82'>
                         its, ite, jts, jte, kts, kte,           &amp;<a name='83'>
                         NUM_URBAN_LAYERS,                       &amp;<a name='84'>
                         NUM_URBAN_HI,                           &amp;<a name='85'>
                         raincv_a,raincv_b,                      &amp;<a name='86'>
                         gd_cloud,gd_cloud2,                     &amp;    <font color=#447700>! Optional<a name='87'></font>
                         gd_cloud_a,gd_cloud2_a,                 &amp;    <font color=#447700>! Optional<a name='88'></font>
                         QC_CU,QI_CU,                            &amp;    <font color=#447700>! Optional<a name='89'></font>
                         ozmixm,pin,                             &amp;    <font color=#447700>! Optional<a name='90'></font>
                         aerodm,pina,                            &amp;    <font color=#447700>! Optional<a name='91'></font>
                         m_ps_1,m_ps_2,m_hybi,aerosolc_1,aerosolc_2,&amp; <font color=#447700>! Optional<a name='92'></font>
                         RUNDGDTEN,RVNDGDTEN,RTHNDGDTEN,         &amp;    <font color=#447700>! Optional<a name='93'></font>
                         RPHNDGDTEN,RQVNDGDTEN,RMUNDGDTEN,       &amp;    <font color=#447700>! Optional<a name='94'></font>
                         SDA_HFX, SDA_QFX, QNORM, HFX_BOTH, QFX_BOTH, &amp; <font color=#447700>! fasdas<a name='95'></font>
                         HFX_FDDA,                                    &amp; <font color=#447700>! fasdas<a name='96'></font>
                         FGDT,STEPFG,                            &amp;    <font color=#447700>! Optional<a name='97'></font>
                         cugd_tten,cugd_ttens,cugd_qvten,        &amp;    <font color=#447700>! Optional<a name='98'></font>
                         cugd_qvtens,cugd_qcten,                 &amp;    <font color=#447700>! Optional<a name='99'></font>
                         ISNOWXY, ZSNSOXY, TSNOXY,                        &amp; <font color=#447700>! Optional Noah-MP<a name='100'></font>
                         SNICEXY, SNLIQXY, TVXY, TGXY, CANICEXY,          &amp; <font color=#447700>! Optional Noah-MP<a name='101'></font>
                         CANLIQXY, EAHXY, TAHXY, CMXY,                    &amp; <font color=#447700>! Optional Noah-MP<a name='102'></font>
                         CHXY, FWETXY, SNEQVOXY, ALBOLDXY, QSNOWXY,       &amp; <font color=#447700>! Optional Noah-MP<a name='103'></font>
                         WSLAKEXY, ZWTXY, WAXY, WTXY, LFMASSXY, RTMASSXY, &amp; <font color=#447700>! Optional Noah-MP<a name='104'></font>
                         STMASSXY, WOODXY, STBLCPXY, FASTCPXY,            &amp; <font color=#447700>! Optional Noah-MP<a name='105'></font>
                         GRAINXY, GDDXY,                                  &amp; <font color=#447700>! Optional Noah-MP<a name='106'></font>
                         croptype, cropcat,                      &amp;           <font color=#447700>! Noah-MP Crop model<a name='107'></font>
                         XSAIXY, LAI,                                     &amp; <font color=#447700>! Optional Noah-MP<a name='108'></font>
                         T2MVXY, T2MBXY, CHSTARXY ,                       &amp; <font color=#447700>! Optional Noah-MP<a name='109'></font>
                         SMOISEQ  ,SMCWTDXY ,RECHXY, DEEPRECHXY, AREAXY,  &amp; <font color=#447700>! Optional Noah-MP <a name='110'></font>
                         WTDDT , STEPWTD ,QRFSXY ,QSPRINGSXY ,QSLATXY,    &amp; <font color=#447700>! Optional Noah-MP<a name='111'></font>
                         FDEPTHXY, RIVERBEDXY, EQZWT, RIVERCONDXY, PEXPXY, &amp; <font color=#447700>! Optional Noah-MP<a name='112'></font>
                         rechclim  ,                                       &amp; <font color=#447700>! Optional Noah-MP<a name='113'></font>
                         msftx, msfty,                           &amp;           <font color=#447700>! Optional Noah-MP<a name='114'></font>
<font color=#447700>!                        num_roof_layers,num_wall_layers,        &amp; !Optional urban<a name='115'></font>
<font color=#447700>!                        num_road_layers,                        &amp; !Optional urban<a name='116'></font>
                         DZR, DZB, DZG,                          &amp; <font color=#447700>!Optional urban<a name='117'></font>
                         TR_URB2D,TB_URB2D,TG_URB2D,TC_URB2D,    &amp; <font color=#447700>!Optional urban<a name='118'></font>
                         QC_URB2D, XXXR_URB2D,XXXB_URB2D,        &amp; <font color=#447700>!Optional urban<a name='119'></font>
                         XXXG_URB2D, XXXC_URB2D,                 &amp; <font color=#447700>!Optional urban<a name='120'></font>
                         TRL_URB3D, TBL_URB3D, TGL_URB3D,        &amp; <font color=#447700>!Optional urban<a name='121'></font>
                         SH_URB2D, LH_URB2D, G_URB2D, RN_URB2D,  &amp; <font color=#447700>!Optional urban<a name='122'></font>
                         TS_URB2D, FRC_URB2D, UTYPE_URB2D,       &amp; <font color=#447700>!Optional urban<a name='123'></font>
                         CMCR_URB2D,TGR_URB2D,TGRL_URB3D,SMR_URB3D, &amp; <font color=#447700>!Optional urban<a name='124'></font>
                         DRELR_URB2D,DRELB_URB2D,DRELG_URB2D,    &amp; <font color=#447700>!Optional urban<a name='125'></font>
                         FLXHUMR_URB2D,FLXHUMB_URB2D,            &amp; <font color=#447700>!Optional urban<a name='126'></font>
                         FLXHUMG_URB2D,                          &amp; <font color=#447700>!Optional urban<a name='127'></font>
                         TRB_URB4D,TW1_URB4D,TW2_URB4D,          &amp; <font color=#447700>!Optional multi-layer urban<a name='128'></font>
                         TGB_URB4D,TLEV_URB3D,QLEV_URB3D,        &amp; <font color=#447700>!Optional multi-layer urban<a name='129'></font>
                         TW1LEV_URB3D,TW2LEV_URB3D,              &amp; <font color=#447700>!Optional multi-layer urban<a name='130'></font>
                         TGLEV_URB3D,TFLEV_URB3D,                &amp; <font color=#447700>!Optional multi-layer urban<a name='131'></font>
                         SF_AC_URB3D,LF_AC_URB3D,CM_AC_URB3D,    &amp; <font color=#447700>!Optional multi-layer urban<a name='132'></font>
                         SFVENT_URB3D,LFVENT_URB3D,              &amp; <font color=#447700>!Optional multi-layer urban<a name='133'></font>
                         SFWIN1_URB3D,SFWIN2_URB3D,              &amp; <font color=#447700>!Optional multi-layer urban<a name='134'></font>
                         SFW1_URB3D,SFW2_URB3D,                  &amp; <font color=#447700>!Optional multi-layer urban<a name='135'></font>
                         SFR_URB3D,SFG_URB3D,                    &amp; <font color=#447700>!Optional multi-layer urban<a name='136'></font>
                         LP_URB2D,HI_URB2D,LB_URB2D,             &amp; <font color=#447700>!Optional multi-layer urban<a name='137'></font>
                         HGT_URB2D,MH_URB2D,STDH_URB2D,          &amp; <font color=#447700>!Optional multi-layer urban<a name='138'></font>
                         LF_URB2D,                               &amp; <font color=#447700>!Optional multi-layer urban<a name='139'></font>
                         A_U_BEP,A_V_BEP,A_T_BEP,A_Q_BEP,        &amp; <font color=#447700>!Optional multi-layer urban<a name='140'></font>
                         A_E_BEP,B_U_BEP,B_V_BEP,                &amp; <font color=#447700>!Optional multi-layer urban<a name='141'></font>
                         B_T_BEP,B_Q_BEP,B_E_BEP,DLG_BEP,        &amp; <font color=#447700>!Optional multi-layer urban<a name='142'></font>
                         DL_U_BEP,SF_BEP,VL_BEP,                 &amp; <font color=#447700>!Optional multi-layer urban<a name='143'></font>
                         TML,T0ML,HML,H0ML,HUML,HVML,TMOML,      &amp; <font color=#447700>!Optional oml<a name='144'></font>
                         lakedepth2d,  savedtke12d,  snowdp2d,   h2osno2d,       &amp; <font color=#447700>!lake<a name='145'></font>
                         snl2d,        t_grnd2d,     t_lake3d,   lake_icefrac3d, &amp; <font color=#447700>!lake<a name='146'></font>
                         z_lake3d,     dz_lake3d,    t_soisno3d, h2osoi_ice3d,   &amp; <font color=#447700>!lake<a name='147'></font>
                         h2osoi_liq3d, h2osoi_vol3d, z3d,        dz3d,           &amp; <font color=#447700>!lake<a name='148'></font>
                         zi3d,         watsat3d,     csol3d,     tkmg3d,         &amp; <font color=#447700>!lake<a name='149'></font>
                         tkdry3d,      tksatu3d,     lake2d,     lakedepth_default, &amp; <font color=#447700>!lake<a name='150'></font>
                         lake_min_elev,   lake_depth,                               &amp; <font color=#447700>!lake<a name='151'></font>
#if ( EM_CORE == 1 )<a name='152'>
                         lakemask,   lakeflag,                                   &amp; <font color=#447700>!lake<a name='153'></font>
#endif<a name='154'>
                         lake_depth_flag, use_lakedepth,                         &amp; <font color=#447700>!lake<a name='155'></font>
                         sf_surface_mosaic, mosaic_cat, NLCAT,               &amp; <font color=#447700>! Noah tiling<a name='156'></font>
<font color=#447700>!CLM variables<a name='157'></font>
                         maxpatch,                                           &amp;<a name='158'>
                         numc,nump,snl,                                      &amp;<a name='159'>
                         snowdp,wtc,wtp,h2osno,t_grnd,t_veg,                 &amp;<a name='160'>
                         h2ocan,h2ocan_col,t2m_max,t2m_min,t_ref2m,          &amp;<a name='161'>
                         h2osoi_liq_s1,                                      &amp;<a name='162'>
                         h2osoi_liq_s2,h2osoi_liq_s3,h2osoi_liq_s4,          &amp;<a name='163'>
                         h2osoi_liq_s5,h2osoi_liq1,h2osoi_liq2,              &amp;<a name='164'>
                         h2osoi_liq3,h2osoi_liq4,h2osoi_liq5,h2osoi_liq6,    &amp;<a name='165'>
                         h2osoi_liq7,h2osoi_liq8,h2osoi_liq9,h2osoi_liq10,   &amp;<a name='166'>
                         h2osoi_ice_s1,h2osoi_ice_s2,                        &amp;<a name='167'>
                         h2osoi_ice_s3,h2osoi_ice_s4,h2osoi_ice_s5,          &amp;<a name='168'>
                         h2osoi_ice1,h2osoi_ice2,h2osoi_ice3,h2osoi_ice4,    &amp;<a name='169'>
                         h2osoi_ice5,h2osoi_ice6,h2osoi_ice7,                &amp;<a name='170'>
                         h2osoi_ice8,h2osoi_ice9,h2osoi_ice10,               &amp;<a name='171'>
                         t_soisno_s1,t_soisno_s2,t_soisno_s3,t_soisno_s4,    &amp;<a name='172'>
                         t_soisno_s5,t_soisno1,t_soisno2,t_soisno3,          &amp;<a name='173'>
                         t_soisno4,t_soisno5,t_soisno6,t_soisno7,            &amp;<a name='174'>
                         t_soisno8,t_soisno9,t_soisno10,                     &amp;<a name='175'>
                         dzsnow1,dzsnow2,dzsnow3,dzsnow4,dzsnow5,            &amp;<a name='176'>
                         snowrds1,snowrds2,snowrds3,snowrds4,snowrds5,       &amp;<a name='177'>
                         t_lake1,t_lake2,t_lake3,t_lake4,t_lake5,            &amp;<a name='178'>
                         t_lake6,t_lake7,t_lake8,t_lake9,t_lake10,           &amp;<a name='179'>
                         h2osoi_vol1,h2osoi_vol2,h2osoi_vol3,                &amp;<a name='180'>
                         h2osoi_vol4,h2osoi_vol5,h2osoi_vol6,                &amp;<a name='181'>
                         h2osoi_vol7,h2osoi_vol8,                            &amp;<a name='182'>
                         h2osoi_vol9,h2osoi_vol10,                           &amp;<a name='183'>
                         ht,                                                 &amp;<a name='184'>
                         ALBEDOsubgrid,LHsubgrid,HFXsubgrid,LWUPsubgrid,     &amp;<a name='185'>
                         Q2subgrid,SABVsubgrid,SABGsubgrid,NRAsubgrid,       &amp;<a name='186'>
                         SWUPsubgrid,lhsoi,lhveg,lhtran,                     &amp;<a name='187'>
<font color=#447700>! end of CLM variables<a name='188'></font>
                         TSK_SAVE,                               &amp; <font color=#447700>!Optional for fractional seaice<a name='189'></font>
                         itimestep,                              &amp; <font color=#447700>!Optional obs fdda<a name='190'></font>
#if ( EM_CORE == 1 )<a name='191'>
                         fdob,                                   &amp; <font color=#447700>!Optional obs fdda<a name='192'></font>
#endif<a name='193'>
                         t00, p00, tlp,                          &amp; <font color=#447700>!for obs-nudging<a name='194'></font>
                         TYR,TYRA,TDLY,TLAG,NYEAR,NDAY,tmn_update,   &amp;<a name='195'>
                         ACHFX,ACLHF,ACGRDFLX,                   &amp;<a name='196'>
                         nssl_cccn,                              &amp;<a name='197'>
                         nssl_alphah,nssl_alphahl,               &amp;<a name='198'>
                         nssl_cnoh, nssl_cnohl,                  &amp;<a name='199'>
                         nssl_cnor, nssl_cnos,                   &amp;<a name='200'>
                         nssl_rho_qh, nssl_rho_qhl,              &amp;<a name='201'>
                         nssl_rho_qs,                             &amp;<a name='202'>
<font color=#447700>! next 2 flags for Explicit lightning:<a name='203'></font>
                         nssl_ipelec,                             &amp;<a name='204'>
                         nssl_isaund,                             &amp;<a name='205'>
   <font color=#447700>! OPTIONAL <a name='206'></font>
                         RQCNCUTEN, RQINCUTEN,                   &amp;<a name='207'>
                         rliq,                                   &amp;  <font color=#447700>!BSINGH:01/31/2013 - Added rliq and is_CAMMGMP_used for CAM5 physics<a name='208'></font>
                         cldfra_dp,cldfra_sh                     &amp; <font color=#447700>!ckay for subgrid cloud<a name='209'></font>
                         ,te_temf                                &amp; <font color=#447700>! WA 12/21/09<a name='210'></font>
                         ,cf3d_temf                              &amp; <font color=#447700>! WA 9/27/10<a name='211'></font>
                         ,wm_temf                                &amp; <font color=#447700>! WA 2/22/11<a name='212'></font>
                         ,massflux_EDKF, entr_EDKF, detr_EDKF  &amp; <font color=#447700>! Optional for qnse<a name='213'></font>
                         ,thl_up, thv_up, rt_up                &amp; <font color=#447700>! Optional for qnse<a name='214'></font>
                         ,rv_up, rc_up, u_up, v_up, frac_up    &amp; <font color=#447700>! Optional for qnse<a name='215'></font>
                         ,ccn_conc                             &amp; <font color=#447700>! RAS<a name='216'></font>
                         ,QKE                                  &amp; <font color=#447700>!for MYNN<a name='217'></font>
                         ,landusef,landusef2,mosaic_cat_index                                                 &amp; <font color=#447700>! danli mosaic<a name='218'></font>
                         ,TSK_mosaic,TSLB_mosaic,SMOIS_mosaic,SH2O_mosaic                                     &amp; <font color=#447700>! danli mosaic<a name='219'></font>
                         ,CANWAT_mosaic,SNOW_mosaic,SNOWH_mosaic,SNOWC_mosaic                                 &amp; <font color=#447700>! danli mosaic<a name='220'></font>
                         ,ALBEDO_mosaic,ALBBCK_mosaic, EMISS_mosaic, EMBCK_mosaic, ZNT_mosaic, Z0_mosaic      &amp; <font color=#447700>! danli mosaic<a name='221'></font>
                         ,TR_URB2D_mosaic,TB_URB2D_mosaic                                                     &amp; <font color=#447700>! danli mosaic <a name='222'></font>
                         ,TG_URB2D_mosaic,TC_URB2D_mosaic                                                     &amp; <font color=#447700>! danli mosaic <a name='223'></font>
                         ,QC_URB2D_mosaic                                                                     &amp; <font color=#447700>! danli mosaic<a name='224'></font>
                         ,TRL_URB3D_mosaic,TBL_URB3D_mosaic                                                   &amp; <font color=#447700>! danli mosaic <a name='225'></font>
                         ,TGL_URB3D_mosaic                                                                    &amp; <font color=#447700>! danli mosaic <a name='226'></font>
                         ,SH_URB2D_mosaic,LH_URB2D_mosaic                                                     &amp; <font color=#447700>! danli mosaic <a name='227'></font>
                         ,G_URB2D_mosaic,RN_URB2D_mosaic                                                      &amp; <font color=#447700>! danli mosaic <a name='228'></font>
                         ,TS_URB2D_mosaic                                                                     &amp; <font color=#447700>! danli mosaic <a name='229'></font>
                         ,TS_RUL2D_mosaic                                                                     &amp; <font color=#447700>! danli mosaic<a name='230'></font>
                         )<a name='231'>
<a name='232'>
<font color=#447700>!-----------------------------------------------------------------<a name='233'></font>
   USE <A href='../../html_code/frame/module_domain.F.html#MODULE_DOMAIN'>module_domain</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DOMAIN_244"><a name='234'>
   USE <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_67"><a name='235'>
   use <A href='../../html_code/phys/module_sf_lake.F.html#MODULE_SF_LAKE'>module_sf_lake</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_LAKE_1">, only : nlevsoil,nlevsnow,nlevlake<a name='236'>
#if ( WRF_CHEM == 1 )<a name='237'>
   USE <A href='../../html_code/phys/module_cam_support.F.html#MODULE_CAM_SUPPORT'>module_cam_support</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CAM_SUPPORT_47">,         ONLY : cam_mam_aerosols<a name='238'>
#endif<a name='239'>
   USE <A href='../../html_code/phys/module_wind_fitch.F.html#MODULE_WIND_FITCH'>module_wind_fitch</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WIND_FITCH_2"><a name='240'>
   IMPLICIT NONE<a name='241'>
<font color=#447700>!-----------------------------------------------------------------<a name='242'></font>
   TYPE (grid_config_rec_type)              :: config_flags<a name='243'>
<a name='244'>
   INTEGER , INTENT(IN)        :: id<a name='245'>
   INTEGER , INTENT(IN) ,OPTIONAL       :: tmn_update<a name='246'>
   LOGICAL , INTENT(OUT)       :: warm_rain,adv_moist_cond<a name='247'>
   LOGICAL , INTENT(OUT)       :: is_CAMMGMP_used <font color=#447700>!BSINGH:01/31/2013 - Added for CAM5 physics<a name='248'></font>
<font color=#447700>!   LOGICAL , INTENT (IN)       :: FNDSOILW, FNDSNOWH<a name='249'></font>
   LOGICAL, PARAMETER          :: FNDSOILW=.true., FNDSNOWH=.true.<a name='250'>
   INTEGER , INTENT(IN)        :: ids, ide, jds, jde, kds, kde,  &amp;<a name='251'>
                                  ims, ime, jms, jme, kms, kme,  &amp;<a name='252'>
                                  its, ite, jts, jte, kts, kte<a name='253'>
<a name='254'>
   INTEGER , INTENT(IN)        :: num_soil_layers<a name='255'>
   INTEGER , INTENT(IN)        :: lagday<a name='256'>
   INTEGER , INTENT(OUT) ,OPTIONAL      :: nyear<a name='257'>
   REAL    , INTENT(OUT) ,OPTIONAL      :: nday<a name='258'>
<a name='259'>
   LOGICAL,  INTENT(IN)        :: start_of_simulation<a name='260'>
   REAL,     INTENT(IN)        :: DT, p_top, DX, DY<a name='261'>
   LOGICAL,  INTENT(IN)        :: restart<a name='262'>
   REAL,     INTENT(IN)        :: RADT,BLDT,CUDT,MPDT<a name='263'>
   REAL,     INTENT(IN)        :: swrad_scat<a name='264'>
<a name='265'>
   REAL,     DIMENSION( kms:kme ) , INTENT(IN) :: zfull, zhalf<a name='266'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(IN) :: TSK, XLAT, XLONG,xlong_u,xlat_v<a name='267'>
   REAL,  DIMENSION(ims:ime,jms:jme), INTENT(IN) , OPTIONAL :: msftx,msfty<a name='268'>
<a name='269'>
   INTEGER,      INTENT(IN   )    ::   levsiz, n_ozmixm<a name='270'>
   INTEGER,      INTENT(IN   )    ::   paerlev, n_aerosolc<a name='271'>
   INTEGER,      INTENT(IN   )    ::   alevsiz, no_src_types<a name='272'>
<a name='273'>
   REAL,  DIMENSION( ims:ime, levsiz, jms:jme, n_ozmixm ), OPTIONAL, &amp;<a name='274'>
          INTENT(INOUT) ::                                  OZMIXM<a name='275'>
   REAL,  DIMENSION( ims:ime, alevsiz, jms:jme, n_ozmixm-1, no_src_types ), OPTIONAL, &amp;<a name='276'>
          INTENT(INOUT) ::                                  aerodm<a name='277'>
<a name='278'>
   REAL,  DIMENSION(levsiz), OPTIONAL, INTENT(INOUT)  ::        PIN<a name='279'>
   REAL,  DIMENSION(alevsiz), OPTIONAL, INTENT(INOUT)  ::       PINA<a name='280'>
<a name='281'>
   REAL,  DIMENSION(ims:ime,jms:jme), OPTIONAL, INTENT(INOUT)  :: m_ps_1,m_ps_2<a name='282'>
   REAL,  DIMENSION(paerlev), OPTIONAL,INTENT(INOUT)  ::          m_hybi<a name='283'>
   REAL,  DIMENSION( ims:ime, paerlev, jms:jme, n_aerosolc ), OPTIONAL, &amp;<a name='284'>
          INTENT(INOUT) ::                    aerosolc_1, aerosolc_2<a name='285'>
<a name='286'>
   REAL,     DIMENSION( ims:ime , 1:num_soil_layers , jms:jme ),&amp;<a name='287'>
                 INTENT(INOUT) :: SMOIS, SH2O,TSLB<a name='288'>
   REAL,     DIMENSION( ims:ime , 1:num_soil_layers , jms:jme ), INTENT(OUT) :: SMFR3D<a name='289'>
<a name='290'>
   REAL,    DIMENSION( ims:ime, jms:jme )                     , &amp;<a name='291'>
            INTENT(INOUT)    ::                           SNOW, &amp;<a name='292'>
                                                         SNOWC, &amp;<a name='293'>
                                                         SNOWH, &amp;<a name='294'>
                                                        CANWAT, &amp;<a name='295'>
                                                        SMSTAV, &amp;<a name='296'>
                                                        SMSTOT, &amp;<a name='297'>
                                                     SFCRUNOFF, &amp;<a name='298'>
                                                      UDRUNOFF, &amp;<a name='299'>
                                                        SFCEVP, &amp;<a name='300'>
                                                        GRDFLX, &amp;<a name='301'>
                                                        ACSNOW, &amp;<a name='302'>
                                                          XICE, &amp;<a name='303'>
                                                         XICEM, &amp;<a name='304'>
                                                        VEGFRA, &amp;<a name='305'>
                                                        ACSNOM<a name='306'>
   REAL,    DIMENSION( ims:ime, jms:jme ), OPTIONAL, INTENT(INOUT) ::   rliq    <a name='307'>
<a name='308'>
   REAL,    DIMENSION( ims:ime, jms:jme )                     , &amp;<a name='309'>
            OPTIONAL, INTENT(INOUT)    ::                ACHFX, &amp;<a name='310'>
                                                         ACLHF, &amp;<a name='311'>
                                                      ACGRDFLX<a name='312'>
<a name='313'>
   INTEGER, DIMENSION( ims:ime, jms:jme )                     , &amp;<a name='314'>
            INTENT(INOUT)    ::                         IVGTYP, &amp;<a name='315'>
                                                        ISLTYP<a name='316'>
<a name='317'>
   INTEGER                             ::             HAIL_OPT<a name='318'>
#if ( EM_CORE == 1 )<a name='319'>
   <font color=#447700>!BSINGH - For WRFCuP scheme<a name='320'></font>
   REAL, DIMENSION( ims:ime, jms:jme )                        , &amp;<a name='321'>
        INTENT(INOUT)    ::                          shall, &amp; <font color=#447700>!CuP, wig 18-Sep-2006<a name='322'></font>
                                                    tcloud_cup    <font color=#447700>!CuP, rce 18-apr-2012<a name='323'></font>
   <font color=#447700>!BSINGH - ENDS<a name='324'></font>
#endif<a name='325'>
<font color=#447700>! rad<a name='326'></font>
<a name='327'>
<font color=#447700>!..Added by G. Thompson to couple cloud physics variables with RRTMG radiation.<a name='328'></font>
   REAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: re_cloud, &amp;<a name='329'>
             re_ice, re_snow<a name='330'>
   INTEGER, INTENT(INOUT):: has_reqc, has_reqi, has_reqs<a name='331'>
<a name='332'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) ::    &amp;<font color=#447700>!BSINGH(PNNL)- should be declared inout<a name='333'></font>
             RTHRATEN, RTHRATENLW, RTHRATENSW, CLDFRA<a name='334'>
<a name='335'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , OPTIONAL, INTENT(INOUT) :: &amp;<font color=#447700>!BSINGH(PNNL)- should be declared inout<a name='336'></font>
             CLDFRA_OLD<a name='337'>
<a name='338'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , OPTIONAL, INTENT(INOUT) :: &amp; <font color=#447700>! ckay for subgrid cloud<a name='339'></font>
             cldfra_dp, cldfra_sh<a name='340'>
<a name='341'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT) ::         &amp;<a name='342'>
             GSW,ALBEDO,ALBBCK,GLW,EMISS,EMBCK                          <font color=#447700>!EMBCK new<a name='343'></font>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT) ::   SNOALB<a name='344'>
<a name='345'>
<a name='346'>
   REAL,     INTENT(IN) :: GMT<a name='347'>
<a name='348'>
   INTEGER , INTENT(OUT) :: STEPRA, STEPBL, STEPCU<a name='349'>
   INTEGER , INTENT(IN) :: JULYR, JULDAY<a name='350'>
<a name='351'>
<font color=#447700>! cps<a name='352'></font>
<a name='353'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) :: &amp; <font color=#447700>!BSINGH(PNNL)- should be declared inout<a name='354'></font>
             RUCUTEN, RVCUTEN, RTHCUTEN, RQVCUTEN, RQRCUTEN, RQCCUTEN, &amp;<a name='355'>
             RQSCUTEN, RQICUTEN,                                       &amp;<a name='356'>
             RUSHTEN, RVSHTEN, RTHSHTEN, RQVSHTEN, RQRSHTEN, RQCSHTEN, &amp;<a name='357'>
             RQSSHTEN, RQISHTEN, RQGSHTEN<a name='358'>
#if ( EM_CORE == 1 )<a name='359'>
   <font color=#447700>!BSINGH - For WRFCuP scheme<a name='360'></font>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) :: &amp;<a name='361'>
        cldfra_cup,cldfratend_cup                              <font color=#447700>!CuP, wig 18-Sep-2006<a name='362'></font>
<a name='363'>
   LOGICAL,  DIMENSION( ims:ime , jms:jme ) , INTENT(OUT) :: cupflag <font color=#447700>!CuP, wig 9-Oct-2006<a name='364'></font>
   <font color=#447700>!BSINGH -ENDS<a name='365'></font>
#endif<a name='366'>
<a name='367'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT), OPTIONAL :: RQCNCUTEN, RQINCUTEN <a name='368'>
<a name='369'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(OUT) :: W0AVG<a name='370'>
<a name='371'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(OUT) :: MASS_FLUX,   &amp;<a name='372'>
                      APR_GR,APR_W,APR_MC,APR_ST,APR_AS,          &amp;<a name='373'>
                      APR_CAPMA,APR_CAPME,APR_CAPMI<a name='374'>
<a name='375'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) ::    &amp; <font color=#447700>!BSINGH(PNNL)- should be declared inout<a name='376'></font>
             RTHFTEN, RQVFTEN<a name='377'>
<a name='378'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(OUT) ::           &amp;<a name='379'>
             RAINNC, RAINC, RAINCV, RAINNCV,  &amp;<a name='380'>
             SNOWNC, SNOWNCV, GRAUPELNC, GRAUPELNCV<a name='381'>
   REAL,     DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(IN) :: z_at_q            <font color=#447700>!  G. Thompson<a name='382'></font>
   REAL,     DIMENSION(ims:ime,jms:jme), INTENT(INOUT) :: qnwfa2d                <font color=#447700>!  G. Thompson<a name='383'></font>
   INTEGER,  INTENT(IN) :: num_sc                                                <font color=#447700>!  G. Thompson<a name='384'></font>
   REAL,     DIMENSION(ims:ime,kms:kme,jms:jme,num_sc), INTENT(INOUT) :: scalar  <font color=#447700>!  G. Thompson<a name='385'></font>
<a name='386'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(OUT) :: CLDEFI, NCA<a name='387'>
<a name='388'>
   INTEGER,  DIMENSION( ims:ime , jms:jme ) , INTENT(OUT) :: LOWLYR<a name='389'>
<a name='390'>
<font color=#447700>!pbl<a name='391'></font>
<a name='392'>
   <font color=#447700>! soil layer<a name='393'></font>
<a name='394'>
<a name='395'>
   REAL,     DIMENSION(1:num_soil_layers),      INTENT(INOUT) :: ZS,DZS<a name='396'>
<a name='397'>
  REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) ::    &amp; <font color=#447700>!BSINGH(PNNL)- should be declared inout<a name='398'></font>
             RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN,RQCBLTEN,RQIBLTEN,EXCH_H,TKE_PBL<a name='399'>
  REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT), OPTIONAL :: QKE<a name='400'>
<a name='401'>
  REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(OUT), OPTIONAL :: &amp;<a name='402'>
                                            massflux_EDKF, entr_EDKF, detr_EDKF &amp; <a name='403'>
                                                   ,thl_up, thv_up, rt_up       &amp;<a name='404'>
                                                   ,rv_up, rc_up, u_up, v_up    &amp;<a name='405'>
                                                   ,frac_up<a name='406'>
<a name='407'>
<a name='408'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , OPTIONAL, INTENT(OUT) ::    &amp;<a name='409'>
             cugd_tten,cugd_ttens,cugd_qvten,                &amp;<a name='410'>
             cugd_qvtens,cugd_qcten<a name='411'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT) ::         &amp;<a name='412'>
             XLAND,ZNT,Z0,UST,MOL,LU_INDEX,                         &amp;<a name='413'>
             PBLH,THC,MAVAIL,HFX,QFX,RAINBL<a name='414'>
   INTEGER , INTENT(INOUT)  :: landuse_ISICE, landuse_LUCATS<a name='415'>
   INTEGER , INTENT(INOUT)  :: landuse_LUSEAS, landuse_ISN<a name='416'>
   REAL    , INTENT(INOUT)  , DIMENSION( : ) :: lu_state<a name='417'>
<a name='418'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT) :: TMN<a name='419'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT),OPTIONAL :: TYR<a name='420'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT),OPTIONAL :: TYRA<a name='421'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT),OPTIONAL :: TDLY<a name='422'>
   REAL,     DIMENSION( ims:ime , 1:lagday , jms:jme ) , INTENT(INOUT),OPTIONAL :: TLAG<a name='423'>
<a name='424'>
<a name='425'>
   REAL,  DIMENSION( ims:ime , kms:kme , jms:jme )         ,         &amp;<a name='426'>
          OPTIONAL,                                                  &amp;<a name='427'>
          INTENT(INOUT   ) ::                                        &amp;<a name='428'>
                               gd_cloud, gd_cloud2,                  &amp;<a name='429'>
                               gd_cloud_a, gd_cloud2_a,              &amp;<a name='430'>
                               QC_CU, QI_CU<a name='431'>
<a name='432'>
   REAL,  DIMENSION( ims:ime ,  jms:jme )         ,         &amp;<a name='433'>
          INTENT(INOUT   ) ::                                        &amp;<a name='434'>
                               raincv_a,raincv_b<a name='435'>
<a name='436'>
<font color=#447700>!Noah-MP<a name='437'></font>
<a name='438'>
<a name='439'>
   INTEGER, OPTIONAL, DIMENSION(ims:ime,jms:jme) :: ISNOWXY<a name='440'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,-2:num_soil_layers, jms:jme) :: ZSNSOXY<a name='441'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,-2:0, jms:jme) :: TSNOXY<a name='442'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,-2:0, jms:jme) :: SNICEXY<a name='443'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,-2:0, jms:jme) :: SNLIQXY<a name='444'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: TVXY<a name='445'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: TGXY<a name='446'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: CANICEXY<a name='447'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: CANLIQXY<a name='448'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: EAHXY<a name='449'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: TAHXY<a name='450'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: CMXY<a name='451'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: CHXY<a name='452'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: FWETXY<a name='453'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: SNEQVOXY<a name='454'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: ALBOLDXY<a name='455'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: QSNOWXY<a name='456'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: WSLAKEXY<a name='457'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: ZWTXY<a name='458'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: WAXY<a name='459'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: WTXY<a name='460'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: LFMASSXY<a name='461'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: RTMASSXY<a name='462'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: STMASSXY<a name='463'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: WOODXY<a name='464'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: GRAINXY<a name='465'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: GDDXY<a name='466'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: STBLCPXY<a name='467'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: FASTCPXY<a name='468'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: XSAIXY<a name='469'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: LAI<a name='470'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: T2MVXY<a name='471'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: T2MBXY<a name='472'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: CHSTARXY<a name='473'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,1:num_soil_layers,jms:jme) :: SMOISEQ <a name='474'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: SMCWTDXY   <a name='475'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: DEEPRECHXY<a name='476'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: RECHXY<a name='477'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: QRFSXY       <a name='478'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: QSPRINGSXY<a name='479'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: QSLATXY <a name='480'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: AREAXY<a name='481'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme), INTENT(IN) :: FDEPTHXY<a name='482'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme), INTENT(IN) :: RIVERBEDXY<a name='483'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme), INTENT(IN) :: EQZWT<a name='484'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: RIVERCONDXY<a name='485'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: PEXPXY<a name='486'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme), INTENT(IN) :: rechclim<a name='487'>
   INTEGER, OPTIONAL, DIMENSION(ims:ime,  jms:jme), INTENT(OUT) :: CROPCAT<a name='488'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,5,jms:jme), INTENT(IN ) :: CROPTYPE<a name='489'>
<a name='490'>
<font color=#447700>!   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),  OPTIONAL,  INTENT(INOUT ) ::   qnn_curr<a name='491'></font>
<a name='492'>
   INTEGER , OPTIONAL,  INTENT(OUT) :: STEPWTD<a name='493'>
   REAL , OPTIONAL, INTENT(IN) :: WTDDT<a name='494'>
<a name='495'>
<font color=#447700>!mp<a name='496'></font>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(OUT) ::   &amp;<a name='497'>
             F_ICE_PHY,F_RAIN_PHY,F_RIMEF_PHY<a name='498'>
   REAL, DIMENSION(:), INTENT(INOUT)   :: mp_restart_state,tbpvs_state,tbpvs0_state<a name='499'>
   LOGICAL,  INTENT(IN)  :: allowed_to_read, moved<a name='500'>
   REAL, INTENT(INOUT) :: ccn_conc <font color=#447700>! RAS<a name='501'></font>
<a name='502'>
<a name='503'>
<font color=#447700>! ocean mixed layer<a name='504'></font>
   REAL,     DIMENSION( ims:ime , jms:jme ) , OPTIONAL, INTENT(INOUT) ::    &amp;<a name='505'>
             TML,T0ML,HML,H0ML,HUML,HVML,TMOML<a name='506'>
<font color=#447700>! fractional seaice<a name='507'></font>
   REAL,     DIMENSION( ims:ime , jms:jme ) , OPTIONAL, INTENT(INOUT) ::    &amp;<a name='508'>
             TSK_SAVE<a name='509'>
<font color=#447700>!fdda<a name='510'></font>
   REAL,     OPTIONAL, INTENT(IN) :: FGDT<a name='511'>
   INTEGER , OPTIONAL, INTENT(OUT) :: STEPFG<a name='512'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , OPTIONAL, INTENT(INOUT) ::    &amp;<font color=#447700>!BSINGH(PNNL)- should be declared inout<a name='513'></font>
             RUNDGDTEN, RVNDGDTEN, RTHNDGDTEN, RPHNDGDTEN, RQVNDGDTEN<a name='514'>
<font color=#447700>!<a name='515'></font>
<font color=#447700>! FASDAS<a name='516'></font>
<font color=#447700>!<a name='517'></font>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT), OPTIONAL ::  &amp;<a name='518'>
             SDA_HFX, SDA_QFX, QNORM, HFX_BOTH, QFX_BOTH<a name='519'>
<font color=#447700>!  INTEGER,  INTENT(IN   )                                            ::  fasdas<a name='520'></font>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , OPTIONAL, INTENT(INOUT) ::    &amp;<a name='521'>
             HFX_FDDA<a name='522'>
<font color=#447700>!<a name='523'></font>
   REAL,     DIMENSION( ims:ime , jms:jme ) , OPTIONAL, INTENT(INOUT) ::    &amp;<a name='524'>
             RMUNDGDTEN<a name='525'>
<a name='526'>
<font color=#447700>!URBAN<a name='527'></font>
<font color=#447700>!   REAL, DIMENSION(1:num_roof_layers), INTENT(INOUT) :: DZR   !urban<a name='528'></font>
<font color=#447700>!   REAL, DIMENSION(1:num_wall_layers), INTENT(INOUT) :: DZB   !urban<a name='529'></font>
<font color=#447700>!   REAL, DIMENSION(1:num_road_layers), INTENT(INOUT) :: DZG   !urban<a name='530'></font>
   REAL, OPTIONAL, DIMENSION(1:num_soil_layers), INTENT(INOUT) :: DZR    <font color=#447700>!urban<a name='531'></font>
   REAL, OPTIONAL, DIMENSION(1:num_soil_layers), INTENT(INOUT) :: DZB    <font color=#447700>!urban<a name='532'></font>
   REAL, OPTIONAL, DIMENSION(1:num_soil_layers), INTENT(INOUT) :: DZG    <font color=#447700>!urban<a name='533'></font>
<a name='534'>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: TR_URB2D <font color=#447700>!urban<a name='535'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: TB_URB2D <font color=#447700>!urban<a name='536'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: TG_URB2D <font color=#447700>!urban<a name='537'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: TC_URB2D <font color=#447700>!urban<a name='538'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: QC_URB2D <font color=#447700>!urban<a name='539'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: XXXR_URB2D <font color=#447700>!urban<a name='540'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: XXXB_URB2D <font color=#447700>!urban<a name='541'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: XXXG_URB2D <font color=#447700>!urban<a name='542'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: XXXC_URB2D <font color=#447700>!urban<a name='543'></font>
<a name='544'>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: DRELR_URB2D<a name='545'>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: DRELB_URB2D<a name='546'>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: DRELG_URB2D<a name='547'>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: FLXHUMR_URB2D<a name='548'>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: FLXHUMB_URB2D<a name='549'>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: FLXHUMG_URB2D<a name='550'>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: CMCR_URB2D<a name='551'>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: TGR_URB2D<a name='552'>
<a name='553'>
<font color=#447700>!   REAL, DIMENSION(ims:ime, 1:num_roof_layers, jms:jme), INTENT(INOUT) :: TRL_URB3D !urban<a name='554'></font>
<font color=#447700>!   REAL, DIMENSION(ims:ime, 1:num_wall_layers, jms:jme), INTENT(INOUT) :: TBL_URB3D !urban<a name='555'></font>
<font color=#447700>!   REAL, DIMENSION(ims:ime, 1:num_road_layers, jms:jme), INTENT(INOUT) :: TGL_URB3D !urban<a name='556'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_soil_layers, jms:jme), INTENT(INOUT) :: TRL_URB3D  <font color=#447700>!urban<a name='557'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_soil_layers, jms:jme), INTENT(INOUT) :: TBL_URB3D  <font color=#447700>!urban<a name='558'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_soil_layers, jms:jme), INTENT(INOUT) :: TGL_URB3D  <font color=#447700>!urban<a name='559'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_soil_layers, jms:jme), INTENT(INOUT) :: TGRL_URB3D  <font color=#447700>!urban<a name='560'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_soil_layers, jms:jme), INTENT(INOUT) :: SMR_URB3D  <font color=#447700>!urban<a name='561'></font>
<a name='562'>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: SH_URB2D <font color=#447700>!urban<a name='563'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: LH_URB2D <font color=#447700>!urban<a name='564'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: G_URB2D <font color=#447700>!urban<a name='565'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: RN_URB2D <font color=#447700>!urban<a name='566'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: TS_URB2D <font color=#447700>!urban<a name='567'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: FRC_URB2D <font color=#447700>!urban<a name='568'></font>
   INTEGER, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: UTYPE_URB2D <font color=#447700>!urban<a name='569'></font>
<a name='570'>
   INTEGER , INTENT(IN)        :: num_urban_layers<a name='571'>
   INTEGER , INTENT(IN)        :: num_urban_hi<a name='572'>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_urban_layers, jms:jme), INTENT(INOUT) :: TRB_URB4D <font color=#447700>! multi-layer UCM<a name='573'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_urban_layers, jms:jme), INTENT(INOUT) :: TW1_URB4D <font color=#447700>! multi-layer UCM<a name='574'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_urban_layers, jms:jme), INTENT(INOUT) :: TW2_URB4D <font color=#447700>! multi-layer UCM<a name='575'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_urban_layers, jms:jme), INTENT(INOUT) :: TGB_URB4D <font color=#447700>! multi-layer UCM<a name='576'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_urban_layers, jms:jme), INTENT(INOUT) :: TLEV_URB3D <font color=#447700>! multi-layer UCM<a name='577'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_urban_layers, jms:jme), INTENT(INOUT) :: QLEV_URB3D <font color=#447700>! multi-layer UCM<a name='578'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TW1LEV_URB3D <font color=#447700>! multi-layer UCM<a name='579'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TW2LEV_URB3D <font color=#447700>! multi-layer UCM<a name='580'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TGLEV_URB3D <font color=#447700>! multi-layer UCM<a name='581'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TFLEV_URB3D <font color=#447700>! multi-layer UCM<a name='582'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: LF_AC_URB3D <font color=#447700>!multi-layer UCM<a name='583'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: SF_AC_URB3D <font color=#447700>!multi-layer UCM<a name='584'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: CM_AC_URB3D <font color=#447700>!multi-layer UCM<a name='585'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: SFVENT_URB3D <font color=#447700>!multi-layer UCM<a name='586'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: LFVENT_URB3D <font color=#447700>!multi-layer UCM<a name='587'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: SFWIN1_URB3D <font color=#447700>! multi-layer UCM<a name='588'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: SFWIN2_URB3D <font color=#447700>! multi-layer UCM<a name='589'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_urban_layers, jms:jme), INTENT(INOUT) :: SFG_URB3D <font color=#447700>! multi-layer UCM<a name='590'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_urban_layers, jms:jme), INTENT(INOUT) :: SFR_URB3D <font color=#447700>! multi-layer UCM<a name='591'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_urban_layers, jms:jme), INTENT(INOUT) :: SFW1_URB3D <font color=#447700>! multi-layer UCM<a name='592'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, 1:num_urban_layers, jms:jme), INTENT(INOUT) :: SFW2_URB3D <font color=#447700>! multi-layer UCM<a name='593'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime,1:num_urban_hi, jms:jme), INTENT(INOUT) :: HI_URB2D  <font color=#447700>!multi-layer UCM<a name='594'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: LP_URB2D  <font color=#447700>!multi-layer UCM<a name='595'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: LB_URB2D  <font color=#447700>!multi-layer UCM<a name='596'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: HGT_URB2D <font color=#447700>!multi-layer UCM<a name='597'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: MH_URB2D  <font color=#447700>!SLUCM<a name='598'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: STDH_URB2D <font color=#447700>!SLUCM<a name='599'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime, 4, jms:jme ), INTENT(INOUT) :: LF_URB2D  <font color=#447700>!SLUCM <a name='600'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: A_U_BEP<a name='601'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: A_V_BEP<a name='602'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: A_T_BEP<a name='603'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: A_Q_BEP<a name='604'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: A_E_BEP<a name='605'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: B_U_BEP<a name='606'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: B_V_BEP<a name='607'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: B_T_BEP<a name='608'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: B_Q_BEP<a name='609'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: B_E_BEP<a name='610'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: VL_BEP<a name='611'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: DLG_BEP<a name='612'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme,jms:jme), INTENT(INOUT) :: SF_BEP<a name='613'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: DL_U_BEP<a name='614'>
<font color=#447700>! lake varibles:<a name='615'></font>
  real,    dimension(ims:ime,jms:jme ),intent(out)                        :: lakedepth2d,    &amp;<a name='616'>
                                                                             savedtke12d<a name='617'>
  real,    dimension(ims:ime,jms:jme ),intent(inout)                      :: snowdp2d,       &amp;<a name='618'>
                                                                             h2osno2d,       &amp;<a name='619'>
                                                                             snl2d,          &amp;<a name='620'>
                                                                             t_grnd2d<a name='621'>
 <a name='622'>
  real,    dimension( ims:ime,1:nlevlake, jms:jme ),INTENT(out)            :: t_lake3d,       &amp;<a name='623'>
                                                                             lake_icefrac3d, &amp;<a name='624'>
                                                                             z_lake3d,       &amp;<a name='625'>
                                                                             dz_lake3d<a name='626'>
  real,    dimension( ims:ime,-nlevsnow+1:nlevsoil, jms:jme ),INTENT(inout) :: t_soisno3d,     &amp;<a name='627'>
                                                                             h2osoi_ice3d,   &amp;<a name='628'>
                                                                             h2osoi_liq3d,   &amp;<a name='629'>
                                                                             h2osoi_vol3d,   &amp;<a name='630'>
                                                                             z3d,            &amp;<a name='631'>
                                                                             dz3d<a name='632'>
  real,    dimension( ims:ime,1:nlevsoil, jms:jme ),INTENT(out)            :: watsat3d,       &amp;<a name='633'>
                                                                             csol3d,         &amp;<a name='634'>
                                                                             tkmg3d,         &amp;<a name='635'>
                                                                             tkdry3d,        &amp;<a name='636'>
                                                                             tksatu3d<a name='637'>
  real,    dimension( ims:ime,-nlevsnow+0:nlevsoil, jms:jme ),INTENT(inout) :: zi3d<a name='638'>
  LOGICAL, DIMENSION( ims:ime, jms:jme ),intent(out)                      :: lake2d<a name='639'>
<font color=#447700>!  REAL,    DIMENSION( ims:ime, jms:jme ), INTENT(IN)                      ::  HT<a name='640'></font>
  REAL, OPTIONAL,    DIMENSION( ims:ime, jms:jme ), INTENT(IN)    ::  lake_depth<a name='641'>
  real, intent(in)      ::      lakedepth_default, lake_min_elev<a name='642'>
#if ( EM_CORE == 1 )<a name='643'>
  REAL,              dimension(ims:ime,jms:jme )      ::  lakemask<a name='644'>
  INTEGER, INTENT(IN)      ::  lakeflag<a name='645'>
#endif<a name='646'>
  INTEGER, INTENT(INOUT)      ::   lake_depth_flag<a name='647'>
  INTEGER, INTENT(IN)      ::   use_lakedepth<a name='648'>
 <a name='649'>
<a name='650'>
<font color=#447700>!CLM<a name='651'></font>
   INTEGER, INTENT(IN) ::       maxpatch<a name='652'>
   REAL, OPTIONAL,    DIMENSION( ims:ime, jms:jme ), INTENT(IN)    ::  HT<a name='653'>
  integer, OPTIONAL,   dimension(ims:ime,jms:jme ),intent(inout) :: numc,nump<a name='654'>
  integer, OPTIONAL,   dimension(ims:ime,1:maxpatch,jms:jme ),intent(inout) :: snl<a name='655'>
  real, OPTIONAL,  dimension(ims:ime,1:maxpatch,jms:jme ),intent(inout) ::  &amp;<a name='656'>
                snowdp,wtc,wtp,h2osno,t_grnd,t_veg,         &amp;<a name='657'>
                h2ocan,h2ocan_col,t2m_max,t2m_min,     &amp;<a name='658'>
                t_ref2m,h2osoi_liq_s1,              &amp;<a name='659'>
                h2osoi_liq_s2,h2osoi_liq_s3,h2osoi_liq_s4,          &amp;<a name='660'>
                h2osoi_liq_s5,h2osoi_liq1,h2osoi_liq2,              &amp;<a name='661'>
                h2osoi_liq3,h2osoi_liq4,h2osoi_liq5,h2osoi_liq6,    &amp;<a name='662'>
                h2osoi_liq7,h2osoi_liq8,h2osoi_liq9,h2osoi_liq10,   &amp;<a name='663'>
                h2osoi_ice_s1,h2osoi_ice_s2,                        &amp;<a name='664'>
                h2osoi_ice_s3,h2osoi_ice_s4,h2osoi_ice_s5,          &amp;<a name='665'>
                h2osoi_ice1,h2osoi_ice2,h2osoi_ice3,h2osoi_ice4,    &amp;<a name='666'>
                h2osoi_ice5,h2osoi_ice6,h2osoi_ice7,                &amp;<a name='667'>
                h2osoi_ice8,h2osoi_ice9,h2osoi_ice10,               &amp;<a name='668'>
                t_soisno_s1,t_soisno_s2,t_soisno_s3,t_soisno_s4,    &amp;<a name='669'>
                t_soisno_s5,t_soisno1,t_soisno2,t_soisno3,          &amp;<a name='670'>
                t_soisno4,t_soisno5,t_soisno6,t_soisno7,            &amp;<a name='671'>
                t_soisno8,t_soisno9,t_soisno10,                     &amp;<a name='672'>
                dzsnow1,dzsnow2,dzsnow3,dzsnow4,dzsnow5,            &amp;<a name='673'>
                snowrds1,snowrds2,snowrds3,snowrds4,snowrds5,       &amp;<a name='674'>
                t_lake1,t_lake2,t_lake3,t_lake4,t_lake5,            &amp;<a name='675'>
                t_lake6,t_lake7,t_lake8,t_lake9,t_lake10,           &amp;<a name='676'>
                h2osoi_vol1,h2osoi_vol2,h2osoi_vol3,                &amp;<a name='677'>
                h2osoi_vol4,h2osoi_vol5,h2osoi_vol6,                &amp;<a name='678'>
                h2osoi_vol7,h2osoi_vol8,                            &amp;<a name='679'>
                h2osoi_vol9,h2osoi_vol10,                           &amp;<a name='680'>
                ALBEDOsubgrid,LHsubgrid,HFXsubgrid,LWUPsubgrid,     &amp;<a name='681'>
                Q2subgrid,SABVsubgrid,SABGsubgrid,NRAsubgrid,       &amp;<a name='682'>
                SWUPsubgrid,lhsoi,lhtran,lhveg<a name='683'>
<a name='684'>
<font color=#447700>!obs fdda<a name='685'></font>
   INTEGER, OPTIONAL, INTENT(IN) :: itimestep<a name='686'>
#if ( EM_CORE == 1 )<a name='687'>
   TYPE(fdob_type), OPTIONAL, INTENT(INOUT) :: fdob<a name='688'>
#endif<a name='689'>
   REAL, OPTIONAL, INTENT(IN) :: p00, t00, tlp   <font color=#447700>! for obs-nudging base-state calcn<a name='690'></font>
   REAL, INTENT(IN) :: nssl_cccn, nssl_alphah, nssl_alphahl, &amp;<a name='691'>
                         nssl_cnoh, nssl_cnohl,                  &amp;<a name='692'>
                         nssl_cnor, nssl_cnos,                   &amp;<a name='693'>
                         nssl_rho_qh, nssl_rho_qhl,              &amp;<a name='694'>
                         nssl_rho_qs<a name='695'>
<a name='696'>
   INTEGER, INTENT(IN) :: nssl_ipelec,nssl_isaund<a name='697'>
<a name='698'>
<font color=#447700>! WA 12/21/09<a name='699'></font>
   REAL,OPTIONAL, DIMENSION( ims:ime , kms:kme , jms:jme ) , &amp;<a name='700'>
          INTENT(OUT) ::    te_temf, cf3d_temf    <a name='701'>
<font color=#447700>! WA 2/22/11<a name='702'></font>
   REAL,OPTIONAL, DIMENSION( ims:ime , jms:jme ) , &amp;<a name='703'>
          INTENT(OUT) ::    wm_temf<a name='704'>
<a name='705'>
<font color=#447700>! Local data<a name='706'></font>
<a name='707'>
   REAL    :: ALBLND,ZZLND,ZZWTR,THINLD,XMAVA,CEN_LAT,pptop<a name='708'>
   REAL,     DIMENSION( kms:kme )  :: sfull, shalf<a name='709'>
   REAL :: obs_twindo_cg, obs_twindo<a name='710'>
<a name='711'>
   CHARACTER*256 :: MMINLU_loc<a name='712'>
   CHARACTER*80 :: message<a name='713'>
   INTEGER :: ISWATER<a name='714'>
   INTEGER :: ISICE<a name='715'>
   INTEGER :: ISURBAN<a name='716'>
   INTEGER :: sf_urban_physics<a name='717'>
   INTEGER :: sf_ocean_physics<a name='718'>
   REAL    :: oml_hml0<a name='719'>
   INTEGER :: LakeModel<a name='720'>
   LOGICAL :: usemonalb<a name='721'>
   LOGICAL :: rdmaxalb<a name='722'>
   INTEGER :: mfshconv<a name='723'>
   INTEGER :: icloud_cu<a name='724'>
   INTEGER :: iopt_run<a name='725'>
<a name='726'>
   INTEGER :: i, j, k, itf, jtf, ktf, n<a name='727'>
integer myproc<a name='728'>
<a name='729'>
<font color=#447700>!-------------------------------------------------<a name='730'></font>
<font color=#447700>! Noah-mosaic related variables are added to declaration  (danli)<a name='731'></font>
<font color=#447700>!-------------------------------------------------<a name='732'></font>
  <a name='733'>
  INTEGER, INTENT(IN) :: sf_surface_mosaic, NLCAT   <a name='734'>
  INTEGER, INTENT(IN) :: mosaic_cat<a name='735'>
  REAL, DIMENSION( ims:ime, NLCAT, jms:jme ) , INTENT(IN) , OPTIONAL::   LANDUSEF<a name='736'>
  REAL, DIMENSION( ims:ime, NLCAT, jms:jme ) , INTENT(INOUT) , OPTIONAL::   LANDUSEF2 <a name='737'>
  INTEGER, DIMENSION( ims:ime, NLCAT, jms:jme ), INTENT(INOUT), OPTIONAL :: mosaic_cat_index <a name='738'>
<a name='739'>
  REAL, DIMENSION( ims:ime, 1:mosaic_cat, jms:jme ) , OPTIONAL, INTENT(INOUT):: &amp;<a name='740'>
        TSK_mosaic, CANWAT_mosaic, SNOW_mosaic,SNOWH_mosaic, SNOWC_mosaic<a name='741'>
  REAL, DIMENSION( ims:ime, 1:mosaic_cat, jms:jme ) , OPTIONAL, INTENT(INOUT)::                &amp;<a name='742'>
        ALBEDO_mosaic,ALBBCK_mosaic, EMISS_mosaic, EMBCK_mosaic, ZNT_mosaic, Z0_mosaic<a name='743'>
  REAL, DIMENSION( ims:ime, 1:num_soil_layers*mosaic_cat, jms:jme ), OPTIONAL, INTENT(INOUT):: &amp;<a name='744'>
        TSLB_mosaic,SMOIS_mosaic,SH2O_mosaic<a name='745'>
  REAL, DIMENSION( ims:ime, 1:mosaic_cat, jms:jme ) , OPTIONAL, INTENT(INOUT)::                &amp;<a name='746'>
        TR_URB2D_mosaic, TB_URB2D_mosaic, TG_URB2D_mosaic, TC_URB2D_mosaic,QC_URB2D_mosaic,    &amp;<a name='747'>
        SH_URB2D_mosaic,LH_URB2D_mosaic,G_URB2D_mosaic,RN_URB2D_mosaic,TS_URB2D_mosaic, TS_RUL2D_mosaic  <a name='748'>
                  <a name='749'>
   REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_soil_layers*mosaic_cat, jms:jme ), INTENT(INOUT) :: TRL_URB3D_mosaic<a name='750'>
   REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_soil_layers*mosaic_cat, jms:jme ), INTENT(INOUT) :: TBL_URB3D_mosaic<a name='751'>
   REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_soil_layers*mosaic_cat, jms:jme ), INTENT(INOUT) :: TGL_URB3D_mosaic  <a name='752'>
   LOGICAL :: IPRINT<a name='753'>
 <a name='754'>
<font color=#447700>!-------------------------------------------------<a name='755'></font>
<font color=#447700>! End of Noah-mosaic <a name='756'></font>
<font color=#447700>!-------------------------------------------------  <a name='757'></font>
   <a name='758'>
<font color=#447700>!-----------------------------------------------------------------<a name='759'></font>
<a name='760'>
   sf_urban_physics=config_flags%sf_urban_physics<a name='761'>
   usemonalb=config_flags%usemonalb<a name='762'>
   rdmaxalb=config_flags%rdmaxalb<a name='763'>
   LakeModel = config_flags%sf_lake_physics<a name='764'>
   mfshconv=config_flags%mfshconv<a name='765'>
   IF(PRESENT(SMOISEQ)) THEN<a name='766'>
      iopt_run=config_flags%opt_run<a name='767'>
   ELSE<a name='768'>
      iopt_run=-1<a name='769'>
   END IF<a name='770'>
#if ( EM_CORE == 1 )<a name='771'>
   obs_twindo_cg=model_config_rec%obs_twindo(1)<a name='772'>
   obs_twindo=config_flags%obs_twindo<a name='773'>
   oml_hml0=config_flags%oml_hml0<a name='774'>
   sf_ocean_physics=config_flags%sf_ocean_physics<a name='775'>
#else<a name='776'>
   obs_twindo_cg=0<a name='777'>
   obs_twindo=0<a name='778'>
   oml_hml0=0<a name='779'>
#endif<a name='780'>
<a name='781'>
<font color=#447700>!..Added G. Thompson to determine if we will compute and pass radiative<a name='782'></font>
<font color=#447700>!.. effective radii of cloud water, ice, and snow.  Currently ONLY properly<a name='783'></font>
<font color=#447700>!.. connected if using Physics options Thompson-MP and RRTMG-LW/SW.<a name='784'></font>
<font color=#447700>! 10/2014: T. Mansell added support for NSSL_2MOM options<a name='785'></font>
   has_reqc = 0<a name='786'>
   has_reqi = 0<a name='787'>
   has_reqs = 0<a name='788'>
   IF ( config_flags%use_mp_re .EQ. 1 ) THEN<a name='789'>
   if ((config_flags%ra_lw_physics .eq. RRTMG_LWSCHEME .or. config_flags%ra_lw_physics .eq. RRTMG_LWSCHEME_FAST) .and. &amp;<a name='790'>
       (config_flags%ra_sw_physics .eq. RRTMG_SWSCHEME .or. config_flags%ra_sw_physics .eq. RRTMG_SWSCHEME_FAST) .and. &amp;<a name='791'>
        (config_flags%mp_physics  .eq. THOMPSON .or.        &amp;<a name='792'>
         config_flags%mp_physics  .eq. THOMPSONAERO         &amp;<a name='793'>
         .or. config_flags%mp_physics  .eq. NSSL_2MOM .or.       &amp;<a name='794'>
         config_flags%mp_physics  .eq. NSSL_2MOMG .or.      &amp;<a name='795'>
         config_flags%mp_physics  .eq. NSSL_2MOMCCN .or.        &amp;<a name='796'>
         config_flags%mp_physics  .eq. WSM3SCHEME .or.      &amp; <font color=#447700>! syb+<a name='797'></font>
         config_flags%mp_physics  .eq. WSM5SCHEME .or.      &amp; <font color=#447700>! syb+<a name='798'></font>
         config_flags%mp_physics  .eq. WSM6SCHEME .or.      &amp; <font color=#447700>! syb+<a name='799'></font>
         config_flags%mp_physics  .eq. WDM5SCHEME .or.      &amp; <font color=#447700>! syb+<a name='800'></font>
         config_flags%mp_physics  .eq. WDM6SCHEME .or.      &amp;<a name='801'>
         config_flags%mp_physics  .eq. P3_1CATEGORY .or.    &amp;<a name='802'>
         config_flags%mp_physics  .eq. P3_1CATEGORY_NC    ) ) then    <font color=#447700>! P3<a name='803'></font>
      has_reqc = 1<a name='804'>
      has_reqi = 1<a name='805'>
      has_reqs = 1<a name='806'>
   endif<a name='807'>
<a name='808'>
<font color=#447700>! for P3, to ensure correct coupling with predicted effective radii<a name='809'></font>
   if (config_flags%mp_physics .eq. P3_1CATEGORY .or.       &amp;<a name='810'>
       config_flags%mp_physics .eq. P3_1CATEGORY_NC       ) then<a name='811'>
      has_reqs = 0<a name='812'>
   end if<a name='813'>
<a name='814'>
   ENDIF<a name='815'>
<a name='816'>
<font color=#447700>!-- should be from the namelist<a name='817'></font>
<a name='818'>
   sfull = 0.<a name='819'>
   shalf = 0.<a name='820'>
<a name='821'>
   CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_719">(100,'top of phy_init')<a name='822'>
<a name='823'>
   WRITE(wrf_err_message,*) 'phy_init:  start_of_simulation = ',start_of_simulation<a name='824'>
   CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_720"> ( 100, TRIM(wrf_err_message) )<a name='825'>
<a name='826'>
   itf=min0(ite,ide-1)<a name='827'>
   jtf=min0(jte,jde-1)<a name='828'>
   ktf=min0(kte,kde-1)<a name='829'>
<a name='830'>
   ZZLND=0.1<a name='831'>
   ZZWTR=0.0001<a name='832'>
   THINLD=0.04<a name='833'>
   ALBLND=0.2<a name='834'>
   XMAVA=0.3<a name='835'>
<a name='836'>
#if (NMM_CORE == 1)<a name='837'>
   if (.not.usemonalb) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_907">('usemonalb should always be true for NMM')<a name='838'>
#endif<a name='839'>
<a name='840'>
   CALL nl_get_cen_lat(id,cen_lat)<a name='841'>
   CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_721">(100,'calling nl_get_iswater, nl_get_isice, nl_get_mminlu_loc')<a name='842'>
   CALL nl_get_iswater(id,iswater)<a name='843'>
   CALL nl_get_isice(id,isice)<a name='844'>
   CALL nl_get_isurban(id,isurban)<a name='845'>
<font color=#447700>!jm   CALL nl_get_mminlu( 1, mminlu_loc )<a name='846'></font>
   CALL nl_get_mminlu( id, mminlu_loc )<a name='847'>
#if (NMM_CORE == 1 &amp;&amp; HWRF == 1 )<a name='848'>
   IF ( trim(mminlu_loc) .eq. "" ) THEN<a name='849'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_837">('WARNING:   MMINLU NOT SET, USING USGS')<a name='850'>
     MMINLU_LOC = 'USGS'<a name='851'>
   ENDIF<a name='852'>
#endif<a name='853'>
   CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_722">(100,'after nl_get_iswater, nl_get_isice, nl_get_mminlu_loc')<a name='854'>
<font color=#447700>!-- temporary fix by ww<a name='855'></font>
   landuse_ISICE = isice<a name='856'>
<a name='857'>
<font color=#447700>!..Determine which cu_rad_feedback option to use<a name='858'></font>
<a name='859'>
   icloud_cu = 0<a name='860'>
   IF ( config_flags%cu_rad_feedback ) THEN<a name='861'>
      IF ( config_flags%cu_physics == kfetascheme ) THEN<a name='862'>
         icloud_cu = 2<a name='863'>
      ELSE IF ( config_flags%cu_physics == gfscheme .OR. &amp;<a name='864'>
                config_flags%cu_physics == g3scheme .OR. &amp;<a name='865'>
                config_flags%cu_physics == gdscheme ) THEN<a name='866'>
         icloud_cu = 1<a name='867'>
      END IF<a name='868'>
   END IF<a name='869'>
#if (EM_CORE == 1)<a name='870'>
   IF ( config_flags%cu_physics == mskfscheme ) THEN<a name='871'>
        icloud_cu = 2<a name='872'>
   END IF<a name='873'>
#endif<a name='874'>
   CALL nl_set_icloud_cu ( id , icloud_cu )<a name='875'>
<a name='876'>
  IF(.not.restart)THEN <font color=#447700>!{<a name='877'></font>
<font color=#447700>!-- initialize common variables<a name='878'></font>
     <font color=#447700>!BSINGH - When all the CAM parameterizations are not executed in WRF,<a name='879'></font>
     <font color=#447700>!rliq can have undefined behaviour<a name='880'></font>
 IF (config_flags%cu_physics == CAMZMSCHEME .or. config_flags%shcu_physics == CAMUWSHCUSCHEME ) THEN<a name='881'>
     IF(PRESENT(rliq)) THEN<a name='882'>
        rliq(:,:) = 0.0 <a name='883'>
     ENDIF<a name='884'>
 ENDIF<a name='885'>
   IF ( .NOT. moved ) THEN<a name='886'>
   DO j=jts,jtf<a name='887'>
   DO i=its,itf<a name='888'>
      XLAND(i,j)=float(config_flags%ideal_xland)<a name='889'>
      GSW(i,j)=0.<a name='890'>
      GLW(i,j)=0.<a name='891'>
<font color=#447700>!-- initialize ust to a small value<a name='892'></font>
      UST(i,j)=0.0001<a name='893'>
      MOL(i,j)=0.0<a name='894'>
      PBLH(i,j)=0.0<a name='895'>
      HFX(i,j)=0.<a name='896'>
      QFX(i,j)=0.<a name='897'>
      RAINBL(i,j)=0.<a name='898'>
      RAINNCV(i,j)=0.<a name='899'>
      SNOWNCV(i,j)=0.<a name='900'>
      GRAUPELNCV(i,j)=0.<a name='901'>
      ACSNOW(i,j)=0.<a name='902'>
      DO k=kms,kme  <font color=#447700>!wig, 17-May-2006: Added for idealized chem. runs<a name='903'></font>
         EXCH_H(i,k,j) = 0.<a name='904'>
      END DO<a name='905'>
   ENDDO<a name='906'>
   ENDDO<a name='907'>
   ENDIF<a name='908'>
<a name='909'>
   DO j=jts,jtf<a name='910'>
   DO i=its,itf<a name='911'>
     IVGTYP(i,j) = NINT(LU_INDEX(i,j))<a name='912'>
   ENDDO<a name='913'>
   ENDDO<a name='914'>
<a name='915'>
<font color=#447700>!<a name='916'></font>
   IF(PRESENT(TMN_UPDATE))THEN<a name='917'>
   if(tmn_update.eq.1) then<a name='918'>
   nyear=1<a name='919'>
   nday=0.<a name='920'>
   DO j=jts,jtf<a name='921'>
   DO i=its,itf<a name='922'>
      TYR(i,j)=TMN(i,j)<a name='923'>
      TYRA(i,j)=0.0<a name='924'>
      TDLY(i,j)=0.0<a name='925'>
    DO n=1,lagday<a name='926'>
      TLAG(i,n,j)=TMN(i,j)<a name='927'>
    ENDDO<a name='928'>
   ENDDO<a name='929'>
   ENDDO<a name='930'>
   endif<a name='931'>
   ENDIF<a name='932'>
<font color=#447700>!<a name='933'></font>
<a name='934'>
<font color=#447700>!<a name='935'></font>
   DO j=jts,jtf<a name='936'>
   DO i=its,itf<a name='937'>
     IF(XLAND(i,j) .LT. 1.5)THEN<a name='938'>
       IF(mminlu_loc .EQ. '    ') ALBBCK(i,j)=ALBLND<a name='939'>
       EMBCK(i,j)=0.85<a name='940'>
       ALBEDO(i,j)=ALBBCK(i,j)<a name='941'>
       EMISS(i,j)=EMBCK(i,j)<a name='942'>
       THC(i,j)=THINLD<a name='943'>
       ZNT(i,j)=ZZLND<a name='944'>
#if  <font color=#447700>! ( NMM_CORE == 1 )<a name='945'></font>
       Z0(i,j)=ZZLND<a name='946'>
#endif<a name='947'>
       MAVAIL(i,j)=XMAVA<a name='948'>
     ELSE<a name='949'>
       IF(mminlu_loc .EQ. '    ') ALBBCK(i,j)=0.08<a name='950'>
       ALBEDO(i,j)=ALBBCK(i,j)<a name='951'>
       EMBCK(i,j)=0.98<a name='952'>
       EMISS(i,j)=EMBCK(i,j)<a name='953'>
       THC(i,j)=THINLD<a name='954'>
       ZNT(i,j)=ZZWTR<a name='955'>
#if  <font color=#447700>! ( NMM_CORE == 1 )<a name='956'></font>
       Z0(i,j)=ZZWTR<a name='957'>
#endif<a name='958'>
       MAVAIL(i,j)=1.0<a name='959'>
     ENDIF<a name='960'>
<a name='961'>
   ENDDO<a name='962'>
   ENDDO<a name='963'>
<a name='964'>
    if (config_flags%cu_diag == 1 )then<a name='965'>
    do j=jts,jtf<a name='966'>
       do k=kts,ktf<a name='967'>
          do i=its,itf<a name='968'>
             gd_cloud(i,k,j) = 0.<a name='969'>
             gd_cloud2(i,k,j) = 0.<a name='970'>
             gd_cloud_a(i,k,j) = 0.<a name='971'>
             gd_cloud2_a(i,k,j) = 0.<a name='972'>
             QC_CU(i,k,j) = 0.<a name='973'>
             QI_CU(i,k,j) = 0.<a name='974'>
          end do<a name='975'>
       end do<a name='976'>
    end do<a name='977'>
    endif<a name='978'>
<a name='979'>
    do j=jts,jtf<a name='980'>
         do i=its,itf<a name='981'>
           raincv_a(i,j)=0.<a name='982'>
           raincv_b(i,j)=0.<a name='983'>
      end do<a name='984'>
    end do<a name='985'>
<a name='986'>
<font color=#447700>!..Fill initial starting values of radiative effective radii for<a name='987'></font>
<font color=#447700>!.. cloud water (2.51 microns), cloud ice (5.01 microns), and<a name='988'></font>
<font color=#447700>!.. snow (10.01 microns).<a name='989'></font>
    if (has_reqc.ne.0) then<a name='990'>
       do j=jts,jtf<a name='991'>
          do k=kts,ktf<a name='992'>
          do i=its,itf<a name='993'>
             re_cloud(i,k,j) = 2.51E-6<a name='994'>
          end do<a name='995'>
          end do<a name='996'>
       end do<a name='997'>
    endif<a name='998'>
    if (has_reqi.ne.0) then<a name='999'>
       do j=jts,jtf<a name='1000'>
          do k=kts,ktf<a name='1001'>
          do i=its,itf<a name='1002'>
             re_ice(i,k,j) = 5.01E-6<a name='1003'>
          end do<a name='1004'>
          end do<a name='1005'>
       end do<a name='1006'>
    endif<a name='1007'>
    if (has_reqs.ne.0) then<a name='1008'>
       do j=jts,jtf<a name='1009'>
          do k=kts,ktf<a name='1010'>
          do i=its,itf<a name='1011'>
             re_snow(i,k,j) = 10.01E-6<a name='1012'>
          end do<a name='1013'>
          end do<a name='1014'>
       end do<a name='1015'>
    endif<a name='1016'>
<a name='1017'>
   CALL wrf_debug ( 200 , 'module_start: phy_init: Before call to landuse_init' )<a name='1018'>
<a name='1019'>
   IF(mminlu_loc .ne. '    ')THEN<a name='1020'>
<font color=#447700>!-- initialize surface properties<a name='1021'></font>
<a name='1022'>
     CALL <A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT'>landuse_init</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LANDUSE_INIT_1">(lu_index, snowc, albedo, albbck, snoalb, mavail, emiss, embck, &amp;<a name='1023'>
                znt, Z0, thc, xland, xice, xicem, julday, cen_lat, iswater, &amp;<a name='1024'>
                TRIM ( mminlu_loc ) ,                               &amp;<a name='1025'>
                landuse_ISICE, landuse_LUCATS,                      &amp;<a name='1026'>
                landuse_LUSEAS, landuse_ISN,                        &amp;<a name='1027'>
                config_flags%fractional_seaice,                      &amp;<a name='1028'>
                lu_state,                                           &amp;<a name='1029'>
                allowed_to_read , usemonalb ,                       &amp;<a name='1030'>
                ids, ide, jds, jde, kds, kde,                       &amp;<a name='1031'>
                ims, ime, jms, jme, kms, kme,                       &amp;<a name='1032'>
                its, ite, jts, jte, kts, kte                       )<a name='1033'>
   ENDIF<a name='1034'>
<a name='1035'>
  ENDIF <font color=#447700>!}<a name='1036'></font>
<a name='1037'>
<font color=#447700>!-- convert zfull and zhalf to sigma values for ra_init (Eta CO2 needs these)<a name='1038'></font>
<font color=#447700>!-- zfull/zhalf may be either zeta or eta<a name='1039'></font>
<font color=#447700>!-- what is done here depends on coordinate (check this code if adding new coordinates)<a name='1040'></font>
   CALL <A href='../../html_code/phys/module_physics_init.F.html#Z2SIGMA'>z2sigma</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="Z2SIGMA_1">(zfull,zhalf,sfull,shalf,p_top,pptop,config_flags, &amp;<a name='1041'>
                allowed_to_read,                                  &amp;<a name='1042'>
                kds,kde,kms,kme,kts,kte)<a name='1043'>
<a name='1044'>
   <font color=#447700>! CAM parameterizations specific initializations [Currently incorporates initializations for CAMZM, CAMUWPBL, CAMUWSHCU and CAMMGMP parameterizations]<a name='1045'></font>
<a name='1046'>
   <font color=#447700>!Findout whether CAMMGMP scheme is used used or not in this simulation<a name='1047'></font>
   is_CAMMGMP_used = .FALSE.<a name='1048'>
# if (EM_CORE == 1)<a name='1049'>
   if(config_flags%mp_physics == CAMMGMPSCHEME) is_CAMMGMP_used = .TRUE.<a name='1050'>
# endif<a name='1051'>
<a name='1052'>
#if ( WRF_CHEM == 1 )<a name='1053'>
   <font color=#447700>!BSINGH:02/01/2013 - For WRF_CHEM simulations, initialize cam_mam_aerosols variable<a name='1054'></font>
   cam_mam_aerosols = .FALSE.<a name='1055'>
   if(config_flags%chem_opt == CBMZ_CAM_MAM3_NOAQ .OR. config_flags%chem_opt == CBMZ_CAM_MAM3_AQ &amp;<a name='1056'>
        .OR. config_flags%chem_opt == CBMZ_CAM_MAM7_NOAQ .OR. config_flags%chem_opt == CBMZ_CAM_MAM7_AQ) cam_mam_aerosols = .TRUE.<a name='1057'>
      <a name='1058'>
#endif<a name='1059'>
<a name='1060'>
<a name='1061'>
   if(       config_flags%bl_pbl_physics == CAMUWPBLSCHEME     .OR. config_flags%cu_physics == CAMZMSCHEME      &amp;<a name='1062'>
        .OR. config_flags%shcu_physics   == CAMUWSHCUSCHEME                                                     &amp; <a name='1063'>
# if (EM_CORE == 1)<a name='1064'>
        .OR. config_flags%mp_physics == CAMMGMPSCHEME                                                           &amp;<a name='1065'>
# endif<a name='1066'>
#if ( WRF_CHEM == 1 )<a name='1067'>
        <font color=#447700>!For WRF_CHEM simulations, first five constituents are added in CAM_INIT and rest are added in the MODULE_CAM_MAM_INIT in chem/<a name='1068'></font>
        .OR. config_flags%chem_opt       == CBMZ_CAM_MAM3_NOAQ .OR. config_flags%chem_opt   == CBMZ_CAM_MAM3_AQ &amp;<a name='1069'>
        .OR. config_flags%chem_opt       == CBMZ_CAM_MAM7_NOAQ .OR. config_flags%chem_opt   == CBMZ_CAM_MAM7_AQ &amp;<a name='1070'>
#endif<a name='1071'>
      ) THEN<a name='1072'>
      CALL <A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT'>CAM_INIT</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CAM_INIT_1">(ixcldliq, ixcldice, ixnumliq, ixnumice, config_flags)<a name='1073'>
   ENDIF<a name='1074'>
<font color=#447700>!-- initialize physics<a name='1075'></font>
<font color=#447700>!-- ra: radiation<a name='1076'></font>
<font color=#447700>!-- bl: pbl<a name='1077'></font>
<font color=#447700>!-- cu: cumulus<a name='1078'></font>
<font color=#447700>!-- mp: microphysics<a name='1079'></font>
<a name='1080'>
<font color=#447700>!<a name='1081'></font>
<font color=#447700>! .... paj ... initialize wind farm ...<a name='1082'></font>
<font color=#447700>!<a name='1083'></font>
  IF ( config_flags%windfarm_opt .EQ. 1 ) THEN<a name='1084'>
    CALL <A href='../../html_code/phys/module_wind_fitch.F.html#INIT_MODULE_WIND_FITCH'>init_module_wind_fitch</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INIT_MODULE_WIND_FITCH_1">(id,config_flags,xlong,xlat,windfarm_initialized,ims,ime,jms,jme,its,ite,jts,jte,ids,ide,jds,jde)<a name='1085'>
  ENDIF<a name='1086'>
<a name='1087'>
<a name='1088'>
   CALL wrf_debug ( 200 , 'module_start: phy_init: Before call to ra_init' )<a name='1089'>
<a name='1090'>
   CALL <A href='../../html_code/phys/module_physics_init.F.html#RA_INIT'>ra_init</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RA_INIT_1">(id=id,STEPRA=STEPRA,RADT=RADT,DT=DT,RTHRATEN=RTHRATEN,RTHRATENLW=RTHRATENLW,             &amp;<a name='1091'>
                RTHRATENSW=RTHRATENSW,CLDFRA=CLDFRA,EMISS=EMISS,cen_lat=cen_lat,JULYR=JULYR,JULDAY=JULDAY,GMT=GMT,    &amp;<a name='1092'>
                levsiz=levsiz,XLAT=XLAT,XLONG=XLONG,n_ozmixm=n_ozmixm,     &amp;<a name='1093'>
                alevsiz=alevsiz,no_src_types=no_src_types,                 &amp;<a name='1094'>
                cldfra_dp=cldfra_dp,cldfra_sh=cldfra_sh,                   &amp; <font color=#447700>! optional for subgrid cloud by ckay<a name='1095'></font>
                cldfra_old=cldfra_old,                                     &amp; <font color=#447700>! Optional<a name='1096'></font>
                ozmixm=ozmixm,pin=pin,                                     &amp; <font color=#447700>! Optional<a name='1097'></font>
                aerodm=aerodm,pina=pina,                                   &amp; <font color=#447700>! Optional<a name='1098'></font>
                m_ps_1=m_ps_1,m_ps_2=m_ps_2,m_hybi=m_hybi,aerosolc_1=aerosolc_1,aerosolc_2=aerosolc_2,     &amp; <font color=#447700>! Optional<a name='1099'></font>
                paerlev=paerlev,n_aerosolc=n_aerosolc,                             &amp;<a name='1100'>
                sfull=sfull,shalf=shalf,pptop=pptop,swrad_scat=swrad_scat,p_top=p_top,       &amp;<a name='1101'>
                config_flags=config_flags,restart=restart,                           &amp;<a name='1102'>
                allowed_to_read=allowed_to_read, start_of_simulation=start_of_simulation,           &amp;<a name='1103'>
                ids=ids, ide=ide, jds=jds, jde=jde, kds=kds, kde=kde,                   &amp;<a name='1104'>
                ims=ims, ime=ime, jms=jms, jme=jme, kms=kms, kme=kme,                   &amp;<a name='1105'>
                its=its, ite=ite, jts=jts, jte=jte, kts=kts, kte=kte                    )<a name='1106'>
<a name='1107'>
   CALL wrf_debug ( 200 , 'module_start: phy_init: Before call to bl_init' )<a name='1108'>
   CALL <A href='../../html_code/phys/module_physics_init.F.html#BL_INIT'>bl_init</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="BL_INIT_1">(STEPBL,BLDT,DT,RUBLTEN,RVBLTEN,RTHBLTEN,        &amp;<a name='1109'>
                RQVBLTEN,RQCBLTEN,RQIBLTEN,TSK,TMN,             &amp;<a name='1110'>
                config_flags,restart,UST,LOWLYR,TSLB,ZS,DZS,    &amp;<a name='1111'>
                num_soil_layers,TKE_PBL,mfshconv,               &amp;<a name='1112'>
                massflux_EDKF, entr_EDKF, detr_EDKF, &amp; <a name='1113'>
                thl_up, thv_up, rt_up,       &amp;<a name='1114'>
                rv_up, rc_up, u_up, v_up,    &amp;<a name='1115'>
                frac_up, &amp;<a name='1116'>
                EXCH_H,VEGFRA,                                  &amp;<a name='1117'>
                SNOW,SNOWC, CANWAT,SMSTAV,                      &amp;<a name='1118'>
                SMSTOT, SFCRUNOFF,UDRUNOFF,ACSNOW,ACSNOM,       &amp;<a name='1119'>
                IVGTYP,ISLTYP,ISURBAN,SMOIS,SMFR3D,MAVAIL,      &amp;<a name='1120'>
                SNOWH,SH2O,SNOALB,FNDSOILW,FNDSNOWH,RDMAXALB,   &amp;<a name='1121'>
#if (NMM_CORE == 1)<a name='1122'>
                Z0,XLAND,XICE,                                  &amp;<a name='1123'>
                DX,DY,                                          &amp;<a name='1124'>
#else<a name='1125'>
                ZNT,XLAND,XICE,                                 &amp;<a name='1126'>
                DX, DY, MSFTX, MSFTY,                           &amp;<a name='1127'>
#endif<a name='1128'>
                QKE,                                            &amp;<a name='1129'>
                SFCEVP,GRDFLX,                                  &amp;<a name='1130'>
                TRIM (MMINLU_LOC),                              &amp;<a name='1131'>
                ISNOWXY, ZSNSOXY, TSNOXY,                       &amp;<a name='1132'>
                SNICEXY, SNLIQXY, TVXY, TGXY, CANICEXY,         &amp;<a name='1133'>
                CANLIQXY, EAHXY, TAHXY, CMXY,                   &amp;<a name='1134'>
                CHXY, FWETXY, SNEQVOXY, ALBOLDXY, QSNOWXY,      &amp;<a name='1135'>
                WSLAKEXY, ZWTXY, WAXY, WTXY, LFMASSXY, RTMASSXY,&amp;<a name='1136'>
                STMASSXY, WOODXY, STBLCPXY, FASTCPXY,           &amp;<a name='1137'>
                GRAINXY, GDDXY,                                 &amp; <font color=#447700>! Noah-MP Crop model<a name='1138'></font>
                croptype, cropcat,                              &amp; <font color=#447700>! Noah-MP Crop model<a name='1139'></font>
                XSAIXY, LAI,                                    &amp;<a name='1140'>
                SMOISEQ, SMCWTDXY, RECHXY, DEEPRECHXY, AREAXY,  &amp;<a name='1141'>
                WTDDT, STEPWTD, QRFSXY ,QSPRINGSXY ,QSLATXY,   &amp;<a name='1142'>
                FDEPTHXY, RIVERBEDXY, EQZWT, RIVERCONDXY, PEXPXY, &amp; <a name='1143'>
                rechclim  ,                                     &amp;<a name='1144'>
                ISICE,                                 &amp;<a name='1145'>
                T2MVXY,T2MBXY,CHSTARXY ,                        &amp;<a name='1146'>
                allowed_to_read , iopt_run ,                    &amp;<a name='1147'>
                start_of_simulation ,                           &amp;<a name='1148'>
                lakedepth2d,  savedtke12d,  snowdp2d,   h2osno2d,       &amp; <font color=#447700>!lake<a name='1149'></font>
                snl2d,        t_grnd2d,     t_lake3d,   lake_icefrac3d, &amp; <font color=#447700>!lake<a name='1150'></font>
                z_lake3d,     dz_lake3d,    t_soisno3d, h2osoi_ice3d,   &amp; <font color=#447700>!lake<a name='1151'></font>
                h2osoi_liq3d, h2osoi_vol3d, z3d,        dz3d,           &amp; <font color=#447700>!lake<a name='1152'></font>
                zi3d,         watsat3d,     csol3d,     tkmg3d,         &amp; <font color=#447700>!lake<a name='1153'></font>
                tkdry3d,      tksatu3d,     LakeModel,  lake2d,           &amp; <font color=#447700>!lake<a name='1154'></font>
                lakedepth_default,            lake_min_elev, lake_depth,       &amp; <font color=#447700>!lake<a name='1155'></font>
#if (EM_CORE == 1)<a name='1156'>
                lakemask, lakeflag,                                    &amp; <font color=#447700>!lake<a name='1157'></font>
#endif<a name='1158'>
                lake_depth_flag, use_lakedepth,                        &amp; <font color=#447700>!lake<a name='1159'></font>
                te_temf,cf3d_temf,wm_temf,                      &amp; <font color=#447700>! WA<a name='1160'></font>
                DZR, DZB, DZG,                                  &amp; <font color=#447700>!Optional urban<a name='1161'></font>
                TR_URB2D,TB_URB2D,TG_URB2D,TC_URB2D,QC_URB2D,   &amp; <font color=#447700>!Optional urban<a name='1162'></font>
                XXXR_URB2D,XXXB_URB2D,XXXG_URB2D,XXXC_URB2D,    &amp; <font color=#447700>!Optional urban<a name='1163'></font>
                TRL_URB3D, TBL_URB3D, TGL_URB3D,                &amp; <font color=#447700>!Optional urban<a name='1164'></font>
                SH_URB2D, LH_URB2D, G_URB2D, RN_URB2D,          &amp; <font color=#447700>!Optional urban<a name='1165'></font>
                TS_URB2D, FRC_URB2D, UTYPE_URB2D,               &amp; <a name='1166'>
                SF_URBAN_PHYSICS,                               &amp; <font color=#447700>!Optional urban<a name='1167'></font>
                CMCR_URB2D,TGR_URB2D,TGRL_URB3D,SMR_URB3D,      &amp; <font color=#447700>!Optional urban<a name='1168'></font>
                DRELR_URB2D,DRELB_URB2D,DRELG_URB2D,            &amp; <font color=#447700>!Optional urban<a name='1169'></font>
                FLXHUMR_URB2D,FLXHUMB_URB2D,FLXHUMG_URB2D,      &amp; <font color=#447700>!Optional urban<a name='1170'></font>
                NUM_URBAN_LAYERS,                               &amp; <font color=#447700>!Optional multi-layer urban<a name='1171'></font>
                NUM_URBAN_HI,                                   &amp; <font color=#447700>!Optional multi-layer urban<a name='1172'></font>
                TRB_URB4D,TW1_URB4D,TW2_URB4D,                  &amp; <font color=#447700>!Optional multi-layer urban<a name='1173'></font>
                TGB_URB4D,TLEV_URB3D,QLEV_URB3D,                &amp; <font color=#447700>!Optional multi-layer urban<a name='1174'></font>
                TW1LEV_URB3D,TW2LEV_URB3D,                      &amp; <font color=#447700>!Optional multi-layer urban<a name='1175'></font>
                TGLEV_URB3D,TFLEV_URB3D,                        &amp; <font color=#447700>!Optional multi-layer urban<a name='1176'></font>
                SF_AC_URB3D,LF_AC_URB3D,CM_AC_URB3D,            &amp; <font color=#447700>!Optional multi-layer urban<a name='1177'></font>
                SFVENT_URB3D,LFVENT_URB3D,                      &amp; <font color=#447700>!Optional multi-layer urban<a name='1178'></font>
                SFWIN1_URB3D,SFWIN2_URB3D,                      &amp; <font color=#447700>!Optional multi-layer urban<a name='1179'></font>
                SFW1_URB3D,SFW2_URB3D,                          &amp; <font color=#447700>!Optional multi-layer urban<a name='1180'></font>
                SFR_URB3D,SFG_URB3D,                            &amp; <font color=#447700>!Optional multi-layer urban<a name='1181'></font>
                LP_URB2D,HI_URB2D,LB_URB2D,                     &amp; <font color=#447700>!Optional multi-layer urban<a name='1182'></font>
                HGT_URB2D,MH_URB2D,STDH_URB2D,                  &amp; <font color=#447700>!Optional multi-layer urban<a name='1183'></font>
                LF_URB2D,                                       &amp; <font color=#447700>!Optional multi-layer urban<a name='1184'></font>
                A_U_BEP,A_V_BEP,A_T_BEP,A_Q_BEP,                &amp; <font color=#447700>!Optional multi-layer urban<a name='1185'></font>
                A_E_BEP,B_U_BEP,B_V_BEP,                        &amp; <font color=#447700>!Optional multi-layer urban<a name='1186'></font>
                B_T_BEP,B_Q_BEP,B_E_BEP,DLG_BEP,                &amp; <font color=#447700>!Optional multi-layer urban<a name='1187'></font>
                DL_U_BEP,SF_BEP,VL_BEP,                         &amp; <font color=#447700>!Optional multi-layer urban<a name='1188'></font>
                ids, ide, jds, jde, kds, kde,                   &amp;<a name='1189'>
                ims, ime, jms, jme, kms, kme,                   &amp;<a name='1190'>
                its, ite, jts, jte, kts, kte,                   &amp;<a name='1191'>
                ACHFX,ACLHF,ACGRDFLX,                           &amp;<a name='1192'>
                oml_hml0, sf_ocean_physics,                     &amp; <font color=#447700>!Optional oml<a name='1193'></font>
                TML,T0ML,HML,H0ML,HUML,HVML,TMOML,              &amp; <font color=#447700>!Optional oml<a name='1194'></font>
                is_CAMMGMP_used                                 &amp;<a name='1195'>
               ,TSK_SAVE                                        &amp; <font color=#447700>!Optional fractional seaice<a name='1196'></font>
<font color=#447700>! CLM vraiables <a name='1197'></font>
               ,numc,nump,snl,                                      &amp;<a name='1198'>
                snowdp,wtc,wtp,h2osno,t_grnd,t_veg,         &amp;<a name='1199'>
                h2ocan,h2ocan_col,t2m_max,t2m_min,t_ref2m,          &amp;<a name='1200'>
                h2osoi_liq_s1,              &amp;<a name='1201'>
                h2osoi_liq_s2,h2osoi_liq_s3,h2osoi_liq_s4,          &amp;<a name='1202'>
                h2osoi_liq_s5,h2osoi_liq1,h2osoi_liq2,              &amp;<a name='1203'>
                h2osoi_liq3,h2osoi_liq4,h2osoi_liq5,h2osoi_liq6,    &amp;<a name='1204'>
                h2osoi_liq7,h2osoi_liq8,h2osoi_liq9,h2osoi_liq10,   &amp;<a name='1205'>
                h2osoi_ice_s1,h2osoi_ice_s2,                        &amp;<a name='1206'>
                h2osoi_ice_s3,h2osoi_ice_s4,h2osoi_ice_s5,          &amp;<a name='1207'>
                h2osoi_ice1,h2osoi_ice2,h2osoi_ice3,h2osoi_ice4,    &amp;<a name='1208'>
                h2osoi_ice5,h2osoi_ice6,h2osoi_ice7,                &amp;<a name='1209'>
                h2osoi_ice8,h2osoi_ice9,h2osoi_ice10,               &amp;<a name='1210'>
                t_soisno_s1,t_soisno_s2,t_soisno_s3,t_soisno_s4,    &amp;<a name='1211'>
                t_soisno_s5,t_soisno1,t_soisno2,t_soisno3,          &amp;<a name='1212'>
                t_soisno4,t_soisno5,t_soisno6,t_soisno7,            &amp;<a name='1213'>
                t_soisno8,t_soisno9,t_soisno10,                     &amp;<a name='1214'>
                dzsnow1,dzsnow2,dzsnow3,dzsnow4,dzsnow5,            &amp;<a name='1215'>
                snowrds1,snowrds2,snowrds3,snowrds4,snowrds5,       &amp;<a name='1216'>
                t_lake1,t_lake2,t_lake3,t_lake4,t_lake5,            &amp;<a name='1217'>
                t_lake6,t_lake7,t_lake8,t_lake9,t_lake10,           &amp;<a name='1218'>
                h2osoi_vol1,h2osoi_vol2,h2osoi_vol3,                &amp;<a name='1219'>
                h2osoi_vol4,h2osoi_vol5,h2osoi_vol6,                &amp;<a name='1220'>
                h2osoi_vol7,h2osoi_vol8,                            &amp;<a name='1221'>
                h2osoi_vol9,h2osoi_vol10,                           &amp;<a name='1222'>
                ht,maxpatch,                                        &amp;<a name='1223'>
                ALBEDOsubgrid,LHsubgrid,HFXsubgrid,LWUPsubgrid,     &amp;<a name='1224'>
                Q2subgrid,SABVsubgrid,SABGsubgrid,NRAsubgrid,       &amp;<a name='1225'>
                SWUPsubgrid,lhsoi,lhveg,lhtran                      &amp;<a name='1226'>
<font color=#447700>! end of CLM vraiables <a name='1227'></font>
                ,landusef,landusef2,NLCAT                       &amp; <font color=#447700>! danli mosaic<a name='1228'></font>
                ,sf_surface_mosaic, mosaic_cat                  &amp; <font color=#447700>! danli mosaic<a name='1229'></font>
                ,mosaic_cat_index                               &amp; <font color=#447700>! danli mosaic  <a name='1230'></font>
                ,TSK_mosaic,TSLB_mosaic                         &amp; <font color=#447700>! danli mosaic<a name='1231'></font>
                ,SMOIS_mosaic,SH2O_mosaic                       &amp; <font color=#447700>! danli mosaic <a name='1232'></font>
                ,CANWAT_mosaic,SNOW_mosaic                      &amp; <font color=#447700>! danli mosaic<a name='1233'></font>
                ,SNOWH_mosaic,SNOWC_mosaic                      &amp; <font color=#447700>! danli mosaic<a name='1234'></font>
                ,ALBEDO,ALBBCK, EMISS, EMBCK                    &amp; <font color=#447700>! danli mosaic          <a name='1235'></font>
                ,ALBEDO_mosaic,ALBBCK_mosaic, EMISS_mosaic, EMBCK_mosaic, ZNT_mosaic, Z0_mosaic   &amp;         <font color=#447700>! danli mosaic<a name='1236'></font>
                ,TR_URB2D_mosaic,TB_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic <a name='1237'></font>
                ,TG_URB2D_mosaic,TC_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic <a name='1238'></font>
                ,QC_URB2D_mosaic                                &amp;  <font color=#447700>!danli mosaic                  <a name='1239'></font>
                ,TRL_URB3D_mosaic,TBL_URB3D_mosaic              &amp;  <font color=#447700>!danli mosaic <a name='1240'></font>
                ,TGL_URB3D_mosaic                               &amp;  <font color=#447700>!danli mosaic <a name='1241'></font>
                ,SH_URB2D_mosaic,LH_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic <a name='1242'></font>
                ,G_URB2D_mosaic,RN_URB2D_mosaic                 &amp;  <font color=#447700>!danli mosaic <a name='1243'></font>
                ,TS_URB2D_mosaic                                &amp;  <font color=#447700>!danli mosaic <a name='1244'></font>
                ,TS_RUL2D_mosaic                                &amp;  <font color=#447700>!danli mosaic <a name='1245'></font>
               ) <a name='1246'>
<a name='1247'>
   CALL wrf_debug ( 200 , 'module_start: phy_init: Before call to cu_init' )<a name='1248'>
<a name='1249'>
   CALL <A href='../../html_code/phys/module_physics_init.F.html#CU_INIT'>cu_init</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CU_INIT_1">(DX,STEPCU,CUDT,DT,RUCUTEN,RVCUTEN,RTHCUTEN,     &amp;<a name='1250'>
                RQVCUTEN,RQRCUTEN,RQCCUTEN,RQSCUTEN,RQICUTEN,   &amp;<a name='1251'>
                NCA,RAINC,RAINCV,W0AVG,config_flags,restart,    &amp;<a name='1252'>
                CLDEFI,LOWLYR,MASS_FLUX,                        &amp;<a name='1253'>
                RTHFTEN, RQVFTEN,                               &amp;<a name='1254'>
#if ( EM_CORE == 1 )<a name='1255'>
                <font color=#447700>!BSINGH - For WRFCuP Scheme<a name='1256'></font>
                cupflag,cldfra_cup,cldfratend_cup,              &amp; <font color=#447700>!CuP, wig 18-Sep-2006<a name='1257'></font>
                shall,                                          &amp; <font color=#447700>!CuP, wig 18-Sep-2006<a name='1258'></font>
                tcloud_cup,                                     &amp; <font color=#447700>!CuP, rce 18-apr-2012<a name='1259'></font>
                <font color=#447700>!BSINGH -ENDS<a name='1260'></font>
#endif<a name='1261'>
                APR_GR,APR_W,APR_MC,APR_ST,APR_AS,              &amp;<a name='1262'>
                APR_CAPMA,APR_CAPME,APR_CAPMI,                  &amp;<a name='1263'>
                cugd_tten,cugd_ttens,cugd_qvten,                &amp;<a name='1264'>
                cugd_qvtens,cugd_qcten,                         &amp;<a name='1265'>
                allowed_to_read, start_of_simulation,           &amp;<a name='1266'>
                ids, ide, jds, jde, kds, kde,                   &amp;<a name='1267'>
                ims, ime, jms, jme, kms, kme,                   &amp;<a name='1268'>
                its, ite, jts, jte, kts, kte,                   &amp;<a name='1269'>
                RQCNCUTEN,RQINCUTEN                            ) <a name='1270'>
<a name='1271'>
   CALL wrf_debug ( 200 , 'module_start: phy_init: Before call to shcu_init' )<a name='1272'>
<a name='1273'>
   CALL <A href='../../html_code/phys/module_physics_init.F.html#SHCU_INIT'>shcu_init</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SHCU_INIT_1">(STEPCU,CUDT,DT,RUSHTEN,RVSHTEN,RTHSHTEN,      &amp;<a name='1274'>
                RQVSHTEN,RQRSHTEN,RQCSHTEN,                     &amp;<a name='1275'>
                RQSSHTEN,RQISHTEN,RQGSHTEN,                     &amp;<a name='1276'>
                NCA,RAINC,RAINCV,config_flags,restart,          &amp;<a name='1277'>
                allowed_to_read, start_of_simulation,           &amp;<a name='1278'>
                ids, ide, jds, jde, kds, kde,                   &amp;<a name='1279'>
                ims, ime, jms, jme, kms, kme,                   &amp;<a name='1280'>
                its, ite, jts, jte, kts, kte                    )<a name='1281'>
<a name='1282'>
   CALL wrf_debug ( 200 , 'module_start: phy_init: Before call to mp_init' )<a name='1283'>
<a name='1284'>
   CALL <A href='../../html_code/phys/module_physics_init.F.html#MP_INIT'>mp_init</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MP_INIT_1">(RAINNC,SNOWNC,GRAUPELNC,config_flags,restart,warm_rain,          &amp;<a name='1285'>
                adv_moist_cond,                                 &amp;<a name='1286'>
                MPDT, DT, DX, DY, LOWLYR,                       &amp;<a name='1287'>
                F_ICE_PHY,F_RAIN_PHY,F_RIMEF_PHY,               &amp;<a name='1288'>
                mp_restart_state,tbpvs_state,tbpvs0_state,      &amp;<a name='1289'>
                allowed_to_read, start_of_simulation,           &amp;<a name='1290'>
<font color=#447700>!CAMMGMP specific variables<a name='1291'></font>
                ixcldliq, ixcldice, ixnumliq, ixnumice,         &amp;<a name='1292'>
                nssl_cccn, nssl_alphah, nssl_alphahl,           &amp;<a name='1293'>
                nssl_ipelec, nssl_isaund,                       &amp;<a name='1294'>
                         nssl_cnoh, nssl_cnohl,                  &amp;<a name='1295'>
                         nssl_cnor, nssl_cnos,                   &amp;<a name='1296'>
                         nssl_rho_qh, nssl_rho_qhl,              &amp;<a name='1297'>
                         nssl_rho_qs,                            &amp;<a name='1298'>
                ccn_conc,                                        &amp; <font color=#447700>! RAS<a name='1299'></font>
                z_at_q, qnwfa2d, scalar, num_sc,            &amp;  <font color=#447700>! G. Thompson<a name='1300'></font>
                ids, ide, jds, jde, kds, kde,                   &amp;<a name='1301'>
                ims, ime, jms, jme, kms, kme,                   &amp;<a name='1302'>
                its, ite, jts, jte, kts, kte                    )<a name='1303'>
<a name='1304'>
#if  ( EM_CORE == 1 )<a name='1305'>
   CALL wrf_debug ( 200 , 'module_start: phy_init: Before call to fg_init' )<a name='1306'>
<a name='1307'>
   CALL <A href='../../html_code/phys/module_physics_init.F.html#FG_INIT'>fg_init</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FG_INIT_1">(STEPFG,FGDT,DT,id,RUNDGDTEN,RVNDGDTEN,          &amp;<a name='1308'>
                RTHNDGDTEN,RPHNDGDTEN,RQVNDGDTEN,RMUNDGDTEN,    &amp;<a name='1309'>
                SDA_HFX, SDA_QFX, QNORM, HFX_BOTH, QFX_BOTH,    &amp; <font color=#447700>! fasdas<a name='1310'></font>
                HFX_FDDA,                                       &amp; <font color=#447700>! fasdas<a name='1311'></font>
                config_flags,restart,                           &amp;<a name='1312'>
                allowed_to_read ,                               &amp;<a name='1313'>
                ids, ide, jds, jde, kds, kde,                   &amp;<a name='1314'>
                ims, ime, jms, jme, kms, kme,                   &amp;<a name='1315'>
                its, ite, jts, jte, kts, kte                    )<a name='1316'>
<a name='1317'>
   CALL wrf_debug ( 200 , 'module_start: phy_init: Before call to fdob_init' )<a name='1318'>
<a name='1319'>
   CALL <A href='../../html_code/phys/module_physics_init.F.html#FDOB_INIT'>fdob_init</A><A href='../../html_code/phys/module_physics_init.F.html#PHY_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FDOB_INIT_1">(model_config_rec%obs_nudge_opt,               &amp;<a name='1320'>
                  model_config_rec%max_dom,                     &amp;<a name='1321'>
                  id,                                           &amp;<a name='1322'>
                  model_config_rec%parent_id,                   &amp;<a name='1323'>
                  model_config_rec%obs_idynin,                  &amp;<a name='1324'>
                  model_config_rec%obs_dtramp,                  &amp;<a name='1325'>
                  model_config_rec%fdda_end,                    &amp;<a name='1326'>
                  model_config_rec%restart,                     &amp;<a name='1327'>
                  obs_twindo_cg, obs_twindo,                    &amp;<a name='1328'>
                  itimestep,                                    &amp;<a name='1329'>
                  model_config_rec%obs_no_pbl_nudge_uv,         &amp;<a name='1330'>
                  model_config_rec%obs_no_pbl_nudge_t,          &amp;<a name='1331'>
                  model_config_rec%obs_no_pbl_nudge_q,          &amp;<a name='1332'>
                  model_config_rec%obs_sfc_scheme_horiz,        &amp;<a name='1333'>
                  model_config_rec%obs_sfc_scheme_vert,         &amp;<a name='1334'>
                  model_config_rec%obs_max_sndng_gap,           &amp;<a name='1335'>
                  model_config_rec%obs_sfcfact,                 &amp;<a name='1336'>
                  model_config_rec%obs_sfcfacr,                 &amp;<a name='1337'>
                  model_config_rec%obs_dpsmx,                   &amp;<a name='1338'>
                  model_config_rec%obs_nudge_wind,              &amp;<a name='1339'>
                  model_config_rec%obs_nudge_temp,              &amp;<a name='1340'>
                  model_config_rec%obs_nudge_mois,              &amp;<a name='1341'>
                  model_config_rec%obs_nudgezfullr1_uv,         &amp;<a name='1342'>
                  model_config_rec%obs_nudgezrampr1_uv,         &amp;<a name='1343'>
                  model_config_rec%obs_nudgezfullr2_uv,         &amp;<a name='1344'>
                  model_config_rec%obs_nudgezrampr2_uv,         &amp;<a name='1345'>
                  model_config_rec%obs_nudgezfullr4_uv,         &amp;<a name='1346'>
                  model_config_rec%obs_nudgezrampr4_uv,         &amp;<a name='1347'>
                  model_config_rec%obs_nudgezfullr1_t,          &amp;<a name='1348'>
                  model_config_rec%obs_nudgezrampr1_t,          &amp;<a name='1349'>
                  model_config_rec%obs_nudgezfullr2_t,          &amp;<a name='1350'>
                  model_config_rec%obs_nudgezrampr2_t,          &amp;<a name='1351'>
                  model_config_rec%obs_nudgezfullr4_t,          &amp;<a name='1352'>
                  model_config_rec%obs_nudgezrampr4_t,          &amp;<a name='1353'>
                  model_config_rec%obs_nudgezfullr1_q,          &amp;<a name='1354'>
                  model_config_rec%obs_nudgezrampr1_q,          &amp;<a name='1355'>
                  model_config_rec%obs_nudgezfullr2_q,          &amp;<a name='1356'>
                  model_config_rec%obs_nudgezrampr2_q,          &amp;<a name='1357'>
                  model_config_rec%obs_nudgezfullr4_q,          &amp;<a name='1358'>
                  model_config_rec%obs_nudgezrampr4_q,          &amp;<a name='1359'>
                  model_config_rec%obs_nudgezfullmin,           &amp;<a name='1360'>
                  model_config_rec%obs_nudgezrampmin,           &amp;<a name='1361'>
                  model_config_rec%obs_nudgezmax,               &amp;<a name='1362'>
                  xlat,                                         &amp;<a name='1363'>
                  xlong,                                        &amp;<a name='1364'>
                  model_config_rec%start_year(id),              &amp;<a name='1365'>
                  model_config_rec%start_month(id),             &amp;<a name='1366'>
                  model_config_rec%start_day(id),               &amp;<a name='1367'>
                  model_config_rec%start_hour(id),              &amp;<a name='1368'>
                  model_config_rec%start_minute(id),            &amp;<a name='1369'>
                  model_config_rec%start_second(id),            &amp;<a name='1370'>
                  p00, t00, tlp,                                &amp;<a name='1371'>
                  zhalf, p_top,                                 &amp;<a name='1372'>
                  fdob,                                         &amp;<a name='1373'>
                  model_config_rec%obs_ipf_init,                &amp;<a name='1374'>
                  ids, ide, jds, jde, kds, kde,                 &amp;<a name='1375'>
                  ims, ime, jms, jme, kms, kme,                 &amp;<a name='1376'>
                  its, ite, jts, jte, kts, kte                  )<a name='1377'>
<a name='1378'>
#endif<a name='1379'>
<a name='1380'>
   END SUBROUTINE phy_init<a name='1381'>
<a name='1382'>
<font color=#447700>!=====================================================================<a name='1383'></font>
<A NAME='LANDUSE_INIT'><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1384'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>landuse_init</font>(lu_index, snowc, albedo, albbck, snoalb, mavail, emiss, embck, &amp; <A href='../../call_to/LANDUSE_INIT.html' TARGET='index'>1</A>,<A href='../../call_from/LANDUSE_INIT.html' TARGET='index'>25</A><a name='1385'>
                znt,Z0,thc,xland, xice, xicem, julday, cen_lat, iswater, mminlu,  &amp;<a name='1386'>
                ISICE, LUCATS, LUSEAS, ISN,                         &amp;<a name='1387'>
                fractional_seaice,                                  &amp;<a name='1388'>
                lu_state,                                           &amp;<a name='1389'>
                allowed_to_read , usemonalb ,                       &amp;<a name='1390'>
                ids, ide, jds, jde, kds, kde,                       &amp;<a name='1391'>
                ims, ime, jms, jme, kms, kme,                       &amp;<a name='1392'>
                its, ite, jts, jte, kts, kte                       )<a name='1393'>
<a name='1394'>
   USE <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_68"><a name='1395'>
   IMPLICIT NONE<a name='1396'>
<a name='1397'>
<font color=#447700>!---------------------------------------------------------------------<a name='1398'></font>
   INTEGER , INTENT(IN)           :: ids, ide, jds, jde, kds, kde,   &amp;<a name='1399'>
                                     ims, ime, jms, jme, kms, kme,   &amp;<a name='1400'>
                                     its, ite, jts, jte, kts, kte<a name='1401'>
<a name='1402'>
   INTEGER , INTENT(IN)           :: iswater, julday<a name='1403'>
   REAL    , INTENT(IN)           :: cen_lat<a name='1404'>
   CHARACTER(LEN=*), INTENT(IN)        :: mminlu<a name='1405'>
   LOGICAL,  INTENT(IN)           :: allowed_to_read , usemonalb<a name='1406'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(IN   ) :: lu_index, snowc, xice, snoalb <a name='1407'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(OUT  ) :: albedo, albbck, mavail, emiss, &amp;<a name='1408'>
                                                               embck,                         &amp;<a name='1409'>
                                                               znt, Z0, thc, xland, xicem<a name='1410'>
   INTEGER , INTENT(INOUT)  :: ISICE, LUCATS, LUSEAS, ISN, fractional_seaice<a name='1411'>
   REAL    , INTENT(INOUT)  , DIMENSION( : ) :: lu_state<a name='1412'>
<a name='1413'>
   REAL :: xice_threshold<a name='1414'>
<font color=#447700>!---------------------------------------------------------------------<a name='1415'></font>
<font color=#447700>! Local<a name='1416'></font>
   CHARACTER*256 LUTYPE<a name='1417'>
   CHARACTER*512 :: message<a name='1418'>
   INTEGER  :: landuse_unit, LS, LC, LI, LUN, NSN<a name='1419'>
   INTEGER  :: i, j, itf, jtf, is, cats, seas, curs<a name='1420'>
   INTEGER , PARAMETER :: OPEN_OK = 0<a name='1421'>
   INTEGER :: ierr<a name='1422'>
   INTEGER , PARAMETER :: max_cats = 100 , max_seas = 12<a name='1423'>
   REAL    , DIMENSION( max_cats, max_seas ) :: ALBD, SLMO, SFEM, SFZ0, THERIN, SFHC<a name='1424'>
   REAL    , DIMENSION( max_cats )     :: SCFX<a name='1425'>
<font color=#447700>! save these fields in case nest moves or has to be reinitialized<a name='1426'></font>
<font color=#447700>! and this routine is called with allowed_to_read set to false<a name='1427'></font>
<font color=#447700>! note that by saving these, we're locking in the same landuse for<a name='1428'></font>
<font color=#447700>! the duration of a run; possible implications for long climate runs<a name='1429'></font>
   LOGICAL :: found_lu, end_of_file<a name='1430'>
   LOGICAL, EXTERNAL :: wrf_dm_on_monitor<a name='1431'>
<a name='1432'>
<font color=#447700>!---------------------------------------------------------------------<a name='1433'></font>
<a name='1434'>
   CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_723">( 100 , 'top of landuse_init' )<a name='1435'>
<a name='1436'>
   NSN=-1  <font color=#447700>! set this to suppress uninitalized data messages from tools<a name='1437'></font>
<a name='1438'>
  if ( fractional_seaice == 0 ) then<a name='1439'>
     xice_threshold = 0.5<a name='1440'>
  else if ( fractional_seaice == 1 ) then<a name='1441'>
     xice_threshold = 0.02<a name='1442'>
  endif<a name='1443'>
<a name='1444'>
<font color=#447700>! recover LU variables from state<a name='1445'></font>
   IF ( 6*(max_cats*max_seas)+1*max_cats .GT. 7501 ) THEN<a name='1446'>
      WRITE(message,*)'landuse_init: lu_state overflow. Make Registry dimspec p &gt; ',6*(max_cats*max_seas)+1*max_cats<a name='1447'>
   ENDIF<a name='1448'>
   curs = 1<a name='1449'>
   DO cats = 1, max_cats<a name='1450'>
     SCFX(cats) =           lu_state(curs)         ; curs = curs + 1<a name='1451'>
     DO seas = 1, max_seas<a name='1452'>
       ALBD(cats,seas) =    lu_state(curs)         ; curs = curs + 1<a name='1453'>
       SLMO(cats,seas) =    lu_state(curs)         ; curs = curs + 1<a name='1454'>
       SFEM(cats,seas) =    lu_state(curs)         ; curs = curs + 1<a name='1455'>
       SFZ0(cats,seas) =    lu_state(curs)         ; curs = curs + 1<a name='1456'>
       SFHC(cats,seas) =    lu_state(curs)         ; curs = curs + 1<a name='1457'>
       THERIN(cats,seas) =  lu_state(curs)         ; curs = curs + 1<a name='1458'>
     ENDDO<a name='1459'>
   ENDDO<a name='1460'>
<a name='1461'>
<font color=#447700>! Determine season (summer=1, winter=2)<a name='1462'></font>
   ISN=1<a name='1463'>
   IF(JULDAY.LT.105.OR.JULDAY.GT.288)ISN=2<a name='1464'>
   IF(CEN_LAT.LT.0.0)ISN=3-ISN<a name='1465'>
<a name='1466'>
   FOUND_LU = .TRUE.<a name='1467'>
   IF ( allowed_to_read ) THEN<a name='1468'>
      landuse_unit = 29<a name='1469'>
      IF ( wrf_dm_on_monitor() ) THEN<a name='1470'>
        OPEN(landuse_unit, FILE='LANDUSE.TBL',FORM='FORMATTED',STATUS='OLD',IOSTAT=ierr)<a name='1471'>
        IF ( ierr .NE. OPEN_OK ) THEN<a name='1472'>
          WRITE(message,FMT='(A)') &amp;<a name='1473'>
          'module_physics_init.F: LANDUSE_INIT: open failure for LANDUSE.TBL'<a name='1474'>
          CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_908"> ( message )<a name='1475'>
        END IF<a name='1476'>
        REWIND(landuse_unit)<a name='1477'>
      ENDIF<a name='1478'>
<a name='1479'>
<font color=#447700>! Read info from file LANDUSE.TBL<a name='1480'></font>
<font color=#447700>!     IF(MMINLU.EQ.'OLD ')THEN<a name='1481'></font>
<font color=#447700>!       ISWATER=7<a name='1482'></font>
<font color=#447700>!       ISICE=11<a name='1483'></font>
<font color=#447700>!     ELSE IF(MMINLU.EQ.'USGS')THEN<a name='1484'></font>
<font color=#447700>!       ISWATER=16<a name='1485'></font>
<font color=#447700>!       ISICE=24<a name='1486'></font>
<font color=#447700>!     ELSE IF(MMINLU.EQ.'SiB ')THEN<a name='1487'></font>
<font color=#447700>!       ISWATER=15<a name='1488'></font>
<font color=#447700>!       ISICE=16<a name='1489'></font>
<font color=#447700>!     ELSE IF(MMINLU.EQ.'LW12')THEN<a name='1490'></font>
<font color=#447700>!       ISWATER=15<a name='1491'></font>
<font color=#447700>!       ISICE=3<a name='1492'></font>
<font color=#447700>!     ELSE IF (MMINLU .EQ. 'MODIFIED_IGBP_MODIS_NOAH') THEN<a name='1493'></font>
<font color=#447700>!       ISICE = 15<a name='1494'></font>
<font color=#447700>!     ELSE<a name='1495'></font>
<font color=#447700>!        call wrf_error_fatal ("INPUT LandUse not found: "//TRIM(MMINLU))<a name='1496'></font>
<font color=#447700>!     ENDIF<a name='1497'></font>
      call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_838"> ( 'INPUT LandUse = "' // TRIM(MMINLU) // '"' )<a name='1498'>
      FOUND_LU = .FALSE.<a name='1499'>
      end_of_file = .FALSE.<a name='1500'>
<font color=#447700>!!! BEGINNING OF 1999 LOOP<a name='1501'></font>
 1999 CONTINUE<a name='1502'>
      IF ( wrf_dm_on_monitor() ) THEN<a name='1503'>
        READ (landuse_unit,*,END=2002)LUTYPE<a name='1504'>
        GOTO 2003<a name='1505'>
 2002   CONTINUE<a name='1506'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_839">( 'INPUT FILE FOR LANDUSE REACHED END OF FILE' )<a name='1507'>
        end_of_file = .TRUE.<a name='1508'>
 2003   CONTINUE<a name='1509'>
        IF ( .NOT. end_of_file ) READ (landuse_unit,*)LUCATS,LUSEAS<a name='1510'>
        FOUND_LU = LUTYPE.EQ.MMINLU<a name='1511'>
      ENDIF<a name='1512'>
      CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_291"> (end_of_file, LWORDSIZE )<a name='1513'>
      IF ( .NOT. end_of_file ) THEN<a name='1514'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_292"> (lucats,  IWORDSIZE )<a name='1515'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_STRING'>wrf_dm_bcast_string</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_STRING_12">(lutype, 256)<a name='1516'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_293"> (lucats,  IWORDSIZE )<a name='1517'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_294"> (luseas,  IWORDSIZE )<a name='1518'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_295"> (found_lu,  LWORDSIZE )<a name='1519'>
        IF(FOUND_LU)THEN<a name='1520'>
          LUN=LUCATS<a name='1521'>
          NSN=LUSEAS<a name='1522'>
            IF(LUTYPE.NE.'SSIB') THEN <font color=#447700>!this is not really true for ssib lsm (fds)<a name='1523'></font>
            write(message,*) 'LANDUSE TYPE = "' // TRIM (LUTYPE) // '" FOUND',        &amp;<a name='1524'>
                   LUCATS,' CATEGORIES',LUSEAS,' SEASONS',     &amp;<a name='1525'>
                   ' WATER CATEGORY = ',ISWATER,               &amp;<a name='1526'>
                   ' SNOW CATEGORY = ',ISICE<a name='1527'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_840">(message)<a name='1528'>
            ENDIF<a name='1529'>
        ENDIF<a name='1530'>
        DO ls=1,luseas<a name='1531'>
          if ( wrf_dm_on_monitor() ) then<a name='1532'>
            READ (landuse_unit,*)<a name='1533'>
          endif<a name='1534'>
          DO LC=1,LUCATS<a name='1535'>
            IF(found_lu)THEN<a name='1536'>
              IF ( wrf_dm_on_monitor() ) THEN<a name='1537'>
                READ (landuse_unit,*)LI,ALBD(LC,LS),SLMO(LC,LS),SFEM(LC,LS),        &amp;<a name='1538'>
                           SFZ0(LC,LS),THERIN(LC,LS),SCFX(LC),SFHC(LC,LS)<a name='1539'>
              ENDIF<a name='1540'>
              CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_296"> (LI,  IWORDSIZE )<a name='1541'>
              IF(LC.NE.LI)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_909"> ( 'module_start: MISSING LANDUSE UNIT ' )<a name='1542'>
            ELSE<a name='1543'>
              IF ( wrf_dm_on_monitor() ) THEN<a name='1544'>
                READ (landuse_unit,*)<a name='1545'>
              ENDIF<a name='1546'>
            ENDIF<a name='1547'>
          ENDDO<a name='1548'>
        ENDDO<a name='1549'>
        IF(NSN.EQ.1.AND.FOUND_LU) THEN<a name='1550'>
           ISN = 1<a name='1551'>
        END IF<a name='1552'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_297"> (albd,   max_cats * max_seas * RWORDSIZE )<a name='1553'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_298"> (slmo,   max_cats * max_seas * RWORDSIZE )<a name='1554'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_299"> (sfem,   max_cats * max_seas * RWORDSIZE )<a name='1555'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_300"> (sfz0,   max_cats * max_seas * RWORDSIZE )<a name='1556'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_301"> (therin, max_cats * max_seas * RWORDSIZE )<a name='1557'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_302"> (sfhc,   max_cats * max_seas * RWORDSIZE )<a name='1558'>
        CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_303"> (scfx,   max_cats *            RWORDSIZE )<a name='1559'>
      ENDIF<a name='1560'>
<a name='1561'>
      IF(.NOT. found_lu .AND. .NOT. end_of_file ) GOTO 1999<a name='1562'>
<font color=#447700>!!! END OF 1999 LOOP<a name='1563'></font>
<a name='1564'>
      IF(.NOT. found_lu .OR. end_of_file )THEN<a name='1565'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_841"> ( 'LANDUSE IN INPUT FILE DOES NOT MATCH LUTABLE: TABLE NOT USED' )<a name='1566'>
      ENDIF<a name='1567'>
    ENDIF  <font color=#447700>! allowed_to_read<a name='1568'></font>
<a name='1569'>
    IF(FOUND_LU)THEN<a name='1570'>
<font color=#447700>! Set arrays according to lu_index<a name='1571'></font>
      itf = min0(ite, ide-1)<a name='1572'>
      jtf = min0(jte, jde-1)<a name='1573'>
      IF(usemonalb)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_842"> ( 'Climatological albedo is used instead of table values' )<a name='1574'>
      DO j = jts, jtf<a name='1575'>
        DO i = its, itf<a name='1576'>
          IS=nint(lu_index(i,j))<a name='1577'>
          <font color=#447700>! only do this check on read-in data<a name='1578'></font>
          IF(allowed_to_read)THEN<a name='1579'>
             IF(IS.LT.0.OR.IS.GT.LUN)THEN<a name='1580'>
               WRITE ( wrf_err_message , * ) 'ERROR: LANDUSE OUTSIDE RANGE =',IS,' AT ',I,J,' LUN= ',LUN<a name='1581'>
               CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_910"> ( TRIM ( wrf_err_message ) )<a name='1582'>
             ENDIF<a name='1583'>
          ENDIF<a name='1584'>
<font color=#447700>!   SET NO-DATA POINTS (IS=0) TO WATER<a name='1585'></font>
          IF(IS.EQ.0)THEN<a name='1586'>
            IS=ISWATER<a name='1587'>
          ENDIF<a name='1588'>
          IF(.NOT.usemonalb)ALBBCK(I,J)=ALBD(IS,ISN)/100.<a name='1589'>
          ALBEDO(I,J)=ALBBCK(I,J)<a name='1590'>
          IF(SNOWC(I,J) .GT. 0.5) THEN <a name='1591'>
             IF (usemonalb) THEN<a name='1592'>
                 ALBEDO(I,J)=SNOALB(I,J)<a name='1593'>
             ELSE<a name='1594'>
                 ALBEDO(I,J)=ALBBCK(I,J)*(1.+SCFX(IS))<a name='1595'>
             ENDIF<a name='1596'>
          ENDIF<a name='1597'>
          THC(I,J)=THERIN(IS,ISN)/100.<a name='1598'>
          Z0(I,J)=SFZ0(IS,ISN)/100.<a name='1599'>
          ZNT(I,J)=Z0(I,J)<a name='1600'>
          EMBCK(I,J)=SFEM(IS,ISN)<a name='1601'>
          EMISS(I,J)=EMBCK(I,J)<a name='1602'>
          MAVAIL(I,J)=SLMO(IS,ISN)<a name='1603'>
          IF(IS.NE.ISWATER)THEN<a name='1604'>
            XLAND(I,J)=1.0<a name='1605'>
          ELSE<a name='1606'>
            XLAND(I,J)=2.0<a name='1607'>
          ENDIF<a name='1608'>
<font color=#447700>!    SET SEA-ICE POINTS TO LAND WITH ICE/SNOW SURFACE PROPERTIES<a name='1609'></font>
          XICEM(I,J)=XICE(I,J)<a name='1610'>
          IF(XICE(I,J).GE.xice_threshold)THEN<a name='1611'>
            XLAND(I,J)=1.0<a name='1612'>
            ALBBCK(I,J)=ALBD(ISICE,ISN)/100.<a name='1613'>
            EMBCK(I,J)=SFEM(ISICE,ISN)<a name='1614'>
            IF (FRACTIONAL_SEAICE == 1) THEN<a name='1615'>
               <font color=#447700>! The 0.08 value is the albedo over open water.<a name='1616'></font>
               <font color=#447700>! The 0.98 value is the emissivity over open water.<a name='1617'></font>
               ALBEDO(I,J) = ( XICE(I,J) * ALBBCK(I,J) ) + ( (1.0-XICE(I,J)) * 0.08 )<a name='1618'>
               EMISS(I,J)  = ( XICE(I,J) * EMBCK(I,J)  ) + ( (1.0-XICE(I,J)) * 0.98 )<a name='1619'>
            ELSE<a name='1620'>
               ALBEDO(I,J)=ALBBCK(I,J)<a name='1621'>
               EMISS(I,J)=EMBCK(I,J)<a name='1622'>
            ENDIF<a name='1623'>
            THC(I,J)=THERIN(ISICE,ISN)/100.<a name='1624'>
            Z0(I,J)=SFZ0(ISICE,ISN)/100.<a name='1625'>
            ZNT(I,J)=Z0(I,J)<a name='1626'>
            MAVAIL(I,J)=SLMO(ISICE,ISN)<a name='1627'>
          ENDIF<a name='1628'>
        ENDDO<a name='1629'>
      ENDDO<a name='1630'>
    ENDIF<a name='1631'>
    if ( wrf_dm_on_monitor() .and. allowed_to_read ) then<a name='1632'>
      CLOSE (landuse_unit)<a name='1633'>
    endif<a name='1634'>
    CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_physics_init.F.html#LANDUSE_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_724">( 100 , 'returning from of landuse_init' )<a name='1635'>
<a name='1636'>
<font color=#447700>! restore LU variables from state<a name='1637'></font>
    curs = 1<a name='1638'>
    DO cats = 1, max_cats<a name='1639'>
      lu_state(curs) = SCFX(cats)                 ; curs = curs + 1<a name='1640'>
      DO seas = 1, max_seas<a name='1641'>
        lu_state(curs) = ALBD(cats,seas)          ; curs = curs + 1<a name='1642'>
        lu_state(curs) = SLMO(cats,seas)          ; curs = curs + 1<a name='1643'>
        lu_state(curs) = SFEM(cats,seas)          ; curs = curs + 1<a name='1644'>
        lu_state(curs) = SFZ0(cats,seas)          ; curs = curs + 1<a name='1645'>
        lu_state(curs) = SFHC(cats,seas)          ; curs = curs + 1<a name='1646'>
        lu_state(curs) = THERIN(cats,seas)        ; curs = curs + 1<a name='1647'>
      ENDDO<a name='1648'>
    ENDDO<a name='1649'>
<font color=#447700>!<a name='1650'></font>
<font color=#447700>!-- fds (07/2010)<a name='1651'></font>
<font color=#447700>!-- SSIB's 12-category vegetation parameters are defined in module_ssib_veg<a name='1652'></font>
<font color=#447700>!-- Data in LANDUSE.TBL is only used temporarily until the first<a name='1653'></font>
<font color=#447700>!-- call to SSIB, and also to set water/ice points properties<a name='1654'></font>
<font color=#447700>!    IF(MMINLU.EQ.'SSIB')THEN<a name='1655'></font>
<font color=#447700>!       CALL init_module_ssib_veg<a name='1656'></font>
<font color=#447700>!       CALL wrf_message ( 'READING SSIB VEGETATION PARAMETERS' )<a name='1657'></font>
<font color=#447700>!    ENDIF<a name='1658'></font>
<font color=#447700>!<a name='1659'></font>
<a name='1660'>
   END SUBROUTINE landuse_init<a name='1661'>
<a name='1662'>
<font color=#447700>!=====================================================================<a name='1663'></font>
<A NAME='RA_INIT'><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1664'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>ra_init</font>(id,STEPRA,RADT,DT,RTHRATEN,RTHRATENLW,       &amp; <A href='../../call_to/RA_INIT.html' TARGET='index'>1</A>,<A href='../../call_from/RA_INIT.html' TARGET='index'>32</A><a name='1665'>
                      RTHRATENSW,CLDFRA,EMISS,cen_lat,JULYR,JULDAY,GMT,    &amp;<a name='1666'>
                      levsiz,XLAT,XLONG,n_ozmixm,                     &amp;<a name='1667'>
                      alevsiz,no_src_types,                           &amp;<a name='1668'>
                      cldfra_dp,cldfra_sh,                            &amp; <font color=#447700>! Optional for subgrid cloud by ckay<a name='1669'></font>
                      cldfra_old,                                     &amp; <font color=#447700>! Optional<a name='1670'></font>
                      ozmixm,pin,                                     &amp; <font color=#447700>! Optional<a name='1671'></font>
                      aerodm,pina,                                    &amp; <font color=#447700>! Optional<a name='1672'></font>
                      m_ps_1,m_ps_2,m_hybi,aerosolc_1,aerosolc_2,     &amp; <font color=#447700>! Optional<a name='1673'></font>
                      paerlev,n_aerosolc,                             &amp;<a name='1674'>
                      sfull,shalf,pptop,swrad_scat,p_top,            &amp;<a name='1675'>
                      config_flags,restart,                          &amp;<a name='1676'>
                      allowed_to_read, start_of_simulation,          &amp;<a name='1677'>
                      ids, ide, jds, jde, kds, kde,                  &amp;<a name='1678'>
                      ims, ime, jms, jme, kms, kme,                  &amp;<a name='1679'>
                      its, ite, jts, jte, kts, kte                   )<a name='1680'>
<font color=#447700>!---------------------------------------------------------------------<a name='1681'></font>
   USE <A href='../../html_code/phys/module_ra_rrtm.F.html#MODULE_RA_RRTM'>module_ra_rrtm</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_RRTM_1">      , ONLY : rrtminit<a name='1682'>
   USE <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#MODULE_RA_RRTMG_LW'>module_ra_rrtmg_lw</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_RRTMG_LW_1">  , ONLY : rrtmg_lwinit<a name='1683'>
   USE <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MODULE_RA_RRTMG_SW'>module_ra_rrtmg_sw</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_RRTMG_SW_1">  , ONLY : rrtmg_swinit<a name='1684'>
   USE <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#MODULE_RA_RRTMG_LWF'>module_ra_rrtmg_lwf</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_RRTMG_LWF_1">  , ONLY : rrtmg_lwinit_fast<a name='1685'>
   USE <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MODULE_RA_RRTMG_SWF'>module_ra_rrtmg_swf</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_RRTMG_SWF_1">  , ONLY : rrtmg_swinit_fast<a name='1686'>
   USE <A href='../../html_code/phys/module_ra_cam.F.html#MODULE_RA_CAM'>module_ra_cam</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_CAM_1">       , ONLY : camradinit<a name='1687'>
   USE <A href='../../html_code/phys/module_ra_cam_support.F.html#MODULE_RA_CAM_SUPPORT'>module_ra_cam_support</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_CAM_SUPPORT_1"> , ONLY : oznini<a name='1688'>
   USE <A href='../../html_code/phys/module_ra_sw.F.html#MODULE_RA_SW'>module_ra_sw</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_SW_1">        , ONLY : swinit<a name='1689'>
   USE <A href='../../html_code/phys/module_ra_gsfcsw.F.html#MODULE_RA_GSFCSW'>module_ra_gsfcsw</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_GSFCSW_1">    , ONLY : gsfc_swinit<a name='1690'>
   USE <A href='../../html_code/phys/module_ra_gfdleta.F.html#MODULE_RA_GFDLETA'>module_ra_gfdleta</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_GFDLETA_3">   , ONLY : gfdletainit<a name='1691'>
#if(NMM_CORE==1)<a name='1692'>
   USE <A href='../../html_code/phys/module_ra_HWRF.F.html#MODULE_RA_HWRF'>module_ra_hwrf</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_HWRF_1">      , ONLY : hwrfrainit<a name='1693'>
#endif<a name='1694'>
   USE <A href='../../html_code/phys/module_ra_hs.F.html#MODULE_RA_HS'>module_ra_hs</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_HS_1">        , ONLY : hsinit<a name='1695'>
   USE <A href='../../html_code/frame/module_domain.F.html#MODULE_DOMAIN'>module_domain</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DOMAIN_245"><a name='1696'>
<font color=#447700>!---------------------------------------------------------------------<a name='1697'></font>
   IMPLICIT NONE<a name='1698'>
<font color=#447700>!---------------------------------------------------------------------<a name='1699'></font>
   INTEGER,  INTENT(IN)           :: id<a name='1700'>
   TYPE (grid_config_rec_type)    :: config_flags<a name='1701'>
   LOGICAL , INTENT(IN)           :: restart<a name='1702'>
   LOGICAL,  INTENT(IN)           :: allowed_to_read<a name='1703'>
<a name='1704'>
   INTEGER , INTENT(IN)           :: ids, ide, jds, jde, kds, kde,   &amp;<a name='1705'>
                                     ims, ime, jms, jme, kms, kme,   &amp;<a name='1706'>
                                     its, ite, jts, jte, kts, kte<a name='1707'>
<a name='1708'>
   INTEGER , INTENT(IN)           :: JULDAY,JULYR<a name='1709'>
   REAL ,    INTENT(IN)           :: DT, RADT, cen_lat, GMT, pptop,  &amp;<a name='1710'>
                                     swrad_scat, p_top<a name='1711'>
   LOGICAL,  INTENT(IN)           :: start_of_simulation<a name='1712'>
<a name='1713'>
   INTEGER,      INTENT(IN   )    ::   levsiz, n_ozmixm<a name='1714'>
   INTEGER,      INTENT(IN   )    ::   paerlev, n_aerosolc<a name='1715'>
   INTEGER,      INTENT(IN   )    ::   alevsiz, no_src_types<a name='1716'>
<a name='1717'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(IN) ::  XLAT, XLONG<a name='1718'>
<a name='1719'>
   REAL,  DIMENSION( ims:ime, levsiz, jms:jme, n_ozmixm ), OPTIONAL,      &amp;<a name='1720'>
          INTENT(INOUT) ::                                  OZMIXM<a name='1721'>
   REAL,  DIMENSION( ims:ime, alevsiz, jms:jme, n_ozmixm-1, no_src_types ), OPTIONAL,      &amp;<a name='1722'>
          INTENT(INOUT) ::                                  aerodm<a name='1723'>
<a name='1724'>
   REAL,  DIMENSION(ims:ime,jms:jme), OPTIONAL, INTENT(INOUT)  :: m_ps_1,m_ps_2<a name='1725'>
   REAL,  DIMENSION(paerlev), OPTIONAL, INTENT(INOUT)  ::         m_hybi<a name='1726'>
   REAL,  DIMENSION( ims:ime, paerlev, jms:jme, n_aerosolc ), OPTIONAL,     &amp;<a name='1727'>
          INTENT(INOUT) ::                      aerosolc_1, aerosolc_2<a name='1728'>
<a name='1729'>
   REAL,  DIMENSION(levsiz), OPTIONAL, INTENT(INOUT)  ::          PIN<a name='1730'>
   REAL,  DIMENSION(alevsiz), OPTIONAL, INTENT(INOUT)  ::         PINA<a name='1731'>
<a name='1732'>
   INTEGER , INTENT(INOUT)        :: STEPRA<a name='1733'>
   INTEGER :: isn<a name='1734'>
<a name='1735'>
   REAL , DIMENSION( kms:kme ) , INTENT(IN) :: sfull, shalf<a name='1736'>
   REAL , DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) ::           &amp;<font color=#447700>!BSINGH(PNNL)- should be declared inout<a name='1737'></font>
                                                           RTHRATEN, &amp;<a name='1738'>
                                                         RTHRATENLW, &amp;<a name='1739'>
                                                         RTHRATENSW, &amp;<a name='1740'>
                                                             CLDFRA<a name='1741'>
<a name='1742'>
   REAL , DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) , &amp; <font color=#447700>! ckay for subgrid cloud<a name='1743'></font>
                                                         OPTIONAL :: &amp;<a name='1744'>
                                                          cldfra_dp, &amp;<a name='1745'>
                                                          cldfra_sh<a name='1746'>
<a name='1747'>
   REAL , DIMENSION( ims:ime , kms:kme , jms:jme ) , OPTIONAL, INTENT(INOUT) :: &amp;<font color=#447700>!BSINGH(PNNL)- should be declared inout<a name='1748'></font>
                                                         CLDFRA_OLD<a name='1749'>
<a name='1750'>
   REAL , DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT) :: EMISS<a name='1751'>
   LOGICAL :: etalw = .false.<a name='1752'>
   LOGICAL :: hwrflw= .false.<a name='1753'>
   LOGICAL :: camlw = .false.<a name='1754'>
<font color=#447700>!   LOGICAL :: etamp = .false.<a name='1755'></font>
   LOGICAL :: acswalloc = .false.<a name='1756'>
   LOGICAL :: aclwalloc = .false.<a name='1757'>
   integer :: month,iday<a name='1758'>
   INTEGER :: i, j, k, itf, jtf, ktf<a name='1759'>
<font color=#447700>!---------------------------------------------------------------------<a name='1760'></font>
<a name='1761'>
   jtf=min0(jte,jde-1)<a name='1762'>
   ktf=min0(kte,kde-1)<a name='1763'>
   itf=min0(ite,ide-1)<a name='1764'>
<a name='1765'>
<font color=#447700>!---------------------------------------------------------------------<a name='1766'></font>
<a name='1767'>
<font color=#447700>!-- calculate radiation time step<a name='1768'></font>
<a name='1769'>
    STEPRA = nint(RADT*60./DT)<a name='1770'>
    STEPRA = max(STEPRA,1)<a name='1771'>
<a name='1772'>
<font color=#447700>!-- initialization<a name='1773'></font>
<a name='1774'>
   IF(start_of_simulation)THEN<a name='1775'>
     DO j=jts,jtf<a name='1776'>
     DO k=kts,ktf<a name='1777'>
     DO i=its,itf<a name='1778'>
        RTHRATEN(i,k,j)=0.<a name='1779'>
        RTHRATENLW(i,k,j)=0.<a name='1780'>
        RTHRATENSW(i,k,j)=0.<a name='1781'>
        CLDFRA(i,k,j)=0.<a name='1782'>
     ENDDO<a name='1783'>
     ENDDO<a name='1784'>
     ENDDO<a name='1785'>
<a name='1786'>
     IF( PRESENT(cldfra_dp) ) THEN<a name='1787'>
        DO j=jts,jtf<a name='1788'>
        DO k=kts,ktf<a name='1789'>
        DO i=its,itf<a name='1790'>
           cldfra_dp(i,k,j)=0.<a name='1791'>
           cldfra_sh(i,k,j)=0.<a name='1792'>
        ENDDO<a name='1793'>
        ENDDO<a name='1794'>
        ENDDO<a name='1795'>
     ENDIF<a name='1796'>
<a name='1797'>
     if( present(cldfra_old) ) then<a name='1798'>
        DO j=jts,jtf<a name='1799'>
        DO k=kts,ktf<a name='1800'>
        DO i=its,itf<a name='1801'>
           cldfra_old(i,k,j) = 0.<a name='1802'>
        ENDDO<a name='1803'>
        ENDDO<a name='1804'>
        ENDDO<a name='1805'>
     end if<a name='1806'>
   ENDIF<a name='1807'>
<a name='1808'>
<font color=#447700>!-- ww: attempt to use CAM ozone and some aerosol profiles in all rad schemes<a name='1809'></font>
<font color=#447700>!   note that CAM option will still do the same. <a name='1810'></font>
<font color=#447700>!   n_ozmixm: no of months; levsiz: = 59, vertical dim<a name='1811'></font>
<font color=#447700>!   Read in CAM ozone data, and interpolate data to model grid<a name='1812'></font>
<font color=#447700>!   Interpolation is done on domain 1 only<a name='1813'></font>
<a name='1814'>
#if (EM_CORE==1) <a name='1815'>
   IF ( config_flags%o3input .EQ. 2 .AND. id .EQ. 1 ) THEN<a name='1816'>
#else<a name='1817'>
   IF ( config_flags%o3input .EQ. 2 ) THEN<a name='1818'>
#endif<a name='1819'>
      CALL <A href='../../html_code/phys/module_ra_cam_support.F.html#OZNINI'>oznini</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="OZNINI_1">(ozmixm,pin,levsiz,n_ozmixm,XLAT,                &amp;<a name='1820'>
                     ids, ide, jds, jde, kds, kde,                  &amp;<a name='1821'>
                     ims, ime, jms, jme, kms, kme,                  &amp;<a name='1822'>
                     its, ite, jts, jte, kts, kte)<a name='1823'>
   ENDIF<a name='1824'>
<a name='1825'>
   IF ( config_flags%aer_opt .EQ. 1 .AND. id .EQ. 1 ) THEN<a name='1826'>
      CALL <A href='../../html_code/phys/module_physics_init.F.html#AEROSOL_IN'>aerosol_in</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="AEROSOL_IN_1">(aerodm,pina,alevsiz,n_ozmixm-1,no_src_types,XLAT,XLONG,   &amp;<a name='1827'>
                     ids, ide, jds, jde, kds, kde,                  &amp;<a name='1828'>
                     ims, ime, jms, jme, kms, kme,                  &amp;<a name='1829'>
                     its, ite, jts, jte, kts, kte)<a name='1830'>
   ENDIF<a name='1831'>
<a name='1832'>
<font color=#447700>!-- find out which microphysics option is used first<a name='1833'></font>
<a name='1834'>
<font color=#447700>!   mp_select: SELECT CASE(config_flags%mp_physics)<a name='1835'></font>
<font color=#447700>!<a name='1836'></font>
<font color=#447700>!        CASE (ETAMPNEW)<a name='1837'></font>
<font color=#447700>!             etamp = .true.<a name='1838'></font>
<font color=#447700>!<a name='1839'></font>
<font color=#447700>!   END SELECT mp_select<a name='1840'></font>
<a name='1841'>
<font color=#447700>!-- chose long wave radiation scheme<a name='1842'></font>
<a name='1843'>
   lwrad_select: SELECT CASE(config_flags%ra_lw_physics)<a name='1844'>
<a name='1845'>
        CASE (RRTMSCHEME)<a name='1846'>
             CALL <A href='../../html_code/phys/module_ra_rrtm.F.html#RRTMINIT'>rrtminit</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMINIT_1">(                                 &amp;<a name='1847'>
                           p_top, allowed_to_read ,         &amp;<a name='1848'>
                           ids, ide, jds, jde, kds, kde,    &amp;<a name='1849'>
                           ims, ime, jms, jme, kms, kme,    &amp;<a name='1850'>
                           its, ite, jts, jte, kts, kte     )<a name='1851'>
<a name='1852'>
        CASE (CAMLWSCHEME)<a name='1853'>
#ifdef MAC_KLUDGE<a name='1854'>
             CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_911"> ( 'CAM radiation scheme not supported under the chosen build configuration' )<a name='1855'>
#endif<a name='1856'>
             IF ( PRESENT( OZMIXM ) .AND. PRESENT( PIN ) .AND. &amp;<a name='1857'>
                  PRESENT(M_PS_1) .AND. PRESENT(M_PS_2) .AND.  &amp;<a name='1858'>
                  PRESENT(M_HYBI) .AND. PRESENT(AEROSOLC_1)    &amp;<a name='1859'>
                  .AND. PRESENT(AEROSOLC_2)) THEN<a name='1860'>
             CALL <A href='../../html_code/phys/module_ra_cam.F.html#CAMRADINIT'>camradinit</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CAMRADINIT_1">(                                  &amp;<a name='1861'>
                         R_D,R_V,CP,G,STBOLT,EP_2,shalf,pptop, &amp;<a name='1862'>
                         ozmixm,pin,levsiz,XLAT,n_ozmixm,      &amp;<a name='1863'>
                         m_ps_1,m_ps_2,m_hybi,aerosolc_1,aerosolc_2,&amp;<a name='1864'>
                         paerlev, n_aerosolc,              &amp;<a name='1865'>
                         ids, ide, jds, jde, kds, kde,     &amp;<a name='1866'>
                         ims, ime, jms, jme, kms, kme,     &amp;<a name='1867'>
                         its, ite, jts, jte, kts, kte      )<a name='1868'>
             ELSE<a name='1869'>
                CALL wrf_error_fatal ( 'arguments not present for calling cam radiation' )<a name='1870'>
             ENDIF<a name='1871'>
<a name='1872'>
             camlw = .true.<a name='1873'>
             aclwalloc = .true.<a name='1874'>
<a name='1875'>
        CASE (RRTMG_LWSCHEME)<a name='1876'>
             CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#RRTMG_LWINIT'>rrtmg_lwinit</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_LWINIT_1">(                             &amp;<a name='1877'>
                           p_top, allowed_to_read ,         &amp;<a name='1878'>
                           ids, ide, jds, jde, kds, kde,    &amp;<a name='1879'>
                           ims, ime, jms, jme, kms, kme,    &amp;<a name='1880'>
                           its, ite, jts, jte, kts, kte     )<a name='1881'>
<a name='1882'>
             aclwalloc = .true.<a name='1883'>
<a name='1884'>
        CASE (RRTMG_LWSCHEME_FAST)<a name='1885'>
             CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#RRTMG_LWINIT_FAST'>rrtmg_lwinit_fast</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_LWINIT_FAST_1">(                             &amp;<a name='1886'>
                           p_top, allowed_to_read ,         &amp;<a name='1887'>
                           ids, ide, jds, jde, kds, kde,    &amp;<a name='1888'>
                           ims, ime, jms, jme, kms, kme,    &amp;<a name='1889'>
                           its, ite, jts, jte, kts, kte     )<a name='1890'>
<a name='1891'>
             aclwalloc = .true.<a name='1892'>
<a name='1893'>
<a name='1894'>
        CASE (GFDLLWSCHEME)<a name='1895'>
             CALL nl_get_start_month(id,month)<a name='1896'>
             CALL nl_get_start_day(id,iday)<a name='1897'>
             CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#GFDLETAINIT'>gfdletainit</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFDLETAINIT_1">(emiss,sfull,shalf,pptop,      &amp;<a name='1898'>
                              julyr,month,iday,gmt,         &amp;<a name='1899'>
                              config_flags,allowed_to_read, &amp;<a name='1900'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='1901'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='1902'>
                              its, ite, jts, jte, kts, kte  )<a name='1903'>
             etalw = .true.<a name='1904'>
#if(NMM_CORE==1)<a name='1905'>
        CASE (HWRFLWSCHEME)<a name='1906'>
             CALL nl_get_start_month(id,month)<a name='1907'>
             CALL nl_get_start_day(id,iday)<a name='1908'>
<font color=#447700>! test this with standard jul-day calls<a name='1909'></font>
<font color=#447700>!     CALL nl_get_start_year(id,start_year)<a name='1910'></font>
<font color=#447700>!     CALL nl_get_start_month(id,start_month)<a name='1911'></font>
<font color=#447700>!     CALL nl_get_start_day(id,start_day)<a name='1912'></font>
<font color=#447700>!     CALL nl_get_start_hour(id,start_hour)<a name='1913'></font>
<font color=#447700>!     CALL nl_get_start_minute(id,start_minute)<a name='1914'></font>
<font color=#447700>!     CALL nl_get_start_second(id,start_second)<a name='1915'></font>
<font color=#447700>!     CALL jdn_sec(day_in_sec,start_year,start_month,start_day,0,0,0)<a name='1916'></font>
<font color=#447700>!     CALL jdn_sec(day_in_sec_ref,start_year,1,1,0,0,0)<a name='1917'></font>
<font color=#447700>!     julyr_start=start_year<a name='1918'></font>
<font color=#447700>!     julday_start=(day_in_sec-day_in_sec_ref)/(3600.*24.)+1<a name='1919'></font>
<font color=#447700>!     gmt_start=start_hour+real(start_minute)/60.+real(start_second)/3600.<a name='1920'></font>
              CALL <A href='../../html_code/phys/module_ra_HWRF.F.html#HWRFRAINIT'>hwrfrainit</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="HWRFRAINIT_1">(sfull,shalf,pptop,JULYR,MONTH,IDAY,GMT,&amp;<a name='1921'>
<font color=#447700>!             CALL hwrfrainit(sfull,shalf,pptop,JULYR_start,MONTH,IDAY,GMT_start,&amp;<a name='1922'></font>
                            config_flags,allowed_to_read ,                         &amp;<a name='1923'>
                           kds, kde, kms, kme, kts, kte     )<a name='1924'>
             hwrflw = .true.<a name='1925'>
#endif<a name='1926'>
        CASE (HELDSUAREZ)<a name='1927'>
             CALL <A href='../../html_code/phys/module_ra_hs.F.html#HSINIT'>hsinit</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="HSINIT_1">(RTHRATEN,restart,             &amp;<a name='1928'>
                         ids, ide, jds, jde, kds, kde, &amp;<a name='1929'>
                         ims, ime, jms, jme, kms, kme, &amp;<a name='1930'>
                         its, ite, jts, jte, kts, kte )<a name='1931'>
<a name='1932'>
        CASE (FLGLWSCHEME)<a name='1933'>
<a name='1934'>
        CASE DEFAULT<a name='1935'>
<a name='1936'>
   END SELECT lwrad_select<a name='1937'>
<font color=#447700>!-- initialize short wave radiation scheme<a name='1938'></font>
<a name='1939'>
   swrad_select: SELECT CASE(config_flags%ra_sw_physics)<a name='1940'>
<a name='1941'>
        CASE (SWRADSCHEME)<a name='1942'>
             CALL <A href='../../html_code/phys/module_ra_sw.F.html#SWINIT'>swinit</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SWINIT_1">(                                  &amp;<a name='1943'>
                         swrad_scat,                       &amp;<a name='1944'>
                         allowed_to_read ,                 &amp;<a name='1945'>
                         ids, ide, jds, jde, kds, kde,     &amp;<a name='1946'>
                         ims, ime, jms, jme, kms, kme,     &amp;<a name='1947'>
                         its, ite, jts, jte, kts, kte      )<a name='1948'>
<a name='1949'>
        CASE (CAMSWSCHEME)<a name='1950'>
#ifdef MAC_KLUDGE<a name='1951'>
             CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_912"> ( 'CAM radiation scheme not supported under the chosen build configuration' )<a name='1952'>
#endif<a name='1953'>
             IF(.not.camlw)THEN<a name='1954'>
             CALL <A href='../../html_code/phys/module_ra_cam.F.html#CAMRADINIT'>camradinit</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CAMRADINIT_2">(                              &amp;<a name='1955'>
                         R_D,R_V,CP,G,STBOLT,EP_2,shalf,pptop,               &amp;<a name='1956'>
                         ozmixm,pin,levsiz,XLAT,n_ozmixm,     &amp;<a name='1957'>
                         m_ps_1,m_ps_2,m_hybi,aerosolc_1,aerosolc_2,&amp;<a name='1958'>
                         paerlev, n_aerosolc,              &amp;<a name='1959'>
                         ids, ide, jds, jde, kds, kde,     &amp;<a name='1960'>
                         ims, ime, jms, jme, kms, kme,     &amp;<a name='1961'>
                         its, ite, jts, jte, kts, kte      )<a name='1962'>
             ENDIF<a name='1963'>
             acswalloc = .true.<a name='1964'>
<a name='1965'>
        CASE (GSFCSWSCHEME)<a name='1966'>
             CALL <A href='../../html_code/phys/module_ra_gsfcsw.F.html#GSFC_SWINIT'>gsfc_swinit</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GSFC_SWINIT_1">(cen_lat, allowed_to_read )<a name='1967'>
<a name='1968'>
        CASE (RRTMG_SWSCHEME)<a name='1969'>
             CALL <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWINIT'>rrtmg_swinit</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SWINIT_1">(                             &amp;<a name='1970'>
                           allowed_to_read ,                &amp;<a name='1971'>
                           ids, ide, jds, jde, kds, kde,    &amp;<a name='1972'>
                           ims, ime, jms, jme, kms, kme,    &amp;<a name='1973'>
                           its, ite, jts, jte, kts, kte     )<a name='1974'>
<a name='1975'>
             acswalloc = .true.<a name='1976'>
<a name='1977'>
        CASE (RRTMG_SWSCHEME_FAST)<a name='1978'>
             CALL <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWINIT_FAST'>rrtmg_swinit_fast</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SWINIT_FAST_1">(                             &amp;<a name='1979'>
                           allowed_to_read ,                &amp;<a name='1980'>
                           ids, ide, jds, jde, kds, kde,    &amp;<a name='1981'>
                           ims, ime, jms, jme, kms, kme,    &amp;<a name='1982'>
                           its, ite, jts, jte, kts, kte     )<a name='1983'>
<a name='1984'>
             acswalloc = .true.<a name='1985'>
<a name='1986'>
<a name='1987'>
        CASE (GFDLSWSCHEME)<a name='1988'>
             IF(.not.etalw)THEN<a name='1989'>
             CALL nl_get_start_month(id,month)<a name='1990'>
             CALL nl_get_start_day(id,iday)<a name='1991'>
             CALL <A href='../../html_code/phys/module_ra_gfdleta.F.html#GFDLETAINIT'>gfdletainit</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFDLETAINIT_2">(emiss,sfull,shalf,pptop,      &amp;<a name='1992'>
                              julyr,month,iday,gmt,         &amp;<a name='1993'>
                              config_flags,allowed_to_read, &amp;<a name='1994'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='1995'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='1996'>
                              its, ite, jts, jte, kts, kte  )<a name='1997'>
             ENDIF<a name='1998'>
#if(NMM_CORE==1)<a name='1999'>
        CASE (HWRFSWSCHEME)<a name='2000'>
             IF(.not.hwrflw)THEN<a name='2001'>
             CALL nl_get_start_month(id,month)<a name='2002'>
             CALL nl_get_start_day(id,iday)<a name='2003'>
             CALL <A href='../../html_code/phys/module_ra_HWRF.F.html#HWRFRAINIT'>hwrfrainit</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="HWRFRAINIT_2">(sfull,shalf,pptop,JULYR,MONTH,IDAY,GMT,&amp;<a name='2004'>
                            config_flags,allowed_to_read,                          &amp;<a name='2005'>
                           kds, kde, kms, kme, kts, kte     )<a name='2006'>
             ENDIF<a name='2007'>
#endif<a name='2008'>
        CASE (FLGSWSCHEME)<a name='2009'>
<a name='2010'>
        CASE DEFAULT<a name='2011'>
<a name='2012'>
   END SELECT swrad_select<a name='2013'>
<a name='2014'>
#if ( EM_CORE == 1 ) <a name='2015'>
   <font color=#447700>! test for conditionally allocated arrays when using bucket_J<a name='2016'></font>
<a name='2017'>
   IF(config_flags%bucket_J .gt. 0.0)THEN<a name='2018'>
     IF(.not. (acswalloc .and. aclwalloc))THEN<a name='2019'>
           CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#RA_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_913"> ( 'Need CAM or RRTMG radiation for bucket_J option')<a name='2020'>
     ENDIF<a name='2021'>
   ENDIF<a name='2022'>
#endif<a name='2023'>
<a name='2024'>
   END SUBROUTINE ra_init<a name='2025'>
<a name='2026'>
<A NAME='BL_INIT'><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2027'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>bl_init</font>(STEPBL,BLDT,DT,RUBLTEN,RVBLTEN,RTHBLTEN,  &amp; <A href='../../call_to/BL_INIT.html' TARGET='index'>1</A>,<A href='../../call_from/BL_INIT.html' TARGET='index'>109</A><a name='2028'>
                RQVBLTEN,RQCBLTEN,RQIBLTEN,TSK,TMN,             &amp;<a name='2029'>
                config_flags,restart,UST,LOWLYR,TSLB,ZS,DZS,    &amp;<a name='2030'>
                num_soil_layers,TKE_PBL,mfshconv,               &amp;<a name='2031'>
                massflux_EDKF, entr_EDKF, detr_EDKF, &amp; <a name='2032'>
                thl_up, thv_up, rt_up,       &amp;<a name='2033'>
                rv_up, rc_up, u_up, v_up,    &amp;<a name='2034'>
                frac_up, &amp;<a name='2035'>
                EXCH_H,VEGFRA,                                  &amp;<a name='2036'>
                SNOW,SNOWC, CANWAT,SMSTAV,                      &amp;<a name='2037'>
                SMSTOT, SFCRUNOFF,UDRUNOFF,ACSNOW,ACSNOM,       &amp;<a name='2038'>
                IVGTYP,ISLTYP,ISURBAN,SMOIS,SMFR3D,mavail,      &amp;<a name='2039'>
                SNOWH,SH2O,SNOALB,FNDSOILW,FNDSNOWH,RDMAXALB,   &amp;<a name='2040'>
#if  ( NMM_CORE == 1 )<a name='2041'>
                Z0,XLAND,XICE,DX,DY,                            &amp;<a name='2042'>
#else<a name='2043'>
                ZNT,XLAND,XICE,DX, DY, MSFTX, MSFTY,            &amp;<a name='2044'>
#endif<a name='2045'>
                QKE, SFCEVP,GRDFLX,                             &amp;<a name='2046'>
                MMINLU,                                         &amp;<a name='2047'>
                ISNOWXY, ZSNSOXY, TSNOXY,                       &amp;<a name='2048'>
                SNICEXY, SNLIQXY, TVXY, TGXY, CANICEXY,         &amp;<a name='2049'>
                CANLIQXY, EAHXY, TAHXY, CMXY,                   &amp;<a name='2050'>
                CHXY, FWETXY, SNEQVOXY, ALBOLDXY, QSNOWXY,      &amp;<a name='2051'>
                WSLAKEXY, ZWTXY, WAXY, WTXY, LFMASSXY, RTMASSXY,&amp;<a name='2052'>
                STMASSXY, WOODXY, STBLCPXY, FASTCPXY,           &amp;<a name='2053'>
                GRAINXY, GDDXY,                                 &amp; <font color=#447700>! Noah-MP Crop model<a name='2054'></font>
                croptype, cropcat,                              &amp; <font color=#447700>! Noah-MP Crop model<a name='2055'></font>
                XSAIXY, LAI,                                    &amp;<a name='2056'>
                SMOISEQ, SMCWTDXY, RECHXY, DEEPRECHXY, AREAXY,  &amp;<a name='2057'>
                WTDDT, STEPWTD,QRFSXY ,QSPRINGSXY ,QSLATXY,     &amp;<a name='2058'>
                FDEPTHXY, RIVERBEDXY, EQZWT, RIVERCONDXY, PEXPXY, &amp; <a name='2059'>
                rechclim  ,                                     &amp;<a name='2060'>
                ISICE,                                 &amp;<a name='2061'>
                T2MVXY, T2MBXY ,CHSTARXY,                       &amp;<a name='2062'>
                allowed_to_read, iopt_run ,                     &amp;<a name='2063'>
                start_of_simulation,                            &amp;<a name='2064'>
                lakedepth2d,  savedtke12d,  snowdp2d,   h2osno2d,       &amp; <font color=#447700>!lake<a name='2065'></font>
                snl2d,        t_grnd2d,     t_lake3d,   lake_icefrac3d, &amp; <font color=#447700>!lake<a name='2066'></font>
                z_lake3d,     dz_lake3d,    t_soisno3d, h2osoi_ice3d,   &amp; <font color=#447700>!lake<a name='2067'></font>
                h2osoi_liq3d, h2osoi_vol3d, z3d,        dz3d,           &amp; <font color=#447700>!lake<a name='2068'></font>
                zi3d,         watsat3d,     csol3d,     tkmg3d,         &amp; <font color=#447700>!lake<a name='2069'></font>
                tkdry3d,      tksatu3d,     LakeModel,  lake2d,           &amp; <font color=#447700>!lake<a name='2070'></font>
                lakedepth_default,            lake_min_elev, lake_depth,       &amp; <font color=#447700>!lake<a name='2071'></font>
#if (EM_CORE == 1)<a name='2072'>
                lakemask, lakeflag,                                      &amp; <font color=#447700>!lake<a name='2073'></font>
#endif<a name='2074'>
                lake_depth_flag, use_lakedepth,                          &amp; <font color=#447700>!lake<a name='2075'></font>
                te_temf,cf3d_temf,wm_temf,                      &amp; <font color=#447700>! WA<a name='2076'></font>
<font color=#447700>!                num_roof_layers,num_wall_layers,num_road_layers,&amp; !Optional urban<a name='2077'></font>
                DZR, DZB, DZG,                                  &amp; <font color=#447700>!Optional urban<a name='2078'></font>
                TR_URB2D,TB_URB2D,TG_URB2D,TC_URB2D,QC_URB2D,   &amp; <font color=#447700>!Optional urban<a name='2079'></font>
                XXXR_URB2D,XXXB_URB2D,XXXG_URB2D,XXXC_URB2D,    &amp; <font color=#447700>!Optional urban<a name='2080'></font>
                TRL_URB3D, TBL_URB3D, TGL_URB3D,                &amp; <font color=#447700>!Optional urban<a name='2081'></font>
                SH_URB2D,LH_URB2D,G_URB2D,RN_URB2D,             &amp; <font color=#447700>!Optional urban<a name='2082'></font>
                TS_URB2D, FRC_URB2D, UTYPE_URB2D,               &amp;<a name='2083'>
                SF_URBAN_PHYSICS,                               &amp; <font color=#447700>!Optional urban<a name='2084'></font>
                CMCR_URB2D,TGR_URB2D,TGRL_URB3D,SMR_URB3D,      &amp; <font color=#447700>!Optional urban<a name='2085'></font>
                DRELR_URB2D,DRELB_URB2D,DRELG_URB2D,            &amp; <font color=#447700>!Optional urban<a name='2086'></font>
                FLXHUMR_URB2D,FLXHUMB_URB2D,FLXHUMG_URB2D,      &amp; <font color=#447700>!Optional urban<a name='2087'></font>
                NUM_URBAN_LAYERS,                               &amp; <font color=#447700>!Optional multi-layer urban<a name='2088'></font>
                NUM_URBAN_HI,                                   &amp; <font color=#447700>!Optional multi-layer urban<a name='2089'></font>
                TRB_URB4D,TW1_URB4D,TW2_URB4D,                  &amp; <font color=#447700>!Optional multi-layer urban<a name='2090'></font>
                TGB_URB4D,TLEV_URB3D,QLEV_URB3D,                &amp; <font color=#447700>!Optional multi-layer urban<a name='2091'></font>
                TW1LEV_URB3D,TW2LEV_URB3D,                      &amp; <font color=#447700>!Optional multi-layer urban<a name='2092'></font>
                TGLEV_URB3D,TFLEV_URB3D,                        &amp; <font color=#447700>!Optional multi-layer urban<a name='2093'></font>
                SF_AC_URB3D,LF_AC_URB3D,CM_AC_URB3D,            &amp; <font color=#447700>!Optional multi-layer urban<a name='2094'></font>
                SFVENT_URB3D,LFVENT_URB3D,                      &amp; <font color=#447700>!Optional multi-layer urban<a name='2095'></font>
                SFWIN1_URB3D,SFWIN2_URB3D,                      &amp; <font color=#447700>!Optional multi-layer urban<a name='2096'></font>
                SFW1_URB3D,SFW2_URB3D,                          &amp; <font color=#447700>!Optional multi-layer urban<a name='2097'></font>
                SFR_URB3D,SFG_URB3D,                            &amp; <font color=#447700>!Optional multi-layer urban<a name='2098'></font>
                LP_URB2D,HI_URB2D,LB_URB2D,                     &amp; <font color=#447700>!Optional multi-layer urban<a name='2099'></font>
                HGT_URB2D,MH_URB2D,STDH_URB2D,                  &amp; <font color=#447700>!Optional multi-layer urban<a name='2100'></font>
                LF_URB2D,                                       &amp; <font color=#447700>!Optional multi-layer urban<a name='2101'></font>
                A_U_BEP,A_V_BEP,A_T_BEP,A_Q_BEP,                &amp; <font color=#447700>!Optional multi-layer urban<a name='2102'></font>
                A_E_BEP,B_U_BEP,B_V_BEP,                        &amp; <font color=#447700>!Optional multi-layer urban<a name='2103'></font>
                B_T_BEP,B_Q_BEP,B_E_BEP,DLG_BEP,                &amp; <font color=#447700>!Optional multi-layer urban<a name='2104'></font>
                DL_U_BEP,SF_BEP,VL_BEP,                         &amp; <font color=#447700>!Optional multi-layer urban<a name='2105'></font>
                ids, ide, jds, jde, kds, kde,                   &amp;<a name='2106'>
                ims, ime, jms, jme, kms, kme,                   &amp;<a name='2107'>
                its, ite, jts, jte, kts, kte,                   &amp;<a name='2108'>
                ACHFX,ACLHF,ACGRDFLX,                           &amp;<a name='2109'>
                oml_hml0, sf_ocean_physics,                     &amp; <font color=#447700>!Optional oml<a name='2110'></font>
                TML,T0ML,HML,H0ML,HUML,HVML,TMOML,              &amp;<a name='2111'>
                is_CAMMGMP_used                                 &amp;<a name='2112'>
               ,TSK_SAVE                                        &amp; <font color=#447700>!Optional fractional seaice<a name='2113'></font>
<font color=#447700>! CLM vraiables <a name='2114'></font>
               ,numc,nump,snl,                                      &amp;<a name='2115'>
                snowdp,wtc,wtp,h2osno,t_grnd,t_veg,         &amp;<a name='2116'>
                h2ocan,h2ocan_col,t2m_max,t2m_min,t_ref2m,          &amp;<a name='2117'>
                h2osoi_liq_s1,              &amp;<a name='2118'>
                h2osoi_liq_s2,h2osoi_liq_s3,h2osoi_liq_s4,          &amp;<a name='2119'>
                h2osoi_liq_s5,h2osoi_liq1,h2osoi_liq2,              &amp;<a name='2120'>
                h2osoi_liq3,h2osoi_liq4,h2osoi_liq5,h2osoi_liq6,    &amp;<a name='2121'>
                h2osoi_liq7,h2osoi_liq8,h2osoi_liq9,h2osoi_liq10,   &amp;<a name='2122'>
                h2osoi_ice_s1,h2osoi_ice_s2,                        &amp;<a name='2123'>
                h2osoi_ice_s3,h2osoi_ice_s4,h2osoi_ice_s5,          &amp;<a name='2124'>
                h2osoi_ice1,h2osoi_ice2,h2osoi_ice3,h2osoi_ice4,    &amp;<a name='2125'>
                h2osoi_ice5,h2osoi_ice6,h2osoi_ice7,                &amp;<a name='2126'>
                h2osoi_ice8,h2osoi_ice9,h2osoi_ice10,               &amp;<a name='2127'>
                t_soisno_s1,t_soisno_s2,t_soisno_s3,t_soisno_s4,    &amp;<a name='2128'>
                t_soisno_s5,t_soisno1,t_soisno2,t_soisno3,          &amp;<a name='2129'>
                t_soisno4,t_soisno5,t_soisno6,t_soisno7,            &amp;<a name='2130'>
                t_soisno8,t_soisno9,t_soisno10,                     &amp;<a name='2131'>
                dzsnow1,dzsnow2,dzsnow3,dzsnow4,dzsnow5,            &amp;<a name='2132'>
                snowrds1,snowrds2,snowrds3,snowrds4,snowrds5,       &amp;<a name='2133'>
                t_lake1,t_lake2,t_lake3,t_lake4,t_lake5,            &amp;<a name='2134'>
                t_lake6,t_lake7,t_lake8,t_lake9,t_lake10,           &amp;<a name='2135'>
                h2osoi_vol1,h2osoi_vol2,h2osoi_vol3,                &amp;<a name='2136'>
                h2osoi_vol4,h2osoi_vol5,h2osoi_vol6,                &amp;<a name='2137'>
                h2osoi_vol7,h2osoi_vol8,                            &amp;<a name='2138'>
                h2osoi_vol9,h2osoi_vol10,                           &amp;<a name='2139'>
                ht,maxpatch,                                        &amp;<a name='2140'>
                ALBEDOsubgrid,LHsubgrid,HFXsubgrid,LWUPsubgrid,     &amp;<a name='2141'>
                Q2subgrid,SABVsubgrid,SABGsubgrid,NRAsubgrid,       &amp;<a name='2142'>
                SWUPsubgrid,lhsoi,lhveg,lhtran                      &amp;<a name='2143'>
<font color=#447700>! end of CLM vraiables <a name='2144'></font>
                ,landusef,landusef2,NLCAT                       &amp; <font color=#447700>! danli mosaic<a name='2145'></font>
                ,sf_surface_mosaic, mosaic_cat                  &amp; <font color=#447700>! danli mosaic<a name='2146'></font>
                ,mosaic_cat_index                               &amp; <font color=#447700>! danli mosaic  <a name='2147'></font>
                ,TSK_mosaic,TSLB_mosaic                         &amp; <font color=#447700>! danli mosaic<a name='2148'></font>
                ,SMOIS_mosaic,SH2O_mosaic                       &amp; <font color=#447700>! danli mosaic<a name='2149'></font>
                ,CANWAT_mosaic,SNOW_mosaic                      &amp; <font color=#447700>! danli mosaic<a name='2150'></font>
                ,SNOWH_mosaic,SNOWC_mosaic                      &amp; <font color=#447700>! danli mosaic<a name='2151'></font>
                ,ALBEDO,ALBBCK, EMISS, EMBCK                    &amp; <font color=#447700>! danli mosaic <a name='2152'></font>
                ,ALBEDO_mosaic,ALBBCK_mosaic, EMISS_mosaic, EMBCK_mosaic, ZNT_mosaic, Z0_mosaic   &amp;         <font color=#447700>! danli mosaic<a name='2153'></font>
                ,TR_URB2D_mosaic,TB_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic <a name='2154'></font>
                ,TG_URB2D_mosaic,TC_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic <a name='2155'></font>
                ,QC_URB2D_mosaic                                &amp;  <font color=#447700>!danli mosaic                  <a name='2156'></font>
                ,TRL_URB3D_mosaic,TBL_URB3D_mosaic              &amp;  <font color=#447700>!danli mosaic <a name='2157'></font>
                ,TGL_URB3D_mosaic                               &amp;  <font color=#447700>!danli mosaic <a name='2158'></font>
                ,SH_URB2D_mosaic,LH_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic <a name='2159'></font>
                ,G_URB2D_mosaic,RN_URB2D_mosaic                 &amp;  <font color=#447700>!danli mosaic <a name='2160'></font>
                ,TS_URB2D_mosaic                                &amp;  <font color=#447700>!danli mosaic <a name='2161'></font>
                ,TS_RUL2D_mosaic                                &amp;  <font color=#447700>!danli mosaic  <a name='2162'></font>
                                                                ) <font color=#447700>!Optional oml<a name='2163'></font>
<font color=#447700>!--------------------------------------------------------------------<a name='2164'></font>
   USE <A href='../../html_code/phys/module_sf_sfclay.F.html#MODULE_SF_SFCLAY'>module_sf_sfclay</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_SFCLAY_1"><a name='2165'>
   USE <A href='../../html_code/phys/module_sf_sfclayrev.F.html#MODULE_SF_SFCLAYREV'>module_sf_sfclayrev</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_SFCLAYREV_1"><a name='2166'>
   USE <A href='../../html_code/phys/module_sf_slab.F.html#MODULE_SF_SLAB'>module_sf_slab</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_SLAB_1"><a name='2167'>
   USE <A href='../../html_code/phys/module_sf_pxsfclay.F.html#MODULE_SF_PXSFCLAY'>module_sf_pxsfclay</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_PXSFCLAY_1"><a name='2168'>
   USE <A href='../../html_code/phys/module_bl_ysu.F.html#MODULE_BL_YSU'>module_bl_ysu</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_YSU_2"><a name='2169'>
   USE <A href='../../html_code/phys/module_bl_shinhong.F.html#MODULE_BL_SHINHONG'>module_bl_shinhong</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_SHINHONG_2"><a name='2170'>
   USE <A href='../../html_code/phys/module_bl_mrf.F.html#MODULE_BL_MRF'>module_bl_mrf</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_MRF_2"><a name='2171'>
   USE <A href='../../html_code/phys/module_bl_gfs.F.html#MODULE_BL_GFS'>module_bl_gfs</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_GFS_2"><a name='2172'>
#if (HWRF==1)<a name='2173'>
   USE <A href='../../html_code/phys/module_bl_gfsedmf.F.html#MODULE_BL_GFSEDMF'>module_bl_gfsedmf</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_GFSEDMF_2">, only : gfsedmfinit<a name='2174'>
#endif<a name='2175'>
   USE <A href='../../html_code/phys/module_bl_acm.F.html#MODULE_BL_ACM'>module_bl_acm</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_ACM_2"><a name='2176'>
   USE <A href='../../html_code/phys/module_sf_myjsfc.F.html#MODULE_SF_MYJSFC'>module_sf_myjsfc</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_MYJSFC_2"><a name='2177'>
   USE <A href='../../html_code/phys/module_sf_qnsesfc.F.html#MODULE_SF_QNSESFC'>module_sf_qnsesfc</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_QNSESFC_1"><a name='2178'>
   USE <A href='../../html_code/phys/module_sf_noahdrv.F.html#MODULE_SF_NOAHDRV'>module_sf_noahdrv</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_NOAHDRV_1"><a name='2179'>
   USE <A href='../../html_code/phys/module_sf_noahlsm.F.html#MODULE_SF_NOAHLSM'>module_sf_noahlsm</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_NOAHLSM_1">, only : LOW_DENSITY_RESIDENTIAL, HIGH_DENSITY_RESIDENTIAL, HIGH_INTENSITY_INDUSTRIAL<a name='2180'>
   USE <A href='../../html_code/phys/module_sf_noahmpdrv.F.html#MODULE_SF_NOAHMPDRV'>module_sf_noahmpdrv</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_NOAHMPDRV_1"><a name='2181'>
   USE <A href='../../html_code/phys/module_sf_noahmplsm.F.html#NOAHMP_TABLES'>noahmp_tables</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NOAHMP_TABLES_1">, ONLY: LOW_DENSITY_RESIDENTIAL_TABLE, HIGH_DENSITY_RESIDENTIAL_TABLE, HIGH_INTENSITY_INDUSTRIAL_TABLE<a name='2182'>
#ifdef WRF_USE_CLM<a name='2183'>
   USE <A href='../../html_code/phys/module_sf_clm.F.html#MODULE_SF_CLM'>module_sf_clm</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_CLM_1">, only : clminit<a name='2184'>
#endif<a name='2185'>
   USE <A href='../../html_code/phys/module_sf_urban.F.html#MODULE_SF_URBAN'>module_sf_urban</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_URBAN_1"><a name='2186'>
   USE <A href='../../html_code/phys/module_sf_bep.F.html#MODULE_SF_BEP'>module_sf_bep</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_BEP_1">                                  <font color=#447700>!BEP<a name='2187'></font>
   USE <A href='../../html_code/phys/module_sf_bep_bem.F.html#MODULE_SF_BEP_BEM'>module_sf_bep_bem</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_BEP_BEM_1"><a name='2188'>
   USE <A href='../../html_code/phys/module_sf_ruclsm.F.html#MODULE_SF_RUCLSM'>module_sf_ruclsm</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_RUCLSM_1"><a name='2189'>
   USE <A href='../../html_code/phys/module_sf_pxlsm.F.html#MODULE_SF_PXLSM'>module_sf_pxlsm</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_PXLSM_1"><a name='2190'>
   USE <A href='../../html_code/phys/module_sf_oml.F.html#MODULE_SF_OML'>module_sf_oml</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_OML_1"><a name='2191'>
   USE <A href='../../html_code/phys/module_bl_myjpbl.F.html#MODULE_BL_MYJPBL'>module_bl_myjpbl</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_MYJPBL_2"><a name='2192'>
   USE <A href='../../html_code/phys/module_bl_myjurb.F.html#MODULE_BL_MYJURB'>module_bl_myjurb</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_MYJURB_2"><a name='2193'>
   USE <A href='../../html_code/phys/module_bl_boulac.F.html#MODULE_BL_BOULAC'>module_bl_boulac</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_BOULAC_2"><a name='2194'>
   USE <A href='../../html_code/phys/module_bl_camuwpbl_driver.F.html#MODULE_BL_CAMUWPBL_DRIVER'>module_bl_camuwpbl_driver</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_CAMUWPBL_DRIVER_2">, ONLY :  camuwpblinit<a name='2195'>
   USE <A href='../../html_code/phys/module_bl_qnsepbl.F.html#MODULE_BL_QNSEPBL'>module_bl_qnsepbl</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_QNSEPBL_2"><a name='2196'>
   USE <A href='../../html_code/phys/module_sf_lake.F.html#MODULE_SF_LAKE'>module_sf_lake</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_LAKE_2"><a name='2197'>
   USE <A href='../../html_code/phys/module_bl_mfshconvpbl.F.html#MODULE_BL_MFSHCONVPBL'>module_bl_mfshconvpbl</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_MFSHCONVPBL_2"><a name='2198'>
   USE <A href='../../html_code/phys/module_bl_gbmpbl.F.html#MODULE_BL_GBMPBL'>module_bl_gbmpbl</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_GBMPBL_2"><a name='2199'>
#if ( EM_CORE == 1 )<a name='2200'>
   USE <A href='../../html_code/phys/module_bl_mynn.F.html#MODULE_BL_MYNN'>module_bl_mynn</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_MYNN_3"><a name='2201'>
   USE <A href='../../html_code/phys/module_bl_temf.F.html#MODULE_BL_TEMF'>module_bl_temf</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BL_TEMF_2"><a name='2202'>
   USE <A href='../../html_code/phys/module_sf_temfsfclay.F.html#MODULE_SF_TEMFSFCLAY'>module_sf_temfsfclay</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_TEMFSFCLAY_1"><a name='2203'>
   USE <A href='../../html_code/phys/module_sf_mynn.F.html#MODULE_SF_MYNN'>module_sf_mynn</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_MYNN_1"><a name='2204'>
#endif<a name='2205'>
<a name='2206'>
#if (NMM_CORE == 1)<a name='2207'>
   USE <A href='../../html_code/phys/module_sf_gfdl.F.html#MODULE_SF_GFDL'>module_sf_gfdl</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SF_GFDL_1"><a name='2208'>
#endif<a name='2209'>
<font color=#447700>!--------------------------------------------------------------------<a name='2210'></font>
   IMPLICIT NONE<a name='2211'>
<font color=#447700>!--------------------------------------------------------------------<a name='2212'></font>
   TYPE (grid_config_rec_type) ::     config_flags<a name='2213'>
   LOGICAL , INTENT(IN)        :: restart<a name='2214'>
   LOGICAL, INTENT(IN)         ::   FNDSOILW, FNDSNOWH<a name='2215'>
   LOGICAL, INTENT(IN)         ::   RDMAXALB<a name='2216'>
   LOGICAL, INTENT(IN)         :: is_CAMMGMP_used <font color=#447700>!BSINGH:02/01/2013: For CAMUWPBL scheme<a name='2217'></font>
<a name='2218'>
   INTEGER , INTENT(IN)        ::     ids, ide, jds, jde, kds, kde, &amp;<a name='2219'>
                                      ims, ime, jms, jme, kms, kme, &amp;<a name='2220'>
                                      its, ite, jts, jte, kts, kte<a name='2221'>
   INTEGER , INTENT(IN)        ::     num_soil_layers<a name='2222'>
   INTEGER , INTENT(IN)        ::     SF_URBAN_PHYSICS <a name='2223'>
   INTEGER , INTENT(IN)        ::     IOPT_RUN<a name='2224'>
<a name='2225'>
<font color=#447700>!   INTEGER , INTENT(IN)        ::     LakeModel<a name='2226'></font>
   INTEGER         ::     LakeModel<a name='2227'>
   real, intent(in)            ::      lakedepth_default,lake_min_elev<a name='2228'>
   REAL ,    INTENT(IN)        ::     DT, BLDT<a name='2229'>
   REAL ,    INTENT(IN)        ::     DX, DY<a name='2230'>
#if (EM_CORE == 1)<a name='2231'>
   REAL,    DIMENSION( ims:ime, jms:jme ) ,  INTENT(IN) :: MSFTX,MSFTY<a name='2232'>
#endif<a name='2233'>
   INTEGER , INTENT(INOUT)     ::     STEPBL<a name='2234'>
<a name='2235'>
   REAL,     DIMENSION( ims:ime , 1:num_soil_layers , jms:jme ),    &amp;<a name='2236'>
             INTENT(OUT) :: SMFR3D<a name='2237'>
<a name='2238'>
   REAL,     DIMENSION( ims:ime , 1:num_soil_layers , jms:jme ),&amp;<a name='2239'>
                   INTENT(INOUT) :: SMOIS,SH2O,TSLB<a name='2240'>
<a name='2241'>
   REAL,    DIMENSION( ims:ime, jms:jme )                     , &amp;<a name='2242'>
            INTENT(INOUT)    ::                           SNOW, &amp;<a name='2243'>
                                                         SNOWH, &amp;<a name='2244'>
                                                         SNOWC, &amp;<a name='2245'>
                                                        SNOALB, &amp;<a name='2246'>
                                                        CANWAT, &amp;<a name='2247'>
                                                        MAVAIL, &amp;<a name='2248'>
                                                        SMSTAV, &amp;<a name='2249'>
                                                        SMSTOT, &amp;<a name='2250'>
                                                     SFCRUNOFF, &amp;<a name='2251'>
                                                      UDRUNOFF, &amp;<a name='2252'>
                                                        ACSNOW, &amp;<a name='2253'>
                                                        VEGFRA, &amp;<a name='2254'>
                                                        ACSNOM, &amp;<a name='2255'>
                                                        SFCEVP, &amp;<a name='2256'>
                                                        GRDFLX, &amp;<a name='2257'>
                                                           UST, &amp;<a name='2258'>
#if ( NMM_CORE == 1 )<a name='2259'>
                                                            Z0, &amp;<a name='2260'>
#else<a name='2261'>
                                                           ZNT, &amp;<a name='2262'>
#endif<a name='2263'>
                                                         XLAND, &amp;<a name='2264'>
                                                         XICE<a name='2265'>
<a name='2266'>
   INTEGER, DIMENSION( ims:ime, jms:jme )                     , &amp;<a name='2267'>
            INTENT(INOUT)    ::                         IVGTYP, &amp;<a name='2268'>
                                                        ISLTYP, &amp;<a name='2269'>
                                                        LOWLYR<a name='2270'>
<a name='2271'>
<a name='2272'>
   REAL,     DIMENSION(1:num_soil_layers), INTENT(INOUT)  ::  ZS,DZS<a name='2273'>
<a name='2274'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) ::       &amp;<font color=#447700>!BSINGH(PNNL)- should be declared inout<a name='2275'></font>
                                                           RUBLTEN, &amp;<a name='2276'>
                                                           RVBLTEN, &amp;<a name='2277'>
                                                          EXCH_H,   &amp;<a name='2278'>
                                                          RTHBLTEN, &amp;<a name='2279'>
                                                          RQVBLTEN, &amp;<a name='2280'>
                                                          RQCBLTEN, &amp;<a name='2281'>
                                                          RQIBLTEN, &amp;<a name='2282'>
                                                          TKE_PBL<a name='2283'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT), OPTIONAL :: QKE<a name='2284'>
<a name='2285'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(OUT), OPTIONAL :: &amp;<a name='2286'>
                              massflux_EDKF, entr_EDKF, detr_EDKF &amp; <a name='2287'>
                                     ,thl_up, thv_up, rt_up       &amp;<a name='2288'>
                                     ,rv_up, rc_up, u_up, v_up    &amp;<a name='2289'>
                                     ,frac_up<a name='2290'>
<a name='2291'>
   INTEGER, INTENT(IN)           ::  mfshconv <font color=#447700>! WRF JP<a name='2292'></font>
<a name='2293'>
   REAL,  DIMENSION( ims:ime , jms:jme ) , INTENT(IN) ::     TSK<a name='2294'>
   REAL,  DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT) ::  TMN<a name='2295'>
   CHARACTER(LEN=*), INTENT(IN)   :: MMINLU<a name='2296'>
   LOGICAL,  INTENT(IN)           :: allowed_to_read<a name='2297'>
   INTEGER,  INTENT(IN)           :: ISURBAN<a name='2298'>
   INTEGER :: isn, isfc<a name='2299'>
   INTEGER :: k<a name='2300'>
<a name='2301'>
   REAL, OPTIONAL, DIMENSION( ims:ime , kms:kme , jms:jme ) , &amp;<a name='2302'>
            INTENT(OUT) :: te_temf, cf3d_temf <font color=#447700>!WA <a name='2303'></font>
   REAL, OPTIONAL, DIMENSION( ims:ime , jms:jme ) , &amp;<a name='2304'>
            INTENT(OUT) :: wm_temf<a name='2305'>
<a name='2306'>
<font color=#447700>!Noah-MP<a name='2307'></font>
<a name='2308'>
   INTEGER, OPTIONAL, DIMENSION(ims:ime,jms:jme) :: ISNOWXY<a name='2309'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,-2:num_soil_layers, jms:jme) :: ZSNSOXY<a name='2310'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,-2:0, jms:jme) :: TSNOXY<a name='2311'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,-2:0, jms:jme) :: SNICEXY<a name='2312'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,-2:0, jms:jme) :: SNLIQXY<a name='2313'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: TVXY<a name='2314'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: TGXY<a name='2315'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: CANICEXY<a name='2316'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: CANLIQXY<a name='2317'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: EAHXY<a name='2318'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: TAHXY<a name='2319'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: CMXY<a name='2320'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: CHXY<a name='2321'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: FWETXY<a name='2322'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: SNEQVOXY<a name='2323'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: ALBOLDXY<a name='2324'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: QSNOWXY<a name='2325'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: WSLAKEXY<a name='2326'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: ZWTXY<a name='2327'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: WAXY<a name='2328'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: WTXY<a name='2329'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: LFMASSXY<a name='2330'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: RTMASSXY<a name='2331'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: STMASSXY<a name='2332'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: WOODXY<a name='2333'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: GRAINXY<a name='2334'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: GDDXY<a name='2335'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: STBLCPXY<a name='2336'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: FASTCPXY<a name='2337'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: XSAIXY<a name='2338'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: LAI<a name='2339'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: T2MVXY<a name='2340'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: T2MBXY<a name='2341'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: CHSTARXY<a name='2342'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,1:num_soil_layers,jms:jme) :: SMOISEQ<a name='2343'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: SMCWTDXY<a name='2344'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: DEEPRECHXY<a name='2345'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: RECHXY<a name='2346'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: QRFSXY  <a name='2347'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: QSPRINGSXY<a name='2348'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: QSLATXY<a name='2349'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: AREAXY<a name='2350'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme), INTENT(IN) :: FDEPTHXY<a name='2351'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: RIVERBEDXY<a name='2352'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: EQZWT<a name='2353'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: RIVERCONDXY<a name='2354'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme) :: PEXPXY<a name='2355'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,jms:jme), INTENT(IN) :: rechclim<a name='2356'>
   INTEGER, OPTIONAL, DIMENSION(ims:ime,  jms:jme), INTENT(OUT) :: CROPCAT<a name='2357'>
   REAL,    OPTIONAL, DIMENSION(ims:ime,5,jms:jme), INTENT(IN ) :: CROPTYPE<a name='2358'>
   INTEGER, OPTIONAL, INTENT(IN)  ::  ISICE<a name='2359'>
   INTEGER , OPTIONAL,  INTENT(OUT) :: STEPWTD<a name='2360'>
   REAL , OPTIONAL, INTENT(IN) :: WTDDT<a name='2361'>
<a name='2362'>
<font color=#447700>!URBAN<a name='2363'></font>
<font color=#447700>!   REAL, DIMENSION(1:num_roof_layers), INTENT(INOUT) :: DZR  !Optional urban<a name='2364'></font>
<font color=#447700>!   REAL, DIMENSION(1:num_wall_layers), INTENT(INOUT) :: DZB  !Optional urban<a name='2365'></font>
<font color=#447700>!   REAL, DIMENSION(1:num_road_layers), INTENT(INOUT) :: DZG  !Optional urban<a name='2366'></font>
    REAL, OPTIONAL, DIMENSION(1:num_soil_layers), INTENT(INOUT) :: DZR  <font color=#447700>!Optional urban<a name='2367'></font>
    REAL, OPTIONAL, DIMENSION(1:num_soil_layers), INTENT(INOUT) :: DZB  <font color=#447700>!Optional urban<a name='2368'></font>
    REAL, OPTIONAL, DIMENSION(1:num_soil_layers), INTENT(INOUT) :: DZG  <font color=#447700>!Optional urban<a name='2369'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: TR_URB2D <font color=#447700>!Optional urban<a name='2370'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: TB_URB2D <font color=#447700>!Optional urban<a name='2371'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: TG_URB2D <font color=#447700>!Optional urban<a name='2372'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: TC_URB2D <font color=#447700>!Optional urban<a name='2373'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: QC_URB2D <font color=#447700>!Optional urban<a name='2374'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: XXXR_URB2D <font color=#447700>!Optional urban<a name='2375'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: XXXB_URB2D <font color=#447700>!Optional urban<a name='2376'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: XXXG_URB2D <font color=#447700>!Optional urban<a name='2377'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: XXXC_URB2D <font color=#447700>!Optional urban<a name='2378'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: DRELR_URB2D <font color=#447700>!Optional urban<a name='2379'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: DRELB_URB2D <font color=#447700>!Optional urban<a name='2380'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: DRELG_URB2D <font color=#447700>!Optional urban<a name='2381'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: FLXHUMR_URB2D <font color=#447700>!Optional urban<a name='2382'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: FLXHUMB_URB2D <font color=#447700>!Optional urban<a name='2383'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: FLXHUMG_URB2D <font color=#447700>!Optional urban<a name='2384'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: CMCR_URB2D    <font color=#447700>!Optional urban<a name='2385'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: TGR_URB2D     <font color=#447700>!Optional urban<a name='2386'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: SH_URB2D <font color=#447700>!Optional urban<a name='2387'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: LH_URB2D <font color=#447700>!Optional urban<a name='2388'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: G_URB2D <font color=#447700>!Optional urban<a name='2389'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: RN_URB2D <font color=#447700>!Optional urban<a name='2390'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: TS_URB2D <font color=#447700>!Optional urban<a name='2391'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: FRC_URB2D <font color=#447700>!Optional urban<a name='2392'></font>
    INTEGER, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: UTYPE_URB2D <font color=#447700>!Optional urban<a name='2393'></font>
<font color=#447700>!    REAL, DIMENSION( ims:ime, 1:num_roof_layers, jms:jme ), INTENT(INOUT) :: TRL_URB3D !Optional urban<a name='2394'></font>
<font color=#447700>!    REAL, DIMENSION( ims:ime, 1:num_wall_layers, jms:jme ), INTENT(INOUT) :: TBL_URB3D !Optional urban<a name='2395'></font>
<font color=#447700>!    REAL, DIMENSION( ims:ime, 1:num_road_layers, jms:jme ), INTENT(INOUT) :: TGL_URB3D !Optional urban<a name='2396'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_soil_layers, jms:jme ), INTENT(INOUT) :: TRL_URB3D <font color=#447700>!Optional urban<a name='2397'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_soil_layers, jms:jme ), INTENT(INOUT) :: TBL_URB3D <font color=#447700>!Optional urban<a name='2398'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_soil_layers, jms:jme ), INTENT(INOUT) :: TGL_URB3D <font color=#447700>!Optional urban<a name='2399'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_soil_layers, jms:jme ), INTENT(INOUT) :: TGRL_URB3D <font color=#447700>!Optional urban<a name='2400'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_soil_layers, jms:jme ), INTENT(INOUT) :: SMR_URB3D <font color=#447700>!Optional urban<a name='2401'></font>
<a name='2402'>
    INTEGER , INTENT(IN)        ::     num_urban_layers<a name='2403'>
    INTEGER , INTENT(IN)        ::     num_urban_hi<a name='2404'>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TRB_URB4D <font color=#447700>!Optional UCM<a name='2405'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TW1_URB4D <font color=#447700>!Optional UCM<a name='2406'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TW2_URB4D <font color=#447700>!Optional UCM<a name='2407'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TGB_URB4D <font color=#447700>!Optional UCM<a name='2408'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TLEV_URB3D <font color=#447700>!Optional UCM<a name='2409'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: QLEV_URB3D <font color=#447700>!Optional UCM<a name='2410'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TW1LEV_URB3D <font color=#447700>! multi-layer UCM<a name='2411'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TW2LEV_URB3D <font color=#447700>! multi-layer UCM<a name='2412'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TGLEV_URB3D <font color=#447700>! multi-layer UCM<a name='2413'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: TFLEV_URB3D <font color=#447700>! multi-layer UCM<a name='2414'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: LF_AC_URB3D  <font color=#447700>!multi-layer UCM<a name='2415'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: SF_AC_URB3D  <font color=#447700>!multi-layer UCM<a name='2416'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: CM_AC_URB3D  <font color=#447700>!multi-layer UCM<a name='2417'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: SFVENT_URB3D <font color=#447700>!multi-layer UCM<a name='2418'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: LFVENT_URB3D <font color=#447700>!multi-layer UCM<a name='2419'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: SFWIN1_URB3D <font color=#447700>! multi-layer UCM<a name='2420'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: SFWIN2_URB3D <font color=#447700>! multi-layer UCM<a name='2421'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: SFW1_URB3D <font color=#447700>!Optional UCM<a name='2422'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: SFW2_URB3D <font color=#447700>!Optional UCM<a name='2423'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: SFR_URB3D <font color=#447700>!Optional UCM<a name='2424'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_urban_layers, jms:jme ), INTENT(INOUT) :: SFG_URB3D <font color=#447700>!Optional UCM<a name='2425'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime,1:num_urban_hi, jms:jme ), INTENT(INOUT) :: HI_URB2D  <font color=#447700>!multi-layer UCM<a name='2426'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: LP_URB2D  <font color=#447700>!multi-layer UCM<a name='2427'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: LB_URB2D  <font color=#447700>!multi-layer UCM<a name='2428'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: HGT_URB2D <font color=#447700>!multi-layer UCM<a name='2429'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: MH_URB2D <font color=#447700>!SLUCM<a name='2430'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, jms:jme ), INTENT(INOUT) :: STDH_URB2D <font color=#447700>!SLUCM<a name='2431'></font>
    REAL, OPTIONAL, DIMENSION( ims:ime, 4, jms:jme ), INTENT(INOUT) :: LF_URB2D <font color=#447700>!SLUCM<a name='2432'></font>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: A_U_BEP <a name='2433'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: A_V_BEP <a name='2434'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: A_T_BEP <a name='2435'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: A_Q_BEP <a name='2436'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: A_E_BEP <a name='2437'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: B_U_BEP <a name='2438'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: B_V_BEP <a name='2439'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: B_T_BEP <a name='2440'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: B_Q_BEP <a name='2441'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: B_E_BEP <a name='2442'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: VL_BEP<a name='2443'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: DLG_BEP <a name='2444'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme,jms:jme),INTENT(INOUT) :: SF_BEP<a name='2445'>
   REAL, OPTIONAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(INOUT) :: DL_U_BEP<a name='2446'>
<font color=#447700>! lake varibles:<a name='2447'></font>
  real,    dimension(ims:ime,jms:jme ),intent(out)                        :: lakedepth2d,    &amp;<a name='2448'>
                                                                             savedtke12d<a name='2449'>
  real,    dimension(ims:ime,jms:jme ),intent(inout)                      :: snowdp2d,       &amp;<a name='2450'>
                                                                             h2osno2d,       &amp;<a name='2451'>
                                                                             snl2d,          &amp;<a name='2452'>
                                                                             t_grnd2d<a name='2453'>
 <a name='2454'>
  real,    dimension( ims:ime,1:nlevlake, jms:jme ),INTENT(out)            :: t_lake3d,       &amp;<a name='2455'>
                                                                             lake_icefrac3d, &amp;<a name='2456'>
                                                                             z_lake3d,       &amp;<a name='2457'>
                                                                             dz_lake3d<a name='2458'>
  real,    dimension( ims:ime,-nlevsnow+1:nlevsoil, jms:jme ),INTENT(inout) :: t_soisno3d,     &amp;<a name='2459'>
                                                                             h2osoi_ice3d,   &amp;<a name='2460'>
                                                                             h2osoi_liq3d,   &amp;<a name='2461'>
                                                                             h2osoi_vol3d,   &amp;<a name='2462'>
                                                                             z3d,            &amp;<a name='2463'>
                                                                             dz3d<a name='2464'>
  real,    dimension( ims:ime,1:nlevsoil, jms:jme ),INTENT(out)            :: watsat3d,       &amp;<a name='2465'>
                                                                             csol3d,         &amp;<a name='2466'>
                                                                             tkmg3d,         &amp;<a name='2467'>
                                                                             tkdry3d,        &amp;<a name='2468'>
                                                                             tksatu3d<a name='2469'>
  real,    dimension( ims:ime,-nlevsnow+0:nlevsoil, jms:jme ),INTENT(inout) :: zi3d<a name='2470'>
 <a name='2471'>
  logical,    dimension(ims:ime,jms:jme ),intent(out)                        :: lake2d<a name='2472'>
  REAL, OPTIONAL,    DIMENSION( ims:ime, jms:jme ), INTENT(IN)    ::  lake_depth<a name='2473'>
#if ( EM_CORE == 1 )<a name='2474'>
  REAL,              dimension(ims:ime,jms:jme ),intent(inout)      ::  lakemask<a name='2475'>
  INTEGER, INTENT(IN)      ::  lakeflag<a name='2476'>
#endif<a name='2477'>
  INTEGER, INTENT(IN)      ::   use_lakedepth<a name='2478'>
  INTEGER, INTENT(INOUT)      ::   lake_depth_flag<a name='2479'>
<font color=#447700>!  REAL,    DIMENSION( ims:ime, jms:jme ), INTENT(IN)                         ::  HT<a name='2480'></font>
<a name='2481'>
   REAL,  DIMENSION( ims:ime , jms:jme ) , OPTIONAL, INTENT(INOUT) ::    &amp;<a name='2482'>
                                        ACHFX,ACLHF,ACGRDFLX<a name='2483'>
<font color=#447700>! Optional OML variables<a name='2484'></font>
   REAL,  DIMENSION( ims:ime , jms:jme ) , OPTIONAL, INTENT(INOUT) ::    &amp;<a name='2485'>
                                        TML,T0ML,HML,H0ML,HUML,HVML,TMOML<a name='2486'>
   INTEGER,  OPTIONAL,  INTENT(IN) :: sf_ocean_physics<a name='2487'>
   REAL,  OPTIONAL,  INTENT(IN) :: oml_hml0<a name='2488'>
   REAL,  DIMENSION( ims:ime , jms:jme ) , OPTIONAL, INTENT(INOUT) ::    &amp;<a name='2489'>
                                        TSK_SAVE<a name='2490'>
   LOGICAL,  INTENT(IN) :: start_of_simulation<a name='2491'>
   INTEGER :: i,j<a name='2492'>
<a name='2493'>
<font color=#447700>! CLM varaibles<a name='2494'></font>
   INTEGER , INTENT(IN)        ::     maxpatch<a name='2495'>
   REAL, OPTIONAL,    DIMENSION( ims:ime, jms:jme ), INTENT(IN)    ::  HT<a name='2496'>
  integer, OPTIONAL,   dimension(ims:ime,jms:jme ),intent(inout) :: numc,nump<a name='2497'>
  integer, OPTIONAL,   dimension(ims:ime,1:maxpatch,jms:jme ),intent(inout) :: snl<a name='2498'>
  real, OPTIONAL,  dimension(ims:ime,1:maxpatch,jms:jme ),intent(inout) ::  &amp;<a name='2499'>
                snowdp,wtc,wtp,h2osno,t_grnd,t_veg,         &amp;<a name='2500'>
                h2ocan,h2ocan_col,t2m_max,t2m_min,t_ref2m,          &amp;<a name='2501'>
                h2osoi_liq_s1,              &amp;<a name='2502'>
                h2osoi_liq_s2,h2osoi_liq_s3,h2osoi_liq_s4,          &amp;<a name='2503'>
                h2osoi_liq_s5,h2osoi_liq1,h2osoi_liq2,              &amp;<a name='2504'>
                h2osoi_liq3,h2osoi_liq4,h2osoi_liq5,h2osoi_liq6,    &amp;<a name='2505'>
                h2osoi_liq7,h2osoi_liq8,h2osoi_liq9,h2osoi_liq10,   &amp;<a name='2506'>
                h2osoi_ice_s1,h2osoi_ice_s2,                        &amp;<a name='2507'>
                h2osoi_ice_s3,h2osoi_ice_s4,h2osoi_ice_s5,          &amp;<a name='2508'>
                h2osoi_ice1,h2osoi_ice2,h2osoi_ice3,h2osoi_ice4,    &amp;<a name='2509'>
                h2osoi_ice5,h2osoi_ice6,h2osoi_ice7,                &amp;<a name='2510'>
                h2osoi_ice8,h2osoi_ice9,h2osoi_ice10,               &amp;<a name='2511'>
                t_soisno_s1,t_soisno_s2,t_soisno_s3,t_soisno_s4,    &amp;<a name='2512'>
                t_soisno_s5,t_soisno1,t_soisno2,t_soisno3,          &amp;<a name='2513'>
                t_soisno4,t_soisno5,t_soisno6,t_soisno7,            &amp;<a name='2514'>
                t_soisno8,t_soisno9,t_soisno10,                     &amp;<a name='2515'>
                dzsnow1,dzsnow2,dzsnow3,dzsnow4,dzsnow5,            &amp;<a name='2516'>
                snowrds1,snowrds2,snowrds3,snowrds4,snowrds5,       &amp;<a name='2517'>
                t_lake1,t_lake2,t_lake3,t_lake4,t_lake5,            &amp;<a name='2518'>
                t_lake6,t_lake7,t_lake8,t_lake9,t_lake10,           &amp;<a name='2519'>
                h2osoi_vol1,h2osoi_vol2,h2osoi_vol3,                &amp;<a name='2520'>
                h2osoi_vol4,h2osoi_vol5,h2osoi_vol6,                &amp;<a name='2521'>
                h2osoi_vol7,h2osoi_vol8,                            &amp;<a name='2522'>
                h2osoi_vol9,h2osoi_vol10,                           &amp;<a name='2523'>
                ALBEDOsubgrid,LHsubgrid,HFXsubgrid,LWUPsubgrid,     &amp;<a name='2524'>
                Q2subgrid,SABVsubgrid,SABGsubgrid,NRAsubgrid,       &amp;<a name='2525'>
                SWUPsubgrid,lhsoi,lhtran,lhveg<a name='2526'>
<a name='2527'>
<font color=#447700>!-------------------------------------------------<a name='2528'></font>
<font color=#447700>! Noah-mosaic related variables are added to declaration  (danli)<a name='2529'></font>
<font color=#447700>!-------------------------------------------------<a name='2530'></font>
  <a name='2531'>
  INTEGER, INTENT(IN) :: sf_surface_mosaic, NLCAT   <a name='2532'>
  INTEGER, INTENT(IN) :: mosaic_cat<a name='2533'>
  REAL, DIMENSION( ims:ime, NLCAT, jms:jme ) , INTENT(IN)::   LANDUSEF<a name='2534'>
  REAL, DIMENSION( ims:ime, NLCAT, jms:jme ) , INTENT(INOUT)::   LANDUSEF2<a name='2535'>
  INTEGER, DIMENSION( ims:ime, NLCAT, jms:jme ), INTENT(INOUT) :: mosaic_cat_index <a name='2536'>
<a name='2537'>
  REAL, DIMENSION( ims:ime, 1:mosaic_cat, jms:jme ) , OPTIONAL, INTENT(INOUT)::   TSK_mosaic, CANWAT_mosaic, SNOW_mosaic,SNOWH_mosaic, SNOWC_mosaic <a name='2538'>
  REAL, DIMENSION( ims:ime, jms:jme ) , INTENT(INOUT)::   ALBEDO,ALBBCK, EMISS, EMBCK <a name='2539'>
<a name='2540'>
  REAL, DIMENSION( ims:ime, 1:mosaic_cat, jms:jme ) , OPTIONAL, INTENT(INOUT)::   ALBEDO_mosaic,ALBBCK_mosaic, EMISS_mosaic, EMBCK_mosaic, ZNT_mosaic, Z0_mosaic<a name='2541'>
  <a name='2542'>
  REAL, DIMENSION( ims:ime, 1:num_soil_layers*mosaic_cat, jms:jme ), OPTIONAL, INTENT(INOUT)::   TSLB_mosaic,SMOIS_mosaic,SH2O_mosaic<a name='2543'>
  <a name='2544'>
  REAL, DIMENSION( ims:ime, 1:mosaic_cat, jms:jme ) , OPTIONAL, INTENT(INOUT)::   TR_URB2D_mosaic, TB_URB2D_mosaic, TG_URB2D_mosaic, TC_URB2D_mosaic,QC_URB2D_mosaic,  &amp;<a name='2545'>
                                                                                     SH_URB2D_mosaic,LH_URB2D_mosaic,G_URB2D_mosaic,RN_URB2D_mosaic,TS_URB2D_mosaic, TS_RUL2D_mosaic  <a name='2546'>
                    <a name='2547'>
  REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_soil_layers*mosaic_cat, jms:jme ), INTENT(INOUT) :: TRL_URB3D_mosaic<a name='2548'>
  REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_soil_layers*mosaic_cat, jms:jme ), INTENT(INOUT) :: TBL_URB3D_mosaic<a name='2549'>
  REAL, OPTIONAL, DIMENSION( ims:ime, 1:num_soil_layers*mosaic_cat, jms:jme ), INTENT(INOUT) :: TGL_URB3D_mosaic  <a name='2550'>
   <a name='2551'>
  REAL :: xice_threshold   <font color=#447700>! lake input<a name='2552'></font>
   <a name='2553'>
  LOGICAL :: IPRINT<a name='2554'>
  <a name='2555'>
<font color=#447700>!-------------------------------------------------<a name='2556'></font>
<font color=#447700>! End of Noah-mosaic related variables <a name='2557'></font>
<font color=#447700>!-------------------------------------------------  <a name='2558'></font>
<a name='2559'>
#if ( EM_CORE == 1 )<a name='2560'>
<font color=#447700>!local mynn <a name='2561'></font>
   INTEGER :: mynn_closure_level<a name='2562'>
#endif<a name='2563'>
<a name='2564'>
  if ( config_flags%fractional_seaice == 0 ) then<a name='2565'>
     xice_threshold = 0.5<a name='2566'>
  else if ( config_flags%fractional_seaice == 1 ) then<a name='2567'>
     xice_threshold = 0.02<a name='2568'>
  endif<a name='2569'>
 <a name='2570'>
<font color=#447700>!-- calculate pbl time step<a name='2571'></font>
<a name='2572'>
   STEPBL = nint(BLDT*60./DT)<a name='2573'>
   STEPBL = max(STEPBL,1)<a name='2574'>
<font color=#447700>!-- initialization<a name='2575'></font>
<a name='2576'>
   IF(PRESENT(ACHFX))THEN<a name='2577'>
   IF(.not.restart)THEN<a name='2578'>
     DO j=jts,jte<a name='2579'>
     DO i=its,ite<a name='2580'>
        ACHFX(i,j)=0.<a name='2581'>
        ACLHF(i,j)=0.<a name='2582'>
        ACGRDFLX(i,j)=0.<a name='2583'>
        SFCEVP(i,j)=0.<a name='2584'>
     ENDDO<a name='2585'>
     ENDDO<a name='2586'>
   ENDIF<a name='2587'>
   ENDIF<a name='2588'>
<a name='2589'>
   IF(PRESENT(TSK_SAVE))THEN<a name='2590'>
   IF(.NOT.restart .AND. config_flags%fractional_seaice.EQ.1)THEN<a name='2591'>
     DO j=jts,jte<a name='2592'>
     DO i=its,ite<a name='2593'>
        TSK_SAVE(i,j)=TSK(i,j)<a name='2594'>
     ENDDO<a name='2595'>
     ENDDO<a name='2596'>
   ENDIF<a name='2597'>
   ENDIF<a name='2598'>
<a name='2599'>
<font color=#447700>!-- initialize surface layer scheme<a name='2600'></font>
<a name='2601'>
   sfclay_select: SELECT CASE(config_flags%sf_sfclay_physics)<a name='2602'>
<a name='2603'>
      CASE (SFCLAYSCHEME)<a name='2604'>
           CALL <A href='../../html_code/phys/module_sf_sfclay.F.html#SFCLAYINIT'>sfclayinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SFCLAYINIT_1">( allowed_to_read )<a name='2605'>
           isfc = 1<a name='2606'>
      CASE (SFCLAYREVSCHEME)<a name='2607'>
            CALL <A href='../../html_code/phys/module_sf_sfclayrev.F.html#SFCLAYREVINIT'>sfclayrevinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SFCLAYREVINIT_1"><a name='2608'>
           isfc = 1<a name='2609'>
      CASE (PXSFCSCHEME)<a name='2610'>
           CALL <A href='../../html_code/phys/module_sf_pxsfclay.F.html#PXSFCLAYINIT'>pxsfclayinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PXSFCLAYINIT_1">( allowed_to_read )<a name='2611'>
           isfc = 7<a name='2612'>
      CASE (MYJSFCSCHEME)<a name='2613'>
           CALL <A href='../../html_code/phys/module_sf_myjsfc.F.html#MYJSFCINIT'>myjsfcinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MYJSFCINIT_1">(LOWLYR,UST,                         &amp;<a name='2614'>
#if ( NMM_CORE == 1 )<a name='2615'>
                                      Z0,                      &amp;<a name='2616'>
#else<a name='2617'>
                                      ZNT,                     &amp;<a name='2618'>
#endif<a name='2619'>
                                          XLAND,XICE,          &amp;<a name='2620'>
                         IVGTYP,restart,                       &amp;<a name='2621'>
                         allowed_to_read ,                     &amp;<a name='2622'>
                         ids, ide, jds, jde, kds, kde,         &amp;<a name='2623'>
                         ims, ime, jms, jme, kms, kme,         &amp;<a name='2624'>
                         its, ite, jts, jte, kts, kte          )<a name='2625'>
           isfc = 2<a name='2626'>
<a name='2627'>
      CASE (QNSESFCSCHEME)<a name='2628'>
           CALL <A href='../../html_code/phys/module_sf_qnsesfc.F.html#QNSESFCINIT'>qnsesfcinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="QNSESFCINIT_1">(LOWLYR,UST,                         &amp;<a name='2629'>
#if ( NMM_CORE == 1 )<a name='2630'>
                                      Z0,                      &amp;<a name='2631'>
#else<a name='2632'>
                                      ZNT,                     &amp;<a name='2633'>
#endif<a name='2634'>
                                          XLAND,XICE,          &amp;<a name='2635'>
                         IVGTYP,restart,                       &amp;<a name='2636'>
                         allowed_to_read ,                     &amp;<a name='2637'>
                         ids, ide, jds, jde, kds, kde,         &amp;<a name='2638'>
                         ims, ime, jms, jme, kms, kme,         &amp;<a name='2639'>
                         its, ite, jts, jte, kts, kte          )<a name='2640'>
           isfc = 4<a name='2641'>
<a name='2642'>
      CASE (GFSSFCSCHEME)<a name='2643'>
           CALL <A href='../../html_code/phys/module_sf_myjsfc.F.html#MYJSFCINIT'>myjsfcinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MYJSFCINIT_2">(LOWLYR,UST,                         &amp;<a name='2644'>
#if ( NMM_CORE == 1 )<a name='2645'>
                                      Z0,                      &amp;<a name='2646'>
#else<a name='2647'>
                                      ZNT,                     &amp;<a name='2648'>
#endif<a name='2649'>
                                          XLAND,XICE,          &amp;<a name='2650'>
                         IVGTYP,restart,                       &amp;<a name='2651'>
                         allowed_to_read ,                     &amp;<a name='2652'>
                         ids, ide, jds, jde, kds, kde,         &amp;<a name='2653'>
                         ims, ime, jms, jme, kms, kme,         &amp;<a name='2654'>
                         its, ite, jts, jte, kts, kte          )<a name='2655'>
           isfc = 2<a name='2656'>
#if (NMM_CORE==1)<a name='2657'>
      CASE (GFDLSFCSCHEME)<a name='2658'>
           CALL <A href='../../html_code/phys/module_sf_myjsfc.F.html#MYJSFCINIT'>myjsfcinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MYJSFCINIT_3">(LOWLYR,UST,                         &amp;<a name='2659'>
                                      Z0,                      &amp;<a name='2660'>
                                          XLAND,XICE,          &amp;<a name='2661'>
                         IVGTYP,restart,                       &amp;<a name='2662'>
                         allowed_to_read ,                     &amp;<a name='2663'>
                         ids, ide, jds, jde, kds, kde,         &amp;<a name='2664'>
                         ims, ime, jms, jme, kms, kme,         &amp;<a name='2665'>
                         its, ite, jts, jte, kts, kte          )<a name='2666'>
           isfc = 2<a name='2667'>
#endif<a name='2668'>
<a name='2669'>
#if ( EM_CORE == 1 )<a name='2670'>
<font color=#447700>!mynn <a name='2671'></font>
<a name='2672'>
        CASE (MYNNSFCSCHEME)<a name='2673'>
<a name='2674'>
           CALL <A href='../../html_code/phys/module_sf_mynn.F.html#MYNN_SF_INIT_DRIVER'>mynn_sf_init_driver</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MYNN_SF_INIT_DRIVER_1">(allowed_to_read)<a name='2675'>
           isfc=5<a name='2676'>
<font color=#447700>!          isfc=3<a name='2677'></font>
<a name='2678'>
      CASE (TEMFSFCSCHEME)<a name='2679'>
           CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_725">( 100, 'calling temfsfclayinit' )<a name='2680'>
           CALL <A href='../../html_code/phys/module_sf_temfsfclay.F.html#TEMFSFCLAYINIT'>temfsfclayinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TEMFSFCLAYINIT_1">( restart, allowed_to_read ,        &amp;<a name='2681'>
                             wm_temf,                          &amp;<a name='2682'>
                         ids, ide, jds, jde, kds, kde,         &amp;<a name='2683'>
                         ims, ime, jms, jme, kms, kme,         &amp;<a name='2684'>
                         its, ite, jts, jte, kts, kte          )<a name='2685'>
#endif<a name='2686'>
<a name='2687'>
      CASE DEFAULT<a name='2688'>
<a name='2689'>
   END SELECT sfclay_select<a name='2690'>
<a name='2691'>
<a name='2692'>
<font color=#447700>!-- initialize surface scheme<a name='2693'></font>
<a name='2694'>
   sfc_select: SELECT CASE(config_flags%sf_surface_physics)<a name='2695'>
<a name='2696'>
      CASE (SLABSCHEME)<a name='2697'>
<a name='2698'>
           CALL <A href='../../html_code/phys/module_sf_slab.F.html#SLABINIT'>slabinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SLABINIT_1">(TSK,TMN,                              &amp;<a name='2699'>
                         TSLB,ZS,DZS,num_soil_layers,          &amp;<a name='2700'>
                         allowed_to_read ,start_of_simulation ,&amp;<a name='2701'>
                         ids, ide, jds, jde, kds, kde,         &amp;<a name='2702'>
                         ims, ime, jms, jme, kms, kme,         &amp;<a name='2703'>
                         its, ite, jts, jte, kts, kte          )<a name='2704'>
<a name='2705'>
#if (NMM_CORE == 1)<a name='2706'>
     CASE (GFDLSLAB)<a name='2707'>
           CALL <A href='../../html_code/phys/module_sf_gfdl.F.html#HWRFSFCINIT'>hwrfsfcinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="HWRFSFCINIT_1">(isn,XICE,VEGFRA,SNOW,SNOWC, CANWAT,SMSTAV, &amp;<a name='2708'>
                     SMSTOT, SFCRUNOFF,UDRUNOFF,GRDFLX,ACSNOW,     &amp;<a name='2709'>
                     ACSNOM,IVGTYP,ISLTYP,TSLB,SMOIS,DZS,SFCEVP,   &amp;<a name='2710'>
                     TMN,                                          &amp;<a name='2711'>
                     num_soil_layers,                              &amp;<a name='2712'>
                     allowed_to_read ,                             &amp;<a name='2713'>
                     ids,ide, jds,jde, kds,kde,                    &amp;<a name='2714'>
                     ims,ime, jms,jme, kms,kme,                    &amp;<a name='2715'>
                     its,ite, jts,jte, kts,kte                     )<a name='2716'>
<a name='2717'>
#endif<a name='2718'>
      CASE (LSMSCHEME)<a name='2719'>
          <a name='2720'>
          IF(TRIM(mminlu) .EQ. 'NLCD40')THEN<a name='2721'>
            CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_843">('Using NLCD40 for Noah, redefine urban categories ')<a name='2722'>
            DO j=jts,jte<a name='2723'>
            DO i=its,ite<a name='2724'>
               IF(IVGTYP(i,j)==23) IVGTYP(i,j) = 24<a name='2725'>
               IF(IVGTYP(i,j)==25) IVGTYP(i,j) = 24<a name='2726'>
            ENDDO<a name='2727'>
            ENDDO<a name='2728'>
          ENDIF<a name='2729'>
 <a name='2730'>
          CALL <A href='../../html_code/phys/module_sf_noahdrv.F.html#LSMINIT'>LSMINIT</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LSMINIT_1">(VEGFRA,SNOW,SNOWC,SNOWH,CANWAT,SMSTAV,  &amp;<a name='2731'>
                     SMSTOT, SFCRUNOFF,UDRUNOFF,ACSNOW,        &amp;<a name='2732'>
                     ACSNOM,IVGTYP,ISLTYP,TSLB,SMOIS,SH2O,ZS,DZS, &amp;<a name='2733'>
                     MMINLU,                                   &amp;<a name='2734'>
                     SNOALB, FNDSOILW, FNDSNOWH, RDMAXALB,     &amp;<a name='2735'>
                     num_soil_layers, restart,                 &amp;<a name='2736'>
                     allowed_to_read ,                         &amp;<a name='2737'>
                     ids,ide, jds,jde, kds,kde,                &amp;<a name='2738'>
                     ims,ime, jms,jme, kms,kme,                &amp;<a name='2739'>
                     its,ite, jts,jte, kts,kte                 )<a name='2740'>
<a name='2741'>
<a name='2742'>
<font color=#447700>!URBAN<a name='2743'></font>
          IF ((SF_URBAN_PHYSICS.eq.1).OR.(SF_URBAN_PHYSICS.EQ.2).OR.(SF_URBAN_PHYSICS.EQ.3)) THEN<a name='2744'>
<a name='2745'>
             IF ( PRESENT( FRC_URB2D ) .AND. PRESENT( UTYPE_URB2D )) THEN<a name='2746'>
                <a name='2747'>
                CALL <A href='../../html_code/phys/module_sf_urban.F.html#URBAN_PARAM_INIT'>urban_param_init</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="URBAN_PARAM_INIT_1">(DZR,DZB,DZG,num_soil_layers,                   &amp; <font color=#447700>!urban<a name='2748'></font>
                                sf_urban_physics)<a name='2749'>
<font color=#447700>!                                num_roof_layers,num_wall_layers,road_soil_layers)   !urban<a name='2750'></font>
                               <a name='2751'>
                <a name='2752'>
                CALL <A href='../../html_code/phys/module_sf_urban.F.html#URBAN_VAR_INIT'>urban_var_init</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="URBAN_VAR_INIT_1">(ISURBAN,TSK,TSLB,TMN,IVGTYP,                     &amp; <font color=#447700>!urban<a name='2753'></font>
                              ims,ime,jms,jme,kms,kme,num_soil_layers,               &amp; <font color=#447700>!urban<a name='2754'></font>
<font color=#447700>!                              num_roof_layers,num_wall_layers,num_road_layers, &amp; !urban<a name='2755'></font>
                              LOW_DENSITY_RESIDENTIAL,                       &amp;<a name='2756'>
                              HIGH_DENSITY_RESIDENTIAL,                      &amp;<a name='2757'>
                              HIGH_INTENSITY_INDUSTRIAL,                       &amp;<a name='2758'>
                              restart,sf_urban_physics,                        &amp; <font color=#447700>!urban<a name='2759'></font>
                              XXXR_URB2D,XXXB_URB2D,XXXG_URB2D,XXXC_URB2D,     &amp; <font color=#447700>!urban<a name='2760'></font>
                              TR_URB2D,TB_URB2D,TG_URB2D,TC_URB2D,QC_URB2D,    &amp; <font color=#447700>!urban<a name='2761'></font>
                              TRL_URB3D,TBL_URB3D,TGL_URB3D,                   &amp; <font color=#447700>!urban<a name='2762'></font>
                              SH_URB2D,LH_URB2D,G_URB2D,RN_URB2D, TS_URB2D,    &amp; <font color=#447700>!urban<a name='2763'></font>
                              num_urban_layers,                                &amp; <font color=#447700>!urban<a name='2764'></font>
                              num_urban_hi,                                    &amp; <font color=#447700>!urban<a name='2765'></font>
                              TRB_URB4D,TW1_URB4D,TW2_URB4D,TGB_URB4D,         &amp; <font color=#447700>!urban<a name='2766'></font>
                              TLEV_URB3D,QLEV_URB3D,                           &amp; <font color=#447700>!urban<a name='2767'></font>
                              TW1LEV_URB3D,TW2LEV_URB3D,                       &amp; <font color=#447700>!urban<a name='2768'></font>
                              TGLEV_URB3D,TFLEV_URB3D,                         &amp; <font color=#447700>!urban<a name='2769'></font>
                              SF_AC_URB3D,LF_AC_URB3D,CM_AC_URB3D,             &amp; <font color=#447700>!urban<a name='2770'></font>
                              SFVENT_URB3D,LFVENT_URB3D,                       &amp; <font color=#447700>!urban<a name='2771'></font>
                              SFWIN1_URB3D,SFWIN2_URB3D,                       &amp; <font color=#447700>!urban<a name='2772'></font>
                              SFW1_URB3D,SFW2_URB3D,SFR_URB3D,SFG_URB3D,       &amp; <font color=#447700>!urban<a name='2773'></font>
                              LP_URB2D,HI_URB2D,LB_URB2D,                      &amp; <font color=#447700>!urban<a name='2774'></font>
                              HGT_URB2D,MH_URB2D,STDH_URB2D,                   &amp; <font color=#447700>!urban<a name='2775'></font>
                              LF_URB2D,                                        &amp; <font color=#447700>!urban<a name='2776'></font>
                              CMCR_URB2D,TGR_URB2D,TGRL_URB3D,SMR_URB3D,       &amp; <font color=#447700>!urban<a name='2777'></font>
                              DRELR_URB2D,DRELB_URB2D,DRELG_URB2D,             &amp; <font color=#447700>!urban<a name='2778'></font>
                              FLXHUMR_URB2D, FLXHUMB_URB2D, FLXHUMG_URB2D,     &amp; <font color=#447700>!urban<a name='2779'></font>
                              A_U_BEP,A_V_BEP,A_T_BEP,A_Q_BEP,                 &amp; <font color=#447700>!multi-layer urban<a name='2780'></font>
                              A_E_BEP,B_U_BEP,B_V_BEP,                         &amp; <font color=#447700>!multi-layer urban<a name='2781'></font>
                              B_T_BEP,B_Q_BEP,B_E_BEP,DLG_BEP,                 &amp; <font color=#447700>!multi-layer urban<a name='2782'></font>
                              DL_U_BEP,SF_BEP,VL_BEP,                          &amp; <font color=#447700>!multi-layer urban<a name='2783'></font>
                              FRC_URB2D, UTYPE_URB2D)                            <font color=#447700>!urban<a name='2784'></font>
             ELSE<a name='2785'>
                CALL wrf_error_fatal ( 'arguments not present for calling urban model' )<a name='2786'>
             ENDIF<a name='2787'>
          ENDIF<a name='2788'>
          <a name='2789'>
<font color=#447700>!danli mosaic<a name='2790'></font>
<a name='2791'>
          IF (SF_surface_mosaic.eq.1) THEN<a name='2792'>
<a name='2793'>
CALL <A href='../../html_code/phys/module_sf_noahdrv.F.html#LSM_MOSAIC_INIT'>lsm_mosaic_init</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LSM_MOSAIC_INIT_1">(IVGTYP,config_flags%ISWATER,config_flags%ISURBAN,config_flags%ISICE, XLAND, XICE,config_flags%fractional_seaice,TSK,TSLB,SMOIS,SH2O,SNOW,SNOWC,SNOWH,CANWAT,  &amp;                <a name='2794'>
                  ids,ide, jds,jde, kds,kde,  &amp;<a name='2795'>
                  ims,ime, jms,jme, kms,kme,  &amp;<a name='2796'>
                  its,ite, jts,jte, kts,kte, restart,             &amp;<a name='2797'>
                  landusef,landusef2,NLCAT,num_soil_layers                  &amp; <a name='2798'>
                  ,sf_surface_mosaic, mosaic_cat                    &amp; <a name='2799'>
                  , mosaic_cat_index                              &amp;   <a name='2800'>
                  ,TSK_mosaic,TSLB_mosaic                         &amp;<a name='2801'>
                  ,SMOIS_mosaic,SH2O_mosaic                       &amp; <a name='2802'>
                  ,CANWAT_mosaic,SNOW_mosaic                      &amp;<a name='2803'>
                  ,SNOWH_mosaic,SNOWC_mosaic                      &amp;<a name='2804'>
                  ,ALBEDO,ALBBCK, EMISS, EMBCK,                    &amp;         <font color=#447700>!danli  <a name='2805'></font>
#if ( NMM_CORE == 1 )<a name='2806'>
                                                            Z0, &amp;<a name='2807'>
#else<a name='2808'>
                                                           ZNT, &amp;<a name='2809'>
#endif  <a name='2810'>
                  ALBEDO_mosaic,ALBBCK_mosaic, EMISS_mosaic, EMBCK_mosaic, ZNT_mosaic, Z0_mosaic   &amp;         <font color=#447700>!danli<a name='2811'></font>
                 ,TR_URB2D_mosaic,TB_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic <a name='2812'></font>
                 ,TG_URB2D_mosaic,TC_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic <a name='2813'></font>
                 ,QC_URB2D_mosaic                                &amp;  <font color=#447700>!danli mosaic                  <a name='2814'></font>
                 ,TRL_URB3D_mosaic,TBL_URB3D_mosaic              &amp;  <font color=#447700>!danli mosaic <a name='2815'></font>
                 ,TGL_URB3D_mosaic                               &amp;  <font color=#447700>!danli mosaic <a name='2816'></font>
                 ,SH_URB2D_mosaic,LH_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic <a name='2817'></font>
                 ,G_URB2D_mosaic,RN_URB2D_mosaic                 &amp;  <font color=#447700>!danli mosaic <a name='2818'></font>
                 ,TS_URB2D_mosaic                                &amp;  <font color=#447700>!danli mosaic <a name='2819'></font>
                 ,TS_RUL2D_mosaic                                &amp;  <font color=#447700>!danli mosaic                        <a name='2820'></font>
                   )<a name='2821'>
<a name='2822'>
          ENDIF               <a name='2823'>
          <a name='2824'>
<font color=#447700>!<a name='2825'></font>
<a name='2826'>
      CASE (NOAHMPSCHEME)<a name='2827'>
          IF ( TRIM(mminlu) .EQ. 'NLCD40' ) THEN<a name='2828'>
             CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_914"> ( 'NoahMP does not work with NLCD data. Stop.' )<a name='2829'>
          ENDIF<a name='2830'>
<a name='2831'>
          CALL <A href='../../html_code/phys/module_sf_noahmpdrv.F.html#NOAHMP_INIT'>NOAHMP_INIT</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NOAHMP_INIT_1">(MMINLU, SNOW,SNOWH,CANWAT,ISLTYP,IVGTYP,                 &amp;<a name='2832'>
                     TSLB,SMOIS,SH2O,DZS, FNDSOILW, FNDSNOWH,          &amp;<a name='2833'>
                     TSK,isnowxy  ,tvxy     ,tgxy     ,canicexy ,TMN,XICE,                  &amp;<a name='2834'>
                     canliqxy ,eahxy    ,tahxy    ,cmxy     ,chxy     ,                     &amp;<a name='2835'>
                     fwetxy   ,sneqvoxy ,alboldxy ,qsnowxy  ,wslakexy ,zwtxy    ,waxy     , &amp;<a name='2836'>
                     wtxy     ,tsnoxy   ,zsnsoxy  ,snicexy  ,snliqxy  ,lfmassxy ,rtmassxy , &amp;<a name='2837'>
                     stmassxy ,woodxy   ,stblcpxy ,fastcpxy ,xsaixy   ,lai      ,           &amp;<a name='2838'>
                     grainxy  ,gddxy    ,                                                   &amp;<a name='2839'>
                     croptype ,cropcat  ,                      &amp;<a name='2840'>
                     t2mvxy   ,t2mbxy   ,chstarxy ,            &amp;<a name='2841'>
                     num_soil_layers, restart,                 &amp;<a name='2842'>
                     allowed_to_read, iopt_run ,               &amp;<a name='2843'>
                     sf_urban_physics,                         &amp;  <font color=#447700>! urban scheme<a name='2844'></font>
                     ids,ide, jds,jde, kds,kde,                &amp;<a name='2845'>
                     ims,ime, jms,jme, kms,kme,                &amp;<a name='2846'>
                     its,ite, jts,jte, kts,kte                 &amp;<a name='2847'>
#if (EM_CORE == 1)<a name='2848'>
                     ,smoiseq  ,smcwtdxy ,rechxy   ,deeprechxy, areaxy ,dx, dy, msftx, msfty,&amp;<a name='2849'>
                     wtddt    ,stepwtd  ,dt  ,qrfsxy ,qspringsxy  ,qslatxy,                  &amp;<a name='2850'>
                     fdepthxy ,ht       ,riverbedxy ,eqzwt ,rivercondxy ,pexpxy,              &amp;<a name='2851'>
                     rechclim                  &amp;<a name='2852'>
#endif<a name='2853'>
                     )<a name='2854'>
<a name='2855'>
          IF ((SF_URBAN_PHYSICS.eq.1).OR.(SF_URBAN_PHYSICS.EQ.2).OR.(SF_URBAN_PHYSICS.EQ.3)) THEN<a name='2856'>
             IF ( PRESENT( FRC_URB2D ) .AND. PRESENT( UTYPE_URB2D )) THEN<a name='2857'>
                CALL <A href='../../html_code/phys/module_sf_urban.F.html#URBAN_PARAM_INIT'>urban_param_init</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="URBAN_PARAM_INIT_2">(DZR,DZB,DZG,num_soil_layers,                   &amp; <font color=#447700>!urban<a name='2858'></font>
                                sf_urban_physics)<a name='2859'>
                CALL <A href='../../html_code/phys/module_sf_urban.F.html#URBAN_VAR_INIT'>urban_var_init</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="URBAN_VAR_INIT_2">(ISURBAN,TSK,TSLB,TMN,IVGTYP,               &amp; <font color=#447700>!urban<a name='2860'></font>
                              ims,ime,jms,jme,kms,kme,num_soil_layers,         &amp; <font color=#447700>!urban<a name='2861'></font>
                              LOW_DENSITY_RESIDENTIAL_TABLE,                   &amp;<a name='2862'>
		              HIGH_DENSITY_RESIDENTIAL_TABLE,                  &amp;<a name='2863'>
		              HIGH_INTENSITY_INDUSTRIAL_TABLE,                 &amp;<a name='2864'>
                              restart,sf_urban_physics,                        &amp; <font color=#447700>!urban<a name='2865'></font>
                              XXXR_URB2D,XXXB_URB2D,XXXG_URB2D,XXXC_URB2D,     &amp; <font color=#447700>!urban<a name='2866'></font>
                              TR_URB2D,TB_URB2D,TG_URB2D,TC_URB2D,QC_URB2D,    &amp; <font color=#447700>!urban<a name='2867'></font>
                              TRL_URB3D,TBL_URB3D,TGL_URB3D,                   &amp; <font color=#447700>!urban<a name='2868'></font>
                              SH_URB2D,LH_URB2D,G_URB2D,RN_URB2D, TS_URB2D,    &amp; <font color=#447700>!urban<a name='2869'></font>
                              num_urban_layers,                                &amp; <font color=#447700>!urban<a name='2870'></font>
                              num_urban_hi,                                    &amp; <font color=#447700>!urban<a name='2871'></font>
                              TRB_URB4D,TW1_URB4D,TW2_URB4D,TGB_URB4D,         &amp; <font color=#447700>!urban<a name='2872'></font>
                              TLEV_URB3D,QLEV_URB3D,                           &amp; <font color=#447700>!urban<a name='2873'></font>
                              TW1LEV_URB3D,TW2LEV_URB3D,                       &amp; <font color=#447700>!urban<a name='2874'></font>
                              TGLEV_URB3D,TFLEV_URB3D,                         &amp; <font color=#447700>!urban<a name='2875'></font>
                              SF_AC_URB3D,LF_AC_URB3D,CM_AC_URB3D,             &amp; <font color=#447700>!urban<a name='2876'></font>
                              SFVENT_URB3D,LFVENT_URB3D,                       &amp; <font color=#447700>!urban<a name='2877'></font>
                              SFWIN1_URB3D,SFWIN2_URB3D,                       &amp; <font color=#447700>!urban<a name='2878'></font>
                              SFW1_URB3D,SFW2_URB3D,SFR_URB3D,SFG_URB3D,       &amp; <font color=#447700>!urban<a name='2879'></font>
                              LP_URB2D,HI_URB2D,LB_URB2D,                      &amp; <font color=#447700>!urban<a name='2880'></font>
                              HGT_URB2D,MH_URB2D,STDH_URB2D,                   &amp; <font color=#447700>!urban<a name='2881'></font>
                              LF_URB2D,                                        &amp; <font color=#447700>!urban<a name='2882'></font>
                              CMCR_URB2D,TGR_URB2D,TGRL_URB3D,SMR_URB3D,       &amp; <font color=#447700>!urban<a name='2883'></font>
                              DRELR_URB2D,DRELB_URB2D,DRELG_URB2D,             &amp; <font color=#447700>!urban<a name='2884'></font>
                              FLXHUMR_URB2D, FLXHUMB_URB2D, FLXHUMG_URB2D,     &amp; <font color=#447700>!urban<a name='2885'></font>
                              A_U_BEP,A_V_BEP,A_T_BEP,A_Q_BEP,                 &amp; <font color=#447700>!multi-layer urban<a name='2886'></font>
                              A_E_BEP,B_U_BEP,B_V_BEP,                         &amp; <font color=#447700>!multi-layer urban<a name='2887'></font>
                              B_T_BEP,B_Q_BEP,B_E_BEP,DLG_BEP,                 &amp; <font color=#447700>!multi-layer urban<a name='2888'></font>
                              DL_U_BEP,SF_BEP,VL_BEP,                          &amp; <font color=#447700>!multi-layer urban<a name='2889'></font>
                              FRC_URB2D, UTYPE_URB2D)                            <font color=#447700>!urban<a name='2890'></font>
             ELSE<a name='2891'>
                CALL wrf_error_fatal ( 'arguments not present for calling urban model' )<a name='2892'>
             ENDIF<a name='2893'>
          ENDIF<a name='2894'>
<a name='2895'>
      CASE (RUCLSMSCHEME)<a name='2896'>
<font color=#447700>!          if(isfc .ne. 2)CALL wrf_error_fatal &amp;<a name='2897'></font>
<font color=#447700>!           ( 'module_physics_init: use myjsfc and myjpbl scheme for this lsm option' )<a name='2898'></font>
           CALL <A href='../../html_code/phys/module_sf_ruclsm.F.html#RUCLSMINIT'>ruclsminit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RUCLSMINIT_1">( SH2O,SMFR3D,TSLB,SMOIS,ISLTYP,IVGTYP,MMINLU,XICE,  &amp;<a name='2899'>
                     mavail,num_soil_layers, config_flags%iswater,      &amp;<a name='2900'>
#if (NMM_CORE == 1)<a name='2901'>
                     config_flags%isice, z0, restart,                  &amp;<a name='2902'>
#else<a name='2903'>
                     config_flags%isice, znt, restart,                  &amp;<a name='2904'>
#endif<a name='2905'>
                     allowed_to_read ,                             &amp;<a name='2906'>
                     ids,ide, jds,jde, kds,kde,                    &amp;<a name='2907'>
                     ims,ime, jms,jme, kms,kme,                    &amp;<a name='2908'>
                     its,ite, jts,jte, kts,kte                     )<a name='2909'>
<a name='2910'>
      CASE (PXLSMSCHEME)<a name='2911'>
          if(config_flags%num_land_cat .ne. 20 .and. config_flags%num_land_cat .ne. 21 .and. &amp; <font color=#447700>! MODIS<a name='2912'></font>
             config_flags%num_land_cat .ne. 24 .and. config_flags%num_land_cat .ne. 28 .and. &amp; <font color=#447700>! USGS<a name='2913'></font>
             config_flags%num_land_cat .ne. 40 .and. config_flags%num_land_cat .ne. 50 )     &amp; <font color=#447700>! NLCD<a name='2914'></font>
          CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_915"> ( 'module_physics_init: PX LSM option requires USGS, MODIS, or NLCD' )<a name='2915'>
          CALL <A href='../../html_code/phys/module_sf_noahdrv.F.html#LSMINIT'>LSMINIT</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LSMINIT_2">(VEGFRA,SNOW,SNOWC,SNOWH,CANWAT,SMSTAV,  &amp;<a name='2916'>
                     SMSTOT, SFCRUNOFF,UDRUNOFF,ACSNOW,        &amp;<a name='2917'>
                     ACSNOM,IVGTYP,ISLTYP,TSLB,SMOIS,SH2O,ZS,DZS, &amp;<a name='2918'>
                     MMINLU,                                   &amp;<a name='2919'>
                     SNOALB, FNDSOILW, FNDSNOWH, RDMAXALB,     &amp;<a name='2920'>
                     num_soil_layers, restart,                 &amp;<a name='2921'>
                     allowed_to_read ,                         &amp;<a name='2922'>
                     ids,ide, jds,jde, kds,kde,                &amp;<a name='2923'>
                     ims,ime, jms,jme, kms,kme,                &amp;<a name='2924'>
                     its,ite, jts,jte, kts,kte                 )<a name='2925'>
<a name='2926'>
<font color=#447700>!--------------fds (06/2010)-----------------------------------<a name='2927'></font>
     CASE  (SSIBSCHEME)<a name='2928'>
<font color=#447700>!SSiB only works with sfclay and YSU schemes. Check this here!<a name='2929'></font>
          if(isfc .ne. 1)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_916"> &amp;<a name='2930'>
           ( 'module_physics_init: use sfclay scheme with SSiB' )<a name='2931'>
          if(config_flags%bl_pbl_physics .ne. 1)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_917"> &amp;<a name='2932'>
           ( 'module_physics_init: use ysu scheme with SSiB' )<a name='2933'>
<font color=#447700>! Add radiation scheme 4 (RRTMg) for SSiB, By Zhenxin 2011-06-20 ************************<a name='2934'></font>
          if(config_flags%ra_lw_physics .eq. 2 .or. config_flags%ra_lw_physics .gt. 4)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_918"> &amp;<a name='2935'>
           ( 'module_physics_init: SSiB only works with rrtm, cam scheme or rrtmg scheme (lw_phys=1,3,4)' )<a name='2936'>
          if(config_flags%ra_sw_physics .eq. 2 .or. config_flags%ra_sw_physics .gt. 4)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_919"> &amp;<a name='2937'>
           ( 'module_physics_init: SSiB only works with rrtm, cam scheme or rrtmg scheme (sw_phys=1,3,4)' )<a name='2938'>
<font color=#447700>! End of Adding radiation scheme 4 (RRTMg) for SSiB, By Zhenxin 2011-06-20 **************<a name='2939'></font>
          IF ( TRIM(mminlu) .EQ. 'NLCD40' ) THEN<a name='2940'>
             CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_920"> ( 'SSIB does not work with NLCD data. Stop.' )<a name='2941'>
          ENDIF<a name='2942'>
<font color=#447700>!--------------------------------------------------------------<a name='2943'></font>
<font color=#447700>! CLM Init Coupling<a name='2944'></font>
      CASE (CLMSCHEME)<a name='2945'>
        IF ((SF_URBAN_PHYSICS.eq.1).OR.(SF_URBAN_PHYSICS.EQ.2).OR.(SF_URBAN_PHYSICS.EQ.3)) THEN<a name='2946'>
                CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_921"> ( 'CLM DOES NOT WORK WITH URBAN SCHEME' ) <a name='2947'>
        ENDIF<a name='2948'>
        IF ( TRIM(mminlu) .EQ. 'NLCD40' ) THEN<a name='2949'>
           CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_922"> ( 'CLM does not work with NLCD input. Stop' )<a name='2950'>
        ENDIF<a name='2951'>
<a name='2952'>
#ifdef WRF_USE_CLM<a name='2953'>
        IF(PRESENT(numc))THEN<a name='2954'>
        <font color=#447700>! added by Jiming Jin 10/14/2012 ; modified to use MODIS data 3/6/2014<a name='2955'></font>
        if((config_flags%num_land_cat .ne. 24) .AND. &amp;<a name='2956'>
           (config_flags%num_land_cat .ne. 28) .AND. &amp;<a name='2957'>
           (config_flags%num_land_cat .ne. 21) .AND. &amp;<a name='2958'>
           (config_flags%num_land_cat .ne. 20)) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_923"> &amp;<a name='2959'>
            ('module_physics_init: USGS or MODIS must be used with CLM option')<a name='2960'>
<a name='2961'>
            CALL <A href='../../html_code/phys/module_sf_clm.F.html#CLMINIT'>CLMINIT</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CLMINIT_1">(VEGFRA,SNOW,SNOWC,SNOWH,CANWAT,SMSTAV,    &amp;<a name='2962'>
                     SMSTOT, SFCRUNOFF,UDRUNOFF,ACSNOW,            &amp;<a name='2963'>
                     ACSNOM,IVGTYP,ISLTYP,TSLB,SMOIS,SH2O,ZS,DZS,  &amp;<a name='2964'>
                     FNDSOILW, FNDSNOWH,                           &amp;<a name='2965'>
                     num_soil_layers, restart,                     &amp;<a name='2966'>
                     allowed_to_read ,                             &amp;<a name='2967'>
                     ids,ide, jds,jde, kds,kde,                    &amp;<a name='2968'>
                     ims,ime, jms,jme, kms,kme,                    &amp;<a name='2969'>
                     its,ite, jts,jte, kts,kte                     &amp;<a name='2970'>
                    ,maxpatch                                            &amp;<a name='2971'>
                    ,numc,nump,snl,                                      &amp;<a name='2972'>
                     snowdp,wtc,wtp,h2osno,t_grnd,t_veg,         &amp;<a name='2973'>
                     h2ocan,h2ocan_col,t2m_max,t2m_min,t_ref2m,          &amp;<a name='2974'>
                     h2osoi_liq_s1,              &amp;<a name='2975'>
                     h2osoi_liq_s2,h2osoi_liq_s3,h2osoi_liq_s4,          &amp;<a name='2976'>
                     h2osoi_liq_s5,h2osoi_liq1,h2osoi_liq2,              &amp;<a name='2977'>
                     h2osoi_liq3,h2osoi_liq4,h2osoi_liq5,h2osoi_liq6,    &amp;<a name='2978'>
                     h2osoi_liq7,h2osoi_liq8,h2osoi_liq9,h2osoi_liq10,   &amp;<a name='2979'>
                     h2osoi_ice_s1,h2osoi_ice_s2,                        &amp;<a name='2980'>
                     h2osoi_ice_s3,h2osoi_ice_s4,h2osoi_ice_s5,          &amp;<a name='2981'>
                     h2osoi_ice1,h2osoi_ice2,h2osoi_ice3,h2osoi_ice4,    &amp;<a name='2982'>
                     h2osoi_ice5,h2osoi_ice6,h2osoi_ice7,                &amp;<a name='2983'>
                     h2osoi_ice8,h2osoi_ice9,h2osoi_ice10,               &amp;<a name='2984'>
                     t_soisno_s1,t_soisno_s2,t_soisno_s3,t_soisno_s4,    &amp;<a name='2985'>
                     t_soisno_s5,t_soisno1,t_soisno2,t_soisno3,          &amp;<a name='2986'>
                     t_soisno4,t_soisno5,t_soisno6,t_soisno7,            &amp;<a name='2987'>
                     t_soisno8,t_soisno9,t_soisno10,                     &amp;<a name='2988'>
                     dzsnow1,dzsnow2,dzsnow3,dzsnow4,dzsnow5,            &amp;<a name='2989'>
                     snowrds1,snowrds2,snowrds3,snowrds4,snowrds5,       &amp;<a name='2990'>
                     t_lake1,t_lake2,t_lake3,t_lake4,t_lake5,            &amp;<a name='2991'>
                     t_lake6,t_lake7,t_lake8,t_lake9,t_lake10,           &amp;<a name='2992'>
                     h2osoi_vol1,h2osoi_vol2,h2osoi_vol3,                &amp;<a name='2993'>
                     h2osoi_vol4,h2osoi_vol5,h2osoi_vol6,                &amp;<a name='2994'>
                     h2osoi_vol7,h2osoi_vol8,                            &amp;<a name='2995'>
                     h2osoi_vol9,h2osoi_vol10,                           &amp;<a name='2996'>
                     ht,XLAND,XICE                                       &amp;<a name='2997'>
                    ,ALBEDOsubgrid,LHsubgrid,HFXsubgrid,LWUPsubgrid,     &amp;<a name='2998'>
                     Q2subgrid,SABVsubgrid,SABGsubgrid,NRAsubgrid,       &amp;<a name='2999'>
                     SWUPsubgrid,lhsoi,lhveg,lhtran                      &amp;<a name='3000'>
                    )<a name='3001'>
        ELSE<a name='3002'>
                CALL wrf_error_fatal ( 'arguments not present for calling CLM' )<a name='3003'>
        ENDIF<a name='3004'>
#else<a name='3005'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_924"> ( "SF CLM CURRENTLY ifdef'ed out, set -DWRF_USE_CLM in configure.wrf in ARCH_LOCAL" )<a name='3006'>
#endif<a name='3007'>
<a name='3008'>
      CASE DEFAULT<a name='3009'>
<a name='3010'>
   END SELECT sfc_select<a name='3011'>
<a name='3012'>
#if ( EM_CORE == 1 )<a name='3013'>
   IF(PRESENT(SF_OCEAN_PHYSICS))THEN<a name='3014'>
     IF ( ( sf_ocean_physics .EQ. OMLSCHEME   ) .OR. &amp;<a name='3015'>
          ( sf_ocean_physics .EQ. PWP3DSCHEME ) ) THEN<a name='3016'>
        CALL <A href='../../html_code/phys/module_sf_oml.F.html#OMLINIT'>omlinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="OMLINIT_1">(oml_hml0, tsk,                           &amp;<a name='3017'>
                     tml,t0ml,hml,h0ml,huml,hvml,tmoml,       &amp;<a name='3018'>
                     allowed_to_read, start_of_simulation,    &amp;<a name='3019'>
                     ids,ide, jds,jde, kds,kde,               &amp;<a name='3020'>
                     ims,ime, jms,jme, kms,kme,               &amp;<a name='3021'>
                     its,ite, jts,jte, kts,kte                )<a name='3022'>
     ENDIF<a name='3023'>
   ENDIF<a name='3024'>
#endif<a name='3025'>
<a name='3026'>
     IF ( LakeModel == 1 ) THEN<a name='3027'>
 <a name='3028'>
             call  <A href='../../html_code/phys/module_sf_lake.F.html#LAKEINI'>lakeini</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LAKEINI_1">(IVGTYP,         ISLTYP,          HT,              SNOW,           &amp; <font color=#447700>!i<a name='3029'></font>
                           lake_min_elev,     restart,         lakedepth_default, lake_depth,     &amp;<a name='3030'>
                           lakedepth2d,    savedtke12d,     snowdp2d,        h2osno2d,       &amp; <font color=#447700>!o<a name='3031'></font>
                           snl2d,          t_grnd2d,        t_lake3d,        lake_icefrac3d, &amp;<a name='3032'>
                           z_lake3d,       dz_lake3d,       t_soisno3d,      h2osoi_ice3d,   &amp;<a name='3033'>
                           h2osoi_liq3d,   h2osoi_vol3d,    z3d,             dz3d,           &amp;<a name='3034'>
                           zi3d,           watsat3d,        csol3d,          tkmg3d,         &amp;<a name='3035'>
                           config_flags%ISWATER,  xice,     xice_threshold,  xland,  tsk,    &amp;<a name='3036'>
#if (EM_CORE == 1)<a name='3037'>
                           lakemask,  lakeflag,                                              &amp;<a name='3038'>
#endif<a name='3039'>
                           lake_depth_flag, use_lakedepth,              &amp;<a name='3040'>
                           tkdry3d,        tksatu3d,        lake2d,          its, ite, jts, jte, &amp;<a name='3041'>
                           ims,ime, jms,jme)<a name='3042'>
     ENDIF<a name='3043'>
 <a name='3044'>
<font color=#447700>!-- initialize pbl scheme<a name='3045'></font>
<a name='3046'>
   pbl_select: SELECT CASE(config_flags%bl_pbl_physics)<a name='3047'>
<a name='3048'>
      CASE (YSUSCHEME)<a name='3049'>
           if(isfc .ne. 1)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_925"> &amp;<a name='3050'>
            ( 'module_physics_init: Use sf_sfclay_physics= 1 or 91 for this pbl option' )<a name='3051'>
           IF ((SF_URBAN_PHYSICS.eq.2).OR.(SF_URBAN_PHYSICS.EQ.3)) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_926"> &amp;<a name='3052'>
            ( 'module_physics_init: use myj (option 2) or boulac (option 8) with BEP/BEM urban scheme' )<a name='3053'>
           CALL <A href='../../html_code/phys/module_bl_ysu.F.html#YSUINIT'>ysuinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="YSUINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN,    &amp;<a name='3054'>
                        RQCBLTEN,RQIBLTEN,P_QI,               &amp;<a name='3055'>
                        PARAM_FIRST_SCALAR,                   &amp;<a name='3056'>
                        restart,                              &amp;<a name='3057'>
                        allowed_to_read ,                     &amp;<a name='3058'>
                        ids, ide, jds, jde, kds, kde,         &amp;<a name='3059'>
                        ims, ime, jms, jme, kms, kme,         &amp;<a name='3060'>
                        its, ite, jts, jte, kts, kte          )<a name='3061'>
      CASE (SHINHONGSCHEME)<a name='3062'>
           if(isfc .ne. 1)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_927"> &amp;<a name='3063'>
            ( 'module_physics_init: Use sf_sfclay_physics= 1 or 91 for this pbl option' )<a name='3064'>
           IF ((SF_URBAN_PHYSICS.eq.2).OR.(SF_URBAN_PHYSICS.EQ.3)) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_928"> &amp;<a name='3065'>
            ( 'module_physics_init: use myj (option 2) or boulac (option 8) with BEP/BEM urban scheme' )<a name='3066'>
           CALL <A href='../../html_code/phys/module_bl_shinhong.F.html#SHINHONGINIT'>shinhonginit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SHINHONGINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN,&amp;<a name='3067'>
                        RQCBLTEN,RQIBLTEN,TKE_PBL,P_QI,       &amp;<a name='3068'>
                        PARAM_FIRST_SCALAR,                   &amp;<a name='3069'>
                        restart,                              &amp;<a name='3070'>
                        allowed_to_read ,                     &amp;<a name='3071'>
                        ids, ide, jds, jde, kds, kde,         &amp;<a name='3072'>
                        ims, ime, jms, jme, kms, kme,         &amp;<a name='3073'>
                        its, ite, jts, jte, kts, kte          )<a name='3074'>
      CASE (MRFSCHEME)<a name='3075'>
           if(isfc .ne. 1)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_929"> &amp;<a name='3076'>
            ( 'module_physics_init: Use sf_sfclay_physics= 1 or 91 for this pbl option' )<a name='3077'>
           IF ((SF_URBAN_PHYSICS.eq.2).OR.(SF_URBAN_PHYSICS.EQ.3)) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_930"> &amp;<a name='3078'>
            ( 'module_physics_init: use myj (option 2) or boulac (option 8) with BEP/BEM urban scheme' )<a name='3079'>
           CALL <A href='../../html_code/phys/module_bl_mrf.F.html#MRFINIT'>mrfinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MRFINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN,    &amp;<a name='3080'>
                        RQCBLTEN,RQIBLTEN,P_QI,               &amp;<a name='3081'>
                        PARAM_FIRST_SCALAR,                   &amp;<a name='3082'>
                        restart,                              &amp;<a name='3083'>
                        allowed_to_read ,                     &amp;<a name='3084'>
                        ids, ide, jds, jde, kds, kde,         &amp;<a name='3085'>
                        ims, ime, jms, jme, kms, kme,         &amp;<a name='3086'>
                        its, ite, jts, jte, kts, kte          )<a name='3087'>
      CASE (ACMPBLSCHEME)<a name='3088'>
           if(isfc .ne. 1 .and. isfc .ne. 7)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_931"> &amp;<a name='3089'>
            ( 'module_physics_init: use sfclay or pxsfc scheme for this pbl option' )<a name='3090'>
           IF ((SF_URBAN_PHYSICS.eq.2).OR.(SF_URBAN_PHYSICS.EQ.3)) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_932"> &amp;<a name='3091'>
            ( 'module_physics_init: use myj (option 2) or boulac (option 8) with BEP/BEM urban scheme' )<a name='3092'>
           CALL <A href='../../html_code/phys/module_bl_acm.F.html#ACMINIT'>acminit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ACMINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN,    &amp;<a name='3093'>
                        RQCBLTEN,RQIBLTEN,P_QI,               &amp;<a name='3094'>
                        PARAM_FIRST_SCALAR,                   &amp;<a name='3095'>
                        restart,                              &amp;<a name='3096'>
                        allowed_to_read ,                     &amp;<a name='3097'>
                        ids, ide, jds, jde, kds, kde,         &amp;<a name='3098'>
                        ims, ime, jms, jme, kms, kme,         &amp;<a name='3099'>
                        its, ite, jts, jte, kts, kte          )<a name='3100'>
      CASE (GFSSCHEME)<a name='3101'>
           if(isfc .ne. 2)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_933"> &amp;<a name='3102'>
            ( 'module_physics_init: use myjsfc scheme for this pbl option' )<a name='3103'>
           IF ((SF_URBAN_PHYSICS.eq.2).OR.(SF_URBAN_PHYSICS.EQ.3)) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_934"> &amp;<a name='3104'>
            ( 'module_physics_init: use myj (option 2) or boulac (option 8) with BEP/BEM urban scheme' )<a name='3105'>
           CALL <A href='../../html_code/phys/module_bl_gfs.F.html#GFSINIT'>gfsinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFSINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN,    &amp;<a name='3106'>
                        RQCBLTEN,RQIBLTEN,P_QI,               &amp;<a name='3107'>
                        PARAM_FIRST_SCALAR,                   &amp;<a name='3108'>
                        restart,                              &amp;<a name='3109'>
                        allowed_to_read ,                     &amp;<a name='3110'>
                        ids, ide, jds, jde, kds, kde,         &amp;<a name='3111'>
                        ims, ime, jms, jme, kms, kme,         &amp;<a name='3112'>
                        its, ite, jts, jte, kts, kte          )<a name='3113'>
#if (HWRF == 1)<a name='3114'>
      CASE (GFSEDMFSCHEME)<a name='3115'>
           if(isfc .ne. 2)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_935"> &amp;<a name='3116'>
            ( 'module_physics_init: use myjsfc scheme for this pbl option' )<a name='3117'>
           IF ((SF_URBAN_PHYSICS.eq.2).OR.(SF_URBAN_PHYSICS.EQ.3)) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_936"> &amp;<a name='3118'>
            ( 'module_physics_init: use myj (option 2) or boulac (option 8) with BEP/BEM urban scheme' )<a name='3119'>
           CALL <A href='../../html_code/phys/module_bl_gfsedmf.F.html#GFSEDMFINIT'>gfsedmfinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFSEDMFINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN,&amp;<a name='3120'>
                        RQCBLTEN,RQIBLTEN,P_QI,               &amp;<a name='3121'>
                        PARAM_FIRST_SCALAR,                   &amp;<a name='3122'>
                        restart,                              &amp;<a name='3123'>
                        allowed_to_read ,                     &amp;<a name='3124'>
                        ids, ide, jds, jde, kds, kde,         &amp;<a name='3125'>
                        ims, ime, jms, jme, kms, kme,         &amp;<a name='3126'>
                        its, ite, jts, jte, kts, kte          )<a name='3127'>
<a name='3128'>
#endif<a name='3129'>
      CASE (MYJPBLSCHEME)<a name='3130'>
           if(isfc .ne. 2)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_937"> &amp;<a name='3131'>
            ( 'module_physics_init: use myjsfc scheme for this pbl option' )<a name='3132'>
          IF ((SF_URBAN_PHYSICS.eq.2).OR.(SF_URBAN_PHYSICS.EQ.3)) THEN<a name='3133'>
           CALL <A href='../../html_code/phys/module_bl_myjurb.F.html#MYJURBINIT'>myjurbinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MYJURBINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN, &amp;<a name='3134'>
                        TKE_PBL,EXCH_H,restart,               &amp;<a name='3135'>
                        allowed_to_read ,                     &amp;<a name='3136'>
                        ids, ide, jds, jde, kds, kde,         &amp;<a name='3137'>
                        ims, ime, jms, jme, kms, kme,         &amp;<a name='3138'>
                        its, ite, jts, jte, kts, kte          )<a name='3139'>
          ELSE<a name='3140'>
<a name='3141'>
           CALL <A href='../../html_code/phys/module_bl_myjpbl.F.html#MYJPBLINIT'>myjpblinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MYJPBLINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN, &amp;<a name='3142'>
                        TKE_PBL,EXCH_H,restart,               &amp;<a name='3143'>
                        allowed_to_read ,                     &amp;<a name='3144'>
                        ids, ide, jds, jde, kds, kde,         &amp;<a name='3145'>
                        ims, ime, jms, jme, kms, kme,         &amp;<a name='3146'>
                        its, ite, jts, jte, kts, kte          )<a name='3147'>
          END IF<a name='3148'>
      CASE (QNSEPBLSCHEME)<a name='3149'>
           if(isfc .ne. 4)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_938"> &amp;<a name='3150'>
            ( 'module_physics_init: use qnsesfc scheme for this pbl option' )<a name='3151'>
           IF ((SF_URBAN_PHYSICS.eq.2).OR.(SF_URBAN_PHYSICS.EQ.3)) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_939"> &amp;<a name='3152'>
            ( 'module_physics_init: use myj (option 2) or boulac (option 8) with BEP/BEM urban scheme' )<a name='3153'>
           CALL <A href='../../html_code/phys/module_bl_qnsepbl.F.html#QNSEPBLINIT'>qnsepblinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="QNSEPBLINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN, &amp;<a name='3154'>
                        TKE_PBL,EXCH_H,restart,               &amp;<a name='3155'>
                        allowed_to_read ,                     &amp;<a name='3156'>
                        ids, ide, jds, jde, kds, kde,         &amp;<a name='3157'>
                        ims, ime, jms, jme, kms, kme,         &amp;<a name='3158'>
                        its, ite, jts, jte, kts, kte          )<a name='3159'>
           <a name='3160'>
<font color=#447700>!          IF ( PRESENT (mfshconv) ) THEN<a name='3161'></font>
              if (mfshconv.EQ.1) &amp;<a name='3162'>
              CALL <A href='../../html_code/phys/module_bl_mfshconvpbl.F.html#MFSHCONVPBLINIT'>mfshconvpblinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MFSHCONVPBLINIT_1">( massflux_EDKF, entr_EDKF, detr_EDKF &amp; <a name='3163'>
                                    ,thl_up, thv_up, rt_up              &amp;<a name='3164'>
                                    ,rv_up, rc_up, u_up, v_up           &amp;<a name='3165'>
                                    ,frac_up, restart,                  &amp;<a name='3166'>
                                    allowed_to_read ,                   &amp;<a name='3167'>
                                    ids, ide, jds, jde, kds, kde,       &amp;<a name='3168'>
                                    ims, ime, jms, jme, kms, kme,       &amp;<a name='3169'>
                                    its, ite, jts, jte, kts, kte   )  <a name='3170'>
<font color=#447700>!          ENDIF<a name='3171'></font>
<a name='3172'>
#if (NMM_CORE <font color=#447700>!= 1)<a name='3173'></font>
      CASE (BOULACSCHEME)<a name='3174'>
           if(isfc .ne. 1 .and. isfc .ne. 2)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_940"> &amp;<a name='3175'>
            ( 'module_physics_init: use sfclay or myjsfc scheme for this pbl option' )<a name='3176'>
           CALL <A href='../../html_code/phys/module_bl_boulac.F.html#BOULACINIT'>boulacinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="BOULACINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN,RQCBLTEN, &amp;<a name='3177'>
                         TKE_PBL,EXCH_H,restart,               &amp;<a name='3178'>
                         allowed_to_read ,                     &amp;<a name='3179'>
                         ids, ide, jds, jde, kds, kde,         &amp;<a name='3180'>
                         ims, ime, jms, jme, kms, kme,         &amp;<a name='3181'>
                         its, ite, jts, jte, kts, kte          )<a name='3182'>
        CASE (CAMUWPBLSCHEME)<a name='3183'>
           IF ((SF_URBAN_PHYSICS.eq.2).OR.(SF_URBAN_PHYSICS.EQ.3)) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_941"> &amp;<a name='3184'>
            ( 'module_physics_init: use myj (option 2) or boulac (option 8) with BEP/BEM urban scheme' )<a name='3185'>
           CALL <A href='../../html_code/phys/module_bl_camuwpbl_driver.F.html#CAMUWPBLINIT'>camuwpblinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CAMUWPBLINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN,        &amp;<a name='3186'>
                restart,TKE_PBL,is_CAMMGMP_used, &amp;<a name='3187'>
                ids, ide, jds, jde, kds, kde,                          &amp;<a name='3188'>
                ims, ime, jms, jme, kms, kme,                          &amp;<a name='3189'>
                its, ite, jts, jte, kts, kte                           )<a name='3190'>
#endif<a name='3191'>
<a name='3192'>
#if ( EM_CORE == 1 )<a name='3193'>
<a name='3194'>
<font color=#447700>!mynn <a name='3195'></font>
           <a name='3196'>
        CASE (MYNNPBLSCHEME2, MYNNPBLSCHEME3)<a name='3197'>
           IF(isfc .NE. 5 .AND. isfc .NE. 1 .AND. isfc .NE. 2) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_942"> &amp;<a name='3198'>
                ( 'module_physics_init: use mynnsfc or sfclay or myjsfc scheme for this pbl option')<a name='3199'>
           IF ((SF_URBAN_PHYSICS.eq.2).OR.(SF_URBAN_PHYSICS.EQ.3)) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_943"> &amp;<a name='3200'>
            ( 'module_physics_init: use myj (option 2) or boulac (option 8) with BEP/BEM urban scheme' )<a name='3201'>
           <a name='3202'>
           SELECT CASE(config_flags%bl_pbl_physics)<a name='3203'>
<a name='3204'>
             CASE(MYNNPBLSCHEME2)<a name='3205'>
                mynn_closure_level=2<a name='3206'>
<a name='3207'>
             CASE(MYNNPBLSCHEME3)<a name='3208'>
                mynn_closure_level=3<a name='3209'>
<a name='3210'>
             CASE DEFAULT<a name='3211'>
<a name='3212'>
           END SELECT<a name='3213'>
<a name='3214'>
           CALL <A href='../../html_code/phys/module_bl_mynn.F.html#MYNN_BL_INIT_DRIVER'>mynn_bl_init_driver</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MYNN_BL_INIT_DRIVER_1">(&amp;<a name='3215'>
                &amp;RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN,RQCBLTEN,&amp;<a name='3216'>
                &amp;RQIBLTEN,                                  &amp;<a name='3217'>
                <font color=#447700>!RQNCBLTEN,RQNIBLTEN,                       &amp;<a name='3218'></font>
                &amp;QKE,                                       &amp;<a name='3219'>
                &amp;TKE_PBL,EXCH_H                             &amp;<a name='3220'>
                &amp;,restart,allowed_to_read,mynn_closure_level &amp;<a name='3221'>
                &amp;,IDS,IDE,JDS,JDE,KDS,KDE                    &amp;<a name='3222'>
                &amp;,IMS,IME,JMS,JME,KMS,KME                    &amp;<a name='3223'>
                &amp;,ITS,ITE,JTS,JTE,KTS,KTE)<a name='3224'>
<a name='3225'>
      CASE (TEMFPBLSCHEME)<a name='3226'>
           <font color=#447700>! if(isfc .ne. 0)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_944"> &amp;<a name='3227'></font>
           <font color=#447700>!  ( 'module_physics_init: use sfclay scheme = 0 for this pbl option' )<a name='3228'></font>
           IF ((SF_URBAN_PHYSICS.eq.2).OR.(SF_URBAN_PHYSICS.EQ.3)) CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_945"> &amp;<a name='3229'>
            ( 'module_physics_init: use myj (option 2) or boulac (option 8) with BEP/BEM urban scheme' )<a name='3230'>
         IF ( PRESENT( te_temf ) .AND. PRESENT( cf3d_temf )) THEN<a name='3231'>
           CALL <A href='../../html_code/phys/module_bl_temf.F.html#TEMFINIT'>temfinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TEMFINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN,    &amp;<a name='3232'>
                        RQCBLTEN,RQIBLTEN,P_QI,               &amp;<a name='3233'>
                        PARAM_FIRST_SCALAR,                   &amp;<a name='3234'>
                        restart,                              &amp;<a name='3235'>
                        allowed_to_read ,                     &amp;<a name='3236'>
                        te_temf,cf3d_temf,                    &amp; <font color=#447700>! WA<a name='3237'></font>
                        ids, ide, jds, jde, kds, kde,         &amp;<a name='3238'>
                        ims, ime, jms, jme, kms, kme,         &amp;<a name='3239'>
                        its, ite, jts, jte, kts, kte          )<a name='3240'>
             ELSE<a name='3241'>
                CALL wrf_error_fatal ( 'arguments not present for calling TEMF scheme' )<a name='3242'>
         ENDIF<a name='3243'>
<a name='3244'>
#endif<a name='3245'>
<a name='3246'>
      CASE (GBMPBLSCHEME) <a name='3247'>
           if(isfc .ne. 1)CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_946"> &amp;<a name='3248'>
            ( 'module_physics_init: Use sf_sfclay_physics= 1 or 91 for this pbl option' )<a name='3249'>
         CALL <A href='../../html_code/phys/module_bl_gbmpbl.F.html#GBMPBLINIT'>gbmpblinit</A><A href='../../html_code/phys/module_physics_init.F.html#BL_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GBMPBLINIT_1">(RUBLTEN,RVBLTEN,RTHBLTEN,RQVBLTEN,   &amp;<a name='3250'>
                        RQCBLTEN,RQIBLTEN,P_QI,               &amp;<a name='3251'>
                        PARAM_FIRST_SCALAR,TKE_PBL,           &amp;<a name='3252'>
                        EXCH_H,                               &amp;<a name='3253'>
                        restart,allowed_to_read ,             &amp;<a name='3254'>
                        ids, ide, jds, jde, kds, kde,         &amp;<a name='3255'>
                        ims, ime, jms, jme, kms, kme,         &amp;<a name='3256'>
                        its, ite, jts, jte, kts, kte          )<a name='3257'>
<a name='3258'>
<a name='3259'>
      CASE DEFAULT<a name='3260'>
<a name='3261'>
   END SELECT pbl_select<a name='3262'>
<a name='3263'>
<a name='3264'>
   END SUBROUTINE bl_init<a name='3265'>
<a name='3266'>
<font color=#447700>!==================================================================<a name='3267'></font>
<A NAME='CU_INIT'><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3268'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>cu_init</font>(DX,STEPCU,CUDT,DT,RUCUTEN,RVCUTEN,RTHCUTEN,  &amp; <A href='../../call_to/CU_INIT.html' TARGET='index'>1</A>,<A href='../../call_from/CU_INIT.html' TARGET='index'>24</A><a name='3269'>
                      RQVCUTEN,RQRCUTEN,RQCCUTEN,RQSCUTEN,RQICUTEN,&amp;<a name='3270'>
                      NCA,RAINC,RAINCV,W0AVG,config_flags,restart, &amp;<a name='3271'>
                      CLDEFI,LOWLYR,MASS_FLUX,                     &amp;<a name='3272'>
                      RTHFTEN, RQVFTEN,                            &amp;<a name='3273'>
#if ( EM_CORE == 1 )<a name='3274'>
                      <font color=#447700>!BSINGH - For WRFCuP Scheme<a name='3275'></font>
                      cupflag,cldfra_cup,cldfratend_cup,          &amp; <font color=#447700>!CuP, wig 18-Sep-2006<a name='3276'></font>
                      shall,                                      &amp; <font color=#447700>!CuP, wig 18-Sep-2006<a name='3277'></font>
                      tcloud_cup,                                 &amp; <font color=#447700>!CuP, rce 18-apr-2012<a name='3278'></font>
                      <font color=#447700>!BSINGH -ENDS<a name='3279'></font>
#endif<a name='3280'>
                      APR_GR,APR_W,APR_MC,APR_ST,APR_AS,           &amp;<a name='3281'>
                      APR_CAPMA,APR_CAPME,APR_CAPMI,               &amp;<a name='3282'>
                      cugd_tten,cugd_ttens,cugd_qvten,             &amp;<a name='3283'>
                      cugd_qvtens,cugd_qcten,                      &amp;<a name='3284'>
                      allowed_to_read, start_of_simulation,        &amp;<a name='3285'>
                      ids, ide, jds, jde, kds, kde,                &amp;<a name='3286'>
                      ims, ime, jms, jme, kms, kme,                &amp;<a name='3287'>
                      its, ite, jts, jte, kts, kte,                &amp;<a name='3288'>
                      RQCNCUTEN,RQINCUTEN                          )                        <a name='3289'>
<font color=#447700>!------------------------------------------------------------------<a name='3290'></font>
   USE <A href='../../html_code/phys/module_cu_kf.F.html#MODULE_CU_KF'>module_cu_kf</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_KF_3"><a name='3291'>
   USE module_cu_kfeta<a name='3292'>
   USE <A href='../../html_code/phys/module_cu_mskf.F.html#MODULE_CU_MSKF'>module_cu_mskf</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_MSKF_2"><a name='3293'>
   USE <A href='../../html_code/phys/module_cu_bmj.F.html#MODULE_CU_BMJ'>MODULE_CU_BMJ</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_BMJ_3"><a name='3294'>
   USE module_cu_gd,  ONLY : GDINIT<a name='3295'>
   USE <A href='../../html_code/phys/module_cu_g3.F.html#MODULE_CU_G3'>module_cu_g3</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_G3_2">,  ONLY : G3INIT<a name='3296'>
   USE <A href='../../html_code/phys/module_cu_sas.F.html#MODULE_CU_SAS'>module_cu_sas</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_SAS_2"><a name='3297'>
   USE <A href='../../html_code/phys/module_cu_scalesas.F.html#MODULE_CU_SCALESAS'>module_cu_scalesas</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_SCALESAS_2"><a name='3298'>
   USE <A href='../../html_code/phys/module_cu_osas.F.html#MODULE_CU_OSAS'>module_cu_osas</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_OSAS_2"><a name='3299'>
   USE <A href='../../html_code/phys/module_cu_camzm_driver.F.html#MODULE_CU_CAMZM_DRIVER'>module_cu_camzm_driver</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_CAMZM_DRIVER_2">, ONLY : zm_conv_init<a name='3300'>
   USE <A href='../../html_code/phys/module_cu_nsas.F.html#MODULE_CU_NSAS'>module_cu_nsas</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_NSAS_2"><a name='3301'>
   USE <A href='../../html_code/phys/module_cu_tiedtke.F.html#MODULE_CU_TIEDTKE'>module_cu_tiedtke</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_TIEDTKE_2"><a name='3302'>
   USE <A href='../../html_code/phys/module_cu_ntiedtke.F.html#MODULE_CU_NTIEDTKE'>module_cu_ntiedtke</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_NTIEDTKE_2"><a name='3303'>
#if ( EM_CORE == 1 )<a name='3304'>
   USE <A href='../../html_code/phys/module_cu_kfcup.F.html#MODULE_CU_KFCUP'>module_cu_kfcup</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_KFCUP_2"> <font color=#447700>!BSINGH - For WRFCuP Scheme<a name='3305'></font>
#endif<a name='3306'>
<font color=#447700>!------------------------------------------------------------------<a name='3307'></font>
   IMPLICIT NONE <a name='3308'>
<font color=#447700>!------------------------------------------------------------------<a name='3309'></font>
   TYPE (grid_config_rec_type) ::     config_flags<a name='3310'>
   LOGICAL , INTENT(IN)        :: restart<a name='3311'>
<a name='3312'>
<a name='3313'>
   INTEGER , INTENT(IN)        :: ids, ide, jds, jde, kds, kde,   &amp;<a name='3314'>
                                  ims, ime, jms, jme, kms, kme,   &amp;<a name='3315'>
                                  its, ite, jts, jte, kts, kte<a name='3316'>
<a name='3317'>
   REAL ,    INTENT(IN)        :: DT, CUDT, DX<a name='3318'>
   LOGICAL , INTENT(IN)        :: start_of_simulation<a name='3319'>
   LOGICAL , INTENT(IN)        :: allowed_to_read<a name='3320'>
   INTEGER , INTENT(INOUT)     :: STEPCU<a name='3321'>
<a name='3322'>
   REAL ,   DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) ::    &amp;    <a name='3323'>
            RUCUTEN, RVCUTEN, RTHCUTEN, &amp;<a name='3324'>
            RQVCUTEN, RQCCUTEN, RQRCUTEN, RQICUTEN, RQSCUTEN<a name='3325'>
#if ( EM_CORE == 1 )<a name='3326'>
   <font color=#447700>!BSINGH - For WRFCuP Scheme<a name='3327'></font>
   REAL ,   DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) ::    &amp;    <a name='3328'>
        cldfra_cup,cldfratend_cup                               <font color=#447700>!CuP, wig 18-Sep-2006<a name='3329'></font>
   <font color=#447700>!BSINGH -ENDS<a name='3330'></font>
#endif<a name='3331'>
   <a name='3332'>
<a name='3333'>
   REAL ,   DIMENSION( ims:ime , kms:kme , jms:jme ) , OPTIONAL, INTENT(INOUT) ::    &amp;    <a name='3334'>
                        cugd_tten,cugd_ttens,cugd_qvten,            &amp;    <a name='3335'>
                        cugd_qvtens,cugd_qcten, RQCNCUTEN, RQINCUTEN<a name='3336'>
<a name='3337'>
   REAL ,   DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(OUT) :: W0AVG<a name='3338'>
<a name='3339'>
   REAL,    DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) ::    &amp;<font color=#447700>!BSINGH(PNNL)- should be declared inout<a name='3340'></font>
            RTHFTEN, RQVFTEN<a name='3341'>
<a name='3342'>
   REAL ,   DIMENSION( ims:ime , jms:jme ), INTENT(OUT):: RAINC, RAINCV<a name='3343'>
<a name='3344'>
   REAL ,   DIMENSION( ims:ime , jms:jme ), INTENT(OUT):: CLDEFI<a name='3345'>
#if ( EM_CORE == 1 )<a name='3346'>
   <font color=#447700>!BSINGH - For WRFCuP Scheme<a name='3347'></font>
   REAL ,   DIMENSION( ims:ime , jms:jme ), INTENT(OUT):: shall, &amp; <font color=#447700>!CuP, wig 18-Sep-2006<a name='3348'></font>
                                                     tcloud_cup    <font color=#447700>!CuP, rce 18-apr-2012<a name='3349'></font>
   LOGICAL, DIMENSION( ims:ime , jms:jme ), INTENT(OUT):: cupflag  <font color=#447700>!CuP, wig 9-Oct-2006 !BSINGH - For WRFCuP Scheme<a name='3350'></font>
   <font color=#447700>!BSINGH -ENDS<a name='3351'></font>
#endif<a name='3352'>
<a name='3353'>
   REAL ,   DIMENSION( ims:ime , jms:jme ), INTENT(INOUT):: NCA<a name='3354'>
<a name='3355'>
   REAL ,   DIMENSION( ims:ime , jms:jme ), INTENT(INOUT):: MASS_FLUX,   &amp;<a name='3356'>
                                   APR_GR,APR_W,APR_MC,APR_ST,APR_AS,    &amp;    <a name='3357'>
                                   APR_CAPMA,APR_CAPME,APR_CAPMI<a name='3358'>
   INTEGER, DIMENSION( ims:ime , jms:jme ), INTENT(INOUT):: LOWLYR<a name='3359'>
<a name='3360'>
<font color=#447700>! LOCAL VAR<a name='3361'></font>
<a name='3362'>
  INTEGER :: i,j,itf,jtf<a name='3363'>
<a name='3364'>
<font color=#447700>!--------------------------------------------------------------------<a name='3365'></font>
<a name='3366'>
<font color=#447700>!-- calculate cumulus parameterization time step<a name='3367'></font>
<a name='3368'>
   itf=min0(ite,ide-1)<a name='3369'>
   jtf=min0(jte,jde-1)<a name='3370'>
<font color=#447700>!<a name='3371'></font>
   STEPCU = nint(CUDT*60./DT)<a name='3372'>
   STEPCU = max(STEPCU,1)<a name='3373'>
<a name='3374'>
<font color=#447700>!-- initialization<a name='3375'></font>
<a name='3376'>
   IF(start_of_simulation)THEN<a name='3377'>
     DO j=jts,jtf<a name='3378'>
     DO i=its,itf<a name='3379'>
        RAINC(i,j)=0.<a name='3380'>
        RAINCV(i,j)=0.<a name='3381'>
     ENDDO<a name='3382'>
     ENDDO<a name='3383'>
   ENDIF<a name='3384'>
<a name='3385'>
<font color=#447700>!-- deep convection and hybrid deep-shallow convection schemes<a name='3386'></font>
   cps_select: SELECT CASE(config_flags%cu_physics)<a name='3387'>
<a name='3388'>
     CASE (KFSCHEME)<a name='3389'>
          CALL <A href='../../html_code/phys/module_cu_kf.F.html#KFINIT'>kfinit</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="KFINIT_1">(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQRCUTEN,        &amp;<a name='3390'>
                      RQICUTEN,RQSCUTEN,NCA,W0AVG,P_QI,P_QS,      &amp;<a name='3391'>
                      PARAM_FIRST_SCALAR,restart,                 &amp;<a name='3392'>
                      allowed_to_read ,                           &amp;<a name='3393'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3394'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3395'>
                      its, ite, jts, jte, kts, kte                )<a name='3396'>
<a name='3397'>
     CASE (BMJSCHEME)<a name='3398'>
          CALL <A href='../../html_code/phys/module_cu_bmj.F.html#BMJINIT'>bmjinit</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="BMJINIT_1">(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQRCUTEN,       &amp;<a name='3399'>
                      CLDEFI,LOWLYR,cp,r_d,restart,               &amp;<a name='3400'>
                      allowed_to_read ,                           &amp;<a name='3401'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3402'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3403'>
                      its, ite, jts, jte, kts, kte                )<a name='3404'>
<a name='3405'>
     CASE (KFETASCHEME)<a name='3406'>
          CALL kf_eta_init(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQRCUTEN,   &amp;<a name='3407'>
                      RQICUTEN,RQSCUTEN,NCA,W0AVG,P_QI,P_QS,      &amp;<a name='3408'>
                      SVP1,SVP2,SVP3,SVPT0,                       &amp;<a name='3409'>
                      PARAM_FIRST_SCALAR,restart,                 &amp;<a name='3410'>
                      allowed_to_read ,                           &amp;<a name='3411'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3412'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3413'>
                      its, ite, jts, jte, kts, kte                )<a name='3414'>
<a name='3415'>
#if ( EM_CORE == 1 )<a name='3416'>
     CASE (MSKFSCHEME)<a name='3417'>
          CALL <A href='../../html_code/phys/module_cu_mskf.F.html#MSKF_INIT'>mskf_init</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MSKF_INIT_1">(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQRCUTEN,     &amp;<a name='3418'>
                      RQICUTEN,RQSCUTEN,NCA,W0AVG,P_QI,P_QS,      &amp;<a name='3419'>
                      SVP1,SVP2,SVP3,SVPT0,                       &amp;<a name='3420'>
                      PARAM_FIRST_SCALAR,restart,                 &amp;<a name='3421'>
                      allowed_to_read ,                           &amp;<a name='3422'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3423'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3424'>
                      its, ite, jts, jte, kts, kte                )<a name='3425'>
#endif<a name='3426'>
<a name='3427'>
     CASE (GDSCHEME)<a name='3428'>
          CALL gdinit(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQICUTEN,        &amp;<a name='3429'>
                      MASS_FLUX,cp,restart,                       &amp;<a name='3430'>
                      P_QC,P_QI,PARAM_FIRST_SCALAR,               &amp;<a name='3431'>
                      RTHFTEN, RQVFTEN,                           &amp;<a name='3432'>
                      APR_GR,APR_W,APR_MC,APR_ST,APR_AS,          &amp;<a name='3433'>
                      APR_CAPMA,APR_CAPME,APR_CAPMI,              &amp;<a name='3434'>
                      allowed_to_read ,                           &amp;<a name='3435'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3436'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3437'>
                      its, ite, jts, jte, kts, kte                )<a name='3438'>
     CASE (NSASSCHEME)<a name='3439'>
         CALL <A href='../../html_code/phys/module_cu_nsas.F.html#NSASINIT'>nsasinit</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NSASINIT_1">(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQICUTEN,       &amp;<a name='3440'>
                      RUCUTEN,RVCUTEN,                            &amp; <a name='3441'>
                      restart,P_QC,P_QI,PARAM_FIRST_SCALAR,       &amp;<a name='3442'>
                      allowed_to_read ,                           &amp;<a name='3443'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3444'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3445'>
                      its, ite, jts, jte, kts, kte                )<a name='3446'>
<a name='3447'>
#if ( EM_CORE == 1 )<a name='3448'>
     CASE (G3SCHEME,GFSCHEME)<a name='3449'>
          CALL <A href='../../html_code/phys/module_cu_g3.F.html#G3INIT'>g3init</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G3INIT_1">(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQICUTEN,        &amp;<a name='3450'>
                      MASS_FLUX,cp,restart,                       &amp;<a name='3451'>
                      P_QC,P_QI,PARAM_FIRST_SCALAR,               &amp;<a name='3452'>
                      RTHFTEN, RQVFTEN,                           &amp;<a name='3453'>
                      APR_GR,APR_W,APR_MC,APR_ST,APR_AS,          &amp;<a name='3454'>
                      APR_CAPMA,APR_CAPME,APR_CAPMI,              &amp;<a name='3455'>
                      cugd_tten,cugd_ttens,cugd_qvten,            &amp;<a name='3456'>
                      cugd_qvtens,cugd_qcten,                     &amp;<a name='3457'>
                      allowed_to_read ,                           &amp;<a name='3458'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3459'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3460'>
                      its, ite, jts, jte, kts, kte                )<a name='3461'>
#endif<a name='3462'>
     CASE (SASSCHEME)<a name='3463'>
          CALL <A href='../../html_code/phys/module_cu_sas.F.html#SASINIT'>sasinit</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SASINIT_1">(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQICUTEN,       &amp;<a name='3464'>
                      RUCUTEN,RVCUTEN,                            &amp;   <font color=#447700>! gopal's doing for SAS<a name='3465'></font>
                      restart,P_QC,P_QI,PARAM_FIRST_SCALAR,       &amp;<a name='3466'>
                      allowed_to_read ,                           &amp;<a name='3467'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3468'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3469'>
                      its, ite, jts, jte, kts, kte                )<a name='3470'>
<a name='3471'>
     CASE (SCALESASSCHEME)<a name='3472'>
          CALL <A href='../../html_code/phys/module_cu_scalesas.F.html#SCALESASINIT'>scalesasinit</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SCALESASINIT_1">(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQICUTEN,  &amp;<a name='3473'>
                      RUCUTEN,RVCUTEN,                            &amp;   <a name='3474'>
                      restart,P_QC,P_QI,PARAM_FIRST_SCALAR,       &amp;<a name='3475'>
                      allowed_to_read ,                           &amp;<a name='3476'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3477'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3478'>
                      its, ite, jts, jte, kts, kte                )<a name='3479'>
<a name='3480'>
#if ( EM_CORE == 1 )<a name='3481'>
          <font color=#447700>!BSINGH - For WRFCuP Scheme<a name='3482'></font>
    CASE (KFCUPSCHEME)  <font color=#447700>!wig: 18-Sep-2006<a name='3483'></font>
       CALL <A href='../../html_code/phys/module_cu_kfcup.F.html#KF_CUP_INIT'>kf_cup_init</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="KF_CUP_INIT_1">(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQRCUTEN,   &amp;<a name='3484'>
                      RQICUTEN,RQSCUTEN,NCA,W0AVG,P_QI,P_QS,      &amp;<a name='3485'>
                      SVP1,SVP2,SVP3,SVPT0,                       &amp;<a name='3486'>
                      cupflag,cldfra_cup,cldfratend_cup,          &amp;<a name='3487'>
                      shall,                                      &amp;<a name='3488'>
                      tcloud_cup,                                 &amp;<a name='3489'>
                      PARAM_FIRST_SCALAR,restart,                 &amp;<a name='3490'>
                      allowed_to_read ,                           &amp;<a name='3491'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3492'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3493'>
                      its, ite, jts, jte, kts, kte                )<a name='3494'>
<a name='3495'>
    <font color=#447700>!BSINGH - ENDS<a name='3496'></font>
#endif<a name='3497'>
<a name='3498'>
     CASE (OSASSCHEME)<a name='3499'>
          CALL <A href='../../html_code/phys/module_cu_osas.F.html#OSASINIT'>osasinit</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="OSASINIT_1">(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQICUTEN,      &amp;<a name='3500'>
                      RUCUTEN,RVCUTEN,                            &amp;   <font color=#447700>! gopal's doing for SAS<a name='3501'></font>
                      restart,P_QC,P_QI,PARAM_FIRST_SCALAR,       &amp;<a name='3502'>
                      allowed_to_read ,                           &amp;<a name='3503'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3504'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3505'>
                      its, ite, jts, jte, kts, kte                )<a name='3506'>
<a name='3507'>
     CASE (CAMZMSCHEME)<a name='3508'>
          IF (PRESENT(RQCNCUTEN)) THEN<a name='3509'>
          CALL <A href='../../html_code/phys/module_cu_camzm_driver.F.html#ZM_CONV_INIT'>zm_conv_init</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ZM_CONV_INIT_1">(DT, DX, rucuten, rvcuten, rthcuten, rqvcuten, &amp;<a name='3510'>
                      rqccuten, rqicuten, rqcncuten, rqincuten,         &amp;<a name='3511'>
                      p_qc, p_qi, p_qnc, p_qni, param_first_scalar,     &amp;<a name='3512'>
                      restart,                                          &amp;<a name='3513'>
                      ids, ide, jds, jde, kds, kde,                     &amp;<a name='3514'>
                      ims, ime, jms, jme, kms, kme,                     &amp;<a name='3515'>
                      its, ite, jts, jte, kts, kte                      )<a name='3516'>
          ELSE<a name='3517'>
          CALL wrf_error_fatal ( 'arguments not present for calling camzmscheme' )<a name='3518'>
          ENDIF<a name='3519'>
<a name='3520'>
<font color=#447700>! Tiedtke Scheme - ZCX&amp;YQW<a name='3521'></font>
      CASE (TIEDTKESCHEME)<a name='3522'>
          CALL <A href='../../html_code/phys/module_cu_tiedtke.F.html#TIEDTKEINIT'>tiedtkeinit</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TIEDTKEINIT_1">(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQICUTEN,   &amp;<a name='3523'>
                      RUCUTEN,RVCUTEN,                            &amp; <a name='3524'>
                      restart,P_QC,P_QI,PARAM_FIRST_SCALAR,       &amp;<a name='3525'>
                      allowed_to_read ,                           &amp;<a name='3526'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3527'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3528'>
                      its, ite, jts, jte, kts, kte                )<a name='3529'>
<a name='3530'>
      CASE (NTIEDTKESCHEME)<a name='3531'>
          CALL <A href='../../html_code/phys/module_cu_ntiedtke.F.html#NTIEDTKEINIT'>ntiedtkeinit</A><A href='../../html_code/phys/module_physics_init.F.html#CU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NTIEDTKEINIT_1">(RTHCUTEN,RQVCUTEN,RQCCUTEN,RQICUTEN,  &amp;<a name='3532'>
                      RUCUTEN,RVCUTEN,                            &amp;<a name='3533'>
                      RTHFTEN, RQVFTEN,                           &amp;<a name='3534'>
                      restart,P_QC,P_QI,PARAM_FIRST_SCALAR,       &amp;<a name='3535'>
                      allowed_to_read ,                           &amp;<a name='3536'>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3537'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3538'>
                      its, ite, jts, jte, kts, kte                )<a name='3539'>
<a name='3540'>
     CASE DEFAULT<a name='3541'>
<a name='3542'>
   END SELECT cps_select<a name='3543'>
<a name='3544'>
   END SUBROUTINE cu_init<a name='3545'>
<a name='3546'>
<font color=#447700>!==================================================================<a name='3547'></font>
<A NAME='SHCU_INIT'><A href='../../html_code/phys/module_physics_init.F.html#SHCU_INIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3548'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>shcu_init</font>(STEPCU,CUDT,DT,RUSHTEN,RVSHTEN,RTHSHTEN,   &amp; <A href='../../call_to/SHCU_INIT.html' TARGET='index'>1</A>,<A href='../../call_from/SHCU_INIT.html' TARGET='index'>6</A><a name='3549'>
                      RQVSHTEN,RQRSHTEN,RQCSHTEN,                  &amp;<a name='3550'>
                      RQSSHTEN,RQISHTEN,RQGSHTEN,                  &amp;<a name='3551'>
                      NCA,RAINC,RAINCV,config_flags,restart,       &amp;<a name='3552'>
                      allowed_to_read, start_of_simulation,        &amp;<a name='3553'>
                      ids, ide, jds, jde, kds, kde,                &amp;<a name='3554'>
                      ims, ime, jms, jme, kms, kme,                &amp;<a name='3555'>
                      its, ite, jts, jte, kts, kte                 )<a name='3556'>
<font color=#447700>!------------------------------------------------------------------<a name='3557'></font>
   USE <A href='../../html_code/phys/module_shcu_camuwshcu.F.html#UWSHCU'>uwshcu</A><A href='../../html_code/phys/module_physics_init.F.html#SHCU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="UWSHCU_1">,        ONLY: init_uwshcu<a name='3558'>
   USE <A href='../../html_code/phys/module_shcu_grims.F.html#MODULE_SHCU_GRIMS'>module_shcu_grims</A><A href='../../html_code/phys/module_physics_init.F.html#SHCU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SHCU_GRIMS_1">, ONLY: grimsinit<a name='3559'>
   USE <A href='../../html_code/phys/module_cam_physconst.F.html#PHYSCONST'>physconst</A><A href='../../html_code/phys/module_physics_init.F.html#SHCU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PHYSCONST_23">,     ONLY: cpair, gravit, latice, latvap, mwdry, mwh2o, &amp;<a name='3560'>
                            rair, zvir<a name='3561'>
   USE <A href='../../html_code/phys/module_cam_shr_kind_mod.F.html#SHR_KIND_MOD'>shr_kind_mod</A><A href='../../html_code/phys/module_physics_init.F.html#SHCU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SHR_KIND_MOD_31">,  ONLY: r8 =&gt; shr_kind_r8<a name='3562'>
<a name='3563'>
<font color=#447700>!------------------------------------------------------------------<a name='3564'></font>
   IMPLICIT NONE<a name='3565'>
<font color=#447700>!------------------------------------------------------------------<a name='3566'></font>
   TYPE (grid_config_rec_type) :: config_flags<a name='3567'>
   LOGICAL , INTENT(IN)        :: restart<a name='3568'>
<a name='3569'>
<a name='3570'>
   INTEGER , INTENT(IN)        :: ids, ide, jds, jde, kds, kde,   &amp;<a name='3571'>
                                  ims, ime, jms, jme, kms, kme,   &amp;<a name='3572'>
                                  its, ite, jts, jte, kts, kte<a name='3573'>
<a name='3574'>
   REAL ,    INTENT(IN)        :: DT, CUDT<a name='3575'>
   LOGICAL , INTENT(IN)        :: start_of_simulation<a name='3576'>
   LOGICAL , INTENT(IN)        :: allowed_to_read<a name='3577'>
   INTEGER , INTENT(INOUT)     :: STEPCU<a name='3578'>
<a name='3579'>
   REAL ,   DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) ::    &amp;<a name='3580'>
            RUSHTEN, RVSHTEN, RTHSHTEN, &amp;<a name='3581'>
            RQVSHTEN, RQCSHTEN, RQRSHTEN, RQISHTEN, RQSSHTEN, RQGSHTEN<a name='3582'>
<a name='3583'>
   REAL ,   DIMENSION( ims:ime , jms:jme ), INTENT(OUT):: RAINC, RAINCV<a name='3584'>
<a name='3585'>
   REAL ,   DIMENSION( ims:ime , jms:jme ), INTENT(INOUT):: NCA<a name='3586'>
<a name='3587'>
<font color=#447700>! LOCAL VAR<a name='3588'></font>
<a name='3589'>
  INTEGER :: i,j,itf,jtf<a name='3590'>
<a name='3591'>
<font color=#447700>!--------------------------------------------------------------------<a name='3592'></font>
<a name='3593'>
<font color=#447700>! Some of this stuff is redundant with deep convection, but redo it<a name='3594'></font>
<font color=#447700>! in case deep is turned off...<a name='3595'></font>
<a name='3596'>
<font color=#447700>!-- calculate cumulus parameterization time step<a name='3597'></font>
<a name='3598'>
   itf=min0(ite,ide-1)<a name='3599'>
   jtf=min0(jte,jde-1)<a name='3600'>
<font color=#447700>!<a name='3601'></font>
   STEPCU = nint(CUDT*60./DT)<a name='3602'>
   STEPCU = max(STEPCU,1)<a name='3603'>
<a name='3604'>
<font color=#447700>!-- initialization<a name='3605'></font>
<a name='3606'>
   IF(start_of_simulation)THEN<a name='3607'>
     DO j=jts,jtf<a name='3608'>
     DO i=its,itf<a name='3609'>
        RAINC(i,j)=0.<a name='3610'>
        RAINCV(i,j)=0.<a name='3611'>
     ENDDO<a name='3612'>
     ENDDO<a name='3613'>
   ENDIF<a name='3614'>
<a name='3615'>
<font color=#447700>!-- independent shallow convection schemes<a name='3616'></font>
   shcu_select: SELECT CASE(config_flags%shcu_physics)<a name='3617'>
<a name='3618'>
   CASE (CAMUWSHCUSCHEME)<a name='3619'>
      CALL <A href='../../html_code/phys/module_shcu_camuwshcu.F.html#INIT_UWSHCU'>init_uwshcu</A><A href='../../html_code/phys/module_physics_init.F.html#SHCU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INIT_UWSHCU_1">(r8,latvap,cpair,latice,zvir,rair,gravit,      &amp;<a name='3620'>
           mwh2o/mwdry,                                              &amp;<a name='3621'>
           rushten, rvshten, rthshten, rqvshten,                     &amp;<a name='3622'>
           rqcshten, rqrshten, rqishten, rqsshten, rqgshten,         &amp;<a name='3623'>
           p_qc, p_qr, p_qi, p_qs, p_qg,                             &amp;<a name='3624'>
           config_flags%bl_pbl_physics, param_first_scalar, restart, &amp;<a name='3625'>
           ids, ide, jds, jde, kds, kde,                             &amp;<a name='3626'>
           ims, ime, jms, jme, kms, kme,                             &amp;<a name='3627'>
           its, ite, jts, jte, kts, kte                              )<a name='3628'>
<a name='3629'>
   CASE (GRIMSSHCUSCHEME)<a name='3630'>
      CALL <A href='../../html_code/phys/module_shcu_grims.F.html#GRIMSINIT'>grimsinit</A><A href='../../html_code/phys/module_physics_init.F.html#SHCU_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GRIMSINIT_1">(rthshten,rqvshten,                              &amp;<a name='3631'>
           restart,                                                  &amp;<a name='3632'>
           ids, ide, jds, jde, kds, kde,                             &amp;<a name='3633'>
           ims, ime, jms, jme, kms, kme,                             &amp;<a name='3634'>
           its, ite, jts, jte, kts, kte                              )<a name='3635'>
 <a name='3636'>
   CASE DEFAULT<a name='3637'>
<a name='3638'>
   END SELECT shcu_select<a name='3639'>
<a name='3640'>
   END SUBROUTINE shcu_init<a name='3641'>
<a name='3642'>
<font color=#447700>!==================================================================<a name='3643'></font>
<A NAME='MP_INIT'><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3644'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>mp_init</font>(RAINNC,SNOWNC,GRAUPELNC,config_flags,restart,warm_rain,      &amp; <A href='../../call_to/MP_INIT.html' TARGET='index'>1</A>,<A href='../../call_from/MP_INIT.html' TARGET='index'>38</A><a name='3645'>
                      adv_moist_cond,                             &amp;<a name='3646'>
                      MPDT, DT, DX, DY, LOWLYR,                   &amp; <font color=#447700>! for eta mp<a name='3647'></font>
                      F_ICE_PHY,F_RAIN_PHY,F_RIMEF_PHY,           &amp; <font color=#447700>! for eta mp<a name='3648'></font>
                      mp_restart_state,tbpvs_state,tbpvs0_state,   &amp; <font color=#447700>! eta mp<a name='3649'></font>
                      allowed_to_read, start_of_simulation,       &amp;<a name='3650'>
<font color=#447700>!CAMMGMP specific variables<a name='3651'></font>
                      ixcldliq, ixcldice, ixnumliq, ixnumice,     &amp;       <a name='3652'>
                      nssl_cccn, nssl_alphah, nssl_alphahl,       &amp;<a name='3653'>
                      nssl_ipelec, nssl_isaund,                  &amp;<a name='3654'>
                         nssl_cnoh, nssl_cnohl,                  &amp;<a name='3655'>
                         nssl_cnor, nssl_cnos,                   &amp;<a name='3656'>
                         nssl_rho_qh, nssl_rho_qhl,              &amp;<a name='3657'>
                         nssl_rho_qs,                            &amp;<a name='3658'>
                      ccn_conc,                                  &amp; <font color=#447700>! RAS<a name='3659'></font>
                      z_at_q, qnwfa2d, scalar, num_sc,        &amp;  <font color=#447700>! G. Thompson<a name='3660'></font>
                      ids, ide, jds, jde, kds, kde,               &amp;<a name='3661'>
                      ims, ime, jms, jme, kms, kme,               &amp;<a name='3662'>
                      its, ite, jts, jte, kts, kte                )<a name='3663'>
<font color=#447700>!------------------------------------------------------------------<a name='3664'></font>
   USE <A href='../../html_code/phys/module_mp_wsm3_accel.F.html#MODULE_MP_WSM3'>module_mp_wsm3</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_WSM3_2"><a name='3665'>
   USE <A href='../../html_code/phys/module_mp_wsm5_accel.F.html#MODULE_MP_WSM5'>module_mp_wsm5</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_WSM5_2"><a name='3666'>
   USE <A href='../../html_code/phys/module_mp_wsm6.F.html#MODULE_MP_WSM6'>module_mp_wsm6</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_WSM6_2"><a name='3667'>
   USE <A href='../../html_code/phys/module_mp_etanew.F.html#MODULE_MP_ETANEW'>module_mp_etanew</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_ETANEW_4"><a name='3668'>
   USE <A href='../../html_code/phys/module_mp_fer_hires.F.html#MODULE_MP_FER_HIRES'>module_mp_fer_hires</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_FER_HIRES_2"><a name='3669'>
#if (NMM_CORE == 1)<a name='3670'>
   USE <A href='../../html_code/phys/module_mp_HWRF.F.html#MODULE_MP_HWRF'>module_mp_HWRF</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_HWRF_2"><a name='3671'>
#endif<a name='3672'>
   USE <A href='../../html_code/phys/module_mp_thompson.F.html#MODULE_MP_THOMPSON'>module_mp_thompson</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_THOMPSON_2"><a name='3673'>
   USE <A href='../../html_code/phys/module_mp_full_sbm.F.html#MODULE_MP_FULL_SBM'>module_mp_full_sbm</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_FULL_SBM_2"><a name='3674'>
   USE <A href='../../html_code/phys/module_mp_fast_sbm.F.html#MODULE_MP_FAST_SBM'>module_mp_fast_sbm</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_FAST_SBM_2"><a name='3675'>
   USE <A href='../../html_code/phys/module_mp_morr_two_moment.F.html#MODULE_MP_MORR_TWO_MOMENT'>module_mp_morr_two_moment</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_MORR_TWO_MOMENT_2"><a name='3676'>
   USE <A href='../../html_code/phys/module_mp_p3.F.html#MODULE_MP_P3'>module_mp_p3</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_P3_2"><a name='3677'>
   USE <A href='../../html_code/phys/module_mp_milbrandt2mom.F.html#MODULE_MP_MILBRANDT2MOM'>module_mp_milbrandt2mom</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_MILBRANDT2MOM_2"><a name='3678'>
<font color=#447700>!  USE module_mp_milbrandt3mom<a name='3679'></font>
   USE <A href='../../html_code/phys/module_mp_wdm5.F.html#MODULE_MP_WDM5'>module_mp_wdm5</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_WDM5_2"><a name='3680'>
   USE <A href='../../html_code/phys/module_mp_wdm6.F.html#MODULE_MP_WDM6'>module_mp_wdm6</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_WDM6_2"><a name='3681'>
   USE <A href='../../html_code/phys/module_mp_nssl_2mom.F.html#MODULE_MP_NSSL_2MOM'>module_mp_nssl_2mom</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_NSSL_2MOM_2"><a name='3682'>
#if (EM_CORE==1)<a name='3683'>
   USE <A href='../../html_code/phys/module_mp_cammgmp_driver.F.html#MODULE_MP_CAMMGMP_DRIVER'>module_mp_cammgmp_driver</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MP_CAMMGMP_DRIVER_3">, ONLY:CAMMGMP_INIT <font color=#447700>!CAM5's microphysics<a name='3684'></font>
#endif<a name='3685'>
<font color=#447700>!------------------------------------------------------------------<a name='3686'></font>
   IMPLICIT NONE<a name='3687'>
<font color=#447700>!------------------------------------------------------------------<a name='3688'></font>
<font color=#447700>! Arguments<a name='3689'></font>
   TYPE (grid_config_rec_type) ::     config_flags<a name='3690'>
   LOGICAL , INTENT(IN)        :: restart<a name='3691'>
   LOGICAL , INTENT(OUT)       :: warm_rain,adv_moist_cond<a name='3692'>
   REAL    , INTENT(IN)        :: MPDT, DT, DX, DY<a name='3693'>
   REAL, INTENT(IN), OPTIONAL  :: nssl_cccn, nssl_alphah, nssl_alphahl, &amp;<a name='3694'>
                                  nssl_cnoh, nssl_cnohl,                  &amp;<a name='3695'>
                                  nssl_cnor, nssl_cnos,                   &amp;<a name='3696'>
                                  nssl_rho_qh, nssl_rho_qhl,              &amp;<a name='3697'>
                                  nssl_rho_qs<a name='3698'>
   INTEGER, INTENT(IN), OPTIONAL  :: nssl_ipelec, nssl_isaund<a name='3699'>
<a name='3700'>
   LOGICAL , INTENT(IN)        :: start_of_simulation<a name='3701'>
   INTEGER , INTENT(IN)        :: ixcldliq, ixcldice, ixnumliq, ixnumice <font color=#447700>! CAMMGMP specific variables<a name='3702'></font>
<a name='3703'>
   INTEGER , INTENT(IN)        :: ids, ide, jds, jde, kds, kde,   &amp;<a name='3704'>
                                  ims, ime, jms, jme, kms, kme,   &amp;<a name='3705'>
                                  its, ite, jts, jte, kts, kte<a name='3706'>
<a name='3707'>
   INTEGER , DIMENSION( ims:ime , jms:jme ) ,INTENT(INOUT)  :: LOWLYR<a name='3708'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT) :: RAINNC,SNOWNC,GRAUPELNC<a name='3709'>
   REAL,     DIMENSION( ims:ime , kms:kme, jms:jme ) , INTENT(INOUT) :: &amp;<a name='3710'>
                                  F_ICE_PHY,F_RAIN_PHY,F_RIMEF_PHY<a name='3711'>
   REAL , DIMENSION(:) ,INTENT(INOUT)  :: mp_restart_state,tbpvs_state,tbpvs0_state<a name='3712'>
   LOGICAL , INTENT(IN)  :: allowed_to_read<a name='3713'>
   REAL, INTENT(INOUT) :: ccn_conc <font color=#447700>! RAS<a name='3714'></font>
   REAL, DIMENSION(ims:ime,jms:jme), INTENT(INOUT):: qnwfa2d                       <font color=#447700>!  G. Thompson<a name='3715'></font>
   REAL, DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(IN):: z_at_q                   <font color=#447700>!  G. Thompson<a name='3716'></font>
   INTEGER, INTENT(IN) :: num_sc                                               <font color=#447700>!  G. Thompson<a name='3717'></font>
   REAL, DIMENSION(ims:ime,kms:kme,jms:jme, num_sc), INTENT(INOUT):: scalar    <font color=#447700>!  G. Thompson<a name='3718'></font>
<a name='3719'>
<font color=#447700>! Local<a name='3720'></font>
   INTEGER :: i, j, itf, jtf<a name='3721'>
   REAL, DIMENSION(20) :: nssl_params<a name='3722'>
   INTEGER    :: nssl_ipelec_tmp<a name='3723'>
<a name='3724'>
   warm_rain = .false.<a name='3725'>
   adv_moist_cond = .true.<a name='3726'>
   itf=min0(ite,ide-1)<a name='3727'>
   jtf=min0(jte,jde-1)<a name='3728'>
<a name='3729'>
   IF(start_of_simulation)THEN<a name='3730'>
     DO j=jts,jtf<a name='3731'>
     DO i=its,itf<a name='3732'>
        RAINNC(i,j) = 0.<a name='3733'>
        SNOWNC(i,j) = 0.<a name='3734'>
        GRAUPELNC(i,j) = 0.<a name='3735'>
     ENDDO<a name='3736'>
     ENDDO<a name='3737'>
   ENDIF<a name='3738'>
   <a name='3739'>
   IF ( present( nssl_cccn ) ) THEN<a name='3740'>
     SELECT CASE(config_flags%mp_physics)<a name='3741'>
     CASE (NSSL_2MOM,NSSL_2MOMCCN)<a name='3742'>
       IF ( config_flags%elec_physics &gt; 0 ) THEN<a name='3743'>
         nssl_ipelec_tmp = nssl_ipelec<a name='3744'>
       ELSE<a name='3745'>
         nssl_ipelec_tmp = 0.0<a name='3746'>
       ENDIF<a name='3747'>
     CASE DEFAULT<a name='3748'>
       nssl_ipelec_tmp = 0.0<a name='3749'>
     END SELECT<a name='3750'>
     <a name='3751'>
     nssl_params(1)  = nssl_cccn<a name='3752'>
     nssl_params(2)  = nssl_alphah<a name='3753'>
     nssl_params(3)  = nssl_alphahl<a name='3754'>
     nssl_params(4)  = nssl_cnoh<a name='3755'>
     nssl_params(5)  = nssl_cnohl<a name='3756'>
     nssl_params(6)  = nssl_cnor<a name='3757'>
     nssl_params(7)  = nssl_cnos<a name='3758'>
     nssl_params(8)  = nssl_rho_qh<a name='3759'>
     nssl_params(9)  = nssl_rho_qhl<a name='3760'>
     nssl_params(10) = nssl_rho_qs<a name='3761'>
     nssl_params(11) = nssl_ipelec_tmp<a name='3762'>
     nssl_params(12) = nssl_isaund<a name='3763'>
<a name='3764'>
   ENDIF<a name='3765'>
<a name='3766'>
   mp_select: SELECT CASE(config_flags%mp_physics)<a name='3767'>
<a name='3768'>
     CASE (KESSLERSCHEME)<a name='3769'>
          warm_rain = .true.<a name='3770'>
     CASE (WSM3SCHEME)<a name='3771'>
          CALL <A href='../../html_code/phys/module_mp_wsm3_accel.F.html#WSM3INIT'>wsm3init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WSM3INIT_1">(rhoair0,rhowater,rhosnow,cliq,cpv, allowed_to_read )<a name='3772'>
     CASE (WSM5SCHEME)<a name='3773'>
          CALL <A href='../../html_code/phys/module_mp_wsm5_accel.F.html#WSM5INIT'>wsm5init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WSM5INIT_1">(rhoair0,rhowater,rhosnow,cliq,cpv, allowed_to_read )<a name='3774'>
     CASE (WSM6SCHEME)<a name='3775'>
          CALL <A href='../../html_code/phys/module_mp_wsm6.F.html#WSM6INIT'>wsm6init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WSM6INIT_1">(rhoair0,rhowater,rhosnow,cliq,cpv, config_flags%hail_opt,allowed_to_read )<a name='3776'>
     CASE (ETAMPNEW)<a name='3777'>
         adv_moist_cond = .false.<a name='3778'>
         CALL <A href='../../html_code/phys/module_mp_etanew.F.html#ETANEWINIT'>etanewinit</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ETANEWINIT_1"> (MPDT,DT,DX,DY,LOWLYR,restart,           &amp;<a name='3779'>
                          F_ICE_PHY,F_RAIN_PHY,F_RIMEF_PHY,       &amp;<a name='3780'>
                          mp_restart_state,tbpvs_state,tbpvs0_state,&amp;<a name='3781'>
                          allowed_to_read,                        &amp;<a name='3782'>
                          ids, ide, jds, jde, kds, kde,           &amp;<a name='3783'>
                          ims, ime, jms, jme, kms, kme,           &amp;<a name='3784'>
                          its, ite, jts, jte, kts, kte            )<a name='3785'>
     CASE (FER_MP_HIRES,FER_MP_HIRES_ADVECT)<a name='3786'>
               CALL <A href='../../html_code/phys/module_mp_fer_hires.F.html#FER_HIRES_INIT'>fer_hires_init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FER_HIRES_INIT_1"> (MPDT,DT,DX,DY,LOWLYR,restart,         &amp;<a name='3787'>
                            allowed_to_read,                        &amp;<a name='3788'>
                            ids, ide, jds, jde, kds, kde,           &amp;<a name='3789'>
                            ims, ime, jms, jme, kms, kme,           &amp;<a name='3790'>
                            its, ite, jts, jte, kts, kte,           &amp;<a name='3791'>
                            F_ICE_PHY,F_RAIN_PHY,F_RIMEF_PHY)<a name='3792'>
#if(NMM_CORE==1)<a name='3793'>
     CASE (etamp_HWRF)<a name='3794'>
         CALL <A href='../../html_code/phys/module_mp_HWRF.F.html#ETANEWINIT_HWRF'>etanewinit_HWRF</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ETANEWINIT_HWRF_1"> (MPDT,DT,DX,DY,LOWLYR,restart,           &amp;<a name='3795'>
                          F_ICE_PHY,F_RAIN_PHY,F_RIMEF_PHY,       &amp;<a name='3796'>
                          allowed_to_read,                        &amp;<a name='3797'>
                          ids, ide, jds, jde, kds, kde,           &amp;<a name='3798'>
                          ims, ime, jms, jme, kms, kme,           &amp;<a name='3799'>
                          its, ite, jts, jte, kts, kte            )<a name='3800'>
#endif <a name='3801'>
     CASE (THOMPSON)<a name='3802'>
         IF(start_of_simulation.or.restart.or.config_flags%cycling)     &amp;<a name='3803'>
            CALL <A href='../../html_code/phys/module_mp_thompson.F.html#THOMPSON_INIT'>thompson_init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="THOMPSON_INIT_1">(HGT=z_at_q,                              &amp;<a name='3804'>
                          IDS=ids, IDE=ide, JDS=jds, JDE=jde, KDS=kds, KDE=kde,   &amp;<a name='3805'>
                          IMS=ims, IME=ime, JMS=jms, JME=jme, KMS=kms, KME=kme,   &amp;<a name='3806'>
                          ITS=its, ITE=ite, JTS=jts, JTE=jte, KTS=kts, KTE=kte)<a name='3807'>
<a name='3808'>
     CASE (THOMPSONAERO)<a name='3809'>
<font color=#447700>! Cycling the WRF forecast with moving nests will cause this initialization to be<a name='3810'></font>
<font color=#447700>! called for each nest move. This is potentially very computationally expensive.<a name='3811'></font>
         IF(start_of_simulation.or.restart.or.config_flags%cycling)     &amp;<a name='3812'>
            CALL <A href='../../html_code/phys/module_mp_thompson.F.html#THOMPSON_INIT'>thompson_init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="THOMPSON_INIT_2">(HGT=z_at_q,                              &amp;<a name='3813'>
                          NWFA2D=qnwfa2d,                               &amp;<a name='3814'>
                          NWFA=scalar(ims,kms,jms,P_QNWFA),             &amp;<a name='3815'>
                          NIFA=scalar(ims,kms,jms,P_QNIFA),             &amp;<a name='3816'>
                          DX=DX, DY=DY,                                 &amp;<a name='3817'>
                          is_start=start_of_simulation,                 &amp;<a name='3818'>
                          IDS=ids, IDE=ide, JDS=jds, JDE=jde, KDS=kds, KDE=kde,   &amp;<a name='3819'>
                          IMS=ims, IME=ime, JMS=jms, JME=jme, KMS=kms, KME=kme,   &amp;<a name='3820'>
                          ITS=its, ITE=ite, JTS=jts, JTE=jte, KTS=kts, KTE=kte)<a name='3821'>
<a name='3822'>
     CASE (MORR_TWO_MOMENT)<a name='3823'>
         CALL <A href='../../html_code/phys/module_mp_morr_two_moment.F.html#MORR_TWO_MOMENT_INIT'>morr_two_moment_init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MORR_TWO_MOMENT_INIT_1">( config_flags%hail_opt )<a name='3824'>
     CASE (P3_1CATEGORY)<a name='3825'>
         CALL <A href='../../html_code/phys/module_mp_p3.F.html#P3_INIT'>p3_init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="P3_INIT_1">('./p3_lookup_table_1.dat','./p3_lookup_table_2.dat',1)<a name='3826'>
     CASE (P3_1CATEGORY_NC)<a name='3827'>
         CALL <A href='../../html_code/phys/module_mp_p3.F.html#P3_INIT'>p3_init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="P3_INIT_2">('./p3_lookup_table_1.dat','./p3_lookup_table_2.dat',1)<a name='3828'>
     CASE (MILBRANDT2MOM)<a name='3829'>
         CALL <A href='../../html_code/phys/module_mp_milbrandt2mom.F.html#MILBRANDT2MOM_INIT'>milbrandt2mom_init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MILBRANDT2MOM_INIT_1"><a name='3830'>
<font color=#447700>!      CASE (MILBRANDT3MOM)<a name='3831'></font>
<font color=#447700>!          CALL milbrandt3mom_init<a name='3832'></font>
     CASE (WDM5SCHEME)<a name='3833'>
          CALL <A href='../../html_code/phys/module_mp_wdm5.F.html#WDM5INIT'>wdm5init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WDM5INIT_1">(rhoair0,rhowater,rhosnow,cliq,cpv,ccn_conc,allowed_to_read )<a name='3834'>
     CASE (WDM6SCHEME)<a name='3835'>
          CALL <A href='../../html_code/phys/module_mp_wdm6.F.html#WDM6INIT'>wdm6init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WDM6INIT_1">(rhoair0,rhowater,rhosnow,cliq,cpv,ccn_conc, &amp;<a name='3836'>
                        config_flags%hail_opt, allowed_to_read )<a name='3837'>
#if (EM_CORE==1)<a name='3838'>
    CASE (FULL_KHAIN_LYNN)<a name='3839'>
     IF(start_of_simulation.or.restart)THEN<a name='3840'>
          CALL <A href='../../html_code/phys/module_mp_full_sbm.F.html#FULL_HUCMINIT'>full_hucminit</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FULL_HUCMINIT_1">(dt)<a name='3841'>
     END IF<a name='3842'>
    CASE (FAST_KHAIN_LYNN)<a name='3843'>
     IF(start_of_simulation.or.restart)THEN<a name='3844'>
          CALL <A href='../../html_code/phys/module_mp_fast_sbm.F.html#FAST_HUCMINIT'>fast_hucminit</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FAST_HUCMINIT_1">(dt)<a name='3845'>
     END IF<a name='3846'>
#endif<a name='3847'>
     CASE (NSSL_1MOMLFO)<a name='3848'>
         CALL <A href='../../html_code/phys/module_mp_nssl_2mom.F.html#NSSL_2MOM_INIT'>nssl_2mom_init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NSSL_2MOM_INIT_1">(ims,ime, jms,jme, kms,kme,nssl_params,ipctmp=0,mixphase=0,ihvol=-1) <font color=#447700>! no separate hail<a name='3849'></font>
     CASE (NSSL_1MOM)<a name='3850'>
         CALL <A href='../../html_code/phys/module_mp_nssl_2mom.F.html#NSSL_2MOM_INIT'>nssl_2mom_init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NSSL_2MOM_INIT_2">(ims,ime, jms,jme, kms,kme,nssl_params,ipctmp=0,mixphase=0,ihvol=0)<a name='3851'>
     CASE (NSSL_2MOM)<a name='3852'>
         CALL <A href='../../html_code/phys/module_mp_nssl_2mom.F.html#NSSL_2MOM_INIT'>nssl_2mom_init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NSSL_2MOM_INIT_3">(ims,ime, jms,jme, kms,kme,nssl_params,ipctmp=5,mixphase=0,ihvol=1)<a name='3853'>
     CASE (NSSL_2MOMG)<a name='3854'>
         CALL <A href='../../html_code/phys/module_mp_nssl_2mom.F.html#NSSL_2MOM_INIT'>nssl_2mom_init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NSSL_2MOM_INIT_4">(ims,ime, jms,jme, kms,kme,nssl_params,ipctmp=5,mixphase=0,ihvol=-1) <font color=#447700>! turn off hail<a name='3855'></font>
     CASE (NSSL_2MOMCCN)<a name='3856'>
         ccn_conc = nssl_cccn/1.225 <font color=#447700>! set this to have correct boundary conditions<a name='3857'></font>
         CALL <A href='../../html_code/phys/module_mp_nssl_2mom.F.html#NSSL_2MOM_INIT'>nssl_2mom_init</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NSSL_2MOM_INIT_5">(ims,ime, jms,jme, kms,kme,nssl_params,ipctmp=5,mixphase=0,ihvol=1)<a name='3858'>
#if (EM_CORE==1)<a name='3859'>
     CASE (CAMMGMPSCHEME) <font color=#447700>! CAM5's microphysics<a name='3860'></font>
          CALL <A href='../../html_code/phys/module_mp_cammgmp_driver.F.html#CAMMGMP_INIT'>CAMMGMP_INIT</A><A href='../../html_code/phys/module_physics_init.F.html#MP_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CAMMGMP_INIT_1">(ixcldliq, ixcldice, ixnumliq, ixnumice &amp;<a name='3861'>
             ,config_flags%chem_opt                          &amp;<a name='3862'>
             ,ids, ide, jds, jde, kds, kde                   &amp; <a name='3863'>
             ,ims, ime, jms, jme, kms, kme                   &amp;<a name='3864'>
             ,its, ite, jts, jte, kts, kte                   )<a name='3865'>
#endif<a name='3866'>
<a name='3867'>
     CASE DEFAULT<a name='3868'>
<a name='3869'>
   END SELECT mp_select<a name='3870'>
<a name='3871'>
   END SUBROUTINE mp_init<a name='3872'>
<a name='3873'>
#if  ( EM_CORE == 1 )<a name='3874'>
<font color=#447700>!==========================================================<a name='3875'></font>
<A NAME='FG_INIT'><A href='../../html_code/phys/module_physics_init.F.html#FG_INIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3876'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>fg_init</font>(STEPFG,FGDT,DT,id,RUNDGDTEN,RVNDGDTEN,    &amp; <A href='../../call_to/FG_INIT.html' TARGET='index'>1</A>,<A href='../../call_from/FG_INIT.html' TARGET='index'>4</A><a name='3877'>
                RTHNDGDTEN,RPHNDGDTEN,RQVNDGDTEN,RMUNDGDTEN,    &amp;<a name='3878'>
                SDA_HFX, SDA_QFX, QNORM, HFX_BOTH, QFX_BOTH,    &amp; <font color=#447700>! fasdas<a name='3879'></font>
                HFX_FDDA,                                       &amp; <font color=#447700>! fasdas<a name='3880'></font>
                config_flags,restart,                           &amp;<a name='3881'>
                allowed_to_read ,                               &amp;<a name='3882'>
                ids, ide, jds, jde, kds, kde,                   &amp;<a name='3883'>
                ims, ime, jms, jme, kms, kme,                   &amp;<a name='3884'>
                its, ite, jts, jte, kts, kte                    )<a name='3885'>
<a name='3886'>
<a name='3887'>
<font color=#447700>!--------------------------------------------------------------------<a name='3888'></font>
   USE <A href='../../html_code/phys/module_fdda_psufddagd.F.html#MODULE_FDDA_PSUFDDAGD'>module_fdda_psufddagd</A><A href='../../html_code/phys/module_physics_init.F.html#FG_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_FDDA_PSUFDDAGD_2"><a name='3889'>
   USE <A href='../../html_code/phys/module_fdda_spnudging.F.html#MODULE_FDDA_SPNUDGING'>module_fdda_spnudging</A><A href='../../html_code/phys/module_physics_init.F.html#FG_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_FDDA_SPNUDGING_2">, ONLY : fddaspnudginginit<a name='3890'>
<font color=#447700>!--------------------------------------------------------------------<a name='3891'></font>
   IMPLICIT NONE<a name='3892'>
<font color=#447700>!--------------------------------------------------------------------<a name='3893'></font>
   TYPE (grid_config_rec_type) ::     config_flags<a name='3894'>
   LOGICAL , INTENT(IN)        :: restart<a name='3895'>
<a name='3896'>
   INTEGER , INTENT(IN)        ::     ids, ide, jds, jde, kds, kde, &amp;<a name='3897'>
                                      ims, ime, jms, jme, kms, kme, &amp;<a name='3898'>
                                      its, ite, jts, jte, kts, kte<a name='3899'>
<a name='3900'>
   REAL ,    INTENT(IN)        ::     DT, FGDT<a name='3901'>
   INTEGER , INTENT(IN)        ::     id<a name='3902'>
   INTEGER , INTENT(INOUT)     ::     STEPFG<a name='3903'>
   REAL,     DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) ::       &amp;<font color=#447700>!BSINGH(PNNL)- should be declared inout<a name='3904'></font>
                                                           RUNDGDTEN, &amp;<a name='3905'>
                                                           RVNDGDTEN, &amp;<a name='3906'>
                                                          RTHNDGDTEN, &amp;<a name='3907'>
                                                          RPHNDGDTEN, &amp;<a name='3908'>
                                                          RQVNDGDTEN<a name='3909'>
<font color=#447700>!<a name='3910'></font>
<font color=#447700>! FASDAS<a name='3911'></font>
<font color=#447700>!<a name='3912'></font>
   REAL ,    DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT)           ::    &amp;<a name='3913'>
                                                             SDA_HFX, &amp;<a name='3914'>
                                                             SDA_QFX, &amp;<a name='3915'>
                                                             QNORM,HFX_BOTH,QFX_BOTH<a name='3916'>
<font color=#447700>!  INTEGER , INTENT(IN   )                                  ::  fasdas<a name='3917'></font>
   REAL ,    DIMENSION( ims:ime , kms:kme , jms:jme ) , INTENT(INOUT) :: &amp;<a name='3918'>
                                                            HFX_FDDA<a name='3919'>
<a name='3920'>
   REAL,     DIMENSION( ims:ime , jms:jme ) , INTENT(INOUT) :: RMUNDGDTEN <font color=#447700>!BSINGH(PNNL)- should be declared inout<a name='3921'></font>
<a name='3922'>
   LOGICAL,  INTENT(IN)           :: allowed_to_read<a name='3923'>
<font color=#447700>!--------------------------------------------------------------------<a name='3924'></font>
<a name='3925'>
<font color=#447700>!-- calculate pbl time step<a name='3926'></font>
<a name='3927'>
   STEPFG = nint(FGDT*60./DT)<a name='3928'>
   STEPFG = max(STEPFG,1)<a name='3929'>
<a name='3930'>
<a name='3931'>
<font color=#447700>!-- initialize fdda scheme<a name='3932'></font>
<a name='3933'>
   fdda_select: SELECT CASE(config_flags%grid_fdda)<a name='3934'>
<a name='3935'>
      CASE (PSUFDDAGD)<a name='3936'>
           CALL <A href='../../html_code/phys/module_fdda_psufddagd.F.html#FDDAGDINIT'>fddagdinit</A><A href='../../html_code/phys/module_physics_init.F.html#FG_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FDDAGDINIT_1">(id,rundgdten,rvndgdten,rthndgdten,rqvndgdten,rmundgdten,&amp;<a name='3937'>
               SDA_HFX, SDA_QFX, QNORM, HFX_BOTH, QFX_BOTH, config_flags%fasdas,&amp; <font color=#447700>! fasdas<a name='3938'></font>
               HFX_FDDA,                                                        &amp; <font color=#447700>! fasdas<a name='3939'></font>
               config_flags%run_hours, &amp;<a name='3940'>
               config_flags%if_no_pbl_nudging_uv, &amp;<a name='3941'>
               config_flags%if_no_pbl_nudging_t, &amp;<a name='3942'>
               config_flags%if_no_pbl_nudging_q, &amp;<a name='3943'>
               config_flags%if_zfac_uv, &amp;<a name='3944'>
               config_flags%k_zfac_uv, &amp;<a name='3945'>
               config_flags%if_zfac_t, &amp;<a name='3946'>
               config_flags%k_zfac_t, &amp;<a name='3947'>
               config_flags%if_zfac_q, &amp;<a name='3948'>
               config_flags%k_zfac_q, &amp;<a name='3949'>
               config_flags%guv, &amp;<a name='3950'>
               config_flags%gt, config_flags%gq, &amp;<a name='3951'>
               config_flags%if_ramping, config_flags%dtramp_min, &amp;<a name='3952'>
               config_flags%auxinput10_end_h, &amp;<a name='3953'>
               config_flags%grid_sfdda, &amp;<a name='3954'>
               config_flags%guv_sfc, &amp;<a name='3955'>
               config_flags%gt_sfc, &amp;<a name='3956'>
               config_flags%gq_sfc, &amp;<a name='3957'>
                      restart, allowed_to_read,                    &amp;<a name='3958'>
                      ids, ide, jds, jde, kds, kde,                &amp;<a name='3959'>
                      ims, ime, jms, jme, kms, kme,                &amp;<a name='3960'>
                      its, ite, jts, jte, kts, kte                 )<a name='3961'>
<a name='3962'>
      CASE (SPNUDGING)<a name='3963'>
           CALL <A href='../../html_code/phys/module_fdda_spnudging.F.html#FDDASPNUDGINGINIT'>fddaspnudginginit</A><A href='../../html_code/phys/module_physics_init.F.html#FG_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FDDASPNUDGINGINIT_1">(id,rundgdten,rvndgdten,rthndgdten,rphndgdten,&amp;<a name='3964'>
               config_flags%run_hours, &amp;<a name='3965'>
               config_flags%if_no_pbl_nudging_uv, &amp;<a name='3966'>
               config_flags%if_no_pbl_nudging_t, &amp;<a name='3967'>
               config_flags%if_no_pbl_nudging_ph, &amp;<a name='3968'>
               config_flags%if_zfac_uv, &amp;<a name='3969'>
               config_flags%k_zfac_uv, &amp;<a name='3970'>
               config_flags%dk_zfac_uv, &amp;<a name='3971'>
               config_flags%if_zfac_t, &amp;<a name='3972'>
               config_flags%k_zfac_t, &amp;<a name='3973'>
               config_flags%dk_zfac_t, &amp;<a name='3974'>
               config_flags%if_zfac_ph, &amp;<a name='3975'>
               config_flags%k_zfac_ph, &amp;<a name='3976'>
               config_flags%dk_zfac_ph, &amp;<a name='3977'>
               config_flags%guv, &amp;<a name='3978'>
               config_flags%gt, config_flags%gph, &amp;<a name='3979'>
               config_flags%if_ramping, config_flags%dtramp_min, &amp;<a name='3980'>
               config_flags%auxinput9_end_h, &amp;<a name='3981'>
               config_flags%xwavenum,config_flags%ywavenum, &amp;<a name='3982'>
                      restart, allowed_to_read,                    &amp;<a name='3983'>
                      ids, ide, jds, jde, kds, kde,                &amp;<a name='3984'>
                      ims, ime, jms, jme, kms, kme,                &amp;<a name='3985'>
                      its, ite, jts, jte, kts, kte                 )<a name='3986'>
<a name='3987'>
      CASE DEFAULT<a name='3988'>
<a name='3989'>
   END SELECT fdda_select<a name='3990'>
<a name='3991'>
   END SUBROUTINE fg_init<a name='3992'>
<a name='3993'>
<font color=#447700>!-------------------------------------------------------------------<a name='3994'></font>
<A NAME='FDOB_INIT'><A href='../../html_code/phys/module_physics_init.F.html#FDOB_INIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3995'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>fdob_init</font>(obs_nudge_opt, maxdom, inest, parid,       &amp; <A href='../../call_to/FDOB_INIT.html' TARGET='index'>1</A>,<A href='../../call_from/FDOB_INIT.html' TARGET='index'>4</A><a name='3996'>
                        idynin, dtramp, fdaend, restart,           &amp;<a name='3997'>
                        obs_twindo_cg, obs_twindo, itimestep,      &amp;<a name='3998'>
                        no_pbl_nudge_uv,                           &amp;<a name='3999'>
                        no_pbl_nudge_t,                            &amp;<a name='4000'>
                        no_pbl_nudge_q,                            &amp;<a name='4001'>
                        sfc_scheme_horiz, sfc_scheme_vert,         &amp;<a name='4002'>
                        maxsnd_gap,                                &amp;<a name='4003'>
                        sfcfact, sfcfacr, dpsmx,                   &amp;<a name='4004'>
                        nudge_wind, nudge_temp, nudge_mois,        &amp;<a name='4005'>
                        nudgezfullr1_uv, nudgezrampr1_uv,          &amp;<a name='4006'>
                        nudgezfullr2_uv, nudgezrampr2_uv,          &amp;<a name='4007'>
                        nudgezfullr4_uv, nudgezrampr4_uv,          &amp;<a name='4008'>
                        nudgezfullr1_t,  nudgezrampr1_t,           &amp;<a name='4009'>
                        nudgezfullr2_t,  nudgezrampr2_t,           &amp;<a name='4010'>
                        nudgezfullr4_t,  nudgezrampr4_t,           &amp;<a name='4011'>
                        nudgezfullr1_q,  nudgezrampr1_q,           &amp;<a name='4012'>
                        nudgezfullr2_q,  nudgezrampr2_q,           &amp;<a name='4013'>
                        nudgezfullr4_q,  nudgezrampr4_q,           &amp;<a name='4014'>
                        nudgezfullmin, nudgezrampmin, nudgezmax,   &amp;<a name='4015'>
                        xlat, xlong,                               &amp;<a name='4016'>
                        start_year, start_month, start_day,        &amp;<a name='4017'>
                        start_hour, start_minute, start_second,    &amp;<a name='4018'>
                        p00, t00, tlp,                             &amp;<a name='4019'>
                        znu, p_top,                                &amp;<a name='4020'>
                        fdob, ipf_init,                            &amp;<a name='4021'>
                        ids, ide, jds, jde, kds, kde,              &amp;<a name='4022'>
                        ims, ime, jms, jme, kms, kme,              &amp;<a name='4023'>
                        its, ite, jts, jte, kts, kte               )<a name='4024'>
<a name='4025'>
<font color=#447700>!--------------------------------------------------------------------<a name='4026'></font>
   USE <A href='../../html_code/frame/module_domain.F.html#MODULE_DOMAIN'>module_domain</A><A href='../../html_code/phys/module_physics_init.F.html#FDOB_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DOMAIN_246"><a name='4027'>
   USE <A href='../../html_code/phys/module_fddaobs_rtfdda.F.html#MODULE_FDDAOBS_RTFDDA'>module_fddaobs_rtfdda</A><A href='../../html_code/phys/module_physics_init.F.html#FDOB_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_FDDAOBS_RTFDDA_3"><a name='4028'>
   USE <A href='../../html_code/share/module_llxy.F.html#MODULE_LLXY'>module_llxy</A><A href='../../html_code/phys/module_physics_init.F.html#FDOB_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_LLXY_6"><a name='4029'>
<font color=#447700>!--------------------------------------------------------------------<a name='4030'></font>
   IMPLICIT NONE<a name='4031'>
<font color=#447700>!--------------------------------------------------------------------<a name='4032'></font>
   INTEGER , INTENT(IN)    :: maxdom<a name='4033'>
   INTEGER , INTENT(IN)    :: obs_nudge_opt(maxdom)<a name='4034'>
   INTEGER , INTENT(IN)    :: ids,ide, jds,jde, kds,kde,           &amp;<a name='4035'>
                              ims,ime, jms,jme, kms,kme,           &amp;<a name='4036'>
                              its,ite, jts,jte, kts,kte<a name='4037'>
   INTEGER , INTENT(IN)    :: inest<a name='4038'>
   INTEGER , INTENT(IN)    :: parid(maxdom)<a name='4039'>
   INTEGER , INTENT(IN)    :: idynin          <font color=#447700>! flag for dynamic initialization<a name='4040'></font>
   REAL    , INTENT(IN)    :: dtramp          <font color=#447700>! time period for ramping (idynin)<a name='4041'></font>
   REAL    , INTENT(IN)    :: fdaend(maxdom)  <font color=#447700>! nudging end time for domain (min)<a name='4042'></font>
   LOGICAL , INTENT(IN)    :: restart<a name='4043'>
   REAL    , INTENT(IN)    :: obs_twindo_cg   <font color=#447700>! twindo on course grid<a name='4044'></font>
   REAL    , INTENT(IN)    :: obs_twindo<a name='4045'>
   INTEGER , INTENT(IN)    :: itimestep<a name='4046'>
   INTEGER , INTENT(IN)    :: no_pbl_nudge_uv(maxdom)  <font color=#447700>! flags for no wind nudging in pbl<a name='4047'></font>
   INTEGER , INTENT(IN)    :: no_pbl_nudge_t(maxdom)   <font color=#447700>! flags for no temperature nudging in pbl<a name='4048'></font>
   INTEGER , INTENT(IN)    :: no_pbl_nudge_q(maxdom)   <font color=#447700>! flags for no moisture nudging in pbl<a name='4049'></font>
   INTEGER , INTENT(IN)    :: sfc_scheme_horiz <font color=#447700>! horizontal spreading scheme for surf obs (wrf or orig mm5)<a name='4050'></font>
   INTEGER , INTENT(IN)    :: sfc_scheme_vert  <font color=#447700>! vertical   spreading scheme for surf obs (orig or regime vif)<a name='4051'></font>
   REAL    , INTENT(IN)    :: maxsnd_gap       <font color=#447700>! max allowed pressure gap in soundings for interp (centibars) <a name='4052'></font>
   REAL    , INTENT(IN)    :: sfcfact      <font color=#447700>! scale factor applied to time window for surface obs<a name='4053'></font>
   REAL    , INTENT(IN)    :: sfcfacr      <font color=#447700>! scale fac applied to horiz rad of infl for sfc obs<a name='4054'></font>
   REAL    , INTENT(IN)    :: dpsmx        <font color=#447700>! max pressure change allowed within horiz. infl. range<a name='4055'></font>
   INTEGER , INTENT(IN)    :: nudge_wind(maxdom)       <font color=#447700>! wind-nudging flag<a name='4056'></font>
   INTEGER , INTENT(IN)    :: nudge_temp(maxdom)       <font color=#447700>! temperature-nudging flag<a name='4057'></font>
   INTEGER , INTENT(IN)    :: nudge_mois(maxdom)       <font color=#447700>! moisture-nudging flag<a name='4058'></font>
   REAL    , INTENT(IN)    :: nudgezfullr1_uv  <font color=#447700>! vert infl fcn, regime=1 full-wt   hght, winds<a name='4059'></font>
   REAL    , INTENT(IN)    :: nudgezrampr1_uv  <font color=#447700>! vert infl fcn, regime=1 ramp down hght, winds<a name='4060'></font>
   REAL    , INTENT(IN)    :: nudgezfullr2_uv  <font color=#447700>! vert infl fcn, regime=2 full-wt   hght, winds<a name='4061'></font>
   REAL    , INTENT(IN)    :: nudgezrampr2_uv  <font color=#447700>! vert infl fcn, regime=2 ramp down hght, winds<a name='4062'></font>
   REAL    , INTENT(IN)    :: nudgezfullr4_uv  <font color=#447700>! vert infl fcn, regime=4 full-wt   hght, winds<a name='4063'></font>
   REAL    , INTENT(IN)    :: nudgezrampr4_uv  <font color=#447700>! vert infl fcn, regime=4 ramp down hght, winds<a name='4064'></font>
   REAL    , INTENT(IN)    :: nudgezfullr1_t   <font color=#447700>! vert infl fcn, regime=1 full-wt   hght, temp<a name='4065'></font>
   REAL    , INTENT(IN)    :: nudgezrampr1_t   <font color=#447700>! vert infl fcn, regime=1 ramp down hght, temp<a name='4066'></font>
   REAL    , INTENT(IN)    :: nudgezfullr2_t   <font color=#447700>! vert infl fcn, regime=2 full-wt   hght, temp<a name='4067'></font>
   REAL    , INTENT(IN)    :: nudgezrampr2_t   <font color=#447700>! vert infl fcn, regime=2 ramp down hght, temp<a name='4068'></font>
   REAL    , INTENT(IN)    :: nudgezfullr4_t   <font color=#447700>! vert infl fcn, regime=4 full-wt   hght, temp<a name='4069'></font>
   REAL    , INTENT(IN)    :: nudgezrampr4_t   <font color=#447700>! vert infl fcn, regime=4 ramp down hght, temp<a name='4070'></font>
   REAL    , INTENT(IN)    :: nudgezfullr1_q   <font color=#447700>! vert infl fcn, regime=1 full-wt   hght, mois<a name='4071'></font>
   REAL    , INTENT(IN)    :: nudgezrampr1_q   <font color=#447700>! vert infl fcn, regime=1 ramp down hght, mois<a name='4072'></font>
   REAL    , INTENT(IN)    :: nudgezfullr2_q   <font color=#447700>! vert infl fcn, regime=2 full-wt   hght, mois<a name='4073'></font>
   REAL    , INTENT(IN)    :: nudgezrampr2_q   <font color=#447700>! vert infl fcn, regime=2 ramp down hght, mois<a name='4074'></font>
   REAL    , INTENT(IN)    :: nudgezfullr4_q   <font color=#447700>! vert infl fcn, regime=4 full-wt   hght, mois<a name='4075'></font>
   REAL    , INTENT(IN)    :: nudgezrampr4_q   <font color=#447700>! vert infl fcn, regime=4 ramp down hght, mois<a name='4076'></font>
   REAL    , INTENT(IN)    :: nudgezfullmin    <font color=#447700>! min dpth thru which vert infl fcn remains 1.0 (m)<a name='4077'></font>
   REAL    , INTENT(IN)    :: nudgezrampmin    <font color=#447700>! min dpth thru which vif decreases 1.0 to 0.0 (m)<a name='4078'></font>
   REAL    , INTENT(IN)    :: nudgezmax        <font color=#447700>! max dpth in which vif is nonzero (m)<a name='4079'></font>
   REAL    , INTENT(IN)    :: xlat ( ims:ime, jms:jme )        <font color=#447700>! latitudes on mass-point grid<a name='4080'></font>
   REAL    , INTENT(IN)    :: xlong( ims:ime, jms:jme )        <font color=#447700>! longitudes on mass-point grid<a name='4081'></font>
   INTEGER , INTENT(INOUT) :: start_year<a name='4082'>
   INTEGER , INTENT(INOUT) :: start_month<a name='4083'>
   INTEGER , INTENT(INOUT) :: start_day<a name='4084'>
   INTEGER , INTENT(INOUT) :: start_hour<a name='4085'>
   INTEGER , INTENT(INOUT) :: start_minute<a name='4086'>
   INTEGER , INTENT(INOUT) :: start_second<a name='4087'>
   REAL    , INTENT(IN)    :: p00                      <font color=#447700>! base state pressure<a name='4088'></font>
   REAL    , INTENT(IN)    :: t00                      <font color=#447700>! base state temperature<a name='4089'></font>
   REAL    , INTENT(IN)    :: tlp                      <font color=#447700>! base state lapse rate<a name='4090'></font>
   REAL    , INTENT(IN)    :: znu( kms:kme )           <font color=#447700>! eta values on half (mass) levels<a name='4091'></font>
   REAL    , INTENT(IN)    :: p_top                    <font color=#447700>! pressure at top of model<a name='4092'></font>
   TYPE(fdob_type), INTENT(INOUT)  :: fdob<a name='4093'>
<a name='4094'>
   INTEGER                 :: e_sn         <font color=#447700>! ending   north-south grid index<a name='4095'></font>
   LOGICAL                 :: ipf_init     <font color=#447700>! print warnings detected at initialzn<a name='4096'></font>
<font color=#447700>!--------------------------------------------------------------------<a name='4097'></font>
<font color=#447700>!-- initialize fdda obs-nudging scheme<a name='4098'></font>
<a name='4099'>
      IF ( obs_nudge_opt(inest) .eq. 0 ) RETURN<a name='4100'>
<a name='4101'>
      e_sn = jde<a name='4102'>
      CALL <A href='../../html_code/phys/module_fddaobs_rtfdda.F.html#FDDAOBS_INIT'>fddaobs_init</A><A href='../../html_code/phys/module_physics_init.F.html#FDOB_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FDDAOBS_INIT_1">(obs_nudge_opt, maxdom, inest, parid,       &amp;<a name='4103'>
                        idynin, dtramp, fdaend, restart,           &amp;<a name='4104'>
                        obs_twindo_cg,                             &amp;<a name='4105'>
                        obs_twindo, itimestep,                     &amp;<a name='4106'>
                        no_pbl_nudge_uv,                           &amp;<a name='4107'>
                        no_pbl_nudge_t,                            &amp;<a name='4108'>
                        no_pbl_nudge_q,                            &amp;<a name='4109'>
                        sfc_scheme_horiz, sfc_scheme_vert,         &amp;<a name='4110'>
                        maxsnd_gap,                                &amp;<a name='4111'>
                        sfcfact, sfcfacr, dpsmx,                   &amp;<a name='4112'>
                        nudge_wind, nudge_temp, nudge_mois,        &amp;<a name='4113'>
                        nudgezfullr1_uv, nudgezrampr1_uv,          &amp;<a name='4114'>
                        nudgezfullr2_uv, nudgezrampr2_uv,          &amp;<a name='4115'>
                        nudgezfullr4_uv, nudgezrampr4_uv,          &amp;<a name='4116'>
                        nudgezfullr1_t,  nudgezrampr1_t,           &amp;<a name='4117'>
                        nudgezfullr2_t,  nudgezrampr2_t,           &amp;<a name='4118'>
                        nudgezfullr4_t,  nudgezrampr4_t,           &amp;<a name='4119'>
                        nudgezfullr1_q,  nudgezrampr1_q,           &amp;<a name='4120'>
                        nudgezfullr2_q,  nudgezrampr2_q,           &amp;<a name='4121'>
                        nudgezfullr4_q,  nudgezrampr4_q,           &amp;<a name='4122'>
                        nudgezfullmin,  nudgezrampmin, nudgezmax,  &amp;<a name='4123'>
                        xlat, xlong,                               &amp;<a name='4124'>
                        start_year, start_month, start_day,        &amp;<a name='4125'>
                        start_hour, start_minute, start_second,    &amp;<a name='4126'>
                        p00, t00, tlp,                             &amp;<a name='4127'>
                        znu, p_top,                                &amp;<a name='4128'>
                        fdob, ipf_init,                            &amp;<a name='4129'>
                        ids,ide, jds,jde, kds,kde,                 &amp;<a name='4130'>
                        ims,ime, jms,jme, kms,kme,                 &amp;<a name='4131'>
                        its,ite, jts,jte, kts,kte)<a name='4132'>
<a name='4133'>
   END SUBROUTINE fdob_init<a name='4134'>
#endif<a name='4135'>
<a name='4136'>
<font color=#447700>!--------------------------------------------------------------------<a name='4137'></font>
<A NAME='Z2SIGMA'><A href='../../html_code/phys/module_physics_init.F.html#Z2SIGMA' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4138'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>z2sigma</font>(zf,zh,sf,sh,p_top,pptop,config_flags, &amp; <A href='../../call_to/Z2SIGMA.html' TARGET='index'>1</A><a name='4139'>
                allowed_to_read , &amp;<a name='4140'>
                kds,kde,kms,kme,kts,kte)<a name='4141'>
   IMPLICIT NONE<a name='4142'>
<font color=#447700>! Arguments<a name='4143'></font>
   INTEGER, INTENT(IN) :: kds,kde,kms,kme,kts,kte<a name='4144'>
   REAL , DIMENSION( kms:kme ), INTENT(IN) :: zf,zh<a name='4145'>
   REAL , DIMENSION( kms:kme ), INTENT(OUT):: sf,sh<a name='4146'>
   REAL , INTENT(IN) :: p_top<a name='4147'>
   REAL , INTENT(OUT) :: pptop<a name='4148'>
   TYPE (grid_config_rec_type)              :: config_flags<a name='4149'>
   LOGICAL , INTENT(IN) :: allowed_to_read<a name='4150'>
<font color=#447700>! Local<a name='4151'></font>
   REAL R, G, TS, GAMMA, PS, ZTROP, TSTRAT, PTROP, Z, T, P, ZTOP, PTOP<a name='4152'>
   INTEGER K<a name='4153'>
<a name='4154'>
   IF(zf(kde/2) .GT. 1.0)THEN<a name='4155'>
<font color=#447700>! Height levels assumed (zeta coordinate)<a name='4156'></font>
<font color=#447700>! Convert to sigma using standard atmosphere for pressure-height relation<a name='4157'></font>
<font color=#447700>! constants for standard atmosphere definition<a name='4158'></font>
      r=287.05<a name='4159'>
      g=9.80665<a name='4160'>
      ts=288.15<a name='4161'>
      gamma=-6.5/1000.<a name='4162'>
      ps=1013.25<a name='4163'>
      ztrop=11000.<a name='4164'>
      tstrat=ts+gamma*ztrop<a name='4165'>
      ptrop=ps*(tstrat/ts)**(-g/(gamma*r))<a name='4166'>
<a name='4167'>
      do k=kde,kds,-1<a name='4168'>
<font color=#447700>! full levels<a name='4169'></font>
        z=zf(k)<a name='4170'>
        if(z.le.ztrop)then<a name='4171'>
          t=ts+gamma*z<a name='4172'>
          p=ps*(t/ts)**(-g/(gamma*r))<a name='4173'>
        else<a name='4174'>
          t=tstrat<a name='4175'>
          p=ptrop*exp(-g*(z-ztrop)/(r*tstrat))<a name='4176'>
        endif<a name='4177'>
        if(k.eq.kde)then<a name='4178'>
          ztop=zf(k)<a name='4179'>
          ptop=p<a name='4180'>
        endif<a name='4181'>
        sf(k)=(p-ptop)/(ps-ptop)<a name='4182'>
<font color=#447700>! half levels<a name='4183'></font>
        if(k.ne.kds)then<a name='4184'>
        z=0.5*(zf(k)+zf(k-1))<a name='4185'>
        if(z.le.ztrop)then<a name='4186'>
          t=ts+gamma*z<a name='4187'>
          p=ps*(t/ts)**(-g/(gamma*r))<a name='4188'>
        else<a name='4189'>
          t=tstrat<a name='4190'>
          p=ptrop*exp(-g*(z-ztrop)/(r*tstrat))<a name='4191'>
        endif<a name='4192'>
        sh(k-1)=(p-ptop)/(ps-ptop)<a name='4193'>
        endif<a name='4194'>
      enddo<a name='4195'>
      pptop=ptop/10.<a name='4196'>
   ELSE<a name='4197'>
<font color=#447700>!  Levels are already sigma/eta<a name='4198'></font>
      do k=kde,kds,-1<a name='4199'>
<font color=#447700>!        sf(k)=zf(kde-k+kds)<a name='4200'></font>
<font color=#447700>!        if(k .ne. kde)sh(k)=zh(kde-1-k+kds)<a name='4201'></font>
         sf(k)=zf(k)<a name='4202'>
         if(k .ne. kde)sh(k)=zh(k)<a name='4203'>
      enddo<a name='4204'>
      pptop=p_top/1000.<a name='4205'>
<a name='4206'>
   ENDIF<a name='4207'>
<a name='4208'>
   END SUBROUTINE z2sigma<a name='4209'>
<a name='4210'>
<font color=#447700>!--------------------------------------------------------------------<a name='4211'></font>
<A NAME='CAM_INIT'><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4212'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CAM_INIT</font> (ixcldliq, ixcldice, ixnumliq, ixnumice,config_flags) <A href='../../call_to/CAM_INIT.html' TARGET='index'>1</A>,<A href='../../call_from/CAM_INIT.html' TARGET='index'>23</A><a name='4213'>
<font color=#447700>!  Purpose: To initialize a set of variables and arrays required by <a name='4214'></font>
<font color=#447700>!           the CAM Parameterizations ported to WRF<a name='4215'></font>
<font color=#447700>!<a name='4216'></font>
<font color=#447700>!  Called by: Phy_init<a name='4217'></font>
<font color=#447700>!<a name='4218'></font>
<font color=#447700>!  Author:Balwinder.Singh@pnl.gov<a name='4219'></font>
<font color=#447700>!--------------------------------------------------------------------<a name='4220'></font>
     USE <A href='../../html_code/phys/module_cam_shr_kind_mod.F.html#SHR_KIND_MOD'>shr_kind_mod</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SHR_KIND_MOD_32">,               ONLY : r8 =&gt; shr_kind_r8<a name='4221'>
     USE <A href='../../html_code/phys/module_cam_esinti.F.html#MODULE_CAM_ESINTI'>module_cam_esinti</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CAM_ESINTI_1">,          ONLY : esinti<a name='4222'>
     USE <A href='../../html_code/phys/module_cam_physconst.F.html#PHYSCONST'>physconst</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PHYSCONST_24">,                  ONLY : mwh2o, cpwv, epsilo, latvap, latice &amp;<a name='4223'>
          , rh2o, cpair, tmelt,mwdry<a name='4224'>
     USE <A href='../../html_code/phys/module_cam_constituents.F.html#CONSTITUENTS'>constituents</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CONSTITUENTS_20">,               ONLY : cnst_add<a name='4225'>
     USE <A href='../../html_code/phys/module_cam_support.F.html#MODULE_CAM_SUPPORT'>module_cam_support</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CAM_SUPPORT_48">,         ONLY : pcnst =&gt;pcnst_runtime, pcnst_mp<a name='4226'>
     USE <A href='../../html_code/phys/module_cam_mp_modal_aero_initialize_data_phys.F.html#MODAL_AERO_INITIALIZE_DATA_PHYS'>modal_aero_initialize_data_phys</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODAL_AERO_INITIALIZE_DATA_PHYS_1">, ONLY : modal_aero_initialize_phys<a name='4227'>
     <a name='4228'>
     implicit none<a name='4229'>
<a name='4230'>
     TYPE (grid_config_rec_type)              :: config_flags<a name='4231'>
<a name='4232'>
     integer, intent(out) :: ixcldliq, ixcldice, ixnumliq, ixnumice<a name='4233'>
<a name='4234'>
     <font color=#447700>!Local variables<a name='4235'></font>
     <font color=#447700>!Following variable declarations are from CAM's stratiform.F90 module<a name='4236'></font>
     integer, parameter  :: ncnstmax = 4                    <font color=#447700>! Number of constituents     <a name='4237'></font>
     integer             :: mm<a name='4238'>
     character(len=8), dimension(ncnstmax), parameter :: cnst_names = &amp; <a name='4239'>
          (/'CLDLIQ', 'CLDICE','NUMLIQ','NUMICE'/)         <font color=#447700>! Constituent names<a name='4240'></font>
     <font color=#447700>!Variables with dummy values<a name='4241'></font>
     integer  :: dumind <a name='4242'>
     real(r8) :: one<a name='4243'>
<a name='4244'>
     <font color=#447700>!set dynamic (runtime)pcnst<a name='4245'></font>
     pcnst = 5                                               <font color=#447700>!For [water vap, cld liq, cld ice, liq num and ice num]<a name='4246'></font>
#if ( EM_CORE == 1 )<a name='4247'>
     IF(config_flags%mp_physics == CAMMGMPSCHEME) pcnst = 12 <font color=#447700>!Additional storage for prescribed aerosols<a name='4248'></font>
# endif<a name='4249'>
<a name='4250'>
     <font color=#447700>!pcnst for microphysics (pcnst_mp is different from pcnst ONLY if CAM MAM package amd CAMMGMP schemes are decoupled)<a name='4251'></font>
     pcnst_mp = pcnst<a name='4252'>
<a name='4253'>
#if ( WRF_CHEM == 1 )<a name='4254'>
     <font color=#447700>!If CAM MAM package is selected<a name='4255'></font>
     <font color=#447700>!BSINGH (01/23/2014):Please make sure pcnst is equal to cam_mam_nspec in chem/module_cam_mam_init.F and registry.chem<a name='4256'></font>
     IF(config_flags%chem_opt == CBMZ_CAM_MAM3_NOAQ .OR. config_flags%chem_opt==CBMZ_CAM_MAM3_AQ) then<a name='4257'>
        pcnst = 85 <font color=#447700>!For 3 modes of aerosols [adjusted for DMS species-BSINGH (01/20/2014) suggested by PMA]<a name='4258'></font>
     else if(config_flags%chem_opt == CBMZ_CAM_MAM7_NOAQ .OR. config_flags%chem_opt == CBMZ_CAM_MAM7_AQ) then<a name='4259'>
        pcnst = 90 <font color=#447700>!For 7 modes of aerosols<a name='4260'></font>
     endif<a name='4261'>
     <font color=#447700>!If CAM MAM package is NOT selected then pcnst presumes its default value set above<a name='4262'></font>
     <font color=#447700>!*NOTE* : the value of pcnst is 'hardwired' here as it was a quick solution. The dynamic value<a name='4263'></font>
     <font color=#447700>!of pcnst is computed in module_cam_mam_init.F. In module_cam_mam_init.F, the value of PCNST set here<a name='4264'></font>
     <font color=#447700>!is tested for its accuracy. If the value computed in module_cam_mam_init.F differs from value mentioned<a name='4265'></font>
     <font color=#447700>!above, then the above values for pcnst should be adjusted accordingly<a name='4266'></font>
<a name='4267'>
     <font color=#447700>!CAMMGMP Scheme is supposed to run with MODAL treatment of AEROSOLS only<a name='4268'></font>
     IF((config_flags%chem_opt .NE. CBMZ_CAM_MAM3_NOAQ .AND. config_flags%chem_opt .NE. CBMZ_CAM_MAM3_AQ &amp;<a name='4269'>
          .AND. config_flags%chem_opt .NE. CBMZ_CAM_MAM7_NOAQ .AND. config_flags%chem_opt .NE. CBMZ_CAM_MAM7_AQ &amp;<a name='4270'>
          .AND. config_flags%chem_opt .NE. 0) .AND. config_flags%mp_physics == CAMMGMPSCHEME) THEN<a name='4271'>
        call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_947">('CAMMGMP (mp_physics=17) ONLY works with CAM MAM package (chem_opt =501,502,503 or 504)')<a name='4272'>
     ENDIF<a name='4273'>
<a name='4274'>
<a name='4275'>
     <font color=#447700>!For assisting decoupled microphysics (MP) CAM MAM simulations (simulations, where MAM package is coupled with <a name='4276'></font>
     <font color=#447700>!radiation but uncoupled with MP- i.e. MP runs with 'prescribed' aerosols) 'pcnst_mp' is defined.'pcnst_mp' will<a name='4277'></font>
     <font color=#447700>!only be used in the CAMMGMP driver and its supporting modules (ndrop and microp_aero)<a name='4278'></font>
     pcnst_mp = pcnst<a name='4279'>
     if(.NOT.config_flags%CAM_MP_MAM_cpled)pcnst_mp = 12<a name='4280'>
#endif<a name='4281'>
<a name='4282'>
     <font color=#447700>! Initialize the saturation vapor pressure look-up table...      <a name='4283'></font>
     call <A href='../../html_code/phys/module_ra_cam_support.F.html#ESINTI'>esinti</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ESINTI_1">(epsilo, latvap, latice, rh2o, cpair, tmelt)<a name='4284'>
     <a name='4285'>
     IF(.NOT.CAM_INITIALIZED) THEN<a name='4286'>
        <a name='4287'>
        <font color=#447700>!Allocate module level CAM arrays<a name='4288'></font>
        call <A href='../../html_code/phys/module_physics_init.F.html#ALLOCATE_CAM_ARRAYS'>ALLOCATE_CAM_ARRAYS</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ALLOCATE_CAM_ARRAYS_1">()     <a name='4289'>
        <a name='4290'>
        <font color=#447700>!-------------------------------------------------------------------------------------!<a name='4291'></font>
        <font color=#447700>!Calls to add constituents (these calls are imported from in initindx.F90 in CAM)     !<a name='4292'></font>
        <font color=#447700>!                                                                                     !<a name='4293'></font>
        <font color=#447700>! Register water vapor.                                                               !<a name='4294'></font>
        <font color=#447700>! ** This must be the first call to cnst_add so that water vapor is constituent 1.**  !<a name='4295'></font>
        <font color=#447700>!-------------------------------------------------------------------------------------!<a name='4296'></font>
        <a name='4297'>
        call <A href='../../html_code/phys/module_cam_constituents.F.html#CNST_ADD'>cnst_add</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CNST_ADD_1">('Q', mwh2o, cpwv, 1.E-12_r8, mm, &amp;<a name='4298'>
             longname='Specific humidity', readiv=.true. )<a name='4299'>
        <a name='4300'>
        <a name='4301'>
        <font color=#447700>!Following add constituent calls are imported from the stratiform.F90 in CAM<a name='4302'></font>
        <a name='4303'>
        call <A href='../../html_code/phys/module_cam_constituents.F.html#CNST_ADD'>cnst_add</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CNST_ADD_2">(cnst_names(1), mwdry, cpair, 0._r8, ixcldliq, &amp;<a name='4304'>
             longname='Grid box averaged cloud liquid amount')<a name='4305'>
        call <A href='../../html_code/phys/module_cam_constituents.F.html#CNST_ADD'>cnst_add</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CNST_ADD_3">(cnst_names(2), mwdry, cpair, 0._r8, ixcldice, &amp;<a name='4306'>
             longname='Grid box averaged cloud ice amount'   )<a name='4307'>
        call <A href='../../html_code/phys/module_cam_constituents.F.html#CNST_ADD'>cnst_add</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CNST_ADD_4">(cnst_names(3), mwdry, cpair, 0._r8, ixnumliq, &amp;<a name='4308'>
             longname='Grid box averaged cloud liquid number')<a name='4309'>
        call <A href='../../html_code/phys/module_cam_constituents.F.html#CNST_ADD'>cnst_add</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CNST_ADD_5">(cnst_names(4), mwdry, cpair, 0._r8, ixnumice, &amp;<a name='4310'>
             longname='Grid box averaged cloud ice number'   )<a name='4311'>
<a name='4312'>
        <font color=#447700>!For prescribed aerosols<a name='4313'></font>
#if ( EM_CORE == 1 )<a name='4314'>
        IF(config_flags%mp_physics .EQ. CAMMGMPSCHEME &amp;<a name='4315'>
#if ( WRF_CHEM == 1 )<a name='4316'>
             .AND.  config_flags%chem_opt .EQ. 0    &amp;<a name='4317'>
#endif<a name='4318'>
             )THEN<a name='4319'>
           one = 1.0_r8<a name='4320'>
           call <A href='../../html_code/phys/module_cam_constituents.F.html#CNST_ADD'>cnst_add</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CNST_ADD_6">('ACCUM_MASS', one, cpair, 0._r8, dumind, &amp;<a name='4321'>
                longname='Grid box averaged accumulation mode mass')<a name='4322'>
           call <A href='../../html_code/phys/module_cam_constituents.F.html#CNST_ADD'>cnst_add</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CNST_ADD_7">('ACCUM_NUM' , one, cpair, 0._r8, dumind, &amp;<a name='4323'>
                longname='Grid box averaged accumulation mode number')<a name='4324'>
           call <A href='../../html_code/phys/module_cam_constituents.F.html#CNST_ADD'>cnst_add</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CNST_ADD_8">('AITKEN_MASS', one, cpair, 0._r8, dumind, &amp;<a name='4325'>
                longname='Grid box averaged aitken mode mass')<a name='4326'>
           call <A href='../../html_code/phys/module_cam_constituents.F.html#CNST_ADD'>cnst_add</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CNST_ADD_9">('AITKEN_NUM' , one, cpair, 0._r8, dumind, &amp;<a name='4327'>
                longname='Grid box averaged aitken mode number')<a name='4328'>
           call <A href='../../html_code/phys/module_cam_constituents.F.html#CNST_ADD'>cnst_add</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CNST_ADD_10">('COARSE_MASS_1', one, cpair, 0._r8, dumind, &amp;<a name='4329'>
                longname='Grid box averaged coarse mode1 mass')<a name='4330'>
           call <A href='../../html_code/phys/module_cam_constituents.F.html#CNST_ADD'>cnst_add</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CNST_ADD_11">('COARSE_MASS_2', one, cpair, 0._r8, dumind, &amp;<a name='4331'>
                longname='Grid box averaged coarse mode2 mass')<a name='4332'>
           call <A href='../../html_code/phys/module_cam_constituents.F.html#CNST_ADD'>cnst_add</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CNST_ADD_12">('COARSE_NUM' , one, cpair, 0._r8, dumind, &amp;<a name='4333'>
                longname='Grid box averaged coarse mode number')<a name='4334'>
           <a name='4335'>
        ENDIF<a name='4336'>
#endif<a name='4337'>
        <a name='4338'>
        CAM_INITIALIZED = .TRUE.<a name='4339'>
     ENDIF<a name='4340'>
     <a name='4341'>
#if ( EM_CORE == 1 )<a name='4342'>
     IF(config_flags%mp_physics == CAMMGMPSCHEME)THEN<a name='4343'>
#if ( WRF_CHEM <font color=#447700>!= 1 )<a name='4344'></font>
        <font color=#447700>!Aerosols must be initialized after adding the constituents otherwise the code may crash in WRF-Chem simulations     <a name='4345'></font>
        CALL <A href='../../html_code/phys/module_cam_mp_modal_aero_initialize_data_phys.F.html#MODAL_AERO_INITIALIZE_PHYS'>modal_aero_initialize_phys</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODAL_AERO_INITIALIZE_PHYS_1"><a name='4346'>
#else<a name='4347'>
        if(config_flags%chem_opt==0) then<a name='4348'>
           CALL <A href='../../html_code/phys/module_cam_mp_modal_aero_initialize_data_phys.F.html#MODAL_AERO_INITIALIZE_PHYS'>modal_aero_initialize_phys</A><A href='../../html_code/phys/module_physics_init.F.html#CAM_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODAL_AERO_INITIALIZE_PHYS_2"><a name='4349'>
        endif<a name='4350'>
#endif<a name='4351'>
     ENDIF<a name='4352'>
#endif<a name='4353'>
   END SUBROUTINE CAM_INIT<a name='4354'>
<a name='4355'>
<a name='4356'>
<font color=#447700>!--------------------------------------------------------------------<a name='4357'></font>
<A NAME='ALLOCATE_CAM_ARRAYS'><A href='../../html_code/phys/module_physics_init.F.html#ALLOCATE_CAM_ARRAYS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4358'>
 <font color=#993300>SUBROUTINE </font><font color=#cc0000>ALLOCATE_CAM_ARRAYS</font> () <A href='../../call_to/ALLOCATE_CAM_ARRAYS.html' TARGET='index'>1</A>,<A href='../../call_from/ALLOCATE_CAM_ARRAYS.html' TARGET='index'>3</A><a name='4359'>
<font color=#447700>!  Purpose: To allocate module level CAM arrays for CAM modules which<a name='4360'></font>
<font color=#447700>!           doesn't have an 'initialization' subroutine<a name='4361'></font>
<font color=#447700>!<a name='4362'></font>
<font color=#447700>!  Called by: CAM_INIT<a name='4363'></font>
<font color=#447700>!<a name='4364'></font>
<font color=#447700>!  Author:Balwinder.Singh@pnl.gov<a name='4365'></font>
<font color=#447700>!--------------------------------------------------------------------<a name='4366'></font>
   USE <A href='../../html_code/phys/module_cam_constituents.F.html#CONSTITUENTS'>constituents</A><A href='../../html_code/phys/module_physics_init.F.html#ALLOCATE_CAM_ARRAYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CONSTITUENTS_21">,         ONLY : cnst_name,cnst_longname,cnst_cp,&amp;<a name='4367'>
        cnst_cv,cnst_mw,cnst_type,cnst_rgas,qmin,qmincg,            &amp;<a name='4368'>
        cnst_fixed_ubc,apcnst,bpcnst,hadvnam,vadvnam,dcconnam,      &amp;<a name='4369'>
        fixcnam,tendnam,ptendnam,dmetendnam,sflxnam,tottnam  <a name='4370'>
<a name='4371'>
   USE <A href='../../html_code/phys/module_cam_support.F.html#MODULE_CAM_SUPPORT'>module_cam_support</A><A href='../../html_code/phys/module_physics_init.F.html#ALLOCATE_CAM_ARRAYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CAM_SUPPORT_49">,   ONLY : pcnst =&gt;pcnst_runtime, pcnst_mp<a name='4372'>
<a name='4373'>
   USE <A href='../../html_code/phys/module_data_cam_mam_aero.F.html#MODAL_AERO_DATA'>modal_aero_data</A><A href='../../html_code/phys/module_physics_init.F.html#ALLOCATE_CAM_ARRAYS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODAL_AERO_DATA_23">,      ONLY : cnst_name_cw,species_class,     &amp;<a name='4374'>
        qneg3_worst_thresh_amode,cnst_name_cw_mp<a name='4375'>
<a name='4376'>
   implicit none<a name='4377'>
<a name='4378'>
   <font color=#447700>!Allocate module_cam_constituents.F arrays<a name='4379'></font>
   Allocate(cnst_name(pcnst),cnst_longname(pcnst),cnst_cp(pcnst),   &amp;<a name='4380'>
        cnst_cv(pcnst),cnst_mw(pcnst),cnst_type(pcnst),             &amp;<a name='4381'>
        cnst_rgas(pcnst),qmin(pcnst),qmincg(pcnst),                 &amp;<a name='4382'>
        cnst_fixed_ubc(pcnst),apcnst(pcnst),bpcnst(pcnst),          &amp;<a name='4383'>
        hadvnam(pcnst),vadvnam(pcnst),dcconnam(pcnst),              &amp;<a name='4384'>
        fixcnam(pcnst),tendnam(pcnst),ptendnam(pcnst),              &amp;<a name='4385'>
        dmetendnam(pcnst),sflxnam(pcnst),tottnam(pcnst)             )<a name='4386'>
<a name='4387'>
   <font color=#447700>!Initialize module_cam_constituents.F variables<a name='4388'></font>
   cnst_fixed_ubc(:) = .false.<a name='4389'>
<a name='4390'>
   <font color=#447700>!Allocate module_cam_mp_modal_aero_data_phys.F arrays<a name='4391'></font>
   Allocate(cnst_name_cw(pcnst),cnst_name_cw_mp(pcnst_mp),          &amp;<a name='4392'>
        species_class(pcnst),qneg3_worst_thresh_amode(pcnst)        )<a name='4393'>
   <a name='4394'>
 END SUBROUTINE ALLOCATE_CAM_ARRAYS<a name='4395'>
<a name='4396'>
<A NAME='AEROSOL_IN'><A href='../../html_code/phys/module_physics_init.F.html#AEROSOL_IN' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4397'>
<font color=#993300>subroutine </font><font color=#cc0000>aerosol_in</font>(aerodm,pina,alevsiz,no_months,no_src_types,XLAT,XLONG,   &amp; <A href='../../call_to/AEROSOL_IN.html' TARGET='index'>1</A>,<A href='../../call_from/AEROSOL_IN.html' TARGET='index'>3</A><a name='4398'>
                     ids, ide, jds, jde, kds, kde,                  &amp;<a name='4399'>
                     ims, ime, jms, jme, kms, kme,                  &amp;<a name='4400'>
                     its, ite, jts, jte, kts, kte)<a name='4401'>
<font color=#447700>!<a name='4402'></font>
<font color=#447700>! Adaped from oznini in CAM <a name='4403'></font>
<font color=#447700>! It should be replaced by monthly climatology that varies latitudinally and vertically<a name='4404'></font>
<font color=#447700>!<a name='4405'></font>
   IMPLICIT NONE<a name='4406'>
<a name='4407'>
   INTEGER,      INTENT(IN   )    ::   ids,ide, jds,jde, kds,kde, &amp;<a name='4408'>
                                       ims,ime, jms,jme, kms,kme, &amp;<a name='4409'>
                                       its,ite, jts,jte, kts,kte   <a name='4410'>
<a name='4411'>
   INTEGER,      INTENT(IN   )    ::   alevsiz, no_months, no_src_types<a name='4412'>
<a name='4413'>
   REAL,  DIMENSION( ims:ime, jms:jme ), INTENT(IN   )  ::     XLAT, XLONG<a name='4414'>
<a name='4415'>
   REAL,  DIMENSION( ims:ime, alevsiz, jms:jme, no_months, no_src_types ),      &amp;<a name='4416'>
          INTENT(OUT   ) ::                                  aerodm<a name='4417'>
<a name='4418'>
   REAL,  DIMENSION(alevsiz), INTENT(OUT )  ::                   pina<a name='4419'>
<a name='4420'>
<font color=#447700>! Local<a name='4421'></font>
<font color=#447700>!  Data from Ryan Torn, computed from EC 6 types of aerosol data:<a name='4422'></font>
<font color=#447700>!    organic carbon, sea salt, dust, black carbon, sulfalte <a name='4423'></font>
<font color=#447700>!    and stratospheric aerosol (volcanic ashes)<a name='4424'></font>
<font color=#447700>!  The data dimensions are 46 x 72 x 12 (pressure levels), and in unit of AOD per Pa<a name='4425'></font>
<a name='4426'>
   INTEGER, PARAMETER :: latsiz = 46<a name='4427'>
   INTEGER, PARAMETER :: lonsiz = 72<a name='4428'>
   INTEGER :: i, j, k, itf, jtf, ktf, m, pin_unit, lat_unit, lon_unit, od_unit, ks, il, jl<a name='4429'>
   INTEGER :: ilon1, ilon2, jlat1, jlat2<a name='4430'>
   REAL    :: interp_pt, interp_pt_lat, interp_pt_lon, wlat1, wlat2, wlon1, wlon2<a name='4431'>
   CHARACTER*256 :: message<a name='4432'>
<a name='4433'>
   REAL,  DIMENSION( lonsiz, alevsiz, latsiz, no_months, no_src_types )    ::   &amp;<a name='4434'>
                                                            aerodin<a name='4435'>
<a name='4436'>
   REAL,  DIMENSION(latsiz)                ::             lat_od, aertmp1<a name='4437'>
   REAL,  DIMENSION(lonsiz)                ::             lon_od, aertmp2<a name='4438'>
<a name='4439'>
   jtf=min0(jte,jde-1)<a name='4440'>
   ktf=min0(kte,kde-1)<a name='4441'>
   itf=min0(ite,ide-1)<a name='4442'>
<a name='4443'>
<font color=#447700>!-- read in aerosol optical depth pressure data<a name='4444'></font>
<a name='4445'>
     WRITE(message,*)'no_months = ',no_months<a name='4446'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_physics_init.F.html#AEROSOL_IN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_726">(1,message)<a name='4447'>
<a name='4448'>
<font color=#447700>! pressure in mb<a name='4449'></font>
      pin_unit = 27<a name='4450'>
        OPEN(pin_unit, FILE='aerosol_plev.formatted',FORM='FORMATTED',STATUS='OLD')<a name='4451'>
        do k = 1,alevsiz<a name='4452'>
        READ (pin_unit,*) pina(k)<a name='4453'>
        end do<a name='4454'>
      close(27)<a name='4455'>
<a name='4456'>
<font color=#447700>!     do k=1,alevsiz<a name='4457'></font>
<font color=#447700>!       pina(k) = pina(k)*100.<a name='4458'></font>
<font color=#447700>!     end do<a name='4459'></font>
<a name='4460'>
<font color=#447700>!-- read in aerosol optical depth lat data<a name='4461'></font>
<a name='4462'>
      lat_unit = 28<a name='4463'>
        OPEN(lat_unit, FILE='aerosol_lat.formatted',FORM='FORMATTED',STATUS='OLD')<a name='4464'>
        do j = 1,latsiz<a name='4465'>
        READ (lat_unit,*) lat_od(j)<a name='4466'>
        end do<a name='4467'>
      close(28)<a name='4468'>
<a name='4469'>
<font color=#447700>!-- read in aerosol optical depth lon data<a name='4470'></font>
<a name='4471'>
      lon_unit = 29<a name='4472'>
        OPEN(lon_unit, FILE='aerosol_lon.formatted',FORM='FORMATTED',STATUS='OLD')<a name='4473'>
        do j = 1,lonsiz<a name='4474'>
        READ (lon_unit,*) lon_od(j)<a name='4475'>
        end do<a name='4476'>
      close(29)<a name='4477'>
<a name='4478'>
<font color=#447700>!-- read in ozone data<a name='4479'></font>
<a name='4480'>
      od_unit = 30<a name='4481'>
      OPEN(od_unit, FILE='aerosol.formatted',FORM='FORMATTED',STATUS='OLD')<a name='4482'>
<a name='4483'>
      do ks=1,no_src_types<a name='4484'>
      do m=1,no_months<a name='4485'>
      do j=1,latsiz  <font color=#447700>! latsiz=46<a name='4486'></font>
      do k=1,alevsiz <font color=#447700>! alevsiz=12<a name='4487'></font>
      do i=1,lonsiz  <font color=#447700>! lonsiz=72<a name='4488'></font>
         READ (od_unit,*) aerodin(i,k,j,m,ks)<a name='4489'>
      enddo<a name='4490'>
      enddo<a name='4491'>
      enddo<a name='4492'>
      enddo<a name='4493'>
      enddo<a name='4494'>
      close(30)<a name='4495'>
<a name='4496'>
<font color=#447700>!-- latitudinally interpolate ozone data (and extend longitudinally)<a name='4497'></font>
<font color=#447700>!-- using function lin_interpol2(x, f, y) result(g)<a name='4498'></font>
<font color=#447700>! Purpose:<a name='4499'></font>
<font color=#447700>!   interpolates f(x) to point y<a name='4500'></font>
<font color=#447700>!   assuming f(x) = f(x0) + a * (x - x0)<a name='4501'></font>
<font color=#447700>!   where a = ( f(x1) - f(x0) ) / (x1 - x0)<a name='4502'></font>
<font color=#447700>!   x0 &lt;= x &lt;= x1<a name='4503'></font>
<font color=#447700>!   assumes x is monotonically increasing<a name='4504'></font>
<font color=#447700>!    real, intent(in), dimension(:) :: x  ! grid points<a name='4505'></font>
<font color=#447700>!    real, intent(in), dimension(:) :: f  ! grid function values<a name='4506'></font>
<font color=#447700>!    real, intent(in) :: y                ! interpolation point<a name='4507'></font>
<font color=#447700>!    real :: g                            ! interpolated function value<a name='4508'></font>
<font color=#447700>!---------------------------------------------------------------------------<a name='4509'></font>
<a name='4510'>
      do j=jts,jtf<a name='4511'>
      do i=its,itf<a name='4512'>
        interp_pt_lat=XLAT(i,j)<a name='4513'>
        interp_pt_lon=XLONG(i,j)<a name='4514'>
        call <A href='../../html_code/phys/module_physics_init.F.html#INTERP_VEC'>interp_vec</A><A href='../../html_code/phys/module_physics_init.F.html#AEROSOL_IN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERP_VEC_1">(lat_od,interp_pt_lat,.true.,jlat1,jlat2,wlat1,wlat2)<a name='4515'>
        call <A href='../../html_code/phys/module_physics_init.F.html#INTERP_VEC'>interp_vec</A><A href='../../html_code/phys/module_physics_init.F.html#AEROSOL_IN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERP_VEC_2">(lon_od,interp_pt_lon,.true.,ilon1,ilon2,wlon1,wlon2)<a name='4516'>
<a name='4517'>
        do ks = 1,no_src_types<a name='4518'>
        do m  = 1,no_months<a name='4519'>
        do k  = 1,alevsiz<a name='4520'>
          aerodm(i,k,j,m,ks) = wlon1 * (wlat1 * aerodin(ilon1,k,jlat1,m,ks)  + &amp;<a name='4521'>
                                        wlat2 * aerodin(ilon1,k,jlat2,m,ks)) + &amp;<a name='4522'>
                               wlon2 * (wlat1 * aerodin(ilon2,k,jlat1,m,ks)  + &amp;<a name='4523'>
                                        wlat2 * aerodin(ilon2,k,jlat2,m,ks))<a name='4524'>
        end do<a name='4525'>
        end do<a name='4526'>
        end do<a name='4527'>
<a name='4528'>
      end do<a name='4529'>
      end do<a name='4530'>
<a name='4531'>
<font color=#447700>!     do j=jts,jtf<a name='4532'></font>
<font color=#447700>!     do i=its,itf<a name='4533'></font>
<font color=#447700>!        onefld(i,j) = aerodm(i,12,j,1,1)<a name='4534'></font>
<font color=#447700>!     enddo<a name='4535'></font>
<font color=#447700>!     enddo<a name='4536'></font>
<a name='4537'>
END SUBROUTINE aerosol_in<a name='4538'>
<a name='4539'>
<A NAME='LIN_INTERP'><A href='../../html_code/phys/module_physics_init.F.html#LIN_INTERP' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='4540'>
  <font color=#993300>function </font><font color=#cc0000>lin_interp</font>(x, f, y) result(g),<A href='../../call_from/LIN_INTERP.html' TARGET='index'>4</A><a name='4541'>
<a name='4542'>
    <font color=#447700>! Purpose:<a name='4543'></font>
    <font color=#447700>!   interpolates f(x) to point y<a name='4544'></font>
    <font color=#447700>!   assuming f(x) = <A href='../../html_code/phys/module_mp_full_sbm.F.html#F'>f</A><A href='../../html_code/phys/module_physics_init.F.html#LIN_INTERP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="F_18">(x0) + a * (x - x0)<a name='4545'></font>
    <font color=#447700>!   where a = ( f(x1) - f(x0) ) / (x1 - x0)<a name='4546'></font>
    <font color=#447700>!   x0 &lt;= x &lt;= x1<a name='4547'></font>
    <font color=#447700>!   assumes x is monotonically increasing<a name='4548'></font>
<a name='4549'>
    <font color=#447700>! Author: D. Fillmore ::  J. Done changed from r8 to r4<a name='4550'></font>
<a name='4551'>
    implicit none<a name='4552'>
<a name='4553'>
    real, intent(in), dimension(:) :: x  <font color=#447700>! grid points<a name='4554'></font>
    real, intent(in), dimension(:) :: f  <font color=#447700>! grid function values<a name='4555'></font>
    real, intent(in) :: y                <font color=#447700>! interpolation point<a name='4556'></font>
    real :: g                            <font color=#447700>! interpolated function value<a name='4557'></font>
<a name='4558'>
    integer :: k  <font color=#447700>! interpolation point index<a name='4559'></font>
    integer :: n  <font color=#447700>! length of x<a name='4560'></font>
    real    :: a<a name='4561'>
<a name='4562'>
    n = size(x)<a name='4563'>
<a name='4564'>
    <font color=#447700>! find k such that x(k) &lt; y =&lt; x(k+1)<a name='4565'></font>
    <font color=#447700>! set k = 1 if y &lt;= x(1)  and  k = n-1 if y &gt; x(n)<a name='4566'></font>
<a name='4567'>
    if (y &lt;= x(1)) then<a name='4568'>
      k = 1<a name='4569'>
    else if (y &gt;= x(n)) then<a name='4570'>
      k = n - 1<a name='4571'>
    else<a name='4572'>
      k = 1<a name='4573'>
      do while (y &gt; x(k+1) .and. k &lt; n)<a name='4574'>
        k = k + 1<a name='4575'>
      end do<a name='4576'>
    end if<a name='4577'>
<a name='4578'>
    <font color=#447700>! interpolate<a name='4579'></font>
    a = (  f(k+1) - f(k) ) / ( x(k+1) - x(k) )<a name='4580'>
    g = <A href='../../html_code/phys/module_mp_full_sbm.F.html#F'>f</A><A href='../../html_code/phys/module_physics_init.F.html#LIN_INTERP' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="F_19">(k) + a * (y - x(k))<a name='4581'>
<a name='4582'>
  end function lin_interp<a name='4583'>
<a name='4584'>
<A NAME='INTERP_VEC'><A href='../../html_code/phys/module_physics_init.F.html#INTERP_VEC' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4585'>
  <font color=#993300>subroutine </font><font color=#cc0000>interp_vec</font>(locvec,locwant,periodic,loc1,loc2,wght1,wght2) <A href='../../call_to/INTERP_VEC.html' TARGET='index'>2</A><a name='4586'>
<a name='4587'>
  implicit none<a name='4588'>
<a name='4589'>
  real, intent(in), dimension(:) :: locvec<a name='4590'>
  real, intent(in)               :: locwant<a name='4591'>
  logical, intent(in)            :: periodic<a name='4592'>
  integer, intent(out)           :: loc1, loc2<a name='4593'>
  real, intent(out)              :: wght1, wght2<a name='4594'>
<a name='4595'>
  integer :: vsize, n<a name='4596'>
  real    :: locv1, locv2<a name='4597'>
<a name='4598'>
  vsize = size(locvec)<a name='4599'>
<a name='4600'>
  loc1 = -1<a name='4601'>
  loc2 = -1<a name='4602'>
<a name='4603'>
  do n = 1, vsize-1<a name='4604'>
    if ( locvec(n) &lt;= locwant .and. locvec(n+1) &gt; locwant ) then<a name='4605'>
      loc1  = n<a name='4606'>
      loc2  = n+1<a name='4607'>
      locv1 = locvec(n)<a name='4608'>
      locv2 = locvec(n+1)<a name='4609'>
      exit<a name='4610'>
    end if<a name='4611'>
  end do<a name='4612'>
<a name='4613'>
  if ( loc1 &lt; 0 .and. loc2 &lt; 0 ) then<a name='4614'>
    if ( periodic ) then<a name='4615'>
      if ( locwant &lt; locvec(1) ) then<a name='4616'>
        loc1  = vsize<a name='4617'>
        loc2  = 1<a name='4618'>
        locv1 = locvec(vsize)-360.0<a name='4619'>
        locv2 = locvec(1)<a name='4620'>
      else<a name='4621'>
        loc1  = vsize<a name='4622'>
        loc2  = 1<a name='4623'>
        locv1 = locvec(vsize)<a name='4624'>
        locv2 = locvec(1)+360.0<a name='4625'>
      end if<a name='4626'>
    else<a name='4627'>
      if ( locwant &lt; locvec(1) ) then<a name='4628'>
        loc1  = 1<a name='4629'>
        loc2  = 1<a name='4630'>
        locv1 = locvec(1)<a name='4631'>
        locv2 = locvec(1)<a name='4632'>
      else<a name='4633'>
        loc1  = vsize<a name='4634'>
        loc2  = vsize<a name='4635'>
        locv1 = locvec(vsize)<a name='4636'>
        locv2 = locvec(vsize)<a name='4637'>
      end if<a name='4638'>
    end if<a name='4639'>
  end if<a name='4640'>
<a name='4641'>
  wght2 = (locwant-locv1) / (locv2-locv1)<a name='4642'>
  wght1 = 1.0 - wght2<a name='4643'>
<a name='4644'>
  return<a name='4645'>
  end subroutine interp_vec<a name='4646'>
<a name='4647'>
END MODULE module_physics_init<a name='4648'>
</pre></body></html>