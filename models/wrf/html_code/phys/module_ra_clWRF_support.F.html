<HTML> <BODY BGCOLOR=#ddddee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!-----------------------------------------------------------------------<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<font color=#447700>! Contains all subroutines to get time-varying mixing ratios of CO2, <a name='4'></font>
<font color=#447700>! N2O, CH4, CFC11 and CFC12 into radiation schemes.<a name='5'></font>
<font color=#447700>! These subroutines enable the user to specify the mixing ratios<a name='6'></font>
<font color=#447700>! in the file CAMtr_volume_mixing_ratio, giving the user an easy way<a name='7'></font>
<font color=#447700>! to specify trace gases concentrations.<a name='8'></font>
<font color=#447700>!<a name='9'></font>
<font color=#447700>! The subroutines were first developed by and put together in this module<a name='10'></font>
<font color=#447700>! by C. Carouge.<a name='11'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='12'></font>
<A NAME='MODULE_RA_CLWRF_SUPPORT'><A href='../../html_code/phys/module_ra_clWRF_support.F.html#MODULE_RA_CLWRF_SUPPORT' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='13'>
<font color=#993300>MODULE </font><font color=#cc0000>module_ra_clWRF_support</font> <A href='../../call_to/MODULE_RA_CLWRF_SUPPORT.html' TARGET='index'>4</A><a name='14'>
<a name='15'>
  USE <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#module_ra_clWRF_support.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_76"><a name='16'>
<a name='17'>
  IMPLICIT NONE<a name='18'>
  PRIVATE<a name='19'>
  INTEGER, PARAMETER               :: r8 = 8<a name='20'>
  integer, parameter               :: cyr = 1800     <font color=#447700>! maximum num. of lines in 'CAMtr_volume_mixing_ratio' file<a name='21'></font>
  integer, DIMENSION(1:cyr), SAVE  :: yrdata<a name='22'>
  real, DIMENSION(1:cyr), SAVE  :: juldata<a name='23'>
  real(r8), DIMENSION(1:cyr), SAVE :: co2r, n2or, ch4r, cfc11r, cfc12r<a name='24'>
<a name='25'>
<a name='26'>
  <font color=#447700>! Same values as in module_ra_cam_support.F<a name='27'></font>
  integer, parameter               :: VARCAM_in_years = 233<a name='28'>
  integer                          :: yr_CAM(1:VARCAM_in_years) = &amp;<a name='29'>
       (/ 1869, 1870, 1871, 1872, 1873, 1874, 1875, &amp;<a name='30'>
       1876, 1877, 1878, 1879, 1880, 1881, 1882, &amp;<a name='31'>
       1883, 1884, 1885, 1886, 1887, 1888, 1889, &amp;<a name='32'>
       1890, 1891, 1892, 1893, 1894, 1895, 1896, &amp;<a name='33'>
       1897, 1898, 1899, 1900, 1901, 1902, 1903, &amp;<a name='34'>
       1904, 1905, 1906, 1907, 1908, 1909, 1910, &amp;<a name='35'>
       1911, 1912, 1913, 1914, 1915, 1916, 1917, &amp;<a name='36'>
       1918, 1919, 1920, 1921, 1922, 1923, 1924, &amp;<a name='37'>
       1925, 1926, 1927, 1928, 1929, 1930, 1931, &amp;<a name='38'>
       1932, 1933, 1934, 1935, 1936, 1937, 1938, &amp;<a name='39'>
       1939, 1940, 1941, 1942, 1943, 1944, 1945, &amp;<a name='40'>
       1946, 1947, 1948, 1949, 1950, 1951, 1952, &amp;<a name='41'>
       1953, 1954, 1955, 1956, 1957, 1958, 1959, &amp;<a name='42'>
       1960, 1961, 1962, 1963, 1964, 1965, 1966, &amp;<a name='43'>
       1967, 1968, 1969, 1970, 1971, 1972, 1973, &amp;<a name='44'>
       1974, 1975, 1976, 1977, 1978, 1979, 1980, &amp;<a name='45'>
       1981, 1982, 1983, 1984, 1985, 1986, 1987, &amp;<a name='46'>
       1988, 1989, 1990, 1991, 1992, 1993, 1994, &amp;<a name='47'>
       1995, 1996, 1997, 1998, 1999, 2000, 2001, &amp;<a name='48'>
       2002, 2003, 2004, 2005, 2006, 2007, 2008, &amp;<a name='49'>
       2009, 2010, 2011, 2012, 2013, 2014, 2015, &amp;<a name='50'>
       2016, 2017, 2018, 2019, 2020, 2021, 2022, &amp;<a name='51'>
       2023, 2024, 2025, 2026, 2027, 2028, 2029, &amp;<a name='52'>
       2030, 2031, 2032, 2033, 2034, 2035, 2036, &amp;<a name='53'>
       2037, 2038, 2039, 2040, 2041, 2042, 2043, &amp;<a name='54'>
       2044, 2045, 2046, 2047, 2048, 2049, 2050, &amp;<a name='55'>
       2051, 2052, 2053, 2054, 2055, 2056, 2057, &amp;<a name='56'>
       2058, 2059, 2060, 2061, 2062, 2063, 2064, &amp;<a name='57'>
       2065, 2066, 2067, 2068, 2069, 2070, 2071, &amp;<a name='58'>
       2072, 2073, 2074, 2075, 2076, 2077, 2078, &amp;<a name='59'>
       2079, 2080, 2081, 2082, 2083, 2084, 2085, &amp;<a name='60'>
       2086, 2087, 2088, 2089, 2090, 2091, 2092, &amp;<a name='61'>
       2093, 2094, 2095, 2096, 2097, 2098, 2099, &amp;<a name='62'>
       2100, 2101                               /)<a name='63'>
  real                             :: co2r_CAM(1:VARCAM_in_years) = &amp;<a name='64'>
       (/ 289.263, 289.263, 289.416, 289.577, 289.745, 289.919, 290.102, &amp;<a name='65'>
       290.293, 290.491, 290.696, 290.909, 291.129, 291.355, 291.587, 291.824, &amp;<a name='66'>
       292.066, 292.313, 292.563, 292.815, 293.071, 293.328, 293.586, 293.843, &amp;<a name='67'>
       294.098, 294.35, 294.598, 294.842, 295.082, 295.32, 295.558, 295.797,   &amp;<a name='68'>
       296.038, 296.284, 296.535, 296.794, 297.062, 297.338, 297.62, 297.91,   &amp;<a name='69'>
       298.204, 298.504, 298.806, 299.111, 299.419, 299.729, 300.04, 300.352,  &amp;<a name='70'>
       300.666, 300.98, 301.294, 301.608, 301.923, 302.237, 302.551, 302.863,  &amp;<a name='71'>
       303.172, 303.478, 303.779, 304.075, 304.366, 304.651, 304.93, 305.206,  &amp;<a name='72'>
       305.478, 305.746, 306.013, 306.28, 306.546, 306.815, 307.087, 307.365,  &amp;<a name='73'>
       307.65, 307.943, 308.246, 308.56, 308.887, 309.228, 309.584, 309.956,   &amp;<a name='74'>
       310.344, 310.749, 311.172, 311.614, 312.077, 312.561, 313.068, 313.599, &amp;<a name='75'>
       314.154, 314.737, 315.347, 315.984, 316.646, 317.328, 318.026, 318.742, &amp;<a name='76'>
       319.489, 320.282, 321.133, 322.045, 323.021, 324.06, 325.155, 326.299,  &amp;<a name='77'>
       327.484, 328.698, 329.933, 331.194, 332.499, 333.854, 335.254, 336.69,  &amp;<a name='78'>
       338.15, 339.628, 341.125, 342.65, 344.206, 345.797, 347.397, 348.98,    &amp;<a name='79'>
       350.551, 352.1, 354.3637, 355.7772, 357.1601, 358.5306, 359.9046,       &amp;<a name='80'>
       361.4157, 363.0445, 364.7761, 366.6064, 368.5322, 370.534, 372.5798,    &amp;<a name='81'>
       374.6564, 376.7656, 378.9087, 381.0864, 383.2994, 385.548, 387.8326,    &amp;<a name='82'>
       390.1536, 392.523, 394.9625, 397.4806, 400.075, 402.7444, 405.4875,     &amp;<a name='83'>
       408.3035, 411.1918, 414.1518, 417.1831, 420.2806, 423.4355, 426.6442,   &amp;<a name='84'>
       429.9076, 433.2261, 436.6002, 440.0303, 443.5168, 447.06, 450.6603,     &amp;<a name='85'>
       454.3059, 457.9756, 461.6612, 465.3649, 469.0886, 472.8335, 476.6008,   &amp;<a name='86'>
       480.3916, 484.2069, 488.0473, 491.9184, 495.8295, 499.7849, 503.7843,   &amp;<a name='87'>
       507.8278, 511.9155, 516.0476, 520.2243, 524.4459, 528.7127, 533.0213,   &amp;<a name='88'>
       537.3655, 541.7429, 546.1544, 550.6005, 555.0819, 559.5991, 564.1525,   &amp;<a name='89'>
       568.7429, 573.3701, 578.0399, 582.7611, 587.5379, 592.3701, 597.2572,   &amp;<a name='90'>
       602.1997, 607.1975, 612.2507, 617.3596, 622.524, 627.7528, 633.0616,    &amp;<a name='91'>
       638.457, 643.9384, 649.505, 655.1568, 660.8936, 666.7153, 672.6219,     &amp;<a name='92'>
       678.6133, 684.6945, 690.8745, 697.1569, 703.5416, 710.0284, 716.6172,   &amp;<a name='93'>
       723.308, 730.1008, 736.9958, 743.993, 751.0975, 758.3183, 765.6594,     &amp;<a name='94'>
       773.1207, 780.702, 788.4033, 796.2249, 804.1667, 812.2289, 820.4118,    &amp;<a name='95'>
       828.6444, 828.6444 /)<a name='96'>
<a name='97'>
  PUBLIC :: read_CAMgases<a name='98'>
<a name='99'>
CONTAINS<a name='100'>
  <a name='101'>
<A NAME='READ_CAMGASES'><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='102'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>read_CAMgases</font>(yr, julian, model, co2vmr, n2ovmr, ch4vmr, cfc11vmr, cfc12vmr)  <A href='../../call_to/READ_CAMGASES.html' TARGET='index'>4</A>,<A href='../../call_from/READ_CAMGASES.html' TARGET='index'>18</A><a name='103'>
<a name='104'>
    INTEGER, INTENT(IN)            :: yr<a name='105'>
    REAL, INTENT(IN)               :: julian<a name='106'>
    CHARACTER(LEN=*), INTENT(IN)   :: model           <font color=#447700>! Radiation scheme name<a name='107'></font>
    REAL(r8), OPTIONAL, INTENT(OUT)    :: co2vmr, n2ovmr, ch4vmr, cfc11vmr, cfc12vmr<a name='108'>
<a name='109'>
<font color=#447700>!Local<a name='110'></font>
    <a name='111'>
    INTEGER                                          :: yearIN, found_yearIN, iyear  &amp;<a name='112'>
                                                       ,yr1,yr2<a name='113'>
    INTEGER                                         :: mondata(1:cyr)<a name='114'>
    LOGICAL, EXTERNAL                                :: wrf_dm_on_monitor<a name='115'>
    INTEGER, EXTERNAL                                :: get_unused_unit<a name='116'>
      <a name='117'>
    INTEGER                                          :: istatus, iunit, idata        <a name='118'>
    INTEGER, SAVE                             :: VARCAM_in_years<a name='119'>
    integer                                          :: nyrm, nyrp, njulm, njulp<a name='120'>
    LOGICAL                                          :: exists<a name='121'>
    LOGICAL, SAVE                                    :: READtrFILE=.FALSE.<a name='122'>
    CHARACTER(LEN=256)                               :: message<a name='123'>
    INTEGER                                   :: monday(13)=(/0,31,28,31,30,31,30,31,31,30,31,30,31/)<a name='124'>
    INTEGER                                   :: mondayi(13)<a name='125'>
    INTEGER                                   :: my1,my2,my3, tot_valid<a name='126'>
    <a name='127'>
<font color=#447700>! CLWRF-UC June.09  (Copy from share/wrf_tsin.F)<a name='128'></font>
    IF ( .NOT. READtrFILE ) THEN<a name='129'>
       READtrFILE= .TRUE.<a name='130'>
       <a name='131'>
       INQUIRE(FILE='CAMtr_volume_mixing_ratio', EXIST=exists)<a name='132'>
       <a name='133'>
       IF (exists) THEN<a name='134'>
          iunit = <A href='../../html_code/share/wrf_tsin.F.html#GET_UNUSED_UNIT'>get_unused_unit</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_UNUSED_UNIT_1">()<a name='135'>
          IF ( iunit &lt;= 0 ) THEN<a name='136'>
             IF ( wrf_dm_on_monitor() ) THEN<a name='137'>
                CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_985">('Error in module_ra_rrtm: could not find a free Fortran unit.')<a name='138'>
             END IF<a name='139'>
          END IF<a name='140'>
          <a name='141'>
          <font color=#447700>! Read volume mixing ratio <a name='142'></font>
          OPEN(UNIT=iunit, FILE='CAMtr_volume_mixing_ratio', FORM='formatted', &amp;<a name='143'>
               STATUS='old', IOSTAT=istatus)<a name='144'>
          <a name='145'>
          IF (istatus == 0) THEN<a name='146'>
             <font color=#447700>! Ignore first two lines which constitute a header<a name='147'></font>
             READ(UNIT=iunit, FMT='(1X)')<a name='148'>
             READ(UNIT=iunit, FMT='(1X)')<a name='149'>
             <a name='150'>
             istatus = 0<a name='151'>
             idata = 1<a name='152'>
             DO WHILE (istatus == 0)<a name='153'>
                READ(UNIT=iunit, FMT='(I4, 1x, F8.3,1x, 4(F10.3,1x))', IOSTAT=istatus)    &amp;<a name='154'>
                     yrdata(idata), co2r(idata), n2or(idata), ch4r(idata), cfc11r(idata), &amp;<a name='155'>
                     cfc12r(idata)<a name='156'>
                IF ( wrf_dm_on_monitor() ) THEN<a name='157'>
                   WRITE(message,*)'CLWRF reading...: istatus:',istatus,' idata:',idata,   &amp;<a name='158'>
                        ' year:', yrdata(idata), ' co2: ',co2r(idata), ' n2o: ',&amp;<a name='159'>
                        n2or(idata),' ch4:',ch4r(idata)<a name='160'>
                   call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_769">( 0, message) <a name='161'>
                ENDIF<a name='162'>
                mondata(idata) = 6<a name='163'>
                <a name='164'>
                idata=idata+1<a name='165'>
             END DO<a name='166'>
<a name='167'>
             IF (istatus /= -1) THEN<a name='168'>
                PRINT *,'CLWRF -- clwrf -- CLWRF ALERT<font color=#447700>!'<a name='169'></font>
                PRINT *,"   Not normal ending of 'CAMtr_volume_mixing_ratio' file"<a name='170'>
                PRINT *,"   Lecture ends with 'IOSTAT'=",istatus<a name='171'>
             END IF<a name='172'>
             VARCAM_in_years = idata - 1<a name='173'>
             CLOSE(iunit)<a name='174'>
<a name='175'>
             <font color=#447700>! Calculate the julian day for each month.<a name='176'></font>
             DO idata=1,VARCAM_in_years<a name='177'>
                mondayi = monday<a name='178'>
                MY1=MOD(yrdata(idata),4)<a name='179'>
                MY2=MOD(yrdata(idata),100)<a name='180'>
                MY3=MOD(yrdata(idata),400)<a name='181'>
                IF(MY1.EQ.0.AND.MY2.NE.0.OR.MY3.EQ.0) mondayi(3)=29<a name='182'>
                juldata(idata) = sum(mondayi(1:mondata(idata)))+real(mondayi(mondata(idata)+1))/2.-0.5   <font color=#447700>! 1st Jan 00:00 = 0 julian day<a name='183'></font>
             ENDDO<a name='184'>
          ENDIF<a name='185'>
       ELSE<a name='186'>
          PRINT *,"CLWRF -- clwrf -- CLWRF ALERT<font color=#447700>!"<a name='187'></font>
          PRINT *,"   'CAMtr_volume_mixing_ratio' does not exists"<a name='188'>
          PRINT *,'   Recovering original concentrations'<a name='189'>
          <a name='190'>
          <font color=#447700>!ccc Fake yrdata. Won't be use but a value &gt; yr is needed so that<a name='191'></font>
          <font color=#447700>! everything work.<a name='192'></font>
          <font color=#447700>! With negative mixing ratios in co2r, n2or and ch4r, no interpolation<a name='193'></font>
          <font color=#447700>! is done and we use the constant mixing ratios that were used before<a name='194'></font>
          <font color=#447700>! CLWRF modifications.<a name='195'></font>
          yrdata = yr + 1<a name='196'>
          juldata = 1<a name='197'>
          co2r   = -9999.999<a name='198'>
          n2or   = -9999.999<a name='199'>
          ch4r   = -9999.999<a name='200'>
          cfc11r = -9999.999<a name='201'>
          cfc12r = -9999.999<a name='202'>
<a name='203'>
          <font color=#447700>! For CAM model, recovers original data sets.<a name='204'></font>
          IF (model .eq. "CAM") THEN<a name='205'>
             yrdata(1:VARCAM_in_years) = yr_CAM<a name='206'>
             co2r(1:VARCAM_in_years)   = co2r_CAM<a name='207'>
          ENDIF<a name='208'>
       ENDIF <font color=#447700>! CAMtr_volume_mixing_ratio exists<a name='209'></font>
       <a name='210'>
    ENDIF <font color=#447700>! File already opened and read <a name='211'></font>
    <a name='212'>
    found_yearIN=0<a name='213'>
    iyear=1<a name='214'>
    <font color=#447700>!ccc Crash if iyear get &gt; cyr (max. # of years in the mixing ratio file) ?<a name='215'></font>
    <font color=#447700>!DO WHILE (found_yearIN == 0) <a name='216'></font>
    DO WHILE (found_yearIN == 0 .and. iyear &lt;= cyr)<a name='217'>
       IF (yrdata(iyear) .GT. yr )  THEN<a name='218'>
          yearIN=iyear<a name='219'>
          found_yearIN=1<a name='220'>
       ELSE IF ((yrdata(iyear) .EQ. yr) .AND. (juldata(iyear) .GT. julian)) THEN<a name='221'>
          yearIN=iyear<a name='222'>
          found_yearIN = 1<a name='223'>
       ENDIF<a name='224'>
       iyear=iyear+1<a name='225'>
    ENDDO<a name='226'>
    <a name='227'>
    <font color=#447700>! Prevent yr &gt; last year in data<a name='228'></font>
<font color=#447700>!    IF (yearIN .ge. VARCAM_in_years) yearIN=VARCAM_in_years-1<a name='229'></font>
    IF (iyear .ge. VARCAM_in_years) then<a name='230'>
       yearIN=VARCAM_in_years-1<a name='231'>
       found_yearIN = 1<a name='232'>
    ENDIF<a name='233'>
    <a name='234'>
    IF (found_yearIN .NE. 0 ) THEN<a name='235'>
       if (yearIN .eq. 1) yearIN = yearIN + 1    <font color=#447700>! To take 2 first lines of the file<a name='236'></font>
       nyrm = yrdata(yearIN-1)<a name='237'>
       njulm = juldata(yearIN-1)<a name='238'>
       nyrp = yrdata(yearIN)<a name='239'>
       njulp = juldata(yearIN)<a name='240'>
    ENDIF<a name='241'>
<a name='242'>
    IF (PRESENT(co2vmr)) THEN<a name='243'>
       co2vmr=-9999.999<a name='244'>
       if (found_yearIN /= 0) then<a name='245'>
          <font color=#447700>! Interpolate data only if we have at least 2 valid concentrations.<a name='246'></font>
          tot_valid = count(co2r(1:VARCAM_in_years) &gt; 0)<a name='247'>
          IF (tot_valid &gt;= 2 ) THEN<a name='248'>
             CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#VALID_YEARS'>valid_years</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="VALID_YEARS_1">(yearIN, co2r, VARCAM_in_years,yr1, yr2)<a name='249'>
<a name='250'>
             <font color=#447700>! Set nyrm, njulm, nyrp, njulp<a name='251'></font>
             nyrm = yrdata(yr1)<a name='252'>
             njulm = juldata(yr1)<a name='253'>
             nyrp = yrdata(yr2)<a name='254'>
             njulp = juldata(yr2)<a name='255'>
<a name='256'>
             CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#INTERPOLATE_CAMGASES'>interpolate_CAMgases</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERPOLATE_CAMGASES_1">(yr, julian, nyrm, njulm, yr1, yr2, nyrp, njulp, co2r, co2vmr)<a name='257'>
          ENDIF<a name='258'>
       endif<a name='259'>
       <font color=#447700>! Verification of interpolated values. In case of no value <a name='260'></font>
       <font color=#447700>! original values extracted from ghg_surfvals.F90 module<a name='261'></font>
<a name='262'>
       IF (co2vmr &lt; 0. .or. found_yearIN == 0) THEN<a name='263'>
          CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#ORIG_VAL'>orig_val</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ORIG_VAL_1">("CO2",model,co2vmr)<a name='264'>
       ELSE<a name='265'>
          <font color=#447700>! If extrapolation, need to bound the data to pre-industrial concentrations<a name='266'></font>
          if (co2vmr &lt; 270.) co2vmr = 270.<a name='267'>
          co2vmr=co2vmr*1.e-06<a name='268'>
       END IF<a name='269'>
    ENDIF<a name='270'>
<a name='271'>
    IF (PRESENT(n2ovmr)) THEN<a name='272'>
       n2ovmr=-9999.999<a name='273'>
       if (found_yearIN /= 0) then<a name='274'>
          tot_valid = count(n2or(1:VARCAM_in_years) &gt; 0)<a name='275'>
          IF (tot_valid &gt;= 2 ) THEN<a name='276'>
             CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#VALID_YEARS'>valid_years</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="VALID_YEARS_2">(yearIN, n2or, VARCAM_in_years,yr1, yr2)<a name='277'>
<a name='278'>
             <font color=#447700>! Set nyrm, njulm, nyrp, njulp<a name='279'></font>
             nyrm = yrdata(yr1)<a name='280'>
             njulm = juldata(yr1)<a name='281'>
             nyrp = yrdata(yr2)<a name='282'>
             njulp = juldata(yr2)<a name='283'>
<a name='284'>
             CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#INTERPOLATE_CAMGASES'>interpolate_CAMgases</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERPOLATE_CAMGASES_2">(yr, julian, nyrm, njulm, yr1, yr2, nyrp, njulp, n2or, n2ovmr)<a name='285'>
          ENDIF<a name='286'>
       endif<a name='287'>
       <a name='288'>
       IF (n2ovmr &lt; 0. .or. found_yearIN == 0) THEN<a name='289'>
          CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#ORIG_VAL'>orig_val</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ORIG_VAL_2">("N2O",model,n2ovmr)<a name='290'>
       ELSE<a name='291'>
          <font color=#447700>! If extrapolation, need to bound the data to pre-industrial concentrations<a name='292'></font>
          if (n2ovmr &lt; 270.) n2ovmr = 270.          <a name='293'>
          n2ovmr=n2ovmr*1.e-09<a name='294'>
       ENDIF<a name='295'>
       <a name='296'>
    ENDIF<a name='297'>
    <a name='298'>
    IF (PRESENT(ch4vmr)) THEN<a name='299'>
       ch4vmr=-9999.999<a name='300'>
       if (found_yearIN /= 0) then<a name='301'>
          tot_valid = count(ch4r(1:VARCAM_in_years) &gt; 0)<a name='302'>
          IF (tot_valid &gt;= 2 ) THEN<a name='303'>
             CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#VALID_YEARS'>valid_years</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="VALID_YEARS_3">(yearIN, ch4r, VARCAM_in_years,yr1, yr2)<a name='304'>
<a name='305'>
             <font color=#447700>! Set nyrm, njulm, nyrp, njulp<a name='306'></font>
             nyrm = yrdata(yr1)<a name='307'>
             njulm = juldata(yr1)<a name='308'>
             nyrp = yrdata(yr2)<a name='309'>
             njulp = juldata(yr2)<a name='310'>
<a name='311'>
             CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#INTERPOLATE_CAMGASES'>interpolate_CAMgases</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERPOLATE_CAMGASES_3">(yr, julian, nyrm, njulm, yr1, yr2, nyrp, njulp, ch4r, ch4vmr)<a name='312'>
          endif<a name='313'>
       endif<a name='314'>
       <a name='315'>
       IF (ch4vmr &lt; 0. .or. found_yearIN == 0) THEN<a name='316'>
          CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#ORIG_VAL'>orig_val</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ORIG_VAL_3">("CH4",model,ch4vmr)<a name='317'>
       ELSE<a name='318'>
          <font color=#447700>! If extrapolation, need to bound the data to pre-industrial concentrations<a name='319'></font>
          if (ch4vmr &lt; 700. ) ch4vmr = 700.<a name='320'>
          ch4vmr=ch4vmr*1.e-09<a name='321'>
       ENDIF<a name='322'>
    ENDIF<a name='323'>
    <a name='324'>
    IF (PRESENT(cfc11vmr)) THEN<a name='325'>
       cfc11vmr = -9999.999<a name='326'>
       if (found_yearIN /= 0) then<a name='327'>
          tot_valid = count(cfc11r(1:VARCAM_in_years) &gt; 0)<a name='328'>
          IF (tot_valid &gt;= 2 ) THEN<a name='329'>
             CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#VALID_YEARS'>valid_years</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="VALID_YEARS_4">(yearIN, cfc11r, VARCAM_in_years,yr1, yr2)<a name='330'>
<a name='331'>
             <font color=#447700>! Set nyrm, njulm, nyrp, njulp<a name='332'></font>
             nyrm = yrdata(yr1)<a name='333'>
             njulm = juldata(yr1)<a name='334'>
             nyrp = yrdata(yr2)<a name='335'>
             njulp = juldata(yr2)<a name='336'>
<a name='337'>
             CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#INTERPOLATE_CAMGASES'>interpolate_CAMgases</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERPOLATE_CAMGASES_4">(yr, julian, nyrm, njulm, yr1, yr2, nyrp, njulp, cfc11r, cfc11vmr)<a name='338'>
          endif<a name='339'>
       endif<a name='340'>
       <a name='341'>
       IF (cfc11vmr &lt; 0. .or. found_yearIN == 0) THEN<a name='342'>
          CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#ORIG_VAL'>orig_val</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ORIG_VAL_4">("CFC11",model,cfc11vmr)<a name='343'>
       ELSE<a name='344'>
          cfc11vmr=cfc11vmr*1.e-12<a name='345'>
       ENDIF<a name='346'>
    ENDIF<a name='347'>
    <a name='348'>
    IF (PRESENT(cfc12vmr)) THEN<a name='349'>
       cfc12vmr = -9999.999<a name='350'>
       if (found_yearIN /= 0) then<a name='351'>
          tot_valid = count(cfc12r(1:VARCAM_in_years) &gt; 0)<a name='352'>
          IF (tot_valid &gt;= 2 ) THEN<a name='353'>
             CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#VALID_YEARS'>valid_years</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="VALID_YEARS_5">(yearIN, cfc12r, VARCAM_in_years,yr1, yr2)<a name='354'>
<a name='355'>
             <font color=#447700>! Set nyrm, njulm, nyrp, njulp<a name='356'></font>
             nyrm = yrdata(yr1)<a name='357'>
             njulm = juldata(yr1)<a name='358'>
             nyrp = yrdata(yr2)<a name='359'>
             njulp = juldata(yr2)<a name='360'>
<a name='361'>
             CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#INTERPOLATE_CAMGASES'>interpolate_CAMgases</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERPOLATE_CAMGASES_5">(yr, julian, nyrm, njulm, yr1, yr2, nyrp, njulp, cfc12r, cfc12vmr)<a name='362'>
          endif<a name='363'>
       endif<a name='364'>
       <a name='365'>
       IF (cfc12vmr &lt; 0. .or. found_yearIN == 0) THEN<a name='366'>
          CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#ORIG_VAL'>orig_val</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ORIG_VAL_5">("CFC12",model,cfc12vmr)<a name='367'>
       ELSE<a name='368'>
          cfc12vmr=cfc12vmr*1.e-12<a name='369'>
       ENDIF<a name='370'>
    ENDIF<a name='371'>
       <a name='372'>
  END SUBROUTINE read_CAMgases<a name='373'>
  <a name='374'>
<A NAME='VALID_YEARS'><A href='../../html_code/phys/module_ra_clWRF_support.F.html#VALID_YEARS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='375'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>valid_years</font>(yearIN, gas, tot_years, yr1, yr2) <A href='../../call_to/VALID_YEARS.html' TARGET='index'>5</A><a name='376'>
<a name='377'>
<font color=#447700>! Find <a name='378'></font>
    INTEGER, INTENT(IN) :: yearIN, tot_years<a name='379'>
    INTEGER, INTENT(OUT) :: yr2, yr1<a name='380'>
    REAL(r8), INTENT(IN) :: gas(:)<a name='381'>
<a name='382'>
    <font color=#447700>! Local variables<a name='383'></font>
    INTEGER :: yr_loc, idata<a name='384'>
    <a name='385'>
<a name='386'>
    yr_loc = yearIN<a name='387'>
    yr2 = yr_loc<a name='388'>
    yr1 = yr_loc-1<a name='389'>
    <a name='390'>
    <font color=#447700>! If all valid dates are &gt; yearIN then find the 2 lowest dates with<a name='391'></font>
    <font color=#447700>! valid data.<a name='392'></font>
    IF (count(gas(1:yr_loc-1) &gt; 0.) == 0) THEN<a name='393'>
<font color=#447700>!ccc       DO idata = yr_loc-1, tot_years-1<a name='394'></font>
       DO idata = yr_loc, tot_years-1<a name='395'>
          IF (gas(idata) &gt; 0.) THEN<a name='396'>
             yr1 = idata<a name='397'>
             EXIT<a name='398'>
          ENDIF<a name='399'>
       ENDDO<a name='400'>
<font color=#447700>!ccc       DO idata = yr1, tot_years<a name='401'></font>
       DO idata = yr1+1, tot_years<a name='402'>
          IF (gas(idata) &gt; 0.) THEN<a name='403'>
             yr2 = idata<a name='404'>
             EXIT<a name='405'>
          ENDIF<a name='406'>
       ENDDO<a name='407'>
    ELSE  <font color=#447700>! There is at least 1 valid year below yearIN<a name='408'></font>
       IF (gas(yr_loc) &lt; 0.) THEN<a name='409'>
          <a name='410'>
          <font color=#447700>! Find the closest valid year, look for higher year first<a name='411'></font>
          IF (any(gas(yr_loc:tot_years) &gt; 0)) THEN<a name='412'>
             DO idata=yr_loc+1, tot_years<a name='413'>
                IF (gas(idata) &gt; 0) THEN<a name='414'>
                   yr2 = idata<a name='415'>
                   exit<a name='416'>
                ENDIF<a name='417'>
             ENDDO<a name='418'>
          ELSE  <font color=#447700>! Need to take lower years and extrapolate data.<a name='419'></font>
             DO idata=yr_loc-1,2,-1<a name='420'>
                IF (gas(idata) &gt; 0) THEN<a name='421'>
                   yr2 = idata<a name='422'>
                   exit<a name='423'>
                ENDIF<a name='424'>
             ENDDO<a name='425'>
          ENDIF<a name='426'>
       ENDIF<a name='427'>
       <a name='428'>
       yr_loc = min(yr_loc-1, yr2-1)<a name='429'>
       IF (gas(yr_loc) &lt; 0.) THEN<a name='430'>
          <a name='431'>
          <font color=#447700>! Find the closest valid year, lower than yr1<a name='432'></font>
          IF (any(gas(1:yr_loc-1) &gt; 0)) THEN<a name='433'>
             DO idata=yr_loc-1,1,-1<a name='434'>
                IF (gas(idata) &gt; 0) THEN<a name='435'>
                   yr1 = idata<a name='436'>
                   exit<a name='437'>
                ENDIF<a name='438'>
             ENDDO<a name='439'>
          ELSE  <font color=#447700>! Need to take higher years and extrapolate data.<a name='440'></font>
             print*, 'Problem: this case should never happen'<a name='441'>
          ENDIF<a name='442'>
       ELSE <font color=#447700>! Then yr1 is yr_loc (first valid date &lt; yr2)<a name='443'></font>
          yr1 = yr_loc<a name='444'>
       ENDIF<a name='445'>
    ENDIF<a name='446'>
  END SUBROUTINE valid_years<a name='447'>
<a name='448'>
<A NAME='INTERPOLATE_CAMGASES'><A href='../../html_code/phys/module_ra_clWRF_support.F.html#INTERPOLATE_CAMGASES' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='449'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>interpolate_CAMgases</font>(yr, julian, yeari, juli, yr1, yr2, yearf, julf, gas, interp_gas) <A href='../../call_to/INTERPOLATE_CAMGASES.html' TARGET='index'>5</A><a name='450'>
    IMPLICIT NONE<a name='451'>
<font color=#447700>! These subroutine interpolates a trace gas concentration from a non-homogeneously <a name='452'></font>
<font color=#447700>! distributed gas concentration evolution<a name='453'></font>
    INTEGER, INTENT (IN)                      :: yr, yeari, yr1, yr2, yearf, juli, julf<a name='454'>
    REAL, INTENT (IN)                         :: julian<a name='455'>
    REAL(r8), DIMENSION(500), INTENT (IN)         :: gas<a name='456'>
    REAL(r8), INTENT (OUT)                    :: interp_gas<a name='457'>
<font color=#447700>!Local<a name='458'></font>
    REAL(r8)                                  :: yearini, yearend, gas1, gas2<a name='459'>
    REAL                                      :: doymodel, doydatam, doydatap,    &amp;<a name='460'>
                                                 deltat, fact1, fact2, x<a name='461'>
    INTEGER                                   :: ny, my1,my2,my3,nday, maxyear, minyear<a name='462'>
 <a name='463'>
    <a name='464'>
    <font color=#447700>! Add support for leap-years<a name='465'></font>
<a name='466'>
    <font color=#447700>! Find smallest and largest year: yearf &gt;= yeari since the file is ordered with increasing dates.<a name='467'></font>
    minyear = MIN(yr,yeari)<a name='468'>
    maxyear = MAX(yr,yearf)<a name='469'>
<a name='470'>
    <font color=#447700>! Initialise with the day in the year for each date.<a name='471'></font>
    fact2 = juli<a name='472'>
    fact1 = julf<a name='473'>
    x = julian<a name='474'>
<a name='475'>
    <font color=#447700>! Calculate the julian day (day 0 = 1 Jan minyear at 00:00)<a name='476'></font>
    DO ny=minyear, maxyear-1<a name='477'>
       nday = 365<a name='478'>
       <font color=#447700>! Leap-year?<a name='479'></font>
       MY1=MOD(ny,4)<a name='480'>
       MY2=MOD(ny,100)<a name='481'>
       MY3=MOD(ny,400)<a name='482'>
       IF(MY1.EQ.0.AND.MY2.NE.0.OR.MY3.EQ.0) nday=366<a name='483'>
       <a name='484'>
       if (ny &lt; yeari) then<a name='485'>
          fact2 = fact2+nday<a name='486'>
       endif<a name='487'>
       if (ny &lt; yr) then<a name='488'>
          x = x+nday<a name='489'>
       endif<a name='490'>
       if (ny &lt; yearf) then<a name='491'>
          fact1 = fact1+nday<a name='492'>
       endif<a name='493'>
    enddo<a name='494'>
<a name='495'>
    deltat = fact1-fact2<a name='496'>
    fact1 = (fact1 - x)/deltat<a name='497'>
    fact2 = (x - fact2)/deltat<a name='498'>
<a name='499'>
    interp_gas = gas(yr1)*fact1+gas(yr2)*fact2 <a name='500'>
<a name='501'>
    IF (interp_gas .LT. 0. ) THEN<a name='502'>
       interp_gas=-99999.<a name='503'>
    ENDIF<a name='504'>
    <a name='505'>
  END SUBROUTINE interpolate_CAMgases<a name='506'>
<a name='507'>
<A NAME='INTERPOLATE_LIN'><A href='../../html_code/phys/module_ra_clWRF_support.F.html#INTERPOLATE_LIN' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='508'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>interpolate_lin</font>(x1,y1,x2,y2,x0,y)<a name='509'>
    IMPLICIT NONE<a name='510'>
<font color=#447700>! Program to interpolate values y=a+b*x with:<a name='511'></font>
<font color=#447700>!       a=y1<a name='512'></font>
<font color=#447700>!       b=(y2-y1)/(x2-x1)<a name='513'></font>
<font color=#447700>!       x=abs(x1-x0)<a name='514'></font>
<a name='515'>
    REAL, INTENT (IN)                       :: x1,x2,x0<a name='516'>
    REAL(r8), INTENT (IN)                   :: y1,y2<a name='517'>
    REAL(r8), INTENT (OUT)                  :: y<a name='518'>
    REAL(r8)                                :: a,b,x<a name='519'>
    <a name='520'>
    a=y1<a name='521'>
    b=(y2-y1)/(x2-x1)<a name='522'>
    <a name='523'>
    IF (x0 .GE. x1) THEN<a name='524'>
       x=x0-x1<a name='525'>
    ELSE<a name='526'>
       x=x1-x0<a name='527'>
       b=-b<a name='528'>
    ENDIF<a name='529'>
    <a name='530'>
    y=a+b*x<a name='531'>
    <a name='532'>
  END SUBROUTINE interpolate_lin<a name='533'>
<a name='534'>
<a name='535'>
<A NAME='ORIG_VAL'><A href='../../html_code/phys/module_ra_clWRF_support.F.html#ORIG_VAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='536'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>orig_val</font>(tracer,model,out) <A href='../../call_to/ORIG_VAL.html' TARGET='index'>5</A>,<A href='../../call_from/ORIG_VAL.html' TARGET='index'>4</A><a name='537'>
<a name='538'>
    CHARACTER(LEN=*), INTENT(IN) :: tracer  <font color=#447700>! The trace gas name<a name='539'></font>
    CHARACTER(LEN=*), INTENT(IN) :: model   <font color=#447700>! The radiation scheme name<a name='540'></font>
    REAL(r8), INTENT(INOUT)      :: out     <font color=#447700>! The output value<a name='541'></font>
<font color=#447700>!Local<a name='542'></font>
    LOGICAL, EXTERNAL            :: wrf_dm_on_monitor<a name='543'>
    CHARACTER(LEN=256)           :: message<a name='544'>
<a name='545'>
<a name='546'>
    IF (model .eq. "CAM") THEN<a name='547'>
       IF (tracer .eq. "CO2") THEN<a name='548'>
          out = 3.55e-4<a name='549'>
<a name='550'>
       ELSE IF (tracer .eq. "N2O") THEN<a name='551'>
          out = 0.311e-6<a name='552'>
<a name='553'>
       ELSE IF (tracer .eq. "CH4") THEN<a name='554'>
          out = 1.714e-6<a name='555'>
<a name='556'>
       ELSE IF (tracer .eq. "CFC11") THEN<a name='557'>
          out = 0.280e-9<a name='558'>
<a name='559'>
       ELSE IF (tracer .eq. "CFC12") THEN<a name='560'>
          out = 0.503e-9<a name='561'>
<a name='562'>
       ELSE<a name='563'>
          IF ( wrf_dm_on_monitor() ) THEN<a name='564'>
             WRITE(message,*) 'CLWRF : Trace gas ',tracer,' not valid for scheme ',model<a name='565'>
             CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#ORIG_VAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_986">(message)<a name='566'>
          ENDIF<a name='567'>
       ENDIF<a name='568'>
<a name='569'>
    ELSE IF (model .eq. "RRTM") THEN<a name='570'>
       IF (tracer .eq. "CO2") THEN<a name='571'>
          out = 3.300e-4<a name='572'>
<a name='573'>
       ELSE IF ((tracer .eq. "N2O") .or. &amp;<a name='574'>
                (tracer .eq. "CH4")) THEN<a name='575'>
          out = 0.<a name='576'>
       ELSE<a name='577'>
          IF ( wrf_dm_on_monitor() ) THEN<a name='578'>
             WRITE(message,*) 'CLWRF : Trace gas ',tracer,' not valid for scheme ',model<a name='579'>
             CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#ORIG_VAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_987">(message)<a name='580'>
          ENDIF<a name='581'>
       ENDIF<a name='582'>
<a name='583'>
    ELSE IF (model .eq. "RRTMG") THEN<a name='584'>
       IF (tracer .eq. "CO2") THEN<a name='585'>
          out = 379.e-6<a name='586'>
<a name='587'>
       ELSE IF (tracer .eq. "N2O") THEN<a name='588'>
          out = 319e-9<a name='589'>
<a name='590'>
       ELSE IF (tracer .eq. "CH4") THEN<a name='591'>
          out = 1774.e-9<a name='592'>
<a name='593'>
       ELSE IF (tracer .eq. "CFC11") THEN<a name='594'>
          out = 0.251e-9<a name='595'>
<a name='596'>
       ELSE IF (tracer .eq. "CFC12") THEN<a name='597'>
          out = 0.538e-9<a name='598'>
<a name='599'>
       ELSE<a name='600'>
          IF ( wrf_dm_on_monitor() ) THEN<a name='601'>
             WRITE(message,*) 'CLWRF : Trace gas ',tracer,' not valid for scheme ',model<a name='602'>
             CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#ORIG_VAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_988">(message)<a name='603'>
          ENDIF<a name='604'>
       ENDIF<a name='605'>
<a name='606'>
    ELSE<a name='607'>
       IF ( wrf_dm_on_monitor() ) THEN<a name='608'>
          WRITE(message,*) 'CLWRF not implemented for the ',model,' radiative scheme.'<a name='609'>
          CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_clWRF_support.F.html#ORIG_VAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_989">(message)<a name='610'>
       ENDIF<a name='611'>
    ENDIF<a name='612'>
<a name='613'>
  END SUBROUTINE orig_val<a name='614'>
<a name='615'>
END MODULE module_ra_clWRF_support<a name='616'>
</pre></body></html>