<HTML> <BODY BGCOLOR=#ddddee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!!MODULE module_ra_rrtmg_sw<a name='2'></font>
                <a name='3'>
<A NAME='PARRRSW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='4'>
      <font color=#993300>module </font><font color=#cc0000>parrrsw</font> <A href='../../call_to/PARRRSW.html' TARGET='index'>38</A>,<A href='../../call_from/PARRRSW.html' TARGET='index'>1</A><a name='5'>
<a name='6'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_32"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='7'>
<a name='8'>
<font color=#447700>!     implicit none<a name='9'></font>
      save<a name='10'>
<a name='11'>
<font color=#447700>!------------------------------------------------------------------<a name='12'></font>
<font color=#447700>! rrtmg_sw main parameters<a name='13'></font>
<font color=#447700>!<a name='14'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, jul1998<a name='15'></font>
<font color=#447700>! Revised: MJIacono, AER, jun2006<a name='16'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='17'></font>
<font color=#447700>!------------------------------------------------------------------<a name='18'></font>
<a name='19'>
<font color=#447700>!  name     type     purpose<a name='20'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='21'></font>
<font color=#447700>! mxlay  :  integer: maximum number of layers<a name='22'></font>
<font color=#447700>! mg     :  integer: number of original g-intervals per spectral band<a name='23'></font>
<font color=#447700>! nbndsw :  integer: number of spectral bands<a name='24'></font>
<font color=#447700>! naerec :  integer: number of aerosols (iaer=6, ecmwf aerosol option)<a name='25'></font>
<font color=#447700>! ngptsw :  integer: total number of reduced g-intervals for rrtmg_lw<a name='26'></font>
<font color=#447700>! ngNN   :  integer: number of reduced g-intervals per spectral band<a name='27'></font>
<font color=#447700>! ngsNN  :  integer: cumulative number of g-intervals per band<a name='28'></font>
<font color=#447700>!------------------------------------------------------------------<a name='29'></font>
<a name='30'>
      integer(kind=im), parameter :: mxlay  = 203    <font color=#447700>!jplay, klev<a name='31'></font>
      integer(kind=im), parameter :: mg     = 16     <font color=#447700>!jpg<a name='32'></font>
      integer(kind=im), parameter :: nbndsw = 14     <font color=#447700>!jpsw, ksw<a name='33'></font>
      integer(kind=im), parameter :: naerec  = 6     <font color=#447700>!jpaer<a name='34'></font>
      integer(kind=im), parameter :: mxmol  = 38<a name='35'>
      integer(kind=im), parameter :: nstr   = 2<a name='36'>
      integer(kind=im), parameter :: nmol   = 7<a name='37'>
<font color=#447700>! Use for 112 g-point model   <a name='38'></font>
      integer(kind=im), parameter :: ngptsw = 112    <font color=#447700>!jpgpt<a name='39'></font>
<font color=#447700>! Use for 224 g-point model   <a name='40'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngptsw = 224   !jpgpt<a name='41'></font>
<a name='42'>
<font color=#447700>! may need to rename these - from v2.6<a name='43'></font>
      integer(kind=im), parameter :: jpband   = 29<a name='44'>
      integer(kind=im), parameter :: jpb1     = 16   <font color=#447700>!istart<a name='45'></font>
      integer(kind=im), parameter :: jpb2     = 29   <font color=#447700>!iend<a name='46'></font>
<a name='47'>
      integer(kind=im), parameter :: jmcmu    = 32<a name='48'>
      integer(kind=im), parameter :: jmumu    = 32<a name='49'>
      integer(kind=im), parameter :: jmphi    = 3<a name='50'>
      integer(kind=im), parameter :: jmxang   = 4<a name='51'>
      integer(kind=im), parameter :: jmxstr   = 16<a name='52'>
<a name='53'>
<font color=#447700>! Use for 112 g-point model   <a name='54'></font>
      integer(kind=im), parameter :: ng16 = 6<a name='55'>
      integer(kind=im), parameter :: ng17 = 12<a name='56'>
      integer(kind=im), parameter :: ng18 = 8<a name='57'>
      integer(kind=im), parameter :: ng19 = 8<a name='58'>
      integer(kind=im), parameter :: ng20 = 10<a name='59'>
      integer(kind=im), parameter :: ng21 = 10<a name='60'>
      integer(kind=im), parameter :: ng22 = 2<a name='61'>
      integer(kind=im), parameter :: ng23 = 10<a name='62'>
      integer(kind=im), parameter :: ng24 = 8<a name='63'>
      integer(kind=im), parameter :: ng25 = 6<a name='64'>
      integer(kind=im), parameter :: ng26 = 6<a name='65'>
      integer(kind=im), parameter :: ng27 = 8<a name='66'>
      integer(kind=im), parameter :: ng28 = 6<a name='67'>
      integer(kind=im), parameter :: ng29 = 12<a name='68'>
<a name='69'>
      integer(kind=im), parameter :: ngs16 = 6<a name='70'>
      integer(kind=im), parameter :: ngs17 = 18<a name='71'>
      integer(kind=im), parameter :: ngs18 = 26<a name='72'>
      integer(kind=im), parameter :: ngs19 = 34<a name='73'>
      integer(kind=im), parameter :: ngs20 = 44<a name='74'>
      integer(kind=im), parameter :: ngs21 = 54<a name='75'>
      integer(kind=im), parameter :: ngs22 = 56<a name='76'>
      integer(kind=im), parameter :: ngs23 = 66<a name='77'>
      integer(kind=im), parameter :: ngs24 = 74<a name='78'>
      integer(kind=im), parameter :: ngs25 = 80<a name='79'>
      integer(kind=im), parameter :: ngs26 = 86<a name='80'>
      integer(kind=im), parameter :: ngs27 = 94<a name='81'>
      integer(kind=im), parameter :: ngs28 = 100<a name='82'>
      integer(kind=im), parameter :: ngs29 = 112<a name='83'>
<a name='84'>
<font color=#447700>! Use for 224 g-point model   <a name='85'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng16 = 16<a name='86'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng17 = 16<a name='87'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng18 = 16<a name='88'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng19 = 16<a name='89'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng20 = 16<a name='90'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng21 = 16<a name='91'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng22 = 16<a name='92'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng23 = 16<a name='93'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng24 = 16<a name='94'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng25 = 16<a name='95'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng26 = 16<a name='96'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng27 = 16<a name='97'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng28 = 16<a name='98'></font>
<font color=#447700>!      integer(kind=im), parameter :: ng29 = 16<a name='99'></font>
<a name='100'>
<font color=#447700>!      integer(kind=im), parameter :: ngs16 = 16<a name='101'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs17 = 32<a name='102'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs18 = 48<a name='103'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs19 = 64<a name='104'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs20 = 80<a name='105'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs21 = 96<a name='106'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs22 = 112<a name='107'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs23 = 128<a name='108'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs24 = 144<a name='109'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs25 = 160<a name='110'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs26 = 176<a name='111'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs27 = 192<a name='112'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs28 = 208<a name='113'></font>
<font color=#447700>!      integer(kind=im), parameter :: ngs29 = 224<a name='114'></font>
<a name='115'>
<font color=#447700>! Source function solar constant<a name='116'></font>
      real(kind=rb), parameter :: rrsw_scon = 1.36822e+03     <font color=#447700>! W/m2<a name='117'></font>
 <a name='118'>
      end module parrrsw<a name='119'>
<a name='120'>
<A NAME='RRSW_AER'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_AER' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='121'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_aer</font> <A href='../../call_to/RRSW_AER.html' TARGET='index'>2</A>,<A href='../../call_from/RRSW_AER.html' TARGET='index'>2</A><a name='122'>
<a name='123'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_AER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_33">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='124'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_AER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_1">, only : nbndsw, naerec<a name='125'>
<a name='126'>
<font color=#447700>!     implicit none<a name='127'></font>
      save<a name='128'>
<a name='129'>
<font color=#447700>!------------------------------------------------------------------<a name='130'></font>
<font color=#447700>! rrtmg_sw aerosol optical properties<a name='131'></font>
<font color=#447700>!<a name='132'></font>
<font color=#447700>!  Data derived from six ECMWF aerosol types and defined for<a name='133'></font>
<font color=#447700>!  the rrtmg_sw spectral intervals<a name='134'></font>
<font color=#447700>!<a name='135'></font>
<font color=#447700>! Initial: J.-J. Morcrette, ECMWF, mar2003<a name='136'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='137'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='138'></font>
<font color=#447700>!------------------------------------------------------------------<a name='139'></font>
<font color=#447700>!<a name='140'></font>
<font color=#447700>!-- The six ECMWF aerosol types are respectively:<a name='141'></font>
<font color=#447700>!<a name='142'></font>
<font color=#447700>!  1/ continental average                 2/ maritime<a name='143'></font>
<font color=#447700>!  3/ desert                              4/ urban<a name='144'></font>
<font color=#447700>!  5/ volcanic active                     6/ stratospheric background<a name='145'></font>
<font color=#447700>!<a name='146'></font>
<font color=#447700>! computed from Hess and Koepke (con, mar, des, urb)<a name='147'></font>
<font color=#447700>!          from Bonnel et al.   (vol, str)<a name='148'></font>
<font color=#447700>!<a name='149'></font>
<font color=#447700>! rrtmg_sw 14 spectral intervals (microns):<a name='150'></font>
<font color=#447700>!  3.846 -  3.077<a name='151'></font>
<font color=#447700>!  3.077 -  2.500<a name='152'></font>
<font color=#447700>!  2.500 -  2.150<a name='153'></font>
<font color=#447700>!  2.150 -  1.942<a name='154'></font>
<font color=#447700>!  1.942 -  1.626<a name='155'></font>
<font color=#447700>!  1.626 -  1.299<a name='156'></font>
<font color=#447700>!  1.299 -  1.242<a name='157'></font>
<font color=#447700>!  1.242 -  0.7782<a name='158'></font>
<font color=#447700>!  0.7782-  0.6250<a name='159'></font>
<font color=#447700>!  0.6250-  0.4415<a name='160'></font>
<font color=#447700>!  0.4415-  0.3448<a name='161'></font>
<font color=#447700>!  0.3448-  0.2632<a name='162'></font>
<font color=#447700>!  0.2632-  0.2000<a name='163'></font>
<font color=#447700>! 12.195 -  3.846<a name='164'></font>
<font color=#447700>!<a name='165'></font>
<font color=#447700>!------------------------------------------------------------------<a name='166'></font>
<font color=#447700>!<a name='167'></font>
<font color=#447700>!  name     type     purpose<a name='168'></font>
<font color=#447700>! -----   : ----   : ----------------------------------------------<a name='169'></font>
<font color=#447700>! rsrtaua : real   : ratio of average optical thickness in <a name='170'></font>
<font color=#447700>!                    spectral band to that at 0.55 micron<a name='171'></font>
<font color=#447700>! rsrpiza : real   : average single scattering albedo (unitless)<a name='172'></font>
<font color=#447700>! rsrasya : real   : average asymmetry parameter (unitless)<a name='173'></font>
<font color=#447700>!------------------------------------------------------------------<a name='174'></font>
<a name='175'>
      real(kind=rb) :: rsrtaua(nbndsw,naerec)<a name='176'>
      real(kind=rb) :: rsrpiza(nbndsw,naerec)<a name='177'>
      real(kind=rb) :: rsrasya(nbndsw,naerec)<a name='178'>
<a name='179'>
      end module rrsw_aer<a name='180'>
<a name='181'>
<A NAME='RRSW_CLD'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_CLD' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='182'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_cld</font> <A href='../../call_to/RRSW_CLD.html' TARGET='index'>2</A>,<A href='../../call_from/RRSW_CLD.html' TARGET='index'>1</A><a name='183'>
<a name='184'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_CLD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_34">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='185'>
<a name='186'>
<font color=#447700>!     implicit none<a name='187'></font>
      save<a name='188'>
<a name='189'>
<font color=#447700>!------------------------------------------------------------------<a name='190'></font>
<font color=#447700>! rrtmg_sw cloud property coefficients<a name='191'></font>
<font color=#447700>!<a name='192'></font>
<font color=#447700>! Initial: J.-J. Morcrette, ECMWF, oct1999<a name='193'></font>
<font color=#447700>! Revised: J. Delamere/MJIacono, AER, aug2005<a name='194'></font>
<font color=#447700>! Revised: MJIacono, AER, nov2005<a name='195'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='196'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='197'></font>
<font color=#447700>!------------------------------------------------------------------<a name='198'></font>
<font color=#447700>!<a name='199'></font>
<font color=#447700>!  name     type     purpose<a name='200'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='201'></font>
<font color=#447700>! xxxliq1 : real   : optical properties (extinction coefficient, single <a name='202'></font>
<font color=#447700>!                    scattering albedo, assymetry factor) from<a name='203'></font>
<font color=#447700>!                    Hu &amp; Stamnes, j. clim., 6, 728-742, 1993.  <a name='204'></font>
<font color=#447700>! xxxice2 : real   : optical properties (extinction coefficient, single <a name='205'></font>
<font color=#447700>!                    scattering albedo, assymetry factor) from streamer v3.0,<a name='206'></font>
<font color=#447700>!                    Key, streamer user's guide, cooperative institude <a name='207'></font>
<font color=#447700>!                    for meteorological studies, 95 pp., 2001.<a name='208'></font>
<font color=#447700>! xxxice3 : real   : optical properties (extinction coefficient, single <a name='209'></font>
<font color=#447700>!                    scattering albedo, assymetry factor) from<a name='210'></font>
<font color=#447700>!                    Fu, j. clim., 9, 1996.<a name='211'></font>
<font color=#447700>! xbari   : real   : optical property coefficients for five spectral <a name='212'></font>
<font color=#447700>!                    intervals (2857-4000, 4000-5263, 5263-7692, 7692-14285,<a name='213'></font>
<font color=#447700>!                    and 14285-40000 wavenumbers) following <a name='214'></font>
<font color=#447700>!                    Ebert and Curry, jgr, 97, 3831-3836, 1992.<a name='215'></font>
<font color=#447700>!------------------------------------------------------------------<a name='216'></font>
<a name='217'>
      real(kind=rb) :: extliq1(58,16:29), ssaliq1(58,16:29), asyliq1(58,16:29)<a name='218'>
      real(kind=rb) :: extice2(43,16:29), ssaice2(43,16:29), asyice2(43,16:29)<a name='219'>
      real(kind=rb) :: extice3(46,16:29), ssaice3(46,16:29), asyice3(46,16:29)<a name='220'>
      real(kind=rb) :: fdlice3(46,16:29)<a name='221'>
      real(kind=rb) :: abari(5),bbari(5),cbari(5),dbari(5),ebari(5),fbari(5)<a name='222'>
<a name='223'>
      end module rrsw_cld<a name='224'>
<a name='225'>
<A NAME='RRSW_CON'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_CON' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='226'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_con</font> <A href='../../call_to/RRSW_CON.html' TARGET='index'>6</A>,<A href='../../call_from/RRSW_CON.html' TARGET='index'>1</A><a name='227'>
<a name='228'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_CON' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_35">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='229'>
<a name='230'>
<font color=#447700>!     implicit none<a name='231'></font>
      save<a name='232'>
<a name='233'>
<font color=#447700>!------------------------------------------------------------------<a name='234'></font>
<font color=#447700>! rrtmg_sw constants<a name='235'></font>
<a name='236'>
<font color=#447700>! Initial version: MJIacono, AER, jun2006<a name='237'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='238'></font>
<font color=#447700>!------------------------------------------------------------------<a name='239'></font>
<a name='240'>
<font color=#447700>!  name     type     purpose<a name='241'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='242'></font>
<font color=#447700>! fluxfac:  real   : radiance to flux conversion factor <a name='243'></font>
<font color=#447700>! heatfac:  real   : flux to heating rate conversion factor<a name='244'></font>
<font color=#447700>!oneminus:  real   : 1.-1.e-6<a name='245'></font>
<font color=#447700>! pi     :  real   : pi<a name='246'></font>
<font color=#447700>! grav   :  real   : acceleration of gravity<a name='247'></font>
<font color=#447700>! planck :  real   : planck constant<a name='248'></font>
<font color=#447700>! boltz  :  real   : boltzmann constant<a name='249'></font>
<font color=#447700>! clight :  real   : speed of light<a name='250'></font>
<font color=#447700>! avogad :  real   : avogadro constant <a name='251'></font>
<font color=#447700>! alosmt :  real   : loschmidt constant<a name='252'></font>
<font color=#447700>! gascon :  real   : molar gas constant<a name='253'></font>
<font color=#447700>! radcn1 :  real   : first radiation constant<a name='254'></font>
<font color=#447700>! radcn2 :  real   : second radiation constant<a name='255'></font>
<font color=#447700>! sbcnst :  real   : stefan-boltzmann constant<a name='256'></font>
<font color=#447700>!  secdy :  real   : seconds per day<a name='257'></font>
<font color=#447700>!------------------------------------------------------------------<a name='258'></font>
<a name='259'>
      real(kind=rb) :: fluxfac, heatfac<a name='260'>
      real(kind=rb) :: oneminus, pi, grav<a name='261'>
      real(kind=rb) :: planck, boltz, clight<a name='262'>
      real(kind=rb) :: avogad, alosmt, gascon<a name='263'>
      real(kind=rb) :: radcn1, radcn2<a name='264'>
      real(kind=rb) :: sbcnst, secdy<a name='265'>
<a name='266'>
      end module rrsw_con<a name='267'>
<a name='268'>
<A NAME='RRSW_KG16'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG16' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='269'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg16</font> <A href='../../call_to/RRSW_KG16.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG16.html' TARGET='index'>2</A><a name='270'>
<a name='271'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_36"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='272'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_2">, only : ng16<a name='273'>
<a name='274'>
<font color=#447700>!     implicit none<a name='275'></font>
      save<a name='276'>
<a name='277'>
<font color=#447700>!-----------------------------------------------------------------<a name='278'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 16<a name='279'></font>
<font color=#447700>! band 16:  2600-3250 cm-1 (low - h2o,ch4; high - ch4)<a name='280'></font>
<font color=#447700>!<a name='281'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='282'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='283'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='284'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='285'></font>
<font color=#447700>!<a name='286'></font>
<font color=#447700>!  name     type     purpose<a name='287'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='288'></font>
<font color=#447700>! kao     : real     <a name='289'></font>
<font color=#447700>! kbo     : real     <a name='290'></font>
<font color=#447700>! selfrefo: real     <a name='291'></font>
<font color=#447700>! forrefo : real<a name='292'></font>
<font color=#447700>!sfluxrefo: real     <a name='293'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='294'></font>
<a name='295'>
      integer(kind=im), parameter :: no16 = 16<a name='296'>
<a name='297'>
      real(kind=rb) :: kao(9,5,13,no16)<a name='298'>
      real(kind=rb) :: kbo(5,13:59,no16)<a name='299'>
      real(kind=rb) :: selfrefo(10,no16), forrefo(3,no16)<a name='300'>
      real(kind=rb) :: sfluxrefo(no16)<a name='301'>
<a name='302'>
      integer(kind=im) :: layreffr<a name='303'>
      real(kind=rb) :: rayl, strrat1<a name='304'>
<a name='305'>
<font color=#447700>!-----------------------------------------------------------------<a name='306'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 16<a name='307'></font>
<font color=#447700>! band 16:  2600-3250 cm-1 (low - h2o,ch4; high - ch4)<a name='308'></font>
<font color=#447700>!<a name='309'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='310'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='311'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='312'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='313'></font>
<font color=#447700>!<a name='314'></font>
<font color=#447700>!  name     type     purpose<a name='315'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='316'></font>
<font color=#447700>! ka      : real     <a name='317'></font>
<font color=#447700>! kb      : real     <a name='318'></font>
<font color=#447700>! absa    : real<a name='319'></font>
<font color=#447700>! absb    : real<a name='320'></font>
<font color=#447700>! selfref : real     <a name='321'></font>
<font color=#447700>! forref  : real<a name='322'></font>
<font color=#447700>! sfluxref: real     <a name='323'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='324'></font>
<a name='325'>
      real(kind=rb) :: ka(9,5,13,ng16) , absa(585,ng16)<a name='326'>
      real(kind=rb) :: kb(5,13:59,ng16), absb(235,ng16)<a name='327'>
      real(kind=rb) :: selfref(10,ng16), forref(3,ng16)<a name='328'>
      real(kind=rb) :: sfluxref(ng16)<a name='329'>
<a name='330'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='331'>
<a name='332'>
      end module rrsw_kg16<a name='333'>
<a name='334'>
<A NAME='RRSW_KG17'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG17' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='335'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg17</font> <A href='../../call_to/RRSW_KG17.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG17.html' TARGET='index'>2</A><a name='336'>
<a name='337'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_37"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='338'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_3">, only : ng17<a name='339'>
<a name='340'>
<font color=#447700>!     implicit none<a name='341'></font>
      save<a name='342'>
<a name='343'>
<font color=#447700>!-----------------------------------------------------------------<a name='344'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 17<a name='345'></font>
<font color=#447700>! band 17:  3250-4000 cm-1 (low - h2o,co2; high - h2o,co2)<a name='346'></font>
<font color=#447700>!<a name='347'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='348'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='349'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='350'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='351'></font>
<font color=#447700>!<a name='352'></font>
<font color=#447700>!  name     type     purpose<a name='353'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='354'></font>
<font color=#447700>! kao     : real     <a name='355'></font>
<font color=#447700>! kbo     : real     <a name='356'></font>
<font color=#447700>! selfrefo: real     <a name='357'></font>
<font color=#447700>! forrefo : real<a name='358'></font>
<font color=#447700>!sfluxrefo: real     <a name='359'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='360'></font>
<a name='361'>
      integer(kind=im), parameter :: no17 = 16<a name='362'>
<a name='363'>
      real(kind=rb) :: kao(9,5,13,no17)<a name='364'>
      real(kind=rb) :: kbo(5,5,13:59,no17)<a name='365'>
      real(kind=rb) :: selfrefo(10,no17), forrefo(4,no17)<a name='366'>
      real(kind=rb) :: sfluxrefo(no17,5)<a name='367'>
<a name='368'>
      integer(kind=im) :: layreffr<a name='369'>
      real(kind=rb) :: rayl, strrat<a name='370'>
<a name='371'>
<font color=#447700>!-----------------------------------------------------------------<a name='372'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 17<a name='373'></font>
<font color=#447700>! band 17:  3250-4000 cm-1 (low - h2o,co2; high - h2o,co2)<a name='374'></font>
<font color=#447700>!<a name='375'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='376'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='377'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='378'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='379'></font>
<font color=#447700>!<a name='380'></font>
<font color=#447700>!  name     type     purpose<a name='381'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='382'></font>
<font color=#447700>! ka      : real     <a name='383'></font>
<font color=#447700>! kb      : real     <a name='384'></font>
<font color=#447700>! absa    : real<a name='385'></font>
<font color=#447700>! absb    : real<a name='386'></font>
<font color=#447700>! selfref : real     <a name='387'></font>
<font color=#447700>! forref  : real<a name='388'></font>
<font color=#447700>! sfluxref: real     <a name='389'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='390'></font>
<a name='391'>
      real(kind=rb) :: ka(9,5,13,ng17) , absa(585,ng17)<a name='392'>
      real(kind=rb) :: kb(5,5,13:59,ng17), absb(1175,ng17)<a name='393'>
      real(kind=rb) :: selfref(10,ng17), forref(4,ng17)<a name='394'>
      real(kind=rb) :: sfluxref(ng17,5)<a name='395'>
<a name='396'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,1,13,1),absb(1,1))<a name='397'>
<a name='398'>
      end module rrsw_kg17<a name='399'>
<a name='400'>
<A NAME='RRSW_KG18'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG18' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='401'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg18</font> <A href='../../call_to/RRSW_KG18.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG18.html' TARGET='index'>2</A><a name='402'>
<a name='403'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_38"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='404'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_4">, only : ng18<a name='405'>
<a name='406'>
<font color=#447700>!     implicit none<a name='407'></font>
      save<a name='408'>
<a name='409'>
<font color=#447700>!-----------------------------------------------------------------<a name='410'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 18<a name='411'></font>
<font color=#447700>! band 18:  4000-4650 cm-1 (low - h2o,ch4; high - ch4)<a name='412'></font>
<font color=#447700>!<a name='413'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='414'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='415'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='416'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='417'></font>
<font color=#447700>!<a name='418'></font>
<font color=#447700>!  name     type     purpose<a name='419'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='420'></font>
<font color=#447700>! kao     : real     <a name='421'></font>
<font color=#447700>! kbo     : real     <a name='422'></font>
<font color=#447700>! selfrefo: real     <a name='423'></font>
<font color=#447700>! forrefo : real<a name='424'></font>
<font color=#447700>!sfluxrefo: real     <a name='425'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='426'></font>
<a name='427'>
      integer(kind=im), parameter :: no18 = 16<a name='428'>
<a name='429'>
      real(kind=rb) :: kao(9,5,13,no18)<a name='430'>
      real(kind=rb) :: kbo(5,13:59,no18)<a name='431'>
      real(kind=rb) :: selfrefo(10,no18), forrefo(3,no18)<a name='432'>
      real(kind=rb) :: sfluxrefo(no18,9)<a name='433'>
<a name='434'>
      integer(kind=im) :: layreffr<a name='435'>
      real(kind=rb) :: rayl, strrat<a name='436'>
<a name='437'>
<font color=#447700>!-----------------------------------------------------------------<a name='438'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 18<a name='439'></font>
<font color=#447700>! band 18:  4000-4650 cm-1 (low - h2o,ch4; high - ch4)<a name='440'></font>
<font color=#447700>!<a name='441'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='442'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='443'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='444'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='445'></font>
<font color=#447700>!<a name='446'></font>
<font color=#447700>!  name     type     purpose<a name='447'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='448'></font>
<font color=#447700>! ka      : real     <a name='449'></font>
<font color=#447700>! kb      : real     <a name='450'></font>
<font color=#447700>! absa    : real<a name='451'></font>
<font color=#447700>! absb    : real<a name='452'></font>
<font color=#447700>! selfref : real     <a name='453'></font>
<font color=#447700>! forref  : real<a name='454'></font>
<font color=#447700>! sfluxref: real     <a name='455'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='456'></font>
<a name='457'>
      real(kind=rb) :: ka(9,5,13,ng18), absa(585,ng18)<a name='458'>
      real(kind=rb) :: kb(5,13:59,ng18), absb(235,ng18)<a name='459'>
      real(kind=rb) :: selfref(10,ng18), forref(3,ng18)<a name='460'>
      real(kind=rb) :: sfluxref(ng18,9)<a name='461'>
<a name='462'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='463'>
<a name='464'>
      end module rrsw_kg18<a name='465'>
<a name='466'>
<A NAME='RRSW_KG19'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG19' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='467'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg19</font> <A href='../../call_to/RRSW_KG19.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG19.html' TARGET='index'>2</A><a name='468'>
<a name='469'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_39"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='470'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_5">, only : ng19<a name='471'>
<a name='472'>
<font color=#447700>!     implicit none<a name='473'></font>
      save<a name='474'>
<a name='475'>
<font color=#447700>!-----------------------------------------------------------------<a name='476'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 19<a name='477'></font>
<font color=#447700>! band 19:  4650-5150 cm-1 (low - h2o,co2; high - co2)<a name='478'></font>
<font color=#447700>!<a name='479'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='480'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='481'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='482'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='483'></font>
<font color=#447700>!<a name='484'></font>
<font color=#447700>!  name     type     purpose<a name='485'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='486'></font>
<font color=#447700>! kao     : real     <a name='487'></font>
<font color=#447700>! kbo     : real     <a name='488'></font>
<font color=#447700>! selfrefo: real     <a name='489'></font>
<font color=#447700>! forrefo : real<a name='490'></font>
<font color=#447700>!sfluxrefo: real     <a name='491'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='492'></font>
<a name='493'>
      integer(kind=im), parameter :: no19 = 16<a name='494'>
<a name='495'>
      real(kind=rb) :: kao(9,5,13,no19)<a name='496'>
      real(kind=rb) :: kbo(5,13:59,no19)<a name='497'>
      real(kind=rb) :: selfrefo(10,no19), forrefo(3,no19)<a name='498'>
      real(kind=rb) :: sfluxrefo(no19,9)<a name='499'>
<a name='500'>
      integer(kind=im) :: layreffr<a name='501'>
      real(kind=rb) :: rayl, strrat<a name='502'>
<a name='503'>
<font color=#447700>!-----------------------------------------------------------------<a name='504'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 19<a name='505'></font>
<font color=#447700>! band 19:  4650-5150 cm-1 (low - h2o,co2; high - co2)<a name='506'></font>
<font color=#447700>!<a name='507'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='508'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='509'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='510'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='511'></font>
<font color=#447700>!<a name='512'></font>
<font color=#447700>!  name     type     purpose<a name='513'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='514'></font>
<font color=#447700>! ka      : real     <a name='515'></font>
<font color=#447700>! kb      : real     <a name='516'></font>
<font color=#447700>! absa    : real<a name='517'></font>
<font color=#447700>! absb    : real<a name='518'></font>
<font color=#447700>! selfref : real     <a name='519'></font>
<font color=#447700>! forref  : real<a name='520'></font>
<font color=#447700>! sfluxref: real     <a name='521'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='522'></font>
<a name='523'>
      real(kind=rb) :: ka(9,5,13,ng19), absa(585,ng19)<a name='524'>
      real(kind=rb) :: kb(5,13:59,ng19), absb(235,ng19)<a name='525'>
      real(kind=rb) :: selfref(10,ng19), forref(3,ng19)<a name='526'>
      real(kind=rb) :: sfluxref(ng19,9)<a name='527'>
<a name='528'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='529'>
<a name='530'>
      end module rrsw_kg19<a name='531'>
<a name='532'>
<A NAME='RRSW_KG20'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG20' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='533'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg20</font> <A href='../../call_to/RRSW_KG20.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG20.html' TARGET='index'>2</A><a name='534'>
<a name='535'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_40"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='536'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_6">, only : ng20<a name='537'>
<a name='538'>
<font color=#447700>!     implicit none<a name='539'></font>
      save<a name='540'>
<a name='541'>
<font color=#447700>!-----------------------------------------------------------------<a name='542'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 20<a name='543'></font>
<font color=#447700>! band 20:  5150-6150 cm-1 (low - h2o; high - h2o)<a name='544'></font>
<font color=#447700>!<a name='545'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='546'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='547'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='548'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='549'></font>
<font color=#447700>!<a name='550'></font>
<font color=#447700>!  name     type     purpose<a name='551'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='552'></font>
<font color=#447700>! kao     : real     <a name='553'></font>
<font color=#447700>! kbo     : real     <a name='554'></font>
<font color=#447700>! selfrefo: real     <a name='555'></font>
<font color=#447700>! forrefo : real<a name='556'></font>
<font color=#447700>!sfluxrefo: real     <a name='557'></font>
<font color=#447700>! absch4o : real     <a name='558'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='559'></font>
<a name='560'>
      integer(kind=im), parameter :: no20 = 16<a name='561'>
<a name='562'>
      real(kind=rb) :: kao(5,13,no20)<a name='563'>
      real(kind=rb) :: kbo(5,13:59,no20)<a name='564'>
      real(kind=rb) :: selfrefo(10,no20), forrefo(4,no20)<a name='565'>
      real(kind=rb) :: sfluxrefo(no20)<a name='566'>
      real(kind=rb) :: absch4o(no20)<a name='567'>
<a name='568'>
      integer(kind=im) :: layreffr<a name='569'>
      real(kind=rb) :: rayl <a name='570'>
<a name='571'>
<font color=#447700>!-----------------------------------------------------------------<a name='572'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 20<a name='573'></font>
<font color=#447700>! band 20:  5150-6150 cm-1 (low - h2o; high - h2o)<a name='574'></font>
<font color=#447700>!<a name='575'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='576'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='577'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='578'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='579'></font>
<font color=#447700>!<a name='580'></font>
<font color=#447700>!  name     type     purpose<a name='581'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='582'></font>
<font color=#447700>! ka      : real     <a name='583'></font>
<font color=#447700>! kb      : real     <a name='584'></font>
<font color=#447700>! absa    : real<a name='585'></font>
<font color=#447700>! absb    : real<a name='586'></font>
<font color=#447700>! selfref : real     <a name='587'></font>
<font color=#447700>! forref  : real<a name='588'></font>
<font color=#447700>! sfluxref: real     <a name='589'></font>
<font color=#447700>! absch4  : real     <a name='590'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='591'></font>
<a name='592'>
      real(kind=rb) :: ka(5,13,ng20), absa(65,ng20)<a name='593'>
      real(kind=rb) :: kb(5,13:59,ng20), absb(235,ng20)<a name='594'>
      real(kind=rb) :: selfref(10,ng20), forref(4,ng20)<a name='595'>
      real(kind=rb) :: sfluxref(ng20)<a name='596'>
      real(kind=rb) :: absch4(ng20)<a name='597'>
<a name='598'>
      equivalence (ka(1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='599'>
<a name='600'>
      end module rrsw_kg20<a name='601'>
<a name='602'>
<A NAME='RRSW_KG21'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG21' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='603'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg21</font> <A href='../../call_to/RRSW_KG21.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG21.html' TARGET='index'>2</A><a name='604'>
<a name='605'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_41"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='606'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_7">, only : ng21<a name='607'>
<a name='608'>
<font color=#447700>!     implicit none<a name='609'></font>
      save<a name='610'>
<a name='611'>
<font color=#447700>!-----------------------------------------------------------------<a name='612'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 21<a name='613'></font>
<font color=#447700>! band 21:  6150-7700 cm-1 (low - h2o,co2; high - h2o,co2)<a name='614'></font>
<font color=#447700>!<a name='615'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='616'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='617'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='618'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='619'></font>
<font color=#447700>!<a name='620'></font>
<font color=#447700>!  name     type     purpose<a name='621'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='622'></font>
<font color=#447700>! kao     : real     <a name='623'></font>
<font color=#447700>! kbo     : real     <a name='624'></font>
<font color=#447700>! selfrefo: real     <a name='625'></font>
<font color=#447700>! forrefo : real<a name='626'></font>
<font color=#447700>!sfluxrefo: real     <a name='627'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='628'></font>
<a name='629'>
      integer(kind=im), parameter :: no21 = 16<a name='630'>
<a name='631'>
      real(kind=rb) :: kao(9,5,13,no21)<a name='632'>
      real(kind=rb) :: kbo(5,5,13:59,no21)<a name='633'>
      real(kind=rb) :: selfrefo(10,no21), forrefo(4,no21)<a name='634'>
      real(kind=rb) :: sfluxrefo(no21,9)<a name='635'>
<a name='636'>
      integer(kind=im) :: layreffr<a name='637'>
      real(kind=rb) :: rayl, strrat<a name='638'>
<a name='639'>
<font color=#447700>!-----------------------------------------------------------------<a name='640'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 21<a name='641'></font>
<font color=#447700>! band 21:  6150-7700 cm-1 (low - h2o,co2; high - h2o,co2)<a name='642'></font>
<font color=#447700>!<a name='643'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='644'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='645'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='646'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='647'></font>
<font color=#447700>!<a name='648'></font>
<font color=#447700>!  name     type     purpose<a name='649'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='650'></font>
<font color=#447700>! ka      : real     <a name='651'></font>
<font color=#447700>! kb      : real     <a name='652'></font>
<font color=#447700>! absa    : real<a name='653'></font>
<font color=#447700>! absb    : real<a name='654'></font>
<font color=#447700>! selfref : real     <a name='655'></font>
<font color=#447700>! forref  : real<a name='656'></font>
<font color=#447700>! sfluxref: real     <a name='657'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='658'></font>
<a name='659'>
      real(kind=rb) :: ka(9,5,13,ng21), absa(585,ng21)<a name='660'>
      real(kind=rb) :: kb(5,5,13:59,ng21), absb(1175,ng21)<a name='661'>
      real(kind=rb) :: selfref(10,ng21), forref(4,ng21)<a name='662'>
      real(kind=rb) :: sfluxref(ng21,9)<a name='663'>
<a name='664'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,1,13,1),absb(1,1))<a name='665'>
<a name='666'>
      end module rrsw_kg21<a name='667'>
<a name='668'>
<A NAME='RRSW_KG22'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG22' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='669'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg22</font> <A href='../../call_to/RRSW_KG22.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG22.html' TARGET='index'>2</A><a name='670'>
<a name='671'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_42"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='672'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_8">, only : ng22<a name='673'>
<a name='674'>
<font color=#447700>!     implicit none<a name='675'></font>
      save<a name='676'>
<a name='677'>
<font color=#447700>!-----------------------------------------------------------------<a name='678'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 22<a name='679'></font>
<font color=#447700>! band 22:  7700-8050 cm-1 (low - h2o,o2; high - o2)<a name='680'></font>
<font color=#447700>!<a name='681'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='682'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='683'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='684'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='685'></font>
<font color=#447700>!<a name='686'></font>
<font color=#447700>!  name     type     purpose<a name='687'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='688'></font>
<font color=#447700>! kao     : real     <a name='689'></font>
<font color=#447700>! kbo     : real     <a name='690'></font>
<font color=#447700>! selfrefo: real     <a name='691'></font>
<font color=#447700>! forrefo : real<a name='692'></font>
<font color=#447700>!sfluxrefo: real     <a name='693'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='694'></font>
<a name='695'>
      integer(kind=im), parameter :: no22 = 16<a name='696'>
<a name='697'>
      real(kind=rb) :: kao(9,5,13,no22)<a name='698'>
      real(kind=rb) :: kbo(5,13:59,no22)<a name='699'>
      real(kind=rb) :: selfrefo(10,no22), forrefo(3,no22)<a name='700'>
      real(kind=rb) :: sfluxrefo(no22,9)<a name='701'>
<a name='702'>
      integer(kind=im) :: layreffr<a name='703'>
      real(kind=rb) :: rayl, strrat<a name='704'>
<a name='705'>
<font color=#447700>!-----------------------------------------------------------------<a name='706'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 22<a name='707'></font>
<font color=#447700>! band 22:  7700-8050 cm-1 (low - h2o,o2; high - o2)<a name='708'></font>
<font color=#447700>!<a name='709'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='710'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='711'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='712'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='713'></font>
<font color=#447700>!<a name='714'></font>
<font color=#447700>!  name     type     purpose<a name='715'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='716'></font>
<font color=#447700>! ka      : real     <a name='717'></font>
<font color=#447700>! kb      : real     <a name='718'></font>
<font color=#447700>! absa    : real<a name='719'></font>
<font color=#447700>! absb    : real<a name='720'></font>
<font color=#447700>! selfref : real     <a name='721'></font>
<font color=#447700>! forref  : real<a name='722'></font>
<font color=#447700>! sfluxref: real     <a name='723'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='724'></font>
<a name='725'>
      real(kind=rb) :: ka(9,5,13,ng22), absa(585,ng22)<a name='726'>
      real(kind=rb) :: kb(5,13:59,ng22), absb(235,ng22)<a name='727'>
      real(kind=rb) :: selfref(10,ng22), forref(3,ng22)<a name='728'>
      real(kind=rb) :: sfluxref(ng22,9)<a name='729'>
<a name='730'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='731'>
<a name='732'>
      end module rrsw_kg22<a name='733'>
<a name='734'>
<A NAME='RRSW_KG23'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG23' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='735'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg23</font> <A href='../../call_to/RRSW_KG23.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG23.html' TARGET='index'>2</A><a name='736'>
<a name='737'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_43"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='738'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_9">, only : ng23<a name='739'>
<a name='740'>
<font color=#447700>!     implicit none<a name='741'></font>
      save<a name='742'>
<a name='743'>
<font color=#447700>!-----------------------------------------------------------------<a name='744'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 23<a name='745'></font>
<font color=#447700>! band 23:  8050-12850 cm-1 (low - h2o; high - nothing)<a name='746'></font>
<font color=#447700>!<a name='747'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='748'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='749'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='750'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='751'></font>
<font color=#447700>!<a name='752'></font>
<font color=#447700>!  name     type     purpose<a name='753'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='754'></font>
<font color=#447700>! kao     : real     <a name='755'></font>
<font color=#447700>! kbo     : real     <a name='756'></font>
<font color=#447700>! selfrefo: real     <a name='757'></font>
<font color=#447700>! forrefo : real<a name='758'></font>
<font color=#447700>!sfluxrefo: real     <a name='759'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='760'></font>
<a name='761'>
      integer(kind=im), parameter :: no23 = 16<a name='762'>
<a name='763'>
      real(kind=rb) :: kao(5,13,no23)<a name='764'>
      real(kind=rb) :: selfrefo(10,no23), forrefo(3,no23)<a name='765'>
      real(kind=rb) :: sfluxrefo(no23)<a name='766'>
      real(kind=rb) :: raylo(no23)<a name='767'>
<a name='768'>
      integer(kind=im) :: layreffr<a name='769'>
      real(kind=rb) :: givfac<a name='770'>
<a name='771'>
<font color=#447700>!-----------------------------------------------------------------<a name='772'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 23<a name='773'></font>
<font color=#447700>! band 23:  8050-12850 cm-1 (low - h2o; high - nothing)<a name='774'></font>
<font color=#447700>!<a name='775'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='776'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='777'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='778'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='779'></font>
<font color=#447700>!<a name='780'></font>
<font color=#447700>!  name     type     purpose<a name='781'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='782'></font>
<font color=#447700>! ka      : real     <a name='783'></font>
<font color=#447700>! kb      : real     <a name='784'></font>
<font color=#447700>! absa    : real<a name='785'></font>
<font color=#447700>! absb    : real<a name='786'></font>
<font color=#447700>! selfref : real     <a name='787'></font>
<font color=#447700>! forref  : real<a name='788'></font>
<font color=#447700>! sfluxref: real     <a name='789'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='790'></font>
<a name='791'>
      real(kind=rb) :: ka(5,13,ng23), absa(65,ng23)<a name='792'>
      real(kind=rb) :: selfref(10,ng23), forref(3,ng23)<a name='793'>
      real(kind=rb) :: sfluxref(ng23), rayl(ng23)<a name='794'>
<a name='795'>
      equivalence (ka(1,1,1),absa(1,1))<a name='796'>
<a name='797'>
      end module rrsw_kg23<a name='798'>
<a name='799'>
<A NAME='RRSW_KG24'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG24' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='800'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg24</font> <A href='../../call_to/RRSW_KG24.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG24.html' TARGET='index'>2</A><a name='801'>
<a name='802'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_44"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='803'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_10">, only : ng24<a name='804'>
<a name='805'>
<font color=#447700>!     implicit none<a name='806'></font>
      save<a name='807'>
<a name='808'>
<font color=#447700>!-----------------------------------------------------------------<a name='809'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 24<a name='810'></font>
<font color=#447700>! band 24: 12850-16000 cm-1 (low - h2o,o2; high - o2)<a name='811'></font>
<font color=#447700>!<a name='812'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='813'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='814'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='815'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='816'></font>
<font color=#447700>!<a name='817'></font>
<font color=#447700>!  name     type     purpose<a name='818'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='819'></font>
<font color=#447700>! kao     : real     <a name='820'></font>
<font color=#447700>! kbo     : real     <a name='821'></font>
<font color=#447700>! selfrefo: real     <a name='822'></font>
<font color=#447700>! forrefo : real<a name='823'></font>
<font color=#447700>!sfluxrefo: real     <a name='824'></font>
<font color=#447700>! abso3ao : real     <a name='825'></font>
<font color=#447700>! abso3bo : real     <a name='826'></font>
<font color=#447700>! raylao  : real     <a name='827'></font>
<font color=#447700>! raylbo  : real     <a name='828'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='829'></font>
<a name='830'>
      integer(kind=im), parameter :: no24 = 16<a name='831'>
<a name='832'>
      real(kind=rb) :: kao(9,5,13,no24)<a name='833'>
      real(kind=rb) :: kbo(5,13:59,no24)<a name='834'>
      real(kind=rb) :: selfrefo(10,no24), forrefo(3,no24)<a name='835'>
      real(kind=rb) :: sfluxrefo(no24,9)<a name='836'>
      real(kind=rb) :: abso3ao(no24), abso3bo(no24)<a name='837'>
      real(kind=rb) :: raylao(no24,9), raylbo(no24)<a name='838'>
<a name='839'>
      integer(kind=im) :: layreffr<a name='840'>
      real(kind=rb) :: strrat<a name='841'>
<a name='842'>
<font color=#447700>!-----------------------------------------------------------------<a name='843'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 24<a name='844'></font>
<font color=#447700>! band 24: 12850-16000 cm-1 (low - h2o,o2; high - o2)<a name='845'></font>
<font color=#447700>!<a name='846'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='847'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='848'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='849'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='850'></font>
<font color=#447700>!<a name='851'></font>
<font color=#447700>!  name     type     purpose<a name='852'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='853'></font>
<font color=#447700>! ka      : real     <a name='854'></font>
<font color=#447700>! kb      : real     <a name='855'></font>
<font color=#447700>! absa    : real<a name='856'></font>
<font color=#447700>! absb    : real<a name='857'></font>
<font color=#447700>! selfref : real     <a name='858'></font>
<font color=#447700>! forref  : real<a name='859'></font>
<font color=#447700>! sfluxref: real     <a name='860'></font>
<font color=#447700>! abso3a  : real     <a name='861'></font>
<font color=#447700>! abso3b  : real     <a name='862'></font>
<font color=#447700>! rayla   : real     <a name='863'></font>
<font color=#447700>! raylb   : real     <a name='864'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='865'></font>
<a name='866'>
      real(kind=rb) :: ka(9,5,13,ng24), absa(585,ng24)<a name='867'>
      real(kind=rb) :: kb(5,13:59,ng24), absb(235,ng24)<a name='868'>
      real(kind=rb) :: selfref(10,ng24), forref(3,ng24)<a name='869'>
      real(kind=rb) :: sfluxref(ng24,9)<a name='870'>
      real(kind=rb) :: abso3a(ng24), abso3b(ng24)<a name='871'>
      real(kind=rb) :: rayla(ng24,9), raylb(ng24)<a name='872'>
<a name='873'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='874'>
<a name='875'>
      end module rrsw_kg24<a name='876'>
<a name='877'>
<A NAME='RRSW_KG25'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG25' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='878'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg25</font> <A href='../../call_to/RRSW_KG25.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG25.html' TARGET='index'>2</A><a name='879'>
<a name='880'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_45"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='881'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_11">, only : ng25<a name='882'>
<a name='883'>
<font color=#447700>!     implicit none<a name='884'></font>
      save<a name='885'>
<a name='886'>
<font color=#447700>!-----------------------------------------------------------------<a name='887'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 25<a name='888'></font>
<font color=#447700>! band 25: 16000-22650 cm-1 (low - h2o; high - nothing)<a name='889'></font>
<font color=#447700>!<a name='890'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='891'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='892'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='893'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='894'></font>
<font color=#447700>!<a name='895'></font>
<font color=#447700>!  name     type     purpose<a name='896'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='897'></font>
<font color=#447700>! kao     : real     <a name='898'></font>
<font color=#447700>!sfluxrefo: real     <a name='899'></font>
<font color=#447700>! abso3ao : real     <a name='900'></font>
<font color=#447700>! abso3bo : real     <a name='901'></font>
<font color=#447700>! raylo   : real     <a name='902'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='903'></font>
<a name='904'>
      integer(kind=im), parameter :: no25 = 16<a name='905'>
<a name='906'>
      real(kind=rb) :: kao(5,13,no25)<a name='907'>
      real(kind=rb) :: sfluxrefo(no25)<a name='908'>
      real(kind=rb) :: abso3ao(no25), abso3bo(no25)<a name='909'>
      real(kind=rb) :: raylo(no25)<a name='910'>
<a name='911'>
      integer(kind=im) :: layreffr<a name='912'>
<a name='913'>
<font color=#447700>!-----------------------------------------------------------------<a name='914'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 25<a name='915'></font>
<font color=#447700>! band 25: 16000-22650 cm-1 (low - h2o; high - nothing)<a name='916'></font>
<font color=#447700>!<a name='917'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='918'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='919'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='920'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='921'></font>
<font color=#447700>!<a name='922'></font>
<font color=#447700>!  name     type     purpose<a name='923'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='924'></font>
<font color=#447700>! ka      : real     <a name='925'></font>
<font color=#447700>! absa    : real<a name='926'></font>
<font color=#447700>! sfluxref: real     <a name='927'></font>
<font color=#447700>! abso3a  : real     <a name='928'></font>
<font color=#447700>! abso3b  : real     <a name='929'></font>
<font color=#447700>! rayl    : real     <a name='930'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='931'></font>
<a name='932'>
      real(kind=rb) :: ka(5,13,ng25), absa(65,ng25)<a name='933'>
      real(kind=rb) :: sfluxref(ng25)<a name='934'>
      real(kind=rb) :: abso3a(ng25), abso3b(ng25)<a name='935'>
      real(kind=rb) :: rayl(ng25)<a name='936'>
<a name='937'>
      equivalence (ka(1,1,1),absa(1,1))<a name='938'>
<a name='939'>
      end module rrsw_kg25<a name='940'>
<a name='941'>
<A NAME='RRSW_KG26'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG26' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='942'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg26</font> <A href='../../call_to/RRSW_KG26.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG26.html' TARGET='index'>2</A><a name='943'>
<a name='944'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_46"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='945'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_12">, only : ng26<a name='946'>
<a name='947'>
<font color=#447700>!     implicit none<a name='948'></font>
      save<a name='949'>
<a name='950'>
<font color=#447700>!-----------------------------------------------------------------<a name='951'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 26<a name='952'></font>
<font color=#447700>! band 26: 22650-29000 cm-1 (low - nothing; high - nothing)<a name='953'></font>
<font color=#447700>!<a name='954'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='955'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='956'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='957'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='958'></font>
<font color=#447700>!<a name='959'></font>
<font color=#447700>!  name     type     purpose<a name='960'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='961'></font>
<font color=#447700>!sfluxrefo: real     <a name='962'></font>
<font color=#447700>! raylo   : real     <a name='963'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='964'></font>
<a name='965'>
      integer(kind=im), parameter :: no26 = 16<a name='966'>
<a name='967'>
      real(kind=rb) :: sfluxrefo(no26)<a name='968'>
      real(kind=rb) :: raylo(no26)<a name='969'>
<a name='970'>
<font color=#447700>!-----------------------------------------------------------------<a name='971'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 26<a name='972'></font>
<font color=#447700>! band 26: 22650-29000 cm-1 (low - nothing; high - nothing)<a name='973'></font>
<font color=#447700>!<a name='974'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='975'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='976'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='977'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='978'></font>
<font color=#447700>!<a name='979'></font>
<font color=#447700>!  name     type     purpose<a name='980'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='981'></font>
<font color=#447700>! sfluxref: real     <a name='982'></font>
<font color=#447700>! rayl    : real     <a name='983'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='984'></font>
<a name='985'>
      real(kind=rb) :: sfluxref(ng26)<a name='986'>
      real(kind=rb) :: rayl(ng26)<a name='987'>
<a name='988'>
      end module rrsw_kg26<a name='989'>
<a name='990'>
<A NAME='RRSW_KG27'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG27' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='991'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg27</font> <A href='../../call_to/RRSW_KG27.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG27.html' TARGET='index'>2</A><a name='992'>
<a name='993'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_47"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='994'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_13">, only : ng27<a name='995'>
<a name='996'>
<font color=#447700>!     implicit none<a name='997'></font>
      save<a name='998'>
<a name='999'>
<font color=#447700>!-----------------------------------------------------------------<a name='1000'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 27<a name='1001'></font>
<font color=#447700>! band 27: 29000-38000 cm-1 (low - o3; high - o3)<a name='1002'></font>
<font color=#447700>!<a name='1003'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1004'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1005'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1006'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1007'></font>
<font color=#447700>!<a name='1008'></font>
<font color=#447700>!  name     type     purpose<a name='1009'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1010'></font>
<font color=#447700>! kao     : real     <a name='1011'></font>
<font color=#447700>! kbo     : real     <a name='1012'></font>
<font color=#447700>!sfluxrefo: real     <a name='1013'></font>
<font color=#447700>! raylo   : real     <a name='1014'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1015'></font>
<a name='1016'>
      integer(kind=im), parameter :: no27 = 16<a name='1017'>
<a name='1018'>
      real(kind=rb) :: kao(5,13,no27)<a name='1019'>
      real(kind=rb) :: kbo(5,13:59,no27)<a name='1020'>
      real(kind=rb) :: sfluxrefo(no27)<a name='1021'>
      real(kind=rb) :: raylo(no27)<a name='1022'>
<a name='1023'>
      integer(kind=im) :: layreffr<a name='1024'>
      real(kind=rb) :: scalekur<a name='1025'>
<a name='1026'>
<font color=#447700>!-----------------------------------------------------------------<a name='1027'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 27<a name='1028'></font>
<font color=#447700>! band 27: 29000-38000 cm-1 (low - o3; high - o3)<a name='1029'></font>
<font color=#447700>!<a name='1030'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1031'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1032'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1033'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1034'></font>
<font color=#447700>!<a name='1035'></font>
<font color=#447700>!  name     type     purpose<a name='1036'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1037'></font>
<font color=#447700>! ka      : real     <a name='1038'></font>
<font color=#447700>! kb      : real     <a name='1039'></font>
<font color=#447700>! absa    : real<a name='1040'></font>
<font color=#447700>! absb    : real<a name='1041'></font>
<font color=#447700>! sfluxref: real     <a name='1042'></font>
<font color=#447700>! rayl    : real     <a name='1043'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1044'></font>
<a name='1045'>
      real(kind=rb) :: ka(5,13,ng27), absa(65,ng27)<a name='1046'>
      real(kind=rb) :: kb(5,13:59,ng27), absb(235,ng27)<a name='1047'>
      real(kind=rb) :: sfluxref(ng27)<a name='1048'>
      real(kind=rb) :: rayl(ng27)<a name='1049'>
<a name='1050'>
      equivalence (ka(1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='1051'>
<a name='1052'>
      end module rrsw_kg27<a name='1053'>
<a name='1054'>
<A NAME='RRSW_KG28'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG28' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1055'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg28</font> <A href='../../call_to/RRSW_KG28.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG28.html' TARGET='index'>2</A><a name='1056'>
<a name='1057'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_48"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='1058'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_14">, only : ng28<a name='1059'>
<a name='1060'>
<font color=#447700>!     implicit none<a name='1061'></font>
      save<a name='1062'>
<a name='1063'>
<font color=#447700>!-----------------------------------------------------------------<a name='1064'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 28<a name='1065'></font>
<font color=#447700>! band 28: 38000-50000 cm-1 (low - o3, o2; high - o3, o2)<a name='1066'></font>
<font color=#447700>!<a name='1067'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1068'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1069'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1070'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1071'></font>
<font color=#447700>!<a name='1072'></font>
<font color=#447700>!  name     type     purpose<a name='1073'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1074'></font>
<font color=#447700>! kao     : real     <a name='1075'></font>
<font color=#447700>! kbo     : real     <a name='1076'></font>
<font color=#447700>!sfluxrefo: real     <a name='1077'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1078'></font>
<a name='1079'>
      integer(kind=im), parameter :: no28 = 16<a name='1080'>
<a name='1081'>
      real(kind=rb) :: kao(9,5,13,no28)<a name='1082'>
      real(kind=rb) :: kbo(5,5,13:59,no28)<a name='1083'>
      real(kind=rb) :: sfluxrefo(no28,5)<a name='1084'>
<a name='1085'>
      integer(kind=im) :: layreffr<a name='1086'>
      real(kind=rb) :: rayl, strrat<a name='1087'>
<a name='1088'>
<font color=#447700>!-----------------------------------------------------------------<a name='1089'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 28<a name='1090'></font>
<font color=#447700>! band 28: 38000-50000 cm-1 (low - o3, o2; high - o3, o2)<a name='1091'></font>
<font color=#447700>!<a name='1092'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1093'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1094'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1095'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1096'></font>
<font color=#447700>!<a name='1097'></font>
<font color=#447700>!  name     type     purpose<a name='1098'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1099'></font>
<font color=#447700>! ka      : real     <a name='1100'></font>
<font color=#447700>! kb      : real     <a name='1101'></font>
<font color=#447700>! sfluxref: real     <a name='1102'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1103'></font>
<a name='1104'>
      real(kind=rb) :: ka(9,5,13,ng28), absa(585,ng28)<a name='1105'>
      real(kind=rb) :: kb(5,5,13:59,ng28), absb(1175,ng28)<a name='1106'>
      real(kind=rb) :: sfluxref(ng28,5)<a name='1107'>
<a name='1108'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,1,13,1),absb(1,1))<a name='1109'>
<a name='1110'>
      end module rrsw_kg28<a name='1111'>
<a name='1112'>
<A NAME='RRSW_KG29'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG29' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1113'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg29</font> <A href='../../call_to/RRSW_KG29.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_KG29.html' TARGET='index'>2</A><a name='1114'>
<a name='1115'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_49"> ,only : im =&gt; kind_im, rb =&gt; kind_rb<a name='1116'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_15">, only : ng29<a name='1117'>
<a name='1118'>
<font color=#447700>!     implicit none<a name='1119'></font>
      save<a name='1120'>
<a name='1121'>
<font color=#447700>!-----------------------------------------------------------------<a name='1122'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 29<a name='1123'></font>
<font color=#447700>! band 29:  820-2600 cm-1 (low - h2o; high - co2)<a name='1124'></font>
<font color=#447700>!<a name='1125'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1126'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1127'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1128'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1129'></font>
<font color=#447700>!<a name='1130'></font>
<font color=#447700>!  name     type     purpose<a name='1131'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1132'></font>
<font color=#447700>! kao     : real     <a name='1133'></font>
<font color=#447700>! kbo     : real     <a name='1134'></font>
<font color=#447700>! selfrefo: real     <a name='1135'></font>
<font color=#447700>! forrefo : real     <a name='1136'></font>
<font color=#447700>!sfluxrefo: real     <a name='1137'></font>
<font color=#447700>! absh2oo : real     <a name='1138'></font>
<font color=#447700>! absco2o : real     <a name='1139'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1140'></font>
<a name='1141'>
      integer(kind=im), parameter :: no29 = 16<a name='1142'>
<a name='1143'>
      real(kind=rb) :: kao(5,13,no29)<a name='1144'>
      real(kind=rb) :: kbo(5,13:59,no29)<a name='1145'>
      real(kind=rb) :: selfrefo(10,no29), forrefo(4,no29)<a name='1146'>
      real(kind=rb) :: sfluxrefo(no29)<a name='1147'>
      real(kind=rb) :: absh2oo(no29), absco2o(no29)<a name='1148'>
<a name='1149'>
      integer(kind=im) :: layreffr<a name='1150'>
      real(kind=rb) :: rayl<a name='1151'>
<a name='1152'>
<font color=#447700>!-----------------------------------------------------------------<a name='1153'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 29<a name='1154'></font>
<font color=#447700>! band 29:  820-2600 cm-1 (low - h2o; high - co2)<a name='1155'></font>
<font color=#447700>!<a name='1156'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1157'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1158'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1159'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1160'></font>
<font color=#447700>!<a name='1161'></font>
<font color=#447700>!  name     type     purpose<a name='1162'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1163'></font>
<font color=#447700>! ka      : real     <a name='1164'></font>
<font color=#447700>! kb      : real     <a name='1165'></font>
<font color=#447700>! selfref : real     <a name='1166'></font>
<font color=#447700>! forref  : real     <a name='1167'></font>
<font color=#447700>! sfluxref: real     <a name='1168'></font>
<font color=#447700>! absh2o  : real     <a name='1169'></font>
<font color=#447700>! absco2  : real     <a name='1170'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1171'></font>
<a name='1172'>
      real(kind=rb) :: ka(5,13,ng29), absa(65,ng29)<a name='1173'>
      real(kind=rb) :: kb(5,13:59,ng29), absb(235,ng29)<a name='1174'>
      real(kind=rb) :: selfref(10,ng29), forref(4,ng29)<a name='1175'>
      real(kind=rb) :: sfluxref(ng29)<a name='1176'>
      real(kind=rb) :: absh2o(ng29), absco2(ng29)<a name='1177'>
<a name='1178'>
      equivalence (ka(1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='1179'>
<a name='1180'>
      end module rrsw_kg29<a name='1181'>
<a name='1182'>
<A NAME='RRSW_REF'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_REF' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1183'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_ref</font> <A href='../../call_to/RRSW_REF.html' TARGET='index'>1</A>,<A href='../../call_from/RRSW_REF.html' TARGET='index'>1</A><a name='1184'>
<a name='1185'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_REF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_50">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='1186'>
<a name='1187'>
<font color=#447700>!     implicit none<a name='1188'></font>
      save<a name='1189'>
<a name='1190'>
<font color=#447700>!------------------------------------------------------------------<a name='1191'></font>
<font color=#447700>! rrtmg_sw reference atmosphere <a name='1192'></font>
<font color=#447700>! Based on standard mid-latitude summer profile<a name='1193'></font>
<font color=#447700>!<a name='1194'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, jul1998<a name='1195'></font>
<font color=#447700>! Revised: MJIacono, AER, jun2006<a name='1196'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1197'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1198'></font>
<a name='1199'>
<font color=#447700>!  name     type     purpose<a name='1200'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='1201'></font>
<font color=#447700>! pref   :  real   : Reference pressure levels<a name='1202'></font>
<font color=#447700>! preflog:  real   : Reference pressure levels, ln(pref)<a name='1203'></font>
<font color=#447700>! tref   :  real   : Reference temperature levels for MLS profile<a name='1204'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1205'></font>
<a name='1206'>
      real(kind=rb) , dimension(59) :: pref<a name='1207'>
      real(kind=rb) , dimension(59) :: preflog<a name='1208'>
      real(kind=rb) , dimension(59) :: tref<a name='1209'>
<a name='1210'>
      end module rrsw_ref<a name='1211'>
<a name='1212'>
<A NAME='RRSW_TBL'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_TBL' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1213'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_tbl</font> <A href='../../call_to/RRSW_TBL.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_TBL.html' TARGET='index'>1</A><a name='1214'>
<a name='1215'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_TBL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_51">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='1216'>
<a name='1217'>
<font color=#447700>!     implicit none<a name='1218'></font>
      save<a name='1219'>
<a name='1220'>
<font color=#447700>!------------------------------------------------------------------<a name='1221'></font>
<font color=#447700>! rrtmg_sw lookup table arrays<a name='1222'></font>
<a name='1223'>
<font color=#447700>! Initial version: MJIacono, AER, may2007<a name='1224'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2007<a name='1225'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1226'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1227'></font>
<a name='1228'>
<font color=#447700>!  name     type     purpose<a name='1229'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='1230'></font>
<font color=#447700>! ntbl   :  integer: Lookup table dimension<a name='1231'></font>
<font color=#447700>! tblint :  real   : Lookup table conversion factor<a name='1232'></font>
<font color=#447700>! tau_tbl:  real   : Clear-sky optical depth <a name='1233'></font>
<font color=#447700>! exp_tbl:  real   : Exponential lookup table for transmittance<a name='1234'></font>
<font color=#447700>! od_lo  :  real   : Value of tau below which expansion is used<a name='1235'></font>
<font color=#447700>!                  : in place of lookup table<a name='1236'></font>
<font color=#447700>! pade   :  real   : Pade approximation constant<a name='1237'></font>
<font color=#447700>! bpade  :  real   : Inverse of Pade constant<a name='1238'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1239'></font>
<a name='1240'>
      integer(kind=im), parameter :: ntbl = 10000<a name='1241'>
<a name='1242'>
      real(kind=rb), parameter :: tblint = 10000.0_rb<a name='1243'>
<a name='1244'>
      real(kind=rb), parameter :: od_lo = 0.06_rb<a name='1245'>
<a name='1246'>
      real(kind=rb) :: tau_tbl<a name='1247'>
      real(kind=rb) , dimension(0:ntbl) :: exp_tbl<a name='1248'>
<a name='1249'>
      real(kind=rb), parameter :: pade = 0.278_rb<a name='1250'>
      real(kind=rb) :: bpade<a name='1251'>
<a name='1252'>
      end module rrsw_tbl<a name='1253'>
<a name='1254'>
<A NAME='RRSW_VSN'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_VSN' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1255'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_vsn</font> <A href='../../call_to/RRSW_VSN.html' TARGET='index'>9</A><a name='1256'>
<a name='1257'>
<font color=#447700>!     implicit none<a name='1258'></font>
      save<a name='1259'>
<a name='1260'>
<font color=#447700>!------------------------------------------------------------------<a name='1261'></font>
<font color=#447700>! rrtmg_sw version information<a name='1262'></font>
<a name='1263'>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, jul1998<a name='1264'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1265'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1266'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1267'></font>
<a name='1268'>
<font color=#447700>!  name     type     purpose<a name='1269'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='1270'></font>
<font color=#447700>!hnamrtm :character: <a name='1271'></font>
<font color=#447700>!hnamini :character: <a name='1272'></font>
<font color=#447700>!hnamcld :character: <a name='1273'></font>
<font color=#447700>!hnamclc :character: <a name='1274'></font>
<font color=#447700>!hnamrft :character: <a name='1275'></font>
<font color=#447700>!hnamspv :character: <a name='1276'></font>
<font color=#447700>!hnamspc :character: <a name='1277'></font>
<font color=#447700>!hnamset :character: <a name='1278'></font>
<font color=#447700>!hnamtau :character: <a name='1279'></font>
<font color=#447700>!hnamvqd :character: <a name='1280'></font>
<font color=#447700>!hnamatm :character: <a name='1281'></font>
<font color=#447700>!hnamutl :character: <a name='1282'></font>
<font color=#447700>!hnamext :character: <a name='1283'></font>
<font color=#447700>!hnamkg  :character: <a name='1284'></font>
<font color=#447700>!<a name='1285'></font>
<font color=#447700>! hvrrtm :character: <a name='1286'></font>
<font color=#447700>! hvrini :character: <a name='1287'></font>
<font color=#447700>! hvrcld :character: <a name='1288'></font>
<font color=#447700>! hvrclc :character: <a name='1289'></font>
<font color=#447700>! hvrrft :character: <a name='1290'></font>
<font color=#447700>! hvrspv :character: <a name='1291'></font>
<font color=#447700>! hvrspc :character: <a name='1292'></font>
<font color=#447700>! hvrset :character: <a name='1293'></font>
<font color=#447700>! hvrtau :character: <a name='1294'></font>
<font color=#447700>! hvrvqd :character: <a name='1295'></font>
<font color=#447700>! hvratm :character: <a name='1296'></font>
<font color=#447700>! hvrutl :character: <a name='1297'></font>
<font color=#447700>! hvrext :character: <a name='1298'></font>
<font color=#447700>! hvrkg  :character: <a name='1299'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1300'></font>
<a name='1301'>
      character*18 hvrrtm,hvrini,hvrcld,hvrclc,hvrrft,hvrspv, &amp;<a name='1302'>
                   hvrspc,hvrset,hvrtau,hvrvqd,hvratm,hvrutl,hvrext<a name='1303'>
      character*20 hnamrtm,hnamini,hnamcld,hnamclc,hnamrft,hnamspv, &amp;<a name='1304'>
                   hnamspc,hnamset,hnamtau,hnamvqd,hnamatm,hnamutl,hnamext<a name='1305'>
<a name='1306'>
      character*18 hvrkg<a name='1307'>
      character*20 hnamkg<a name='1308'>
<a name='1309'>
      end module rrsw_vsn<a name='1310'>
<a name='1311'>
<A NAME='RRSW_WVN'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_WVN' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1312'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_wvn</font> <A href='../../call_to/RRSW_WVN.html' TARGET='index'>7</A>,<A href='../../call_from/RRSW_WVN.html' TARGET='index'>2</A><a name='1313'>
<a name='1314'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_WVN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_52">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='1315'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_WVN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_16">, only : nbndsw, mg, ngptsw, jpb1, jpb2<a name='1316'>
<a name='1317'>
<font color=#447700>!     implicit none<a name='1318'></font>
      save<a name='1319'>
<a name='1320'>
<font color=#447700>!------------------------------------------------------------------<a name='1321'></font>
<font color=#447700>! rrtmg_sw spectral information<a name='1322'></font>
<a name='1323'>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, jul1998<a name='1324'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1325'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1326'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1327'></font>
<a name='1328'>
<font color=#447700>!  name     type     purpose<a name='1329'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='1330'></font>
<font color=#447700>! ng     :  integer: Number of original g-intervals in each spectral band<a name='1331'></font>
<font color=#447700>! nspa   :  integer: <a name='1332'></font>
<font color=#447700>! nspb   :  integer: <a name='1333'></font>
<font color=#447700>!wavenum1:  real   : Spectral band lower boundary in wavenumbers<a name='1334'></font>
<font color=#447700>!wavenum2:  real   : Spectral band upper boundary in wavenumbers<a name='1335'></font>
<font color=#447700>! delwave:  real   : Spectral band width in wavenumbers<a name='1336'></font>
<font color=#447700>!<a name='1337'></font>
<font color=#447700>! ngc    :  integer: The number of new g-intervals in each band<a name='1338'></font>
<font color=#447700>! ngs    :  integer: The cumulative sum of new g-intervals for each band<a name='1339'></font>
<font color=#447700>! ngm    :  integer: The index of each new g-interval relative to the<a name='1340'></font>
<font color=#447700>!                    original 16 g-intervals in each band<a name='1341'></font>
<font color=#447700>! ngn    :  integer: The number of original g-intervals that are <a name='1342'></font>
<font color=#447700>!                    combined to make each new g-intervals in each band<a name='1343'></font>
<font color=#447700>! ngb    :  integer: The band index for each new g-interval<a name='1344'></font>
<font color=#447700>! wt     :  real   : RRTM weights for the original 16 g-intervals<a name='1345'></font>
<font color=#447700>! rwgt   :  real   : Weights for combining original 16 g-intervals <a name='1346'></font>
<font color=#447700>!                    (224 total) into reduced set of g-intervals <a name='1347'></font>
<font color=#447700>!                    (112 total)<a name='1348'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1349'></font>
<a name='1350'>
      integer(kind=im) :: ng(jpb1:jpb2)<a name='1351'>
      integer(kind=im) :: nspa(jpb1:jpb2)<a name='1352'>
      integer(kind=im) :: nspb(jpb1:jpb2)<a name='1353'>
<a name='1354'>
      real(kind=rb) :: wavenum1(jpb1:jpb2)<a name='1355'>
      real(kind=rb) :: wavenum2(jpb1:jpb2)<a name='1356'>
      real(kind=rb) :: delwave(jpb1:jpb2)<a name='1357'>
<a name='1358'>
      integer(kind=im) :: ngc(nbndsw)<a name='1359'>
      integer(kind=im) :: ngs(nbndsw)<a name='1360'>
      integer(kind=im) :: ngn(ngptsw)<a name='1361'>
      integer(kind=im) :: ngb(ngptsw)<a name='1362'>
      integer(kind=im) :: ngm(nbndsw*mg)<a name='1363'>
<a name='1364'>
      real(kind=rb) :: wt(mg)<a name='1365'>
      real(kind=rb) :: rwgt(nbndsw*mg)<a name='1366'>
<a name='1367'>
      end module rrsw_wvn<a name='1368'>
<a name='1369'>
<font color=#447700>!     path:      $Source: /cvsroot/NWP/WRFV3/phys/module_ra_rrtmg_sw.F,v $<a name='1370'></font>
<font color=#447700>!     author:    $Author: trn $<a name='1371'></font>
<font color=#447700>!     revision:  $Revision: 1.3 $<a name='1372'></font>
<font color=#447700>!     created:   $Date: 2009/04/16 19:54:22 $<a name='1373'></font>
<font color=#447700>!<a name='1374'></font>
<A NAME='MCICA_SUBCOL_GEN_SW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MCICA_SUBCOL_GEN_SW' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1375'>
      <font color=#993300>module </font><font color=#cc0000>mcica_subcol_gen_sw</font> <A href='../../call_to/MCICA_SUBCOL_GEN_SW.html' TARGET='index'>2</A>,<A href='../../call_from/MCICA_SUBCOL_GEN_SW.html' TARGET='index'>5</A><a name='1376'>
<a name='1377'>
<font color=#447700>!  --------------------------------------------------------------------------<a name='1378'></font>
<font color=#447700>! |                                                                          |<a name='1379'></font>
<font color=#447700>! |  Copyright 2006-2008, Atmospheric &amp; Environmental Research, Inc. (AER).  |<a name='1380'></font>
<font color=#447700>! |  This software may be used, copied, or redistributed as long as it is    |<a name='1381'></font>
<font color=#447700>! |  not sold and this copyright notice is reproduced on each copy made.     |<a name='1382'></font>
<font color=#447700>! |  This model is provided as is without any express or implied warranties. |<a name='1383'></font>
<font color=#447700>! |                       (http://www.rtweb.aer.com/)                        |<a name='1384'></font>
<font color=#447700>! |                                                                          |<a name='1385'></font>
<font color=#447700>!  --------------------------------------------------------------------------<a name='1386'></font>
<a name='1387'>
<font color=#447700>! Purpose: Create McICA stochastic arrays for cloud physical or optical properties.   <a name='1388'></font>
<font color=#447700>! Two options are possible:<a name='1389'></font>
<font color=#447700>! 1) Input cloud physical properties: cloud fraction, ice and liquid water<a name='1390'></font>
<font color=#447700>!    paths, ice fraction, and particle sizes.  Output will be stochastic<a name='1391'></font>
<font color=#447700>!    arrays of these variables.  (inflag = 1)<a name='1392'></font>
<font color=#447700>! 2) Input cloud optical properties directly: cloud optical depth, single<a name='1393'></font>
<font color=#447700>!    scattering albedo and asymmetry parameter.  Output will be stochastic<a name='1394'></font>
<font color=#447700>!    arrays of these variables.  (inflag = 0)<a name='1395'></font>
<a name='1396'>
<font color=#447700>! --------- Modules ----------<a name='1397'></font>
<a name='1398'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MCICA_SUBCOL_GEN_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_53">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='1399'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MCICA_SUBCOL_GEN_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_17">, only : nbndsw, ngptsw<a name='1400'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_CON'>rrsw_con</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MCICA_SUBCOL_GEN_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CON_1">, only: grav<a name='1401'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_WVN'>rrsw_wvn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MCICA_SUBCOL_GEN_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_1">, only: ngb<a name='1402'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_VSN'>rrsw_vsn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MCICA_SUBCOL_GEN_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_1"><a name='1403'>
<a name='1404'>
      implicit none<a name='1405'>
<a name='1406'>
<font color=#447700>! public interfaces/functions/subroutines<a name='1407'></font>
      public :: mcica_subcol_sw, generate_stochastic_clouds_sw<a name='1408'>
<a name='1409'>
      contains<a name='1410'>
<a name='1411'>
<font color=#447700>!------------------------------------------------------------------<a name='1412'></font>
<font color=#447700>! Public subroutines<a name='1413'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1414'></font>
<a name='1415'>
<A NAME='MCICA_SUBCOL_SW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MCICA_SUBCOL_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1416'>
      <font color=#993300>subroutine </font><font color=#cc0000>mcica_subcol_sw</font>(iplon, ncol, nlay, icld, permuteseed, irng, play, &amp; <A href='../../call_to/MCICA_SUBCOL_SW.html' TARGET='index'>1</A>,<A href='../../call_from/MCICA_SUBCOL_SW.html' TARGET='index'>1</A><a name='1417'>
                       cldfrac, ciwp, clwp, cswp, rei, rel, res, tauc, ssac, asmc, fsfc, &amp;<a name='1418'>
                       cldfmcl, ciwpmcl, clwpmcl, cswpmcl, reicmcl, relqmcl, resnmcl, &amp;<a name='1419'>
                       taucmcl, ssacmcl, asmcmcl, fsfcmcl)<a name='1420'>
<a name='1421'>
<font color=#447700>! ----- Input -----<a name='1422'></font>
<font color=#447700>! Control<a name='1423'></font>
      integer(kind=im), intent(in) :: iplon           <font color=#447700>! column/longitude dimension<a name='1424'></font>
      integer(kind=im), intent(in) :: ncol            <font color=#447700>! number of columns<a name='1425'></font>
      integer(kind=im), intent(in) :: nlay            <font color=#447700>! number of model layers<a name='1426'></font>
      integer(kind=im), intent(in) :: icld            <font color=#447700>! clear/cloud, cloud overlap flag<a name='1427'></font>
      integer(kind=im), intent(in) :: permuteseed     <font color=#447700>! if the cloud generator is called multiple times,<a name='1428'></font>
                                                      <font color=#447700>! permute the seed between each call;<a name='1429'></font>
                                                      <font color=#447700>! between calls for LW and SW, recommended<a name='1430'></font>
                                                      <font color=#447700>! permuteseed differs by 'ngpt'<a name='1431'></font>
      integer(kind=im), intent(inout) :: irng         <font color=#447700>! flag for random number generator<a name='1432'></font>
                                                      <font color=#447700>!  0 = kissvec<a name='1433'></font>
                                                      <font color=#447700>!  1 = Mersenne Twister<a name='1434'></font>
        <a name='1435'>
<font color=#447700>! Atmosphere<a name='1436'></font>
      real(kind=rb), intent(in) :: play(:,:)          <font color=#447700>! layer pressures (mb) <a name='1437'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1438'></font>
<a name='1439'>
<font color=#447700>! Atmosphere/clouds - cldprop<a name='1440'></font>
      real(kind=rb), intent(in) :: cldfrac(:,:)       <font color=#447700>! layer cloud fraction<a name='1441'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1442'></font>
      real(kind=rb), intent(in) :: tauc(:,:,:)        <font color=#447700>! in-cloud optical depth<a name='1443'></font>
                                                      <font color=#447700>!    Dimensions: (nbndsw,ncol,nlay)<a name='1444'></font>
      real(kind=rb), intent(in) :: ssac(:,:,:)        <font color=#447700>! in-cloud single scattering albedo (non-delta scaled)<a name='1445'></font>
                                                      <font color=#447700>!    Dimensions: (nbndsw,ncol,nlay)<a name='1446'></font>
      real(kind=rb), intent(in) :: asmc(:,:,:)        <font color=#447700>! in-cloud asymmetry parameter (non-delta scaled)<a name='1447'></font>
                                                      <font color=#447700>!    Dimensions: (nbndsw,ncol,nlay)<a name='1448'></font>
      real(kind=rb), intent(in) :: fsfc(:,:,:)        <font color=#447700>! in-cloud forward scattering fraction (non-delta scaled)<a name='1449'></font>
                                                      <font color=#447700>!    Dimensions: (nbndsw,ncol,nlay)<a name='1450'></font>
      real(kind=rb), intent(in) :: ciwp(:,:)          <font color=#447700>! in-cloud ice water path<a name='1451'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1452'></font>
      real(kind=rb), intent(in) :: clwp(:,:)          <font color=#447700>! in-cloud liquid water path<a name='1453'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1454'></font>
      real(kind=rb), intent(in) :: cswp(:,:)          <font color=#447700>! in-cloud snow water path<a name='1455'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1456'></font>
      real(kind=rb), intent(in) :: rei(:,:)           <font color=#447700>! cloud ice particle size<a name='1457'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1458'></font>
      real(kind=rb), intent(in) :: rel(:,:)           <font color=#447700>! cloud liquid particle size<a name='1459'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1460'></font>
      real(kind=rb), intent(in) :: res(:,:)           <font color=#447700>! cloud snow particle size<a name='1461'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1462'></font>
<a name='1463'>
<font color=#447700>! ----- Output -----<a name='1464'></font>
<font color=#447700>! Atmosphere/clouds - cldprmc [mcica]<a name='1465'></font>
      real(kind=rb), intent(out) :: cldfmcl(:,:,:)    <font color=#447700>! cloud fraction [mcica]<a name='1466'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1467'></font>
      real(kind=rb), intent(out) :: ciwpmcl(:,:,:)    <font color=#447700>! in-cloud ice water path [mcica]<a name='1468'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1469'></font>
      real(kind=rb), intent(out) :: clwpmcl(:,:,:)    <font color=#447700>! in-cloud liquid water path [mcica]<a name='1470'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1471'></font>
      real(kind=rb), intent(out) :: cswpmcl(:,:,:)    <font color=#447700>! in-cloud snow water path [mcica]<a name='1472'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1473'></font>
      real(kind=rb), intent(out) :: relqmcl(:,:)      <font color=#447700>! liquid particle size (microns)<a name='1474'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1475'></font>
      real(kind=rb), intent(out) :: reicmcl(:,:)      <font color=#447700>! ice partcle size (microns)<a name='1476'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1477'></font>
      real(kind=rb), intent(out) :: resnmcl(:,:)      <font color=#447700>! snow partcle size (microns)<a name='1478'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1479'></font>
      real(kind=rb), intent(out) :: taucmcl(:,:,:)    <font color=#447700>! in-cloud optical depth [mcica]<a name='1480'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1481'></font>
      real(kind=rb), intent(out) :: ssacmcl(:,:,:)    <font color=#447700>! in-cloud single scattering albedo [mcica]<a name='1482'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1483'></font>
      real(kind=rb), intent(out) :: asmcmcl(:,:,:)    <font color=#447700>! in-cloud asymmetry parameter [mcica]<a name='1484'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1485'></font>
      real(kind=rb), intent(out) :: fsfcmcl(:,:,:)    <font color=#447700>! in-cloud forward scattering fraction [mcica]<a name='1486'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1487'></font>
<a name='1488'>
<font color=#447700>! ----- Local -----<a name='1489'></font>
<a name='1490'>
<font color=#447700>! Stochastic cloud generator variables [mcica]<a name='1491'></font>
      integer(kind=im), parameter :: nsubcsw = ngptsw <font color=#447700>! number of sub-columns (g-point intervals)<a name='1492'></font>
      integer(kind=im) :: ilev                        <font color=#447700>! loop index<a name='1493'></font>
<a name='1494'>
      real(kind=rb) :: pmid(ncol,nlay)                <font color=#447700>! layer pressures (Pa) <a name='1495'></font>
<font color=#447700>!      real(kind=rb) :: pdel(ncol,nlay)               ! layer pressure thickness (Pa) <a name='1496'></font>
<font color=#447700>!      real(kind=rb) :: qi(ncol,nlay)                 ! ice water (specific humidity)<a name='1497'></font>
<font color=#447700>!      real(kind=rb) :: ql(ncol,nlay)                 ! liq water (specific humidity)<a name='1498'></font>
<a name='1499'>
<a name='1500'>
<font color=#447700>! Return if clear sky; or stop if icld out of range<a name='1501'></font>
      if (icld.eq.0) return<a name='1502'>
      if (icld.lt.0.or.icld.gt.3) then <a name='1503'>
         stop 'MCICA_SUBCOL: INVALID ICLD'<a name='1504'>
      endif <a name='1505'>
<a name='1506'>
<font color=#447700>! NOTE: For GCM mode, permuteseed must be offset between LW and SW by at least number of subcolumns<a name='1507'></font>
<a name='1508'>
<a name='1509'>
<font color=#447700>! Pass particle sizes to new arrays, no subcolumns for these properties yet<a name='1510'></font>
<font color=#447700>! Convert pressures from mb to Pa<a name='1511'></font>
<a name='1512'>
      reicmcl(:ncol,:nlay) = rei(:ncol,:nlay)<a name='1513'>
      relqmcl(:ncol,:nlay) = rel(:ncol,:nlay)<a name='1514'>
      resnmcl(:ncol,:nlay) = res(:ncol,:nlay)<a name='1515'>
      pmid(:ncol,:nlay) = play(:ncol,:nlay)*1.e2_rb<a name='1516'>
<a name='1517'>
<font color=#447700>! Convert input ice and liquid cloud water paths to specific humidity ice and liquid components <a name='1518'></font>
<a name='1519'>
<font color=#447700>!      cwp =  (q * pdel * 1000.) / gravit)<a name='1520'></font>
<font color=#447700>!           = (kg/kg * kg m-1 s-2 *1000.) / m s-2<a name='1521'></font>
<font color=#447700>!           = (g m-2)<a name='1522'></font>
<font color=#447700>!<a name='1523'></font>
<font color=#447700>!      q  = (cwp * gravit) / (pdel *1000.)<a name='1524'></font>
<font color=#447700>!         = (g m-2 * m s-2) / (kg m-1 s-2 * 1000.)<a name='1525'></font>
<font color=#447700>!         =  kg/kg<a name='1526'></font>
<a name='1527'>
<font color=#447700>!      do ilev = 1, nlay<a name='1528'></font>
<font color=#447700>!         qi(ilev) = (ciwp(ilev) * grav) / (pdel(ilev) * 1000._rb)<a name='1529'></font>
<font color=#447700>!         ql(ilev) = (clwp(ilev) * grav) / (pdel(ilev) * 1000._rb)<a name='1530'></font>
<font color=#447700>!      enddo<a name='1531'></font>
<a name='1532'>
<font color=#447700>!  Generate the stochastic subcolumns of cloud optical properties for the shortwave;<a name='1533'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#GENERATE_STOCHASTIC_CLOUDS_SW'>generate_stochastic_clouds_sw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MCICA_SUBCOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GENERATE_STOCHASTIC_CLOUDS_SW_1"> (ncol, nlay, nsubcsw, icld, irng, pmid, cldfrac, clwp, ciwp, cswp, &amp;<a name='1534'>
                               tauc, ssac, asmc, fsfc, cldfmcl, clwpmcl, ciwpmcl, cswpmcl, &amp;<a name='1535'>
                               taucmcl, ssacmcl, asmcmcl, fsfcmcl, permuteseed)<a name='1536'>
<a name='1537'>
      end subroutine mcica_subcol_sw<a name='1538'>
<a name='1539'>
<a name='1540'>
<font color=#447700>!-------------------------------------------------------------------------------------------------<a name='1541'></font>
<A NAME='GENERATE_STOCHASTIC_CLOUDS_SW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#GENERATE_STOCHASTIC_CLOUDS_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1542'>
      <font color=#993300>subroutine </font><font color=#cc0000>generate_stochastic_clouds_sw</font>(ncol, nlay, nsubcol, icld, irng, pmid, cld, clwp, ciwp, cswp, &amp; <A href='../../call_to/GENERATE_STOCHASTIC_CLOUDS_SW.html' TARGET='index'>1</A>,<A href='../../call_from/GENERATE_STOCHASTIC_CLOUDS_SW.html' TARGET='index'>9</A><a name='1543'>
                               tauc, ssac, asmc, fsfc, cld_stoch, clwp_stoch, ciwp_stoch, cswp_stoch,        &amp;<a name='1544'>
                               tauc_stoch, ssac_stoch, asmc_stoch, fsfc_stoch, changeSeed) <a name='1545'>
<font color=#447700>!-------------------------------------------------------------------------------------------------<a name='1546'></font>
<a name='1547'>
  <font color=#447700>!----------------------------------------------------------------------------------------------------------------<a name='1548'></font>
  <font color=#447700>! ---------------------<a name='1549'></font>
  <font color=#447700>! Contact: Cecile Hannay (hannay@ucar.edu)<a name='1550'></font>
  <font color=#447700>! <a name='1551'></font>
  <font color=#447700>! Original code: Based on Raisanen et al., QJRMS, 2004.<a name='1552'></font>
  <font color=#447700>!<a name='1553'></font>
  <font color=#447700>! Modifications: Generalized for use with RRTMG and added Mersenne Twister as the default<a name='1554'></font>
  <font color=#447700>!   random number generator, which can be changed to the optional kissvec random number generator<a name='1555'></font>
  <font color=#447700>!   with flag 'irng'. Some extra functionality has been commented or removed.  <a name='1556'></font>
  <font color=#447700>!   Michael J. Iacono, AER, Inc., February 2007<a name='1557'></font>
  <font color=#447700>!<a name='1558'></font>
  <font color=#447700>! Given a profile of cloud fraction, cloud water and cloud ice, we produce a set of subcolumns.<a name='1559'></font>
  <font color=#447700>! Each layer within each subcolumn is homogeneous, with cloud fraction equal to zero or one <a name='1560'></font>
  <font color=#447700>! and uniform cloud liquid and cloud ice concentration.<a name='1561'></font>
  <font color=#447700>! The ensemble as a whole reproduces the probability function of cloud liquid and ice within each layer <a name='1562'></font>
  <font color=#447700>! and obeys an overlap assumption in the vertical.   <a name='1563'></font>
  <font color=#447700>! <a name='1564'></font>
  <font color=#447700>! Overlap assumption:<a name='1565'></font>
  <font color=#447700>!  The cloud are consistent with 4 overlap assumptions: random, maximum, maximum-random and exponential. <a name='1566'></font>
  <font color=#447700>!  The default option is maximum-random (option 3)<a name='1567'></font>
  <font color=#447700>!  The options are: 1=random overlap, 2=max/random, 3=maximum overlap, 4=exponential overlap<a name='1568'></font>
  <font color=#447700>!  This is set with the variable "overlap" <a name='1569'></font>
  <font color=#447700>!mji - Exponential overlap option (overlap=4) has been deactivated in this version<a name='1570'></font>
  <font color=#447700>!  The exponential overlap uses also a length scale, Zo. (real,    parameter  :: Zo = 2500. ) <a name='1571'></font>
  <font color=#447700>! <a name='1572'></font>
  <font color=#447700>! Seed:<a name='1573'></font>
  <font color=#447700>!  If the stochastic cloud generator is called several times during the same timestep, <a name='1574'></font>
  <font color=#447700>!  one should change the seed between the call to insure that the subcolumns are different.<a name='1575'></font>
  <font color=#447700>!  This is done by changing the argument 'changeSeed'<a name='1576'></font>
  <font color=#447700>!  For example, if one wants to create a set of columns for the shortwave and another set for the longwave ,<a name='1577'></font>
  <font color=#447700>!  use 'changeSeed = 1' for the first call and'changeSeed = 2' for the second call <a name='1578'></font>
  <font color=#447700>!<a name='1579'></font>
  <font color=#447700>! PDF assumption:<a name='1580'></font>
  <font color=#447700>!  We can use arbitrary complicated PDFS. <a name='1581'></font>
  <font color=#447700>!  In the present version, we produce homogeneuous clouds (the simplest case).  <a name='1582'></font>
  <font color=#447700>!  Future developments include using the PDF scheme of Ben Johnson. <a name='1583'></font>
  <font color=#447700>!<a name='1584'></font>
  <font color=#447700>! History file:<a name='1585'></font>
  <font color=#447700>!  Option to add diagnostics variables in the history file. (using FINCL in the namelist)<a name='1586'></font>
  <font color=#447700>!  nsubcol = number of subcolumns<a name='1587'></font>
  <font color=#447700>!  overlap = overlap type (1-3)<a name='1588'></font>
  <font color=#447700>!  Zo = length scale <a name='1589'></font>
  <font color=#447700>!  CLOUD_S = mean of the subcolumn cloud fraction ('_S" means Stochastic)<a name='1590'></font>
  <font color=#447700>!  CLDLIQ_S = mean of the subcolumn cloud water<a name='1591'></font>
  <font color=#447700>!  CLDICE_S = mean of the subcolumn cloud ice <a name='1592'></font>
  <font color=#447700>!<a name='1593'></font>
  <font color=#447700>! Note:<a name='1594'></font>
  <font color=#447700>!   Here: we force that the cloud condensate to be consistent with the cloud fraction <a name='1595'></font>
  <font color=#447700>!   i.e we only have cloud condensate when the cell is cloudy. <a name='1596'></font>
  <font color=#447700>!   In CAM: The cloud condensate and the cloud fraction are obtained from 2 different equations <a name='1597'></font>
  <font color=#447700>!   and the 2 quantities can be inconsistent (i.e. CAM can produce cloud fraction <a name='1598'></font>
  <font color=#447700>!   without cloud condensate or the opposite).<a name='1599'></font>
  <font color=#447700>!---------------------------------------------------------------------------------------------------------------<a name='1600'></font>
<a name='1601'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#MCICA_RANDOM_NUMBERS'>mcica_random_numbers</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#GENERATE_STOCHASTIC_CLOUDS_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MCICA_RANDOM_NUMBERS_2"><a name='1602'>
<font color=#447700>! The Mersenne Twister random number engine<a name='1603'></font>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#MERSENNETWISTER'>MersenneTwister</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#GENERATE_STOCHASTIC_CLOUDS_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MERSENNETWISTER_3">, only: randomNumberSequence, &amp;   <a name='1604'>
                                 new_RandomNumberSequence, getRandomReal<a name='1605'>
<a name='1606'>
      type(randomNumberSequence) :: randomNumbers<a name='1607'>
<a name='1608'>
<font color=#447700>! -- Arguments<a name='1609'></font>
<a name='1610'>
      integer(kind=im), intent(in) :: ncol            <font color=#447700>! number of layers<a name='1611'></font>
      integer(kind=im), intent(in) :: nlay            <font color=#447700>! number of layers<a name='1612'></font>
      integer(kind=im), intent(in) :: icld            <font color=#447700>! clear/cloud, cloud overlap flag<a name='1613'></font>
      integer(kind=im), intent(inout) :: irng         <font color=#447700>! flag for random number generator<a name='1614'></font>
                                                      <font color=#447700>!  0 = kissvec<a name='1615'></font>
                                                      <font color=#447700>!  1 = Mersenne Twister<a name='1616'></font>
      integer(kind=im), intent(in) :: nsubcol         <font color=#447700>! number of sub-columns (g-point intervals)<a name='1617'></font>
      integer(kind=im), optional, intent(in) :: changeSeed     <font color=#447700>! allows permuting seed<a name='1618'></font>
<a name='1619'>
<font color=#447700>! Column state (cloud fraction, cloud water, cloud ice) + variables needed to read physics state <a name='1620'></font>
      real(kind=rb), intent(in) :: pmid(:,:)          <font color=#447700>! layer pressure (Pa)<a name='1621'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1622'></font>
      real(kind=rb), intent(in) :: cld(:,:)           <font color=#447700>! cloud fraction <a name='1623'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1624'></font>
      real(kind=rb), intent(in) :: clwp(:,:)          <font color=#447700>! in-cloud liquid water path (g/m2)<a name='1625'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1626'></font>
      real(kind=rb), intent(in) :: ciwp(:,:)          <font color=#447700>! in-cloud ice water path (g/m2)<a name='1627'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1628'></font>
      real(kind=rb), intent(in) :: cswp(:,:)          <font color=#447700>! in-cloud snow water path (g/m2)<a name='1629'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1630'></font>
      real(kind=rb), intent(in) :: tauc(:,:,:)        <font color=#447700>! in-cloud optical depth (non-delta scaled)<a name='1631'></font>
                                                      <font color=#447700>!    Dimensions: (nbndsw,ncol,nlay)<a name='1632'></font>
      real(kind=rb), intent(in) :: ssac(:,:,:)        <font color=#447700>! in-cloud single scattering albedo (non-delta scaled)<a name='1633'></font>
                                                      <font color=#447700>!    Dimensions: (nbndsw,ncol,nlay)<a name='1634'></font>
      real(kind=rb), intent(in) :: asmc(:,:,:)        <font color=#447700>! in-cloud asymmetry parameter (non-delta scaled)<a name='1635'></font>
                                                      <font color=#447700>!    Dimensions: (nbndsw,ncol,nlay)<a name='1636'></font>
      real(kind=rb), intent(in) :: fsfc(:,:,:)        <font color=#447700>! in-cloud forward scattering fraction (non-delta scaled)<a name='1637'></font>
                                                      <font color=#447700>!    Dimensions: (nbndsw,ncol,nlay)<a name='1638'></font>
<a name='1639'>
      real(kind=rb), intent(out) :: cld_stoch(:,:,:)  <font color=#447700>! subcolumn cloud fraction <a name='1640'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1641'></font>
      real(kind=rb), intent(out) :: clwp_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud liquid water path<a name='1642'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1643'></font>
      real(kind=rb), intent(out) :: ciwp_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud ice water path<a name='1644'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1645'></font>
      real(kind=rb), intent(out) :: cswp_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud snow water path<a name='1646'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1647'></font>
      real(kind=rb), intent(out) :: tauc_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud optical depth<a name='1648'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1649'></font>
      real(kind=rb), intent(out) :: ssac_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud single scattering albedo<a name='1650'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1651'></font>
      real(kind=rb), intent(out) :: asmc_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud asymmetry parameter<a name='1652'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1653'></font>
      real(kind=rb), intent(out) :: fsfc_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud forward scattering fraction<a name='1654'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1655'></font>
<a name='1656'>
<font color=#447700>! -- Local variables<a name='1657'></font>
      real(kind=rb) :: cldf(ncol,nlay)                <font color=#447700>! cloud fraction <a name='1658'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1659'></font>
<a name='1660'>
<font color=#447700>! Mean over the subcolumns (cloud fraction, cloud water , cloud ice) - inactive<a name='1661'></font>
<font color=#447700>!      real(kind=rb) :: mean_cld_stoch(ncol,nlay)     ! cloud fraction <a name='1662'></font>
<font color=#447700>!      real(kind=rb) :: mean_clwp_stoch(ncol,nlay)    ! cloud water<a name='1663'></font>
<font color=#447700>!      real(kind=rb) :: mean_ciwp_stoch(ncol,nlay)    ! cloud ice<a name='1664'></font>
<font color=#447700>!      real(kind=rb) :: mean_tauc_stoch(ncol,nlay)    ! cloud optical depth<a name='1665'></font>
<font color=#447700>!      real(kind=rb) :: mean_ssac_stoch(ncol,nlay)    ! cloud single scattering albedo<a name='1666'></font>
<font color=#447700>!      real(kind=rb) :: mean_asmc_stoch(ncol,nlay)    ! cloud asymmetry parameter<a name='1667'></font>
<font color=#447700>!      real(kind=rb) :: mean_fsfc_stoch(ncol,nlay)    ! cloud forward scattering fraction<a name='1668'></font>
<a name='1669'>
<font color=#447700>! Set overlap<a name='1670'></font>
      integer(kind=im) :: overlap                     <font color=#447700>! 1 = random overlap, 2 = maximum/random,<a name='1671'></font>
                                                      <font color=#447700>! 3 = maximum overlap, <a name='1672'></font>
<font color=#447700>!      real(kind=rb), parameter  :: Zo = 2500._rb        ! length scale (m) <a name='1673'></font>
<font color=#447700>!      real(kind=rb) :: zm(ncon,nlay)                    ! Height of midpoints (above surface)<a name='1674'></font>
<font color=#447700>!      real(kind=rb), dimension(nlay) :: alpha=0.0_rb    ! overlap parameter  <a name='1675'></font>
<a name='1676'>
<font color=#447700>! Constants (min value for cloud fraction and cloud water and ice)<a name='1677'></font>
      real(kind=rb), parameter :: cldmin = 1.0e-20_rb <font color=#447700>! min cloud fraction<a name='1678'></font>
<font color=#447700>!      real(kind=rb), parameter :: qmin   = 1.0e-10_rb   ! min cloud water and cloud ice (not used)<a name='1679'></font>
<a name='1680'>
<font color=#447700>! Variables related to random number and seed <a name='1681'></font>
      real(kind=rb), dimension(nsubcol, ncol, nlay) :: CDF, CDF2       <font color=#447700>! random numbers<a name='1682'></font>
      integer(kind=im), dimension(ncol) :: seed1, seed2, seed3, seed4  <font color=#447700>! seed to create random number<a name='1683'></font>
      real(kind=rb), dimension(ncol) :: rand_num       <font color=#447700>! random number (kissvec)<a name='1684'></font>
      integer(kind=im) :: iseed                        <font color=#447700>! seed to create random number (Mersenne Twister)<a name='1685'></font>
      real(kind=rb) :: rand_num_mt                     <font color=#447700>! random number (Mersenne Twister)<a name='1686'></font>
<a name='1687'>
<font color=#447700>! Flag to identify cloud fraction in subcolumns<a name='1688'></font>
      logical,  dimension(nsubcol, ncol, nlay) :: isCloudy   <font color=#447700>! flag that says whether a gridbox is cloudy<a name='1689'></font>
<a name='1690'>
<font color=#447700>! Indices<a name='1691'></font>
      integer(kind=im) :: ilev, isubcol, i, n, ngbm    <font color=#447700>! indices<a name='1692'></font>
<a name='1693'>
<font color=#447700>!------------------------------------------------------------------------------------------ <a name='1694'></font>
<a name='1695'>
<font color=#447700>! Check that irng is in bounds; if not, set to default<a name='1696'></font>
      if (irng .ne. 0) irng = 1<a name='1697'>
<a name='1698'>
<font color=#447700>! Pass input cloud overlap setting to local variable<a name='1699'></font>
      overlap = icld<a name='1700'>
<a name='1701'>
<font color=#447700>! Ensure that cloud fractions are in bounds <a name='1702'></font>
      do ilev = 1, nlay<a name='1703'>
         do i = 1, ncol<a name='1704'>
            cldf(i,ilev) = cld(i,ilev)<a name='1705'>
            if (cldf(i,ilev) &lt; cldmin) then<a name='1706'>
               cldf(i,ilev) = 0._rb<a name='1707'>
            endif<a name='1708'>
         enddo<a name='1709'>
      enddo<a name='1710'>
<a name='1711'>
<font color=#447700>! ----- Create seed  --------<a name='1712'></font>
   <a name='1713'>
<font color=#447700>! Advance randum number generator by changeseed values<a name='1714'></font>
      if (irng.eq.0) then   <a name='1715'>
<font color=#447700>! For kissvec, create a seed that depends on the state of the columns. Maybe not the best way, but it works.  <a name='1716'></font>
<font color=#447700>! Must use pmid from bottom four layers. <a name='1717'></font>
         do i=1,ncol<a name='1718'>
            if (pmid(i,1).lt.pmid(i,2)) then<a name='1719'>
               stop 'MCICA_SUBCOL: KISSVEC SEED GENERATOR REQUIRES PMID FROM BOTTOM FOUR LAYERS.'<a name='1720'>
            endif<a name='1721'>
            seed1(i) = (pmid(i,1) - int(pmid(i,1)))  * 1000000000_im<a name='1722'>
            seed2(i) = (pmid(i,2) - int(pmid(i,2)))  * 1000000000_im<a name='1723'>
            seed3(i) = (pmid(i,3) - int(pmid(i,3)))  * 1000000000_im<a name='1724'>
            seed4(i) = (pmid(i,4) - int(pmid(i,4)))  * 1000000000_im<a name='1725'>
          enddo<a name='1726'>
         do i=1,changeSeed<a name='1727'>
            call <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#KISSVEC'>kissvec</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#GENERATE_STOCHASTIC_CLOUDS_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="KISSVEC_9">(seed1, seed2, seed3, seed4, rand_num)<a name='1728'>
         enddo<a name='1729'>
      elseif (irng.eq.1) then<a name='1730'>
         randomNumbers = new_RandomNumberSequence(seed = changeSeed)<a name='1731'>
      endif <a name='1732'>
<a name='1733'>
<a name='1734'>
<font color=#447700>! ------ Apply overlap assumption --------<a name='1735'></font>
<a name='1736'>
<font color=#447700>! generate the random numbers  <a name='1737'></font>
<a name='1738'>
      select case (overlap)<a name='1739'>
<a name='1740'>
      case(1) <a name='1741'>
<font color=#447700>! Random overlap<a name='1742'></font>
<font color=#447700>! i) pick a random value at every level<a name='1743'></font>
  <a name='1744'>
         if (irng.eq.0) then <a name='1745'>
            do isubcol = 1,nsubcol<a name='1746'>
               do ilev = 1,nlay<a name='1747'>
                  call <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#KISSVEC'>kissvec</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#GENERATE_STOCHASTIC_CLOUDS_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="KISSVEC_10">(seed1, seed2, seed3, seed4, rand_num)<a name='1748'>
                  CDF(isubcol,:,ilev) = rand_num<a name='1749'>
               enddo<a name='1750'>
            enddo<a name='1751'>
         elseif (irng.eq.1) then<a name='1752'>
            do isubcol = 1, nsubcol<a name='1753'>
               do i = 1, ncol<a name='1754'>
                  do ilev = 1, nlay<a name='1755'>
                     rand_num_mt = <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#GETRANDOMREAL'>getRandomReal</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#GENERATE_STOCHASTIC_CLOUDS_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETRANDOMREAL_8">(randomNumbers)<a name='1756'>
                     CDF(isubcol,i,ilev) = rand_num_mt<a name='1757'>
                  enddo<a name='1758'>
               enddo<a name='1759'>
             enddo<a name='1760'>
         endif<a name='1761'>
<a name='1762'>
      case(2) <a name='1763'>
<font color=#447700>! Maximum-Random overlap<a name='1764'></font>
<font color=#447700>! i) pick  a random number for top layer.<a name='1765'></font>
<font color=#447700>! ii) walk down the column: <a name='1766'></font>
<font color=#447700>!    - if the layer above is cloudy, we use the same random number than in the layer above<a name='1767'></font>
<font color=#447700>!    - if the layer above is clear, we use a new random number <a name='1768'></font>
<a name='1769'>
         if (irng.eq.0) then <a name='1770'>
            do isubcol = 1,nsubcol<a name='1771'>
               do ilev = 1,nlay<a name='1772'>
                  call <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#KISSVEC'>kissvec</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#GENERATE_STOCHASTIC_CLOUDS_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="KISSVEC_11">(seed1, seed2, seed3, seed4, rand_num)<a name='1773'>
                  CDF(isubcol,:,ilev) = rand_num<a name='1774'>
               enddo<a name='1775'>
            enddo<a name='1776'>
         elseif (irng.eq.1) then<a name='1777'>
            do isubcol = 1, nsubcol<a name='1778'>
               do i = 1, ncol<a name='1779'>
                  do ilev = 1, nlay<a name='1780'>
                     rand_num_mt = <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#GETRANDOMREAL'>getRandomReal</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#GENERATE_STOCHASTIC_CLOUDS_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETRANDOMREAL_9">(randomNumbers)<a name='1781'>
                     CDF(isubcol,i,ilev) = rand_num_mt<a name='1782'>
                  enddo<a name='1783'>
               enddo<a name='1784'>
             enddo<a name='1785'>
         endif<a name='1786'>
<a name='1787'>
         do ilev = 2,nlay<a name='1788'>
            do i = 1, ncol<a name='1789'>
               do isubcol = 1, nsubcol<a name='1790'>
                  if (CDF(isubcol, i, ilev-1) &gt; 1._rb - cldf(i,ilev-1) ) then<a name='1791'>
                     CDF(isubcol,i,ilev) = CDF(isubcol,i,ilev-1) <a name='1792'>
                  else<a name='1793'>
                     CDF(isubcol,i,ilev) = CDF(isubcol,i,ilev) * (1._rb - cldf(i,ilev-1)) <a name='1794'>
                  endif<a name='1795'>
               enddo<a name='1796'>
            enddo<a name='1797'>
         enddo<a name='1798'>
<a name='1799'>
      case(3) <a name='1800'>
<font color=#447700>! Maximum overlap<a name='1801'></font>
<font color=#447700>! i) pick same random numebr at every level  <a name='1802'></font>
<a name='1803'>
         if (irng.eq.0) then <a name='1804'>
            do isubcol = 1,nsubcol<a name='1805'>
               call <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#KISSVEC'>kissvec</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#GENERATE_STOCHASTIC_CLOUDS_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="KISSVEC_12">(seed1, seed2, seed3, seed4, rand_num)<a name='1806'>
               do ilev = 1,nlay<a name='1807'>
                  CDF(isubcol,:,ilev) = rand_num<a name='1808'>
               enddo<a name='1809'>
            enddo<a name='1810'>
         elseif (irng.eq.1) then<a name='1811'>
            do isubcol = 1, nsubcol<a name='1812'>
               do i = 1, ncol<a name='1813'>
                  rand_num_mt = <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#GETRANDOMREAL'>getRandomReal</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#GENERATE_STOCHASTIC_CLOUDS_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETRANDOMREAL_10">(randomNumbers)<a name='1814'>
                  do ilev = 1, nlay<a name='1815'>
                     CDF(isubcol,i,ilev) = rand_num_mt<a name='1816'>
                  enddo<a name='1817'>
               enddo<a name='1818'>
             enddo<a name='1819'>
         endif<a name='1820'>
<a name='1821'>
<font color=#447700>!    case(4)  - inactive<a name='1822'></font>
<font color=#447700>!       ! Exponential overlap: weighting between maximum and random overlap increases with the distance. <a name='1823'></font>
<font color=#447700>!       ! The random numbers for exponential overlap verify:<a name='1824'></font>
<font color=#447700>!       ! j=1   RAN(j)=RND1<a name='1825'></font>
<font color=#447700>!       ! j&gt;1   if RND1 &lt; alpha(j,j-1) =&gt; RAN(j) = RAN(j-1)<a name='1826'></font>
<font color=#447700>!       !                                 RAN(j) = RND2<a name='1827'></font>
<font color=#447700>!       ! alpha is obtained from the equation<a name='1828'></font>
<font color=#447700>!       ! alpha = exp(- (Zi-Zj-1)/Zo) where Zo is a characteristic length scale    <a name='1829'></font>
<a name='1830'>
<a name='1831'>
<font color=#447700>!       ! compute alpha<a name='1832'></font>
<font color=#447700>!       zm    = state%zm     <a name='1833'></font>
<font color=#447700>!       alpha(:, 1) = 0._rb<a name='1834'></font>
<font color=#447700>!       do ilev = 2,nlay<a name='1835'></font>
<font color=#447700>!          alpha(:, ilev) = exp( -( zm (:, ilev-1) -  zm (:, ilev)) / Zo)<a name='1836'></font>
<font color=#447700>!       end do<a name='1837'></font>
       <a name='1838'>
<font color=#447700>!       ! generate 2 streams of random numbers<a name='1839'></font>
<font color=#447700>!       do isubcol = 1,nsubcol<a name='1840'></font>
<font color=#447700>!          do ilev = 1,nlay<a name='1841'></font>
<font color=#447700>!             call kissvec(seed1, seed2, seed3, seed4, rand_num)<a name='1842'></font>
<font color=#447700>!             CDF(isubcol, :, ilev) = rand_num<a name='1843'></font>
<font color=#447700>!             call kissvec(seed1, seed2, seed3, seed4, rand_num)<a name='1844'></font>
<font color=#447700>!             CDF2(isubcol, :, ilev) = rand_num<a name='1845'></font>
<font color=#447700>!          end do<a name='1846'></font>
<font color=#447700>!       end do<a name='1847'></font>
<a name='1848'>
<font color=#447700>!       ! generate random numbers<a name='1849'></font>
<font color=#447700>!       do ilev = 2,nlay<a name='1850'></font>
<font color=#447700>!          where (CDF2(:, :, ilev) &lt; spread(alpha (:,ilev), dim=1, nCopies=nsubcol) )<a name='1851'></font>
<font color=#447700>!             CDF(:,:,ilev) = CDF(:,:,ilev-1) <a name='1852'></font>
<font color=#447700>!          end where<a name='1853'></font>
<font color=#447700>!       end do<a name='1854'></font>
<a name='1855'>
      end select<a name='1856'>
<a name='1857'>
 <a name='1858'>
<font color=#447700>! -- generate subcolumns for homogeneous clouds -----<a name='1859'></font>
      do ilev = 1, nlay<a name='1860'>
         isCloudy(:,:,ilev) = (CDF(:,:,ilev) &gt;= 1._rb - spread(cldf(:,ilev), dim=1, nCopies=nsubcol) )<a name='1861'>
      enddo<a name='1862'>
<a name='1863'>
<font color=#447700>! where the subcolumn is cloudy, the subcolumn cloud fraction is 1;<a name='1864'></font>
<font color=#447700>! where the subcolumn is not cloudy, the subcolumn cloud fraction is 0;<a name='1865'></font>
<font color=#447700>! where there is a cloud, define the subcolumn cloud properties,<a name='1866'></font>
<font color=#447700>! otherwise set these to zero<a name='1867'></font>
<a name='1868'>
      ngbm = ngb(1) - 1<a name='1869'>
      do ilev = 1,nlay<a name='1870'>
         do i = 1, ncol<a name='1871'>
            do isubcol = 1, nsubcol<a name='1872'>
               if ( iscloudy(isubcol,i,ilev) ) then<a name='1873'>
                  cld_stoch(isubcol,i,ilev) = 1._rb<a name='1874'>
                  clwp_stoch(isubcol,i,ilev) = clwp(i,ilev)<a name='1875'>
                  ciwp_stoch(isubcol,i,ilev) = ciwp(i,ilev)<a name='1876'>
                  cswp_stoch(isubcol,i,ilev) = cswp(i,ilev)<a name='1877'>
                  n = ngb(isubcol) - ngbm<a name='1878'>
                  tauc_stoch(isubcol,i,ilev) = tauc(n,i,ilev)<a name='1879'>
                  ssac_stoch(isubcol,i,ilev) = ssac(n,i,ilev)<a name='1880'>
                  asmc_stoch(isubcol,i,ilev) = asmc(n,i,ilev)<a name='1881'>
                  fsfc_stoch(isubcol,i,ilev) = fsfc(n,i,ilev)<a name='1882'>
               else<a name='1883'>
                  cld_stoch(isubcol,i,ilev) = 0._rb<a name='1884'>
                  clwp_stoch(isubcol,i,ilev) = 0._rb<a name='1885'>
                  ciwp_stoch(isubcol,i,ilev) = 0._rb<a name='1886'>
                  cswp_stoch(isubcol,i,ilev) = 0._rb<a name='1887'>
                  tauc_stoch(isubcol,i,ilev) = 0._rb<a name='1888'>
                  ssac_stoch(isubcol,i,ilev) = 1._rb<a name='1889'>
                  asmc_stoch(isubcol,i,ilev) = 0._rb<a name='1890'>
                  fsfc_stoch(isubcol,i,ilev) = 0._rb<a name='1891'>
               endif<a name='1892'>
            enddo<a name='1893'>
         enddo<a name='1894'>
      enddo<a name='1895'>
<a name='1896'>
<font color=#447700>! -- compute the means of the subcolumns ---<a name='1897'></font>
<font color=#447700>!      mean_cld_stoch(:,:) = 0._rb<a name='1898'></font>
<font color=#447700>!      mean_clwp_stoch(:,:) = 0._rb<a name='1899'></font>
<font color=#447700>!      mean_ciwp_stoch(:,:) = 0._rb<a name='1900'></font>
<font color=#447700>!      mean_tauc_stoch(:,:) = 0._rb<a name='1901'></font>
<font color=#447700>!      mean_ssac_stoch(:,:) = 0._rb<a name='1902'></font>
<font color=#447700>!      mean_asmc_stoch(:,:) = 0._rb<a name='1903'></font>
<font color=#447700>!      mean_fsfc_stoch(:,:) = 0._rb<a name='1904'></font>
<font color=#447700>!      do i = 1, nsubcol<a name='1905'></font>
<font color=#447700>!         mean_cld_stoch(:,:) =  cld_stoch(i,:,:) + mean_cld_stoch(:,:) <a name='1906'></font>
<font color=#447700>!         mean_clwp_stoch(:,:) =  clwp_stoch( i,:,:) + mean_clwp_stoch(:,:) <a name='1907'></font>
<font color=#447700>!         mean_ciwp_stoch(:,:) =  ciwp_stoch( i,:,:) + mean_ciwp_stoch(:,:) <a name='1908'></font>
<font color=#447700>!         mean_tauc_stoch(:,:) =  tauc_stoch( i,:,:) + mean_tauc_stoch(:,:) <a name='1909'></font>
<font color=#447700>!         mean_ssac_stoch(:,:) =  ssac_stoch( i,:,:) + mean_ssac_stoch(:,:) <a name='1910'></font>
<font color=#447700>!         mean_asmc_stoch(:,:) =  asmc_stoch( i,:,:) + mean_asmc_stoch(:,:) <a name='1911'></font>
<font color=#447700>!         mean_fsfc_stoch(:,:) =  fsfc_stoch( i,:,:) + mean_fsfc_stoch(:,:) <a name='1912'></font>
<font color=#447700>!      end do<a name='1913'></font>
<font color=#447700>!      mean_cld_stoch(:,:) = mean_cld_stoch(:,:) / nsubcol<a name='1914'></font>
<font color=#447700>!      mean_clwp_stoch(:,:) = mean_clwp_stoch(:,:) / nsubcol<a name='1915'></font>
<font color=#447700>!      mean_ciwp_stoch(:,:) = mean_ciwp_stoch(:,:) / nsubcol<a name='1916'></font>
<font color=#447700>!      mean_tauc_stoch(:,:) = mean_tauc_stoch(:,:) / nsubcol<a name='1917'></font>
<font color=#447700>!      mean_ssac_stoch(:,:) = mean_ssac_stoch(:,:) / nsubcol<a name='1918'></font>
<font color=#447700>!      mean_asmc_stoch(:,:) = mean_asmc_stoch(:,:) / nsubcol<a name='1919'></font>
<font color=#447700>!      mean_fsfc_stoch(:,:) = mean_fsfc_stoch(:,:) / nsubcol<a name='1920'></font>
<a name='1921'>
      end subroutine generate_stochastic_clouds_sw<a name='1922'>
<a name='1923'>
<a name='1924'>
<font color=#447700>!-------------------------------------------------------------------------------------------------- <a name='1925'></font>
<A NAME='KISSVEC'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#KISSVEC' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1926'>
      <font color=#993300>subroutine </font><font color=#cc0000>kissvec</font>(seed1,seed2,seed3,seed4,ran_arr) <A href='../../call_to/KISSVEC.html' TARGET='index'>12</A><a name='1927'>
<font color=#447700>!-------------------------------------------------------------------------------------------------- <a name='1928'></font>
<a name='1929'>
<font color=#447700>! public domain code<a name='1930'></font>
<font color=#447700>! made available from http://www.fortran.com/<a name='1931'></font>
<font color=#447700>! downloaded by pjr on 03/16/04 for NCAR CAM<a name='1932'></font>
<font color=#447700>! converted to vector form, functions inlined by pjr,mvr on 05/10/2004<a name='1933'></font>
<a name='1934'>
<font color=#447700>! The  KISS (Keep It Simple Stupid) random number generator. Combines:<a name='1935'></font>
<font color=#447700>! (1) The congruential generator x(n)=69069*x(n-1)+1327217885, period 2^32.<a name='1936'></font>
<font color=#447700>! (2) A 3-shift shift-register generator, period 2^32-1,<a name='1937'></font>
<font color=#447700>! (3) Two 16-bit multiply-with-carry generators, period 597273182964842497&gt;2^59<a name='1938'></font>
<font color=#447700>!  Overall period&gt;2^123; <a name='1939'></font>
<font color=#447700>!<a name='1940'></font>
      real(kind=rb), dimension(:), intent(inout)  :: ran_arr<a name='1941'>
      integer(kind=im), dimension(:), intent(inout) :: seed1,seed2,seed3,seed4<a name='1942'>
      integer(kind=im) :: i,sz,kiss<a name='1943'>
      integer(kind=im) :: m, k, n<a name='1944'>
<a name='1945'>
<font color=#447700>! inline function <a name='1946'></font>
      m(k, n) = ieor (k, ishft (k, n) )<a name='1947'>
<a name='1948'>
      sz = size(ran_arr)<a name='1949'>
      do i = 1, sz<a name='1950'>
         seed1(i) = 69069_im * seed1(i) + 1327217885_im<a name='1951'>
         seed2(i) = m (m (m (seed2(i), 13_im), - 17_im), 5_im)<a name='1952'>
         seed3(i) = 18000_im * iand (seed3(i), 65535_im) + ishft (seed3(i), - 16_im)<a name='1953'>
         seed4(i) = 30903_im * iand (seed4(i), 65535_im) + ishft (seed4(i), - 16_im)<a name='1954'>
         kiss = seed1(i) + seed2(i) + ishft (seed3(i), 16_im) + seed4(i)<a name='1955'>
         ran_arr(i) = kiss*2.328306e-10_rb + 0.5_rb<a name='1956'>
      end do<a name='1957'>
    <a name='1958'>
      end subroutine kissvec<a name='1959'>
<a name='1960'>
      end module mcica_subcol_gen_sw<a name='1961'>
<a name='1962'>
<font color=#447700>!     path:      $Source: /cvsroot/NWP/WRFV3/phys/module_ra_rrtmg_sw.F,v $<a name='1963'></font>
<font color=#447700>!     author:    $Author: trn $<a name='1964'></font>
<font color=#447700>!     revision:  $Revision: 1.3 $<a name='1965'></font>
<font color=#447700>!     created:   $Date: 2009/04/16 19:54:22 $<a name='1966'></font>
<a name='1967'>
<A NAME='RRTMG_SW_CLDPRMC'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_CLDPRMC' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1968'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_cldprmc</font> <A href='../../call_to/RRTMG_SW_CLDPRMC.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_CLDPRMC.html' TARGET='index'>5</A><a name='1969'>
<a name='1970'>
<font color=#447700>!  --------------------------------------------------------------------------<a name='1971'></font>
<font color=#447700>! |                                                                          |<a name='1972'></font>
<font color=#447700>! |  Copyright 2002-2008, Atmospheric &amp; Environmental Research, Inc. (AER).  |<a name='1973'></font>
<font color=#447700>! |  This software may be used, copied, or redistributed as long as it is    |<a name='1974'></font>
<font color=#447700>! |  not sold and this copyright notice is reproduced on each copy made.     |<a name='1975'></font>
<font color=#447700>! |  This model is provided as is without any express or implied warranties. |<a name='1976'></font>
<font color=#447700>! |                       (http://www.rtweb.aer.com/)                        |<a name='1977'></font>
<font color=#447700>! |                                                                          |<a name='1978'></font>
<font color=#447700>!  --------------------------------------------------------------------------<a name='1979'></font>
<a name='1980'>
<font color=#447700>! ------- Modules -------<a name='1981'></font>
<a name='1982'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_CLDPRMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_54">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='1983'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_CLDPRMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_18">, only : ngptsw, jpband, jpb1, jpb2<a name='1984'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_CLD'>rrsw_cld</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_CLDPRMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CLD_1">, only : extliq1, ssaliq1, asyliq1, &amp;<a name='1985'>
                           extice2, ssaice2, asyice2, &amp;<a name='1986'>
                           extice3, ssaice3, asyice3, fdlice3, &amp;<a name='1987'>
                           abari, bbari, cbari, dbari, ebari, fbari<a name='1988'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_WVN'>rrsw_wvn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_CLDPRMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_2">, only : wavenum1, wavenum2, ngb<a name='1989'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_VSN'>rrsw_vsn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_CLDPRMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_2">, only : hvrclc, hnamclc<a name='1990'>
<a name='1991'>
      implicit none<a name='1992'>
<a name='1993'>
      contains<a name='1994'>
<a name='1995'>
<font color=#447700>! ----------------------------------------------------------------------------<a name='1996'></font>
<A NAME='CLDPRMC_SW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CLDPRMC_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1997'>
      <font color=#993300>subroutine </font><font color=#cc0000>cldprmc_sw</font>(nlayers, inflag, iceflag, liqflag, cldfmc, &amp; <A href='../../call_to/CLDPRMC_SW.html' TARGET='index'>2</A>,<A href='../../call_from/CLDPRMC_SW.html' TARGET='index'>11</A><a name='1998'>
                            ciwpmc, clwpmc, cswpmc, reicmc, relqmc, resnmc, &amp;<a name='1999'>
                            taormc, taucmc, ssacmc, asmcmc, fsfcmc)<a name='2000'>
<font color=#447700>! ----------------------------------------------------------------------------<a name='2001'></font>
<a name='2002'>
<font color=#447700>! Purpose: Compute the cloud optical properties for each cloudy layer<a name='2003'></font>
<font color=#447700>! and g-point interval for use by the McICA method.  <a name='2004'></font>
<font color=#447700>! Note: Only inflag = 0 and inflag=2/liqflag=1/iceflag=2,3 are available;<a name='2005'></font>
<font color=#447700>! (Hu &amp; Stamnes, Key, and Fu) are implemented. <a name='2006'></font>
<a name='2007'>
<font color=#447700>! ------- Input -------<a name='2008'></font>
<a name='2009'>
      integer(kind=im), intent(in) :: nlayers         <font color=#447700>! total number of layers<a name='2010'></font>
      integer(kind=im), intent(in) :: inflag          <font color=#447700>! see definitions<a name='2011'></font>
      integer(kind=im), intent(in) :: iceflag         <font color=#447700>! see definitions<a name='2012'></font>
      integer(kind=im), intent(in) :: liqflag         <font color=#447700>! see definitions<a name='2013'></font>
<a name='2014'>
      real(kind=rb), intent(in) :: cldfmc(:,:)        <font color=#447700>! cloud fraction [mcica]<a name='2015'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='2016'></font>
      real(kind=rb), intent(in) :: ciwpmc(:,:)        <font color=#447700>! cloud ice water path [mcica]<a name='2017'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='2018'></font>
      real(kind=rb), intent(in) :: clwpmc(:,:)        <font color=#447700>! cloud liquid water path [mcica]<a name='2019'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='2020'></font>
      real(kind=rb), intent(in) :: cswpmc(:,:)        <font color=#447700>! cloud snow water path [mcica]<a name='2021'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='2022'></font>
      real(kind=rb), intent(in) :: resnmc(:)          <font color=#447700>! cloud snow particle effective radius (microns)<a name='2023'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2024'></font>
      real(kind=rb), intent(in) :: relqmc(:)          <font color=#447700>! cloud liquid particle effective radius (microns)<a name='2025'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2026'></font>
      real(kind=rb), intent(in) :: reicmc(:)          <font color=#447700>! cloud ice particle effective radius (microns)<a name='2027'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2028'></font>
                                                      <font color=#447700>! specific definition of reicmc depends on setting of iceflag:<a name='2029'></font>
                                                      <font color=#447700>! iceflag = 1: ice effective radius, r_ec, (Ebert and Curry, 1992),<a name='2030'></font>
                                                      <font color=#447700>!              r_ec range is limited to 13.0 to 130.0 microns<a name='2031'></font>
                                                      <font color=#447700>! iceflag = 2: ice effective radius, r_k, (Key, Streamer Ref. Manual, 1996)<a name='2032'></font>
                                                      <font color=#447700>!              r_k range is limited to 5.0 to 131.0 microns<a name='2033'></font>
                                                      <font color=#447700>! iceflag = 3: generalized effective size, dge, (Fu, 1996),<a name='2034'></font>
                                                      <font color=#447700>!              dge range is limited to 5.0 to 140.0 microns<a name='2035'></font>
                                                      <font color=#447700>!              [dge = 1.0315 * r_ec]<a name='2036'></font>
      real(kind=rb), intent(in) :: fsfcmc(:,:)        <font color=#447700>! cloud forward scattering fraction<a name='2037'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='2038'></font>
<a name='2039'>
<font color=#447700>! ------- Output -------<a name='2040'></font>
<a name='2041'>
      real(kind=rb), intent(inout) :: taucmc(:,:)     <font color=#447700>! cloud optical depth (delta scaled)<a name='2042'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='2043'></font>
      real(kind=rb), intent(inout) :: ssacmc(:,:)     <font color=#447700>! single scattering albedo (delta scaled)<a name='2044'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='2045'></font>
      real(kind=rb), intent(inout) :: asmcmc(:,:)     <font color=#447700>! asymmetry parameter (delta scaled)<a name='2046'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='2047'></font>
      real(kind=rb), intent(out) :: taormc(:,:)       <font color=#447700>! cloud optical depth (non-delta scaled)<a name='2048'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='2049'></font>
<a name='2050'>
<font color=#447700>! ------- Local -------<a name='2051'></font>
<a name='2052'>
<font color=#447700>!      integer(kind=im) :: ncbands<a name='2053'></font>
      integer(kind=im) :: ib, lay, istr, index, icx, ig<a name='2054'>
<a name='2055'>
      real(kind=rb), parameter :: eps = 1.e-06_rb     <font color=#447700>! epsilon<a name='2056'></font>
      real(kind=rb), parameter :: cldmin = 1.e-20_rb  <font color=#447700>! minimum value for cloud quantities<a name='2057'></font>
      real(kind=rb) :: cwp                            <font color=#447700>! total cloud water path<a name='2058'></font>
      real(kind=rb) :: radliq                         <font color=#447700>! cloud liquid droplet radius (microns)<a name='2059'></font>
      real(kind=rb) :: radice                         <font color=#447700>! cloud ice effective size (microns)<a name='2060'></font>
      real(kind=rb) :: radsno                         <font color=#447700>! cloud snow effective size (microns)<a name='2061'></font>
      real(kind=rb) :: factor<a name='2062'>
      real(kind=rb) :: fint<a name='2063'>
<a name='2064'>
      real(kind=rb) :: taucldorig_a, taucloud_a, ssacloud_a, ffp, ffp1, ffpssa<a name='2065'>
      real(kind=rb) :: tauiceorig, scatice, ssaice, tauice, tauliqorig, scatliq, ssaliq, tauliq<a name='2066'>
      real(kind=rb) :: tausnoorig, scatsno, ssasno, tausno<a name='2067'>
<a name='2068'>
      real(kind=rb) :: fdelta(ngptsw)<a name='2069'>
      real(kind=rb) :: extcoice(ngptsw), gice(ngptsw)<a name='2070'>
      real(kind=rb) :: ssacoice(ngptsw), forwice(ngptsw)<a name='2071'>
      real(kind=rb) :: extcoliq(ngptsw), gliq(ngptsw)<a name='2072'>
      real(kind=rb) :: ssacoliq(ngptsw), forwliq(ngptsw)<a name='2073'>
      real(kind=rb) :: extcosno(ngptsw), gsno(ngptsw)<a name='2074'>
      real(kind=rb) :: ssacosno(ngptsw), forwsno(ngptsw)<a name='2075'>
<a name='2076'>
      CHARACTER*80 errmess<a name='2077'>
<a name='2078'>
<font color=#447700>! Initialize<a name='2079'></font>
<a name='2080'>
<font color=#447700>!jm not thread safe      hvrclc = '$Revision: 1.3 $'<a name='2081'></font>
<a name='2082'>
<font color=#447700>! Some of these initializations are done elsewhere<a name='2083'></font>
      do lay = 1, nlayers<a name='2084'>
         do ig = 1, ngptsw<a name='2085'>
            taormc(ig,lay) = taucmc(ig,lay)<a name='2086'>
<font color=#447700>!            taucmc(ig,lay) = 0.0_rb<a name='2087'></font>
<font color=#447700>!            ssacmc(ig,lay) = 1.0_rb<a name='2088'></font>
<font color=#447700>!            asmcmc(ig,lay) = 0.0_rb<a name='2089'></font>
         enddo<a name='2090'>
      enddo<a name='2091'>
<a name='2092'>
<font color=#447700>! Main layer loop<a name='2093'></font>
      do lay = 1, nlayers<a name='2094'>
<a name='2095'>
<font color=#447700>! Main g-point interval loop<a name='2096'></font>
         do ig = 1, ngptsw <a name='2097'>
            cwp = ciwpmc(ig,lay) + clwpmc(ig,lay) + cswpmc(ig,lay)<a name='2098'>
<a name='2099'>
            if (cldfmc(ig,lay) .ge. cldmin .and. &amp;<a name='2100'>
               (cwp .ge. cldmin .or. taucmc(ig,lay) .ge. cldmin)) then<a name='2101'>
<a name='2102'>
<font color=#447700>! (inflag=0): Cloud optical properties input directly<a name='2103'></font>
               if (inflag .eq. 0) then<a name='2104'>
<font color=#447700>! Cloud optical properties already defined in taucmc, ssacmc, asmcmc are unscaled;<a name='2105'></font>
<font color=#447700>! Apply delta-M scaling here (using Henyey-Greenstein approximation)<a name='2106'></font>
                  taucldorig_a = taucmc(ig,lay)<a name='2107'>
                  ffp = fsfcmc(ig,lay)<a name='2108'>
                  ffp1 = 1.0_rb - ffp<a name='2109'>
                  ffpssa = 1.0_rb - ffp * ssacmc(ig,lay)<a name='2110'>
                  ssacloud_a = ffp1 * ssacmc(ig,lay) / ffpssa<a name='2111'>
                  taucloud_a = ffpssa * taucldorig_a<a name='2112'>
<a name='2113'>
                  taormc(ig,lay) = taucldorig_a<a name='2114'>
                  ssacmc(ig,lay) = ssacloud_a<a name='2115'>
                  taucmc(ig,lay) = taucloud_a<a name='2116'>
                  asmcmc(ig,lay) = (asmcmc(ig,lay) - ffp) / (ffp1)<a name='2117'>
<a name='2118'>
               elseif (inflag .eq. 1) then <a name='2119'>
                  stop 'INFLAG = 1 OPTION NOT AVAILABLE WITH MCICA'<a name='2120'>
<a name='2121'>
<font color=#447700>! (inflag=2): Separate treatement of ice clouds and water clouds.<a name='2122'></font>
               elseif (inflag .ge. 2) then<a name='2123'>
                  radice = reicmc(lay)<a name='2124'>
<a name='2125'>
<font color=#447700>! Calculation of absorption coefficients due to ice clouds.<a name='2126'></font>
                  if ((ciwpmc(ig,lay)+cswpmc(ig,lay)) .eq. 0.0_rb) then<a name='2127'>
                     extcoice(ig) = 0.0_rb<a name='2128'>
                     ssacoice(ig) = 0.0_rb<a name='2129'>
                     gice(ig)     = 0.0_rb<a name='2130'>
                     forwice(ig)  = 0.0_rb<a name='2131'>
<a name='2132'>
                     extcosno(ig) = 0.0_rb<a name='2133'>
                     ssacosno(ig) = 0.0_rb<a name='2134'>
                     gsno(ig)     = 0.0_rb<a name='2135'>
                     forwsno(ig)  = 0.0_rb<a name='2136'>
<a name='2137'>
<font color=#447700>! (iceflag = 1): <a name='2138'></font>
<font color=#447700>! Note: This option uses Ebert and Curry approach for all particle sizes similar to<a name='2139'></font>
<font color=#447700>! CAM3 implementation, though this is somewhat unjustified for large ice particles<a name='2140'></font>
                  elseif (iceflag .eq. 1) then<a name='2141'>
                     ib = ngb(ig)<a name='2142'>
                     if (wavenum2(ib) .gt. 1.43e04_rb) then<a name='2143'>
                        icx = 1<a name='2144'>
                     elseif (wavenum2(ib) .gt. 7.7e03_rb) then<a name='2145'>
                        icx = 2<a name='2146'>
                     elseif (wavenum2(ib) .gt. 5.3e03_rb) then<a name='2147'>
                        icx = 3<a name='2148'>
                     elseif (wavenum2(ib) .gt. 4.0e03_rb) then<a name='2149'>
                        icx = 4<a name='2150'>
                     elseif (wavenum2(ib) .ge. 2.5e03_rb) then<a name='2151'>
                        icx = 5<a name='2152'>
                     endif<a name='2153'>
                     extcoice(ig) = (abari(icx) + bbari(icx)/radice)<a name='2154'>
                     ssacoice(ig) = 1._rb - cbari(icx) - dbari(icx) * radice<a name='2155'>
                     gice(ig) = ebari(icx) + fbari(icx) * radice<a name='2156'>
<font color=#447700>! Check to ensure upper limit of gice is within physical limits for large particles<a name='2157'></font>
                     if (gice(ig).ge.1._rb) gice(ig) = 1._rb - eps<a name='2158'>
                     forwice(ig) = gice(ig)*gice(ig)<a name='2159'>
<font color=#447700>! Check to ensure all calculated quantities are within physical limits.<a name='2160'></font>
                     if (extcoice(ig) .lt. 0.0_rb) stop 'ICE EXTINCTION LESS THAN 0.0'<a name='2161'>
                     if (ssacoice(ig) .gt. 1.0_rb) stop 'ICE SSA GRTR THAN 1.0'<a name='2162'>
                     if (ssacoice(ig) .lt. 0.0_rb) stop 'ICE SSA LESS THAN 0.0'<a name='2163'>
                     if (gice(ig) .gt. 1.0_rb) stop 'ICE ASYM GRTR THAN 1.0'<a name='2164'>
                     if (gice(ig) .lt. 0.0_rb) stop 'ICE ASYM LESS THAN 0.0'<a name='2165'>
<a name='2166'>
<font color=#447700>! For iceflag=2 option, ice particle effective radius is limited to 5.0 to 131.0 microns<a name='2167'></font>
<a name='2168'>
                  elseif (iceflag .eq. 2) then<a name='2169'>
                     if (radice .lt. 5.0_rb .or. radice .gt. 131.0_rb) stop 'ICE RADIUS OUT OF BOUNDS'<a name='2170'>
                     factor = (radice - 2._rb)/3._rb<a name='2171'>
                     index = int(factor)<a name='2172'>
                     if (index .eq. 43) index = 42<a name='2173'>
                     fint = factor - float(index)<a name='2174'>
                     ib = ngb(ig)<a name='2175'>
                     extcoice(ig) = extice2(index,ib) + fint * &amp;<a name='2176'>
                                   (extice2(index+1,ib) -  extice2(index,ib))<a name='2177'>
                     ssacoice(ig) = ssaice2(index,ib) + fint * &amp;<a name='2178'>
                                   (ssaice2(index+1,ib) -  ssaice2(index,ib))<a name='2179'>
                     gice(ig) = asyice2(index,ib) + fint * &amp;<a name='2180'>
                                   (asyice2(index+1,ib) -  asyice2(index,ib))<a name='2181'>
                     forwice(ig) = gice(ig)*gice(ig)<a name='2182'>
<font color=#447700>! Check to ensure all calculated quantities are within physical limits.<a name='2183'></font>
                     if (extcoice(ig) .lt. 0.0_rb) stop 'ICE EXTINCTION LESS THAN 0.0'<a name='2184'>
                     if (ssacoice(ig) .gt. 1.0_rb) stop 'ICE SSA GRTR THAN 1.0'<a name='2185'>
                     if (ssacoice(ig) .lt. 0.0_rb) stop 'ICE SSA LESS THAN 0.0'<a name='2186'>
                     if (gice(ig) .gt. 1.0_rb) stop 'ICE ASYM GRTR THAN 1.0'<a name='2187'>
                     if (gice(ig) .lt. 0.0_rb) stop 'ICE ASYM LESS THAN 0.0'<a name='2188'>
<a name='2189'>
<font color=#447700>! For iceflag=3 option, ice particle generalized effective size is limited to 5.0 to 140.0 microns<a name='2190'></font>
<a name='2191'>
                  elseif (iceflag .ge. 3) then<a name='2192'>
                     if (radice .lt. 5.0_rb .or. radice .gt. 140.0_rb) then<a name='2193'>
                         write(errmess,'(A,i5,i5,f8.2,f8.2)' )         &amp;<a name='2194'>
               'ERROR: ICE GENERALIZED EFFECTIVE SIZE OUT OF BOUNDS'   &amp;<a name='2195'>
               ,ig, lay, ciwpmc(ig,lay), radice<a name='2196'>
                         call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1072">(errmess)<a name='2197'>
                     end if<a name='2198'>
                     factor = (radice - 2._rb)/3._rb<a name='2199'>
                     index = int(factor)<a name='2200'>
                     if (index .eq. 46) index = 45<a name='2201'>
                     fint = factor - float(index)<a name='2202'>
                     ib = ngb(ig)<a name='2203'>
                     extcoice(ig) = extice3(index,ib) + fint * &amp;<a name='2204'>
                                   (extice3(index+1,ib) - extice3(index,ib))<a name='2205'>
                     ssacoice(ig) = ssaice3(index,ib) + fint * &amp;<a name='2206'>
                                   (ssaice3(index+1,ib) - ssaice3(index,ib))<a name='2207'>
                     gice(ig) = asyice3(index,ib) + fint * &amp;<a name='2208'>
                               (asyice3(index+1,ib) - asyice3(index,ib))<a name='2209'>
                     fdelta(ig) = fdlice3(index,ib) + fint * &amp;<a name='2210'>
                                 (fdlice3(index+1,ib) - fdlice3(index,ib))<a name='2211'>
                     if (fdelta(ig) .lt. 0.0_rb) then<a name='2212'>
                      write(errmess, *) 'FDELTA LESS THAN 0.0'<a name='2213'>
                      call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1073">(errmess)<a name='2214'>
                     end if<a name='2215'>
                     if (fdelta(ig) .gt. 1.0_rb) then<a name='2216'>
                      write(errmess, *) 'FDELTA GT THAN 1.0'<a name='2217'>
                      call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1074">(errmess)<a name='2218'>
                     end if<a name='2219'>
                     forwice(ig) = fdelta(ig) + 0.5_rb / ssacoice(ig)<a name='2220'>
<font color=#447700>! See Fu 1996 p. 2067 <a name='2221'></font>
                     if (forwice(ig) .gt. gice(ig)) forwice(ig) = gice(ig)<a name='2222'>
<font color=#447700>! Check to ensure all calculated quantities are within physical limits.  <a name='2223'></font>
                     if (extcoice(ig) .lt. 0.0_rb) stop 'ICE EXTINCTION LESS THAN 0.0'<a name='2224'>
                     if (ssacoice(ig) .gt. 1.0_rb) stop 'ICE SSA GRTR THAN 1.0'<a name='2225'>
                     if (ssacoice(ig) .lt. 0.0_rb) stop 'ICE SSA LESS THAN 0.0'<a name='2226'>
                     if (gice(ig) .gt. 1.0_rb) stop 'ICE ASYM GRTR THAN 1.0'<a name='2227'>
                     if (gice(ig) .lt. 0.0_rb) stop 'ICE ASYM LESS THAN 0.0'<a name='2228'>
<a name='2229'>
                  endif<a name='2230'>
<a name='2231'>
<font color=#447700>!!!!!!!!!!!!!!!!!! Mukul !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<a name='2232'></font>
<font color=#447700>!!!!  INSERT THE EQUIVALENT SNOW VARIABLE CODE HERE<a name='2233'></font>
<font color=#447700>!!!! Although far from perfect, the snow will utilize the<a name='2234'></font>
<font color=#447700>!!!! same lookup table constants as cloud ice.  Changes<a name='2235'></font>
<font color=#447700>!!!! to those constants for larger particle snow would be<a name='2236'></font>
<font color=#447700>!!!! an improvement.<a name='2237'></font>
<font color=#447700>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<a name='2238'></font>
<a name='2239'>
                  if (cswpmc(ig,lay).gt.0.0_rb .and. iceflag .eq. 5) then<a name='2240'>
                     radsno = resnmc(lay)<a name='2241'>
                     if (radsno .lt. 5.0_rb .or. radsno .gt. 140.0_rb) then<a name='2242'>
                         write(errmess,'(A,i5,i5,f8.2,f8.2)' )         &amp;<a name='2243'>
               'ERROR: SNOW GENERALIZED EFFECTIVE SIZE OUT OF BOUNDS'   &amp;<a name='2244'>
               ,ig, lay, cswpmc(ig,lay), radsno<a name='2245'>
                         call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1075">(errmess)<a name='2246'>
                     end if<a name='2247'>
                     factor = (radsno - 2._rb)/3._rb<a name='2248'>
                     index = int(factor)<a name='2249'>
                     if (index .eq. 46) index = 45<a name='2250'>
                     fint = factor - float(index)<a name='2251'>
                     ib = ngb(ig)<a name='2252'>
                     extcosno(ig) = extice3(index,ib) + fint * &amp;<a name='2253'>
                                   (extice3(index+1,ib) - extice3(index,ib))<a name='2254'>
                     ssacosno(ig) = ssaice3(index,ib) + fint * &amp;<a name='2255'>
                                   (ssaice3(index+1,ib) - ssaice3(index,ib))<a name='2256'>
                     gsno(ig) = asyice3(index,ib) + fint * &amp;<a name='2257'>
                               (asyice3(index+1,ib) - asyice3(index,ib))<a name='2258'>
                     fdelta(ig) = fdlice3(index,ib) + fint * &amp;<a name='2259'>
                                 (fdlice3(index+1,ib) - fdlice3(index,ib))<a name='2260'>
                     if (fdelta(ig) .lt. 0.0_rb) then<a name='2261'>
                      write(errmess, *) 'FDELTA LESS THAN 0.0'<a name='2262'>
                      call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1076">(errmess)<a name='2263'>
                     end if<a name='2264'>
                     if (fdelta(ig) .gt. 1.0_rb) then<a name='2265'>
                      write(errmess, *) 'FDELTA GT THAN 1.0'<a name='2266'>
                      call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1077">(errmess)<a name='2267'>
                     end if<a name='2268'>
                     forwsno(ig) = fdelta(ig) + 0.5_rb / ssacosno(ig)<a name='2269'>
<font color=#447700>! See Fu 1996 p. 2067<a name='2270'></font>
                     if (forwsno(ig) .gt. gsno(ig)) forwsno(ig) = gsno(ig)<a name='2271'>
<font color=#447700>! Check to ensure all calculated quantities are within physical limits.  <a name='2272'></font>
                     if (extcosno(ig) .lt. 0.0_rb) then<a name='2273'>
                      write(errmess, *) 'SNOW EXTINCTION LESS THAN 0.0'<a name='2274'>
                      call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1078">(errmess)<a name='2275'>
                     end if<a name='2276'>
                     if (ssacosno(ig) .gt. 1.0_rb) then<a name='2277'>
                      write(errmess, *) 'SNOW SSA GRTR THAN 1.0'<a name='2278'>
                      call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1079">(errmess)<a name='2279'>
                     end if<a name='2280'>
                     if (ssacosno(ig) .lt. 0.0_rb)  then<a name='2281'>
                      write(errmess, *) 'SNOW SSA LESS THAN 0.0'<a name='2282'>
                      call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1080">(errmess)<a name='2283'>
                     end if<a name='2284'>
                     if (gsno(ig) .gt. 1.0_rb)  then<a name='2285'>
                      write(errmess, *) 'SNOW ASYM GRTR THAN 1.0'<a name='2286'>
                      call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1081">(errmess)<a name='2287'>
                     end if<a name='2288'>
                     if (gsno(ig) .lt. 0.0_rb)  then<a name='2289'>
                      write(errmess, *) 'SNOW ASYM LESS THAN 0.0'<a name='2290'>
                      call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1082">(errmess)<a name='2291'>
                     end if<a name='2292'>
                  else<a name='2293'>
                     extcosno(ig) = 0.0_rb<a name='2294'>
                     ssacosno(ig) = 0.0_rb<a name='2295'>
                     gsno(ig)     = 0.0_rb<a name='2296'>
                     forwsno(ig)  = 0.0_rb<a name='2297'>
                  endif<a name='2298'>
<a name='2299'>
<a name='2300'>
<font color=#447700>! Calculation of absorption coefficients due to water clouds.<a name='2301'></font>
                  if (clwpmc(ig,lay) .eq. 0.0_rb) then<a name='2302'>
                     extcoliq(ig) = 0.0_rb<a name='2303'>
                     ssacoliq(ig) = 0.0_rb<a name='2304'>
                     gliq(ig) = 0.0_rb<a name='2305'>
                     forwliq(ig) = 0.0_rb<a name='2306'>
<a name='2307'>
                  elseif (liqflag .eq. 1) then<a name='2308'>
                     radliq = relqmc(lay)<a name='2309'>
                     if (radliq .lt. 1.5_rb .or. radliq .gt. 60._rb) stop &amp;<a name='2310'>
                        'liquid effective radius out of bounds'<a name='2311'>
                     index = int(radliq - 1.5_rb)<a name='2312'>
                     if (index .eq. 0) index = 1<a name='2313'>
                     if (index .eq. 58) index = 57<a name='2314'>
                     fint = radliq - 1.5_rb - float(index)<a name='2315'>
                     ib = ngb(ig)<a name='2316'>
                     extcoliq(ig) = extliq1(index,ib) + fint * &amp;<a name='2317'>
                                   (extliq1(index+1,ib) - extliq1(index,ib))<a name='2318'>
                     ssacoliq(ig) = ssaliq1(index,ib) + fint * &amp;<a name='2319'>
                                   (ssaliq1(index+1,ib) - ssaliq1(index,ib))<a name='2320'>
                     if (fint .lt. 0._rb .and. ssacoliq(ig) .gt. 1._rb) &amp;<a name='2321'>
                                    ssacoliq(ig) = ssaliq1(index,ib)<a name='2322'>
                     gliq(ig) = asyliq1(index,ib) + fint * &amp;<a name='2323'>
                               (asyliq1(index+1,ib) - asyliq1(index,ib))<a name='2324'>
                     forwliq(ig) = gliq(ig)*gliq(ig)<a name='2325'>
<font color=#447700>! Check to ensure all calculated quantities are within physical limits.<a name='2326'></font>
                     if (extcoliq(ig) .lt. 0.0_rb) stop 'LIQUID EXTINCTION LESS THAN 0.0'<a name='2327'>
                     if (ssacoliq(ig) .gt. 1.0_rb) stop 'LIQUID SSA GRTR THAN 1.0'<a name='2328'>
                     if (ssacoliq(ig) .lt. 0.0_rb) stop 'LIQUID SSA LESS THAN 0.0'<a name='2329'>
                     if (gliq(ig) .gt. 1.0_rb) stop 'LIQUID ASYM GRTR THAN 1.0'<a name='2330'>
                     if (gliq(ig) .lt. 0.0_rb) stop 'LIQUID ASYM LESS THAN 0.0'<a name='2331'>
                  endif<a name='2332'>
   <a name='2333'>
<a name='2334'>
                  if (iceflag .lt. 5) then<a name='2335'>
                      tauliqorig = clwpmc(ig,lay) * extcoliq(ig)<a name='2336'>
                      tauiceorig = ciwpmc(ig,lay) * extcoice(ig)<a name='2337'>
                      taormc(ig,lay) = tauliqorig + tauiceorig<a name='2338'>
  <a name='2339'>
                      ssaliq = ssacoliq(ig) * (1._rb - forwliq(ig)) / &amp;<a name='2340'>
                               (1._rb - forwliq(ig) * ssacoliq(ig))<a name='2341'>
                      tauliq = (1._rb - forwliq(ig) * ssacoliq(ig)) * tauliqorig<a name='2342'>
                      ssaice = ssacoice(ig) * (1._rb - forwice(ig)) / &amp;<a name='2343'>
                               (1._rb - forwice(ig) * ssacoice(ig))<a name='2344'>
                      tauice = (1._rb - forwice(ig) * ssacoice(ig)) * tauiceorig<a name='2345'>
                      scatliq = ssaliq * tauliq<a name='2346'>
                      scatice = ssaice * tauice<a name='2347'>
                      scatsno = 0.0_rb <a name='2348'>
                      taucmc(ig,lay) = tauliq + tauice<a name='2349'>
                  else<a name='2350'>
                      tauliqorig = clwpmc(ig,lay) * extcoliq(ig)<a name='2351'>
                      tauiceorig = ciwpmc(ig,lay) * extcoice(ig)<a name='2352'>
                      tausnoorig = cswpmc(ig,lay) * extcosno(ig)<a name='2353'>
                      taormc(ig,lay) = tauliqorig + tauiceorig + tausnoorig<a name='2354'>
<a name='2355'>
                      ssaliq = ssacoliq(ig) * (1._rb - forwliq(ig)) / &amp;<a name='2356'>
                               (1._rb - forwliq(ig) * ssacoliq(ig))<a name='2357'>
                      tauliq = (1._rb - forwliq(ig) * ssacoliq(ig)) * tauliqorig<a name='2358'>
                      ssaice = ssacoice(ig) * (1._rb - forwice(ig)) / &amp;<a name='2359'>
                               (1._rb - forwice(ig) * ssacoice(ig))<a name='2360'>
                      tauice = (1._rb - forwice(ig) * ssacoice(ig)) * tauiceorig<a name='2361'>
                      ssasno = ssacosno(ig) * (1._rb - forwsno(ig)) / &amp;<a name='2362'>
                               (1._rb - forwsno(ig) * ssacosno(ig))<a name='2363'>
                      tausno = (1._rb - forwsno(ig) * ssacosno(ig)) * tausnoorig<a name='2364'>
                      scatliq = ssaliq * tauliq<a name='2365'>
                      scatice = ssaice * tauice<a name='2366'>
                      scatsno = ssasno * tausno<a name='2367'>
                      taucmc(ig,lay) = tauliq + tauice + tausno<a name='2368'>
                  endif<a name='2369'>
<a name='2370'>
<font color=#447700>! Ensure non-zero taucmc and scatice<a name='2371'></font>
                  if(taucmc(ig,lay).eq.0.) taucmc(ig,lay) = cldmin<a name='2372'>
                  if(scatice.eq.0.) scatice = cldmin<a name='2373'>
                  if(scatsno.eq.0.) scatsno = cldmin<a name='2374'>
<a name='2375'>
                  if (iceflag .lt. 5) then<a name='2376'>
                      ssacmc(ig,lay) = (scatliq + scatice) / taucmc(ig,lay)<a name='2377'>
                  else<a name='2378'>
                      ssacmc(ig,lay) = (scatliq + scatice + scatsno) / taucmc(ig,lay)<a name='2379'>
                  endif<a name='2380'>
<a name='2381'>
                  if (iceflag .eq. 3 .or. iceflag.eq.4) then<a name='2382'>
<font color=#447700>! In accordance with the 1996 Fu paper, equation A.3, <a name='2383'></font>
<font color=#447700>! the moments for ice were calculated depending on whether using spheres<a name='2384'></font>
<font color=#447700>! or hexagonal ice crystals.<a name='2385'></font>
<font color=#447700>! Set asymetry parameter to first moment (istr=1)<a name='2386'></font>
                     istr = 1<a name='2387'>
                     asmcmc(ig,lay) = (1.0_rb/(scatliq+scatice))* &amp;<a name='2388'>
                        (scatliq*(gliq(ig)**istr - forwliq(ig)) / &amp;<a name='2389'>
                        (1.0_rb - forwliq(ig)) + scatice * ((gice(ig)-forwice(ig))/ &amp;<a name='2390'>
                        (1.0_rb - forwice(ig)))**istr)<a name='2391'>
                  elseif (iceflag .eq. 5) then<a name='2392'>
                     istr = 1<a name='2393'>
                     asmcmc(ig,lay) = (1.0_rb/(scatliq+scatice+scatsno))                               &amp;<a name='2394'>
                                    *  (scatliq*(gliq(ig)**istr - forwliq(ig))/(1.0_rb - forwliq(ig))  &amp;<a name='2395'>
                                    + scatice * ((gice(ig)-forwice(ig))/(1.0_rb - forwice(ig)))        &amp;<a name='2396'>
                                    + scatsno * ((gsno(ig)-forwsno(ig))/(1.0_rb - forwsno(ig)))**istr)<a name='2397'>
<a name='2398'>
                  else <a name='2399'>
<font color=#447700>! This code is the standard method for delta-m scaling. <a name='2400'></font>
<font color=#447700>! Set asymetry parameter to first moment (istr=1)<a name='2401'></font>
                     istr = 1<a name='2402'>
                     asmcmc(ig,lay) = (scatliq *  &amp;<a name='2403'>
                        (gliq(ig)**istr - forwliq(ig)) / &amp;<a name='2404'>
                        (1.0_rb - forwliq(ig)) + scatice * (gice(ig)**istr - forwice(ig)) / &amp;<a name='2405'>
                        (1.0_rb - forwice(ig)))/(scatliq + scatice)<a name='2406'>
                  endif <a name='2407'>
<a name='2408'>
               endif<a name='2409'>
<a name='2410'>
            endif<a name='2411'>
<a name='2412'>
<font color=#447700>! End g-point interval loop<a name='2413'></font>
         enddo<a name='2414'>
<a name='2415'>
<font color=#447700>! End layer loop<a name='2416'></font>
      enddo<a name='2417'>
<a name='2418'>
      end subroutine cldprmc_sw<a name='2419'>
<a name='2420'>
      end module rrtmg_sw_cldprmc<a name='2421'>
<a name='2422'>
<font color=#447700>!     path:      $Source: /cvsroot/NWP/WRFV3/phys/module_ra_rrtmg_sw.F,v $<a name='2423'></font>
<font color=#447700>!     author:    $Author: trn $<a name='2424'></font>
<font color=#447700>!     revision:  $Revision: 1.3 $<a name='2425'></font>
<font color=#447700>!     created:   $Date: 2009/04/16 19:54:22 $<a name='2426'></font>
<a name='2427'>
<A NAME='RRTMG_SW_REFTRA'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_REFTRA' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='2428'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_reftra</font> <A href='../../call_to/RRTMG_SW_REFTRA.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_REFTRA.html' TARGET='index'>3</A><a name='2429'>
<a name='2430'>
<font color=#447700>!  --------------------------------------------------------------------------<a name='2431'></font>
<font color=#447700>! |                                                                          |<a name='2432'></font>
<font color=#447700>! |  Copyright 2002-2008, Atmospheric &amp; Environmental Research, Inc. (AER).  |<a name='2433'></font>
<font color=#447700>! |  This software may be used, copied, or redistributed as long as it is    |<a name='2434'></font>
<font color=#447700>! |  not sold and this copyright notice is reproduced on each copy made.     |<a name='2435'></font>
<font color=#447700>! |  This model is provided as is without any express or implied warranties. |<a name='2436'></font>
<font color=#447700>! |                       (http://www.rtweb.aer.com/)                        |<a name='2437'></font>
<font color=#447700>! |                                                                          |<a name='2438'></font>
<font color=#447700>!  --------------------------------------------------------------------------<a name='2439'></font>
<a name='2440'>
<font color=#447700>! ------- Modules -------<a name='2441'></font>
<a name='2442'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_REFTRA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_55">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='2443'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_TBL'>rrsw_tbl</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_REFTRA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_TBL_1">, only : tblint, bpade, od_lo, exp_tbl<a name='2444'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_VSN'>rrsw_vsn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_REFTRA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_3">, only : hvrrft, hnamrft<a name='2445'>
<a name='2446'>
      implicit none<a name='2447'>
<a name='2448'>
      contains<a name='2449'>
<a name='2450'>
<font color=#447700>! --------------------------------------------------------------------<a name='2451'></font>
<A NAME='REFTRA_SW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#REFTRA_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2452'>
      <font color=#993300>subroutine </font><font color=#cc0000>reftra_sw</font>(nlayers, lrtchk, pgg, prmuz, ptau, pw, &amp; <A href='../../call_to/REFTRA_SW.html' TARGET='index'>4</A><a name='2453'>
                           pref, prefd, ptra, ptrad)<a name='2454'>
<font color=#447700>! --------------------------------------------------------------------<a name='2455'></font>
  <a name='2456'>
<font color=#447700>! Purpose: computes the reflectivity and transmissivity of a clear or <a name='2457'></font>
<font color=#447700>!   cloudy layer using a choice of various approximations.<a name='2458'></font>
<font color=#447700>!<a name='2459'></font>
<font color=#447700>! Interface:  *rrtmg_sw_reftra* is called by *rrtmg_sw_spcvrt*<a name='2460'></font>
<font color=#447700>!<a name='2461'></font>
<font color=#447700>! Description:<a name='2462'></font>
<font color=#447700>! explicit arguments :<a name='2463'></font>
<font color=#447700>! --------------------<a name='2464'></font>
<font color=#447700>! inputs<a name='2465'></font>
<font color=#447700>! ------ <a name='2466'></font>
<font color=#447700>!      lrtchk  = .t. for all layers in clear profile<a name='2467'></font>
<font color=#447700>!      lrtchk  = .t. for cloudy layers in cloud profile <a name='2468'></font>
<font color=#447700>!              = .f. for clear layers in cloud profile<a name='2469'></font>
<font color=#447700>!      pgg     = assymetry factor<a name='2470'></font>
<font color=#447700>!      prmuz   = cosine solar zenith angle<a name='2471'></font>
<font color=#447700>!      ptau    = optical thickness<a name='2472'></font>
<font color=#447700>!      pw      = single scattering albedo<a name='2473'></font>
<font color=#447700>!<a name='2474'></font>
<font color=#447700>! outputs<a name='2475'></font>
<font color=#447700>! -------<a name='2476'></font>
<font color=#447700>!      pref    : collimated beam reflectivity<a name='2477'></font>
<font color=#447700>!      prefd   : diffuse beam reflectivity <a name='2478'></font>
<font color=#447700>!      ptra    : collimated beam transmissivity<a name='2479'></font>
<font color=#447700>!      ptrad   : diffuse beam transmissivity<a name='2480'></font>
<font color=#447700>!<a name='2481'></font>
<font color=#447700>!<a name='2482'></font>
<font color=#447700>! Method:<a name='2483'></font>
<font color=#447700>! -------<a name='2484'></font>
<font color=#447700>!      standard delta-eddington, p.i.f.m., or d.o.m. layer calculations.<a name='2485'></font>
<font color=#447700>!      kmodts  = 1 eddington (joseph et al., 1976)<a name='2486'></font>
<font color=#447700>!              = 2 pifm (zdunkowski et al., 1980)<a name='2487'></font>
<font color=#447700>!              = 3 discrete ordinates (liou, 1973)<a name='2488'></font>
<font color=#447700>!<a name='2489'></font>
<font color=#447700>!<a name='2490'></font>
<font color=#447700>! Modifications:<a name='2491'></font>
<font color=#447700>! --------------<a name='2492'></font>
<font color=#447700>! Original: J-JMorcrette, ECMWF, Feb 2003<a name='2493'></font>
<font color=#447700>! Revised for F90 reformatting: MJIacono, AER, Jul 2006<a name='2494'></font>
<font color=#447700>! Revised to add exponential lookup table: MJIacono, AER, Aug 2007<a name='2495'></font>
<font color=#447700>! Reformulated some code to avoid potential fpes: MJIacono, AER, Nov 2008<a name='2496'></font>
<font color=#447700>!<a name='2497'></font>
<font color=#447700>! ------------------------------------------------------------------<a name='2498'></font>
<a name='2499'>
<font color=#447700>! ------- Declarations ------<a name='2500'></font>
<a name='2501'>
<font color=#447700>! ------- Input -------<a name='2502'></font>
<a name='2503'>
      integer(kind=im), intent(in) :: nlayers<a name='2504'>
<a name='2505'>
      logical, intent(in) :: lrtchk(:)                         <font color=#447700>! Logical flag for reflectivity and<a name='2506'></font>
                                                               <font color=#447700>! and transmissivity calculation; <a name='2507'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='2508'></font>
<a name='2509'>
      real(kind=rb), intent(in) :: pgg(:)                      <font color=#447700>! asymmetry parameter<a name='2510'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='2511'></font>
      real(kind=rb), intent(in) :: ptau(:)                     <font color=#447700>! optical depth<a name='2512'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='2513'></font>
      real(kind=rb), intent(in) :: pw(:)                       <font color=#447700>! single scattering albedo <a name='2514'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='2515'></font>
      real(kind=rb), intent(in) :: prmuz                       <font color=#447700>! cosine of solar zenith angle<a name='2516'></font>
<a name='2517'>
<font color=#447700>! ------- Output -------<a name='2518'></font>
<a name='2519'>
      real(kind=rb), intent(inout) :: pref(:)                  <font color=#447700>! direct beam reflectivity<a name='2520'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers+1)<a name='2521'></font>
      real(kind=rb), intent(inout) :: prefd(:)                 <font color=#447700>! diffuse beam reflectivity<a name='2522'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers+1)<a name='2523'></font>
      real(kind=rb), intent(inout) :: ptra(:)                  <font color=#447700>! direct beam transmissivity<a name='2524'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers+1)<a name='2525'></font>
      real(kind=rb), intent(inout) :: ptrad(:)                 <font color=#447700>! diffuse beam transmissivity<a name='2526'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers+1)<a name='2527'></font>
<a name='2528'>
<font color=#447700>! ------- Local -------<a name='2529'></font>
<a name='2530'>
      integer(kind=im) :: jk, jl, kmodts<a name='2531'>
      integer(kind=im) :: itind<a name='2532'>
<a name='2533'>
      real(kind=rb) :: tblind<a name='2534'>
      real(kind=rb) :: za, za1, za2<a name='2535'>
      real(kind=rb) :: zbeta, zdend, zdenr, zdent<a name='2536'>
      real(kind=rb) :: ze1, ze2, zem1, zem2, zemm, zep1, zep2<a name='2537'>
      real(kind=rb) :: zg, zg3, zgamma1, zgamma2, zgamma3, zgamma4, zgt<a name='2538'>
      real(kind=rb) :: zr1, zr2, zr3, zr4, zr5<a name='2539'>
      real(kind=rb) :: zrk, zrk2, zrkg, zrm1, zrp, zrp1, zrpp<a name='2540'>
      real(kind=rb) :: zsr3, zt1, zt2, zt3, zt4, zt5, zto1<a name='2541'>
      real(kind=rb) :: zw, zwcrit, zwo<a name='2542'>
      real(kind=rb) :: denom<a name='2543'>
<a name='2544'>
      real(kind=rb), parameter :: eps = 1.e-08_rb<a name='2545'>
<a name='2546'>
<font color=#447700>!     ------------------------------------------------------------------<a name='2547'></font>
<a name='2548'>
<font color=#447700>! Initialize<a name='2549'></font>
<a name='2550'>
<font color=#447700>!jm not thread safe      hvrrft = '$Revision: 1.3 $'<a name='2551'></font>
<a name='2552'>
      zsr3=sqrt(3._rb)<a name='2553'>
      zwcrit=0.9999995_rb<a name='2554'>
      kmodts=2<a name='2555'>
<a name='2556'>
      do jk=1, nlayers<a name='2557'>
         if (.not.lrtchk(jk)) then<a name='2558'>
            pref(jk) =0._rb<a name='2559'>
            ptra(jk) =1._rb<a name='2560'>
            prefd(jk)=0._rb<a name='2561'>
            ptrad(jk)=1._rb<a name='2562'>
         else<a name='2563'>
            zto1=ptau(jk)<a name='2564'>
            zw  =pw(jk)<a name='2565'>
            zg  =pgg(jk)  <a name='2566'>
<a name='2567'>
<font color=#447700>! General two-stream expressions<a name='2568'></font>
<a name='2569'>
            zg3= 3._rb * zg<a name='2570'>
            if (kmodts == 1) then<a name='2571'>
               zgamma1= (7._rb - zw * (4._rb + zg3)) * 0.25_rb<a name='2572'>
               zgamma2=-(1._rb - zw * (4._rb - zg3)) * 0.25_rb<a name='2573'>
               zgamma3= (2._rb - zg3 * prmuz ) * 0.25_rb<a name='2574'>
            else if (kmodts == 2) then  <a name='2575'>
               zgamma1= (8._rb - zw * (5._rb + zg3)) * 0.25_rb<a name='2576'>
               zgamma2=  3._rb *(zw * (1._rb - zg )) * 0.25_rb<a name='2577'>
               zgamma3= (2._rb - zg3 * prmuz ) * 0.25_rb<a name='2578'>
            else if (kmodts == 3) then  <a name='2579'>
               zgamma1= zsr3 * (2._rb - zw * (1._rb + zg)) * 0.5_rb<a name='2580'>
               zgamma2= zsr3 * zw * (1._rb - zg ) * 0.5_rb<a name='2581'>
               zgamma3= (1._rb - zsr3 * zg * prmuz ) * 0.5_rb<a name='2582'>
            end if<a name='2583'>
            zgamma4= 1._rb - zgamma3<a name='2584'>
    <a name='2585'>
<font color=#447700>! Recompute original s.s.a. to test for conservative solution<a name='2586'></font>
            <font color=#447700>!Balwinder.Singh@pnnl.gov: Code added to avoid 'divide by zero' error in zwo computation<a name='2587'></font>
            denom = max((1._rb - (1._rb - zw) * (zg / (1._rb - zg))**2),1.0E-30_rb)<a name='2588'>
            zwo= zw / denom<a name='2589'>
<a name='2590'>
            if (zwo &gt;= zwcrit) then<a name='2591'>
<font color=#447700>! Conservative scattering<a name='2592'></font>
<a name='2593'>
               za  = zgamma1 * prmuz <a name='2594'>
               za1 = za - zgamma3<a name='2595'>
               zgt = zgamma1 * zto1<a name='2596'>
        <a name='2597'>
<font color=#447700>! Homogeneous reflectance and transmittance,<a name='2598'></font>
<font color=#447700>! collimated beam<a name='2599'></font>
<a name='2600'>
               ze1 = min ( zto1 / prmuz , 500._rb)<a name='2601'>
<font color=#447700>!               ze2 = exp( -ze1 )<a name='2602'></font>
<a name='2603'>
<font color=#447700>! Use exponential lookup table for transmittance, or expansion of <a name='2604'></font>
<font color=#447700>! exponential for low tau<a name='2605'></font>
               if (ze1 .le. od_lo) then <a name='2606'>
                  ze2 = 1._rb - ze1 + 0.5_rb * ze1 * ze1<a name='2607'>
               else<a name='2608'>
                  tblind = ze1 / (bpade + ze1)<a name='2609'>
                  itind = tblint * tblind + 0.5_rb<a name='2610'>
                  ze2 = exp_tbl(itind)<a name='2611'>
               endif<a name='2612'>
<font color=#447700>!<a name='2613'></font>
<a name='2614'>
               pref(jk) = (zgt - za1 * (1._rb - ze2)) / (1._rb + zgt)<a name='2615'>
               ptra(jk) = 1._rb - pref(jk)<a name='2616'>
<a name='2617'>
<font color=#447700>! isotropic incidence<a name='2618'></font>
<a name='2619'>
               prefd(jk) = zgt / (1._rb + zgt)<a name='2620'>
               ptrad(jk) = 1._rb - prefd(jk)        <a name='2621'>
<a name='2622'>
<font color=#447700>! This is applied for consistency between total (delta-scaled) and direct (unscaled) <a name='2623'></font>
<font color=#447700>! calculations at very low optical depths (tau &lt; 1.e-4) when the exponential lookup<a name='2624'></font>
<font color=#447700>! table returns a transmittance of 1.0.<a name='2625'></font>
               if (ze2 .eq. 1.0_rb) then <a name='2626'>
                  pref(jk) = 0.0_rb<a name='2627'>
                  ptra(jk) = 1.0_rb<a name='2628'>
                  prefd(jk) = 0.0_rb<a name='2629'>
                  ptrad(jk) = 1.0_rb<a name='2630'>
               endif<a name='2631'>
<a name='2632'>
            else<a name='2633'>
<font color=#447700>! Non-conservative scattering<a name='2634'></font>
<a name='2635'>
               za1 = zgamma1 * zgamma4 + zgamma2 * zgamma3<a name='2636'>
               za2 = zgamma1 * zgamma3 + zgamma2 * zgamma4<a name='2637'>
               zrk = sqrt ( zgamma1**2 - zgamma2**2)<a name='2638'>
               zrp = zrk * prmuz               <a name='2639'>
               zrp1 = 1._rb + zrp<a name='2640'>
               zrm1 = 1._rb - zrp<a name='2641'>
               zrk2 = 2._rb * zrk<a name='2642'>
               zrpp = 1._rb - zrp*zrp<a name='2643'>
               zrkg = zrk + zgamma1<a name='2644'>
               zr1  = zrm1 * (za2 + zrk * zgamma3)<a name='2645'>
               zr2  = zrp1 * (za2 - zrk * zgamma3)<a name='2646'>
               zr3  = zrk2 * (zgamma3 - za2 * prmuz )<a name='2647'>
               zr4  = zrpp * zrkg<a name='2648'>
               zr5  = zrpp * (zrk - zgamma1)<a name='2649'>
               zt1  = zrp1 * (za1 + zrk * zgamma4)<a name='2650'>
               zt2  = zrm1 * (za1 - zrk * zgamma4)<a name='2651'>
               zt3  = zrk2 * (zgamma4 + za1 * prmuz )<a name='2652'>
               zt4  = zr4<a name='2653'>
               zt5  = zr5<a name='2654'>
<a name='2655'>
<font color=#447700>! mji - reformulated code to avoid potential floating point exceptions<a name='2656'></font>
<font color=#447700>!               zbeta = - zr5 / zr4<a name='2657'></font>
               zbeta = (zgamma1 - zrk) / zrkg<a name='2658'>
<font color=#447700>!!<a name='2659'></font>
        <a name='2660'>
<font color=#447700>! Homogeneous reflectance and transmittance<a name='2661'></font>
<a name='2662'>
               ze1 = min ( zrk * zto1, 500._rb)<a name='2663'>
               ze2 = min ( zto1 / prmuz , 500._rb)<a name='2664'>
<font color=#447700>!<a name='2665'></font>
<font color=#447700>! Original<a name='2666'></font>
<font color=#447700>!              zep1 = exp( ze1 )<a name='2667'></font>
<font color=#447700>!              zem1 = exp(-ze1 )<a name='2668'></font>
<font color=#447700>!              zep2 = exp( ze2 )<a name='2669'></font>
<font color=#447700>!              zem2 = exp(-ze2 )<a name='2670'></font>
<font color=#447700>!<a name='2671'></font>
<font color=#447700>! Revised original, to reduce exponentials<a name='2672'></font>
<font color=#447700>!              zep1 = exp( ze1 )<a name='2673'></font>
<font color=#447700>!              zem1 = 1._rb / zep1<a name='2674'></font>
<font color=#447700>!              zep2 = exp( ze2 )<a name='2675'></font>
<font color=#447700>!              zem2 = 1._rb / zep2<a name='2676'></font>
<font color=#447700>!<a name='2677'></font>
<font color=#447700>! Use exponential lookup table for transmittance, or expansion of <a name='2678'></font>
<font color=#447700>! exponential for low tau<a name='2679'></font>
               if (ze1 .le. od_lo) then <a name='2680'>
                  zem1 = 1._rb - ze1 + 0.5_rb * ze1 * ze1<a name='2681'>
                  zep1 = 1._rb / zem1<a name='2682'>
               else<a name='2683'>
                  tblind = ze1 / (bpade + ze1)<a name='2684'>
                  itind = tblint * tblind + 0.5_rb<a name='2685'>
                  zem1 = exp_tbl(itind)<a name='2686'>
                  zep1 = 1._rb / zem1<a name='2687'>
               endif<a name='2688'>
<a name='2689'>
               if (ze2 .le. od_lo) then <a name='2690'>
                  zem2 = 1._rb - ze2 + 0.5_rb * ze2 * ze2<a name='2691'>
                  zep2 = 1._rb / zem2<a name='2692'>
               else<a name='2693'>
                  tblind = ze2 / (bpade + ze2)<a name='2694'>
                  itind = tblint * tblind + 0.5_rb<a name='2695'>
                  zem2 = exp_tbl(itind)<a name='2696'>
                  zep2 = 1._rb / zem2<a name='2697'>
               endif<a name='2698'>
<a name='2699'>
<font color=#447700>! collimated beam<a name='2700'></font>
<a name='2701'>
<font color=#447700>! mji - reformulated code to avoid potential floating point exceptions<a name='2702'></font>
<font color=#447700>!               zdenr = zr4*zep1 + zr5*zem1<a name='2703'></font>
<font color=#447700>!               pref(jk) = zw * (zr1*zep1 - zr2*zem1 - zr3*zem2) / zdenr<a name='2704'></font>
<font color=#447700>!               zdent = zt4*zep1 + zt5*zem1<a name='2705'></font>
<font color=#447700>!               ptra(jk) = zem2 - zem2 * zw * (zt1*zep1 - zt2*zem1 - zt3*zep2) / zdent<a name='2706'></font>
<a name='2707'>
               zdenr = zr4*zep1 + zr5*zem1<a name='2708'>
               zdent = zt4*zep1 + zt5*zem1<a name='2709'>
               if (zdenr .ge. -eps .and. zdenr .le. eps) then<a name='2710'>
                  pref(jk) = eps<a name='2711'>
                  ptra(jk) = zem2<a name='2712'>
               else<a name='2713'>
                  pref(jk) = zw * (zr1*zep1 - zr2*zem1 - zr3*zem2) / zdenr<a name='2714'>
                  ptra(jk) = zem2 - zem2 * zw * (zt1*zep1 - zt2*zem1 - zt3*zep2) / zdent<a name='2715'>
               endif<a name='2716'>
<font color=#447700>!!<a name='2717'></font>
<a name='2718'>
<font color=#447700>! diffuse beam<a name='2719'></font>
<a name='2720'>
               zemm = zem1*zem1<a name='2721'>
               zdend = 1._rb / ( (1._rb - zbeta*zemm ) * zrkg)<a name='2722'>
               prefd(jk) =  zgamma2 * (1._rb - zemm) * zdend<a name='2723'>
               ptrad(jk) =  zrk2*zem1*zdend<a name='2724'>
<a name='2725'>
            endif<a name='2726'>
<a name='2727'>
         endif         <a name='2728'>
<a name='2729'>
      enddo    <a name='2730'>
<a name='2731'>
      end subroutine reftra_sw<a name='2732'>
<a name='2733'>
      end module rrtmg_sw_reftra<a name='2734'>
<a name='2735'>
<font color=#447700>!     path:      $Source: /cvsroot/NWP/WRFV3/phys/module_ra_rrtmg_sw.F,v $<a name='2736'></font>
<font color=#447700>!     author:    $Author: trn $<a name='2737'></font>
<font color=#447700>!     revision:  $Revision: 1.3 $<a name='2738'></font>
<font color=#447700>!     created:   $Date: 2009/04/16 19:54:22 $<a name='2739'></font>
<a name='2740'>
<A NAME='RRTMG_SW_SETCOEF'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SETCOEF' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='2741'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_setcoef</font> <A href='../../call_to/RRTMG_SW_SETCOEF.html' TARGET='index'>2</A>,<A href='../../call_from/RRTMG_SW_SETCOEF.html' TARGET='index'>4</A><a name='2742'>
<a name='2743'>
<font color=#447700>!  --------------------------------------------------------------------------<a name='2744'></font>
<font color=#447700>! |                                                                          |<a name='2745'></font>
<font color=#447700>! |  Copyright 2002-2008, Atmospheric &amp; Environmental Research, Inc. (AER).  |<a name='2746'></font>
<font color=#447700>! |  This software may be used, copied, or redistributed as long as it is    |<a name='2747'></font>
<font color=#447700>! |  not sold and this copyright notice is reproduced on each copy made.     |<a name='2748'></font>
<font color=#447700>! |  This model is provided as is without any express or implied warranties. |<a name='2749'></font>
<font color=#447700>! |                       (http://www.rtweb.aer.com/)                        |<a name='2750'></font>
<font color=#447700>! |                                                                          |<a name='2751'></font>
<font color=#447700>!  --------------------------------------------------------------------------<a name='2752'></font>
<a name='2753'>
<font color=#447700>! ------- Modules -------<a name='2754'></font>
<a name='2755'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SETCOEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_56">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='2756'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SETCOEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_19">, only : mxmol<a name='2757'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_REF'>rrsw_ref</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SETCOEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_REF_1">, only : pref, preflog, tref<a name='2758'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_VSN'>rrsw_vsn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SETCOEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_4">, only : hvrset, hnamset<a name='2759'>
<a name='2760'>
      implicit none<a name='2761'>
<a name='2762'>
      contains<a name='2763'>
<a name='2764'>
<font color=#447700>!----------------------------------------------------------------------------<a name='2765'></font>
<A NAME='SETCOEF_SW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SETCOEF_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2766'>
      <font color=#993300>subroutine </font><font color=#cc0000>setcoef_sw</font>(nlayers, pavel, tavel, pz, tz, tbound, coldry, wkl, &amp; <A href='../../call_to/SETCOEF_SW.html' TARGET='index'>2</A><a name='2767'>
                            laytrop, layswtch, laylow, jp, jt, jt1, &amp;<a name='2768'>
                            co2mult, colch4, colco2, colh2o, colmol, coln2o, &amp;<a name='2769'>
                            colo2, colo3, fac00, fac01, fac10, fac11, &amp;<a name='2770'>
                            selffac, selffrac, indself, forfac, forfrac, indfor)<a name='2771'>
<font color=#447700>!----------------------------------------------------------------------------<a name='2772'></font>
<font color=#447700>!<a name='2773'></font>
<font color=#447700>! Purpose:  For a given atmosphere, calculate the indices and<a name='2774'></font>
<font color=#447700>! fractions related to the pressure and temperature interpolations.<a name='2775'></font>
<a name='2776'>
<font color=#447700>! Modifications:<a name='2777'></font>
<font color=#447700>! Original: J. Delamere, AER, Inc. (version 2.5, 02/04/01)<a name='2778'></font>
<font color=#447700>! Revised: Rewritten and adapted to ECMWF F90, JJMorcrette 030224<a name='2779'></font>
<font color=#447700>! Revised: For uniform rrtmg formatting, MJIacono, Jul 2006<a name='2780'></font>
<a name='2781'>
<font color=#447700>! ------ Declarations -------<a name='2782'></font>
<a name='2783'>
<font color=#447700>! ----- Input -----<a name='2784'></font>
      integer(kind=im), intent(in) :: nlayers         <font color=#447700>! total number of layers<a name='2785'></font>
<a name='2786'>
      real(kind=rb), intent(in) :: pavel(:)           <font color=#447700>! layer pressures (mb) <a name='2787'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2788'></font>
      real(kind=rb), intent(in) :: tavel(:)           <font color=#447700>! layer temperatures (K)<a name='2789'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2790'></font>
      real(kind=rb), intent(in) :: pz(0:)             <font color=#447700>! level (interface) pressures (hPa, mb)<a name='2791'></font>
                                                      <font color=#447700>!    Dimensions: (0:nlayers)<a name='2792'></font>
      real(kind=rb), intent(in) :: tz(0:)             <font color=#447700>! level (interface) temperatures (K)<a name='2793'></font>
                                                      <font color=#447700>!    Dimensions: (0:nlayers)<a name='2794'></font>
      real(kind=rb), intent(in) :: tbound             <font color=#447700>! surface temperature (K)<a name='2795'></font>
      real(kind=rb), intent(in) :: coldry(:)          <font color=#447700>! dry air column density (mol/cm2)<a name='2796'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2797'></font>
      real(kind=rb), intent(in) :: wkl(:,:)           <font color=#447700>! molecular amounts (mol/cm-2)<a name='2798'></font>
                                                      <font color=#447700>!    Dimensions: (mxmol,nlayers)<a name='2799'></font>
<a name='2800'>
<font color=#447700>! ----- Output -----<a name='2801'></font>
      integer(kind=im), intent(out) :: laytrop        <font color=#447700>! tropopause layer index<a name='2802'></font>
      integer(kind=im), intent(out) :: layswtch       <font color=#447700>! <a name='2803'></font>
      integer(kind=im), intent(out) :: laylow         <font color=#447700>! <a name='2804'></font>
<a name='2805'>
      integer(kind=im), intent(out) :: jp(:)          <font color=#447700>! <a name='2806'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2807'></font>
      integer(kind=im), intent(out) :: jt(:)          <font color=#447700>!<a name='2808'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2809'></font>
      integer(kind=im), intent(out) :: jt1(:)         <font color=#447700>!<a name='2810'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2811'></font>
<a name='2812'>
      real(kind=rb), intent(out) :: colh2o(:)         <font color=#447700>! column amount (h2o)<a name='2813'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2814'></font>
      real(kind=rb), intent(out) :: colco2(:)         <font color=#447700>! column amount (co2)<a name='2815'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2816'></font>
      real(kind=rb), intent(out) :: colo3(:)          <font color=#447700>! column amount (o3)<a name='2817'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2818'></font>
      real(kind=rb), intent(out) :: coln2o(:)         <font color=#447700>! column amount (n2o)<a name='2819'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2820'></font>
      real(kind=rb), intent(out) :: colch4(:)         <font color=#447700>! column amount (ch4)<a name='2821'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2822'></font>
      real(kind=rb), intent(out) :: colo2(:)          <font color=#447700>! column amount (o2)<a name='2823'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2824'></font>
      real(kind=rb), intent(out) :: colmol(:)         <font color=#447700>! <a name='2825'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2826'></font>
      real(kind=rb), intent(out) :: co2mult(:)        <font color=#447700>!<a name='2827'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2828'></font>
<a name='2829'>
      integer(kind=im), intent(out) :: indself(:)<a name='2830'>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2831'></font>
      integer(kind=im), intent(out) :: indfor(:)<a name='2832'>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2833'></font>
      real(kind=rb), intent(out) :: selffac(:)<a name='2834'>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2835'></font>
      real(kind=rb), intent(out) :: selffrac(:)<a name='2836'>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2837'></font>
      real(kind=rb), intent(out) :: forfac(:)<a name='2838'>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2839'></font>
      real(kind=rb), intent(out) :: forfrac(:)<a name='2840'>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2841'></font>
<a name='2842'>
      real(kind=rb), intent(out) :: &amp;                 <font color=#447700>!<a name='2843'></font>
                         fac00(:), fac01(:), &amp;        <font color=#447700>!    Dimensions: (nlayers)<a name='2844'></font>
                         fac10(:), fac11(:) <a name='2845'>
<a name='2846'>
<font color=#447700>! ----- Local -----<a name='2847'></font>
<a name='2848'>
      integer(kind=im) :: indbound<a name='2849'>
      integer(kind=im) :: indlev0<a name='2850'>
      integer(kind=im) :: lay<a name='2851'>
      integer(kind=im) :: jp1<a name='2852'>
<a name='2853'>
      real(kind=rb) :: stpfac<a name='2854'>
      real(kind=rb) :: tbndfrac<a name='2855'>
      real(kind=rb) :: t0frac<a name='2856'>
      real(kind=rb) :: plog<a name='2857'>
      real(kind=rb) :: fp<a name='2858'>
      real(kind=rb) :: ft<a name='2859'>
      real(kind=rb) :: ft1<a name='2860'>
      real(kind=rb) :: water<a name='2861'>
      real(kind=rb) :: scalefac<a name='2862'>
      real(kind=rb) :: factor<a name='2863'>
      real(kind=rb) :: co2reg<a name='2864'>
      real(kind=rb) :: compfp<a name='2865'>
<a name='2866'>
<a name='2867'>
<font color=#447700>! Initializations<a name='2868'></font>
      stpfac = 296._rb/1013._rb<a name='2869'>
<a name='2870'>
      indbound = tbound - 159._rb<a name='2871'>
      tbndfrac = tbound - int(tbound)<a name='2872'>
      indlev0  = tz(0) - 159._rb<a name='2873'>
      t0frac   = tz(0) - int(tz(0))<a name='2874'>
<a name='2875'>
      laytrop  = 0<a name='2876'>
      layswtch = 0<a name='2877'>
      laylow   = 0<a name='2878'>
<a name='2879'>
<font color=#447700>! Begin layer loop<a name='2880'></font>
      do lay = 1, nlayers<a name='2881'>
<font color=#447700>! Find the two reference pressures on either side of the<a name='2882'></font>
<font color=#447700>! layer pressure.  Store them in JP and JP1.  Store in FP the<a name='2883'></font>
<font color=#447700>! fraction of the difference (in ln(pressure)) between these<a name='2884'></font>
<font color=#447700>! two values that the layer pressure lies.<a name='2885'></font>
<a name='2886'>
         plog = log(pavel(lay))<a name='2887'>
         jp(lay) = int(36._rb - 5*(plog+0.04_rb))<a name='2888'>
         if (jp(lay) .lt. 1) then<a name='2889'>
            jp(lay) = 1<a name='2890'>
         elseif (jp(lay) .gt. 58) then<a name='2891'>
            jp(lay) = 58<a name='2892'>
         endif<a name='2893'>
         jp1 = jp(lay) + 1<a name='2894'>
         fp = 5._rb * (preflog(jp(lay)) - plog)<a name='2895'>
<a name='2896'>
<font color=#447700>! Determine, for each reference pressure (JP and JP1), which<a name='2897'></font>
<font color=#447700>! reference temperature (these are different for each  <a name='2898'></font>
<font color=#447700>! reference pressure) is nearest the layer temperature but does<a name='2899'></font>
<font color=#447700>! not exceed it.  Store these indices in JT and JT1, resp.<a name='2900'></font>
<font color=#447700>! Store in FT (resp. FT1) the fraction of the way between JT<a name='2901'></font>
<font color=#447700>! (JT1) and the next highest reference temperature that the <a name='2902'></font>
<font color=#447700>! layer temperature falls.<a name='2903'></font>
<a name='2904'>
         jt(lay) = int(3._rb + (tavel(lay)-tref(jp(lay)))/15._rb)<a name='2905'>
         if (jt(lay) .lt. 1) then<a name='2906'>
            jt(lay) = 1<a name='2907'>
         elseif (jt(lay) .gt. 4) then<a name='2908'>
            jt(lay) = 4<a name='2909'>
         endif<a name='2910'>
         ft = ((tavel(lay)-tref(jp(lay)))/15._rb) - float(jt(lay)-3)<a name='2911'>
         jt1(lay) = int(3._rb + (tavel(lay)-tref(jp1))/15._rb)<a name='2912'>
         if (jt1(lay) .lt. 1) then<a name='2913'>
            jt1(lay) = 1<a name='2914'>
         elseif (jt1(lay) .gt. 4) then<a name='2915'>
            jt1(lay) = 4<a name='2916'>
         endif<a name='2917'>
         ft1 = ((tavel(lay)-tref(jp1))/15._rb) - float(jt1(lay)-3)<a name='2918'>
<a name='2919'>
         water = wkl(1,lay)/coldry(lay)<a name='2920'>
         scalefac = pavel(lay) * stpfac / tavel(lay)<a name='2921'>
<a name='2922'>
<font color=#447700>! If the pressure is less than ~100mb, perform a different<a name='2923'></font>
<font color=#447700>! set of species interpolations.<a name='2924'></font>
<a name='2925'>
         if (plog .le. 4.56_rb) go to 5300<a name='2926'>
         laytrop =  laytrop + 1<a name='2927'>
         if (plog .ge. 6.62_rb) laylow = laylow + 1<a name='2928'>
<a name='2929'>
<font color=#447700>! Set up factors needed to separately include the water vapor<a name='2930'></font>
<font color=#447700>! foreign-continuum in the calculation of absorption coefficient.<a name='2931'></font>
<a name='2932'>
         forfac(lay) = scalefac / (1.+water)<a name='2933'>
         factor = (332.0_rb-tavel(lay))/36.0_rb<a name='2934'>
         indfor(lay) = min(2, max(1, int(factor)))<a name='2935'>
         forfrac(lay) = factor - float(indfor(lay))<a name='2936'>
<a name='2937'>
<font color=#447700>! Set up factors needed to separately include the water vapor<a name='2938'></font>
<font color=#447700>! self-continuum in the calculation of absorption coefficient.<a name='2939'></font>
<a name='2940'>
         selffac(lay) = water * forfac(lay)<a name='2941'>
         factor = (tavel(lay)-188.0_rb)/7.2_rb<a name='2942'>
         indself(lay) = min(9, max(1, int(factor)-7))<a name='2943'>
         selffrac(lay) = factor - float(indself(lay) + 7)<a name='2944'>
<a name='2945'>
<font color=#447700>! Calculate needed column amounts.<a name='2946'></font>
<a name='2947'>
         colh2o(lay) = 1.e-20_rb * wkl(1,lay)<a name='2948'>
         colco2(lay) = 1.e-20_rb * wkl(2,lay)<a name='2949'>
         colo3(lay) = 1.e-20_rb * wkl(3,lay)<a name='2950'>
<font color=#447700>!           colo3(lay) = 0._rb<a name='2951'></font>
<font color=#447700>!           colo3(lay) = colo3(lay)/1.16_rb<a name='2952'></font>
         coln2o(lay) = 1.e-20_rb * wkl(4,lay)<a name='2953'>
         colch4(lay) = 1.e-20_rb * wkl(6,lay)<a name='2954'>
         colo2(lay) = 1.e-20_rb * wkl(7,lay)<a name='2955'>
         colmol(lay) = 1.e-20_rb * coldry(lay) + colh2o(lay)<a name='2956'>
<font color=#447700>!           colco2(lay) = 0._rb<a name='2957'></font>
<font color=#447700>!           colo3(lay) = 0._rb<a name='2958'></font>
<font color=#447700>!           coln2o(lay) = 0._rb<a name='2959'></font>
<font color=#447700>!           colch4(lay) = 0._rb<a name='2960'></font>
<font color=#447700>!           colo2(lay) = 0._rb<a name='2961'></font>
<font color=#447700>!           colmol(lay) = 0._rb<a name='2962'></font>
         if (colco2(lay) .eq. 0._rb) colco2(lay) = 1.e-32_rb * coldry(lay)<a name='2963'>
         if (coln2o(lay) .eq. 0._rb) coln2o(lay) = 1.e-32_rb * coldry(lay)<a name='2964'>
         if (colch4(lay) .eq. 0._rb) colch4(lay) = 1.e-32_rb * coldry(lay)<a name='2965'>
         if (colo2(lay) .eq. 0._rb) colo2(lay) = 1.e-32_rb * coldry(lay)<a name='2966'>
<font color=#447700>! Using E = 1334.2 cm-1.<a name='2967'></font>
         co2reg = 3.55e-24_rb * coldry(lay)<a name='2968'>
         co2mult(lay)= (colco2(lay) - co2reg) * &amp;<a name='2969'>
               272.63_rb*exp(-1919.4_rb/tavel(lay))/(8.7604e-4_rb*tavel(lay))<a name='2970'>
         goto 5400<a name='2971'>
<a name='2972'>
<font color=#447700>! Above laytrop.<a name='2973'></font>
 5300    continue<a name='2974'>
<a name='2975'>
<font color=#447700>! Set up factors needed to separately include the water vapor<a name='2976'></font>
<font color=#447700>! foreign-continuum in the calculation of absorption coefficient.<a name='2977'></font>
<a name='2978'>
         forfac(lay) = scalefac / (1.+water)<a name='2979'>
         factor = (tavel(lay)-188.0_rb)/36.0_rb<a name='2980'>
         indfor(lay) = 3<a name='2981'>
         forfrac(lay) = factor - 1.0_rb<a name='2982'>
<a name='2983'>
<font color=#447700>! Calculate needed column amounts.<a name='2984'></font>
<a name='2985'>
         colh2o(lay) = 1.e-20_rb * wkl(1,lay)<a name='2986'>
         colco2(lay) = 1.e-20_rb * wkl(2,lay)<a name='2987'>
         colo3(lay)  = 1.e-20_rb * wkl(3,lay)<a name='2988'>
         coln2o(lay) = 1.e-20_rb * wkl(4,lay)<a name='2989'>
         colch4(lay) = 1.e-20_rb * wkl(6,lay)<a name='2990'>
         colo2(lay)  = 1.e-20_rb * wkl(7,lay)<a name='2991'>
         colmol(lay) = 1.e-20_rb * coldry(lay) + colh2o(lay)<a name='2992'>
         if (colco2(lay) .eq. 0._rb) colco2(lay) = 1.e-32_rb * coldry(lay)<a name='2993'>
         if (coln2o(lay) .eq. 0._rb) coln2o(lay) = 1.e-32_rb * coldry(lay)<a name='2994'>
         if (colch4(lay) .eq. 0._rb) colch4(lay) = 1.e-32_rb * coldry(lay)<a name='2995'>
         if (colo2(lay)  .eq. 0._rb) colo2(lay)  = 1.e-32_rb * coldry(lay)<a name='2996'>
         co2reg = 3.55e-24_rb * coldry(lay)<a name='2997'>
         co2mult(lay)= (colco2(lay) - co2reg) * &amp;<a name='2998'>
               272.63_rb*exp(-1919.4_rb/tavel(lay))/(8.7604e-4_rb*tavel(lay))<a name='2999'>
<a name='3000'>
         selffac(lay) = 0._rb<a name='3001'>
         selffrac(lay)= 0._rb<a name='3002'>
         indself(lay) = 0<a name='3003'>
<a name='3004'>
 5400    continue<a name='3005'>
<a name='3006'>
<font color=#447700>! We have now isolated the layer ln pressure and temperature,<a name='3007'></font>
<font color=#447700>! between two reference pressures and two reference temperatures <a name='3008'></font>
<font color=#447700>! (for each reference pressure).  We multiply the pressure <a name='3009'></font>
<font color=#447700>! fraction FP with the appropriate temperature fractions to get <a name='3010'></font>
<font color=#447700>! the factors that will be needed for the interpolation that yields<a name='3011'></font>
<font color=#447700>! the optical depths (performed in routines TAUGBn for band n).<a name='3012'></font>
<a name='3013'>
         compfp = 1._rb - fp<a name='3014'>
         fac10(lay) = compfp * ft<a name='3015'>
         fac00(lay) = compfp * (1._rb - ft)<a name='3016'>
         fac11(lay) = fp * ft1<a name='3017'>
         fac01(lay) = fp * (1._rb - ft1)<a name='3018'>
<a name='3019'>
<font color=#447700>! End layer loop<a name='3020'></font>
      enddo<a name='3021'>
<a name='3022'>
      end subroutine setcoef_sw<a name='3023'>
<a name='3024'>
<font color=#447700>!***************************************************************************<a name='3025'></font>
<A NAME='SWATMREF'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SWATMREF' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3026'>
      <font color=#993300>subroutine </font><font color=#cc0000>swatmref</font> <A href='../../call_to/SWATMREF.html' TARGET='index'>2</A><a name='3027'>
<font color=#447700>!***************************************************************************<a name='3028'></font>
<a name='3029'>
      save<a name='3030'>
 <a name='3031'>
<font color=#447700>! These pressures are chosen such that the ln of the first pressure<a name='3032'></font>
<font color=#447700>! has only a few non-zero digits (i.e. ln(PREF(1)) = 6.96000) and<a name='3033'></font>
<font color=#447700>! each subsequent ln(pressure) differs from the previous one by 0.2.<a name='3034'></font>
<a name='3035'>
      pref(:) = (/ &amp;<a name='3036'>
          1.05363e+03_rb,8.62642e+02_rb,7.06272e+02_rb,5.78246e+02_rb,4.73428e+02_rb, &amp;<a name='3037'>
          3.87610e+02_rb,3.17348e+02_rb,2.59823e+02_rb,2.12725e+02_rb,1.74164e+02_rb, &amp;<a name='3038'>
          1.42594e+02_rb,1.16746e+02_rb,9.55835e+01_rb,7.82571e+01_rb,6.40715e+01_rb, &amp;<a name='3039'>
          5.24573e+01_rb,4.29484e+01_rb,3.51632e+01_rb,2.87892e+01_rb,2.35706e+01_rb, &amp;<a name='3040'>
          1.92980e+01_rb,1.57998e+01_rb,1.29358e+01_rb,1.05910e+01_rb,8.67114e+00_rb, &amp;<a name='3041'>
          7.09933e+00_rb,5.81244e+00_rb,4.75882e+00_rb,3.89619e+00_rb,3.18993e+00_rb, &amp;<a name='3042'>
          2.61170e+00_rb,2.13828e+00_rb,1.75067e+00_rb,1.43333e+00_rb,1.17351e+00_rb, &amp;<a name='3043'>
          9.60789e-01_rb,7.86628e-01_rb,6.44036e-01_rb,5.27292e-01_rb,4.31710e-01_rb, &amp;<a name='3044'>
          3.53455e-01_rb,2.89384e-01_rb,2.36928e-01_rb,1.93980e-01_rb,1.58817e-01_rb, &amp;<a name='3045'>
          1.30029e-01_rb,1.06458e-01_rb,8.71608e-02_rb,7.13612e-02_rb,5.84256e-02_rb, &amp;<a name='3046'>
          4.78349e-02_rb,3.91639e-02_rb,3.20647e-02_rb,2.62523e-02_rb,2.14936e-02_rb, &amp;<a name='3047'>
          1.75975e-02_rb,1.44076e-02_rb,1.17959e-02_rb,9.65769e-03_rb /)<a name='3048'>
<a name='3049'>
      preflog(:) = (/ &amp;<a name='3050'>
           6.9600e+00_rb, 6.7600e+00_rb, 6.5600e+00_rb, 6.3600e+00_rb, 6.1600e+00_rb, &amp;<a name='3051'>
           5.9600e+00_rb, 5.7600e+00_rb, 5.5600e+00_rb, 5.3600e+00_rb, 5.1600e+00_rb, &amp;<a name='3052'>
           4.9600e+00_rb, 4.7600e+00_rb, 4.5600e+00_rb, 4.3600e+00_rb, 4.1600e+00_rb, &amp;<a name='3053'>
           3.9600e+00_rb, 3.7600e+00_rb, 3.5600e+00_rb, 3.3600e+00_rb, 3.1600e+00_rb, &amp;<a name='3054'>
           2.9600e+00_rb, 2.7600e+00_rb, 2.5600e+00_rb, 2.3600e+00_rb, 2.1600e+00_rb, &amp;<a name='3055'>
           1.9600e+00_rb, 1.7600e+00_rb, 1.5600e+00_rb, 1.3600e+00_rb, 1.1600e+00_rb, &amp;<a name='3056'>
           9.6000e-01_rb, 7.6000e-01_rb, 5.6000e-01_rb, 3.6000e-01_rb, 1.6000e-01_rb, &amp;<a name='3057'>
          -4.0000e-02_rb,-2.4000e-01_rb,-4.4000e-01_rb,-6.4000e-01_rb,-8.4000e-01_rb, &amp;<a name='3058'>
          -1.0400e+00_rb,-1.2400e+00_rb,-1.4400e+00_rb,-1.6400e+00_rb,-1.8400e+00_rb, &amp;<a name='3059'>
          -2.0400e+00_rb,-2.2400e+00_rb,-2.4400e+00_rb,-2.6400e+00_rb,-2.8400e+00_rb, &amp;<a name='3060'>
          -3.0400e+00_rb,-3.2400e+00_rb,-3.4400e+00_rb,-3.6400e+00_rb,-3.8400e+00_rb, &amp;<a name='3061'>
          -4.0400e+00_rb,-4.2400e+00_rb,-4.4400e+00_rb,-4.6400e+00_rb /)<a name='3062'>
<a name='3063'>
<font color=#447700>! These are the temperatures associated with the respective <a name='3064'></font>
<font color=#447700>! pressures for the MLS standard atmosphere. <a name='3065'></font>
<a name='3066'>
      tref(:) = (/ &amp;<a name='3067'>
           2.9420e+02_rb, 2.8799e+02_rb, 2.7894e+02_rb, 2.6925e+02_rb, 2.5983e+02_rb, &amp;<a name='3068'>
           2.5017e+02_rb, 2.4077e+02_rb, 2.3179e+02_rb, 2.2306e+02_rb, 2.1578e+02_rb, &amp;<a name='3069'>
           2.1570e+02_rb, 2.1570e+02_rb, 2.1570e+02_rb, 2.1706e+02_rb, 2.1858e+02_rb, &amp;<a name='3070'>
           2.2018e+02_rb, 2.2174e+02_rb, 2.2328e+02_rb, 2.2479e+02_rb, 2.2655e+02_rb, &amp;<a name='3071'>
           2.2834e+02_rb, 2.3113e+02_rb, 2.3401e+02_rb, 2.3703e+02_rb, 2.4022e+02_rb, &amp;<a name='3072'>
           2.4371e+02_rb, 2.4726e+02_rb, 2.5085e+02_rb, 2.5457e+02_rb, 2.5832e+02_rb, &amp;<a name='3073'>
           2.6216e+02_rb, 2.6606e+02_rb, 2.6999e+02_rb, 2.7340e+02_rb, 2.7536e+02_rb, &amp;<a name='3074'>
           2.7568e+02_rb, 2.7372e+02_rb, 2.7163e+02_rb, 2.6955e+02_rb, 2.6593e+02_rb, &amp;<a name='3075'>
           2.6211e+02_rb, 2.5828e+02_rb, 2.5360e+02_rb, 2.4854e+02_rb, 2.4348e+02_rb, &amp; <a name='3076'>
           2.3809e+02_rb, 2.3206e+02_rb, 2.2603e+02_rb, 2.2000e+02_rb, 2.1435e+02_rb, &amp;<a name='3077'>
           2.0887e+02_rb, 2.0340e+02_rb, 1.9792e+02_rb, 1.9290e+02_rb, 1.8809e+02_rb, &amp;<a name='3078'>
           1.8329e+02_rb, 1.7849e+02_rb, 1.7394e+02_rb, 1.7212e+02_rb /)<a name='3079'>
<a name='3080'>
      end subroutine swatmref<a name='3081'>
<a name='3082'>
      end module rrtmg_sw_setcoef<a name='3083'>
<a name='3084'>
<font color=#447700>!     path:      $Source: /cvsroot/NWP/WRFV3/phys/module_ra_rrtmg_sw.F,v $<a name='3085'></font>
<font color=#447700>!     author:    $Author: trn $<a name='3086'></font>
<font color=#447700>!     revision:  $Revision: 1.3 $<a name='3087'></font>
<font color=#447700>!     created:   $Date: 2009/04/16 19:54:22 $<a name='3088'></font>
<a name='3089'>
<A NAME='RRTMG_SW_TAUMOL'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_TAUMOL' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='3090'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_taumol</font> <A href='../../call_to/RRTMG_SW_TAUMOL.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_TAUMOL.html' TARGET='index'>4</A><a name='3091'>
<a name='3092'>
<font color=#447700>!  --------------------------------------------------------------------------<a name='3093'></font>
<font color=#447700>! |                                                                          |<a name='3094'></font>
<font color=#447700>! |  Copyright 2002-2008, Atmospheric &amp; Environmental Research, Inc. (AER).  |<a name='3095'></font>
<font color=#447700>! |  This software may be used, copied, or redistributed as long as it is    |<a name='3096'></font>
<font color=#447700>! |  not sold and this copyright notice is reproduced on each copy made.     |<a name='3097'></font>
<font color=#447700>! |  This model is provided as is without any express or implied warranties. |<a name='3098'></font>
<font color=#447700>! |                       (http://www.rtweb.aer.com/)                        |<a name='3099'></font>
<font color=#447700>! |                                                                          |<a name='3100'></font>
<font color=#447700>!  --------------------------------------------------------------------------<a name='3101'></font>
<a name='3102'>
<font color=#447700>! ------- Modules -------<a name='3103'></font>
<a name='3104'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_TAUMOL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_57">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='3105'>
<font color=#447700>!      use parrrsw, only : mg, jpband, nbndsw, ngptsw<a name='3106'></font>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_CON'>rrsw_con</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_TAUMOL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CON_2">, only: oneminus<a name='3107'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_WVN'>rrsw_wvn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_TAUMOL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_3">, only: nspa, nspb<a name='3108'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_VSN'>rrsw_vsn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_TAUMOL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_5">, only: hvrtau, hnamtau<a name='3109'>
<a name='3110'>
      implicit none<a name='3111'>
<a name='3112'>
      contains<a name='3113'>
<a name='3114'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3115'></font>
<A NAME='TAUMOL_SW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3116'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol_sw</font>(nlayers, &amp; <A href='../../call_to/TAUMOL_SW.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL_SW.html' TARGET='index'>28</A><a name='3117'>
                           colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='3118'>
                           laytrop, jp, jt, jt1, &amp;<a name='3119'>
                           fac00, fac01, fac10, fac11, &amp;<a name='3120'>
                           selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='3121'>
                           sfluxzen, taug, taur)<a name='3122'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3123'></font>
<a name='3124'>
<font color=#447700>! ******************************************************************************<a name='3125'></font>
<font color=#447700>! *                                                                            *<a name='3126'></font>
<font color=#447700>! *                 Optical depths developed for the                           *<a name='3127'></font>
<font color=#447700>! *                                                                            *<a name='3128'></font>
<font color=#447700>! *               RAPID RADIATIVE TRANSFER MODEL (RRTM)                        *<a name='3129'></font>
<font color=#447700>! *                                                                            *<a name='3130'></font>
<font color=#447700>! *                                                                            *<a name='3131'></font>
<font color=#447700>! *           ATMOSPHERIC AND ENVIRONMENTAL RESEARCH, INC.                     *<a name='3132'></font>
<font color=#447700>! *                       131 HARTWELL AVENUE                                  *<a name='3133'></font>
<font color=#447700>! *                       LEXINGTON, MA 02421                                  *<a name='3134'></font>
<font color=#447700>! *                                                                            *<a name='3135'></font>
<font color=#447700>! *                                                                            *<a name='3136'></font>
<font color=#447700>! *                          ELI J. MLAWER                                     *<a name='3137'></font>
<font color=#447700>! *                        JENNIFER DELAMERE                                   *<a name='3138'></font>
<font color=#447700>! *                        STEVEN J. TAUBMAN                                   *<a name='3139'></font>
<font color=#447700>! *                        SHEPARD A. CLOUGH                                   *<a name='3140'></font>
<font color=#447700>! *                                                                            *<a name='3141'></font>
<font color=#447700>! *                                                                            *<a name='3142'></font>
<font color=#447700>! *                                                                            *<a name='3143'></font>
<font color=#447700>! *                                                                            *<a name='3144'></font>
<font color=#447700>! *                      email:  mlawer@aer.com                                *<a name='3145'></font>
<font color=#447700>! *                      email:  jdelamer@aer.com                              *<a name='3146'></font>
<font color=#447700>! *                                                                            *<a name='3147'></font>
<font color=#447700>! *       The authors wish to acknowledge the contributions of the             *<a name='3148'></font>
<font color=#447700>! *       following people:  Patrick D. Brown, Michael J. Iacono,              *<a name='3149'></font>
<font color=#447700>! *       Ronald E. Farren, Luke Chen, Robert Bergstrom.                       *<a name='3150'></font>
<font color=#447700>! *                                                                            *<a name='3151'></font>
<font color=#447700>! ******************************************************************************<a name='3152'></font>
<font color=#447700>! *    TAUMOL                                                                  *<a name='3153'></font>
<font color=#447700>! *                                                                            *<a name='3154'></font>
<font color=#447700>! *    This file contains the subroutines TAUGBn (where n goes from            *<a name='3155'></font>
<font color=#447700>! *    1 to 28).  TAUGBn calculates the optical depths and Planck fractions    *<a name='3156'></font>
<font color=#447700>! *    per g-value and layer for band n.                                       *<a name='3157'></font>
<font color=#447700>! *                                                                            *<a name='3158'></font>
<font color=#447700>! * Output:  optical depths (unitless)                                         *<a name='3159'></font>
<font color=#447700>! *          fractions needed to compute Planck functions at every layer       *<a name='3160'></font>
<font color=#447700>! *              and g-value                                                   *<a name='3161'></font>
<font color=#447700>! *                                                                            *<a name='3162'></font>
<font color=#447700>! *    COMMON /TAUGCOM/  TAUG(MXLAY,MG)                                        *<a name='3163'></font>
<font color=#447700>! *    COMMON /PLANKG/   FRACS(MXLAY,MG)                                       *<a name='3164'></font>
<font color=#447700>! *                                                                            *<a name='3165'></font>
<font color=#447700>! * Input                                                                      *<a name='3166'></font>
<font color=#447700>! *                                                                            *<a name='3167'></font>
<font color=#447700>! *    PARAMETER (MG=16, MXLAY=203, NBANDS=14)                                 *<a name='3168'></font>
<font color=#447700>! *                                                                            *<a name='3169'></font>
<font color=#447700>! *    COMMON /FEATURES/ NG(NBANDS),NSPA(NBANDS),NSPB(NBANDS)                  *<a name='3170'></font>
<font color=#447700>! *    COMMON /PRECISE/  ONEMINUS                                              *<a name='3171'></font>
<font color=#447700>! *    COMMON /PROFILE/  NLAYERS,PAVEL(MXLAY),TAVEL(MXLAY),                    *<a name='3172'></font>
<font color=#447700>! *   &amp;                  PZ(0:MXLAY),TZ(0:MXLAY),TBOUND                        *<a name='3173'></font>
<font color=#447700>! *    COMMON /PROFDATA/ LAYTROP,LAYSWTCH,LAYLOW,                              *<a name='3174'></font>
<font color=#447700>! *   &amp;                  COLH2O(MXLAY),COLCO2(MXLAY),                          *<a name='3175'></font>
<font color=#447700>! *   &amp;                  COLO3(MXLAY),COLN2O(MXLAY),COLCH4(MXLAY),             *<a name='3176'></font>
<font color=#447700>! *   &amp;                  COLO2(MXLAY),CO2MULT(MXLAY)                           *<a name='3177'></font>
<font color=#447700>! *    COMMON /INTFAC/   FAC00(MXLAY),FAC01(MXLAY),                            *<a name='3178'></font>
<font color=#447700>! *   &amp;                  FAC10(MXLAY),FAC11(MXLAY)                             *<a name='3179'></font>
<font color=#447700>! *    COMMON /INTIND/   JP(MXLAY),JT(MXLAY),JT1(MXLAY)                        *<a name='3180'></font>
<font color=#447700>! *    COMMON /SELF/     SELFFAC(MXLAY), SELFFRAC(MXLAY), INDSELF(MXLAY)       *<a name='3181'></font>
<font color=#447700>! *                                                                            *<a name='3182'></font>
<font color=#447700>! *    Description:                                                            *<a name='3183'></font>
<font color=#447700>! *    NG(IBAND) - number of g-values in band IBAND                            *<a name='3184'></font>
<font color=#447700>! *    NSPA(IBAND) - for the lower atmosphere, the number of reference         *<a name='3185'></font>
<font color=#447700>! *                  atmospheres that are stored for band IBAND per            *<a name='3186'></font>
<font color=#447700>! *                  pressure level and temperature.  Each of these            *<a name='3187'></font>
<font color=#447700>! *                  atmospheres has different relative amounts of the         *<a name='3188'></font>
<font color=#447700>! *                  key species for the band (i.e. different binary           *<a name='3189'></font>
<font color=#447700>! *                  species parameters).                                      *<a name='3190'></font>
<font color=#447700>! *    NSPB(IBAND) - same for upper atmosphere                                 *<a name='3191'></font>
<font color=#447700>! *    ONEMINUS - since problems are caused in some cases by interpolation     *<a name='3192'></font>
<font color=#447700>! *               parameters equal to or greater than 1, for these cases       *<a name='3193'></font>
<font color=#447700>! *               these parameters are set to this value, slightly &lt; 1.        *<a name='3194'></font>
<font color=#447700>! *    PAVEL - layer pressures (mb)                                            *<a name='3195'></font>
<font color=#447700>! *    TAVEL - layer temperatures (degrees K)                                  *<a name='3196'></font>
<font color=#447700>! *    PZ - level pressures (mb)                                               *<a name='3197'></font>
<font color=#447700>! *    TZ - level temperatures (degrees K)                                     *<a name='3198'></font>
<font color=#447700>! *    LAYTROP - layer at which switch is made from one combination of         *<a name='3199'></font>
<font color=#447700>! *              key species to another                                        *<a name='3200'></font>
<font color=#447700>! *    COLH2O, COLCO2, COLO3, COLN2O, COLCH4 - column amounts of water         *<a name='3201'></font>
<font color=#447700>! *              vapor,carbon dioxide, ozone, nitrous ozide, methane,          *<a name='3202'></font>
<font color=#447700>! *              respectively (molecules/cm**2)                                *<a name='3203'></font>
<font color=#447700>! *    CO2MULT - for bands in which carbon dioxide is implemented as a         *<a name='3204'></font>
<font color=#447700>! *              trace species, this is the factor used to multiply the        *<a name='3205'></font>
<font color=#447700>! *              band's average CO2 absorption coefficient to get the added    *<a name='3206'></font>
<font color=#447700>! *              contribution to the optical depth relative to 355 ppm.        *<a name='3207'></font>
<font color=#447700>! *    FACij(LAY) - for layer LAY, these are factors that are needed to        *<a name='3208'></font>
<font color=#447700>! *                 compute the interpolation factors that multiply the        *<a name='3209'></font>
<font color=#447700>! *                 appropriate reference k-values.  A value of 0 (1) for      *<a name='3210'></font>
<font color=#447700>! *                 i,j indicates that the corresponding factor multiplies     *<a name='3211'></font>
<font color=#447700>! *                 reference k-value for the lower (higher) of the two        *<a name='3212'></font>
<font color=#447700>! *                 appropriate temperatures, and altitudes, respectively.     *<a name='3213'></font>
<font color=#447700>! *    JP - the index of the lower (in altitude) of the two appropriate        *<a name='3214'></font>
<font color=#447700>! *         reference pressure levels needed for interpolation                 *<a name='3215'></font>
<font color=#447700>! *    JT, JT1 - the indices of the lower of the two appropriate reference     *<a name='3216'></font>
<font color=#447700>! *              temperatures needed for interpolation (for pressure           *<a name='3217'></font>
<font color=#447700>! *              levels JP and JP+1, respectively)                             *<a name='3218'></font>
<font color=#447700>! *    SELFFAC - scale factor needed to water vapor self-continuum, equals     *<a name='3219'></font>
<font color=#447700>! *              (water vapor density)/(atmospheric density at 296K and        *<a name='3220'></font>
<font color=#447700>! *              1013 mb)                                                      *<a name='3221'></font>
<font color=#447700>! *    SELFFRAC - factor needed for temperature interpolation of reference     *<a name='3222'></font>
<font color=#447700>! *               water vapor self-continuum data                              *<a name='3223'></font>
<font color=#447700>! *    INDSELF - index of the lower of the two appropriate reference           *<a name='3224'></font>
<font color=#447700>! *              temperatures needed for the self-continuum interpolation      *<a name='3225'></font>
<font color=#447700>! *                                                                            *<a name='3226'></font>
<font color=#447700>! * Data input                                                                 *<a name='3227'></font>
<font color=#447700>! *    COMMON /Kn/ KA(NSPA(n),5,13,MG), KB(NSPB(n),5,13:59,MG), SELFREF(10,MG) *<a name='3228'></font>
<font color=#447700>! *       (note:  n is the band number)                                        *<a name='3229'></font>
<font color=#447700>! *                                                                            *<a name='3230'></font>
<font color=#447700>! *    Description:                                                            *<a name='3231'></font>
<font color=#447700>! *    KA - k-values for low reference atmospheres (no water vapor             *<a name='3232'></font>
<font color=#447700>! *         self-continuum) (units: cm**2/molecule)                            *<a name='3233'></font>
<font color=#447700>! *    KB - k-values for high reference atmospheres (all sources)              *<a name='3234'></font>
<font color=#447700>! *         (units: cm**2/molecule)                                            *<a name='3235'></font>
<font color=#447700>! *    SELFREF - k-values for water vapor self-continuum for reference         *<a name='3236'></font>
<font color=#447700>! *              atmospheres (used below LAYTROP)                              *<a name='3237'></font>
<font color=#447700>! *              (units: cm**2/molecule)                                       *<a name='3238'></font>
<font color=#447700>! *                                                                            *<a name='3239'></font>
<font color=#447700>! *    DIMENSION ABSA(65*NSPA(n),MG), ABSB(235*NSPB(n),MG)                     *<a name='3240'></font>
<font color=#447700>! *    EQUIVALENCE (KA,ABSA),(KB,ABSB)                                         *<a name='3241'></font>
<font color=#447700>! *                                                                            *<a name='3242'></font>
<font color=#447700>! *****************************************************************************<a name='3243'></font>
<font color=#447700>!<a name='3244'></font>
<font color=#447700>! Modifications<a name='3245'></font>
<font color=#447700>!<a name='3246'></font>
<font color=#447700>! Revised: Adapted to F90 coding, J.-J.Morcrette, ECMWF, Feb 2003<a name='3247'></font>
<font color=#447700>! Revised: Modified for g-point reduction, MJIacono, AER, Dec 2003<a name='3248'></font>
<font color=#447700>! Revised: Reformatted for consistency with rrtmg_lw, MJIacono, AER, Jul 2006<a name='3249'></font>
<font color=#447700>!<a name='3250'></font>
<font color=#447700>! ------- Declarations -------<a name='3251'></font>
<a name='3252'>
<font color=#447700>! ----- Input -----<a name='3253'></font>
      integer(kind=im), intent(in) :: nlayers            <font color=#447700>! total number of layers<a name='3254'></font>
<a name='3255'>
      integer(kind=im), intent(in) :: laytrop            <font color=#447700>! tropopause layer index<a name='3256'></font>
      integer(kind=im), intent(in) :: jp(:)              <font color=#447700>! <a name='3257'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3258'></font>
      integer(kind=im), intent(in) :: jt(:)              <font color=#447700>!<a name='3259'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3260'></font>
      integer(kind=im), intent(in) :: jt1(:)             <font color=#447700>!<a name='3261'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3262'></font>
<a name='3263'>
      real(kind=rb), intent(in) :: colh2o(:)             <font color=#447700>! column amount (h2o)<a name='3264'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3265'></font>
      real(kind=rb), intent(in) :: colco2(:)             <font color=#447700>! column amount (co2)<a name='3266'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3267'></font>
      real(kind=rb), intent(in) :: colo3(:)              <font color=#447700>! column amount (o3)<a name='3268'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3269'></font>
      real(kind=rb), intent(in) :: colch4(:)             <font color=#447700>! column amount (ch4)<a name='3270'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3271'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3272'></font>
      real(kind=rb), intent(in) :: colo2(:)              <font color=#447700>! column amount (o2)<a name='3273'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3274'></font>
      real(kind=rb), intent(in) :: colmol(:)             <font color=#447700>! <a name='3275'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3276'></font>
<a name='3277'>
      integer(kind=im), intent(in) :: indself(:)    <a name='3278'>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3279'></font>
      integer(kind=im), intent(in) :: indfor(:)<a name='3280'>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3281'></font>
      real(kind=rb), intent(in) :: selffac(:)<a name='3282'>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3283'></font>
      real(kind=rb), intent(in) :: selffrac(:)<a name='3284'>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3285'></font>
      real(kind=rb), intent(in) :: forfac(:)<a name='3286'>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3287'></font>
      real(kind=rb), intent(in) :: forfrac(:)<a name='3288'>
                                                         <font color=#447700>!   Dimensions: (nlayers)<a name='3289'></font>
<a name='3290'>
      real(kind=rb), intent(in) :: &amp;                     <font color=#447700>!<a name='3291'></font>
                       fac00(:), fac01(:), &amp;             <font color=#447700>!   Dimensions: (nlayers)<a name='3292'></font>
                       fac10(:), fac11(:) <a name='3293'>
<a name='3294'>
<font color=#447700>! ----- Output -----<a name='3295'></font>
      real(kind=rb), intent(out) :: sfluxzen(:)          <font color=#447700>! solar source function<a name='3296'></font>
                                                         <font color=#447700>!   Dimensions: (ngptsw)<a name='3297'></font>
      real(kind=rb), intent(out) :: taug(:,:)            <font color=#447700>! gaseous optical depth <a name='3298'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers,ngptsw)<a name='3299'></font>
      real(kind=rb), intent(out) :: taur(:,:)            <font color=#447700>! Rayleigh <a name='3300'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers,ngptsw)<a name='3301'></font>
<font color=#447700>!      real(kind=rb), intent(out) :: ssa(:,:)            ! single scattering albedo (inactive)<a name='3302'></font>
                                                         <font color=#447700>!   Dimensions: (nlayers,ngptsw)<a name='3303'></font>
<a name='3304'>
<font color=#447700>!jm not thread safe      hvrtau = '$Revision: 1.3 $'<a name='3305'></font>
<a name='3306'>
<font color=#447700>! Calculate gaseous optical depth and planck fractions for each spectral band.<a name='3307'></font>
<a name='3308'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL16'>taumol16</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL16_1"><a name='3309'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL17'>taumol17</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL17_1"><a name='3310'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL18'>taumol18</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL18_1"><a name='3311'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL19'>taumol19</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL19_1"><a name='3312'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL20'>taumol20</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL20_1"><a name='3313'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL21'>taumol21</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL21_1"><a name='3314'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL22'>taumol22</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL22_1"><a name='3315'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL23'>taumol23</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL23_1"><a name='3316'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL24'>taumol24</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL24_1"><a name='3317'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL25'>taumol25</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL25_1"><a name='3318'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL26'>taumol26</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL26_1"><a name='3319'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL27'>taumol27</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL27_1"><a name='3320'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL28'>taumol28</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL28_1"><a name='3321'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL29'>taumol29</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL29_1"><a name='3322'>
<a name='3323'>
<font color=#447700>!-------------<a name='3324'></font>
      contains<a name='3325'>
<font color=#447700>!-------------<a name='3326'></font>
<a name='3327'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3328'></font>
<A NAME='TAUMOL16'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL16' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3329'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol16</font> <A href='../../call_to/TAUMOL16.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL16.html' TARGET='index'>4</A><a name='3330'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3331'></font>
<font color=#447700>!<a name='3332'></font>
<font color=#447700>!     band 16:  2600-3250 cm-1 (low - h2o,ch4; high - ch4)<a name='3333'></font>
<font color=#447700>!<a name='3334'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3335'></font>
<a name='3336'>
<font color=#447700>! ------- Modules -------<a name='3337'></font>
<a name='3338'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_20">, only : ng16<a name='3339'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG16'>rrsw_kg16</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG16_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3340'>
                            sfluxref, rayl, layreffr, strrat1<a name='3341'>
<a name='3342'>
<font color=#447700>! ------- Declarations -------<a name='3343'></font>
<a name='3344'>
<font color=#447700>! Local<a name='3345'></font>
<a name='3346'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3347'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3348'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3349'>
                       tauray<a name='3350'>
<a name='3351'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='3352'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='3353'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='3354'></font>
<a name='3355'>
<font color=#447700>! Lower atmosphere loop<a name='3356'></font>
      do lay = 1, laytrop<a name='3357'>
         speccomb = colh2o(lay) + strrat1*colch4(lay)<a name='3358'>
         specparm = colh2o(lay)/speccomb <a name='3359'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3360'>
         specmult = 8._rb*(specparm)<a name='3361'>
         js = 1 + int(specmult)<a name='3362'>
         fs = mod(specmult, 1._rb )<a name='3363'>
         fac000 = (1._rb - fs) * fac00(lay)<a name='3364'>
         fac010 = (1._rb - fs) * fac10(lay)<a name='3365'>
         fac100 = fs * fac00(lay)<a name='3366'>
         fac110 = fs * fac10(lay)<a name='3367'>
         fac001 = (1._rb - fs) * fac01(lay)<a name='3368'>
         fac011 = (1._rb - fs) * fac11(lay)<a name='3369'>
         fac101 = fs * fac01(lay)<a name='3370'>
         fac111 = fs * fac11(lay)<a name='3371'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(16) + js<a name='3372'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(16) + js<a name='3373'>
         inds = indself(lay)<a name='3374'>
         indf = indfor(lay)<a name='3375'>
         tauray = colmol(lay) * rayl<a name='3376'>
<a name='3377'>
         do ig = 1, ng16<a name='3378'>
            taug(lay,ig) = speccomb * &amp;<a name='3379'>
                (fac000 * absa(ind0   ,ig) + &amp;<a name='3380'>
                 fac100 * absa(ind0 +1,ig) + &amp;<a name='3381'>
                 fac010 * absa(ind0 +9,ig) + &amp;<a name='3382'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='3383'>
                 fac001 * absa(ind1   ,ig) + &amp;<a name='3384'>
                 fac101 * absa(ind1 +1,ig) + &amp;<a name='3385'>
                 fac011 * absa(ind1 +9,ig) + &amp;<a name='3386'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='3387'>
                 colh2o(lay) * &amp;<a name='3388'>
                 (selffac(lay) * (selfref(inds,ig) + &amp;<a name='3389'>
                 selffrac(lay) * &amp;<a name='3390'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='3391'>
                 forfac(lay) * (forref(indf,ig) + &amp;<a name='3392'>
                 forfrac(lay) * &amp;<a name='3393'>
                 (forref(indf+1,ig) - forref(indf,ig)))) <a name='3394'>
<font color=#447700>!            ssa(lay,ig) = tauray/taug(lay,ig)<a name='3395'></font>
            taur(lay,ig) = tauray<a name='3396'>
         enddo<a name='3397'>
      enddo<a name='3398'>
<a name='3399'>
      laysolfr = nlayers<a name='3400'>
<a name='3401'>
<font color=#447700>! Upper atmosphere loop<a name='3402'></font>
      do lay = laytrop+1, nlayers<a name='3403'>
         if (jp(lay-1) .lt. layreffr .and. jp(lay) .ge. layreffr) &amp;<a name='3404'>
            laysolfr = lay<a name='3405'>
         ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(16) + 1<a name='3406'>
         ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(16) + 1<a name='3407'>
         tauray = colmol(lay) * rayl<a name='3408'>
<a name='3409'>
         do ig = 1, ng16<a name='3410'>
            taug(lay,ig) = colch4(lay) * &amp;<a name='3411'>
                (fac00(lay) * absb(ind0  ,ig) + &amp;<a name='3412'>
                 fac10(lay) * absb(ind0+1,ig) + &amp;<a name='3413'>
                 fac01(lay) * absb(ind1  ,ig) + &amp;<a name='3414'>
                 fac11(lay) * absb(ind1+1,ig)) <a name='3415'>
<font color=#447700>!            ssa(lay,ig) = tauray/taug(lay,ig)<a name='3416'></font>
            if (lay .eq. laysolfr) sfluxzen(ig) = sfluxref(ig) <a name='3417'>
            taur(lay,ig) = tauray  <a name='3418'>
         enddo<a name='3419'>
      enddo<a name='3420'>
<a name='3421'>
      end subroutine taumol16<a name='3422'>
<a name='3423'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3424'></font>
<A NAME='TAUMOL17'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL17' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3425'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol17</font> <A href='../../call_to/TAUMOL17.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL17.html' TARGET='index'>4</A><a name='3426'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3427'></font>
<font color=#447700>!<a name='3428'></font>
<font color=#447700>!     band 17:  3250-4000 cm-1 (low - h2o,co2; high - h2o,co2)<a name='3429'></font>
<font color=#447700>!<a name='3430'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3431'></font>
<a name='3432'>
<font color=#447700>! ------- Modules -------<a name='3433'></font>
<a name='3434'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_21">, only : ng17, ngs16<a name='3435'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG17'>rrsw_kg17</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG17_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3436'>
                            sfluxref, rayl, layreffr, strrat<a name='3437'>
<a name='3438'>
<font color=#447700>! ------- Declarations -------<a name='3439'></font>
<a name='3440'>
<font color=#447700>! Local<a name='3441'></font>
<a name='3442'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3443'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3444'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3445'>
                       tauray<a name='3446'>
<a name='3447'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='3448'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='3449'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='3450'></font>
<a name='3451'>
<font color=#447700>! Lower atmosphere loop<a name='3452'></font>
      do lay = 1, laytrop<a name='3453'>
         speccomb = colh2o(lay) + strrat*colco2(lay)<a name='3454'>
         specparm = colh2o(lay)/speccomb <a name='3455'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3456'>
         specmult = 8._rb*(specparm)<a name='3457'>
         js = 1 + int(specmult)<a name='3458'>
         fs = mod(specmult, 1._rb )<a name='3459'>
         fac000 = (1._rb - fs) * fac00(lay)<a name='3460'>
         fac010 = (1._rb - fs) * fac10(lay)<a name='3461'>
         fac100 = fs * fac00(lay)<a name='3462'>
         fac110 = fs * fac10(lay)<a name='3463'>
         fac001 = (1._rb - fs) * fac01(lay)<a name='3464'>
         fac011 = (1._rb - fs) * fac11(lay)<a name='3465'>
         fac101 = fs * fac01(lay)<a name='3466'>
         fac111 = fs * fac11(lay)<a name='3467'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(17) + js<a name='3468'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(17) + js<a name='3469'>
         inds = indself(lay)<a name='3470'>
         indf = indfor(lay)<a name='3471'>
         tauray = colmol(lay) * rayl<a name='3472'>
<a name='3473'>
         do ig = 1, ng17<a name='3474'>
            taug(lay,ngs16+ig) = speccomb * &amp;<a name='3475'>
                (fac000 * absa(ind0,ig) + &amp;<a name='3476'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='3477'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='3478'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='3479'>
                 fac001 * absa(ind1,ig) + &amp;<a name='3480'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='3481'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='3482'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='3483'>
                 colh2o(lay) * &amp;<a name='3484'>
                 (selffac(lay) * (selfref(inds,ig) + &amp;<a name='3485'>
                 selffrac(lay) * &amp;<a name='3486'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='3487'>
                 forfac(lay) * (forref(indf,ig) + &amp;<a name='3488'>
                 forfrac(lay) * &amp;<a name='3489'>
                 (forref(indf+1,ig) - forref(indf,ig)))) <a name='3490'>
<font color=#447700>!             ssa(lay,ngs16+ig) = tauray/taug(lay,ngs16+ig)<a name='3491'></font>
            taur(lay,ngs16+ig) = tauray<a name='3492'>
         enddo<a name='3493'>
      enddo<a name='3494'>
<a name='3495'>
      laysolfr = nlayers<a name='3496'>
<a name='3497'>
<font color=#447700>! Upper atmosphere loop<a name='3498'></font>
      do lay = laytrop+1, nlayers<a name='3499'>
         if (jp(lay-1) .lt. layreffr .and. jp(lay) .ge. layreffr) &amp;<a name='3500'>
            laysolfr = lay<a name='3501'>
         speccomb = colh2o(lay) + strrat*colco2(lay)<a name='3502'>
         specparm = colh2o(lay)/speccomb <a name='3503'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3504'>
         specmult = 4._rb*(specparm)<a name='3505'>
         js = 1 + int(specmult)<a name='3506'>
         fs = mod(specmult, 1._rb )<a name='3507'>
         fac000 = (1._rb - fs) * fac00(lay)<a name='3508'>
         fac010 = (1._rb - fs) * fac10(lay)<a name='3509'>
         fac100 = fs * fac00(lay)<a name='3510'>
         fac110 = fs * fac10(lay)<a name='3511'>
         fac001 = (1._rb - fs) * fac01(lay)<a name='3512'>
         fac011 = (1._rb - fs) * fac11(lay)<a name='3513'>
         fac101 = fs * fac01(lay)<a name='3514'>
         fac111 = fs * fac11(lay)<a name='3515'>
         ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(17) + js<a name='3516'>
         ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(17) + js<a name='3517'>
         indf = indfor(lay)<a name='3518'>
         tauray = colmol(lay) * rayl<a name='3519'>
<a name='3520'>
         do ig = 1, ng17<a name='3521'>
            taug(lay,ngs16+ig) = speccomb * &amp;<a name='3522'>
                (fac000 * absb(ind0,ig) + &amp;<a name='3523'>
                 fac100 * absb(ind0+1,ig) + &amp;<a name='3524'>
                 fac010 * absb(ind0+5,ig) + &amp;<a name='3525'>
                 fac110 * absb(ind0+6,ig) + &amp;<a name='3526'>
                 fac001 * absb(ind1,ig) + &amp;<a name='3527'>
                 fac101 * absb(ind1+1,ig) + &amp;<a name='3528'>
                 fac011 * absb(ind1+5,ig) + &amp;<a name='3529'>
                 fac111 * absb(ind1+6,ig)) + &amp;<a name='3530'>
                 colh2o(lay) * &amp;<a name='3531'>
                 forfac(lay) * (forref(indf,ig) + &amp;<a name='3532'>
                 forfrac(lay) * &amp;<a name='3533'>
                 (forref(indf+1,ig) - forref(indf,ig))) <a name='3534'>
<font color=#447700>!            ssa(lay,ngs16+ig) = tauray/taug(lay,ngs16+ig)<a name='3535'></font>
            if (lay .eq. laysolfr) sfluxzen(ngs16+ig) = sfluxref(ig,js) &amp;<a name='3536'>
               + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='3537'>
            taur(lay,ngs16+ig) = tauray<a name='3538'>
         enddo<a name='3539'>
      enddo<a name='3540'>
<a name='3541'>
      end subroutine taumol17<a name='3542'>
<a name='3543'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3544'></font>
<A NAME='TAUMOL18'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL18' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3545'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol18</font> <A href='../../call_to/TAUMOL18.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL18.html' TARGET='index'>4</A><a name='3546'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3547'></font>
<font color=#447700>!<a name='3548'></font>
<font color=#447700>!     band 18:  4000-4650 cm-1 (low - h2o,ch4; high - ch4)<a name='3549'></font>
<font color=#447700>!<a name='3550'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3551'></font>
<a name='3552'>
<font color=#447700>! ------- Modules -------<a name='3553'></font>
<a name='3554'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_22">, only : ng18, ngs17<a name='3555'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG18'>rrsw_kg18</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG18_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3556'>
                            sfluxref, rayl, layreffr, strrat<a name='3557'>
<a name='3558'>
<font color=#447700>! ------- Declarations -------<a name='3559'></font>
<a name='3560'>
<font color=#447700>! Local<a name='3561'></font>
<a name='3562'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3563'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3564'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3565'>
                       tauray<a name='3566'>
<a name='3567'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='3568'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='3569'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='3570'></font>
<a name='3571'>
      laysolfr = laytrop<a name='3572'>
      <a name='3573'>
<font color=#447700>! Lower atmosphere loop<a name='3574'></font>
      do lay = 1, laytrop<a name='3575'>
         if (jp(lay) .lt. layreffr .and. jp(lay+1) .ge. layreffr) &amp;<a name='3576'>
            laysolfr = min(lay+1,laytrop)<a name='3577'>
         speccomb = colh2o(lay) + strrat*colch4(lay)<a name='3578'>
         specparm = colh2o(lay)/speccomb <a name='3579'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3580'>
         specmult = 8._rb*(specparm)<a name='3581'>
         js = 1 + int(specmult)<a name='3582'>
         fs = mod(specmult, 1._rb )<a name='3583'>
         fac000 = (1._rb - fs) * fac00(lay)<a name='3584'>
         fac010 = (1._rb - fs) * fac10(lay)<a name='3585'>
         fac100 = fs * fac00(lay)<a name='3586'>
         fac110 = fs * fac10(lay)<a name='3587'>
         fac001 = (1._rb - fs) * fac01(lay)<a name='3588'>
         fac011 = (1._rb - fs) * fac11(lay)<a name='3589'>
         fac101 = fs * fac01(lay)<a name='3590'>
         fac111 = fs * fac11(lay)<a name='3591'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(18) + js<a name='3592'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(18) + js<a name='3593'>
         inds = indself(lay)<a name='3594'>
         indf = indfor(lay)<a name='3595'>
         tauray = colmol(lay) * rayl<a name='3596'>
<a name='3597'>
         do ig = 1, ng18<a name='3598'>
            taug(lay,ngs17+ig) = speccomb * &amp;<a name='3599'>
                (fac000 * absa(ind0,ig) + &amp;<a name='3600'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='3601'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='3602'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='3603'>
                 fac001 * absa(ind1,ig) + &amp;<a name='3604'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='3605'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='3606'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='3607'>
                 colh2o(lay) * &amp;<a name='3608'>
                 (selffac(lay) * (selfref(inds,ig) + &amp;<a name='3609'>
                 selffrac(lay) * &amp;<a name='3610'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='3611'>
                 forfac(lay) * (forref(indf,ig) + &amp;<a name='3612'>
                 forfrac(lay) * &amp;<a name='3613'>
                 (forref(indf+1,ig) - forref(indf,ig)))) <a name='3614'>
<font color=#447700>!            ssa(lay,ngs17+ig) = tauray/taug(lay,ngs17+ig)<a name='3615'></font>
            if (lay .eq. laysolfr) sfluxzen(ngs17+ig) = sfluxref(ig,js) &amp;<a name='3616'>
               + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='3617'>
            taur(lay,ngs17+ig) = tauray<a name='3618'>
         enddo<a name='3619'>
      enddo<a name='3620'>
<a name='3621'>
<font color=#447700>! Upper atmosphere loop<a name='3622'></font>
      do lay = laytrop+1, nlayers<a name='3623'>
         ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(18) + 1<a name='3624'>
         ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(18) + 1<a name='3625'>
         tauray = colmol(lay) * rayl<a name='3626'>
<a name='3627'>
         do ig = 1, ng18<a name='3628'>
            taug(lay,ngs17+ig) = colch4(lay) * &amp;<a name='3629'>
                (fac00(lay) * absb(ind0,ig) + &amp;<a name='3630'>
                 fac10(lay) * absb(ind0+1,ig) + &amp;<a name='3631'>
                 fac01(lay) * absb(ind1,ig) + &amp;	  <a name='3632'>
                 fac11(lay) * absb(ind1+1,ig)) <a name='3633'>
<font color=#447700>!           ssa(lay,ngs17+ig) = tauray/taug(lay,ngs17+ig)<a name='3634'></font>
           taur(lay,ngs17+ig) = tauray<a name='3635'>
         enddo<a name='3636'>
       enddo<a name='3637'>
<a name='3638'>
       end subroutine taumol18<a name='3639'>
<a name='3640'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3641'></font>
<A NAME='TAUMOL19'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL19' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3642'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol19</font> <A href='../../call_to/TAUMOL19.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL19.html' TARGET='index'>4</A><a name='3643'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3644'></font>
<font color=#447700>!<a name='3645'></font>
<font color=#447700>!     band 19:  4650-5150 cm-1 (low - h2o,co2; high - co2)<a name='3646'></font>
<font color=#447700>!<a name='3647'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3648'></font>
<a name='3649'>
<font color=#447700>! ------- Modules -------<a name='3650'></font>
<a name='3651'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_23">, only : ng19, ngs18<a name='3652'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG19'>rrsw_kg19</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG19_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3653'>
                            sfluxref, rayl, layreffr, strrat<a name='3654'>
<a name='3655'>
<font color=#447700>! ------- Declarations -------<a name='3656'></font>
<a name='3657'>
<font color=#447700>! Local<a name='3658'></font>
<a name='3659'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3660'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3661'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3662'>
                       tauray<a name='3663'>
<a name='3664'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='3665'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='3666'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='3667'></font>
<a name='3668'>
      laysolfr = laytrop<a name='3669'>
<a name='3670'>
<font color=#447700>! Lower atmosphere loop      <a name='3671'></font>
      do lay = 1, laytrop<a name='3672'>
         if (jp(lay) .lt. layreffr .and. jp(lay+1) .ge. layreffr) &amp;<a name='3673'>
            laysolfr = min(lay+1,laytrop)<a name='3674'>
         speccomb = colh2o(lay) + strrat*colco2(lay)<a name='3675'>
         specparm = colh2o(lay)/speccomb <a name='3676'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3677'>
         specmult = 8._rb*(specparm)<a name='3678'>
         js = 1 + int(specmult)<a name='3679'>
         fs = mod(specmult, 1._rb )<a name='3680'>
         fac000 = (1._rb - fs) * fac00(lay)<a name='3681'>
         fac010 = (1._rb - fs) * fac10(lay)<a name='3682'>
         fac100 = fs * fac00(lay)<a name='3683'>
         fac110 = fs * fac10(lay)<a name='3684'>
         fac001 = (1._rb - fs) * fac01(lay)<a name='3685'>
         fac011 = (1._rb - fs) * fac11(lay)<a name='3686'>
         fac101 = fs * fac01(lay)<a name='3687'>
         fac111 = fs * fac11(lay)<a name='3688'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(19) + js<a name='3689'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(19) + js<a name='3690'>
         inds = indself(lay)<a name='3691'>
         indf = indfor(lay)<a name='3692'>
         tauray = colmol(lay) * rayl<a name='3693'>
<a name='3694'>
         do ig = 1 , ng19<a name='3695'>
            taug(lay,ngs18+ig) = speccomb * &amp;<a name='3696'>
                (fac000 * absa(ind0,ig) + &amp;<a name='3697'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='3698'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='3699'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='3700'>
                 fac001 * absa(ind1,ig) + &amp;<a name='3701'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='3702'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='3703'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='3704'>
                 colh2o(lay) * &amp;<a name='3705'>
                 (selffac(lay) * (selfref(inds,ig) + &amp;<a name='3706'>
                 selffrac(lay) * &amp;<a name='3707'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp; <a name='3708'>
                 forfac(lay) * (forref(indf,ig) + &amp;<a name='3709'>
                 forfrac(lay) * &amp;<a name='3710'>
                 (forref(indf+1,ig) - forref(indf,ig)))) <a name='3711'>
<font color=#447700>!            ssa(lay,ngs18+ig) = tauray/taug(lay,ngs18+ig)<a name='3712'></font>
            if (lay .eq. laysolfr) sfluxzen(ngs18+ig) = sfluxref(ig,js) &amp;<a name='3713'>
               + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='3714'>
            taur(lay,ngs18+ig) = tauray   <a name='3715'>
         enddo<a name='3716'>
      enddo<a name='3717'>
<a name='3718'>
<font color=#447700>! Upper atmosphere loop<a name='3719'></font>
      do lay = laytrop+1, nlayers<a name='3720'>
         ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(19) + 1<a name='3721'>
         ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(19) + 1<a name='3722'>
         tauray = colmol(lay) * rayl<a name='3723'>
<a name='3724'>
         do ig = 1 , ng19<a name='3725'>
            taug(lay,ngs18+ig) = colco2(lay) * &amp;<a name='3726'>
                (fac00(lay) * absb(ind0,ig) + &amp;<a name='3727'>
                 fac10(lay) * absb(ind0+1,ig) + &amp;<a name='3728'>
                 fac01(lay) * absb(ind1,ig) + &amp;<a name='3729'>
                 fac11(lay) * absb(ind1+1,ig)) <a name='3730'>
<font color=#447700>!            ssa(lay,ngs18+ig) = tauray/taug(lay,ngs18+ig) <a name='3731'></font>
            taur(lay,ngs18+ig) = tauray   <a name='3732'>
         enddo<a name='3733'>
      enddo<a name='3734'>
<a name='3735'>
      end subroutine taumol19<a name='3736'>
<a name='3737'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3738'></font>
<A NAME='TAUMOL20'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL20' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3739'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol20</font> <A href='../../call_to/TAUMOL20.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL20.html' TARGET='index'>4</A><a name='3740'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3741'></font>
<font color=#447700>!<a name='3742'></font>
<font color=#447700>!     band 20:  5150-6150 cm-1 (low - h2o; high - h2o)<a name='3743'></font>
<font color=#447700>!<a name='3744'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3745'></font>
<a name='3746'>
<font color=#447700>! ------- Modules -------<a name='3747'></font>
<a name='3748'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_24">, only : ng20, ngs19<a name='3749'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG20'>rrsw_kg20</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG20_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3750'>
                            sfluxref, absch4, rayl, layreffr<a name='3751'>
<a name='3752'>
      implicit none<a name='3753'>
<a name='3754'>
<font color=#447700>! ------- Declarations -------<a name='3755'></font>
<a name='3756'>
<font color=#447700>! Local<a name='3757'></font>
<a name='3758'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3759'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3760'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3761'>
                       tauray<a name='3762'>
<a name='3763'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='3764'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='3765'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='3766'></font>
<a name='3767'>
      laysolfr = laytrop<a name='3768'>
<a name='3769'>
<font color=#447700>! Lower atmosphere loop<a name='3770'></font>
      do lay = 1, laytrop<a name='3771'>
         if (jp(lay) .lt. layreffr .and. jp(lay+1) .ge. layreffr) &amp;<a name='3772'>
            laysolfr = min(lay+1,laytrop)<a name='3773'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(20) + 1<a name='3774'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(20) + 1<a name='3775'>
         inds = indself(lay)<a name='3776'>
         indf = indfor(lay)<a name='3777'>
         tauray = colmol(lay) * rayl<a name='3778'>
<a name='3779'>
         do ig = 1, ng20<a name='3780'>
            taug(lay,ngs19+ig) = colh2o(lay) * &amp;<a name='3781'>
               ((fac00(lay) * absa(ind0,ig) + &amp;<a name='3782'>
                 fac10(lay) * absa(ind0+1,ig) + &amp;<a name='3783'>
                 fac01(lay) * absa(ind1,ig) + &amp;<a name='3784'>
                 fac11(lay) * absa(ind1+1,ig)) + &amp;<a name='3785'>
                 selffac(lay) * (selfref(inds,ig) + &amp; <a name='3786'>
                 selffrac(lay) * &amp;<a name='3787'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='3788'>
                 forfac(lay) * (forref(indf,ig) + &amp;<a name='3789'>
                 forfrac(lay) * &amp;<a name='3790'>
                 (forref(indf+1,ig) - forref(indf,ig)))) &amp;<a name='3791'>
                 + colch4(lay) * absch4(ig)<a name='3792'>
<font color=#447700>!            ssa(lay,ngs19+ig) = tauray/taug(lay,ngs19+ig)<a name='3793'></font>
            taur(lay,ngs19+ig) = tauray <a name='3794'>
            if (lay .eq. laysolfr) sfluxzen(ngs19+ig) = sfluxref(ig) <a name='3795'>
         enddo<a name='3796'>
      enddo<a name='3797'>
<a name='3798'>
<font color=#447700>! Upper atmosphere loop<a name='3799'></font>
      do lay = laytrop+1, nlayers<a name='3800'>
         ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(20) + 1<a name='3801'>
         ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(20) + 1<a name='3802'>
         indf = indfor(lay)<a name='3803'>
         tauray = colmol(lay) * rayl<a name='3804'>
<a name='3805'>
         do ig = 1, ng20<a name='3806'>
            taug(lay,ngs19+ig) = colh2o(lay) * &amp;<a name='3807'>
                (fac00(lay) * absb(ind0,ig) + &amp;<a name='3808'>
                 fac10(lay) * absb(ind0+1,ig) + &amp;<a name='3809'>
                 fac01(lay) * absb(ind1,ig) + &amp;<a name='3810'>
                 fac11(lay) * absb(ind1+1,ig) + &amp;<a name='3811'>
                 forfac(lay) * (forref(indf,ig) + &amp;<a name='3812'>
                 forfrac(lay) * &amp;<a name='3813'>
                 (forref(indf+1,ig) - forref(indf,ig)))) + &amp;<a name='3814'>
                 colch4(lay) * absch4(ig)<a name='3815'>
<font color=#447700>!            ssa(lay,ngs19+ig) = tauray/taug(lay,ngs19+ig)<a name='3816'></font>
            taur(lay,ngs19+ig) = tauray <a name='3817'>
         enddo<a name='3818'>
      enddo<a name='3819'>
<a name='3820'>
      end subroutine taumol20<a name='3821'>
<a name='3822'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3823'></font>
<A NAME='TAUMOL21'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL21' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3824'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol21</font> <A href='../../call_to/TAUMOL21.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL21.html' TARGET='index'>4</A><a name='3825'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3826'></font>
<font color=#447700>!<a name='3827'></font>
<font color=#447700>!     band 21:  6150-7700 cm-1 (low - h2o,co2; high - h2o,co2)<a name='3828'></font>
<font color=#447700>!<a name='3829'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3830'></font>
<a name='3831'>
<font color=#447700>! ------- Modules -------<a name='3832'></font>
<a name='3833'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_25">, only : ng21, ngs20<a name='3834'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG21'>rrsw_kg21</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG21_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3835'>
                            sfluxref, rayl, layreffr, strrat<a name='3836'>
<a name='3837'>
<font color=#447700>! ------- Declarations -------<a name='3838'></font>
<a name='3839'>
<font color=#447700>! Local<a name='3840'></font>
<a name='3841'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3842'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3843'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3844'>
                       tauray<a name='3845'>
<a name='3846'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='3847'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='3848'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='3849'></font>
<a name='3850'>
      laysolfr = laytrop<a name='3851'>
      <a name='3852'>
<font color=#447700>! Lower atmosphere loop<a name='3853'></font>
      do lay = 1, laytrop<a name='3854'>
         if (jp(lay) .lt. layreffr .and. jp(lay+1) .ge. layreffr) &amp;<a name='3855'>
            laysolfr = min(lay+1,laytrop)<a name='3856'>
         speccomb = colh2o(lay) + strrat*colco2(lay)<a name='3857'>
         specparm = colh2o(lay)/speccomb <a name='3858'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3859'>
         specmult = 8._rb*(specparm)<a name='3860'>
         js = 1 + int(specmult)<a name='3861'>
         fs = mod(specmult, 1._rb )<a name='3862'>
         fac000 = (1._rb - fs) * fac00(lay)<a name='3863'>
         fac010 = (1._rb - fs) * fac10(lay)<a name='3864'>
         fac100 = fs * fac00(lay)<a name='3865'>
         fac110 = fs * fac10(lay)<a name='3866'>
         fac001 = (1._rb - fs) * fac01(lay)<a name='3867'>
         fac011 = (1._rb - fs) * fac11(lay)<a name='3868'>
         fac101 = fs * fac01(lay)<a name='3869'>
         fac111 = fs * fac11(lay)<a name='3870'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(21) + js<a name='3871'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(21) + js<a name='3872'>
         inds = indself(lay)<a name='3873'>
         indf = indfor(lay)<a name='3874'>
         tauray = colmol(lay) * rayl<a name='3875'>
<a name='3876'>
         do ig = 1, ng21<a name='3877'>
            taug(lay,ngs20+ig) = speccomb * &amp;<a name='3878'>
                (fac000 * absa(ind0,ig) + &amp;<a name='3879'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='3880'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='3881'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='3882'>
                 fac001 * absa(ind1,ig) + &amp;<a name='3883'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='3884'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='3885'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='3886'>
                 colh2o(lay) * &amp;<a name='3887'>
                 (selffac(lay) * (selfref(inds,ig) + &amp;<a name='3888'>
                 selffrac(lay) * &amp;<a name='3889'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='3890'>
                 forfac(lay) * (forref(indf,ig) + &amp;<a name='3891'>
                 forfrac(lay) * &amp;<a name='3892'>
                 (forref(indf+1,ig) - forref(indf,ig))))<a name='3893'>
<font color=#447700>!            ssa(lay,ngs20+ig) = tauray/taug(lay,ngs20+ig)<a name='3894'></font>
            if (lay .eq. laysolfr) sfluxzen(ngs20+ig) = sfluxref(ig,js) &amp;<a name='3895'>
               + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='3896'>
            taur(lay,ngs20+ig) = tauray<a name='3897'>
         enddo<a name='3898'>
      enddo<a name='3899'>
<a name='3900'>
<font color=#447700>! Upper atmosphere loop<a name='3901'></font>
      do lay = laytrop+1, nlayers<a name='3902'>
         speccomb = colh2o(lay) + strrat*colco2(lay)<a name='3903'>
         specparm = colh2o(lay)/speccomb <a name='3904'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3905'>
         specmult = 4._rb*(specparm)<a name='3906'>
         js = 1 + int(specmult)<a name='3907'>
         fs = mod(specmult, 1._rb )<a name='3908'>
         fac000 = (1._rb - fs) * fac00(lay)<a name='3909'>
         fac010 = (1._rb - fs) * fac10(lay)<a name='3910'>
         fac100 = fs * fac00(lay)<a name='3911'>
         fac110 = fs * fac10(lay)<a name='3912'>
         fac001 = (1._rb - fs) * fac01(lay)<a name='3913'>
         fac011 = (1._rb - fs) * fac11(lay)<a name='3914'>
         fac101 = fs * fac01(lay)<a name='3915'>
         fac111 = fs * fac11(lay)<a name='3916'>
         ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(21) + js<a name='3917'>
         ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(21) + js<a name='3918'>
         indf = indfor(lay)<a name='3919'>
         tauray = colmol(lay) * rayl<a name='3920'>
<a name='3921'>
         do ig = 1, ng21<a name='3922'>
            taug(lay,ngs20+ig) = speccomb * &amp;<a name='3923'>
                (fac000 * absb(ind0,ig) + &amp;<a name='3924'>
                 fac100 * absb(ind0+1,ig) + &amp;<a name='3925'>
                 fac010 * absb(ind0+5,ig) + &amp;<a name='3926'>
                 fac110 * absb(ind0+6,ig) + &amp;<a name='3927'>
                 fac001 * absb(ind1,ig) + &amp;<a name='3928'>
                 fac101 * absb(ind1+1,ig) + &amp;<a name='3929'>
                 fac011 * absb(ind1+5,ig) + &amp;<a name='3930'>
                 fac111 * absb(ind1+6,ig)) + &amp;<a name='3931'>
                 colh2o(lay) * &amp;<a name='3932'>
                 forfac(lay) * (forref(indf,ig) + &amp;<a name='3933'>
                 forfrac(lay) * &amp;<a name='3934'>
                 (forref(indf+1,ig) - forref(indf,ig)))<a name='3935'>
<font color=#447700>!            ssa(lay,ngs20+ig) = tauray/taug(lay,ngs20+ig)<a name='3936'></font>
            taur(lay,ngs20+ig) = tauray<a name='3937'>
         enddo<a name='3938'>
      enddo<a name='3939'>
<a name='3940'>
      end subroutine taumol21<a name='3941'>
<a name='3942'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3943'></font>
<A NAME='TAUMOL22'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL22' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3944'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol22</font> <A href='../../call_to/TAUMOL22.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL22.html' TARGET='index'>4</A><a name='3945'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3946'></font>
<font color=#447700>!<a name='3947'></font>
<font color=#447700>!     band 22:  7700-8050 cm-1 (low - h2o,o2; high - o2)<a name='3948'></font>
<font color=#447700>!<a name='3949'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3950'></font>
<a name='3951'>
<font color=#447700>! ------- Modules -------<a name='3952'></font>
<a name='3953'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_26">, only : ng22, ngs21<a name='3954'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG22'>rrsw_kg22</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG22_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3955'>
                            sfluxref, rayl, layreffr, strrat<a name='3956'>
<a name='3957'>
<font color=#447700>! ------- Declarations -------<a name='3958'></font>
<a name='3959'>
<font color=#447700>! Local<a name='3960'></font>
<a name='3961'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3962'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3963'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3964'>
                       tauray, o2adj, o2cont<a name='3965'>
<a name='3966'>
<font color=#447700>! The following factor is the ratio of total O2 band intensity (lines <a name='3967'></font>
<font color=#447700>! and Mate continuum) to O2 band intensity (line only).  It is needed<a name='3968'></font>
<font color=#447700>! to adjust the optical depths since the k's include only lines.<a name='3969'></font>
      o2adj = 1.6_rb<a name='3970'>
      <a name='3971'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='3972'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='3973'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='3974'></font>
<a name='3975'>
      laysolfr = laytrop<a name='3976'>
<a name='3977'>
<font color=#447700>! Lower atmosphere loop<a name='3978'></font>
      do lay = 1, laytrop<a name='3979'>
         if (jp(lay) .lt. layreffr .and. jp(lay+1) .ge. layreffr) &amp;<a name='3980'>
            laysolfr = min(lay+1,laytrop)<a name='3981'>
         o2cont = 4.35e-4_rb*colo2(lay)/(350.0_rb*2.0_rb)<a name='3982'>
         speccomb = colh2o(lay) + o2adj*strrat*colo2(lay)<a name='3983'>
         specparm = colh2o(lay)/speccomb <a name='3984'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3985'>
         specmult = 8._rb*(specparm)<a name='3986'>
<font color=#447700>!         odadj = specparm + o2adj * (1._rb - specparm)<a name='3987'></font>
         js = 1 + int(specmult)<a name='3988'>
         fs = mod(specmult, 1._rb )<a name='3989'>
         fac000 = (1._rb - fs) * fac00(lay)<a name='3990'>
         fac010 = (1._rb - fs) * fac10(lay)<a name='3991'>
         fac100 = fs * fac00(lay)<a name='3992'>
         fac110 = fs * fac10(lay)<a name='3993'>
         fac001 = (1._rb - fs) * fac01(lay)<a name='3994'>
         fac011 = (1._rb - fs) * fac11(lay)<a name='3995'>
         fac101 = fs * fac01(lay)<a name='3996'>
         fac111 = fs * fac11(lay)<a name='3997'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(22) + js<a name='3998'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(22) + js<a name='3999'>
         inds = indself(lay)<a name='4000'>
         indf = indfor(lay)<a name='4001'>
         tauray = colmol(lay) * rayl<a name='4002'>
<a name='4003'>
         do ig = 1, ng22<a name='4004'>
            taug(lay,ngs21+ig) = speccomb * &amp;<a name='4005'>
                (fac000 * absa(ind0,ig) + &amp;<a name='4006'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='4007'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='4008'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='4009'>
                 fac001 * absa(ind1,ig) + &amp;<a name='4010'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='4011'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='4012'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='4013'>
                 colh2o(lay) * &amp;<a name='4014'>
                 (selffac(lay) * (selfref(inds,ig) + &amp;<a name='4015'>
                 selffrac(lay) * &amp;<a name='4016'>
                  (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='4017'>
                 forfac(lay) * (forref(indf,ig) + &amp;<a name='4018'>
                 forfrac(lay) * &amp;<a name='4019'>
                 (forref(indf+1,ig) - forref(indf,ig)))) &amp;<a name='4020'>
                 + o2cont<a name='4021'>
<font color=#447700>!            ssa(lay,ngs21+ig) = tauray/taug(lay,ngs21+ig)<a name='4022'></font>
            if (lay .eq. laysolfr) sfluxzen(ngs21+ig) = sfluxref(ig,js) &amp;<a name='4023'>
                + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='4024'>
            taur(lay,ngs21+ig) = tauray<a name='4025'>
         enddo<a name='4026'>
      enddo<a name='4027'>
<a name='4028'>
<font color=#447700>! Upper atmosphere loop<a name='4029'></font>
      do lay = laytrop+1, nlayers<a name='4030'>
         o2cont = 4.35e-4_rb*colo2(lay)/(350.0_rb*2.0_rb)<a name='4031'>
         ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(22) + 1<a name='4032'>
         ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(22) + 1<a name='4033'>
         tauray = colmol(lay) * rayl<a name='4034'>
<a name='4035'>
         do ig = 1, ng22<a name='4036'>
            taug(lay,ngs21+ig) = colo2(lay) * o2adj * &amp;<a name='4037'>
                (fac00(lay) * absb(ind0,ig) + &amp;<a name='4038'>
                 fac10(lay) * absb(ind0+1,ig) + &amp;<a name='4039'>
                 fac01(lay) * absb(ind1,ig) + &amp;<a name='4040'>
                 fac11(lay) * absb(ind1+1,ig)) + &amp;<a name='4041'>
                 o2cont<a name='4042'>
<font color=#447700>!            ssa(lay,ngs21+ig) = tauray/taug(lay,ngs21+ig)<a name='4043'></font>
            taur(lay,ngs21+ig) = tauray<a name='4044'>
         enddo<a name='4045'>
      enddo<a name='4046'>
<a name='4047'>
      end subroutine taumol22<a name='4048'>
<a name='4049'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4050'></font>
<A NAME='TAUMOL23'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL23' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4051'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol23</font> <A href='../../call_to/TAUMOL23.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL23.html' TARGET='index'>4</A><a name='4052'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4053'></font>
<font color=#447700>!<a name='4054'></font>
<font color=#447700>!     band 23:  8050-12850 cm-1 (low - h2o; high - nothing)<a name='4055'></font>
<font color=#447700>!<a name='4056'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4057'></font>
<a name='4058'>
<font color=#447700>! ------- Modules -------<a name='4059'></font>
<a name='4060'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_27">, only : ng23, ngs22<a name='4061'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG23'>rrsw_kg23</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG23_1">, only : absa, ka, forref, selfref, &amp;<a name='4062'>
                            sfluxref, rayl, layreffr, givfac<a name='4063'>
<a name='4064'>
<font color=#447700>! ------- Declarations -------<a name='4065'></font>
<a name='4066'>
<font color=#447700>! Local<a name='4067'></font>
<a name='4068'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='4069'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4070'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4071'>
                       tauray<a name='4072'>
<a name='4073'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4074'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4075'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4076'></font>
<a name='4077'>
      laysolfr = laytrop<a name='4078'>
<a name='4079'>
<font color=#447700>! Lower atmosphere loop<a name='4080'></font>
      do lay = 1, laytrop<a name='4081'>
         if (jp(lay) .lt. layreffr .and. jp(lay+1) .ge. layreffr) &amp;<a name='4082'>
            laysolfr = min(lay+1,laytrop)<a name='4083'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(23) + 1<a name='4084'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(23) + 1<a name='4085'>
         inds = indself(lay)<a name='4086'>
         indf = indfor(lay)<a name='4087'>
<a name='4088'>
         do ig = 1, ng23<a name='4089'>
            tauray = colmol(lay) * rayl(ig)<a name='4090'>
            taug(lay,ngs22+ig) = colh2o(lay) * &amp;<a name='4091'>
                (givfac * (fac00(lay) * absa(ind0,ig) + &amp;<a name='4092'>
                 fac10(lay) * absa(ind0+1,ig) + &amp;<a name='4093'>
                 fac01(lay) * absa(ind1,ig) + &amp;<a name='4094'>
                 fac11(lay) * absa(ind1+1,ig)) + &amp;<a name='4095'>
                 selffac(lay) * (selfref(inds,ig) + &amp;<a name='4096'>
                 selffrac(lay) * &amp;<a name='4097'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='4098'>
                 forfac(lay) * (forref(indf,ig) + &amp;<a name='4099'>
                 forfrac(lay) * &amp;<a name='4100'>
                 (forref(indf+1,ig) - forref(indf,ig)))) <a name='4101'>
<font color=#447700>!            ssa(lay,ngs22+ig) = tauray/taug(lay,ngs22+ig)<a name='4102'></font>
            if (lay .eq. laysolfr) sfluxzen(ngs22+ig) = sfluxref(ig) <a name='4103'>
            taur(lay,ngs22+ig) = tauray<a name='4104'>
         enddo<a name='4105'>
      enddo<a name='4106'>
<a name='4107'>
<font color=#447700>! Upper atmosphere loop<a name='4108'></font>
      do lay = laytrop+1, nlayers<a name='4109'>
         do ig = 1, ng23<a name='4110'>
<font color=#447700>!            taug(lay,ngs22+ig) = colmol(lay) * rayl(ig)<a name='4111'></font>
<font color=#447700>!            ssa(lay,ngs22+ig) = 1.0_rb<a name='4112'></font>
            taug(lay,ngs22+ig) = 0._rb<a name='4113'>
            taur(lay,ngs22+ig) = colmol(lay) * rayl(ig) <a name='4114'>
         enddo<a name='4115'>
      enddo<a name='4116'>
<a name='4117'>
      end subroutine taumol23<a name='4118'>
<a name='4119'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4120'></font>
<A NAME='TAUMOL24'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL24' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4121'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol24</font> <A href='../../call_to/TAUMOL24.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL24.html' TARGET='index'>4</A><a name='4122'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4123'></font>
<font color=#447700>!<a name='4124'></font>
<font color=#447700>!     band 24:  12850-16000 cm-1 (low - h2o,o2; high - o2)<a name='4125'></font>
<font color=#447700>!<a name='4126'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4127'></font>
<a name='4128'>
<font color=#447700>! ------- Modules -------<a name='4129'></font>
<a name='4130'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_28">, only : ng24, ngs23<a name='4131'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG24'>rrsw_kg24</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG24_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='4132'>
                            sfluxref, abso3a, abso3b, rayla, raylb, &amp;<a name='4133'>
                            layreffr, strrat<a name='4134'>
<a name='4135'>
<font color=#447700>! ------- Declarations -------<a name='4136'></font>
<a name='4137'>
<font color=#447700>! Local<a name='4138'></font>
<a name='4139'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='4140'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4141'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4142'>
                       tauray<a name='4143'>
<a name='4144'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4145'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4146'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4147'></font>
<a name='4148'>
      laysolfr = laytrop<a name='4149'>
<a name='4150'>
<font color=#447700>! Lower atmosphere loop<a name='4151'></font>
      do lay = 1, laytrop<a name='4152'>
         if (jp(lay) .lt. layreffr .and. jp(lay+1) .ge. layreffr) &amp;<a name='4153'>
            laysolfr = min(lay+1,laytrop)<a name='4154'>
         speccomb = colh2o(lay) + strrat*colo2(lay)<a name='4155'>
         specparm = colh2o(lay)/speccomb <a name='4156'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='4157'>
         specmult = 8._rb*(specparm)<a name='4158'>
         js = 1 + int(specmult)<a name='4159'>
         fs = mod(specmult, 1._rb )<a name='4160'>
         fac000 = (1._rb - fs) * fac00(lay)<a name='4161'>
         fac010 = (1._rb - fs) * fac10(lay)<a name='4162'>
         fac100 = fs * fac00(lay)<a name='4163'>
         fac110 = fs * fac10(lay)<a name='4164'>
         fac001 = (1._rb - fs) * fac01(lay)<a name='4165'>
         fac011 = (1._rb - fs) * fac11(lay)<a name='4166'>
         fac101 = fs * fac01(lay)<a name='4167'>
         fac111 = fs * fac11(lay)<a name='4168'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(24) + js<a name='4169'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(24) + js<a name='4170'>
         inds = indself(lay)<a name='4171'>
         indf = indfor(lay)<a name='4172'>
<a name='4173'>
         do ig = 1, ng24<a name='4174'>
            tauray = colmol(lay) * (rayla(ig,js) + &amp;<a name='4175'>
               fs * (rayla(ig,js+1) - rayla(ig,js)))<a name='4176'>
            taug(lay,ngs23+ig) = speccomb * &amp;<a name='4177'>
                (fac000 * absa(ind0,ig) + &amp;<a name='4178'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='4179'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='4180'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='4181'>
                 fac001 * absa(ind1,ig) + &amp;<a name='4182'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='4183'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='4184'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='4185'>
                 colo3(lay) * abso3a(ig) + &amp;<a name='4186'>
                 colh2o(lay) * &amp; <a name='4187'>
                 (selffac(lay) * (selfref(inds,ig) + &amp;<a name='4188'>
                 selffrac(lay) * &amp;<a name='4189'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='4190'>
                 forfac(lay) * (forref(indf,ig) + &amp; <a name='4191'>
                 forfrac(lay) * &amp;<a name='4192'>
                 (forref(indf+1,ig) - forref(indf,ig))))<a name='4193'>
<font color=#447700>!            ssa(lay,ngs23+ig) = tauray/taug(lay,ngs23+ig)<a name='4194'></font>
            if (lay .eq. laysolfr) sfluxzen(ngs23+ig) = sfluxref(ig,js) &amp;<a name='4195'>
               + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='4196'>
            taur(lay,ngs23+ig) = tauray<a name='4197'>
         enddo<a name='4198'>
      enddo<a name='4199'>
<a name='4200'>
<font color=#447700>! Upper atmosphere loop<a name='4201'></font>
      do lay = laytrop+1, nlayers<a name='4202'>
         ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(24) + 1<a name='4203'>
         ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(24) + 1<a name='4204'>
<a name='4205'>
         do ig = 1, ng24<a name='4206'>
            tauray = colmol(lay) * raylb(ig)<a name='4207'>
            taug(lay,ngs23+ig) = colo2(lay) * &amp;<a name='4208'>
                (fac00(lay) * absb(ind0,ig) + &amp;<a name='4209'>
                 fac10(lay) * absb(ind0+1,ig) + &amp;<a name='4210'>
                 fac01(lay) * absb(ind1,ig) + &amp;<a name='4211'>
                 fac11(lay) * absb(ind1+1,ig)) + &amp;<a name='4212'>
                 colo3(lay) * abso3b(ig)<a name='4213'>
<font color=#447700>!            ssa(lay,ngs23+ig) = tauray/taug(lay,ngs23+ig)<a name='4214'></font>
            taur(lay,ngs23+ig) = tauray<a name='4215'>
         enddo<a name='4216'>
      enddo<a name='4217'>
<a name='4218'>
      end subroutine taumol24<a name='4219'>
<a name='4220'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4221'></font>
<A NAME='TAUMOL25'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL25' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4222'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol25</font> <A href='../../call_to/TAUMOL25.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL25.html' TARGET='index'>4</A><a name='4223'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4224'></font>
<font color=#447700>!<a name='4225'></font>
<font color=#447700>!     band 25:  16000-22650 cm-1 (low - h2o; high - nothing)<a name='4226'></font>
<font color=#447700>!<a name='4227'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4228'></font>
<a name='4229'>
<font color=#447700>! ------- Modules -------<a name='4230'></font>
<a name='4231'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_29">, only : ng25, ngs24<a name='4232'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG25'>rrsw_kg25</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG25_1">, only : absa, ka, &amp;<a name='4233'>
                            sfluxref, abso3a, abso3b, rayl, layreffr<a name='4234'>
<a name='4235'>
<font color=#447700>! ------- Declarations -------<a name='4236'></font>
<a name='4237'>
<font color=#447700>! Local<a name='4238'></font>
<a name='4239'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='4240'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4241'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4242'>
                       tauray<a name='4243'>
<a name='4244'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4245'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4246'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4247'></font>
<a name='4248'>
      laysolfr = laytrop<a name='4249'>
<a name='4250'>
<font color=#447700>! Lower atmosphere loop<a name='4251'></font>
      do lay = 1, laytrop<a name='4252'>
         if (jp(lay) .lt. layreffr .and. jp(lay+1) .ge. layreffr) &amp;<a name='4253'>
            laysolfr = min(lay+1,laytrop)<a name='4254'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(25) + 1<a name='4255'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(25) + 1<a name='4256'>
<a name='4257'>
         do ig = 1, ng25<a name='4258'>
            tauray = colmol(lay) * rayl(ig)<a name='4259'>
            taug(lay,ngs24+ig) = colh2o(lay) * &amp;<a name='4260'>
                (fac00(lay) * absa(ind0,ig) + &amp;<a name='4261'>
                 fac10(lay) * absa(ind0+1,ig) + &amp;<a name='4262'>
                 fac01(lay) * absa(ind1,ig) + &amp;<a name='4263'>
                 fac11(lay) * absa(ind1+1,ig)) + &amp;<a name='4264'>
                 colo3(lay) * abso3a(ig) <a name='4265'>
<font color=#447700>!            ssa(lay,ngs24+ig) = tauray/taug(lay,ngs24+ig)<a name='4266'></font>
            if (lay .eq. laysolfr) sfluxzen(ngs24+ig) = sfluxref(ig) <a name='4267'>
            taur(lay,ngs24+ig) = tauray<a name='4268'>
         enddo<a name='4269'>
      enddo<a name='4270'>
<a name='4271'>
<font color=#447700>! Upper atmosphere loop<a name='4272'></font>
      do lay = laytrop+1, nlayers<a name='4273'>
         do ig = 1, ng25<a name='4274'>
            tauray = colmol(lay) * rayl(ig)<a name='4275'>
            taug(lay,ngs24+ig) = colo3(lay) * abso3b(ig) <a name='4276'>
<font color=#447700>!            ssa(lay,ngs24+ig) = tauray/taug(lay,ngs24+ig)<a name='4277'></font>
            taur(lay,ngs24+ig) = tauray<a name='4278'>
         enddo<a name='4279'>
      enddo<a name='4280'>
<a name='4281'>
      end subroutine taumol25<a name='4282'>
<a name='4283'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4284'></font>
<A NAME='TAUMOL26'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL26' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4285'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol26</font> <A href='../../call_to/TAUMOL26.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL26.html' TARGET='index'>4</A><a name='4286'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4287'></font>
<font color=#447700>!<a name='4288'></font>
<font color=#447700>!     band 26:  22650-29000 cm-1 (low - nothing; high - nothing)<a name='4289'></font>
<font color=#447700>!<a name='4290'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4291'></font>
<a name='4292'>
<font color=#447700>! ------- Modules -------<a name='4293'></font>
<a name='4294'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_30">, only : ng26, ngs25<a name='4295'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG26'>rrsw_kg26</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG26_1">, only : sfluxref, rayl<a name='4296'>
<a name='4297'>
<font color=#447700>! ------- Declarations -------<a name='4298'></font>
<a name='4299'>
<font color=#447700>! Local<a name='4300'></font>
<a name='4301'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='4302'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4303'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4304'>
                       tauray<a name='4305'>
<a name='4306'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4307'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4308'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4309'></font>
<a name='4310'>
      laysolfr = laytrop<a name='4311'>
<a name='4312'>
<font color=#447700>! Lower atmosphere loop<a name='4313'></font>
      do lay = 1, laytrop<a name='4314'>
         do ig = 1, ng26 <a name='4315'>
<font color=#447700>!            taug(lay,ngs25+ig) = colmol(lay) * rayl(ig)<a name='4316'></font>
<font color=#447700>!            ssa(lay,ngs25+ig) = 1.0_rb<a name='4317'></font>
            if (lay .eq. laysolfr) sfluxzen(ngs25+ig) = sfluxref(ig) <a name='4318'>
            taug(lay,ngs25+ig) = 0._rb<a name='4319'>
            taur(lay,ngs25+ig) = colmol(lay) * rayl(ig) <a name='4320'>
         enddo<a name='4321'>
      enddo<a name='4322'>
<a name='4323'>
<font color=#447700>! Upper atmosphere loop<a name='4324'></font>
      do lay = laytrop+1, nlayers<a name='4325'>
         do ig = 1, ng26<a name='4326'>
<font color=#447700>!            taug(lay,ngs25+ig) = colmol(lay) * rayl(ig)<a name='4327'></font>
<font color=#447700>!            ssa(lay,ngs25+ig) = 1.0_rb<a name='4328'></font>
            taug(lay,ngs25+ig) = 0._rb<a name='4329'>
            taur(lay,ngs25+ig) = colmol(lay) * rayl(ig) <a name='4330'>
         enddo<a name='4331'>
      enddo<a name='4332'>
<a name='4333'>
      end subroutine taumol26<a name='4334'>
<a name='4335'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4336'></font>
<A NAME='TAUMOL27'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL27' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4337'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol27</font> <A href='../../call_to/TAUMOL27.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL27.html' TARGET='index'>4</A><a name='4338'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4339'></font>
<font color=#447700>!<a name='4340'></font>
<font color=#447700>!     band 27:  29000-38000 cm-1 (low - o3; high - o3)<a name='4341'></font>
<font color=#447700>!<a name='4342'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4343'></font>
<a name='4344'>
<font color=#447700>! ------- Modules -------<a name='4345'></font>
<a name='4346'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_31">, only : ng27, ngs26<a name='4347'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG27'>rrsw_kg27</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG27_1">, only : absa, ka, absb, kb, &amp;<a name='4348'>
                            sfluxref, rayl, layreffr, scalekur<a name='4349'>
<a name='4350'>
<font color=#447700>! ------- Declarations -------<a name='4351'></font>
<a name='4352'>
<font color=#447700>! Local<a name='4353'></font>
<a name='4354'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='4355'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4356'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4357'>
                       tauray<a name='4358'>
<a name='4359'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4360'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4361'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4362'></font>
<a name='4363'>
<font color=#447700>! Lower atmosphere loop<a name='4364'></font>
      do lay = 1, laytrop<a name='4365'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(27) + 1<a name='4366'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(27) + 1<a name='4367'>
<a name='4368'>
         do ig = 1, ng27<a name='4369'>
            tauray = colmol(lay) * rayl(ig)<a name='4370'>
            taug(lay,ngs26+ig) = colo3(lay) * &amp;<a name='4371'>
                (fac00(lay) * absa(ind0,ig) + &amp;<a name='4372'>
                 fac10(lay) * absa(ind0+1,ig) + &amp;<a name='4373'>
                 fac01(lay) * absa(ind1,ig) + &amp;<a name='4374'>
                 fac11(lay) * absa(ind1+1,ig))<a name='4375'>
<font color=#447700>!            ssa(lay,ngs26+ig) = tauray/taug(lay,ngs26+ig)<a name='4376'></font>
            taur(lay,ngs26+ig) = tauray<a name='4377'>
         enddo<a name='4378'>
      enddo<a name='4379'>
<a name='4380'>
      laysolfr = nlayers<a name='4381'>
<a name='4382'>
<font color=#447700>! Upper atmosphere loop<a name='4383'></font>
      do lay = laytrop+1, nlayers<a name='4384'>
         if (jp(lay-1) .lt. layreffr .and. jp(lay) .ge. layreffr) &amp;<a name='4385'>
            laysolfr = lay<a name='4386'>
         ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(27) + 1<a name='4387'>
         ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(27) + 1<a name='4388'>
<a name='4389'>
         do ig = 1, ng27<a name='4390'>
            tauray = colmol(lay) * rayl(ig)<a name='4391'>
            taug(lay,ngs26+ig) = colo3(lay) * &amp;<a name='4392'>
                (fac00(lay) * absb(ind0,ig) + &amp;<a name='4393'>
                 fac10(lay) * absb(ind0+1,ig) + &amp;<a name='4394'>
                 fac01(lay) * absb(ind1,ig) + &amp; <a name='4395'>
                 fac11(lay) * absb(ind1+1,ig))<a name='4396'>
<font color=#447700>!            ssa(lay,ngs26+ig) = tauray/taug(lay,ngs26+ig)<a name='4397'></font>
            if (lay.eq.laysolfr) sfluxzen(ngs26+ig) = scalekur * sfluxref(ig) <a name='4398'>
            taur(lay,ngs26+ig) = tauray<a name='4399'>
         enddo<a name='4400'>
      enddo<a name='4401'>
<a name='4402'>
      end subroutine taumol27<a name='4403'>
<a name='4404'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4405'></font>
<A NAME='TAUMOL28'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL28' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4406'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol28</font> <A href='../../call_to/TAUMOL28.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL28.html' TARGET='index'>4</A><a name='4407'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4408'></font>
<font color=#447700>!<a name='4409'></font>
<font color=#447700>!     band 28:  38000-50000 cm-1 (low - o3,o2; high - o3,o2)<a name='4410'></font>
<font color=#447700>!<a name='4411'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4412'></font>
<a name='4413'>
<font color=#447700>! ------- Modules -------<a name='4414'></font>
<a name='4415'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_32">, only : ng28, ngs27<a name='4416'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG28'>rrsw_kg28</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG28_1">, only : absa, ka, absb, kb, &amp;<a name='4417'>
                            sfluxref, rayl, layreffr, strrat<a name='4418'>
<a name='4419'>
<font color=#447700>! ------- Declarations -------<a name='4420'></font>
<a name='4421'>
<font color=#447700>! Local<a name='4422'></font>
<a name='4423'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='4424'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4425'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4426'>
                       tauray<a name='4427'>
<a name='4428'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4429'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4430'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4431'></font>
<a name='4432'>
<font color=#447700>! Lower atmosphere loop<a name='4433'></font>
      do lay = 1, laytrop<a name='4434'>
         speccomb = colo3(lay) + strrat*colo2(lay)<a name='4435'>
         specparm = colo3(lay)/speccomb <a name='4436'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='4437'>
         specmult = 8._rb*(specparm)<a name='4438'>
         js = 1 + int(specmult)<a name='4439'>
         fs = mod(specmult, 1._rb )<a name='4440'>
         fac000 = (1._rb - fs) * fac00(lay)<a name='4441'>
         fac010 = (1._rb - fs) * fac10(lay)<a name='4442'>
         fac100 = fs * fac00(lay)<a name='4443'>
         fac110 = fs * fac10(lay)<a name='4444'>
         fac001 = (1._rb - fs) * fac01(lay)<a name='4445'>
         fac011 = (1._rb - fs) * fac11(lay)<a name='4446'>
         fac101 = fs * fac01(lay)<a name='4447'>
         fac111 = fs * fac11(lay)<a name='4448'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(28) + js<a name='4449'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(28) + js<a name='4450'>
         tauray = colmol(lay) * rayl<a name='4451'>
<a name='4452'>
         do ig = 1, ng28<a name='4453'>
            taug(lay,ngs27+ig) = speccomb * &amp;<a name='4454'>
                (fac000 * absa(ind0,ig) + &amp;<a name='4455'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='4456'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='4457'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='4458'>
                 fac001 * absa(ind1,ig) + &amp;<a name='4459'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='4460'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='4461'>
                 fac111 * absa(ind1+10,ig)) <a name='4462'>
<font color=#447700>!            ssa(lay,ngs27+ig) = tauray/taug(lay,ngs27+ig)<a name='4463'></font>
            taur(lay,ngs27+ig) = tauray<a name='4464'>
         enddo<a name='4465'>
      enddo<a name='4466'>
<a name='4467'>
      laysolfr = nlayers<a name='4468'>
<a name='4469'>
<font color=#447700>! Upper atmosphere loop<a name='4470'></font>
      do lay = laytrop+1, nlayers<a name='4471'>
         if (jp(lay-1) .lt. layreffr .and. jp(lay) .ge. layreffr) &amp;<a name='4472'>
            laysolfr = lay<a name='4473'>
         speccomb = colo3(lay) + strrat*colo2(lay)<a name='4474'>
         specparm = colo3(lay)/speccomb <a name='4475'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='4476'>
         specmult = 4._rb*(specparm)<a name='4477'>
         js = 1 + int(specmult)<a name='4478'>
         fs = mod(specmult, 1._rb )<a name='4479'>
         fac000 = (1._rb - fs) * fac00(lay)<a name='4480'>
         fac010 = (1._rb - fs) * fac10(lay)<a name='4481'>
         fac100 = fs * fac00(lay)<a name='4482'>
         fac110 = fs * fac10(lay)<a name='4483'>
         fac001 = (1._rb - fs) * fac01(lay)<a name='4484'>
         fac011 = (1._rb - fs) * fac11(lay)<a name='4485'>
         fac101 = fs * fac01(lay)<a name='4486'>
         fac111 = fs * fac11(lay)<a name='4487'>
         ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(28) + js<a name='4488'>
         ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(28) + js<a name='4489'>
         tauray = colmol(lay) * rayl<a name='4490'>
<a name='4491'>
         do ig = 1, ng28<a name='4492'>
            taug(lay,ngs27+ig) = speccomb * &amp;<a name='4493'>
                (fac000 * absb(ind0,ig) + &amp;<a name='4494'>
                 fac100 * absb(ind0+1,ig) + &amp;<a name='4495'>
                 fac010 * absb(ind0+5,ig) + &amp;<a name='4496'>
                 fac110 * absb(ind0+6,ig) + &amp;<a name='4497'>
                 fac001 * absb(ind1,ig) + &amp;<a name='4498'>
                 fac101 * absb(ind1+1,ig) + &amp;<a name='4499'>
                 fac011 * absb(ind1+5,ig) + &amp;<a name='4500'>
                 fac111 * absb(ind1+6,ig)) <a name='4501'>
<font color=#447700>!            ssa(lay,ngs27+ig) = tauray/taug(lay,ngs27+ig)<a name='4502'></font>
            if (lay .eq. laysolfr) sfluxzen(ngs27+ig) = sfluxref(ig,js) &amp;<a name='4503'>
               + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='4504'>
            taur(lay,ngs27+ig) = tauray<a name='4505'>
         enddo<a name='4506'>
      enddo<a name='4507'>
<a name='4508'>
      end subroutine taumol28<a name='4509'>
<a name='4510'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4511'></font>
<A NAME='TAUMOL29'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#TAUMOL29' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4512'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol29</font> <A href='../../call_to/TAUMOL29.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL29.html' TARGET='index'>4</A><a name='4513'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4514'></font>
<font color=#447700>!<a name='4515'></font>
<font color=#447700>!     band 29:  820-2600 cm-1 (low - h2o; high - co2)<a name='4516'></font>
<font color=#447700>!<a name='4517'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4518'></font>
<a name='4519'>
<font color=#447700>! ------- Modules -------<a name='4520'></font>
<a name='4521'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_33">, only : ng29, ngs28<a name='4522'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG29'>rrsw_kg29</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG29_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='4523'>
                            sfluxref, absh2o, absco2, rayl, layreffr<a name='4524'>
<a name='4525'>
<font color=#447700>! ------- Declarations -------<a name='4526'></font>
<a name='4527'>
<font color=#447700>! Local<a name='4528'></font>
<a name='4529'>
      integer(kind=im) :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='4530'>
      real(kind=rb) :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4531'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4532'>
                       tauray<a name='4533'>
<a name='4534'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4535'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4536'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4537'></font>
<a name='4538'>
<font color=#447700>! Lower atmosphere loop<a name='4539'></font>
      do lay = 1, laytrop<a name='4540'>
         ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(29) + 1<a name='4541'>
         ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(29) + 1<a name='4542'>
         inds = indself(lay)<a name='4543'>
         indf = indfor(lay)<a name='4544'>
         tauray = colmol(lay) * rayl<a name='4545'>
<a name='4546'>
         do ig = 1, ng29<a name='4547'>
            taug(lay,ngs28+ig) = colh2o(lay) * &amp;<a name='4548'>
               ((fac00(lay) * absa(ind0,ig) + &amp;<a name='4549'>
                 fac10(lay) * absa(ind0+1,ig) + &amp;<a name='4550'>
                 fac01(lay) * absa(ind1,ig) + &amp;<a name='4551'>
                 fac11(lay) * absa(ind1+1,ig)) + &amp;<a name='4552'>
                 selffac(lay) * (selfref(inds,ig) + &amp;<a name='4553'>
                 selffrac(lay) * &amp;<a name='4554'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='4555'>
                 forfac(lay) * (forref(indf,ig) + &amp; <a name='4556'>
                 forfrac(lay) * &amp;<a name='4557'>
                 (forref(indf+1,ig) - forref(indf,ig)))) &amp;<a name='4558'>
                 + colco2(lay) * absco2(ig) <a name='4559'>
<font color=#447700>!            ssa(lay,ngs28+ig) = tauray/taug(lay,ngs28+ig)<a name='4560'></font>
            taur(lay,ngs28+ig) = tauray<a name='4561'>
         enddo<a name='4562'>
      enddo<a name='4563'>
<a name='4564'>
      laysolfr = nlayers<a name='4565'>
<a name='4566'>
<font color=#447700>! Upper atmosphere loop<a name='4567'></font>
      do lay = laytrop+1, nlayers<a name='4568'>
         if (jp(lay-1) .lt. layreffr .and. jp(lay) .ge. layreffr) &amp;<a name='4569'>
            laysolfr = lay<a name='4570'>
         ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(29) + 1<a name='4571'>
         ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(29) + 1<a name='4572'>
         tauray = colmol(lay) * rayl<a name='4573'>
<a name='4574'>
         do ig = 1, ng29<a name='4575'>
            taug(lay,ngs28+ig) = colco2(lay) * &amp;<a name='4576'>
                (fac00(lay) * absb(ind0,ig) + &amp;<a name='4577'>
                 fac10(lay) * absb(ind0+1,ig) + &amp;<a name='4578'>
                 fac01(lay) * absb(ind1,ig) + &amp;<a name='4579'>
                 fac11(lay) * absb(ind1+1,ig)) &amp;  <a name='4580'>
                 + colh2o(lay) * absh2o(ig) <a name='4581'>
<font color=#447700>!            ssa(lay,ngs28+ig) = tauray/taug(lay,ngs28+ig)<a name='4582'></font>
            if (lay .eq. laysolfr) sfluxzen(ngs28+ig) = sfluxref(ig) <a name='4583'>
            taur(lay,ngs28+ig) = tauray<a name='4584'>
         enddo<a name='4585'>
      enddo<a name='4586'>
<a name='4587'>
      end subroutine taumol29<a name='4588'>
<a name='4589'>
      end subroutine taumol_sw<a name='4590'>
<a name='4591'>
      end module rrtmg_sw_taumol<a name='4592'>
<a name='4593'>
<font color=#447700>!     path:      $Source: /cvsroot/NWP/WRFV3/phys/module_ra_rrtmg_sw.F,v $<a name='4594'></font>
<font color=#447700>!     author:    $Author: trn $<a name='4595'></font>
<font color=#447700>!     revision:  $Revision: 1.3 $<a name='4596'></font>
<font color=#447700>!     created:   $Date: 2009/04/16 19:54:22 $<a name='4597'></font>
<a name='4598'>
<A NAME='RRTMG_SW_INIT'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_INIT' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='4599'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_init</font> <A href='../../call_to/RRTMG_SW_INIT.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_INIT.html' TARGET='index'>3</A><a name='4600'>
<a name='4601'>
<font color=#447700>!  --------------------------------------------------------------------------<a name='4602'></font>
<font color=#447700>! |                                                                          |<a name='4603'></font>
<font color=#447700>! |  Copyright 2002-2008, Atmospheric &amp; Environmental Research, Inc. (AER).  |<a name='4604'></font>
<font color=#447700>! |  This software may be used, copied, or redistributed as long as it is    |<a name='4605'></font>
<font color=#447700>! |  not sold and this copyright notice is reproduced on each copy made.     |<a name='4606'></font>
<font color=#447700>! |  This model is provided as is without any express or implied warranties. |<a name='4607'></font>
<font color=#447700>! |                       (http://www.rtweb.aer.com/)                        |<a name='4608'></font>
<font color=#447700>! |                                                                          |<a name='4609'></font>
<font color=#447700>!  --------------------------------------------------------------------------<a name='4610'></font>
<a name='4611'>
<font color=#447700>! ------- Modules -------<a name='4612'></font>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_58">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='4613'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_WVN'>rrsw_wvn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_4"><a name='4614'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SETCOEF'>rrtmg_sw_setcoef</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_INIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_SETCOEF_1">, only: swatmref<a name='4615'>
<a name='4616'>
      implicit none<a name='4617'>
<a name='4618'>
      contains<a name='4619'>
<a name='4620'>
<font color=#447700>! **************************************************************************<a name='4621'></font>
<A NAME='RRTMG_SW_INI'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_INI' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4622'>
      <font color=#993300>subroutine </font><font color=#cc0000>rrtmg_sw_ini</font>(cpdair) <A href='../../call_to/RRTMG_SW_INI.html' TARGET='index'>2</A>,<A href='../../call_from/RRTMG_SW_INI.html' TARGET='index'>44</A><a name='4623'>
<font color=#447700>! **************************************************************************<a name='4624'></font>
<font color=#447700>!<a name='4625'></font>
<font color=#447700>!  Original version:   Michael J. Iacono; February, 2004<a name='4626'></font>
<font color=#447700>!  Revision for F90 formatting:  M. J. Iacono, July, 2006<a name='4627'></font>
<font color=#447700>!<a name='4628'></font>
<font color=#447700>!  This subroutine performs calculations necessary for the initialization<a name='4629'></font>
<font color=#447700>!  of the shortwave model.  Lookup tables are computed for use in the SW<a name='4630'></font>
<font color=#447700>!  radiative transfer, and input absorption coefficient data for each<a name='4631'></font>
<font color=#447700>!  spectral band are reduced from 224 g-point intervals to 112.<a name='4632'></font>
<font color=#447700>! **************************************************************************<a name='4633'></font>
<a name='4634'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_34">, only : mg, nbndsw, ngptsw<a name='4635'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_TBL'>rrsw_tbl</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_TBL_2">, only: ntbl, tblint, pade, bpade, tau_tbl, exp_tbl<a name='4636'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_VSN'>rrsw_vsn</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_6">, only: hvrini, hnamini<a name='4637'>
<a name='4638'>
      real(kind=rb), intent(in) :: cpdair     <font color=#447700>! Specific heat capacity of dry air<a name='4639'></font>
                                              <font color=#447700>! at constant pressure at 273 K<a name='4640'></font>
                                              <font color=#447700>! (J kg-1 K-1)<a name='4641'></font>
<a name='4642'>
<font color=#447700>! ------- Local -------<a name='4643'></font>
<a name='4644'>
      integer(kind=im) :: ibnd, igc, ig, ind, ipr<a name='4645'>
      integer(kind=im) :: igcsm, iprsm<a name='4646'>
      integer(kind=im) :: itr<a name='4647'>
<a name='4648'>
      real(kind=rb) :: wtsum, wtsm(mg)<a name='4649'>
      real(kind=rb) :: tfn<a name='4650'>
<a name='4651'>
      real(kind=rb), parameter :: expeps = 1.e-20   <font color=#447700>! Smallest value for exponential table<a name='4652'></font>
<a name='4653'>
<font color=#447700>! ------- Definitions -------<a name='4654'></font>
<font color=#447700>!     Arrays for 10000-point look-up tables:<a name='4655'></font>
<font color=#447700>!     TAU_TBL  Clear-sky optical depth <a name='4656'></font>
<font color=#447700>!     EXP_TBL  Exponential lookup table for transmittance<a name='4657'></font>
<font color=#447700>!     PADE     Pade approximation constant (= 0.278)<a name='4658'></font>
<font color=#447700>!     BPADE    Inverse of the Pade approximation constant<a name='4659'></font>
<font color=#447700>!<a name='4660'></font>
<a name='4661'>
<font color=#447700>!jm not thread safe      hvrini = '$Revision: 1.3 $'<a name='4662'></font>
<a name='4663'>
<font color=#447700>! Initialize model data<a name='4664'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWDATINIT'>swdatinit</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SWDATINIT_1">(cpdair)<a name='4665'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWCMBDAT'>swcmbdat</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SWCMBDAT_1">              <font color=#447700>! g-point interval reduction data<a name='4666'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWAERPR'>swaerpr</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SWAERPR_1">               <font color=#447700>! aerosol optical properties<a name='4667'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWCLDPR'>swcldpr</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SWCLDPR_1">               <font color=#447700>! cloud optical properties<a name='4668'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWATMREF'>swatmref</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SWATMREF_1">              <font color=#447700>! reference MLS profile<a name='4669'></font>
<font color=#447700>! Moved to module_ra_rrtmg_sw for WRF<a name='4670'></font>
<font color=#447700>!      call sw_kgb16              ! molecular absorption coefficients<a name='4671'></font>
<font color=#447700>!      call sw_kgb17<a name='4672'></font>
<font color=#447700>!      call sw_kgb18<a name='4673'></font>
<font color=#447700>!      call sw_kgb19<a name='4674'></font>
<font color=#447700>!      call sw_kgb20<a name='4675'></font>
<font color=#447700>!      call sw_kgb21<a name='4676'></font>
<font color=#447700>!      call sw_kgb22<a name='4677'></font>
<font color=#447700>!      call sw_kgb23<a name='4678'></font>
<font color=#447700>!      call sw_kgb24<a name='4679'></font>
<font color=#447700>!      call sw_kgb25<a name='4680'></font>
<font color=#447700>!      call sw_kgb26<a name='4681'></font>
<font color=#447700>!      call sw_kgb27<a name='4682'></font>
<font color=#447700>!      call sw_kgb28<a name='4683'></font>
<font color=#447700>!      call sw_kgb29<a name='4684'></font>
<a name='4685'>
<font color=#447700>! Define exponential lookup tables for transmittance. Tau is<a name='4686'></font>
<font color=#447700>! computed as a function of the tau transition function, and transmittance <a name='4687'></font>
<font color=#447700>! is calculated as a function of tau.  All tables are computed at intervals <a name='4688'></font>
<font color=#447700>! of 0.0001.  The inverse of the constant used in the Pade approximation to <a name='4689'></font>
<font color=#447700>! the tau transition function is set to bpade.<a name='4690'></font>
<a name='4691'>
      exp_tbl(0) = 1.0_rb<a name='4692'>
      exp_tbl(ntbl) = expeps<a name='4693'>
      bpade = 1.0_rb / pade<a name='4694'>
      do itr = 1, ntbl-1<a name='4695'>
         tfn = float(itr) / float(ntbl)<a name='4696'>
         tau_tbl = bpade * tfn / (1._rb - tfn)<a name='4697'>
         exp_tbl(itr) = exp(-tau_tbl)<a name='4698'>
         if (exp_tbl(itr) .le. expeps) exp_tbl(itr) = expeps<a name='4699'>
      enddo<a name='4700'>
<a name='4701'>
<font color=#447700>! Perform g-point reduction from 16 per band (224 total points) to<a name='4702'></font>
<font color=#447700>! a band dependent number (112 total points) for all absorption<a name='4703'></font>
<font color=#447700>! coefficient input data and Planck fraction input data.<a name='4704'></font>
<font color=#447700>! Compute relative weighting for new g-point combinations.<a name='4705'></font>
<a name='4706'>
      igcsm = 0<a name='4707'>
      do ibnd = 1,nbndsw<a name='4708'>
         iprsm = 0<a name='4709'>
         if (ngc(ibnd).lt.mg) then<a name='4710'>
            do igc = 1,ngc(ibnd)<a name='4711'>
               igcsm = igcsm + 1<a name='4712'>
               wtsum = 0.<a name='4713'>
               do ipr = 1, ngn(igcsm)<a name='4714'>
                  iprsm = iprsm + 1<a name='4715'>
                  wtsum = wtsum + wt(iprsm)<a name='4716'>
               enddo<a name='4717'>
               wtsm(igc) = wtsum<a name='4718'>
            enddo<a name='4719'>
            do ig = 1, ng(ibnd+15)<a name='4720'>
               ind = (ibnd-1)*mg + ig<a name='4721'>
               rwgt(ind) = wt(ig)/wtsm(ngm(ind))<a name='4722'>
            enddo<a name='4723'>
         else<a name='4724'>
            do ig = 1, ng(ibnd+15)<a name='4725'>
               igcsm = igcsm + 1<a name='4726'>
               ind = (ibnd-1)*mg + ig<a name='4727'>
               rwgt(ind) = 1.0_rb<a name='4728'>
            enddo<a name='4729'>
         endif<a name='4730'>
      enddo<a name='4731'>
<a name='4732'>
<font color=#447700>! Reduce g-points for absorption coefficient data in each LW spectral band.<a name='4733'></font>
<a name='4734'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB16S'>cmbgb16s</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB16S_1"><a name='4735'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB17'>cmbgb17</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB17_1"><a name='4736'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB18'>cmbgb18</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB18_1"><a name='4737'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB19'>cmbgb19</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB19_1"><a name='4738'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB20'>cmbgb20</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB20_1"><a name='4739'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB21'>cmbgb21</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB21_1"><a name='4740'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB22'>cmbgb22</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB22_1"><a name='4741'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB23'>cmbgb23</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB23_1"><a name='4742'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB24'>cmbgb24</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB24_1"><a name='4743'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB25'>cmbgb25</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB25_1"><a name='4744'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB26'>cmbgb26</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB26_1"><a name='4745'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB27'>cmbgb27</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB27_1"><a name='4746'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB28'>cmbgb28</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB28_1"><a name='4747'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB29'>cmbgb29</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB29_1"><a name='4748'>
<a name='4749'>
      end subroutine rrtmg_sw_ini<a name='4750'>
<a name='4751'>
<font color=#447700>!***************************************************************************<a name='4752'></font>
<A NAME='SWDATINIT'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SWDATINIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4753'>
      <font color=#993300>subroutine </font><font color=#cc0000>swdatinit</font>(cpdair) <A href='../../call_to/SWDATINIT.html' TARGET='index'>2</A>,<A href='../../call_from/SWDATINIT.html' TARGET='index'>4</A><a name='4754'>
<font color=#447700>!***************************************************************************<a name='4755'></font>
<a name='4756'>
<font color=#447700>! --------- Modules ----------<a name='4757'></font>
<a name='4758'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_CON'>rrsw_con</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWDATINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CON_3">, only: heatfac, grav, planck, boltz, &amp;<a name='4759'>
                          clight, avogad, alosmt, gascon, radcn1, radcn2, &amp;<a name='4760'>
                          sbcnst, secdy, oneminus, pi<a name='4761'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_VSN'>rrsw_vsn</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWDATINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_7"><a name='4762'>
<a name='4763'>
      save <a name='4764'>
 <a name='4765'>
      real(kind=rb), intent(in) :: cpdair     <font color=#447700>! Specific heat capacity of dry air<a name='4766'></font>
                                              <font color=#447700>! at constant pressure at 273 K<a name='4767'></font>
                                              <font color=#447700>! (J kg-1 K-1)<a name='4768'></font>
<a name='4769'>
<font color=#447700>! Shortwave spectral band limits (wavenumbers)<a name='4770'></font>
      wavenum1(:) = (/2600._rb, 3250._rb, 4000._rb, 4650._rb, 5150._rb, 6150._rb, 7700._rb, &amp;<a name='4771'>
                      8050._rb,12850._rb,16000._rb,22650._rb,29000._rb,38000._rb,  820._rb/)<a name='4772'>
      wavenum2(:) = (/3250._rb, 4000._rb, 4650._rb, 5150._rb, 6150._rb, 7700._rb, 8050._rb, &amp;<a name='4773'>
                     12850._rb,16000._rb,22650._rb,29000._rb,38000._rb,50000._rb, 2600._rb/)<a name='4774'>
      delwave(:) =  (/ 650._rb,  750._rb,  650._rb,  500._rb, 1000._rb, 1550._rb,  350._rb, &amp;<a name='4775'>
                      4800._rb, 3150._rb, 6650._rb, 6350._rb, 9000._rb,12000._rb, 1780._rb/)<a name='4776'>
<a name='4777'>
<font color=#447700>! Spectral band information<a name='4778'></font>
      ng(:) = (/16,16,16,16,16,16,16,16,16,16,16,16,16,16/)<a name='4779'>
      nspa(:) = (/9,9,9,9,1,9,9,1,9,1,0,1,9,1/)<a name='4780'>
      nspb(:) = (/1,5,1,1,1,5,1,0,1,0,0,1,5,1/)<a name='4781'>
<a name='4782'>
<font color=#447700>! Fundamental physical constants from NIST 2002<a name='4783'></font>
<a name='4784'>
      grav = 9.8066_rb                        <font color=#447700>! Acceleration of gravity<a name='4785'></font>
                                              <font color=#447700>! (m s-2)<a name='4786'></font>
      planck = 6.62606876e-27_rb              <font color=#447700>! Planck constant<a name='4787'></font>
                                              <font color=#447700>! (ergs s; g cm2 s-1)<a name='4788'></font>
      boltz = 1.3806503e-16_rb                <font color=#447700>! Boltzmann constant<a name='4789'></font>
                                              <font color=#447700>! (ergs K-1; g cm2 s-2 K-1)<a name='4790'></font>
      clight = 2.99792458e+10_rb              <font color=#447700>! Speed of light in a vacuum  <a name='4791'></font>
                                              <font color=#447700>! (cm s-1)<a name='4792'></font>
      avogad = 6.02214199e+23_rb              <font color=#447700>! Avogadro constant<a name='4793'></font>
                                              <font color=#447700>! (mol-1)<a name='4794'></font>
      alosmt = 2.6867775e+19_rb               <font color=#447700>! Loschmidt constant<a name='4795'></font>
                                              <font color=#447700>! (cm-3)<a name='4796'></font>
      gascon = 8.31447200e+07_rb              <font color=#447700>! Molar gas constant<a name='4797'></font>
                                              <font color=#447700>! (ergs mol-1 K-1)<a name='4798'></font>
      radcn1 = 1.191042772e-12_rb             <font color=#447700>! First radiation constant<a name='4799'></font>
                                              <font color=#447700>! (W cm2 sr-1)<a name='4800'></font>
      radcn2 = 1.4387752_rb                   <font color=#447700>! Second radiation constant<a name='4801'></font>
                                              <font color=#447700>! (cm K)<a name='4802'></font>
      sbcnst = 5.670400e-04_rb                <font color=#447700>! Stefan-Boltzmann constant<a name='4803'></font>
                                              <font color=#447700>! (W cm-2 K-4)<a name='4804'></font>
      secdy = 8.6400e4_rb                     <font color=#447700>! Number of seconds per day<a name='4805'></font>
                                              <font color=#447700>! (s d-1)<a name='4806'></font>
<a name='4807'>
<font color=#447700>!jm 20141107 moved here for thread safety<a name='4808'></font>
      oneminus = 1.0_rb - 1.e-06_rb <font color=#447700>! zepsec<a name='4809'></font>
      pi = 2._rb * asin(1._rb)<a name='4810'>
<a name='4811'>
<font color=#447700>!<a name='4812'></font>
<font color=#447700>!     units are generally cgs<a name='4813'></font>
<font color=#447700>!<a name='4814'></font>
<font color=#447700>!     The first and second radiation constants are taken from NIST.<a name='4815'></font>
<font color=#447700>!     They were previously obtained from the relations:<a name='4816'></font>
<font color=#447700>!          radcn1 = 2.*planck*clight*clight*1.e-07<a name='4817'></font>
<font color=#447700>!          radcn2 = planck*clight/boltz<a name='4818'></font>
<a name='4819'>
<font color=#447700>!     Heatfac is the factor by which delta-flux / delta-pressure is<a name='4820'></font>
<font color=#447700>!     multiplied, with flux in W/m-2 and pressure in mbar, to get <a name='4821'></font>
<font color=#447700>!     the heating rate in units of degrees/day.  It is equal to:<a name='4822'></font>
<font color=#447700>!     Original value:<a name='4823'></font>
<font color=#447700>!           (g)x(#sec/day)x(1e-5)/(specific heat of air at const. p)<a name='4824'></font>
<font color=#447700>!           Here, cpdair (1.004) is in units of J g-1 K-1, and the <a name='4825'></font>
<font color=#447700>!           constant (1.e-5) converts mb to Pa and g-1 to kg-1.<a name='4826'></font>
<font color=#447700>!        =  (9.8066)(86400)(1e-5)/(1.004)<a name='4827'></font>
<font color=#447700>!      heatfac = 8.4391_rb<a name='4828'></font>
<font color=#447700>!<a name='4829'></font>
<font color=#447700>!     Modified value for consistency with CAM3:<a name='4830'></font>
<font color=#447700>!           (g)x(#sec/day)x(1e-5)/(specific heat of air at const. p)<a name='4831'></font>
<font color=#447700>!           Here, cpdair (1.00464) is in units of J g-1 K-1, and the<a name='4832'></font>
<font color=#447700>!           constant (1.e-5) converts mb to Pa and g-1 to kg-1.<a name='4833'></font>
<font color=#447700>!        =  (9.80616)(86400)(1e-5)/(1.00464)<a name='4834'></font>
<font color=#447700>!      heatfac = 8.43339130434_rb<a name='4835'></font>
<font color=#447700>!<a name='4836'></font>
<font color=#447700>!     Calculated value (from constants above and input cpdair)<a name='4837'></font>
<font color=#447700>!        (grav) x (#sec/day) / (specific heat of dry air at const. p x 1.e2)<a name='4838'></font>
<font color=#447700>!           Here, cpdair is in units of J kg-1 K-1, and the constant (1.e2) <a name='4839'></font>
<font color=#447700>!           converts mb to Pa when heatfac is multiplied by W m-2 mb-1. <a name='4840'></font>
      heatfac = grav * secdy / (cpdair * 1.e2_rb)<a name='4841'>
<a name='4842'>
      end subroutine swdatinit<a name='4843'>
<a name='4844'>
<font color=#447700>!***************************************************************************<a name='4845'></font>
<A NAME='SWCMBDAT'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SWCMBDAT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4846'>
      <font color=#993300>subroutine </font><font color=#cc0000>swcmbdat</font> <A href='../../call_to/SWCMBDAT.html' TARGET='index'>2</A><a name='4847'>
<font color=#447700>!***************************************************************************<a name='4848'></font>
<a name='4849'>
      save<a name='4850'>
 <a name='4851'>
<font color=#447700>! ------- Definitions -------<a name='4852'></font>
<font color=#447700>!     Arrays for the g-point reduction from 224 to 112 for the 16 LW bands:<a name='4853'></font>
<font color=#447700>!     This mapping from 224 to 112 points has been carefully selected to <a name='4854'></font>
<font color=#447700>!     minimize the effect on the resulting fluxes and cooling rates, and<a name='4855'></font>
<font color=#447700>!     caution should be used if the mapping is modified.  The full 224<a name='4856'></font>
<font color=#447700>!     g-point set can be restored with ngpt=224, ngc=16*16, ngn=224*1., etc.<a name='4857'></font>
<font color=#447700>!     ngpt    The total number of new g-points<a name='4858'></font>
<font color=#447700>!     ngc     The number of new g-points in each band<a name='4859'></font>
<font color=#447700>!     ngs     The cumulative sum of new g-points for each band<a name='4860'></font>
<font color=#447700>!     ngm     The index of each new g-point relative to the original<a name='4861'></font>
<font color=#447700>!             16 g-points for each band.  <a name='4862'></font>
<font color=#447700>!     ngn     The number of original g-points that are combined to make<a name='4863'></font>
<font color=#447700>!             each new g-point in each band.<a name='4864'></font>
<font color=#447700>!     ngb     The band index for each new g-point.<a name='4865'></font>
<font color=#447700>!     wt      RRTM weights for 16 g-points.<a name='4866'></font>
<a name='4867'>
<font color=#447700>! Use this set for 112 quadrature point (g-point) model<a name='4868'></font>
<font color=#447700>! ------- Data statements -------<a name='4869'></font>
      ngc(:) = (/ 6,12, 8, 8,10,10, 2,10, 8, 6, 6, 8, 6,12 /)<a name='4870'>
      ngs(:) = (/ 6,18,26,34,44,54,56,66,74,80,86,94,100,112 /)<a name='4871'>
      ngm(:) = (/ 1,1,2,2,3,3,4,4,5,5,5,5,6,6,6,6, &amp;           <font color=#447700>! band 16<a name='4872'></font>
                  1,2,3,4,5,6,6,7,8,8,9,10,10,11,12,12, &amp;      <font color=#447700>! band 17<a name='4873'></font>
                  1,2,3,4,5,5,6,6,7,7,7,7,8,8,8,8, &amp;           <font color=#447700>! band 18<a name='4874'></font>
                  1,2,3,4,5,5,6,6,7,7,7,7,8,8,8,8, &amp;           <font color=#447700>! band 19<a name='4875'></font>
                  1,2,3,4,5,6,7,8,9,9,10,10,10,10,10,10, &amp;     <font color=#447700>! band 20<a name='4876'></font>
                  1,2,3,4,5,6,7,8,9,9,10,10,10,10,10,10, &amp;     <font color=#447700>! band 21<a name='4877'></font>
                  1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2, &amp;           <font color=#447700>! band 22<a name='4878'></font>
                  1,1,2,2,3,4,5,6,7,8,9,9,10,10,10,10, &amp;       <font color=#447700>! band 23<a name='4879'></font>
                  1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8, &amp;           <font color=#447700>! band 24<a name='4880'></font>
                  1,2,3,3,4,4,5,5,5,5,6,6,6,6,6,6, &amp;           <font color=#447700>! band 25<a name='4881'></font>
                  1,2,3,3,4,4,5,5,5,5,6,6,6,6,6,6, &amp;           <font color=#447700>! band 26<a name='4882'></font>
                  1,2,3,4,5,6,7,7,7,7,8,8,8,8,8,8, &amp;           <font color=#447700>! band 27<a name='4883'></font>
                  1,2,3,3,4,4,5,5,5,5,6,6,6,6,6,6, &amp;           <font color=#447700>! band 28<a name='4884'></font>
                  1,2,3,4,5,5,6,6,7,7,8,8,9,10,11,12 /)        <font color=#447700>! band 29<a name='4885'></font>
      ngn(:) = (/ 2,2,2,2,4,4, &amp;                               <font color=#447700>! band 16<a name='4886'></font>
                  1,1,1,1,1,2,1,2,1,2,1,2, &amp;                   <font color=#447700>! band 17<a name='4887'></font>
                  1,1,1,1,2,2,4,4, &amp;                           <font color=#447700>! band 18<a name='4888'></font>
                  1,1,1,1,2,2,4,4, &amp;                           <font color=#447700>! band 19<a name='4889'></font>
                  1,1,1,1,1,1,1,1,2,6, &amp;                       <font color=#447700>! band 20<a name='4890'></font>
                  1,1,1,1,1,1,1,1,2,6, &amp;                       <font color=#447700>! band 21<a name='4891'></font>
                  8,8, &amp;                                       <font color=#447700>! band 22<a name='4892'></font>
                  2,2,1,1,1,1,1,1,2,4, &amp;                       <font color=#447700>! band 23<a name='4893'></font>
                  2,2,2,2,2,2,2,2, &amp;                           <font color=#447700>! band 24<a name='4894'></font>
                  1,1,2,2,4,6, &amp;                               <font color=#447700>! band 25<a name='4895'></font>
                  1,1,2,2,4,6, &amp;                               <font color=#447700>! band 26<a name='4896'></font>
                  1,1,1,1,1,1,4,6, &amp;                           <font color=#447700>! band 27<a name='4897'></font>
                  1,1,2,2,4,6, &amp;                               <font color=#447700>! band 28<a name='4898'></font>
                  1,1,1,1,2,2,2,2,1,1,1,1 /)                   <font color=#447700>! band 29<a name='4899'></font>
      ngb(:) = (/ 16,16,16,16,16,16, &amp;                         <font color=#447700>! band 16<a name='4900'></font>
                  17,17,17,17,17,17,17,17,17,17,17,17, &amp;       <font color=#447700>! band 17<a name='4901'></font>
                  18,18,18,18,18,18,18,18, &amp;                   <font color=#447700>! band 18<a name='4902'></font>
                  19,19,19,19,19,19,19,19, &amp;                   <font color=#447700>! band 19<a name='4903'></font>
                  20,20,20,20,20,20,20,20,20,20, &amp;             <font color=#447700>! band 20<a name='4904'></font>
                  21,21,21,21,21,21,21,21,21,21, &amp;             <font color=#447700>! band 21<a name='4905'></font>
                  22,22, &amp;                                     <font color=#447700>! band 22<a name='4906'></font>
                  23,23,23,23,23,23,23,23,23,23, &amp;             <font color=#447700>! band 23<a name='4907'></font>
                  24,24,24,24,24,24,24,24, &amp;                   <font color=#447700>! band 24<a name='4908'></font>
                  25,25,25,25,25,25, &amp;                         <font color=#447700>! band 25<a name='4909'></font>
                  26,26,26,26,26,26, &amp;                         <font color=#447700>! band 26<a name='4910'></font>
                  27,27,27,27,27,27,27,27, &amp;                   <font color=#447700>! band 27<a name='4911'></font>
                  28,28,28,28,28,28, &amp;                         <font color=#447700>! band 28<a name='4912'></font>
                  29,29,29,29,29,29,29,29,29,29,29,29 /)       <font color=#447700>! band 29<a name='4913'></font>
<a name='4914'>
<font color=#447700>! Use this set for full 224 quadrature point (g-point) model<a name='4915'></font>
<font color=#447700>! ------- Data statements -------<a name='4916'></font>
<font color=#447700>!      ngc(:) = (/ 16,16,16,16,16,16,16,16,16,16,16,16,16,16 /)<a name='4917'></font>
<font color=#447700>!      ngs(:) = (/ 16,32,48,64,80,96,112,128,144,160,176,192,208,224 /)<a name='4918'></font>
<font color=#447700>!      ngm(:) = (/ 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 16<a name='4919'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 17<a name='4920'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 18<a name='4921'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 19<a name='4922'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 20<a name='4923'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 21<a name='4924'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 22<a name='4925'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 23<a name='4926'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 24<a name='4927'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 25<a name='4928'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 26<a name='4929'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 27<a name='4930'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 28<a name='4931'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16 /)    ! band 29<a name='4932'></font>
<font color=#447700>!      ngn(:) = (/ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 16<a name='4933'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 17<a name='4934'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 18<a name='4935'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 19<a name='4936'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 20<a name='4937'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 21<a name='4938'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 22<a name='4939'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 23<a name='4940'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 24<a name='4941'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 25<a name='4942'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 26<a name='4943'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 27<a name='4944'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 28<a name='4945'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 /)           ! band 29<a name='4946'></font>
<font color=#447700>!      ngb(:) = (/ 16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16, &amp;   ! band 16<a name='4947'></font>
<font color=#447700>!                  17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17, &amp;   ! band 17<a name='4948'></font>
<font color=#447700>!                  18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18, &amp;   ! band 18<a name='4949'></font>
<font color=#447700>!                  19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19, &amp;   ! band 19<a name='4950'></font>
<font color=#447700>!                  20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20, &amp;   ! band 20<a name='4951'></font>
<font color=#447700>!                  21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21, &amp;   ! band 21<a name='4952'></font>
<font color=#447700>!                  22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22, &amp;   ! band 22<a name='4953'></font>
<font color=#447700>!                  23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23, &amp;   ! band 23<a name='4954'></font>
<font color=#447700>!                  24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24, &amp;   ! band 24<a name='4955'></font>
<font color=#447700>!                  25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25, &amp;   ! band 25<a name='4956'></font>
<font color=#447700>!                  26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26, &amp;   ! band 26<a name='4957'></font>
<font color=#447700>!                  27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27, &amp;   ! band 27<a name='4958'></font>
<font color=#447700>!                  28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28, &amp;   ! band 28<a name='4959'></font>
<font color=#447700>!                  29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29 /)   ! band 29<a name='4960'></font>
<a name='4961'>
<a name='4962'>
      wt(:) =  (/ 0.1527534276_rb, 0.1491729617_rb, 0.1420961469_rb, &amp;<a name='4963'>
                  0.1316886544_rb, 0.1181945205_rb, 0.1019300893_rb, &amp;<a name='4964'>
                  0.0832767040_rb, 0.0626720116_rb, 0.0424925000_rb, &amp;<a name='4965'>
                  0.0046269894_rb, 0.0038279891_rb, 0.0030260086_rb, &amp;<a name='4966'>
                  0.0022199750_rb, 0.0014140010_rb, 0.0005330000_rb, &amp;<a name='4967'>
                  0.0000750000_rb /)<a name='4968'>
<a name='4969'>
      end subroutine swcmbdat<a name='4970'>
<a name='4971'>
<font color=#447700>!***************************************************************************<a name='4972'></font>
<A NAME='SWAERPR'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SWAERPR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4973'>
      <font color=#993300>subroutine </font><font color=#cc0000>swaerpr</font> <A href='../../call_to/SWAERPR.html' TARGET='index'>2</A>,<A href='../../call_from/SWAERPR.html' TARGET='index'>2</A><a name='4974'>
<font color=#447700>!***************************************************************************<a name='4975'></font>
<a name='4976'>
<font color=#447700>! Purpose: Define spectral aerosol properties for six ECMWF aerosol types<a name='4977'></font>
<font color=#447700>! as used in the ECMWF IFS model (see module rrsw_aer.F90 for details)<a name='4978'></font>
<font color=#447700>!<a name='4979'></font>
<font color=#447700>! Original: Defined for rrtmg_sw 14 spectral bands, JJMorcrette, ECMWF Feb 2003<a name='4980'></font>
<font color=#447700>! Revision: Reformatted for consistency with rrtmg_lw, MJIacono, AER, Jul 2006<a name='4981'></font>
<a name='4982'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_AER'>rrsw_aer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWAERPR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_AER_1">, only : rsrtaua, rsrpiza, rsrasya<a name='4983'>
<a name='4984'>
      save<a name='4985'>
<a name='4986'>
      rsrtaua( 1, :) = (/ &amp;<a name='4987'>
        0.10849_rb, 0.66699_rb, 0.65255_rb, 0.11600_rb, 0.06529_rb, 0.04468_rb/)<a name='4988'>
      rsrtaua( 2, :) = (/ &amp;<a name='4989'>
        0.10849_rb, 0.66699_rb, 0.65255_rb, 0.11600_rb, 0.06529_rb, 0.04468_rb/)<a name='4990'>
      rsrtaua( 3, :) = (/ &amp;<a name='4991'>
        0.20543_rb, 0.84642_rb, 0.84958_rb, 0.21673_rb, 0.28270_rb, 0.10915_rb/)<a name='4992'>
      rsrtaua( 4, :) = (/ &amp;<a name='4993'>
        0.20543_rb, 0.84642_rb, 0.84958_rb, 0.21673_rb, 0.28270_rb, 0.10915_rb/)<a name='4994'>
      rsrtaua( 5, :) = (/ &amp;<a name='4995'>
        0.20543_rb, 0.84642_rb, 0.84958_rb, 0.21673_rb, 0.28270_rb, 0.10915_rb/)<a name='4996'>
      rsrtaua( 6, :) = (/ &amp;<a name='4997'>
        0.20543_rb, 0.84642_rb, 0.84958_rb, 0.21673_rb, 0.28270_rb, 0.10915_rb/)<a name='4998'>
      rsrtaua( 7, :) = (/ &amp;<a name='4999'>
        0.20543_rb, 0.84642_rb, 0.84958_rb, 0.21673_rb, 0.28270_rb, 0.10915_rb/)<a name='5000'>
      rsrtaua( 8, :) = (/ &amp;<a name='5001'>
        0.52838_rb, 0.93285_rb, 0.93449_rb, 0.53078_rb, 0.67148_rb, 0.46608_rb/)<a name='5002'>
      rsrtaua( 9, :) = (/ &amp;<a name='5003'>
        0.52838_rb, 0.93285_rb, 0.93449_rb, 0.53078_rb, 0.67148_rb, 0.46608_rb/)<a name='5004'>
      rsrtaua(10, :) = (/ &amp;<a name='5005'>
        1.69446_rb, 1.11855_rb, 1.09212_rb, 1.72145_rb, 1.03858_rb, 1.12044_rb/)<a name='5006'>
      rsrtaua(11, :) = (/ &amp;<a name='5007'>
        1.69446_rb, 1.11855_rb, 1.09212_rb, 1.72145_rb, 1.03858_rb, 1.12044_rb/)<a name='5008'>
      rsrtaua(12, :) = (/ &amp;<a name='5009'>
        1.69446_rb, 1.11855_rb, 1.09212_rb, 1.72145_rb, 1.03858_rb, 1.12044_rb/)<a name='5010'>
      rsrtaua(13, :) = (/ &amp;<a name='5011'>
        1.69446_rb, 1.11855_rb, 1.09212_rb, 1.72145_rb, 1.03858_rb, 1.12044_rb/)<a name='5012'>
      rsrtaua(14, :) = (/ &amp;<a name='5013'>
        0.10849_rb, 0.66699_rb, 0.65255_rb, 0.11600_rb, 0.06529_rb, 0.04468_rb/)<a name='5014'>
 <a name='5015'>
      rsrpiza( 1, :) = (/ &amp;<a name='5016'>
        .5230504_rb, .7868518_rb, .8531531_rb, .4048149_rb, .8748231_rb, .2355667_rb/)<a name='5017'>
      rsrpiza( 2, :) = (/ &amp;<a name='5018'>
        .5230504_rb, .7868518_rb, .8531531_rb, .4048149_rb, .8748231_rb, .2355667_rb/)<a name='5019'>
      rsrpiza( 3, :) = (/ &amp;<a name='5020'>
        .8287144_rb, .9949396_rb, .9279543_rb, .6765051_rb, .9467578_rb, .9955938_rb/)<a name='5021'>
      rsrpiza( 4, :) = (/ &amp;<a name='5022'>
        .8287144_rb, .9949396_rb, .9279543_rb, .6765051_rb, .9467578_rb, .9955938_rb/)<a name='5023'>
      rsrpiza( 5, :) = (/ &amp;<a name='5024'>
        .8287144_rb, .9949396_rb, .9279543_rb, .6765051_rb, .9467578_rb, .9955938_rb/)<a name='5025'>
      rsrpiza( 6, :) = (/ &amp;<a name='5026'>
        .8287144_rb, .9949396_rb, .9279543_rb, .6765051_rb, .9467578_rb, .9955938_rb/)<a name='5027'>
      rsrpiza( 7, :) = (/ &amp;<a name='5028'>
        .8287144_rb, .9949396_rb, .9279543_rb, .6765051_rb, .9467578_rb, .9955938_rb/)<a name='5029'>
      rsrpiza( 8, :) = (/ &amp;<a name='5030'>
        .8970131_rb, .9984940_rb, .9245594_rb, .7768385_rb, .9532763_rb, .9999999_rb/)<a name='5031'>
      rsrpiza( 9, :) = (/ &amp;<a name='5032'>
        .8970131_rb, .9984940_rb, .9245594_rb, .7768385_rb, .9532763_rb, .9999999_rb/)<a name='5033'>
      rsrpiza(10, :) = (/ &amp;<a name='5034'>
        .9148907_rb, .9956173_rb, .7504584_rb, .8131335_rb, .9401905_rb, .9999999_rb/)<a name='5035'>
      rsrpiza(11, :) = (/ &amp;<a name='5036'>
        .9148907_rb, .9956173_rb, .7504584_rb, .8131335_rb, .9401905_rb, .9999999_rb/)<a name='5037'>
      rsrpiza(12, :) = (/ &amp;<a name='5038'>
        .9148907_rb, .9956173_rb, .7504584_rb, .8131335_rb, .9401905_rb, .9999999_rb/)<a name='5039'>
      rsrpiza(13, :) = (/ &amp;<a name='5040'>
        .9148907_rb, .9956173_rb, .7504584_rb, .8131335_rb, .9401905_rb, .9999999_rb/)<a name='5041'>
      rsrpiza(14, :) = (/ &amp;<a name='5042'>
        .5230504_rb, .7868518_rb, .8531531_rb, .4048149_rb, .8748231_rb, .2355667_rb/)<a name='5043'>
<a name='5044'>
      rsrasya( 1, :) = (/ &amp;<a name='5045'>
        0.700610_rb, 0.818871_rb, 0.702399_rb, 0.689886_rb, .4629866_rb, .1907639_rb/)<a name='5046'>
      rsrasya( 2, :) = (/ &amp;<a name='5047'>
        0.700610_rb, 0.818871_rb, 0.702399_rb, 0.689886_rb, .4629866_rb, .1907639_rb/)<a name='5048'>
      rsrasya( 3, :) = (/ &amp;<a name='5049'>
        0.636342_rb, 0.802467_rb, 0.691305_rb, 0.627497_rb, .6105750_rb, .4760794_rb/)<a name='5050'>
      rsrasya( 4, :) = (/ &amp;<a name='5051'>
        0.636342_rb, 0.802467_rb, 0.691305_rb, 0.627497_rb, .6105750_rb, .4760794_rb/)<a name='5052'>
      rsrasya( 5, :) = (/ &amp;<a name='5053'>
        0.636342_rb, 0.802467_rb, 0.691305_rb, 0.627497_rb, .6105750_rb, .4760794_rb/)<a name='5054'>
      rsrasya( 6, :) = (/ &amp;<a name='5055'>
        0.636342_rb, 0.802467_rb, 0.691305_rb, 0.627497_rb, .6105750_rb, .4760794_rb/)<a name='5056'>
      rsrasya( 7, :) = (/ &amp;<a name='5057'>
        0.636342_rb, 0.802467_rb, 0.691305_rb, 0.627497_rb, .6105750_rb, .4760794_rb/)<a name='5058'>
      rsrasya( 8, :) = (/ &amp;<a name='5059'>
        0.668431_rb, 0.788530_rb, 0.698682_rb, 0.657422_rb, .6735182_rb, .6519706_rb/)<a name='5060'>
      rsrasya( 9, :) = (/ &amp;<a name='5061'>
        0.668431_rb, 0.788530_rb, 0.698682_rb, 0.657422_rb, .6735182_rb, .6519706_rb/)<a name='5062'>
      rsrasya(10, :) = (/ &amp;<a name='5063'>
        0.729019_rb, 0.803129_rb, 0.784592_rb, 0.712208_rb, .7008249_rb, .7270548_rb/)<a name='5064'>
      rsrasya(11, :) = (/ &amp;<a name='5065'>
        0.729019_rb, 0.803129_rb, 0.784592_rb, 0.712208_rb, .7008249_rb, .7270548_rb/)<a name='5066'>
      rsrasya(12, :) = (/ &amp;<a name='5067'>
        0.729019_rb, 0.803129_rb, 0.784592_rb, 0.712208_rb, .7008249_rb, .7270548_rb/)<a name='5068'>
      rsrasya(13, :) = (/ &amp;<a name='5069'>
        0.729019_rb, 0.803129_rb, 0.784592_rb, 0.712208_rb, .7008249_rb, .7270548_rb/)<a name='5070'>
      rsrasya(14, :) = (/ &amp;<a name='5071'>
        0.700610_rb, 0.818871_rb, 0.702399_rb, 0.689886_rb, .4629866_rb, .1907639_rb/)<a name='5072'>
<a name='5073'>
      end subroutine swaerpr<a name='5074'>
 <a name='5075'>
<font color=#447700>!***************************************************************************<a name='5076'></font>
<A NAME='CMBGB16S'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB16S' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5077'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb16s</font> <A href='../../call_to/CMBGB16S.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB16S.html' TARGET='index'>2</A><a name='5078'>
<font color=#447700>!***************************************************************************<a name='5079'></font>
<font color=#447700>!<a name='5080'></font>
<font color=#447700>!  Original version:       MJIacono; July 1998<a name='5081'></font>
<font color=#447700>!  Revision for RRTM_SW:   MJIacono; November 2002<a name='5082'></font>
<font color=#447700>!  Revision for RRTMG_SW:  MJIacono; December 2003<a name='5083'></font>
<font color=#447700>!  Revision for F90 reformatting:  MJIacono; July 2006<a name='5084'></font>
<font color=#447700>!<a name='5085'></font>
<font color=#447700>!  The subroutines CMBGB16-&gt;CMBGB29 input the absorption coefficient<a name='5086'></font>
<font color=#447700>!  data for each band, which are defined for 16 g-points and 14 spectral<a name='5087'></font>
<font color=#447700>!  bands. The data are combined with appropriate weighting following the<a name='5088'></font>
<font color=#447700>!  g-point mapping arrays specified in RRTMG_SW_INIT.  Solar source <a name='5089'></font>
<font color=#447700>!  function data in array SFLUXREF are combined without weighting.  All<a name='5090'></font>
<font color=#447700>!  g-point reduced data are put into new arrays for use in RRTMG_SW.<a name='5091'></font>
<font color=#447700>!<a name='5092'></font>
<font color=#447700>!  band 16:  2600-3250 cm-1 (low key- h2o,ch4; high key - ch4)<a name='5093'></font>
<font color=#447700>!<a name='5094'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5095'></font>
<a name='5096'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG16'>rrsw_kg16</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB16S' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG16_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='5097'>
                            absa, ka, absb, kb, selfref, forref, sfluxref<a name='5098'>
<a name='5099'>
<font color=#447700>! ------- Local -------<a name='5100'></font>
      integer(kind=im) :: jn, jt, jp, igc, ipr, iprsm<a name='5101'>
      real(kind=rb) :: sumk, sumf<a name='5102'>
<a name='5103'>
<a name='5104'>
      do jn = 1,9<a name='5105'>
         do jt = 1,5<a name='5106'>
            do jp = 1,13<a name='5107'>
               iprsm = 0<a name='5108'>
               do igc = 1,ngc(1)<a name='5109'>
                  sumk = 0.<a name='5110'>
                  do ipr = 1, ngn(igc)<a name='5111'>
                     iprsm = iprsm + 1<a name='5112'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm)<a name='5113'>
                  enddo<a name='5114'>
                  ka(jn,jt,jp,igc) = sumk<a name='5115'>
               enddo<a name='5116'>
            enddo<a name='5117'>
         enddo<a name='5118'>
      enddo<a name='5119'>
<a name='5120'>
      do jt = 1,5<a name='5121'>
         do jp = 13,59<a name='5122'>
            iprsm = 0<a name='5123'>
            do igc = 1,ngc(1)<a name='5124'>
               sumk = 0.<a name='5125'>
               do ipr = 1, ngn(igc)<a name='5126'>
                  iprsm = iprsm + 1<a name='5127'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm)<a name='5128'>
               enddo<a name='5129'>
               kb(jt,jp,igc) = sumk<a name='5130'>
            enddo<a name='5131'>
         enddo<a name='5132'>
      enddo<a name='5133'>
<a name='5134'>
      do jt = 1,10<a name='5135'>
         iprsm = 0<a name='5136'>
         do igc = 1,ngc(1)<a name='5137'>
            sumk = 0.<a name='5138'>
            do ipr = 1, ngn(igc)<a name='5139'>
               iprsm = iprsm + 1<a name='5140'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm)<a name='5141'>
            enddo<a name='5142'>
            selfref(jt,igc) = sumk<a name='5143'>
         enddo<a name='5144'>
      enddo<a name='5145'>
<a name='5146'>
      do jt = 1,3<a name='5147'>
         iprsm = 0<a name='5148'>
         do igc = 1,ngc(1)<a name='5149'>
            sumk = 0.<a name='5150'>
            do ipr = 1, ngn(igc)<a name='5151'>
               iprsm = iprsm + 1<a name='5152'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm)<a name='5153'>
            enddo<a name='5154'>
            forref(jt,igc) = sumk<a name='5155'>
         enddo<a name='5156'>
      enddo<a name='5157'>
<a name='5158'>
      iprsm = 0<a name='5159'>
      do igc = 1,ngc(1)<a name='5160'>
         sumf = 0.<a name='5161'>
         do ipr = 1, ngn(igc)<a name='5162'>
            iprsm = iprsm + 1<a name='5163'>
            sumf = sumf + sfluxrefo(iprsm)<a name='5164'>
         enddo<a name='5165'>
         sfluxref(igc) = sumf<a name='5166'>
      enddo<a name='5167'>
<a name='5168'>
      end subroutine cmbgb16s<a name='5169'>
<a name='5170'>
<font color=#447700>!***************************************************************************<a name='5171'></font>
<A NAME='CMBGB17'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB17' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5172'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb17</font> <A href='../../call_to/CMBGB17.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB17.html' TARGET='index'>2</A><a name='5173'>
<font color=#447700>!***************************************************************************<a name='5174'></font>
<font color=#447700>!<a name='5175'></font>
<font color=#447700>!     band 17:  3250-4000 cm-1 (low - h2o,co2; high - h2o,co2)<a name='5176'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5177'></font>
<a name='5178'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG17'>rrsw_kg17</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG17_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='5179'>
                            absa, ka, absb, kb, selfref, forref, sfluxref<a name='5180'>
<a name='5181'>
<font color=#447700>! ------- Local -------<a name='5182'></font>
      integer(kind=im) :: jn, jt, jp, igc, ipr, iprsm<a name='5183'>
      real(kind=rb) :: sumk, sumf<a name='5184'>
<a name='5185'>
<a name='5186'>
      do jn = 1,9<a name='5187'>
         do jt = 1,5<a name='5188'>
            do jp = 1,13<a name='5189'>
               iprsm = 0<a name='5190'>
               do igc = 1,ngc(2)<a name='5191'>
                  sumk = 0.<a name='5192'>
                  do ipr = 1, ngn(ngs(1)+igc)<a name='5193'>
                     iprsm = iprsm + 1<a name='5194'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+16)<a name='5195'>
                  enddo<a name='5196'>
                  ka(jn,jt,jp,igc) = sumk<a name='5197'>
               enddo<a name='5198'>
            enddo<a name='5199'>
         enddo<a name='5200'>
      enddo<a name='5201'>
<a name='5202'>
      do jn = 1,5<a name='5203'>
         do jt = 1,5<a name='5204'>
            do jp = 13,59<a name='5205'>
               iprsm = 0<a name='5206'>
               do igc = 1,ngc(2)<a name='5207'>
                  sumk = 0.<a name='5208'>
                  do ipr = 1, ngn(ngs(1)+igc)<a name='5209'>
                     iprsm = iprsm + 1<a name='5210'>
                     sumk = sumk + kbo(jn,jt,jp,iprsm)*rwgt(iprsm+16)<a name='5211'>
                  enddo<a name='5212'>
                  kb(jn,jt,jp,igc) = sumk<a name='5213'>
               enddo<a name='5214'>
            enddo<a name='5215'>
         enddo<a name='5216'>
      enddo<a name='5217'>
<a name='5218'>
      do jt = 1,10<a name='5219'>
         iprsm = 0<a name='5220'>
         do igc = 1,ngc(2)<a name='5221'>
            sumk = 0.<a name='5222'>
            do ipr = 1, ngn(ngs(1)+igc)<a name='5223'>
               iprsm = iprsm + 1<a name='5224'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+16)<a name='5225'>
            enddo<a name='5226'>
            selfref(jt,igc) = sumk<a name='5227'>
         enddo<a name='5228'>
      enddo<a name='5229'>
<a name='5230'>
      do jt = 1,4<a name='5231'>
         iprsm = 0<a name='5232'>
         do igc = 1,ngc(2)<a name='5233'>
            sumk = 0.<a name='5234'>
            do ipr = 1, ngn(ngs(1)+igc)<a name='5235'>
               iprsm = iprsm + 1<a name='5236'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+16)<a name='5237'>
            enddo<a name='5238'>
            forref(jt,igc) = sumk<a name='5239'>
         enddo<a name='5240'>
      enddo<a name='5241'>
<a name='5242'>
      do jp = 1,5<a name='5243'>
         iprsm = 0<a name='5244'>
         do igc = 1,ngc(2)<a name='5245'>
            sumf = 0.<a name='5246'>
            do ipr = 1, ngn(ngs(1)+igc)<a name='5247'>
               iprsm = iprsm + 1<a name='5248'>
               sumf = sumf + sfluxrefo(iprsm,jp)<a name='5249'>
            enddo<a name='5250'>
            sfluxref(igc,jp) = sumf<a name='5251'>
         enddo<a name='5252'>
      enddo<a name='5253'>
<a name='5254'>
      end subroutine cmbgb17<a name='5255'>
<a name='5256'>
<font color=#447700>!***************************************************************************<a name='5257'></font>
<A NAME='CMBGB18'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB18' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5258'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb18</font> <A href='../../call_to/CMBGB18.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB18.html' TARGET='index'>2</A><a name='5259'>
<font color=#447700>!***************************************************************************<a name='5260'></font>
<font color=#447700>!<a name='5261'></font>
<font color=#447700>!     band 18:  4000-4650 cm-1 (low - h2o,ch4; high - ch4)<a name='5262'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5263'></font>
<a name='5264'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG18'>rrsw_kg18</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG18_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='5265'>
                            absa, ka, absb, kb, selfref, forref, sfluxref<a name='5266'>
<a name='5267'>
<font color=#447700>! ------- Local -------<a name='5268'></font>
      integer(kind=im) :: jn, jt, jp, igc, ipr, iprsm<a name='5269'>
      real(kind=rb) :: sumk, sumf<a name='5270'>
<a name='5271'>
<a name='5272'>
      do jn = 1,9<a name='5273'>
         do jt = 1,5<a name='5274'>
            do jp = 1,13<a name='5275'>
               iprsm = 0<a name='5276'>
               do igc = 1,ngc(3)<a name='5277'>
                  sumk = 0.<a name='5278'>
                  do ipr = 1, ngn(ngs(2)+igc)<a name='5279'>
                     iprsm = iprsm + 1<a name='5280'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+32)<a name='5281'>
                  enddo<a name='5282'>
                  ka(jn,jt,jp,igc) = sumk<a name='5283'>
               enddo<a name='5284'>
            enddo<a name='5285'>
         enddo<a name='5286'>
      enddo<a name='5287'>
<a name='5288'>
      do jt = 1,5<a name='5289'>
         do jp = 13,59<a name='5290'>
            iprsm = 0<a name='5291'>
            do igc = 1,ngc(3)<a name='5292'>
               sumk = 0.<a name='5293'>
               do ipr = 1, ngn(ngs(2)+igc)<a name='5294'>
                  iprsm = iprsm + 1<a name='5295'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+32)<a name='5296'>
               enddo<a name='5297'>
               kb(jt,jp,igc) = sumk<a name='5298'>
            enddo<a name='5299'>
         enddo<a name='5300'>
      enddo<a name='5301'>
<a name='5302'>
      do jt = 1,10<a name='5303'>
         iprsm = 0<a name='5304'>
         do igc = 1,ngc(3)<a name='5305'>
            sumk = 0.<a name='5306'>
            do ipr = 1, ngn(ngs(2)+igc)<a name='5307'>
               iprsm = iprsm + 1<a name='5308'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+32)<a name='5309'>
            enddo<a name='5310'>
            selfref(jt,igc) = sumk<a name='5311'>
         enddo<a name='5312'>
      enddo<a name='5313'>
<a name='5314'>
      do jt = 1,3<a name='5315'>
         iprsm = 0<a name='5316'>
         do igc = 1,ngc(3)<a name='5317'>
            sumk = 0.<a name='5318'>
            do ipr = 1, ngn(ngs(2)+igc)<a name='5319'>
               iprsm = iprsm + 1<a name='5320'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+32)<a name='5321'>
            enddo<a name='5322'>
            forref(jt,igc) = sumk<a name='5323'>
         enddo<a name='5324'>
      enddo<a name='5325'>
<a name='5326'>
      do jp = 1,9<a name='5327'>
         iprsm = 0<a name='5328'>
         do igc = 1,ngc(3)<a name='5329'>
            sumf = 0.<a name='5330'>
            do ipr = 1, ngn(ngs(2)+igc)<a name='5331'>
               iprsm = iprsm + 1<a name='5332'>
               sumf = sumf + sfluxrefo(iprsm,jp)<a name='5333'>
            enddo<a name='5334'>
            sfluxref(igc,jp) = sumf<a name='5335'>
         enddo<a name='5336'>
      enddo<a name='5337'>
<a name='5338'>
      end subroutine cmbgb18<a name='5339'>
<a name='5340'>
<font color=#447700>!***************************************************************************<a name='5341'></font>
<A NAME='CMBGB19'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB19' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5342'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb19</font> <A href='../../call_to/CMBGB19.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB19.html' TARGET='index'>2</A><a name='5343'>
<font color=#447700>!***************************************************************************<a name='5344'></font>
<font color=#447700>!<a name='5345'></font>
<font color=#447700>!     band 19:  4650-5150 cm-1 (low - h2o,co2; high - co2)<a name='5346'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5347'></font>
<a name='5348'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG19'>rrsw_kg19</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG19_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='5349'>
                            absa, ka, absb, kb, selfref, forref, sfluxref<a name='5350'>
<a name='5351'>
<font color=#447700>! ------- Local -------<a name='5352'></font>
      integer(kind=im) :: jn, jt, jp, igc, ipr, iprsm<a name='5353'>
      real(kind=rb) :: sumk, sumf<a name='5354'>
<a name='5355'>
<a name='5356'>
      do jn = 1,9<a name='5357'>
         do jt = 1,5<a name='5358'>
            do jp = 1,13<a name='5359'>
               iprsm = 0<a name='5360'>
               do igc = 1,ngc(4)<a name='5361'>
                  sumk = 0.<a name='5362'>
                  do ipr = 1, ngn(ngs(3)+igc)<a name='5363'>
                     iprsm = iprsm + 1<a name='5364'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+48)<a name='5365'>
                  enddo<a name='5366'>
                  ka(jn,jt,jp,igc) = sumk<a name='5367'>
               enddo<a name='5368'>
            enddo<a name='5369'>
         enddo<a name='5370'>
      enddo<a name='5371'>
<a name='5372'>
      do jt = 1,5<a name='5373'>
         do jp = 13,59<a name='5374'>
            iprsm = 0<a name='5375'>
            do igc = 1,ngc(4)<a name='5376'>
               sumk = 0.<a name='5377'>
               do ipr = 1, ngn(ngs(3)+igc)<a name='5378'>
                  iprsm = iprsm + 1<a name='5379'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+48)<a name='5380'>
               enddo<a name='5381'>
               kb(jt,jp,igc) = sumk<a name='5382'>
            enddo<a name='5383'>
         enddo<a name='5384'>
      enddo<a name='5385'>
<a name='5386'>
      do jt = 1,10<a name='5387'>
         iprsm = 0<a name='5388'>
         do igc = 1,ngc(4)<a name='5389'>
            sumk = 0.<a name='5390'>
            do ipr = 1, ngn(ngs(3)+igc)<a name='5391'>
               iprsm = iprsm + 1<a name='5392'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+48)<a name='5393'>
            enddo<a name='5394'>
            selfref(jt,igc) = sumk<a name='5395'>
         enddo<a name='5396'>
      enddo<a name='5397'>
<a name='5398'>
      do jt = 1,3<a name='5399'>
         iprsm = 0<a name='5400'>
         do igc = 1,ngc(4)<a name='5401'>
            sumk = 0.<a name='5402'>
            do ipr = 1, ngn(ngs(3)+igc)<a name='5403'>
               iprsm = iprsm + 1<a name='5404'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+48)<a name='5405'>
            enddo<a name='5406'>
            forref(jt,igc) = sumk<a name='5407'>
         enddo<a name='5408'>
      enddo<a name='5409'>
<a name='5410'>
      do jp = 1,9<a name='5411'>
         iprsm = 0<a name='5412'>
         do igc = 1,ngc(4)<a name='5413'>
            sumf = 0.<a name='5414'>
            do ipr = 1, ngn(ngs(3)+igc)<a name='5415'>
               iprsm = iprsm + 1<a name='5416'>
               sumf = sumf + sfluxrefo(iprsm,jp)<a name='5417'>
            enddo<a name='5418'>
            sfluxref(igc,jp) = sumf<a name='5419'>
         enddo<a name='5420'>
      enddo<a name='5421'>
<a name='5422'>
      end subroutine cmbgb19<a name='5423'>
<a name='5424'>
<font color=#447700>!***************************************************************************<a name='5425'></font>
<A NAME='CMBGB20'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB20' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5426'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb20</font> <A href='../../call_to/CMBGB20.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB20.html' TARGET='index'>2</A><a name='5427'>
<font color=#447700>!***************************************************************************<a name='5428'></font>
<font color=#447700>!<a name='5429'></font>
<font color=#447700>!     band 20:  5150-6150 cm-1 (low - h2o; high - h2o)<a name='5430'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5431'></font>
<a name='5432'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG20'>rrsw_kg20</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG20_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, absch4o, &amp;<a name='5433'>
                            absa, ka, absb, kb, selfref, forref, sfluxref, absch4<a name='5434'>
<a name='5435'>
<font color=#447700>! ------- Local -------<a name='5436'></font>
      integer(kind=im) :: jt, jp, igc, ipr, iprsm<a name='5437'>
      real(kind=rb) :: sumk, sumf1, sumf2<a name='5438'>
<a name='5439'>
<a name='5440'>
      do jt = 1,5<a name='5441'>
         do jp = 1,13<a name='5442'>
            iprsm = 0<a name='5443'>
            do igc = 1,ngc(5)<a name='5444'>
               sumk = 0.<a name='5445'>
               do ipr = 1, ngn(ngs(4)+igc)<a name='5446'>
                  iprsm = iprsm + 1<a name='5447'>
                  sumk = sumk + kao(jt,jp,iprsm)*rwgt(iprsm+64)<a name='5448'>
               enddo<a name='5449'>
               ka(jt,jp,igc) = sumk<a name='5450'>
            enddo<a name='5451'>
         enddo<a name='5452'>
         do jp = 13,59<a name='5453'>
            iprsm = 0<a name='5454'>
            do igc = 1,ngc(5)<a name='5455'>
               sumk = 0.<a name='5456'>
               do ipr = 1, ngn(ngs(4)+igc)<a name='5457'>
                  iprsm = iprsm + 1<a name='5458'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+64)<a name='5459'>
               enddo<a name='5460'>
               kb(jt,jp,igc) = sumk<a name='5461'>
            enddo<a name='5462'>
         enddo<a name='5463'>
      enddo<a name='5464'>
<a name='5465'>
      do jt = 1,10<a name='5466'>
         iprsm = 0<a name='5467'>
         do igc = 1,ngc(5)<a name='5468'>
            sumk = 0.<a name='5469'>
            do ipr = 1, ngn(ngs(4)+igc)<a name='5470'>
               iprsm = iprsm + 1<a name='5471'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+64)<a name='5472'>
            enddo<a name='5473'>
            selfref(jt,igc) = sumk<a name='5474'>
         enddo<a name='5475'>
      enddo<a name='5476'>
<a name='5477'>
      do jt = 1,4<a name='5478'>
         iprsm = 0<a name='5479'>
         do igc = 1,ngc(5)<a name='5480'>
            sumk = 0.<a name='5481'>
            do ipr = 1, ngn(ngs(4)+igc)<a name='5482'>
               iprsm = iprsm + 1<a name='5483'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+64)<a name='5484'>
            enddo<a name='5485'>
            forref(jt,igc) = sumk<a name='5486'>
         enddo<a name='5487'>
      enddo<a name='5488'>
<a name='5489'>
      iprsm = 0<a name='5490'>
      do igc = 1,ngc(5)<a name='5491'>
         sumf1 = 0.<a name='5492'>
         sumf2 = 0.<a name='5493'>
         do ipr = 1, ngn(ngs(4)+igc)<a name='5494'>
            iprsm = iprsm + 1<a name='5495'>
            sumf1 = sumf1 + sfluxrefo(iprsm)<a name='5496'>
            sumf2 = sumf2 + absch4o(iprsm)*rwgt(iprsm+64)<a name='5497'>
         enddo<a name='5498'>
         sfluxref(igc) = sumf1<a name='5499'>
         absch4(igc) = sumf2<a name='5500'>
      enddo<a name='5501'>
<a name='5502'>
      end subroutine cmbgb20<a name='5503'>
<a name='5504'>
<font color=#447700>!***************************************************************************<a name='5505'></font>
<A NAME='CMBGB21'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB21' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5506'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb21</font> <A href='../../call_to/CMBGB21.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB21.html' TARGET='index'>2</A><a name='5507'>
<font color=#447700>!***************************************************************************<a name='5508'></font>
<font color=#447700>!<a name='5509'></font>
<font color=#447700>!     band 21:  6150-7700 cm-1 (low - h2o,co2; high - h2o,co2)<a name='5510'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5511'></font>
<a name='5512'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG21'>rrsw_kg21</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG21_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='5513'>
                            absa, ka, absb, kb, selfref, forref, sfluxref<a name='5514'>
<a name='5515'>
<font color=#447700>! ------- Local -------<a name='5516'></font>
      integer(kind=im) :: jn, jt, jp, igc, ipr, iprsm<a name='5517'>
      real(kind=rb) :: sumk, sumf<a name='5518'>
<a name='5519'>
<a name='5520'>
      do jn = 1,9<a name='5521'>
         do jt = 1,5<a name='5522'>
            do jp = 1,13<a name='5523'>
               iprsm = 0<a name='5524'>
               do igc = 1,ngc(6)<a name='5525'>
                  sumk = 0.<a name='5526'>
                  do ipr = 1, ngn(ngs(5)+igc)<a name='5527'>
                     iprsm = iprsm + 1<a name='5528'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+80)<a name='5529'>
                  enddo<a name='5530'>
                  ka(jn,jt,jp,igc) = sumk<a name='5531'>
               enddo<a name='5532'>
            enddo<a name='5533'>
         enddo<a name='5534'>
      enddo<a name='5535'>
<a name='5536'>
      do jn = 1,5<a name='5537'>
         do jt = 1,5<a name='5538'>
            do jp = 13,59<a name='5539'>
               iprsm = 0<a name='5540'>
               do igc = 1,ngc(6)<a name='5541'>
                  sumk = 0.<a name='5542'>
                  do ipr = 1, ngn(ngs(5)+igc)<a name='5543'>
                     iprsm = iprsm + 1<a name='5544'>
                     sumk = sumk + kbo(jn,jt,jp,iprsm)*rwgt(iprsm+80)<a name='5545'>
                  enddo<a name='5546'>
                  kb(jn,jt,jp,igc) = sumk<a name='5547'>
               enddo<a name='5548'>
            enddo<a name='5549'>
         enddo<a name='5550'>
      enddo<a name='5551'>
<a name='5552'>
      do jt = 1,10<a name='5553'>
         iprsm = 0<a name='5554'>
         do igc = 1,ngc(6)<a name='5555'>
            sumk = 0.<a name='5556'>
            do ipr = 1, ngn(ngs(5)+igc)<a name='5557'>
               iprsm = iprsm + 1<a name='5558'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+80)<a name='5559'>
            enddo<a name='5560'>
            selfref(jt,igc) = sumk<a name='5561'>
         enddo<a name='5562'>
      enddo<a name='5563'>
<a name='5564'>
      do jt = 1,4<a name='5565'>
         iprsm = 0<a name='5566'>
         do igc = 1,ngc(6)<a name='5567'>
            sumk = 0.<a name='5568'>
            do ipr = 1, ngn(ngs(5)+igc)<a name='5569'>
               iprsm = iprsm + 1<a name='5570'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+80)<a name='5571'>
            enddo<a name='5572'>
            forref(jt,igc) = sumk<a name='5573'>
         enddo<a name='5574'>
      enddo<a name='5575'>
<a name='5576'>
      do jp = 1,9<a name='5577'>
         iprsm = 0<a name='5578'>
         do igc = 1,ngc(6)<a name='5579'>
            sumf = 0.<a name='5580'>
            do ipr = 1, ngn(ngs(5)+igc)<a name='5581'>
               iprsm = iprsm + 1<a name='5582'>
               sumf = sumf + sfluxrefo(iprsm,jp)<a name='5583'>
            enddo<a name='5584'>
            sfluxref(igc,jp) = sumf<a name='5585'>
         enddo<a name='5586'>
      enddo<a name='5587'>
<a name='5588'>
      end subroutine cmbgb21<a name='5589'>
<a name='5590'>
<font color=#447700>!***************************************************************************<a name='5591'></font>
<A NAME='CMBGB22'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB22' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5592'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb22</font> <A href='../../call_to/CMBGB22.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB22.html' TARGET='index'>2</A><a name='5593'>
<font color=#447700>!***************************************************************************<a name='5594'></font>
<font color=#447700>!<a name='5595'></font>
<font color=#447700>!     band 22:  7700-8050 cm-1 (low - h2o,o2; high - o2)<a name='5596'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5597'></font>
<a name='5598'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG22'>rrsw_kg22</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG22_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='5599'>
                            absa, ka, absb, kb, selfref, forref, sfluxref<a name='5600'>
<a name='5601'>
<font color=#447700>! ------- Local -------<a name='5602'></font>
      integer(kind=im) :: jn, jt, jp, igc, ipr, iprsm<a name='5603'>
      real(kind=rb) :: sumk, sumf<a name='5604'>
<a name='5605'>
<a name='5606'>
      do jn = 1,9<a name='5607'>
         do jt = 1,5<a name='5608'>
            do jp = 1,13<a name='5609'>
               iprsm = 0<a name='5610'>
               do igc = 1,ngc(7)<a name='5611'>
                  sumk = 0.<a name='5612'>
                  do ipr = 1, ngn(ngs(6)+igc)<a name='5613'>
                     iprsm = iprsm + 1<a name='5614'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+96)<a name='5615'>
                  enddo<a name='5616'>
                  ka(jn,jt,jp,igc) = sumk<a name='5617'>
               enddo<a name='5618'>
            enddo<a name='5619'>
         enddo<a name='5620'>
      enddo<a name='5621'>
<a name='5622'>
      do jt = 1,5<a name='5623'>
         do jp = 13,59<a name='5624'>
            iprsm = 0<a name='5625'>
            do igc = 1,ngc(7)<a name='5626'>
               sumk = 0.<a name='5627'>
               do ipr = 1, ngn(ngs(6)+igc)<a name='5628'>
                  iprsm = iprsm + 1<a name='5629'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+96)<a name='5630'>
               enddo<a name='5631'>
               kb(jt,jp,igc) = sumk<a name='5632'>
            enddo<a name='5633'>
         enddo<a name='5634'>
      enddo<a name='5635'>
<a name='5636'>
      do jt = 1,10<a name='5637'>
         iprsm = 0<a name='5638'>
         do igc = 1,ngc(7)<a name='5639'>
            sumk = 0.<a name='5640'>
            do ipr = 1, ngn(ngs(6)+igc)<a name='5641'>
               iprsm = iprsm + 1<a name='5642'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+96)<a name='5643'>
            enddo<a name='5644'>
            selfref(jt,igc) = sumk<a name='5645'>
         enddo<a name='5646'>
      enddo<a name='5647'>
<a name='5648'>
      do jt = 1,3<a name='5649'>
         iprsm = 0<a name='5650'>
         do igc = 1,ngc(7)<a name='5651'>
            sumk = 0.<a name='5652'>
            do ipr = 1, ngn(ngs(6)+igc)<a name='5653'>
               iprsm = iprsm + 1<a name='5654'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+96)<a name='5655'>
            enddo<a name='5656'>
            forref(jt,igc) = sumk<a name='5657'>
         enddo<a name='5658'>
      enddo<a name='5659'>
<a name='5660'>
      do jp = 1,9<a name='5661'>
         iprsm = 0<a name='5662'>
         do igc = 1,ngc(7)<a name='5663'>
            sumf = 0.<a name='5664'>
            do ipr = 1, ngn(ngs(6)+igc)<a name='5665'>
               iprsm = iprsm + 1<a name='5666'>
               sumf = sumf + sfluxrefo(iprsm,jp)<a name='5667'>
            enddo<a name='5668'>
            sfluxref(igc,jp) = sumf<a name='5669'>
         enddo<a name='5670'>
      enddo<a name='5671'>
<a name='5672'>
      end subroutine cmbgb22<a name='5673'>
<a name='5674'>
<font color=#447700>!***************************************************************************<a name='5675'></font>
<A NAME='CMBGB23'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB23' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5676'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb23</font> <A href='../../call_to/CMBGB23.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB23.html' TARGET='index'>2</A><a name='5677'>
<font color=#447700>!***************************************************************************<a name='5678'></font>
<font color=#447700>!<a name='5679'></font>
<font color=#447700>!     band 23:  8050-12850 cm-1 (low - h2o; high - nothing)<a name='5680'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5681'></font>
<a name='5682'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG23'>rrsw_kg23</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG23_2">, only : kao, selfrefo, forrefo, sfluxrefo, raylo, &amp;<a name='5683'>
                            absa, ka, selfref, forref, sfluxref, rayl<a name='5684'>
<a name='5685'>
<font color=#447700>! ------- Local -------<a name='5686'></font>
      integer(kind=im) :: jt, jp, igc, ipr, iprsm<a name='5687'>
      real(kind=rb) :: sumk, sumf1, sumf2<a name='5688'>
<a name='5689'>
<a name='5690'>
      do jt = 1,5<a name='5691'>
         do jp = 1,13<a name='5692'>
            iprsm = 0<a name='5693'>
            do igc = 1,ngc(8)<a name='5694'>
               sumk = 0.<a name='5695'>
               do ipr = 1, ngn(ngs(7)+igc)<a name='5696'>
                  iprsm = iprsm + 1<a name='5697'>
                  sumk = sumk + kao(jt,jp,iprsm)*rwgt(iprsm+112)<a name='5698'>
               enddo<a name='5699'>
               ka(jt,jp,igc) = sumk<a name='5700'>
            enddo<a name='5701'>
         enddo<a name='5702'>
      enddo<a name='5703'>
<a name='5704'>
      do jt = 1,10<a name='5705'>
         iprsm = 0<a name='5706'>
         do igc = 1,ngc(8)<a name='5707'>
            sumk = 0.<a name='5708'>
            do ipr = 1, ngn(ngs(7)+igc)<a name='5709'>
               iprsm = iprsm + 1<a name='5710'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+112)<a name='5711'>
            enddo<a name='5712'>
            selfref(jt,igc) = sumk<a name='5713'>
         enddo<a name='5714'>
      enddo<a name='5715'>
<a name='5716'>
      do jt = 1,3<a name='5717'>
         iprsm = 0<a name='5718'>
         do igc = 1,ngc(8)<a name='5719'>
            sumk = 0.<a name='5720'>
            do ipr = 1, ngn(ngs(7)+igc)<a name='5721'>
               iprsm = iprsm + 1<a name='5722'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+112)<a name='5723'>
            enddo<a name='5724'>
            forref(jt,igc) = sumk<a name='5725'>
         enddo<a name='5726'>
      enddo<a name='5727'>
<a name='5728'>
      iprsm = 0<a name='5729'>
      do igc = 1,ngc(8)<a name='5730'>
         sumf1 = 0.<a name='5731'>
         sumf2 = 0.<a name='5732'>
         do ipr = 1, ngn(ngs(7)+igc)<a name='5733'>
            iprsm = iprsm + 1<a name='5734'>
            sumf1 = sumf1 + sfluxrefo(iprsm)<a name='5735'>
            sumf2 = sumf2 + raylo(iprsm)*rwgt(iprsm+112)<a name='5736'>
         enddo<a name='5737'>
         sfluxref(igc) = sumf1<a name='5738'>
         rayl(igc) = sumf2<a name='5739'>
      enddo<a name='5740'>
<a name='5741'>
      end subroutine cmbgb23<a name='5742'>
<a name='5743'>
<font color=#447700>!***************************************************************************<a name='5744'></font>
<A NAME='CMBGB24'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB24' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5745'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb24</font> <A href='../../call_to/CMBGB24.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB24.html' TARGET='index'>2</A><a name='5746'>
<font color=#447700>!***************************************************************************<a name='5747'></font>
<font color=#447700>!<a name='5748'></font>
<font color=#447700>!     band 24:  12850-16000 cm-1 (low - h2o,o2; high - o2)<a name='5749'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5750'></font>
<a name='5751'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG24'>rrsw_kg24</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG24_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='5752'>
                            abso3ao, abso3bo, raylao, raylbo, &amp;<a name='5753'>
                            absa, ka, absb, kb, selfref, forref, sfluxref, &amp;<a name='5754'>
                            abso3a, abso3b, rayla, raylb<a name='5755'>
<a name='5756'>
<font color=#447700>! ------- Local -------<a name='5757'></font>
      integer(kind=im) :: jn, jt, jp, igc, ipr, iprsm<a name='5758'>
      real(kind=rb) :: sumk, sumf1, sumf2, sumf3<a name='5759'>
<a name='5760'>
<a name='5761'>
      do jn = 1,9<a name='5762'>
         do jt = 1,5<a name='5763'>
            do jp = 1,13<a name='5764'>
               iprsm = 0<a name='5765'>
               do igc = 1,ngc(9)<a name='5766'>
                  sumk = 0.<a name='5767'>
                  do ipr = 1, ngn(ngs(8)+igc)<a name='5768'>
                     iprsm = iprsm + 1<a name='5769'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+128)<a name='5770'>
                  enddo<a name='5771'>
                  ka(jn,jt,jp,igc) = sumk<a name='5772'>
               enddo<a name='5773'>
            enddo<a name='5774'>
         enddo<a name='5775'>
      enddo<a name='5776'>
<a name='5777'>
      do jt = 1,5<a name='5778'>
         do jp = 13,59<a name='5779'>
            iprsm = 0<a name='5780'>
            do igc = 1,ngc(9)<a name='5781'>
               sumk = 0.<a name='5782'>
               do ipr = 1, ngn(ngs(8)+igc)<a name='5783'>
                  iprsm = iprsm + 1<a name='5784'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+128)<a name='5785'>
               enddo<a name='5786'>
               kb(jt,jp,igc) = sumk<a name='5787'>
            enddo<a name='5788'>
         enddo<a name='5789'>
      enddo<a name='5790'>
<a name='5791'>
      do jt = 1,10<a name='5792'>
         iprsm = 0<a name='5793'>
         do igc = 1,ngc(9)<a name='5794'>
            sumk = 0.<a name='5795'>
            do ipr = 1, ngn(ngs(8)+igc)<a name='5796'>
               iprsm = iprsm + 1<a name='5797'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+128)<a name='5798'>
            enddo<a name='5799'>
            selfref(jt,igc) = sumk<a name='5800'>
         enddo<a name='5801'>
      enddo<a name='5802'>
<a name='5803'>
      do jt = 1,3<a name='5804'>
         iprsm = 0<a name='5805'>
         do igc = 1,ngc(9)<a name='5806'>
            sumk = 0.<a name='5807'>
            do ipr = 1, ngn(ngs(8)+igc)<a name='5808'>
               iprsm = iprsm + 1<a name='5809'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+128)<a name='5810'>
            enddo<a name='5811'>
            forref(jt,igc) = sumk<a name='5812'>
         enddo<a name='5813'>
      enddo<a name='5814'>
<a name='5815'>
      iprsm = 0<a name='5816'>
      do igc = 1,ngc(9)<a name='5817'>
         sumf1 = 0.<a name='5818'>
         sumf2 = 0.<a name='5819'>
         sumf3 = 0.<a name='5820'>
         do ipr = 1, ngn(ngs(8)+igc)<a name='5821'>
            iprsm = iprsm + 1<a name='5822'>
            sumf1 = sumf1 + raylbo(iprsm)*rwgt(iprsm+128)<a name='5823'>
            sumf2 = sumf2 + abso3ao(iprsm)*rwgt(iprsm+128)<a name='5824'>
            sumf3 = sumf3 + abso3bo(iprsm)*rwgt(iprsm+128)<a name='5825'>
         enddo<a name='5826'>
         raylb(igc) = sumf1<a name='5827'>
         abso3a(igc) = sumf2<a name='5828'>
         abso3b(igc) = sumf3<a name='5829'>
      enddo<a name='5830'>
<a name='5831'>
      do jp = 1,9<a name='5832'>
         iprsm = 0<a name='5833'>
         do igc = 1,ngc(9)<a name='5834'>
            sumf1 = 0.<a name='5835'>
            sumf2 = 0.<a name='5836'>
            do ipr = 1, ngn(ngs(8)+igc)<a name='5837'>
               iprsm = iprsm + 1<a name='5838'>
               sumf1 = sumf1 + sfluxrefo(iprsm,jp)<a name='5839'>
               sumf2 = sumf2 + raylao(iprsm,jp)*rwgt(iprsm+128)<a name='5840'>
            enddo<a name='5841'>
            sfluxref(igc,jp) = sumf1<a name='5842'>
            rayla(igc,jp) = sumf2<a name='5843'>
         enddo<a name='5844'>
      enddo<a name='5845'>
<a name='5846'>
      end subroutine cmbgb24<a name='5847'>
<a name='5848'>
<font color=#447700>!***************************************************************************<a name='5849'></font>
<A NAME='CMBGB25'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB25' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5850'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb25</font> <A href='../../call_to/CMBGB25.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB25.html' TARGET='index'>2</A><a name='5851'>
<font color=#447700>!***************************************************************************<a name='5852'></font>
<font color=#447700>!<a name='5853'></font>
<font color=#447700>!     band 25:  16000-22650 cm-1 (low - h2o; high - nothing)<a name='5854'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5855'></font>
<a name='5856'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG25'>rrsw_kg25</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG25_2">, only : kao, sfluxrefo, &amp;<a name='5857'>
                            abso3ao, abso3bo, raylo, &amp;<a name='5858'>
                            absa, ka, sfluxref, &amp;<a name='5859'>
                            abso3a, abso3b, rayl<a name='5860'>
<a name='5861'>
<font color=#447700>! ------- Local -------<a name='5862'></font>
      integer(kind=im) :: jt, jp, igc, ipr, iprsm<a name='5863'>
      real(kind=rb) :: sumk, sumf1, sumf2, sumf3, sumf4<a name='5864'>
<a name='5865'>
<a name='5866'>
      do jt = 1,5<a name='5867'>
         do jp = 1,13<a name='5868'>
            iprsm = 0<a name='5869'>
            do igc = 1,ngc(10)<a name='5870'>
               sumk = 0.<a name='5871'>
               do ipr = 1, ngn(ngs(9)+igc)<a name='5872'>
                  iprsm = iprsm + 1<a name='5873'>
                  sumk = sumk + kao(jt,jp,iprsm)*rwgt(iprsm+144)<a name='5874'>
               enddo<a name='5875'>
               ka(jt,jp,igc) = sumk<a name='5876'>
            enddo<a name='5877'>
         enddo<a name='5878'>
      enddo<a name='5879'>
<a name='5880'>
      iprsm = 0<a name='5881'>
      do igc = 1,ngc(10)<a name='5882'>
         sumf1 = 0.<a name='5883'>
         sumf2 = 0.<a name='5884'>
         sumf3 = 0.<a name='5885'>
         sumf4 = 0.<a name='5886'>
         do ipr = 1, ngn(ngs(9)+igc)<a name='5887'>
            iprsm = iprsm + 1<a name='5888'>
            sumf1 = sumf1 + sfluxrefo(iprsm)<a name='5889'>
            sumf2 = sumf2 + abso3ao(iprsm)*rwgt(iprsm+144)<a name='5890'>
            sumf3 = sumf3 + abso3bo(iprsm)*rwgt(iprsm+144)<a name='5891'>
            sumf4 = sumf4 + raylo(iprsm)*rwgt(iprsm+144)<a name='5892'>
         enddo<a name='5893'>
         sfluxref(igc) = sumf1<a name='5894'>
         abso3a(igc) = sumf2<a name='5895'>
         abso3b(igc) = sumf3<a name='5896'>
         rayl(igc) = sumf4<a name='5897'>
      enddo<a name='5898'>
<a name='5899'>
      end subroutine cmbgb25<a name='5900'>
<a name='5901'>
<font color=#447700>!***************************************************************************<a name='5902'></font>
<A NAME='CMBGB26'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB26' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5903'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb26</font> <A href='../../call_to/CMBGB26.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB26.html' TARGET='index'>2</A><a name='5904'>
<font color=#447700>!***************************************************************************<a name='5905'></font>
<font color=#447700>!<a name='5906'></font>
<font color=#447700>!     band 26:  22650-29000 cm-1 (low - nothing; high - nothing)<a name='5907'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5908'></font>
<a name='5909'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG26'>rrsw_kg26</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG26_2">, only : sfluxrefo, raylo, &amp;<a name='5910'>
                            sfluxref, rayl<a name='5911'>
<a name='5912'>
<font color=#447700>! ------- Local -------<a name='5913'></font>
      integer(kind=im) :: igc, ipr, iprsm<a name='5914'>
      real(kind=rb) :: sumf1, sumf2<a name='5915'>
<a name='5916'>
<a name='5917'>
      iprsm = 0<a name='5918'>
      do igc = 1,ngc(11)<a name='5919'>
         sumf1 = 0.<a name='5920'>
         sumf2 = 0.<a name='5921'>
         do ipr = 1, ngn(ngs(10)+igc)<a name='5922'>
            iprsm = iprsm + 1<a name='5923'>
            sumf1 = sumf1 + raylo(iprsm)*rwgt(iprsm+160)<a name='5924'>
            sumf2 = sumf2 + sfluxrefo(iprsm)<a name='5925'>
         enddo<a name='5926'>
         rayl(igc) = sumf1<a name='5927'>
         sfluxref(igc) = sumf2<a name='5928'>
      enddo<a name='5929'>
<a name='5930'>
      end subroutine cmbgb26<a name='5931'>
<a name='5932'>
<font color=#447700>!***************************************************************************<a name='5933'></font>
<A NAME='CMBGB27'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB27' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5934'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb27</font> <A href='../../call_to/CMBGB27.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB27.html' TARGET='index'>2</A><a name='5935'>
<font color=#447700>!***************************************************************************<a name='5936'></font>
<font color=#447700>!<a name='5937'></font>
<font color=#447700>!     band 27:  29000-38000 cm-1 (low - o3; high - o3)<a name='5938'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5939'></font>
<a name='5940'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG27'>rrsw_kg27</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG27_2">, only : kao, kbo, sfluxrefo, raylo, &amp;<a name='5941'>
                            absa, ka, absb, kb, sfluxref, rayl<a name='5942'>
<a name='5943'>
<font color=#447700>! ------- Local -------<a name='5944'></font>
      integer(kind=im) :: jt, jp, igc, ipr, iprsm<a name='5945'>
      real(kind=rb) :: sumk, sumf1, sumf2<a name='5946'>
<a name='5947'>
<a name='5948'>
      do jt = 1,5<a name='5949'>
         do jp = 1,13<a name='5950'>
            iprsm = 0<a name='5951'>
            do igc = 1,ngc(12)<a name='5952'>
               sumk = 0.<a name='5953'>
               do ipr = 1, ngn(ngs(11)+igc)<a name='5954'>
                  iprsm = iprsm + 1<a name='5955'>
                  sumk = sumk + kao(jt,jp,iprsm)*rwgt(iprsm+176)<a name='5956'>
               enddo<a name='5957'>
               ka(jt,jp,igc) = sumk<a name='5958'>
            enddo<a name='5959'>
         enddo<a name='5960'>
         do jp = 13,59<a name='5961'>
            iprsm = 0<a name='5962'>
            do igc = 1,ngc(12)<a name='5963'>
               sumk = 0.<a name='5964'>
               do ipr = 1, ngn(ngs(11)+igc)<a name='5965'>
                  iprsm = iprsm + 1<a name='5966'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+176)<a name='5967'>
               enddo<a name='5968'>
               kb(jt,jp,igc) = sumk<a name='5969'>
            enddo<a name='5970'>
         enddo<a name='5971'>
      enddo<a name='5972'>
<a name='5973'>
      iprsm = 0<a name='5974'>
      do igc = 1,ngc(12)<a name='5975'>
         sumf1 = 0.<a name='5976'>
         sumf2 = 0.<a name='5977'>
         do ipr = 1, ngn(ngs(11)+igc)<a name='5978'>
            iprsm = iprsm + 1<a name='5979'>
            sumf1 = sumf1 + sfluxrefo(iprsm)<a name='5980'>
            sumf2 = sumf2 + raylo(iprsm)*rwgt(iprsm+176)<a name='5981'>
         enddo<a name='5982'>
         sfluxref(igc) = sumf1<a name='5983'>
         rayl(igc) = sumf2<a name='5984'>
      enddo<a name='5985'>
<a name='5986'>
      end subroutine cmbgb27<a name='5987'>
<a name='5988'>
<font color=#447700>!***************************************************************************<a name='5989'></font>
<A NAME='CMBGB28'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB28' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5990'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb28</font> <A href='../../call_to/CMBGB28.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB28.html' TARGET='index'>2</A><a name='5991'>
<font color=#447700>!***************************************************************************<a name='5992'></font>
<font color=#447700>!<a name='5993'></font>
<font color=#447700>!     band 28:  38000-50000 cm-1 (low - o3,o2; high - o3,o2)<a name='5994'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5995'></font>
<a name='5996'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG28'>rrsw_kg28</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG28_2">, only : kao, kbo, sfluxrefo, &amp;<a name='5997'>
                            absa, ka, absb, kb, sfluxref<a name='5998'>
<a name='5999'>
<font color=#447700>! ------- Local -------<a name='6000'></font>
      integer(kind=im) :: jn, jt, jp, igc, ipr, iprsm<a name='6001'>
      real(kind=rb) :: sumk, sumf<a name='6002'>
<a name='6003'>
<a name='6004'>
      do jn = 1,9<a name='6005'>
         do jt = 1,5<a name='6006'>
            do jp = 1,13<a name='6007'>
               iprsm = 0<a name='6008'>
               do igc = 1,ngc(13)<a name='6009'>
                  sumk = 0.<a name='6010'>
                  do ipr = 1, ngn(ngs(12)+igc)<a name='6011'>
                     iprsm = iprsm + 1<a name='6012'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+192)<a name='6013'>
                  enddo<a name='6014'>
                  ka(jn,jt,jp,igc) = sumk<a name='6015'>
               enddo<a name='6016'>
            enddo<a name='6017'>
         enddo<a name='6018'>
      enddo<a name='6019'>
<a name='6020'>
      do jn = 1,5<a name='6021'>
         do jt = 1,5<a name='6022'>
            do jp = 13,59<a name='6023'>
               iprsm = 0<a name='6024'>
               do igc = 1,ngc(13)<a name='6025'>
                  sumk = 0.<a name='6026'>
                  do ipr = 1, ngn(ngs(12)+igc)<a name='6027'>
                     iprsm = iprsm + 1<a name='6028'>
                     sumk = sumk + kbo(jn,jt,jp,iprsm)*rwgt(iprsm+192)<a name='6029'>
                  enddo<a name='6030'>
                  kb(jn,jt,jp,igc) = sumk<a name='6031'>
               enddo<a name='6032'>
            enddo<a name='6033'>
         enddo<a name='6034'>
      enddo<a name='6035'>
<a name='6036'>
      do jp = 1,5<a name='6037'>
         iprsm = 0<a name='6038'>
         do igc = 1,ngc(13)<a name='6039'>
            sumf = 0.<a name='6040'>
            do ipr = 1, ngn(ngs(12)+igc)<a name='6041'>
               iprsm = iprsm + 1<a name='6042'>
               sumf = sumf + sfluxrefo(iprsm,jp)<a name='6043'>
            enddo<a name='6044'>
            sfluxref(igc,jp) = sumf<a name='6045'>
         enddo<a name='6046'>
      enddo<a name='6047'>
<a name='6048'>
      end subroutine cmbgb28<a name='6049'>
<a name='6050'>
<font color=#447700>!***************************************************************************<a name='6051'></font>
<A NAME='CMBGB29'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#CMBGB29' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6052'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb29</font> <A href='../../call_to/CMBGB29.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB29.html' TARGET='index'>2</A><a name='6053'>
<font color=#447700>!***************************************************************************<a name='6054'></font>
<font color=#447700>!<a name='6055'></font>
<font color=#447700>!     band 29:  820-2600 cm-1 (low - h2o; high - co2)<a name='6056'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='6057'></font>
<a name='6058'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG29'>rrsw_kg29</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG29_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='6059'>
                            absh2oo, absco2o, &amp;<a name='6060'>
                            absa, ka, absb, kb, selfref, forref, sfluxref, &amp;<a name='6061'>
                            absh2o, absco2<a name='6062'>
<a name='6063'>
<font color=#447700>! ------- Local -------<a name='6064'></font>
      integer(kind=im) :: jt, jp, igc, ipr, iprsm<a name='6065'>
      real(kind=rb) :: sumk, sumf1, sumf2, sumf3<a name='6066'>
<a name='6067'>
<a name='6068'>
      do jt = 1,5<a name='6069'>
         do jp = 1,13<a name='6070'>
            iprsm = 0<a name='6071'>
            do igc = 1,ngc(14)<a name='6072'>
               sumk = 0.<a name='6073'>
               do ipr = 1, ngn(ngs(13)+igc)<a name='6074'>
                  iprsm = iprsm + 1<a name='6075'>
                  sumk = sumk + kao(jt,jp,iprsm)*rwgt(iprsm+208)<a name='6076'>
               enddo<a name='6077'>
               ka(jt,jp,igc) = sumk<a name='6078'>
            enddo<a name='6079'>
         enddo<a name='6080'>
         do jp = 13,59<a name='6081'>
            iprsm = 0<a name='6082'>
            do igc = 1,ngc(14)<a name='6083'>
               sumk = 0.<a name='6084'>
               do ipr = 1, ngn(ngs(13)+igc)<a name='6085'>
                  iprsm = iprsm + 1<a name='6086'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+208)<a name='6087'>
               enddo<a name='6088'>
               kb(jt,jp,igc) = sumk<a name='6089'>
            enddo<a name='6090'>
         enddo<a name='6091'>
      enddo<a name='6092'>
<a name='6093'>
      do jt = 1,10<a name='6094'>
         iprsm = 0<a name='6095'>
         do igc = 1,ngc(14)<a name='6096'>
            sumk = 0.<a name='6097'>
            do ipr = 1, ngn(ngs(13)+igc)<a name='6098'>
               iprsm = iprsm + 1<a name='6099'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+208)<a name='6100'>
            enddo<a name='6101'>
            selfref(jt,igc) = sumk<a name='6102'>
         enddo<a name='6103'>
      enddo<a name='6104'>
<a name='6105'>
      do jt = 1,4<a name='6106'>
         iprsm = 0<a name='6107'>
         do igc = 1,ngc(14)<a name='6108'>
            sumk = 0.<a name='6109'>
            do ipr = 1, ngn(ngs(13)+igc)<a name='6110'>
               iprsm = iprsm + 1<a name='6111'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+208)<a name='6112'>
            enddo<a name='6113'>
            forref(jt,igc) = sumk<a name='6114'>
         enddo<a name='6115'>
      enddo<a name='6116'>
<a name='6117'>
      iprsm = 0<a name='6118'>
      do igc = 1,ngc(14)<a name='6119'>
         sumf1 = 0.<a name='6120'>
         sumf2 = 0.<a name='6121'>
         sumf3 = 0.<a name='6122'>
         do ipr = 1, ngn(ngs(13)+igc)<a name='6123'>
            iprsm = iprsm + 1<a name='6124'>
            sumf1 = sumf1 + sfluxrefo(iprsm)<a name='6125'>
            sumf2 = sumf2 + absco2o(iprsm)*rwgt(iprsm+208)<a name='6126'>
            sumf3 = sumf3 + absh2oo(iprsm)*rwgt(iprsm+208)<a name='6127'>
         enddo<a name='6128'>
         sfluxref(igc) = sumf1<a name='6129'>
         absco2(igc) = sumf2<a name='6130'>
         absh2o(igc) = sumf3<a name='6131'>
      enddo<a name='6132'>
<a name='6133'>
      end subroutine cmbgb29<a name='6134'>
<a name='6135'>
<font color=#447700>!***********************************************************************<a name='6136'></font>
<A NAME='SWCLDPR'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SWCLDPR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6137'>
      <font color=#993300>subroutine </font><font color=#cc0000>swcldpr</font> <A href='../../call_to/SWCLDPR.html' TARGET='index'>2</A>,<A href='../../call_from/SWCLDPR.html' TARGET='index'>2</A><a name='6138'>
<a name='6139'>
<font color=#447700>! Purpose: Define cloud extinction coefficient, single scattering albedo<a name='6140'></font>
<font color=#447700>!          and asymmetry parameter data.<a name='6141'></font>
<font color=#447700>!<a name='6142'></font>
<a name='6143'>
<font color=#447700>! ------- Modules -------<a name='6144'></font>
<a name='6145'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_CLD'>rrsw_cld</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWCLDPR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CLD_2">, only : extliq1, ssaliq1, asyliq1, &amp;<a name='6146'>
                           extice2, ssaice2, asyice2, &amp;<a name='6147'>
                           extice3, ssaice3, asyice3, fdlice3, &amp;<a name='6148'>
                           abari, bbari, cbari, dbari, ebari, fbari<a name='6149'>
<a name='6150'>
      save<a name='6151'>
<a name='6152'>
<font color=#447700>!-----------------------------------------------------------------------<a name='6153'></font>
<font color=#447700>!<a name='6154'></font>
<font color=#447700>! Explanation of the method for each value of INFLAG.  A value of<a name='6155'></font>
<font color=#447700>!  0 for INFLAG do not distingish being liquid and ice clouds.<a name='6156'></font>
<font color=#447700>!  INFLAG = 2 does distinguish between liquid and ice clouds, and<a name='6157'></font>
<font color=#447700>!    requires further user input to specify the method to be used to <a name='6158'></font>
<font color=#447700>!    compute the aborption due to each.<a name='6159'></font>
<font color=#447700>!  INFLAG = 0:  For each cloudy layer, the cloud fraction, the cloud optical<a name='6160'></font>
<font color=#447700>!    depth, the cloud single-scattering albedo, and the<a name='6161'></font>
<font color=#447700>!    moments of the phase function (0:NSTREAM).  Note<a name='6162'></font>
<font color=#447700>!    that these values are delta-m scaled within this<a name='6163'></font>
<font color=#447700>!    subroutine.<a name='6164'></font>
<a name='6165'>
<font color=#447700>!  INFLAG = 2:  For each cloudy layer, the cloud fraction, cloud <a name='6166'></font>
<font color=#447700>!    water path (g/m2), and cloud ice fraction are input.<a name='6167'></font>
<font color=#447700>!  ICEFLAG = 2:  The ice effective radius (microns) is input and the<a name='6168'></font>
<font color=#447700>!    optical properties due to ice clouds are computed from<a name='6169'></font>
<font color=#447700>!    the optical properties stored in the RT code, STREAMER v3.0 <a name='6170'></font>
<font color=#447700>!    (Reference: Key. J., Streamer User's Guide, Cooperative <a name='6171'></font>
<font color=#447700>!    Institute for Meteorological Satellite Studies, 2001, 96 pp.).<a name='6172'></font>
<font color=#447700>!    Valid range of values for re are between 5.0 and<a name='6173'></font>
<font color=#447700>!    131.0 micron.<a name='6174'></font>
<font color=#447700>!    This version uses Ebert and Curry, JGR, (1992) method for <a name='6175'></font>
<font color=#447700>!    ice particles larger than 131.0 microns. <a name='6176'></font>
<font color=#447700>!  ICEFLAG = 3:  The ice generalized effective size (dge) is input<a name='6177'></font>
<font color=#447700>!    and the optical depths, single-scattering albedo,<a name='6178'></font>
<font color=#447700>!    and phase function moments are calculated as in<a name='6179'></font>
<font color=#447700>!    Q. Fu, J. Climate, (1996). Q. Fu provided high resolution<a name='6180'></font>
<font color=#447700>!    tables which were appropriately averaged for the<a name='6181'></font>
<font color=#447700>!    bands in RRTM_SW.  Linear interpolation is used to<a name='6182'></font>
<font color=#447700>!    get the coefficients from the stored tables.<a name='6183'></font>
<font color=#447700>!    Valid range of values for dge are between 5.0 and<a name='6184'></font>
<font color=#447700>!    140.0 micron. <a name='6185'></font>
<font color=#447700>!    This version uses Ebert and Curry, JGR, (1992) method for <a name='6186'></font>
<font color=#447700>!    ice particles larger than 140.0 microns. <a name='6187'></font>
<font color=#447700>!  LIQFLAG = 1:  The water droplet effective radius (microns) is input <a name='6188'></font>
<font color=#447700>!    and the optical depths due to water clouds are computed <a name='6189'></font>
<font color=#447700>!    as in Hu and Stamnes, J., Clim., 6, 728-742, (1993) with<a name='6190'></font>
<font color=#447700>!    modified coefficients derived from Mie scattering calculations. <a name='6191'></font>
<font color=#447700>!    The values for absorption coefficients appropriate for<a name='6192'></font>
<font color=#447700>!    the spectral bands in RRTM/RRTMG have been obtained for a <a name='6193'></font>
<font color=#447700>!    range of effective radii by an averaging procedure <a name='6194'></font>
<font color=#447700>!    based on the work of J. Pinto (private communication).<a name='6195'></font>
<font color=#447700>!    Linear interpolation is used to get the absorption <a name='6196'></font>
<font color=#447700>!    coefficients for the input effective radius.<a name='6197'></font>
<font color=#447700>!<a name='6198'></font>
<font color=#447700>!..Updated tables suggested by Peter Blossey (Univ. Washington) that came from RRTM v3.9 from AER, Inc.<a name='6199'></font>
<font color=#447700>!<a name='6200'></font>
<font color=#447700>!     ------------------------------------------------------------------<a name='6201'></font>
<a name='6202'>
<font color=#447700>! Everything below is for INFLAG = 2.<a name='6203'></font>
<a name='6204'>
<font color=#447700>! Coefficients for Ebert and Curry method<a name='6205'></font>
      abari(:) = (/ &amp;<a name='6206'>
        &amp; 3.448e-03_rb,3.448e-03_rb,3.448e-03_rb,3.448e-03_rb,3.448e-03_rb /)<a name='6207'>
      bbari(:) = (/ &amp;<a name='6208'>
        &amp; 2.431e+00_rb,2.431e+00_rb,2.431e+00_rb,2.431e+00_rb,2.431e+00_rb /)<a name='6209'>
      cbari(:) = (/ &amp;<a name='6210'>
        &amp; 1.000e-05_rb,1.100e-04_rb,1.240e-02_rb,3.779e-02_rb,4.666e-01_rb /)<a name='6211'>
      dbari(:) = (/ &amp;<a name='6212'>
        &amp; 0.000e+00_rb,1.405e-05_rb,6.867e-04_rb,1.284e-03_rb,2.050e-05_rb /)<a name='6213'>
      ebari(:) = (/ &amp;<a name='6214'>
        &amp; 7.661e-01_rb,7.730e-01_rb,7.865e-01_rb,8.172e-01_rb,9.595e-01_rb /)<a name='6215'>
      fbari(:) = (/ &amp;<a name='6216'>
        &amp; 5.851e-04_rb,5.665e-04_rb,7.204e-04_rb,7.463e-04_rb,1.076e-04_rb /)<a name='6217'>
<a name='6218'>
<font color=#447700>! LIQFLAG==1 extinction coefficients, single scattering albedos, and asymmetry parameters<a name='6219'></font>
<font color=#447700>!   Derived from on Mie scattering computations; based on Hu &amp; Stamnes coefficients<a name='6220'></font>
<font color=#447700>!     BAND  16<a name='6221'></font>
      extliq1(:, 16) = (/ &amp;<a name='6222'>
        &amp; 9.004493E-01_rb,6.366723E-01_rb,4.542354E-01_rb,3.468253E-01_rb,2.816431E-01_rb,&amp;<a name='6223'>
        &amp; 2.383415E-01_rb,2.070854E-01_rb,1.831854E-01_rb,1.642115E-01_rb,1.487539E-01_rb,&amp;<a name='6224'>
        &amp; 1.359169E-01_rb,1.250900E-01_rb,1.158354E-01_rb,1.078400E-01_rb,1.008646E-01_rb,&amp;<a name='6225'>
        &amp; 9.472307E-02_rb,8.928000E-02_rb,8.442308E-02_rb,8.005924E-02_rb,7.612231E-02_rb,&amp;<a name='6226'>
        &amp; 7.255153E-02_rb,6.929539E-02_rb,6.631769E-02_rb,6.358153E-02_rb,6.106231E-02_rb,&amp;<a name='6227'>
        &amp; 5.873077E-02_rb,5.656924E-02_rb,5.455769E-02_rb,5.267846E-02_rb,5.091923E-02_rb,&amp;<a name='6228'>
        &amp; 4.926692E-02_rb,4.771154E-02_rb,4.623923E-02_rb,4.484385E-02_rb,4.351539E-02_rb,&amp;<a name='6229'>
        &amp; 4.224615E-02_rb,4.103385E-02_rb,3.986538E-02_rb,3.874077E-02_rb,3.765462E-02_rb,&amp;<a name='6230'>
        &amp; 3.660077E-02_rb,3.557384E-02_rb,3.457615E-02_rb,3.360308E-02_rb,3.265000E-02_rb,&amp;<a name='6231'>
        &amp; 3.171770E-02_rb,3.080538E-02_rb,2.990846E-02_rb,2.903000E-02_rb,2.816461E-02_rb,&amp;<a name='6232'>
        &amp; 2.731539E-02_rb,2.648231E-02_rb,2.566308E-02_rb,2.485923E-02_rb,2.407000E-02_rb,&amp;<a name='6233'>
        &amp; 2.329615E-02_rb,2.253769E-02_rb,2.179615E-02_rb /)<a name='6234'>
<font color=#447700>!     BAND  17<a name='6235'></font>
      extliq1(:, 17) = (/ &amp;<a name='6236'>
       &amp; 6.741200e-01_rb,5.390739e-01_rb,4.198767e-01_rb,3.332553e-01_rb,2.735633e-01_rb,&amp;<a name='6237'>
       &amp; 2.317727e-01_rb,2.012760e-01_rb,1.780400e-01_rb,1.596927e-01_rb,1.447980e-01_rb,&amp;<a name='6238'>
       &amp; 1.324480e-01_rb,1.220347e-01_rb,1.131327e-01_rb,1.054313e-01_rb,9.870534e-02_rb,&amp;<a name='6239'>
       &amp; 9.278200e-02_rb,8.752599e-02_rb,8.282933e-02_rb,7.860600e-02_rb,7.479133e-02_rb,&amp;<a name='6240'>
       &amp; 7.132800e-02_rb,6.816733e-02_rb,6.527401e-02_rb,6.261266e-02_rb,6.015934e-02_rb,&amp;<a name='6241'>
       &amp; 5.788867e-02_rb,5.578134e-02_rb,5.381667e-02_rb,5.198133e-02_rb,5.026067e-02_rb,&amp;<a name='6242'>
       &amp; 4.864466e-02_rb,4.712267e-02_rb,4.568066e-02_rb,4.431200e-02_rb,4.300867e-02_rb,&amp;<a name='6243'>
       &amp; 4.176600e-02_rb,4.057400e-02_rb,3.942534e-02_rb,3.832066e-02_rb,3.725068e-02_rb,&amp;<a name='6244'>
       &amp; 3.621400e-02_rb,3.520533e-02_rb,3.422333e-02_rb,3.326400e-02_rb,3.232467e-02_rb,&amp;<a name='6245'>
       &amp; 3.140535e-02_rb,3.050400e-02_rb,2.962000e-02_rb,2.875267e-02_rb,2.789800e-02_rb,&amp;<a name='6246'>
       &amp; 2.705934e-02_rb,2.623667e-02_rb,2.542667e-02_rb,2.463200e-02_rb,2.385267e-02_rb,&amp;<a name='6247'>
       &amp; 2.308667e-02_rb,2.233667e-02_rb,2.160067e-02_rb /)<a name='6248'>
<font color=#447700>!     BAND  18<a name='6249'></font>
      extliq1(:, 18) = (/ &amp;<a name='6250'>
       &amp; 9.250861e-01_rb,6.245692e-01_rb,4.347038e-01_rb,3.320208e-01_rb,2.714869e-01_rb,&amp;<a name='6251'>
       &amp; 2.309516e-01_rb,2.012592e-01_rb,1.783315e-01_rb,1.600369e-01_rb,1.451000e-01_rb,&amp;<a name='6252'>
       &amp; 1.326838e-01_rb,1.222069e-01_rb,1.132554e-01_rb,1.055146e-01_rb,9.876000e-02_rb,&amp;<a name='6253'>
       &amp; 9.281386e-02_rb,8.754000e-02_rb,8.283078e-02_rb,7.860077e-02_rb,7.477769e-02_rb,&amp;<a name='6254'>
       &amp; 7.130847e-02_rb,6.814461e-02_rb,6.524615e-02_rb,6.258462e-02_rb,6.012847e-02_rb,&amp;<a name='6255'>
       &amp; 5.785462e-02_rb,5.574231e-02_rb,5.378000e-02_rb,5.194461e-02_rb,5.022462e-02_rb,&amp;<a name='6256'>
       &amp; 4.860846e-02_rb,4.708462e-02_rb,4.564154e-02_rb,4.427462e-02_rb,4.297231e-02_rb,&amp;<a name='6257'>
       &amp; 4.172769e-02_rb,4.053693e-02_rb,3.939000e-02_rb,3.828462e-02_rb,3.721692e-02_rb,&amp;<a name='6258'>
       &amp; 3.618000e-02_rb,3.517077e-02_rb,3.418923e-02_rb,3.323077e-02_rb,3.229154e-02_rb,&amp;<a name='6259'>
       &amp; 3.137154e-02_rb,3.047154e-02_rb,2.959077e-02_rb,2.872308e-02_rb,2.786846e-02_rb,&amp;<a name='6260'>
       &amp; 2.703077e-02_rb,2.620923e-02_rb,2.540077e-02_rb,2.460615e-02_rb,2.382693e-02_rb,&amp;<a name='6261'>
       &amp; 2.306231e-02_rb,2.231231e-02_rb,2.157923e-02_rb /)<a name='6262'>
<font color=#447700>!     BAND  19<a name='6263'></font>
      extliq1(:, 19) = (/ &amp;<a name='6264'>
       &amp; 9.298960e-01_rb,5.776460e-01_rb,4.083450e-01_rb,3.211160e-01_rb,2.666390e-01_rb,&amp;<a name='6265'>
       &amp; 2.281990e-01_rb,1.993250e-01_rb,1.768080e-01_rb,1.587810e-01_rb,1.440390e-01_rb,&amp;<a name='6266'>
       &amp; 1.317720e-01_rb,1.214150e-01_rb,1.125540e-01_rb,1.048890e-01_rb,9.819600e-02_rb,&amp;<a name='6267'>
       &amp; 9.230201e-02_rb,8.706900e-02_rb,8.239698e-02_rb,7.819500e-02_rb,7.439899e-02_rb,&amp;<a name='6268'>
       &amp; 7.095300e-02_rb,6.780700e-02_rb,6.492900e-02_rb,6.228600e-02_rb,5.984600e-02_rb,&amp;<a name='6269'>
       &amp; 5.758599e-02_rb,5.549099e-02_rb,5.353801e-02_rb,5.171400e-02_rb,5.000500e-02_rb,&amp;<a name='6270'>
       &amp; 4.840000e-02_rb,4.688500e-02_rb,4.545100e-02_rb,4.409300e-02_rb,4.279700e-02_rb,&amp;<a name='6271'>
       &amp; 4.156100e-02_rb,4.037700e-02_rb,3.923800e-02_rb,3.813800e-02_rb,3.707600e-02_rb,&amp;<a name='6272'>
       &amp; 3.604500e-02_rb,3.504300e-02_rb,3.406500e-02_rb,3.310800e-02_rb,3.217700e-02_rb,&amp;<a name='6273'>
       &amp; 3.126600e-02_rb,3.036800e-02_rb,2.948900e-02_rb,2.862400e-02_rb,2.777500e-02_rb,&amp;<a name='6274'>
       &amp; 2.694200e-02_rb,2.612300e-02_rb,2.531700e-02_rb,2.452800e-02_rb,2.375100e-02_rb,&amp;<a name='6275'>
       &amp; 2.299100e-02_rb,2.224300e-02_rb,2.151201e-02_rb /)<a name='6276'>
<font color=#447700>!     BAND  20<a name='6277'></font>
      extliq1(:, 20) = (/ &amp;<a name='6278'>
       &amp; 8.780964e-01_rb,5.407031e-01_rb,3.961100e-01_rb,3.166645e-01_rb,2.640455e-01_rb,&amp;<a name='6279'>
       &amp; 2.261070e-01_rb,1.974820e-01_rb,1.751775e-01_rb,1.573415e-01_rb,1.427725e-01_rb,&amp;<a name='6280'>
       &amp; 1.306535e-01_rb,1.204195e-01_rb,1.116650e-01_rb,1.040915e-01_rb,9.747550e-02_rb,&amp;<a name='6281'>
       &amp; 9.164800e-02_rb,8.647649e-02_rb,8.185501e-02_rb,7.770200e-02_rb,7.394749e-02_rb,&amp;<a name='6282'>
       &amp; 7.053800e-02_rb,6.742700e-02_rb,6.457999e-02_rb,6.196149e-02_rb,5.954450e-02_rb,&amp;<a name='6283'>
       &amp; 5.730650e-02_rb,5.522949e-02_rb,5.329450e-02_rb,5.148500e-02_rb,4.979000e-02_rb,&amp;<a name='6284'>
       &amp; 4.819600e-02_rb,4.669301e-02_rb,4.527050e-02_rb,4.391899e-02_rb,4.263500e-02_rb,&amp;<a name='6285'>
       &amp; 4.140500e-02_rb,4.022850e-02_rb,3.909500e-02_rb,3.800199e-02_rb,3.694600e-02_rb,&amp;<a name='6286'>
       &amp; 3.592000e-02_rb,3.492250e-02_rb,3.395050e-02_rb,3.300150e-02_rb,3.207250e-02_rb,&amp;<a name='6287'>
       &amp; 3.116250e-02_rb,3.027100e-02_rb,2.939500e-02_rb,2.853500e-02_rb,2.768900e-02_rb,&amp;<a name='6288'>
       &amp; 2.686000e-02_rb,2.604350e-02_rb,2.524150e-02_rb,2.445350e-02_rb,2.368049e-02_rb,&amp;<a name='6289'>
       &amp; 2.292150e-02_rb,2.217800e-02_rb,2.144800e-02_rb /)<a name='6290'>
<font color=#447700>!     BAND  21<a name='6291'></font>
      extliq1(:, 21) = (/ &amp;<a name='6292'>
       &amp; 7.937480e-01_rb,5.123036e-01_rb,3.858181e-01_rb,3.099622e-01_rb,2.586829e-01_rb,&amp;<a name='6293'>
       &amp; 2.217587e-01_rb,1.939755e-01_rb,1.723397e-01_rb,1.550258e-01_rb,1.408600e-01_rb,&amp;<a name='6294'>
       &amp; 1.290545e-01_rb,1.190661e-01_rb,1.105039e-01_rb,1.030848e-01_rb,9.659387e-02_rb,&amp;<a name='6295'>
       &amp; 9.086775e-02_rb,8.577807e-02_rb,8.122452e-02_rb,7.712711e-02_rb,7.342193e-02_rb,&amp;<a name='6296'>
       &amp; 7.005387e-02_rb,6.697840e-02_rb,6.416000e-02_rb,6.156903e-02_rb,5.917484e-02_rb,&amp;<a name='6297'>
       &amp; 5.695807e-02_rb,5.489968e-02_rb,5.298097e-02_rb,5.118806e-02_rb,4.950645e-02_rb,&amp;<a name='6298'>
       &amp; 4.792710e-02_rb,4.643581e-02_rb,4.502484e-02_rb,4.368547e-02_rb,4.241001e-02_rb,&amp;<a name='6299'>
       &amp; 4.118936e-02_rb,4.002193e-02_rb,3.889711e-02_rb,3.781322e-02_rb,3.676387e-02_rb,&amp;<a name='6300'>
       &amp; 3.574549e-02_rb,3.475548e-02_rb,3.379033e-02_rb,3.284678e-02_rb,3.192420e-02_rb,&amp;<a name='6301'>
       &amp; 3.102032e-02_rb,3.013484e-02_rb,2.926258e-02_rb,2.840839e-02_rb,2.756742e-02_rb,&amp;<a name='6302'>
       &amp; 2.674258e-02_rb,2.593064e-02_rb,2.513258e-02_rb,2.435000e-02_rb,2.358064e-02_rb,&amp;<a name='6303'>
       &amp; 2.282581e-02_rb,2.208548e-02_rb,2.135936e-02_rb /)<a name='6304'>
<font color=#447700>!     BAND  22<a name='6305'></font>
      extliq1(:, 22) = (/ &amp;<a name='6306'>
       &amp; 7.533129e-01_rb,5.033129e-01_rb,3.811271e-01_rb,3.062757e-01_rb,2.558729e-01_rb,&amp;<a name='6307'>
       &amp; 2.196828e-01_rb,1.924372e-01_rb,1.711714e-01_rb,1.541086e-01_rb,1.401114e-01_rb,&amp;<a name='6308'>
       &amp; 1.284257e-01_rb,1.185200e-01_rb,1.100243e-01_rb,1.026529e-01_rb,9.620142e-02_rb,&amp;<a name='6309'>
       &amp; 9.050714e-02_rb,8.544428e-02_rb,8.091714e-02_rb,7.684000e-02_rb,7.315429e-02_rb,&amp;<a name='6310'>
       &amp; 6.980143e-02_rb,6.673999e-02_rb,6.394000e-02_rb,6.136000e-02_rb,5.897715e-02_rb,&amp;<a name='6311'>
       &amp; 5.677000e-02_rb,5.472285e-02_rb,5.281286e-02_rb,5.102858e-02_rb,4.935429e-02_rb,&amp;<a name='6312'>
       &amp; 4.778000e-02_rb,4.629714e-02_rb,4.489142e-02_rb,4.355857e-02_rb,4.228715e-02_rb,&amp;<a name='6313'>
       &amp; 4.107285e-02_rb,3.990857e-02_rb,3.879000e-02_rb,3.770999e-02_rb,3.666429e-02_rb,&amp;<a name='6314'>
       &amp; 3.565000e-02_rb,3.466286e-02_rb,3.370143e-02_rb,3.276143e-02_rb,3.184143e-02_rb,&amp;<a name='6315'>
       &amp; 3.094000e-02_rb,3.005714e-02_rb,2.919000e-02_rb,2.833714e-02_rb,2.750000e-02_rb,&amp;<a name='6316'>
       &amp; 2.667714e-02_rb,2.586714e-02_rb,2.507143e-02_rb,2.429143e-02_rb,2.352428e-02_rb,&amp;<a name='6317'>
       &amp; 2.277143e-02_rb,2.203429e-02_rb,2.130857e-02_rb /)<a name='6318'>
<font color=#447700>!     BAND  23<a name='6319'></font>
      extliq1(:, 23) = (/ &amp;<a name='6320'>
       &amp; 7.079894e-01_rb,4.878198e-01_rb,3.719852e-01_rb,3.001873e-01_rb,2.514795e-01_rb,&amp;<a name='6321'>
       &amp; 2.163013e-01_rb,1.897100e-01_rb,1.689033e-01_rb,1.521793e-01_rb,1.384449e-01_rb,&amp;<a name='6322'>
       &amp; 1.269666e-01_rb,1.172326e-01_rb,1.088745e-01_rb,1.016224e-01_rb,9.527085e-02_rb,&amp;<a name='6323'>
       &amp; 8.966240e-02_rb,8.467543e-02_rb,8.021144e-02_rb,7.619344e-02_rb,7.255676e-02_rb,&amp;<a name='6324'>
       &amp; 6.924996e-02_rb,6.623030e-02_rb,6.346261e-02_rb,6.091499e-02_rb,5.856325e-02_rb,&amp;<a name='6325'>
       &amp; 5.638385e-02_rb,5.435930e-02_rb,5.247156e-02_rb,5.070699e-02_rb,4.905230e-02_rb,&amp;<a name='6326'>
       &amp; 4.749499e-02_rb,4.602611e-02_rb,4.463581e-02_rb,4.331543e-02_rb,4.205647e-02_rb,&amp;<a name='6327'>
       &amp; 4.085241e-02_rb,3.969978e-02_rb,3.859033e-02_rb,3.751877e-02_rb,3.648168e-02_rb,&amp;<a name='6328'>
       &amp; 3.547468e-02_rb,3.449553e-02_rb,3.354072e-02_rb,3.260732e-02_rb,3.169438e-02_rb,&amp;<a name='6329'>
       &amp; 3.079969e-02_rb,2.992146e-02_rb,2.905875e-02_rb,2.821201e-02_rb,2.737873e-02_rb,&amp;<a name='6330'>
       &amp; 2.656052e-02_rb,2.575586e-02_rb,2.496511e-02_rb,2.418783e-02_rb,2.342500e-02_rb,&amp;<a name='6331'>
       &amp; 2.267646e-02_rb,2.194177e-02_rb,2.122146e-02_rb /)<a name='6332'>
<font color=#447700>!     BAND  24<a name='6333'></font>
      extliq1(:, 24) = (/ &amp;<a name='6334'>
       &amp; 6.850164e-01_rb,4.762468e-01_rb,3.642001e-01_rb,2.946012e-01_rb,2.472001e-01_rb,&amp;<a name='6335'>
       &amp; 2.128588e-01_rb,1.868537e-01_rb,1.664893e-01_rb,1.501142e-01_rb,1.366620e-01_rb,&amp;<a name='6336'>
       &amp; 1.254147e-01_rb,1.158721e-01_rb,1.076732e-01_rb,1.005530e-01_rb,9.431306e-02_rb,&amp;<a name='6337'>
       &amp; 8.879891e-02_rb,8.389232e-02_rb,7.949714e-02_rb,7.553857e-02_rb,7.195474e-02_rb,&amp;<a name='6338'>
       &amp; 6.869413e-02_rb,6.571444e-02_rb,6.298286e-02_rb,6.046779e-02_rb,5.814474e-02_rb,&amp;<a name='6339'>
       &amp; 5.599141e-02_rb,5.399114e-02_rb,5.212443e-02_rb,5.037870e-02_rb,4.874321e-02_rb,&amp;<a name='6340'>
       &amp; 4.720219e-02_rb,4.574813e-02_rb,4.437160e-02_rb,4.306460e-02_rb,4.181810e-02_rb,&amp;<a name='6341'>
       &amp; 4.062603e-02_rb,3.948252e-02_rb,3.838256e-02_rb,3.732049e-02_rb,3.629192e-02_rb,&amp;<a name='6342'>
       &amp; 3.529301e-02_rb,3.432190e-02_rb,3.337412e-02_rb,3.244842e-02_rb,3.154175e-02_rb,&amp;<a name='6343'>
       &amp; 3.065253e-02_rb,2.978063e-02_rb,2.892367e-02_rb,2.808221e-02_rb,2.725478e-02_rb,&amp;<a name='6344'>
       &amp; 2.644174e-02_rb,2.564175e-02_rb,2.485508e-02_rb,2.408303e-02_rb,2.332365e-02_rb,&amp;<a name='6345'>
       &amp; 2.257890e-02_rb,2.184824e-02_rb,2.113224e-02_rb /)<a name='6346'>
<font color=#447700>!     BAND  25<a name='6347'></font>
      extliq1(:, 25) = (/ &amp;<a name='6348'>
       &amp; 6.673017e-01_rb,4.664520e-01_rb,3.579398e-01_rb,2.902234e-01_rb,2.439904e-01_rb,&amp;<a name='6349'>
       &amp; 2.104149e-01_rb,1.849277e-01_rb,1.649234e-01_rb,1.488087e-01_rb,1.355515e-01_rb,&amp;<a name='6350'>
       &amp; 1.244562e-01_rb,1.150329e-01_rb,1.069321e-01_rb,9.989310e-02_rb,9.372070e-02_rb,&amp;<a name='6351'>
       &amp; 8.826450e-02_rb,8.340622e-02_rb,7.905378e-02_rb,7.513109e-02_rb,7.157859e-02_rb,&amp;<a name='6352'>
       &amp; 6.834588e-02_rb,6.539114e-02_rb,6.268150e-02_rb,6.018621e-02_rb,5.788098e-02_rb,&amp;<a name='6353'>
       &amp; 5.574351e-02_rb,5.375699e-02_rb,5.190412e-02_rb,5.017099e-02_rb,4.854497e-02_rb,&amp;<a name='6354'>
       &amp; 4.701490e-02_rb,4.557030e-02_rb,4.420249e-02_rb,4.290304e-02_rb,4.166427e-02_rb,&amp;<a name='6355'>
       &amp; 4.047820e-02_rb,3.934232e-02_rb,3.824778e-02_rb,3.719236e-02_rb,3.616931e-02_rb,&amp;<a name='6356'>
       &amp; 3.517597e-02_rb,3.420856e-02_rb,3.326566e-02_rb,3.234346e-02_rb,3.144122e-02_rb,&amp;<a name='6357'>
       &amp; 3.055684e-02_rb,2.968798e-02_rb,2.883519e-02_rb,2.799635e-02_rb,2.717228e-02_rb,&amp;<a name='6358'>
       &amp; 2.636182e-02_rb,2.556424e-02_rb,2.478114e-02_rb,2.401086e-02_rb,2.325657e-02_rb,&amp;<a name='6359'>
       &amp; 2.251506e-02_rb,2.178594e-02_rb,2.107301e-02_rb /)<a name='6360'>
<font color=#447700>!     BAND  26<a name='6361'></font>
      extliq1(:, 26) = (/ &amp;<a name='6362'>
       &amp; 6.552414e-01_rb,4.599454e-01_rb,3.538626e-01_rb,2.873547e-01_rb,2.418033e-01_rb,&amp;<a name='6363'>
       &amp; 2.086660e-01_rb,1.834885e-01_rb,1.637142e-01_rb,1.477767e-01_rb,1.346583e-01_rb,&amp;<a name='6364'>
       &amp; 1.236734e-01_rb,1.143412e-01_rb,1.063148e-01_rb,9.933905e-02_rb,9.322026e-02_rb,&amp;<a name='6365'>
       &amp; 8.780979e-02_rb,8.299230e-02_rb,7.867554e-02_rb,7.478450e-02_rb,7.126053e-02_rb,&amp;<a name='6366'>
       &amp; 6.805276e-02_rb,6.512143e-02_rb,6.243211e-02_rb,5.995541e-02_rb,5.766712e-02_rb,&amp;<a name='6367'>
       &amp; 5.554484e-02_rb,5.357246e-02_rb,5.173222e-02_rb,5.001069e-02_rb,4.839505e-02_rb,&amp;<a name='6368'>
       &amp; 4.687471e-02_rb,4.543861e-02_rb,4.407857e-02_rb,4.278577e-02_rb,4.155331e-02_rb,&amp;<a name='6369'>
       &amp; 4.037322e-02_rb,3.924302e-02_rb,3.815376e-02_rb,3.710172e-02_rb,3.608296e-02_rb,&amp;<a name='6370'>
       &amp; 3.509330e-02_rb,3.412980e-02_rb,3.319009e-02_rb,3.227106e-02_rb,3.137157e-02_rb,&amp;<a name='6371'>
       &amp; 3.048950e-02_rb,2.962365e-02_rb,2.877297e-02_rb,2.793726e-02_rb,2.711500e-02_rb,&amp;<a name='6372'>
       &amp; 2.630666e-02_rb,2.551206e-02_rb,2.473052e-02_rb,2.396287e-02_rb,2.320861e-02_rb,&amp;<a name='6373'>
       &amp; 2.246810e-02_rb,2.174162e-02_rb,2.102927e-02_rb /)<a name='6374'>
<font color=#447700>!     BAND  27<a name='6375'></font>
      extliq1(:, 27) = (/ &amp;<a name='6376'>
       &amp; 6.430901e-01_rb,4.532134e-01_rb,3.496132e-01_rb,2.844655e-01_rb,2.397347e-01_rb,&amp;<a name='6377'>
       &amp; 2.071236e-01_rb,1.822976e-01_rb,1.627640e-01_rb,1.469961e-01_rb,1.340006e-01_rb,&amp;<a name='6378'>
       &amp; 1.231069e-01_rb,1.138441e-01_rb,1.058706e-01_rb,9.893678e-02_rb,9.285166e-02_rb,&amp;<a name='6379'>
       &amp; 8.746871e-02_rb,8.267411e-02_rb,7.837656e-02_rb,7.450257e-02_rb,7.099318e-02_rb,&amp;<a name='6380'>
       &amp; 6.779929e-02_rb,6.487987e-02_rb,6.220168e-02_rb,5.973530e-02_rb,5.745636e-02_rb,&amp;<a name='6381'>
       &amp; 5.534344e-02_rb,5.337986e-02_rb,5.154797e-02_rb,4.983404e-02_rb,4.822582e-02_rb,&amp;<a name='6382'>
       &amp; 4.671228e-02_rb,4.528321e-02_rb,4.392997e-02_rb,4.264325e-02_rb,4.141647e-02_rb,&amp;<a name='6383'>
       &amp; 4.024259e-02_rb,3.911767e-02_rb,3.803309e-02_rb,3.698782e-02_rb,3.597140e-02_rb,&amp;<a name='6384'>
       &amp; 3.498774e-02_rb,3.402852e-02_rb,3.309340e-02_rb,3.217818e-02_rb,3.128292e-02_rb,&amp;<a name='6385'>
       &amp; 3.040486e-02_rb,2.954230e-02_rb,2.869545e-02_rb,2.786261e-02_rb,2.704372e-02_rb,&amp;<a name='6386'>
       &amp; 2.623813e-02_rb,2.544668e-02_rb,2.466788e-02_rb,2.390313e-02_rb,2.315136e-02_rb,&amp;<a name='6387'>
       &amp; 2.241391e-02_rb,2.168921e-02_rb,2.097903e-02_rb /)<a name='6388'>
<font color=#447700>!     BAND  28<a name='6389'></font>
      extliq1(:, 28) = (/ &amp;<a name='6390'>
       &amp; 6.367074e-01_rb,4.495768e-01_rb,3.471263e-01_rb,2.826149e-01_rb,2.382868e-01_rb,&amp;<a name='6391'>
       &amp; 2.059640e-01_rb,1.813562e-01_rb,1.619881e-01_rb,1.463436e-01_rb,1.334402e-01_rb,&amp;<a name='6392'>
       &amp; 1.226166e-01_rb,1.134096e-01_rb,1.054829e-01_rb,9.858838e-02_rb,9.253790e-02_rb,&amp;<a name='6393'>
       &amp; 8.718582e-02_rb,8.241830e-02_rb,7.814482e-02_rb,7.429212e-02_rb,7.080165e-02_rb,&amp;<a name='6394'>
       &amp; 6.762385e-02_rb,6.471838e-02_rb,6.205388e-02_rb,5.959726e-02_rb,5.732871e-02_rb,&amp;<a name='6395'>
       &amp; 5.522402e-02_rb,5.326793e-02_rb,5.144230e-02_rb,4.973440e-02_rb,4.813188e-02_rb,&amp;<a name='6396'>
       &amp; 4.662283e-02_rb,4.519798e-02_rb,4.384833e-02_rb,4.256541e-02_rb,4.134253e-02_rb,&amp;<a name='6397'>
       &amp; 4.017136e-02_rb,3.904911e-02_rb,3.796779e-02_rb,3.692364e-02_rb,3.591182e-02_rb,&amp;<a name='6398'>
       &amp; 3.492930e-02_rb,3.397230e-02_rb,3.303920e-02_rb,3.212572e-02_rb,3.123278e-02_rb,&amp;<a name='6399'>
       &amp; 3.035519e-02_rb,2.949493e-02_rb,2.864985e-02_rb,2.781840e-02_rb,2.700197e-02_rb,&amp;<a name='6400'>
       &amp; 2.619682e-02_rb,2.540674e-02_rb,2.462966e-02_rb,2.386613e-02_rb,2.311602e-02_rb,&amp;<a name='6401'>
       &amp; 2.237846e-02_rb,2.165660e-02_rb,2.094756e-02_rb /)<a name='6402'>
<font color=#447700>!     BAND  29<a name='6403'></font>
      extliq1(:, 29) = (/ &amp;<a name='6404'>
       &amp; 4.298416e-01_rb,4.391639e-01_rb,3.975030e-01_rb,3.443028e-01_rb,2.957345e-01_rb,&amp;<a name='6405'>
       &amp; 2.556461e-01_rb,2.234755e-01_rb,1.976636e-01_rb,1.767428e-01_rb,1.595611e-01_rb,&amp;<a name='6406'>
       &amp; 1.452636e-01_rb,1.332156e-01_rb,1.229481e-01_rb,1.141059e-01_rb,1.064208e-01_rb,&amp;<a name='6407'>
       &amp; 9.968527e-02_rb,9.373833e-02_rb,8.845221e-02_rb,8.372112e-02_rb,7.946667e-02_rb,&amp;<a name='6408'>
       &amp; 7.561807e-02_rb,7.212029e-02_rb,6.893166e-02_rb,6.600944e-02_rb,6.332277e-02_rb,&amp;<a name='6409'>
       &amp; 6.084277e-02_rb,5.854721e-02_rb,5.641361e-02_rb,5.442639e-02_rb,5.256750e-02_rb,&amp;<a name='6410'>
       &amp; 5.082499e-02_rb,4.918556e-02_rb,4.763694e-02_rb,4.617222e-02_rb,4.477861e-02_rb,&amp;<a name='6411'>
       &amp; 4.344861e-02_rb,4.217999e-02_rb,4.096111e-02_rb,3.978638e-02_rb,3.865361e-02_rb,&amp;<a name='6412'>
       &amp; 3.755473e-02_rb,3.649028e-02_rb,3.545361e-02_rb,3.444361e-02_rb,3.345666e-02_rb,&amp;<a name='6413'>
       &amp; 3.249167e-02_rb,3.154722e-02_rb,3.062083e-02_rb,2.971250e-02_rb,2.882083e-02_rb,&amp;<a name='6414'>
       &amp; 2.794611e-02_rb,2.708778e-02_rb,2.624500e-02_rb,2.541750e-02_rb,2.460528e-02_rb,&amp;<a name='6415'>
       &amp; 2.381194e-02_rb,2.303250e-02_rb,2.226833e-02_rb /)<a name='6416'>
<font color=#447700>!     BAND  16<a name='6417'></font>
      ssaliq1(:, 16) = (/ &amp;<a name='6418'>
       &amp; 8.362119e-01_rb,8.098460e-01_rb,7.762291e-01_rb,7.486042e-01_rb,7.294172e-01_rb,&amp;<a name='6419'>
       &amp; 7.161000e-01_rb,7.060656e-01_rb,6.978387e-01_rb,6.907193e-01_rb,6.843551e-01_rb,&amp;<a name='6420'>
       &amp; 6.785668e-01_rb,6.732450e-01_rb,6.683191e-01_rb,6.637264e-01_rb,6.594307e-01_rb,&amp;<a name='6421'>
       &amp; 6.554033e-01_rb,6.516115e-01_rb,6.480295e-01_rb,6.446429e-01_rb,6.414306e-01_rb,&amp;<a name='6422'>
       &amp; 6.383783e-01_rb,6.354750e-01_rb,6.327068e-01_rb,6.300665e-01_rb,6.275376e-01_rb,&amp;<a name='6423'>
       &amp; 6.251245e-01_rb,6.228136e-01_rb,6.205944e-01_rb,6.184720e-01_rb,6.164330e-01_rb,&amp;<a name='6424'>
       &amp; 6.144742e-01_rb,6.125962e-01_rb,6.108004e-01_rb,6.090740e-01_rb,6.074200e-01_rb,&amp;<a name='6425'>
       &amp; 6.058381e-01_rb,6.043209e-01_rb,6.028681e-01_rb,6.014836e-01_rb,6.001626e-01_rb,&amp;<a name='6426'>
       &amp; 5.988957e-01_rb,5.976864e-01_rb,5.965390e-01_rb,5.954379e-01_rb,5.943972e-01_rb,&amp;<a name='6427'>
       &amp; 5.934019e-01_rb,5.924624e-01_rb,5.915579e-01_rb,5.907025e-01_rb,5.898913e-01_rb,&amp;<a name='6428'>
       &amp; 5.891213e-01_rb,5.883815e-01_rb,5.876851e-01_rb,5.870158e-01_rb,5.863868e-01_rb,&amp;<a name='6429'>
       &amp; 5.857821e-01_rb,5.852111e-01_rb,5.846579e-01_rb /)<a name='6430'>
<font color=#447700>!     BAND  17<a name='6431'></font>
      ssaliq1(:, 17) = (/ &amp;<a name='6432'>
       &amp; 6.995459e-01_rb,7.158012e-01_rb,7.076001e-01_rb,6.927244e-01_rb,6.786434e-01_rb,&amp;<a name='6433'>
       &amp; 6.673545e-01_rb,6.585859e-01_rb,6.516314e-01_rb,6.459010e-01_rb,6.410225e-01_rb,&amp;<a name='6434'>
       &amp; 6.367574e-01_rb,6.329554e-01_rb,6.295119e-01_rb,6.263595e-01_rb,6.234462e-01_rb,&amp;<a name='6435'>
       &amp; 6.207274e-01_rb,6.181755e-01_rb,6.157678e-01_rb,6.134880e-01_rb,6.113173e-01_rb,&amp;<a name='6436'>
       &amp; 6.092495e-01_rb,6.072689e-01_rb,6.053717e-01_rb,6.035507e-01_rb,6.018001e-01_rb,&amp;<a name='6437'>
       &amp; 6.001134e-01_rb,5.984951e-01_rb,5.969294e-01_rb,5.954256e-01_rb,5.939698e-01_rb,&amp;<a name='6438'>
       &amp; 5.925716e-01_rb,5.912265e-01_rb,5.899270e-01_rb,5.886771e-01_rb,5.874746e-01_rb,&amp;<a name='6439'>
       &amp; 5.863185e-01_rb,5.852077e-01_rb,5.841460e-01_rb,5.831249e-01_rb,5.821474e-01_rb,&amp;<a name='6440'>
       &amp; 5.812078e-01_rb,5.803173e-01_rb,5.794616e-01_rb,5.786443e-01_rb,5.778617e-01_rb,&amp;<a name='6441'>
       &amp; 5.771236e-01_rb,5.764191e-01_rb,5.757400e-01_rb,5.750971e-01_rb,5.744842e-01_rb,&amp;<a name='6442'>
       &amp; 5.739012e-01_rb,5.733482e-01_rb,5.728175e-01_rb,5.723214e-01_rb,5.718383e-01_rb,&amp;<a name='6443'>
       &amp; 5.713827e-01_rb,5.709471e-01_rb,5.705330e-01_rb /)<a name='6444'>
<font color=#447700>!     BAND  18<a name='6445'></font>
      ssaliq1(:, 18) = (/ &amp;<a name='6446'>
       &amp; 9.929711e-01_rb,9.896942e-01_rb,9.852408e-01_rb,9.806820e-01_rb,9.764512e-01_rb,&amp;<a name='6447'>
       &amp; 9.725375e-01_rb,9.688677e-01_rb,9.653832e-01_rb,9.620552e-01_rb,9.588522e-01_rb,&amp;<a name='6448'>
       &amp; 9.557475e-01_rb,9.527265e-01_rb,9.497731e-01_rb,9.468756e-01_rb,9.440270e-01_rb,&amp;<a name='6449'>
       &amp; 9.412230e-01_rb,9.384592e-01_rb,9.357287e-01_rb,9.330369e-01_rb,9.303778e-01_rb,&amp;<a name='6450'>
       &amp; 9.277502e-01_rb,9.251546e-01_rb,9.225907e-01_rb,9.200553e-01_rb,9.175521e-01_rb,&amp;<a name='6451'>
       &amp; 9.150773e-01_rb,9.126352e-01_rb,9.102260e-01_rb,9.078485e-01_rb,9.055057e-01_rb,&amp;<a name='6452'>
       &amp; 9.031978e-01_rb,9.009306e-01_rb,8.987010e-01_rb,8.965177e-01_rb,8.943774e-01_rb,&amp;<a name='6453'>
       &amp; 8.922869e-01_rb,8.902430e-01_rb,8.882551e-01_rb,8.863182e-01_rb,8.844373e-01_rb,&amp;<a name='6454'>
       &amp; 8.826143e-01_rb,8.808499e-01_rb,8.791413e-01_rb,8.774940e-01_rb,8.759019e-01_rb,&amp;<a name='6455'>
       &amp; 8.743650e-01_rb,8.728941e-01_rb,8.714712e-01_rb,8.701065e-01_rb,8.688008e-01_rb,&amp;<a name='6456'>
       &amp; 8.675409e-01_rb,8.663295e-01_rb,8.651714e-01_rb,8.640637e-01_rb,8.629943e-01_rb,&amp;<a name='6457'>
       &amp; 8.619762e-01_rb,8.609995e-01_rb,8.600581e-01_rb /)<a name='6458'>
<font color=#447700>!     BAND  19<a name='6459'></font>
      ssaliq1(:, 19) = (/ &amp;<a name='6460'>
       &amp; 9.910612e-01_rb,9.854226e-01_rb,9.795008e-01_rb,9.742920e-01_rb,9.695996e-01_rb,&amp;<a name='6461'>
       &amp; 9.652274e-01_rb,9.610648e-01_rb,9.570521e-01_rb,9.531397e-01_rb,9.493086e-01_rb,&amp;<a name='6462'>
       &amp; 9.455413e-01_rb,9.418362e-01_rb,9.381902e-01_rb,9.346016e-01_rb,9.310718e-01_rb,&amp;<a name='6463'>
       &amp; 9.275957e-01_rb,9.241757e-01_rb,9.208038e-01_rb,9.174802e-01_rb,9.142058e-01_rb,&amp;<a name='6464'>
       &amp; 9.109753e-01_rb,9.077895e-01_rb,9.046433e-01_rb,9.015409e-01_rb,8.984784e-01_rb,&amp;<a name='6465'>
       &amp; 8.954572e-01_rb,8.924748e-01_rb,8.895367e-01_rb,8.866395e-01_rb,8.837864e-01_rb,&amp;<a name='6466'>
       &amp; 8.809819e-01_rb,8.782267e-01_rb,8.755231e-01_rb,8.728712e-01_rb,8.702802e-01_rb,&amp;<a name='6467'>
       &amp; 8.677443e-01_rb,8.652733e-01_rb,8.628678e-01_rb,8.605300e-01_rb,8.582593e-01_rb,&amp;<a name='6468'>
       &amp; 8.560596e-01_rb,8.539352e-01_rb,8.518782e-01_rb,8.498915e-01_rb,8.479790e-01_rb,&amp;<a name='6469'>
       &amp; 8.461384e-01_rb,8.443645e-01_rb,8.426613e-01_rb,8.410229e-01_rb,8.394495e-01_rb,&amp;<a name='6470'>
       &amp; 8.379428e-01_rb,8.364967e-01_rb,8.351117e-01_rb,8.337820e-01_rb,8.325091e-01_rb,&amp;<a name='6471'>
       &amp; 8.312874e-01_rb,8.301169e-01_rb,8.289985e-01_rb /)<a name='6472'>
<font color=#447700>!     BAND  20<a name='6473'></font>
      ssaliq1(:, 20) = (/ &amp;<a name='6474'>
       &amp; 9.969802e-01_rb,9.950445e-01_rb,9.931448e-01_rb,9.914272e-01_rb,9.898652e-01_rb,&amp;<a name='6475'>
       &amp; 9.884250e-01_rb,9.870637e-01_rb,9.857482e-01_rb,9.844558e-01_rb,9.831755e-01_rb,&amp;<a name='6476'>
       &amp; 9.819068e-01_rb,9.806477e-01_rb,9.794000e-01_rb,9.781666e-01_rb,9.769461e-01_rb,&amp;<a name='6477'>
       &amp; 9.757386e-01_rb,9.745459e-01_rb,9.733650e-01_rb,9.721953e-01_rb,9.710398e-01_rb,&amp;<a name='6478'>
       &amp; 9.698936e-01_rb,9.687583e-01_rb,9.676334e-01_rb,9.665192e-01_rb,9.654132e-01_rb,&amp;<a name='6479'>
       &amp; 9.643208e-01_rb,9.632374e-01_rb,9.621625e-01_rb,9.611003e-01_rb,9.600518e-01_rb,&amp;<a name='6480'>
       &amp; 9.590144e-01_rb,9.579922e-01_rb,9.569864e-01_rb,9.559948e-01_rb,9.550239e-01_rb,&amp;<a name='6481'>
       &amp; 9.540698e-01_rb,9.531382e-01_rb,9.522280e-01_rb,9.513409e-01_rb,9.504772e-01_rb,&amp;<a name='6482'>
       &amp; 9.496360e-01_rb,9.488220e-01_rb,9.480327e-01_rb,9.472693e-01_rb,9.465333e-01_rb,&amp;<a name='6483'>
       &amp; 9.458211e-01_rb,9.451344e-01_rb,9.444732e-01_rb,9.438372e-01_rb,9.432268e-01_rb,&amp;<a name='6484'>
       &amp; 9.426391e-01_rb,9.420757e-01_rb,9.415308e-01_rb,9.410102e-01_rb,9.405115e-01_rb,&amp;<a name='6485'>
       &amp; 9.400326e-01_rb,9.395716e-01_rb,9.391313e-01_rb /)<a name='6486'>
<font color=#447700>!     BAND  21<a name='6487'></font>
      ssaliq1(:, 21) = (/ &amp;<a name='6488'>
       &amp; 9.980034e-01_rb,9.968572e-01_rb,9.958696e-01_rb,9.949747e-01_rb,9.941241e-01_rb,&amp;<a name='6489'>
       &amp; 9.933043e-01_rb,9.924971e-01_rb,9.916978e-01_rb,9.909023e-01_rb,9.901046e-01_rb,&amp;<a name='6490'>
       &amp; 9.893087e-01_rb,9.885146e-01_rb,9.877195e-01_rb,9.869283e-01_rb,9.861379e-01_rb,&amp;<a name='6491'>
       &amp; 9.853523e-01_rb,9.845715e-01_rb,9.837945e-01_rb,9.830217e-01_rb,9.822567e-01_rb,&amp;<a name='6492'>
       &amp; 9.814935e-01_rb,9.807356e-01_rb,9.799815e-01_rb,9.792332e-01_rb,9.784845e-01_rb,&amp;<a name='6493'>
       &amp; 9.777424e-01_rb,9.770042e-01_rb,9.762695e-01_rb,9.755416e-01_rb,9.748152e-01_rb,&amp;<a name='6494'>
       &amp; 9.740974e-01_rb,9.733873e-01_rb,9.726813e-01_rb,9.719861e-01_rb,9.713010e-01_rb,&amp;<a name='6495'>
       &amp; 9.706262e-01_rb,9.699647e-01_rb,9.693144e-01_rb,9.686794e-01_rb,9.680596e-01_rb,&amp;<a name='6496'>
       &amp; 9.674540e-01_rb,9.668657e-01_rb,9.662926e-01_rb,9.657390e-01_rb,9.652019e-01_rb,&amp;<a name='6497'>
       &amp; 9.646820e-01_rb,9.641784e-01_rb,9.636945e-01_rb,9.632260e-01_rb,9.627743e-01_rb,&amp;<a name='6498'>
       &amp; 9.623418e-01_rb,9.619227e-01_rb,9.615194e-01_rb,9.611341e-01_rb,9.607629e-01_rb,&amp;<a name='6499'>
       &amp; 9.604057e-01_rb,9.600622e-01_rb,9.597322e-01_rb /)<a name='6500'>
<font color=#447700>!     BAND  22<a name='6501'></font>
      ssaliq1(:, 22) = (/ &amp;<a name='6502'>
       &amp; 9.988219e-01_rb,9.981767e-01_rb,9.976168e-01_rb,9.971066e-01_rb,9.966195e-01_rb,&amp;<a name='6503'>
       &amp; 9.961566e-01_rb,9.956995e-01_rb,9.952481e-01_rb,9.947982e-01_rb,9.943495e-01_rb,&amp;<a name='6504'>
       &amp; 9.938955e-01_rb,9.934368e-01_rb,9.929825e-01_rb,9.925239e-01_rb,9.920653e-01_rb,&amp;<a name='6505'>
       &amp; 9.916096e-01_rb,9.911552e-01_rb,9.907067e-01_rb,9.902594e-01_rb,9.898178e-01_rb,&amp;<a name='6506'>
       &amp; 9.893791e-01_rb,9.889453e-01_rb,9.885122e-01_rb,9.880837e-01_rb,9.876567e-01_rb,&amp;<a name='6507'>
       &amp; 9.872331e-01_rb,9.868121e-01_rb,9.863938e-01_rb,9.859790e-01_rb,9.855650e-01_rb,&amp;<a name='6508'>
       &amp; 9.851548e-01_rb,9.847491e-01_rb,9.843496e-01_rb,9.839521e-01_rb,9.835606e-01_rb,&amp;<a name='6509'>
       &amp; 9.831771e-01_rb,9.827975e-01_rb,9.824292e-01_rb,9.820653e-01_rb,9.817124e-01_rb,&amp;<a name='6510'>
       &amp; 9.813644e-01_rb,9.810291e-01_rb,9.807020e-01_rb,9.803864e-01_rb,9.800782e-01_rb,&amp;<a name='6511'>
       &amp; 9.797821e-01_rb,9.794958e-01_rb,9.792179e-01_rb,9.789509e-01_rb,9.786940e-01_rb,&amp;<a name='6512'>
       &amp; 9.784460e-01_rb,9.782090e-01_rb,9.779789e-01_rb,9.777553e-01_rb,9.775425e-01_rb,&amp;<a name='6513'>
       &amp; 9.773387e-01_rb,9.771420e-01_rb,9.769529e-01_rb /)<a name='6514'>
<font color=#447700>!     BAND  23<a name='6515'></font>
      ssaliq1(:, 23) = (/ &amp;<a name='6516'>
       &amp; 9.998902e-01_rb,9.998395e-01_rb,9.997915e-01_rb,9.997442e-01_rb,9.997016e-01_rb,&amp;<a name='6517'>
       &amp; 9.996600e-01_rb,9.996200e-01_rb,9.995806e-01_rb,9.995411e-01_rb,9.995005e-01_rb,&amp;<a name='6518'>
       &amp; 9.994589e-01_rb,9.994178e-01_rb,9.993766e-01_rb,9.993359e-01_rb,9.992948e-01_rb,&amp;<a name='6519'>
       &amp; 9.992533e-01_rb,9.992120e-01_rb,9.991723e-01_rb,9.991313e-01_rb,9.990906e-01_rb,&amp;<a name='6520'>
       &amp; 9.990510e-01_rb,9.990113e-01_rb,9.989716e-01_rb,9.989323e-01_rb,9.988923e-01_rb,&amp;<a name='6521'>
       &amp; 9.988532e-01_rb,9.988140e-01_rb,9.987761e-01_rb,9.987373e-01_rb,9.986989e-01_rb,&amp;<a name='6522'>
       &amp; 9.986597e-01_rb,9.986239e-01_rb,9.985861e-01_rb,9.985485e-01_rb,9.985123e-01_rb,&amp;<a name='6523'>
       &amp; 9.984762e-01_rb,9.984415e-01_rb,9.984065e-01_rb,9.983722e-01_rb,9.983398e-01_rb,&amp;<a name='6524'>
       &amp; 9.983078e-01_rb,9.982758e-01_rb,9.982461e-01_rb,9.982157e-01_rb,9.981872e-01_rb,&amp;<a name='6525'>
       &amp; 9.981595e-01_rb,9.981324e-01_rb,9.981068e-01_rb,9.980811e-01_rb,9.980580e-01_rb,&amp;<a name='6526'>
       &amp; 9.980344e-01_rb,9.980111e-01_rb,9.979908e-01_rb,9.979690e-01_rb,9.979492e-01_rb,&amp;<a name='6527'>
       &amp; 9.979316e-01_rb,9.979116e-01_rb,9.978948e-01_rb /)<a name='6528'>
<font color=#447700>!     BAND  24<a name='6529'></font>
      ssaliq1(:, 24) = (/ &amp;<a name='6530'>
       &amp; 9.999978e-01_rb,9.999948e-01_rb,9.999915e-01_rb,9.999905e-01_rb,9.999896e-01_rb,&amp;<a name='6531'>
       &amp; 9.999887e-01_rb,9.999888e-01_rb,9.999888e-01_rb,9.999870e-01_rb,9.999854e-01_rb,&amp;<a name='6532'>
       &amp; 9.999855e-01_rb,9.999856e-01_rb,9.999839e-01_rb,9.999834e-01_rb,9.999829e-01_rb,&amp;<a name='6533'>
       &amp; 9.999809e-01_rb,9.999816e-01_rb,9.999793e-01_rb,9.999782e-01_rb,9.999779e-01_rb,&amp;<a name='6534'>
       &amp; 9.999772e-01_rb,9.999764e-01_rb,9.999756e-01_rb,9.999744e-01_rb,9.999744e-01_rb,&amp;<a name='6535'>
       &amp; 9.999736e-01_rb,9.999729e-01_rb,9.999716e-01_rb,9.999706e-01_rb,9.999692e-01_rb,&amp;<a name='6536'>
       &amp; 9.999690e-01_rb,9.999675e-01_rb,9.999673e-01_rb,9.999660e-01_rb,9.999654e-01_rb,&amp;<a name='6537'>
       &amp; 9.999647e-01_rb,9.999647e-01_rb,9.999625e-01_rb,9.999620e-01_rb,9.999614e-01_rb,&amp;<a name='6538'>
       &amp; 9.999613e-01_rb,9.999607e-01_rb,9.999604e-01_rb,9.999594e-01_rb,9.999589e-01_rb,&amp;<a name='6539'>
       &amp; 9.999586e-01_rb,9.999567e-01_rb,9.999550e-01_rb,9.999557e-01_rb,9.999542e-01_rb,&amp;<a name='6540'>
       &amp; 9.999546e-01_rb,9.999539e-01_rb,9.999536e-01_rb,9.999526e-01_rb,9.999523e-01_rb,&amp;<a name='6541'>
       &amp; 9.999508e-01_rb,9.999534e-01_rb,9.999507e-01_rb /)<a name='6542'>
<font color=#447700>!     BAND  25<a name='6543'></font>
      ssaliq1(:, 25) = (/ &amp;<a name='6544'>
       &amp; 1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,&amp;<a name='6545'>
       &amp; 1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,&amp;<a name='6546'>
       &amp; 1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,&amp;<a name='6547'>
       &amp; 1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,9.999995e-01_rb,&amp;<a name='6548'>
       &amp; 9.999995e-01_rb,9.999990e-01_rb,9.999991e-01_rb,9.999991e-01_rb,9.999990e-01_rb,&amp;<a name='6549'>
       &amp; 9.999989e-01_rb,9.999988e-01_rb,9.999988e-01_rb,9.999986e-01_rb,9.999988e-01_rb,&amp;<a name='6550'>
       &amp; 9.999986e-01_rb,9.999987e-01_rb,9.999986e-01_rb,9.999985e-01_rb,9.999985e-01_rb,&amp;<a name='6551'>
       &amp; 9.999985e-01_rb,9.999985e-01_rb,9.999983e-01_rb,9.999983e-01_rb,9.999981e-01_rb,&amp;<a name='6552'>
       &amp; 9.999981e-01_rb,9.999986e-01_rb,9.999985e-01_rb,9.999983e-01_rb,9.999984e-01_rb,&amp;<a name='6553'>
       &amp; 9.999982e-01_rb,9.999983e-01_rb,9.999982e-01_rb,9.999980e-01_rb,9.999981e-01_rb,&amp;<a name='6554'>
       &amp; 9.999978e-01_rb,9.999979e-01_rb,9.999985e-01_rb,9.999985e-01_rb,9.999983e-01_rb,&amp;<a name='6555'>
       &amp; 9.999983e-01_rb,9.999983e-01_rb,9.999983e-01_rb /)<a name='6556'>
<font color=#447700>!     BAND  26<a name='6557'></font>
      ssaliq1(:, 26) = (/ &amp;<a name='6558'>
       &amp; 1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,&amp;<a name='6559'>
       &amp; 1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,&amp;<a name='6560'>
       &amp; 1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,&amp;<a name='6561'>
       &amp; 1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,1.000000e+00_rb,9.999991e-01_rb,&amp;<a name='6562'>
       &amp; 9.999990e-01_rb,9.999992e-01_rb,9.999995e-01_rb,9.999986e-01_rb,9.999994e-01_rb,&amp;<a name='6563'>
       &amp; 9.999985e-01_rb,9.999980e-01_rb,9.999984e-01_rb,9.999983e-01_rb,9.999979e-01_rb,&amp;<a name='6564'>
       &amp; 9.999969e-01_rb,9.999977e-01_rb,9.999971e-01_rb,9.999969e-01_rb,9.999969e-01_rb,&amp;<a name='6565'>
       &amp; 9.999965e-01_rb,9.999970e-01_rb,9.999985e-01_rb,9.999973e-01_rb,9.999961e-01_rb,&amp;<a name='6566'>
       &amp; 9.999968e-01_rb,9.999952e-01_rb,9.999970e-01_rb,9.999974e-01_rb,9.999965e-01_rb,&amp;<a name='6567'>
       &amp; 9.999969e-01_rb,9.999970e-01_rb,9.999970e-01_rb,9.999960e-01_rb,9.999923e-01_rb,&amp;<a name='6568'>
       &amp; 9.999958e-01_rb,9.999937e-01_rb,9.999960e-01_rb,9.999953e-01_rb,9.999946e-01_rb,&amp;<a name='6569'>
       &amp; 9.999946e-01_rb,9.999957e-01_rb,9.999951e-01_rb /)<a name='6570'>
<font color=#447700>!     BAND  27<a name='6571'></font>
      ssaliq1(:, 27) = (/ &amp;<a name='6572'>
       &amp; 1.000000e+00_rb,1.000000e+00_rb,9.999983e-01_rb,9.999979e-01_rb,9.999965e-01_rb,&amp;<a name='6573'>
       &amp; 9.999949e-01_rb,9.999948e-01_rb,9.999918e-01_rb,9.999917e-01_rb,9.999923e-01_rb,&amp;<a name='6574'>
       &amp; 9.999908e-01_rb,9.999889e-01_rb,9.999902e-01_rb,9.999895e-01_rb,9.999881e-01_rb,&amp;<a name='6575'>
       &amp; 9.999882e-01_rb,9.999876e-01_rb,9.999866e-01_rb,9.999866e-01_rb,9.999858e-01_rb,&amp;<a name='6576'>
       &amp; 9.999860e-01_rb,9.999852e-01_rb,9.999836e-01_rb,9.999831e-01_rb,9.999818e-01_rb,&amp;<a name='6577'>
       &amp; 9.999808e-01_rb,9.999816e-01_rb,9.999800e-01_rb,9.999783e-01_rb,9.999780e-01_rb,&amp;<a name='6578'>
       &amp; 9.999763e-01_rb,9.999746e-01_rb,9.999731e-01_rb,9.999713e-01_rb,9.999762e-01_rb,&amp;<a name='6579'>
       &amp; 9.999740e-01_rb,9.999670e-01_rb,9.999703e-01_rb,9.999687e-01_rb,9.999666e-01_rb,&amp;<a name='6580'>
       &amp; 9.999683e-01_rb,9.999667e-01_rb,9.999611e-01_rb,9.999635e-01_rb,9.999600e-01_rb,&amp;<a name='6581'>
       &amp; 9.999635e-01_rb,9.999594e-01_rb,9.999601e-01_rb,9.999586e-01_rb,9.999559e-01_rb,&amp;<a name='6582'>
       &amp; 9.999569e-01_rb,9.999558e-01_rb,9.999523e-01_rb,9.999535e-01_rb,9.999529e-01_rb,&amp;<a name='6583'>
       &amp; 9.999553e-01_rb,9.999495e-01_rb,9.999490e-01_rb /)<a name='6584'>
<font color=#447700>!     BAND  28<a name='6585'></font>
      ssaliq1(:, 28) = (/ &amp;<a name='6586'>
       &amp; 9.999920e-01_rb,9.999873e-01_rb,9.999855e-01_rb,9.999832e-01_rb,9.999807e-01_rb,&amp;<a name='6587'>
       &amp; 9.999778e-01_rb,9.999754e-01_rb,9.999721e-01_rb,9.999692e-01_rb,9.999651e-01_rb,&amp;<a name='6588'>
       &amp; 9.999621e-01_rb,9.999607e-01_rb,9.999567e-01_rb,9.999546e-01_rb,9.999521e-01_rb,&amp;<a name='6589'>
       &amp; 9.999491e-01_rb,9.999457e-01_rb,9.999439e-01_rb,9.999403e-01_rb,9.999374e-01_rb,&amp;<a name='6590'>
       &amp; 9.999353e-01_rb,9.999315e-01_rb,9.999282e-01_rb,9.999244e-01_rb,9.999234e-01_rb,&amp;<a name='6591'>
       &amp; 9.999189e-01_rb,9.999130e-01_rb,9.999117e-01_rb,9.999073e-01_rb,9.999020e-01_rb,&amp;<a name='6592'>
       &amp; 9.998993e-01_rb,9.998987e-01_rb,9.998922e-01_rb,9.998893e-01_rb,9.998869e-01_rb,&amp;<a name='6593'>
       &amp; 9.998805e-01_rb,9.998778e-01_rb,9.998751e-01_rb,9.998708e-01_rb,9.998676e-01_rb,&amp;<a name='6594'>
       &amp; 9.998624e-01_rb,9.998642e-01_rb,9.998582e-01_rb,9.998547e-01_rb,9.998546e-01_rb,&amp;<a name='6595'>
       &amp; 9.998477e-01_rb,9.998487e-01_rb,9.998466e-01_rb,9.998403e-01_rb,9.998412e-01_rb,&amp;<a name='6596'>
       &amp; 9.998406e-01_rb,9.998342e-01_rb,9.998326e-01_rb,9.998333e-01_rb,9.998328e-01_rb,&amp;<a name='6597'>
       &amp; 9.998290e-01_rb,9.998276e-01_rb,9.998249e-01_rb /)<a name='6598'>
<font color=#447700>!     BAND  29<a name='6599'></font>
      ssaliq1(:, 29) = (/ &amp;<a name='6600'>
       &amp; 8.383753e-01_rb,8.461471e-01_rb,8.373325e-01_rb,8.212889e-01_rb,8.023834e-01_rb,&amp;<a name='6601'>
       &amp; 7.829501e-01_rb,7.641777e-01_rb,7.466000e-01_rb,7.304023e-01_rb,7.155998e-01_rb,&amp;<a name='6602'>
       &amp; 7.021259e-01_rb,6.898840e-01_rb,6.787615e-01_rb,6.686479e-01_rb,6.594414e-01_rb,&amp;<a name='6603'>
       &amp; 6.510417e-01_rb,6.433668e-01_rb,6.363335e-01_rb,6.298788e-01_rb,6.239398e-01_rb,&amp;<a name='6604'>
       &amp; 6.184633e-01_rb,6.134055e-01_rb,6.087228e-01_rb,6.043786e-01_rb,6.003439e-01_rb,&amp;<a name='6605'>
       &amp; 5.965910e-01_rb,5.930917e-01_rb,5.898280e-01_rb,5.867798e-01_rb,5.839264e-01_rb,&amp;<a name='6606'>
       &amp; 5.812576e-01_rb,5.787592e-01_rb,5.764163e-01_rb,5.742189e-01_rb,5.721598e-01_rb,&amp;<a name='6607'>
       &amp; 5.702286e-01_rb,5.684182e-01_rb,5.667176e-01_rb,5.651237e-01_rb,5.636253e-01_rb,&amp;<a name='6608'>
       &amp; 5.622228e-01_rb,5.609074e-01_rb,5.596713e-01_rb,5.585089e-01_rb,5.574223e-01_rb,&amp;<a name='6609'>
       &amp; 5.564002e-01_rb,5.554411e-01_rb,5.545397e-01_rb,5.536914e-01_rb,5.528967e-01_rb,&amp;<a name='6610'>
       &amp; 5.521495e-01_rb,5.514457e-01_rb,5.507818e-01_rb,5.501623e-01_rb,5.495750e-01_rb,&amp;<a name='6611'>
       &amp; 5.490192e-01_rb,5.484980e-01_rb,5.480046e-01_rb /)<a name='6612'>
<font color=#447700>!     BAND  16<a name='6613'></font>
      asyliq1(:, 16) = (/ &amp;<a name='6614'>
       &amp; 8.038165e-01_rb,8.014154e-01_rb,7.942381e-01_rb,7.970521e-01_rb,8.086621e-01_rb,&amp;<a name='6615'>
       &amp; 8.233392e-01_rb,8.374127e-01_rb,8.495742e-01_rb,8.596945e-01_rb,8.680497e-01_rb,&amp;<a name='6616'>
       &amp; 8.750005e-01_rb,8.808589e-01_rb,8.858749e-01_rb,8.902403e-01_rb,8.940939e-01_rb,&amp;<a name='6617'>
       &amp; 8.975379e-01_rb,9.006450e-01_rb,9.034741e-01_rb,9.060659e-01_rb,9.084561e-01_rb,&amp;<a name='6618'>
       &amp; 9.106675e-01_rb,9.127198e-01_rb,9.146332e-01_rb,9.164194e-01_rb,9.180970e-01_rb,&amp;<a name='6619'>
       &amp; 9.196658e-01_rb,9.211421e-01_rb,9.225352e-01_rb,9.238443e-01_rb,9.250841e-01_rb,&amp;<a name='6620'>
       &amp; 9.262541e-01_rb,9.273620e-01_rb,9.284081e-01_rb,9.294002e-01_rb,9.303395e-01_rb,&amp;<a name='6621'>
       &amp; 9.312285e-01_rb,9.320715e-01_rb,9.328716e-01_rb,9.336271e-01_rb,9.343427e-01_rb,&amp;<a name='6622'>
       &amp; 9.350219e-01_rb,9.356647e-01_rb,9.362728e-01_rb,9.368495e-01_rb,9.373956e-01_rb,&amp;<a name='6623'>
       &amp; 9.379113e-01_rb,9.383987e-01_rb,9.388608e-01_rb,9.392986e-01_rb,9.397132e-01_rb,&amp;<a name='6624'>
       &amp; 9.401063e-01_rb,9.404776e-01_rb,9.408299e-01_rb,9.411641e-01_rb,9.414800e-01_rb,&amp;<a name='6625'>
       &amp; 9.417787e-01_rb,9.420633e-01_rb,9.423364e-01_rb /)<a name='6626'>
<font color=#447700>!     BAND  17<a name='6627'></font>
      asyliq1(:, 17) = (/ &amp;<a name='6628'>
       &amp; 8.941000e-01_rb,9.054049e-01_rb,9.049510e-01_rb,9.027216e-01_rb,9.021636e-01_rb,&amp;<a name='6629'>
       &amp; 9.037878e-01_rb,9.069852e-01_rb,9.109817e-01_rb,9.152013e-01_rb,9.193040e-01_rb,&amp;<a name='6630'>
       &amp; 9.231177e-01_rb,9.265712e-01_rb,9.296606e-01_rb,9.324048e-01_rb,9.348419e-01_rb,&amp;<a name='6631'>
       &amp; 9.370131e-01_rb,9.389529e-01_rb,9.406954e-01_rb,9.422727e-01_rb,9.437088e-01_rb,&amp;<a name='6632'>
       &amp; 9.450221e-01_rb,9.462308e-01_rb,9.473488e-01_rb,9.483830e-01_rb,9.493492e-01_rb,&amp;<a name='6633'>
       &amp; 9.502541e-01_rb,9.510999e-01_rb,9.518971e-01_rb,9.526455e-01_rb,9.533554e-01_rb,&amp;<a name='6634'>
       &amp; 9.540249e-01_rb,9.546571e-01_rb,9.552551e-01_rb,9.558258e-01_rb,9.563603e-01_rb,&amp;<a name='6635'>
       &amp; 9.568713e-01_rb,9.573569e-01_rb,9.578141e-01_rb,9.582485e-01_rb,9.586604e-01_rb,&amp;<a name='6636'>
       &amp; 9.590525e-01_rb,9.594218e-01_rb,9.597710e-01_rb,9.601052e-01_rb,9.604181e-01_rb,&amp;<a name='6637'>
       &amp; 9.607159e-01_rb,9.609979e-01_rb,9.612655e-01_rb,9.615184e-01_rb,9.617564e-01_rb,&amp;<a name='6638'>
       &amp; 9.619860e-01_rb,9.622009e-01_rb,9.624031e-01_rb,9.625957e-01_rb,9.627792e-01_rb,&amp;<a name='6639'>
       &amp; 9.629530e-01_rb,9.631171e-01_rb,9.632746e-01_rb /)<a name='6640'>
<font color=#447700>!     BAND  18<a name='6641'></font>
      asyliq1(:, 18) = (/ &amp;<a name='6642'>
       &amp; 8.574638e-01_rb,8.351383e-01_rb,8.142977e-01_rb,8.083068e-01_rb,8.129284e-01_rb,&amp;<a name='6643'>
       &amp; 8.215827e-01_rb,8.307238e-01_rb,8.389963e-01_rb,8.460481e-01_rb,8.519273e-01_rb,&amp;<a name='6644'>
       &amp; 8.568153e-01_rb,8.609116e-01_rb,8.643892e-01_rb,8.673941e-01_rb,8.700248e-01_rb,&amp;<a name='6645'>
       &amp; 8.723707e-01_rb,8.744902e-01_rb,8.764240e-01_rb,8.782057e-01_rb,8.798593e-01_rb,&amp;<a name='6646'>
       &amp; 8.814063e-01_rb,8.828573e-01_rb,8.842261e-01_rb,8.855196e-01_rb,8.867497e-01_rb,&amp;<a name='6647'>
       &amp; 8.879164e-01_rb,8.890316e-01_rb,8.900941e-01_rb,8.911118e-01_rb,8.920832e-01_rb,&amp;<a name='6648'>
       &amp; 8.930156e-01_rb,8.939091e-01_rb,8.947663e-01_rb,8.955888e-01_rb,8.963786e-01_rb,&amp;<a name='6649'>
       &amp; 8.971350e-01_rb,8.978617e-01_rb,8.985590e-01_rb,8.992243e-01_rb,8.998631e-01_rb,&amp;<a name='6650'>
       &amp; 9.004753e-01_rb,9.010602e-01_rb,9.016192e-01_rb,9.021542e-01_rb,9.026644e-01_rb,&amp;<a name='6651'>
       &amp; 9.031535e-01_rb,9.036194e-01_rb,9.040656e-01_rb,9.044894e-01_rb,9.048933e-01_rb,&amp;<a name='6652'>
       &amp; 9.052789e-01_rb,9.056481e-01_rb,9.060004e-01_rb,9.063343e-01_rb,9.066544e-01_rb,&amp;<a name='6653'>
       &amp; 9.069604e-01_rb,9.072512e-01_rb,9.075290e-01_rb /)<a name='6654'>
<font color=#447700>!     BAND  19<a name='6655'></font>
      asyliq1(:, 19) = (/ &amp;<a name='6656'>
       &amp; 8.349569e-01_rb,8.034579e-01_rb,7.932136e-01_rb,8.010156e-01_rb,8.137083e-01_rb,&amp;<a name='6657'>
       &amp; 8.255339e-01_rb,8.351938e-01_rb,8.428286e-01_rb,8.488944e-01_rb,8.538187e-01_rb,&amp;<a name='6658'>
       &amp; 8.579255e-01_rb,8.614473e-01_rb,8.645338e-01_rb,8.672908e-01_rb,8.697947e-01_rb,&amp;<a name='6659'>
       &amp; 8.720843e-01_rb,8.742015e-01_rb,8.761718e-01_rb,8.780160e-01_rb,8.797479e-01_rb,&amp;<a name='6660'>
       &amp; 8.813810e-01_rb,8.829250e-01_rb,8.843907e-01_rb,8.857822e-01_rb,8.871059e-01_rb,&amp;<a name='6661'>
       &amp; 8.883724e-01_rb,8.895810e-01_rb,8.907384e-01_rb,8.918456e-01_rb,8.929083e-01_rb,&amp;<a name='6662'>
       &amp; 8.939284e-01_rb,8.949060e-01_rb,8.958463e-01_rb,8.967486e-01_rb,8.976129e-01_rb,&amp;<a name='6663'>
       &amp; 8.984463e-01_rb,8.992439e-01_rb,9.000094e-01_rb,9.007438e-01_rb,9.014496e-01_rb,&amp;<a name='6664'>
       &amp; 9.021235e-01_rb,9.027699e-01_rb,9.033859e-01_rb,9.039772e-01_rb,9.045419e-01_rb,&amp;<a name='6665'>
       &amp; 9.050819e-01_rb,9.055975e-01_rb,9.060907e-01_rb,9.065607e-01_rb,9.070093e-01_rb,&amp;<a name='6666'>
       &amp; 9.074389e-01_rb,9.078475e-01_rb,9.082388e-01_rb,9.086117e-01_rb,9.089678e-01_rb,&amp;<a name='6667'>
       &amp; 9.093081e-01_rb,9.096307e-01_rb,9.099410e-01_rb /)<a name='6668'>
<font color=#447700>!     BAND  20<a name='6669'></font>
      asyliq1(:, 20) = (/ &amp;<a name='6670'>
       &amp; 8.109692e-01_rb,7.846657e-01_rb,7.881928e-01_rb,8.009509e-01_rb,8.131208e-01_rb,&amp;<a name='6671'>
       &amp; 8.230400e-01_rb,8.309448e-01_rb,8.372920e-01_rb,8.424837e-01_rb,8.468166e-01_rb,&amp;<a name='6672'>
       &amp; 8.504947e-01_rb,8.536642e-01_rb,8.564256e-01_rb,8.588513e-01_rb,8.610011e-01_rb,&amp;<a name='6673'>
       &amp; 8.629122e-01_rb,8.646262e-01_rb,8.661720e-01_rb,8.675752e-01_rb,8.688582e-01_rb,&amp;<a name='6674'>
       &amp; 8.700379e-01_rb,8.711300e-01_rb,8.721485e-01_rb,8.731027e-01_rb,8.740010e-01_rb,&amp;<a name='6675'>
       &amp; 8.748499e-01_rb,8.756564e-01_rb,8.764239e-01_rb,8.771542e-01_rb,8.778523e-01_rb,&amp;<a name='6676'>
       &amp; 8.785211e-01_rb,8.791601e-01_rb,8.797725e-01_rb,8.803589e-01_rb,8.809173e-01_rb,&amp;<a name='6677'>
       &amp; 8.814552e-01_rb,8.819705e-01_rb,8.824611e-01_rb,8.829311e-01_rb,8.833791e-01_rb,&amp;<a name='6678'>
       &amp; 8.838078e-01_rb,8.842148e-01_rb,8.846044e-01_rb,8.849756e-01_rb,8.853291e-01_rb,&amp;<a name='6679'>
       &amp; 8.856645e-01_rb,8.859841e-01_rb,8.862904e-01_rb,8.865801e-01_rb,8.868551e-01_rb,&amp;<a name='6680'>
       &amp; 8.871182e-01_rb,8.873673e-01_rb,8.876059e-01_rb,8.878307e-01_rb,8.880462e-01_rb,&amp;<a name='6681'>
       &amp; 8.882501e-01_rb,8.884453e-01_rb,8.886339e-01_rb /)<a name='6682'>
<font color=#447700>!     BAND  21<a name='6683'></font>
      asyliq1(:, 21) = (/ &amp;<a name='6684'>
       &amp; 7.838510e-01_rb,7.803151e-01_rb,7.980477e-01_rb,8.144160e-01_rb,8.261784e-01_rb,&amp;<a name='6685'>
       &amp; 8.344240e-01_rb,8.404278e-01_rb,8.450391e-01_rb,8.487593e-01_rb,8.518741e-01_rb,&amp;<a name='6686'>
       &amp; 8.545484e-01_rb,8.568890e-01_rb,8.589560e-01_rb,8.607983e-01_rb,8.624504e-01_rb,&amp;<a name='6687'>
       &amp; 8.639408e-01_rb,8.652945e-01_rb,8.665301e-01_rb,8.676634e-01_rb,8.687121e-01_rb,&amp;<a name='6688'>
       &amp; 8.696855e-01_rb,8.705933e-01_rb,8.714448e-01_rb,8.722454e-01_rb,8.730014e-01_rb,&amp;<a name='6689'>
       &amp; 8.737180e-01_rb,8.743982e-01_rb,8.750436e-01_rb,8.756598e-01_rb,8.762481e-01_rb,&amp;<a name='6690'>
       &amp; 8.768089e-01_rb,8.773427e-01_rb,8.778532e-01_rb,8.783434e-01_rb,8.788089e-01_rb,&amp;<a name='6691'>
       &amp; 8.792530e-01_rb,8.796784e-01_rb,8.800845e-01_rb,8.804716e-01_rb,8.808411e-01_rb,&amp;<a name='6692'>
       &amp; 8.811923e-01_rb,8.815276e-01_rb,8.818472e-01_rb,8.821504e-01_rb,8.824408e-01_rb,&amp;<a name='6693'>
       &amp; 8.827155e-01_rb,8.829777e-01_rb,8.832269e-01_rb,8.834631e-01_rb,8.836892e-01_rb,&amp;<a name='6694'>
       &amp; 8.839034e-01_rb,8.841075e-01_rb,8.843021e-01_rb,8.844866e-01_rb,8.846631e-01_rb,&amp;<a name='6695'>
       &amp; 8.848304e-01_rb,8.849910e-01_rb,8.851425e-01_rb /)<a name='6696'>
<font color=#447700>!     BAND  22<a name='6697'></font>
      asyliq1(:, 22) = (/ &amp;<a name='6698'>
       &amp; 7.760783e-01_rb,7.890215e-01_rb,8.090192e-01_rb,8.230252e-01_rb,8.321369e-01_rb,&amp;<a name='6699'>
       &amp; 8.384258e-01_rb,8.431529e-01_rb,8.469558e-01_rb,8.501499e-01_rb,8.528899e-01_rb,&amp;<a name='6700'>
       &amp; 8.552899e-01_rb,8.573956e-01_rb,8.592570e-01_rb,8.609098e-01_rb,8.623897e-01_rb,&amp;<a name='6701'>
       &amp; 8.637169e-01_rb,8.649184e-01_rb,8.660097e-01_rb,8.670096e-01_rb,8.679338e-01_rb,&amp;<a name='6702'>
       &amp; 8.687896e-01_rb,8.695880e-01_rb,8.703365e-01_rb,8.710422e-01_rb,8.717092e-01_rb,&amp;<a name='6703'>
       &amp; 8.723378e-01_rb,8.729363e-01_rb,8.735063e-01_rb,8.740475e-01_rb,8.745661e-01_rb,&amp;<a name='6704'>
       &amp; 8.750560e-01_rb,8.755275e-01_rb,8.759731e-01_rb,8.764000e-01_rb,8.768071e-01_rb,&amp;<a name='6705'>
       &amp; 8.771942e-01_rb,8.775628e-01_rb,8.779126e-01_rb,8.782483e-01_rb,8.785626e-01_rb,&amp;<a name='6706'>
       &amp; 8.788610e-01_rb,8.791482e-01_rb,8.794180e-01_rb,8.796765e-01_rb,8.799207e-01_rb,&amp;<a name='6707'>
       &amp; 8.801522e-01_rb,8.803707e-01_rb,8.805777e-01_rb,8.807749e-01_rb,8.809605e-01_rb,&amp;<a name='6708'>
       &amp; 8.811362e-01_rb,8.813047e-01_rb,8.814647e-01_rb,8.816131e-01_rb,8.817588e-01_rb,&amp;<a name='6709'>
       &amp; 8.818930e-01_rb,8.820230e-01_rb,8.821445e-01_rb /)<a name='6710'>
<font color=#447700>!     BAND  23<a name='6711'></font>
      asyliq1(:, 23) = (/ &amp;<a name='6712'>
       &amp; 7.847907e-01_rb,8.099917e-01_rb,8.257428e-01_rb,8.350423e-01_rb,8.411971e-01_rb,&amp;<a name='6713'>
       &amp; 8.457241e-01_rb,8.493010e-01_rb,8.522565e-01_rb,8.547660e-01_rb,8.569311e-01_rb,&amp;<a name='6714'>
       &amp; 8.588181e-01_rb,8.604729e-01_rb,8.619296e-01_rb,8.632208e-01_rb,8.643725e-01_rb,&amp;<a name='6715'>
       &amp; 8.654050e-01_rb,8.663363e-01_rb,8.671835e-01_rb,8.679590e-01_rb,8.686707e-01_rb,&amp;<a name='6716'>
       &amp; 8.693308e-01_rb,8.699433e-01_rb,8.705147e-01_rb,8.710490e-01_rb,8.715497e-01_rb,&amp;<a name='6717'>
       &amp; 8.720219e-01_rb,8.724669e-01_rb,8.728849e-01_rb,8.732806e-01_rb,8.736550e-01_rb,&amp;<a name='6718'>
       &amp; 8.740099e-01_rb,8.743435e-01_rb,8.746601e-01_rb,8.749610e-01_rb,8.752449e-01_rb,&amp;<a name='6719'>
       &amp; 8.755143e-01_rb,8.757688e-01_rb,8.760095e-01_rb,8.762375e-01_rb,8.764532e-01_rb,&amp;<a name='6720'>
       &amp; 8.766579e-01_rb,8.768506e-01_rb,8.770323e-01_rb,8.772049e-01_rb,8.773690e-01_rb,&amp;<a name='6721'>
       &amp; 8.775226e-01_rb,8.776679e-01_rb,8.778062e-01_rb,8.779360e-01_rb,8.780587e-01_rb,&amp;<a name='6722'>
       &amp; 8.781747e-01_rb,8.782852e-01_rb,8.783892e-01_rb,8.784891e-01_rb,8.785824e-01_rb,&amp;<a name='6723'>
       &amp; 8.786705e-01_rb,8.787546e-01_rb,8.788336e-01_rb /)<a name='6724'>
<font color=#447700>!     BAND  24<a name='6725'></font>
      asyliq1(:, 24) = (/ &amp;<a name='6726'>
       &amp; 8.054324e-01_rb,8.266282e-01_rb,8.378075e-01_rb,8.449848e-01_rb,8.502166e-01_rb,&amp;<a name='6727'>
       &amp; 8.542268e-01_rb,8.573477e-01_rb,8.598022e-01_rb,8.617689e-01_rb,8.633859e-01_rb,&amp;<a name='6728'>
       &amp; 8.647536e-01_rb,8.659354e-01_rb,8.669807e-01_rb,8.679143e-01_rb,8.687577e-01_rb,&amp;<a name='6729'>
       &amp; 8.695222e-01_rb,8.702207e-01_rb,8.708591e-01_rb,8.714446e-01_rb,8.719836e-01_rb,&amp;<a name='6730'>
       &amp; 8.724812e-01_rb,8.729426e-01_rb,8.733689e-01_rb,8.737665e-01_rb,8.741373e-01_rb,&amp;<a name='6731'>
       &amp; 8.744834e-01_rb,8.748070e-01_rb,8.751131e-01_rb,8.754011e-01_rb,8.756676e-01_rb,&amp;<a name='6732'>
       &amp; 8.759219e-01_rb,8.761599e-01_rb,8.763857e-01_rb,8.765984e-01_rb,8.767999e-01_rb,&amp;<a name='6733'>
       &amp; 8.769889e-01_rb,8.771669e-01_rb,8.773373e-01_rb,8.774969e-01_rb,8.776469e-01_rb,&amp;<a name='6734'>
       &amp; 8.777894e-01_rb,8.779237e-01_rb,8.780505e-01_rb,8.781703e-01_rb,8.782820e-01_rb,&amp;<a name='6735'>
       &amp; 8.783886e-01_rb,8.784894e-01_rb,8.785844e-01_rb,8.786736e-01_rb,8.787584e-01_rb,&amp;<a name='6736'>
       &amp; 8.788379e-01_rb,8.789130e-01_rb,8.789849e-01_rb,8.790506e-01_rb,8.791141e-01_rb,&amp;<a name='6737'>
       &amp; 8.791750e-01_rb,8.792324e-01_rb,8.792867e-01_rb /)<a name='6738'>
<font color=#447700>!     BAND  25<a name='6739'></font>
      asyliq1(:, 25) = (/ &amp;<a name='6740'>
       &amp; 8.249534e-01_rb,8.391988e-01_rb,8.474107e-01_rb,8.526860e-01_rb,8.563983e-01_rb,&amp;<a name='6741'>
       &amp; 8.592389e-01_rb,8.615144e-01_rb,8.633790e-01_rb,8.649325e-01_rb,8.662504e-01_rb,&amp;<a name='6742'>
       &amp; 8.673841e-01_rb,8.683741e-01_rb,8.692495e-01_rb,8.700309e-01_rb,8.707328e-01_rb,&amp;<a name='6743'>
       &amp; 8.713650e-01_rb,8.719432e-01_rb,8.724676e-01_rb,8.729498e-01_rb,8.733922e-01_rb,&amp;<a name='6744'>
       &amp; 8.737981e-01_rb,8.741745e-01_rb,8.745225e-01_rb,8.748467e-01_rb,8.751512e-01_rb,&amp;<a name='6745'>
       &amp; 8.754315e-01_rb,8.756962e-01_rb,8.759450e-01_rb,8.761774e-01_rb,8.763945e-01_rb,&amp;<a name='6746'>
       &amp; 8.766021e-01_rb,8.767970e-01_rb,8.769803e-01_rb,8.771511e-01_rb,8.773151e-01_rb,&amp;<a name='6747'>
       &amp; 8.774689e-01_rb,8.776147e-01_rb,8.777533e-01_rb,8.778831e-01_rb,8.780050e-01_rb,&amp;<a name='6748'>
       &amp; 8.781197e-01_rb,8.782301e-01_rb,8.783323e-01_rb,8.784312e-01_rb,8.785222e-01_rb,&amp;<a name='6749'>
       &amp; 8.786096e-01_rb,8.786916e-01_rb,8.787688e-01_rb,8.788411e-01_rb,8.789122e-01_rb,&amp;<a name='6750'>
       &amp; 8.789762e-01_rb,8.790373e-01_rb,8.790954e-01_rb,8.791514e-01_rb,8.792018e-01_rb,&amp;<a name='6751'>
       &amp; 8.792517e-01_rb,8.792990e-01_rb,8.793429e-01_rb /)<a name='6752'>
<font color=#447700>!     BAND  26<a name='6753'></font>
      asyliq1(:, 26) = (/ &amp;<a name='6754'>
       &amp; 8.323091e-01_rb,8.429776e-01_rb,8.498123e-01_rb,8.546929e-01_rb,8.584295e-01_rb,&amp;<a name='6755'>
       &amp; 8.613489e-01_rb,8.636324e-01_rb,8.654303e-01_rb,8.668675e-01_rb,8.680404e-01_rb,&amp;<a name='6756'>
       &amp; 8.690174e-01_rb,8.698495e-01_rb,8.705666e-01_rb,8.711961e-01_rb,8.717556e-01_rb,&amp;<a name='6757'>
       &amp; 8.722546e-01_rb,8.727063e-01_rb,8.731170e-01_rb,8.734933e-01_rb,8.738382e-01_rb,&amp;<a name='6758'>
       &amp; 8.741590e-01_rb,8.744525e-01_rb,8.747295e-01_rb,8.749843e-01_rb,8.752210e-01_rb,&amp;<a name='6759'>
       &amp; 8.754437e-01_rb,8.756524e-01_rb,8.758472e-01_rb,8.760288e-01_rb,8.762030e-01_rb,&amp;<a name='6760'>
       &amp; 8.763603e-01_rb,8.765122e-01_rb,8.766539e-01_rb,8.767894e-01_rb,8.769130e-01_rb,&amp;<a name='6761'>
       &amp; 8.770310e-01_rb,8.771422e-01_rb,8.772437e-01_rb,8.773419e-01_rb,8.774355e-01_rb,&amp;<a name='6762'>
       &amp; 8.775221e-01_rb,8.776047e-01_rb,8.776802e-01_rb,8.777539e-01_rb,8.778216e-01_rb,&amp;<a name='6763'>
       &amp; 8.778859e-01_rb,8.779473e-01_rb,8.780031e-01_rb,8.780562e-01_rb,8.781097e-01_rb,&amp;<a name='6764'>
       &amp; 8.781570e-01_rb,8.782021e-01_rb,8.782463e-01_rb,8.782845e-01_rb,8.783235e-01_rb,&amp;<a name='6765'>
       &amp; 8.783610e-01_rb,8.783953e-01_rb,8.784273e-01_rb /)<a name='6766'>
<font color=#447700>!     BAND  27<a name='6767'></font>
      asyliq1(:, 27) = (/ &amp;<a name='6768'>
       &amp; 8.396448e-01_rb,8.480172e-01_rb,8.535934e-01_rb,8.574145e-01_rb,8.600835e-01_rb,&amp;<a name='6769'>
       &amp; 8.620347e-01_rb,8.635500e-01_rb,8.648003e-01_rb,8.658758e-01_rb,8.668248e-01_rb,&amp;<a name='6770'>
       &amp; 8.676697e-01_rb,8.684220e-01_rb,8.690893e-01_rb,8.696807e-01_rb,8.702046e-01_rb,&amp;<a name='6771'>
       &amp; 8.706676e-01_rb,8.710798e-01_rb,8.714478e-01_rb,8.717778e-01_rb,8.720747e-01_rb,&amp;<a name='6772'>
       &amp; 8.723431e-01_rb,8.725889e-01_rb,8.728144e-01_rb,8.730201e-01_rb,8.732129e-01_rb,&amp;<a name='6773'>
       &amp; 8.733907e-01_rb,8.735541e-01_rb,8.737100e-01_rb,8.738533e-01_rb,8.739882e-01_rb,&amp;<a name='6774'>
       &amp; 8.741164e-01_rb,8.742362e-01_rb,8.743485e-01_rb,8.744530e-01_rb,8.745512e-01_rb,&amp;<a name='6775'>
       &amp; 8.746471e-01_rb,8.747373e-01_rb,8.748186e-01_rb,8.748973e-01_rb,8.749732e-01_rb,&amp;<a name='6776'>
       &amp; 8.750443e-01_rb,8.751105e-01_rb,8.751747e-01_rb,8.752344e-01_rb,8.752902e-01_rb,&amp;<a name='6777'>
       &amp; 8.753412e-01_rb,8.753917e-01_rb,8.754393e-01_rb,8.754843e-01_rb,8.755282e-01_rb,&amp;<a name='6778'>
       &amp; 8.755662e-01_rb,8.756039e-01_rb,8.756408e-01_rb,8.756722e-01_rb,8.757072e-01_rb,&amp;<a name='6779'>
       &amp; 8.757352e-01_rb,8.757653e-01_rb,8.757932e-01_rb /)<a name='6780'>
<font color=#447700>!     BAND  28<a name='6781'></font>
      asyliq1(:, 28) = (/ &amp;<a name='6782'>
       &amp; 8.374590e-01_rb,8.465669e-01_rb,8.518701e-01_rb,8.547627e-01_rb,8.565745e-01_rb,&amp;<a name='6783'>
       &amp; 8.579065e-01_rb,8.589717e-01_rb,8.598632e-01_rb,8.606363e-01_rb,8.613268e-01_rb,&amp;<a name='6784'>
       &amp; 8.619560e-01_rb,8.625340e-01_rb,8.630689e-01_rb,8.635601e-01_rb,8.640084e-01_rb,&amp;<a name='6785'>
       &amp; 8.644180e-01_rb,8.647885e-01_rb,8.651220e-01_rb,8.654218e-01_rb,8.656908e-01_rb,&amp;<a name='6786'>
       &amp; 8.659294e-01_rb,8.661422e-01_rb,8.663334e-01_rb,8.665037e-01_rb,8.666543e-01_rb,&amp;<a name='6787'>
       &amp; 8.667913e-01_rb,8.669156e-01_rb,8.670242e-01_rb,8.671249e-01_rb,8.672161e-01_rb,&amp;<a name='6788'>
       &amp; 8.672993e-01_rb,8.673733e-01_rb,8.674457e-01_rb,8.675103e-01_rb,8.675713e-01_rb,&amp;<a name='6789'>
       &amp; 8.676267e-01_rb,8.676798e-01_rb,8.677286e-01_rb,8.677745e-01_rb,8.678178e-01_rb,&amp;<a name='6790'>
       &amp; 8.678601e-01_rb,8.678986e-01_rb,8.679351e-01_rb,8.679693e-01_rb,8.680013e-01_rb,&amp;<a name='6791'>
       &amp; 8.680334e-01_rb,8.680624e-01_rb,8.680915e-01_rb,8.681178e-01_rb,8.681428e-01_rb,&amp;<a name='6792'>
       &amp; 8.681654e-01_rb,8.681899e-01_rb,8.682103e-01_rb,8.682317e-01_rb,8.682498e-01_rb,&amp;<a name='6793'>
       &amp; 8.682677e-01_rb,8.682861e-01_rb,8.683041e-01_rb /)<a name='6794'>
<font color=#447700>!     BAND  29<a name='6795'></font>
      asyliq1(:, 29) = (/ &amp;<a name='6796'>
       &amp; 7.877069e-01_rb,8.244281e-01_rb,8.367971e-01_rb,8.409074e-01_rb,8.429859e-01_rb,&amp;<a name='6797'>
       &amp; 8.454386e-01_rb,8.489350e-01_rb,8.534141e-01_rb,8.585814e-01_rb,8.641267e-01_rb,&amp;<a name='6798'>
       &amp; 8.697999e-01_rb,8.754223e-01_rb,8.808785e-01_rb,8.860944e-01_rb,8.910354e-01_rb,&amp;<a name='6799'>
       &amp; 8.956837e-01_rb,9.000392e-01_rb,9.041091e-01_rb,9.079071e-01_rb,9.114479e-01_rb,&amp;<a name='6800'>
       &amp; 9.147462e-01_rb,9.178234e-01_rb,9.206903e-01_rb,9.233663e-01_rb,9.258668e-01_rb,&amp;<a name='6801'>
       &amp; 9.282006e-01_rb,9.303847e-01_rb,9.324288e-01_rb,9.343418e-01_rb,9.361356e-01_rb,&amp;<a name='6802'>
       &amp; 9.378176e-01_rb,9.393939e-01_rb,9.408736e-01_rb,9.422622e-01_rb,9.435670e-01_rb,&amp;<a name='6803'>
       &amp; 9.447900e-01_rb,9.459395e-01_rb,9.470199e-01_rb,9.480335e-01_rb,9.489852e-01_rb,&amp;<a name='6804'>
       &amp; 9.498782e-01_rb,9.507168e-01_rb,9.515044e-01_rb,9.522470e-01_rb,9.529409e-01_rb,&amp;<a name='6805'>
       &amp; 9.535946e-01_rb,9.542071e-01_rb,9.547838e-01_rb,9.553256e-01_rb,9.558351e-01_rb,&amp;<a name='6806'>
       &amp; 9.563139e-01_rb,9.567660e-01_rb,9.571915e-01_rb,9.575901e-01_rb,9.579685e-01_rb,&amp;<a name='6807'>
       &amp; 9.583239e-01_rb,9.586602e-01_rb,9.589766e-01_rb /)<a name='6808'>
<a name='6809'>
<a name='6810'>
<font color=#447700>! Spherical Ice Particle Parameterization<a name='6811'></font>
<font color=#447700>! extinction units (ext coef/iwc): [(m^-1)/(g m^-3)]<a name='6812'></font>
      extice2(:, 16) = (/ &amp;<a name='6813'>
<font color=#447700>! band 16<a name='6814'></font>
        &amp; 4.101824e-01_rb,2.435514e-01_rb,1.713697e-01_rb,1.314865e-01_rb,1.063406e-01_rb,&amp;<a name='6815'>
        &amp; 8.910701e-02_rb,7.659480e-02_rb,6.711784e-02_rb,5.970353e-02_rb,5.375249e-02_rb,&amp;<a name='6816'>
        &amp; 4.887577e-02_rb,4.481025e-02_rb,4.137171e-02_rb,3.842744e-02_rb,3.587948e-02_rb,&amp;<a name='6817'>
        &amp; 3.365396e-02_rb,3.169419e-02_rb,2.995593e-02_rb,2.840419e-02_rb,2.701091e-02_rb,&amp;<a name='6818'>
        &amp; 2.575336e-02_rb,2.461293e-02_rb,2.357423e-02_rb,2.262443e-02_rb,2.175276e-02_rb,&amp;<a name='6819'>
        &amp; 2.095012e-02_rb,2.020875e-02_rb,1.952199e-02_rb,1.888412e-02_rb,1.829018e-02_rb,&amp;<a name='6820'>
        &amp; 1.773586e-02_rb,1.721738e-02_rb,1.673144e-02_rb,1.627510e-02_rb,1.584579e-02_rb,&amp;<a name='6821'>
        &amp; 1.544122e-02_rb,1.505934e-02_rb,1.469833e-02_rb,1.435654e-02_rb,1.403251e-02_rb,&amp;<a name='6822'>
        &amp; 1.372492e-02_rb,1.343255e-02_rb,1.315433e-02_rb /)<a name='6823'>
      extice2(:, 17) = (/ &amp;<a name='6824'>
<font color=#447700>! band 17<a name='6825'></font>
        &amp; 3.836650e-01_rb,2.304055e-01_rb,1.637265e-01_rb,1.266681e-01_rb,1.031602e-01_rb,&amp;<a name='6826'>
        &amp; 8.695191e-02_rb,7.511544e-02_rb,6.610009e-02_rb,5.900909e-02_rb,5.328833e-02_rb,&amp;<a name='6827'>
        &amp; 4.857728e-02_rb,4.463133e-02_rb,4.127880e-02_rb,3.839567e-02_rb,3.589013e-02_rb,&amp;<a name='6828'>
        &amp; 3.369280e-02_rb,3.175027e-02_rb,3.002079e-02_rb,2.847121e-02_rb,2.707493e-02_rb,&amp;<a name='6829'>
        &amp; 2.581031e-02_rb,2.465962e-02_rb,2.360815e-02_rb,2.264363e-02_rb,2.175571e-02_rb,&amp;<a name='6830'>
        &amp; 2.093563e-02_rb,2.017592e-02_rb,1.947015e-02_rb,1.881278e-02_rb,1.819901e-02_rb,&amp;<a name='6831'>
        &amp; 1.762463e-02_rb,1.708598e-02_rb,1.657982e-02_rb,1.610330e-02_rb,1.565390e-02_rb,&amp;<a name='6832'>
        &amp; 1.522937e-02_rb,1.482768e-02_rb,1.444706e-02_rb,1.408588e-02_rb,1.374270e-02_rb,&amp;<a name='6833'>
        &amp; 1.341619e-02_rb,1.310517e-02_rb,1.280857e-02_rb /)<a name='6834'>
      extice2(:, 18) = (/ &amp;<a name='6835'>
<font color=#447700>! band 18<a name='6836'></font>
        &amp; 4.152673e-01_rb,2.436816e-01_rb,1.702243e-01_rb,1.299704e-01_rb,1.047528e-01_rb,&amp;<a name='6837'>
        &amp; 8.756039e-02_rb,7.513327e-02_rb,6.575690e-02_rb,5.844616e-02_rb,5.259609e-02_rb,&amp;<a name='6838'>
        &amp; 4.781531e-02_rb,4.383980e-02_rb,4.048517e-02_rb,3.761891e-02_rb,3.514342e-02_rb,&amp;<a name='6839'>
        &amp; 3.298525e-02_rb,3.108814e-02_rb,2.940825e-02_rb,2.791096e-02_rb,2.656858e-02_rb,&amp;<a name='6840'>
        &amp; 2.535869e-02_rb,2.426297e-02_rb,2.326627e-02_rb,2.235602e-02_rb,2.152164e-02_rb,&amp;<a name='6841'>
        &amp; 2.075420e-02_rb,2.004613e-02_rb,1.939091e-02_rb,1.878296e-02_rb,1.821744e-02_rb,&amp;<a name='6842'>
        &amp; 1.769015e-02_rb,1.719741e-02_rb,1.673600e-02_rb,1.630308e-02_rb,1.589615e-02_rb,&amp;<a name='6843'>
        &amp; 1.551298e-02_rb,1.515159e-02_rb,1.481021e-02_rb,1.448726e-02_rb,1.418131e-02_rb,&amp;<a name='6844'>
        &amp; 1.389109e-02_rb,1.361544e-02_rb,1.335330e-02_rb /)<a name='6845'>
      extice2(:, 19) = (/ &amp;<a name='6846'>
<font color=#447700>! band 19<a name='6847'></font>
        &amp; 3.873250e-01_rb,2.331609e-01_rb,1.655002e-01_rb,1.277753e-01_rb,1.038247e-01_rb,&amp;<a name='6848'>
        &amp; 8.731780e-02_rb,7.527638e-02_rb,6.611873e-02_rb,5.892850e-02_rb,5.313885e-02_rb,&amp;<a name='6849'>
        &amp; 4.838068e-02_rb,4.440356e-02_rb,4.103167e-02_rb,3.813804e-02_rb,3.562870e-02_rb,&amp;<a name='6850'>
        &amp; 3.343269e-02_rb,3.149539e-02_rb,2.977414e-02_rb,2.823510e-02_rb,2.685112e-02_rb,&amp;<a name='6851'>
        &amp; 2.560015e-02_rb,2.446411e-02_rb,2.342805e-02_rb,2.247948e-02_rb,2.160789e-02_rb,&amp;<a name='6852'>
        &amp; 2.080438e-02_rb,2.006139e-02_rb,1.937238e-02_rb,1.873177e-02_rb,1.813469e-02_rb,&amp;<a name='6853'>
        &amp; 1.757689e-02_rb,1.705468e-02_rb,1.656479e-02_rb,1.610435e-02_rb,1.567081e-02_rb,&amp;<a name='6854'>
        &amp; 1.526192e-02_rb,1.487565e-02_rb,1.451020e-02_rb,1.416396e-02_rb,1.383546e-02_rb,&amp;<a name='6855'>
        &amp; 1.352339e-02_rb,1.322657e-02_rb,1.294392e-02_rb /)<a name='6856'>
      extice2(:, 20) = (/ &amp;<a name='6857'>
<font color=#447700>! band 20<a name='6858'></font>
        &amp; 3.784280e-01_rb,2.291396e-01_rb,1.632551e-01_rb,1.263775e-01_rb,1.028944e-01_rb,&amp;<a name='6859'>
        &amp; 8.666975e-02_rb,7.480952e-02_rb,6.577335e-02_rb,5.866714e-02_rb,5.293694e-02_rb,&amp;<a name='6860'>
        &amp; 4.822153e-02_rb,4.427547e-02_rb,4.092626e-02_rb,3.804918e-02_rb,3.555184e-02_rb,&amp;<a name='6861'>
        &amp; 3.336440e-02_rb,3.143307e-02_rb,2.971577e-02_rb,2.817912e-02_rb,2.679632e-02_rb,&amp;<a name='6862'>
        &amp; 2.554558e-02_rb,2.440903e-02_rb,2.337187e-02_rb,2.242173e-02_rb,2.154821e-02_rb,&amp;<a name='6863'>
        &amp; 2.074249e-02_rb,1.999706e-02_rb,1.930546e-02_rb,1.866212e-02_rb,1.806221e-02_rb,&amp;<a name='6864'>
        &amp; 1.750152e-02_rb,1.697637e-02_rb,1.648352e-02_rb,1.602010e-02_rb,1.558358e-02_rb,&amp;<a name='6865'>
        &amp; 1.517172e-02_rb,1.478250e-02_rb,1.441413e-02_rb,1.406498e-02_rb,1.373362e-02_rb,&amp;<a name='6866'>
        &amp; 1.341872e-02_rb,1.311911e-02_rb,1.283371e-02_rb /)<a name='6867'>
      extice2(:, 21) = (/ &amp;<a name='6868'>
<font color=#447700>! band 21<a name='6869'></font>
        &amp; 3.719909e-01_rb,2.259490e-01_rb,1.613144e-01_rb,1.250648e-01_rb,1.019462e-01_rb,&amp;<a name='6870'>
        &amp; 8.595358e-02_rb,7.425064e-02_rb,6.532618e-02_rb,5.830218e-02_rb,5.263421e-02_rb,&amp;<a name='6871'>
        &amp; 4.796697e-02_rb,4.405891e-02_rb,4.074013e-02_rb,3.788776e-02_rb,3.541071e-02_rb,&amp;<a name='6872'>
        &amp; 3.324008e-02_rb,3.132280e-02_rb,2.961733e-02_rb,2.809071e-02_rb,2.671645e-02_rb,&amp;<a name='6873'>
        &amp; 2.547302e-02_rb,2.434276e-02_rb,2.331102e-02_rb,2.236558e-02_rb,2.149614e-02_rb,&amp;<a name='6874'>
        &amp; 2.069397e-02_rb,1.995163e-02_rb,1.926272e-02_rb,1.862174e-02_rb,1.802389e-02_rb,&amp;<a name='6875'>
        &amp; 1.746500e-02_rb,1.694142e-02_rb,1.644994e-02_rb,1.598772e-02_rb,1.555225e-02_rb,&amp;<a name='6876'>
        &amp; 1.514129e-02_rb,1.475286e-02_rb,1.438515e-02_rb,1.403659e-02_rb,1.370572e-02_rb,&amp;<a name='6877'>
        &amp; 1.339124e-02_rb,1.309197e-02_rb,1.280685e-02_rb /)<a name='6878'>
      extice2(:, 22) = (/ &amp;<a name='6879'>
<font color=#447700>! band 22<a name='6880'></font>
        &amp; 3.713158e-01_rb,2.253816e-01_rb,1.608461e-01_rb,1.246718e-01_rb,1.016109e-01_rb,&amp;<a name='6881'>
        &amp; 8.566332e-02_rb,7.399666e-02_rb,6.510199e-02_rb,5.810290e-02_rb,5.245608e-02_rb,&amp;<a name='6882'>
        &amp; 4.780702e-02_rb,4.391478e-02_rb,4.060989e-02_rb,3.776982e-02_rb,3.530374e-02_rb,&amp;<a name='6883'>
        &amp; 3.314296e-02_rb,3.123458e-02_rb,2.953719e-02_rb,2.801794e-02_rb,2.665043e-02_rb,&amp;<a name='6884'>
        &amp; 2.541321e-02_rb,2.428868e-02_rb,2.326224e-02_rb,2.232173e-02_rb,2.145688e-02_rb,&amp;<a name='6885'>
        &amp; 2.065899e-02_rb,1.992067e-02_rb,1.923552e-02_rb,1.859808e-02_rb,1.800356e-02_rb,&amp;<a name='6886'>
        &amp; 1.744782e-02_rb,1.692721e-02_rb,1.643855e-02_rb,1.597900e-02_rb,1.554606e-02_rb,&amp;<a name='6887'>
        &amp; 1.513751e-02_rb,1.475137e-02_rb,1.438586e-02_rb,1.403938e-02_rb,1.371050e-02_rb,&amp;<a name='6888'>
        &amp; 1.339793e-02_rb,1.310050e-02_rb,1.281713e-02_rb /)<a name='6889'>
      extice2(:, 23) = (/ &amp;<a name='6890'>
<font color=#447700>! band 23<a name='6891'></font>
        &amp; 3.605883e-01_rb,2.204388e-01_rb,1.580431e-01_rb,1.229033e-01_rb,1.004203e-01_rb,&amp;<a name='6892'>
        &amp; 8.482616e-02_rb,7.338941e-02_rb,6.465105e-02_rb,5.776176e-02_rb,5.219398e-02_rb,&amp;<a name='6893'>
        &amp; 4.760288e-02_rb,4.375369e-02_rb,4.048111e-02_rb,3.766539e-02_rb,3.521771e-02_rb,&amp;<a name='6894'>
        &amp; 3.307079e-02_rb,3.117277e-02_rb,2.948303e-02_rb,2.796929e-02_rb,2.660560e-02_rb,&amp;<a name='6895'>
        &amp; 2.537086e-02_rb,2.424772e-02_rb,2.322182e-02_rb,2.228114e-02_rb,2.141556e-02_rb,&amp;<a name='6896'>
        &amp; 2.061649e-02_rb,1.987661e-02_rb,1.918962e-02_rb,1.855009e-02_rb,1.795330e-02_rb,&amp;<a name='6897'>
        &amp; 1.739514e-02_rb,1.687199e-02_rb,1.638069e-02_rb,1.591845e-02_rb,1.548276e-02_rb,&amp;<a name='6898'>
        &amp; 1.507143e-02_rb,1.468249e-02_rb,1.431416e-02_rb,1.396486e-02_rb,1.363318e-02_rb,&amp;<a name='6899'>
        &amp; 1.331781e-02_rb,1.301759e-02_rb,1.273147e-02_rb /)<a name='6900'>
      extice2(:, 24) = (/ &amp;<a name='6901'>
<font color=#447700>! band 24<a name='6902'></font>
        &amp; 3.527890e-01_rb,2.168469e-01_rb,1.560090e-01_rb,1.216216e-01_rb,9.955787e-02_rb,&amp;<a name='6903'>
        &amp; 8.421942e-02_rb,7.294827e-02_rb,6.432192e-02_rb,5.751081e-02_rb,5.199888e-02_rb,&amp;<a name='6904'>
        &amp; 4.744835e-02_rb,4.362899e-02_rb,4.037847e-02_rb,3.757910e-02_rb,3.514351e-02_rb,&amp;<a name='6905'>
        &amp; 3.300546e-02_rb,3.111382e-02_rb,2.942853e-02_rb,2.791775e-02_rb,2.655584e-02_rb,&amp;<a name='6906'>
        &amp; 2.532195e-02_rb,2.419892e-02_rb,2.317255e-02_rb,2.223092e-02_rb,2.136402e-02_rb,&amp;<a name='6907'>
        &amp; 2.056334e-02_rb,1.982160e-02_rb,1.913258e-02_rb,1.849087e-02_rb,1.789178e-02_rb,&amp;<a name='6908'>
        &amp; 1.733124e-02_rb,1.680565e-02_rb,1.631187e-02_rb,1.584711e-02_rb,1.540889e-02_rb,&amp;<a name='6909'>
        &amp; 1.499502e-02_rb,1.460354e-02_rb,1.423269e-02_rb,1.388088e-02_rb,1.354670e-02_rb,&amp;<a name='6910'>
        &amp; 1.322887e-02_rb,1.292620e-02_rb,1.263767e-02_rb /)<a name='6911'>
      extice2(:, 25) = (/ &amp;<a name='6912'>
<font color=#447700>! band 25<a name='6913'></font>
        &amp; 3.477874e-01_rb,2.143515e-01_rb,1.544887e-01_rb,1.205942e-01_rb,9.881779e-02_rb,&amp;<a name='6914'>
        &amp; 8.366261e-02_rb,7.251586e-02_rb,6.397790e-02_rb,5.723183e-02_rb,5.176908e-02_rb,&amp;<a name='6915'>
        &amp; 4.725658e-02_rb,4.346715e-02_rb,4.024055e-02_rb,3.746055e-02_rb,3.504080e-02_rb,&amp;<a name='6916'>
        &amp; 3.291583e-02_rb,3.103507e-02_rb,2.935891e-02_rb,2.785582e-02_rb,2.650042e-02_rb,&amp;<a name='6917'>
        &amp; 2.527206e-02_rb,2.415376e-02_rb,2.313142e-02_rb,2.219326e-02_rb,2.132934e-02_rb,&amp;<a name='6918'>
        &amp; 2.053122e-02_rb,1.979169e-02_rb,1.910456e-02_rb,1.846448e-02_rb,1.786680e-02_rb,&amp;<a name='6919'>
        &amp; 1.730745e-02_rb,1.678289e-02_rb,1.628998e-02_rb,1.582595e-02_rb,1.538835e-02_rb,&amp;<a name='6920'>
        &amp; 1.497499e-02_rb,1.458393e-02_rb,1.421341e-02_rb,1.386187e-02_rb,1.352788e-02_rb,&amp;<a name='6921'>
        &amp; 1.321019e-02_rb,1.290762e-02_rb,1.261913e-02_rb /)<a name='6922'>
      extice2(:, 26) = (/ &amp;<a name='6923'>
<font color=#447700>! band 26<a name='6924'></font>
        &amp; 3.453721e-01_rb,2.130744e-01_rb,1.536698e-01_rb,1.200140e-01_rb,9.838078e-02_rb,&amp;<a name='6925'>
        &amp; 8.331940e-02_rb,7.223803e-02_rb,6.374775e-02_rb,5.703770e-02_rb,5.160290e-02_rb,&amp;<a name='6926'>
        &amp; 4.711259e-02_rb,4.334110e-02_rb,4.012923e-02_rb,3.736150e-02_rb,3.495208e-02_rb,&amp;<a name='6927'>
        &amp; 3.283589e-02_rb,3.096267e-02_rb,2.929302e-02_rb,2.779560e-02_rb,2.644517e-02_rb,&amp;<a name='6928'>
        &amp; 2.522119e-02_rb,2.410677e-02_rb,2.308788e-02_rb,2.215281e-02_rb,2.129165e-02_rb,&amp;<a name='6929'>
        &amp; 2.049602e-02_rb,1.975874e-02_rb,1.907365e-02_rb,1.843542e-02_rb,1.783943e-02_rb,&amp;<a name='6930'>
        &amp; 1.728162e-02_rb,1.675847e-02_rb,1.626685e-02_rb,1.580401e-02_rb,1.536750e-02_rb,&amp;<a name='6931'>
        &amp; 1.495515e-02_rb,1.456502e-02_rb,1.419537e-02_rb,1.384463e-02_rb,1.351139e-02_rb,&amp;<a name='6932'>
        &amp; 1.319438e-02_rb,1.289246e-02_rb,1.260456e-02_rb /)<a name='6933'>
      extice2(:, 27) = (/ &amp;<a name='6934'>
<font color=#447700>! band 27<a name='6935'></font>
        &amp; 3.417883e-01_rb,2.113379e-01_rb,1.526395e-01_rb,1.193347e-01_rb,9.790253e-02_rb,&amp;<a name='6936'>
        &amp; 8.296715e-02_rb,7.196979e-02_rb,6.353806e-02_rb,5.687024e-02_rb,5.146670e-02_rb,&amp;<a name='6937'>
        &amp; 4.700001e-02_rb,4.324667e-02_rb,4.004894e-02_rb,3.729233e-02_rb,3.489172e-02_rb,&amp;<a name='6938'>
        &amp; 3.278257e-02_rb,3.091499e-02_rb,2.924987e-02_rb,2.775609e-02_rb,2.640859e-02_rb,&amp;<a name='6939'>
        &amp; 2.518695e-02_rb,2.407439e-02_rb,2.305697e-02_rb,2.212303e-02_rb,2.126273e-02_rb,&amp;<a name='6940'>
        &amp; 2.046774e-02_rb,1.973090e-02_rb,1.904610e-02_rb,1.840801e-02_rb,1.781204e-02_rb,&amp;<a name='6941'>
        &amp; 1.725417e-02_rb,1.673086e-02_rb,1.623902e-02_rb,1.577590e-02_rb,1.533906e-02_rb,&amp;<a name='6942'>
        &amp; 1.492634e-02_rb,1.453580e-02_rb,1.416571e-02_rb,1.381450e-02_rb,1.348078e-02_rb,&amp;<a name='6943'>
        &amp; 1.316327e-02_rb,1.286082e-02_rb,1.257240e-02_rb /)<a name='6944'>
      extice2(:, 28) = (/ &amp;<a name='6945'>
<font color=#447700>! band 28<a name='6946'></font>
        &amp; 3.416111e-01_rb,2.114124e-01_rb,1.527734e-01_rb,1.194809e-01_rb,9.804612e-02_rb,&amp;<a name='6947'>
        &amp; 8.310287e-02_rb,7.209595e-02_rb,6.365442e-02_rb,5.697710e-02_rb,5.156460e-02_rb,&amp;<a name='6948'>
        &amp; 4.708957e-02_rb,4.332850e-02_rb,4.012361e-02_rb,3.736037e-02_rb,3.495364e-02_rb,&amp;<a name='6949'>
        &amp; 3.283879e-02_rb,3.096593e-02_rb,2.929589e-02_rb,2.779751e-02_rb,2.644571e-02_rb,&amp;<a name='6950'>
        &amp; 2.522004e-02_rb,2.410369e-02_rb,2.308271e-02_rb,2.214542e-02_rb,2.128195e-02_rb,&amp;<a name='6951'>
        &amp; 2.048396e-02_rb,1.974429e-02_rb,1.905679e-02_rb,1.841614e-02_rb,1.781774e-02_rb,&amp;<a name='6952'>
        &amp; 1.725754e-02_rb,1.673203e-02_rb,1.623807e-02_rb,1.577293e-02_rb,1.533416e-02_rb,&amp;<a name='6953'>
        &amp; 1.491958e-02_rb,1.452727e-02_rb,1.415547e-02_rb,1.380262e-02_rb,1.346732e-02_rb,&amp;<a name='6954'>
        &amp; 1.314830e-02_rb,1.284439e-02_rb,1.255456e-02_rb /)<a name='6955'>
      extice2(:, 29) = (/ &amp;<a name='6956'>
<font color=#447700>! band 29<a name='6957'></font>
        &amp; 4.196611e-01_rb,2.493642e-01_rb,1.761261e-01_rb,1.357197e-01_rb,1.102161e-01_rb,&amp;<a name='6958'>
        &amp; 9.269376e-02_rb,7.992985e-02_rb,7.022538e-02_rb,6.260168e-02_rb,5.645603e-02_rb,&amp;<a name='6959'>
        &amp; 5.139732e-02_rb,4.716088e-02_rb,4.356133e-02_rb,4.046498e-02_rb,3.777303e-02_rb,&amp;<a name='6960'>
        &amp; 3.541094e-02_rb,3.332137e-02_rb,3.145954e-02_rb,2.978998e-02_rb,2.828419e-02_rb,&amp;<a name='6961'>
        &amp; 2.691905e-02_rb,2.567559e-02_rb,2.453811e-02_rb,2.349350e-02_rb,2.253072e-02_rb,&amp;<a name='6962'>
        &amp; 2.164042e-02_rb,2.081464e-02_rb,2.004652e-02_rb,1.933015e-02_rb,1.866041e-02_rb,&amp;<a name='6963'>
        &amp; 1.803283e-02_rb,1.744348e-02_rb,1.688894e-02_rb,1.636616e-02_rb,1.587244e-02_rb,&amp;<a name='6964'>
        &amp; 1.540539e-02_rb,1.496287e-02_rb,1.454295e-02_rb,1.414392e-02_rb,1.376423e-02_rb,&amp;<a name='6965'>
        &amp; 1.340247e-02_rb,1.305739e-02_rb,1.272784e-02_rb /)<a name='6966'>
<a name='6967'>
<font color=#447700>! single-scattering albedo: unitless<a name='6968'></font>
      ssaice2(:, 16) = (/ &amp;<a name='6969'>
<font color=#447700>! band 16<a name='6970'></font>
        &amp; 6.630615e-01_rb,6.451169e-01_rb,6.333696e-01_rb,6.246927e-01_rb,6.178420e-01_rb,&amp;<a name='6971'>
        &amp; 6.121976e-01_rb,6.074069e-01_rb,6.032505e-01_rb,5.995830e-01_rb,5.963030e-01_rb,&amp;<a name='6972'>
        &amp; 5.933372e-01_rb,5.906311e-01_rb,5.881427e-01_rb,5.858395e-01_rb,5.836955e-01_rb,&amp;<a name='6973'>
        &amp; 5.816896e-01_rb,5.798046e-01_rb,5.780264e-01_rb,5.763429e-01_rb,5.747441e-01_rb,&amp;<a name='6974'>
        &amp; 5.732213e-01_rb,5.717672e-01_rb,5.703754e-01_rb,5.690403e-01_rb,5.677571e-01_rb,&amp;<a name='6975'>
        &amp; 5.665215e-01_rb,5.653297e-01_rb,5.641782e-01_rb,5.630643e-01_rb,5.619850e-01_rb,&amp;<a name='6976'>
        &amp; 5.609381e-01_rb,5.599214e-01_rb,5.589328e-01_rb,5.579707e-01_rb,5.570333e-01_rb,&amp;<a name='6977'>
        &amp; 5.561193e-01_rb,5.552272e-01_rb,5.543558e-01_rb,5.535041e-01_rb,5.526708e-01_rb,&amp;<a name='6978'>
        &amp; 5.518551e-01_rb,5.510561e-01_rb,5.502729e-01_rb /)<a name='6979'>
      ssaice2(:, 17) = (/ &amp;<a name='6980'>
<font color=#447700>! band 17<a name='6981'></font>
        &amp; 7.689749e-01_rb,7.398171e-01_rb,7.205819e-01_rb,7.065690e-01_rb,6.956928e-01_rb,&amp;<a name='6982'>
        &amp; 6.868989e-01_rb,6.795813e-01_rb,6.733606e-01_rb,6.679838e-01_rb,6.632742e-01_rb,&amp;<a name='6983'>
        &amp; 6.591036e-01_rb,6.553766e-01_rb,6.520197e-01_rb,6.489757e-01_rb,6.461991e-01_rb,&amp;<a name='6984'>
        &amp; 6.436531e-01_rb,6.413075e-01_rb,6.391375e-01_rb,6.371221e-01_rb,6.352438e-01_rb,&amp;<a name='6985'>
        &amp; 6.334876e-01_rb,6.318406e-01_rb,6.302918e-01_rb,6.288315e-01_rb,6.274512e-01_rb,&amp;<a name='6986'>
        &amp; 6.261436e-01_rb,6.249022e-01_rb,6.237211e-01_rb,6.225953e-01_rb,6.215201e-01_rb,&amp;<a name='6987'>
        &amp; 6.204914e-01_rb,6.195055e-01_rb,6.185592e-01_rb,6.176492e-01_rb,6.167730e-01_rb,&amp;<a name='6988'>
        &amp; 6.159280e-01_rb,6.151120e-01_rb,6.143228e-01_rb,6.135587e-01_rb,6.128177e-01_rb,&amp;<a name='6989'>
        &amp; 6.120984e-01_rb,6.113993e-01_rb,6.107189e-01_rb /)<a name='6990'>
      ssaice2(:, 18) = (/ &amp;<a name='6991'>
<font color=#447700>! band 18<a name='6992'></font>
        &amp; 9.956167e-01_rb,9.814770e-01_rb,9.716104e-01_rb,9.639746e-01_rb,9.577179e-01_rb,&amp;<a name='6993'>
        &amp; 9.524010e-01_rb,9.477672e-01_rb,9.436527e-01_rb,9.399467e-01_rb,9.365708e-01_rb,&amp;<a name='6994'>
        &amp; 9.334672e-01_rb,9.305921e-01_rb,9.279118e-01_rb,9.253993e-01_rb,9.230330e-01_rb,&amp;<a name='6995'>
        &amp; 9.207954e-01_rb,9.186719e-01_rb,9.166501e-01_rb,9.147199e-01_rb,9.128722e-01_rb,&amp;<a name='6996'>
        &amp; 9.110997e-01_rb,9.093956e-01_rb,9.077544e-01_rb,9.061708e-01_rb,9.046406e-01_rb,&amp;<a name='6997'>
        &amp; 9.031598e-01_rb,9.017248e-01_rb,9.003326e-01_rb,8.989804e-01_rb,8.976655e-01_rb,&amp;<a name='6998'>
        &amp; 8.963857e-01_rb,8.951389e-01_rb,8.939233e-01_rb,8.927370e-01_rb,8.915785e-01_rb,&amp;<a name='6999'>
        &amp; 8.904464e-01_rb,8.893392e-01_rb,8.882559e-01_rb,8.871951e-01_rb,8.861559e-01_rb,&amp;<a name='7000'>
        &amp; 8.851373e-01_rb,8.841383e-01_rb,8.831581e-01_rb /)<a name='7001'>
      ssaice2(:, 19) = (/ &amp;<a name='7002'>
<font color=#447700>! band 19<a name='7003'></font>
        &amp; 9.723177e-01_rb,9.452119e-01_rb,9.267592e-01_rb,9.127393e-01_rb,9.014238e-01_rb,&amp;<a name='7004'>
        &amp; 8.919334e-01_rb,8.837584e-01_rb,8.765773e-01_rb,8.701736e-01_rb,8.643950e-01_rb,&amp;<a name='7005'>
        &amp; 8.591299e-01_rb,8.542942e-01_rb,8.498230e-01_rb,8.456651e-01_rb,8.417794e-01_rb,&amp;<a name='7006'>
        &amp; 8.381324e-01_rb,8.346964e-01_rb,8.314484e-01_rb,8.283687e-01_rb,8.254408e-01_rb,&amp;<a name='7007'>
        &amp; 8.226505e-01_rb,8.199854e-01_rb,8.174348e-01_rb,8.149891e-01_rb,8.126403e-01_rb,&amp;<a name='7008'>
        &amp; 8.103808e-01_rb,8.082041e-01_rb,8.061044e-01_rb,8.040765e-01_rb,8.021156e-01_rb,&amp;<a name='7009'>
        &amp; 8.002174e-01_rb,7.983781e-01_rb,7.965941e-01_rb,7.948622e-01_rb,7.931795e-01_rb,&amp;<a name='7010'>
        &amp; 7.915432e-01_rb,7.899508e-01_rb,7.884002e-01_rb,7.868891e-01_rb,7.854156e-01_rb,&amp;<a name='7011'>
        &amp; 7.839779e-01_rb,7.825742e-01_rb,7.812031e-01_rb /)<a name='7012'>
      ssaice2(:, 20) = (/ &amp;<a name='7013'>
<font color=#447700>! band 20<a name='7014'></font>
        &amp; 9.933294e-01_rb,9.860917e-01_rb,9.811564e-01_rb,9.774008e-01_rb,9.743652e-01_rb,&amp;<a name='7015'>
        &amp; 9.718155e-01_rb,9.696159e-01_rb,9.676810e-01_rb,9.659531e-01_rb,9.643915e-01_rb,&amp;<a name='7016'>
        &amp; 9.629667e-01_rb,9.616561e-01_rb,9.604426e-01_rb,9.593125e-01_rb,9.582548e-01_rb,&amp;<a name='7017'>
        &amp; 9.572607e-01_rb,9.563227e-01_rb,9.554347e-01_rb,9.545915e-01_rb,9.537888e-01_rb,&amp;<a name='7018'>
        &amp; 9.530226e-01_rb,9.522898e-01_rb,9.515874e-01_rb,9.509130e-01_rb,9.502643e-01_rb,&amp;<a name='7019'>
        &amp; 9.496394e-01_rb,9.490366e-01_rb,9.484542e-01_rb,9.478910e-01_rb,9.473456e-01_rb,&amp;<a name='7020'>
        &amp; 9.468169e-01_rb,9.463039e-01_rb,9.458056e-01_rb,9.453212e-01_rb,9.448499e-01_rb,&amp;<a name='7021'>
        &amp; 9.443910e-01_rb,9.439438e-01_rb,9.435077e-01_rb,9.430821e-01_rb,9.426666e-01_rb,&amp;<a name='7022'>
        &amp; 9.422607e-01_rb,9.418638e-01_rb,9.414756e-01_rb /)<a name='7023'>
      ssaice2(:, 21) = (/ &amp;<a name='7024'>
<font color=#447700>! band 21<a name='7025'></font>
        &amp; 9.900787e-01_rb,9.828880e-01_rb,9.779258e-01_rb,9.741173e-01_rb,9.710184e-01_rb,&amp;<a name='7026'>
        &amp; 9.684012e-01_rb,9.661332e-01_rb,9.641301e-01_rb,9.623352e-01_rb,9.607083e-01_rb,&amp;<a name='7027'>
        &amp; 9.592198e-01_rb,9.578474e-01_rb,9.565739e-01_rb,9.553856e-01_rb,9.542715e-01_rb,&amp;<a name='7028'>
        &amp; 9.532226e-01_rb,9.522314e-01_rb,9.512919e-01_rb,9.503986e-01_rb,9.495472e-01_rb,&amp;<a name='7029'>
        &amp; 9.487337e-01_rb,9.479549e-01_rb,9.472077e-01_rb,9.464897e-01_rb,9.457985e-01_rb,&amp;<a name='7030'>
        &amp; 9.451322e-01_rb,9.444890e-01_rb,9.438673e-01_rb,9.432656e-01_rb,9.426826e-01_rb,&amp;<a name='7031'>
        &amp; 9.421173e-01_rb,9.415684e-01_rb,9.410351e-01_rb,9.405164e-01_rb,9.400115e-01_rb,&amp;<a name='7032'>
        &amp; 9.395198e-01_rb,9.390404e-01_rb,9.385728e-01_rb,9.381164e-01_rb,9.376707e-01_rb,&amp;<a name='7033'>
        &amp; 9.372350e-01_rb,9.368091e-01_rb,9.363923e-01_rb /)<a name='7034'>
      ssaice2(:, 22) = (/ &amp;<a name='7035'>
<font color=#447700>! band 22<a name='7036'></font>
        &amp; 9.986793e-01_rb,9.985239e-01_rb,9.983911e-01_rb,9.982715e-01_rb,9.981606e-01_rb,&amp;<a name='7037'>
        &amp; 9.980562e-01_rb,9.979567e-01_rb,9.978613e-01_rb,9.977691e-01_rb,9.976798e-01_rb,&amp;<a name='7038'>
        &amp; 9.975929e-01_rb,9.975081e-01_rb,9.974251e-01_rb,9.973438e-01_rb,9.972640e-01_rb,&amp;<a name='7039'>
        &amp; 9.971855e-01_rb,9.971083e-01_rb,9.970322e-01_rb,9.969571e-01_rb,9.968830e-01_rb,&amp;<a name='7040'>
        &amp; 9.968099e-01_rb,9.967375e-01_rb,9.966660e-01_rb,9.965951e-01_rb,9.965250e-01_rb,&amp;<a name='7041'>
        &amp; 9.964555e-01_rb,9.963867e-01_rb,9.963185e-01_rb,9.962508e-01_rb,9.961836e-01_rb,&amp;<a name='7042'>
        &amp; 9.961170e-01_rb,9.960508e-01_rb,9.959851e-01_rb,9.959198e-01_rb,9.958550e-01_rb,&amp;<a name='7043'>
        &amp; 9.957906e-01_rb,9.957266e-01_rb,9.956629e-01_rb,9.955997e-01_rb,9.955367e-01_rb,&amp;<a name='7044'>
        &amp; 9.954742e-01_rb,9.954119e-01_rb,9.953500e-01_rb /)<a name='7045'>
      ssaice2(:, 23) = (/ &amp;<a name='7046'>
<font color=#447700>! band 23<a name='7047'></font>
        &amp; 9.997944e-01_rb,9.997791e-01_rb,9.997664e-01_rb,9.997547e-01_rb,9.997436e-01_rb,&amp;<a name='7048'>
        &amp; 9.997327e-01_rb,9.997219e-01_rb,9.997110e-01_rb,9.996999e-01_rb,9.996886e-01_rb,&amp;<a name='7049'>
        &amp; 9.996771e-01_rb,9.996653e-01_rb,9.996533e-01_rb,9.996409e-01_rb,9.996282e-01_rb,&amp;<a name='7050'>
        &amp; 9.996152e-01_rb,9.996019e-01_rb,9.995883e-01_rb,9.995743e-01_rb,9.995599e-01_rb,&amp;<a name='7051'>
        &amp; 9.995453e-01_rb,9.995302e-01_rb,9.995149e-01_rb,9.994992e-01_rb,9.994831e-01_rb,&amp;<a name='7052'>
        &amp; 9.994667e-01_rb,9.994500e-01_rb,9.994329e-01_rb,9.994154e-01_rb,9.993976e-01_rb,&amp;<a name='7053'>
        &amp; 9.993795e-01_rb,9.993610e-01_rb,9.993422e-01_rb,9.993230e-01_rb,9.993035e-01_rb,&amp;<a name='7054'>
        &amp; 9.992837e-01_rb,9.992635e-01_rb,9.992429e-01_rb,9.992221e-01_rb,9.992008e-01_rb,&amp;<a name='7055'>
        &amp; 9.991793e-01_rb,9.991574e-01_rb,9.991352e-01_rb /)<a name='7056'>
      ssaice2(:, 24) = (/ &amp;<a name='7057'>
<font color=#447700>! band 24<a name='7058'></font>
        &amp; 9.999949e-01_rb,9.999947e-01_rb,9.999943e-01_rb,9.999939e-01_rb,9.999934e-01_rb,&amp;<a name='7059'>
        &amp; 9.999927e-01_rb,9.999920e-01_rb,9.999913e-01_rb,9.999904e-01_rb,9.999895e-01_rb,&amp;<a name='7060'>
        &amp; 9.999885e-01_rb,9.999874e-01_rb,9.999863e-01_rb,9.999851e-01_rb,9.999838e-01_rb,&amp;<a name='7061'>
        &amp; 9.999824e-01_rb,9.999810e-01_rb,9.999795e-01_rb,9.999780e-01_rb,9.999764e-01_rb,&amp;<a name='7062'>
        &amp; 9.999747e-01_rb,9.999729e-01_rb,9.999711e-01_rb,9.999692e-01_rb,9.999673e-01_rb,&amp;<a name='7063'>
        &amp; 9.999653e-01_rb,9.999632e-01_rb,9.999611e-01_rb,9.999589e-01_rb,9.999566e-01_rb,&amp;<a name='7064'>
        &amp; 9.999543e-01_rb,9.999519e-01_rb,9.999495e-01_rb,9.999470e-01_rb,9.999444e-01_rb,&amp;<a name='7065'>
        &amp; 9.999418e-01_rb,9.999392e-01_rb,9.999364e-01_rb,9.999336e-01_rb,9.999308e-01_rb,&amp;<a name='7066'>
        &amp; 9.999279e-01_rb,9.999249e-01_rb,9.999219e-01_rb /)<a name='7067'>
      ssaice2(:, 25) = (/ &amp;<a name='7068'>
<font color=#447700>! band 25<a name='7069'></font>
        &amp; 9.999997e-01_rb,9.999997e-01_rb,9.999997e-01_rb,9.999996e-01_rb,9.999996e-01_rb,&amp;<a name='7070'>
        &amp; 9.999995e-01_rb,9.999994e-01_rb,9.999993e-01_rb,9.999993e-01_rb,9.999992e-01_rb,&amp;<a name='7071'>
        &amp; 9.999991e-01_rb,9.999989e-01_rb,9.999988e-01_rb,9.999987e-01_rb,9.999986e-01_rb,&amp;<a name='7072'>
        &amp; 9.999984e-01_rb,9.999983e-01_rb,9.999981e-01_rb,9.999980e-01_rb,9.999978e-01_rb,&amp;<a name='7073'>
        &amp; 9.999976e-01_rb,9.999974e-01_rb,9.999972e-01_rb,9.999971e-01_rb,9.999969e-01_rb,&amp;<a name='7074'>
        &amp; 9.999966e-01_rb,9.999964e-01_rb,9.999962e-01_rb,9.999960e-01_rb,9.999957e-01_rb,&amp;<a name='7075'>
        &amp; 9.999955e-01_rb,9.999953e-01_rb,9.999950e-01_rb,9.999947e-01_rb,9.999945e-01_rb,&amp;<a name='7076'>
        &amp; 9.999942e-01_rb,9.999939e-01_rb,9.999936e-01_rb,9.999934e-01_rb,9.999931e-01_rb,&amp;<a name='7077'>
        &amp; 9.999928e-01_rb,9.999925e-01_rb,9.999921e-01_rb /)<a name='7078'>
      ssaice2(:, 26) = (/ &amp;<a name='7079'>
<font color=#447700>! band 26<a name='7080'></font>
        &amp; 9.999997e-01_rb,9.999996e-01_rb,9.999996e-01_rb,9.999995e-01_rb,9.999994e-01_rb,&amp;<a name='7081'>
        &amp; 9.999993e-01_rb,9.999992e-01_rb,9.999991e-01_rb,9.999990e-01_rb,9.999989e-01_rb,&amp;<a name='7082'>
        &amp; 9.999987e-01_rb,9.999986e-01_rb,9.999984e-01_rb,9.999982e-01_rb,9.999980e-01_rb,&amp;<a name='7083'>
        &amp; 9.999978e-01_rb,9.999976e-01_rb,9.999974e-01_rb,9.999972e-01_rb,9.999970e-01_rb,&amp;<a name='7084'>
        &amp; 9.999967e-01_rb,9.999965e-01_rb,9.999962e-01_rb,9.999959e-01_rb,9.999956e-01_rb,&amp;<a name='7085'>
        &amp; 9.999954e-01_rb,9.999951e-01_rb,9.999947e-01_rb,9.999944e-01_rb,9.999941e-01_rb,&amp;<a name='7086'>
        &amp; 9.999938e-01_rb,9.999934e-01_rb,9.999931e-01_rb,9.999927e-01_rb,9.999923e-01_rb,&amp;<a name='7087'>
        &amp; 9.999920e-01_rb,9.999916e-01_rb,9.999912e-01_rb,9.999908e-01_rb,9.999904e-01_rb,&amp;<a name='7088'>
        &amp; 9.999899e-01_rb,9.999895e-01_rb,9.999891e-01_rb /)<a name='7089'>
      ssaice2(:, 27) = (/ &amp;<a name='7090'>
<font color=#447700>! band 27<a name='7091'></font>
        &amp; 9.999987e-01_rb,9.999987e-01_rb,9.999985e-01_rb,9.999984e-01_rb,9.999982e-01_rb,&amp;<a name='7092'>
        &amp; 9.999980e-01_rb,9.999978e-01_rb,9.999976e-01_rb,9.999973e-01_rb,9.999970e-01_rb,&amp;<a name='7093'>
        &amp; 9.999967e-01_rb,9.999964e-01_rb,9.999960e-01_rb,9.999956e-01_rb,9.999952e-01_rb,&amp;<a name='7094'>
        &amp; 9.999948e-01_rb,9.999944e-01_rb,9.999939e-01_rb,9.999934e-01_rb,9.999929e-01_rb,&amp;<a name='7095'>
        &amp; 9.999924e-01_rb,9.999918e-01_rb,9.999913e-01_rb,9.999907e-01_rb,9.999901e-01_rb,&amp;<a name='7096'>
        &amp; 9.999894e-01_rb,9.999888e-01_rb,9.999881e-01_rb,9.999874e-01_rb,9.999867e-01_rb,&amp;<a name='7097'>
        &amp; 9.999860e-01_rb,9.999853e-01_rb,9.999845e-01_rb,9.999837e-01_rb,9.999829e-01_rb,&amp;<a name='7098'>
        &amp; 9.999821e-01_rb,9.999813e-01_rb,9.999804e-01_rb,9.999796e-01_rb,9.999787e-01_rb,&amp;<a name='7099'>
        &amp; 9.999778e-01_rb,9.999768e-01_rb,9.999759e-01_rb /)<a name='7100'>
      ssaice2(:, 28) = (/ &amp;<a name='7101'>
<font color=#447700>! band 28<a name='7102'></font>
        &amp; 9.999989e-01_rb,9.999989e-01_rb,9.999987e-01_rb,9.999986e-01_rb,9.999984e-01_rb,&amp;<a name='7103'>
        &amp; 9.999982e-01_rb,9.999980e-01_rb,9.999978e-01_rb,9.999975e-01_rb,9.999972e-01_rb,&amp;<a name='7104'>
        &amp; 9.999969e-01_rb,9.999966e-01_rb,9.999962e-01_rb,9.999958e-01_rb,9.999954e-01_rb,&amp;<a name='7105'>
        &amp; 9.999950e-01_rb,9.999945e-01_rb,9.999941e-01_rb,9.999936e-01_rb,9.999931e-01_rb,&amp;<a name='7106'>
        &amp; 9.999925e-01_rb,9.999920e-01_rb,9.999914e-01_rb,9.999908e-01_rb,9.999902e-01_rb,&amp;<a name='7107'>
        &amp; 9.999896e-01_rb,9.999889e-01_rb,9.999883e-01_rb,9.999876e-01_rb,9.999869e-01_rb,&amp;<a name='7108'>
        &amp; 9.999861e-01_rb,9.999854e-01_rb,9.999846e-01_rb,9.999838e-01_rb,9.999830e-01_rb,&amp;<a name='7109'>
        &amp; 9.999822e-01_rb,9.999814e-01_rb,9.999805e-01_rb,9.999796e-01_rb,9.999787e-01_rb,&amp;<a name='7110'>
        &amp; 9.999778e-01_rb,9.999769e-01_rb,9.999759e-01_rb /)<a name='7111'>
      ssaice2(:, 29) = (/ &amp;<a name='7112'>
<font color=#447700>! band 29<a name='7113'></font>
        &amp; 7.042143e-01_rb,6.691161e-01_rb,6.463240e-01_rb,6.296590e-01_rb,6.166381e-01_rb,&amp;<a name='7114'>
        &amp; 6.060183e-01_rb,5.970908e-01_rb,5.894144e-01_rb,5.826968e-01_rb,5.767343e-01_rb,&amp;<a name='7115'>
        &amp; 5.713804e-01_rb,5.665256e-01_rb,5.620867e-01_rb,5.579987e-01_rb,5.542101e-01_rb,&amp;<a name='7116'>
        &amp; 5.506794e-01_rb,5.473727e-01_rb,5.442620e-01_rb,5.413239e-01_rb,5.385389e-01_rb,&amp;<a name='7117'>
        &amp; 5.358901e-01_rb,5.333633e-01_rb,5.309460e-01_rb,5.286277e-01_rb,5.263988e-01_rb,&amp;<a name='7118'>
        &amp; 5.242512e-01_rb,5.221777e-01_rb,5.201719e-01_rb,5.182280e-01_rb,5.163410e-01_rb,&amp;<a name='7119'>
        &amp; 5.145062e-01_rb,5.127197e-01_rb,5.109776e-01_rb,5.092766e-01_rb,5.076137e-01_rb,&amp;<a name='7120'>
        &amp; 5.059860e-01_rb,5.043911e-01_rb,5.028266e-01_rb,5.012904e-01_rb,4.997805e-01_rb,&amp;<a name='7121'>
        &amp; 4.982951e-01_rb,4.968326e-01_rb,4.953913e-01_rb /)<a name='7122'>
<a name='7123'>
<font color=#447700>! asymmetry factor: unitless<a name='7124'></font>
      asyice2(:, 16) = (/ &amp;<a name='7125'>
<font color=#447700>! band 16<a name='7126'></font>
        &amp; 7.946655e-01_rb,8.547685e-01_rb,8.806016e-01_rb,8.949880e-01_rb,9.041676e-01_rb,&amp;<a name='7127'>
        &amp; 9.105399e-01_rb,9.152249e-01_rb,9.188160e-01_rb,9.216573e-01_rb,9.239620e-01_rb,&amp;<a name='7128'>
        &amp; 9.258695e-01_rb,9.274745e-01_rb,9.288441e-01_rb,9.300267e-01_rb,9.310584e-01_rb,&amp;<a name='7129'>
        &amp; 9.319665e-01_rb,9.327721e-01_rb,9.334918e-01_rb,9.341387e-01_rb,9.347236e-01_rb,&amp;<a name='7130'>
        &amp; 9.352551e-01_rb,9.357402e-01_rb,9.361850e-01_rb,9.365942e-01_rb,9.369722e-01_rb,&amp;<a name='7131'>
        &amp; 9.373225e-01_rb,9.376481e-01_rb,9.379516e-01_rb,9.382352e-01_rb,9.385010e-01_rb,&amp;<a name='7132'>
        &amp; 9.387505e-01_rb,9.389854e-01_rb,9.392070e-01_rb,9.394163e-01_rb,9.396145e-01_rb,&amp;<a name='7133'>
        &amp; 9.398024e-01_rb,9.399809e-01_rb,9.401508e-01_rb,9.403126e-01_rb,9.404670e-01_rb,&amp;<a name='7134'>
        &amp; 9.406144e-01_rb,9.407555e-01_rb,9.408906e-01_rb /)<a name='7135'>
      asyice2(:, 17) = (/ &amp;<a name='7136'>
<font color=#447700>! band 17<a name='7137'></font>
        &amp; 9.078091e-01_rb,9.195850e-01_rb,9.267250e-01_rb,9.317083e-01_rb,9.354632e-01_rb,&amp;<a name='7138'>
        &amp; 9.384323e-01_rb,9.408597e-01_rb,9.428935e-01_rb,9.446301e-01_rb,9.461351e-01_rb,&amp;<a name='7139'>
        &amp; 9.474555e-01_rb,9.486259e-01_rb,9.496722e-01_rb,9.506146e-01_rb,9.514688e-01_rb,&amp;<a name='7140'>
        &amp; 9.522476e-01_rb,9.529612e-01_rb,9.536181e-01_rb,9.542251e-01_rb,9.547883e-01_rb,&amp;<a name='7141'>
        &amp; 9.553124e-01_rb,9.558019e-01_rb,9.562601e-01_rb,9.566904e-01_rb,9.570953e-01_rb,&amp;<a name='7142'>
        &amp; 9.574773e-01_rb,9.578385e-01_rb,9.581806e-01_rb,9.585054e-01_rb,9.588142e-01_rb,&amp;<a name='7143'>
        &amp; 9.591083e-01_rb,9.593888e-01_rb,9.596569e-01_rb,9.599135e-01_rb,9.601593e-01_rb,&amp;<a name='7144'>
        &amp; 9.603952e-01_rb,9.606219e-01_rb,9.608399e-01_rb,9.610499e-01_rb,9.612523e-01_rb,&amp;<a name='7145'>
        &amp; 9.614477e-01_rb,9.616365e-01_rb,9.618192e-01_rb /)<a name='7146'>
      asyice2(:, 18) = (/ &amp;<a name='7147'>
<font color=#447700>! band 18<a name='7148'></font>
        &amp; 8.322045e-01_rb,8.528693e-01_rb,8.648167e-01_rb,8.729163e-01_rb,8.789054e-01_rb,&amp;<a name='7149'>
        &amp; 8.835845e-01_rb,8.873819e-01_rb,8.905511e-01_rb,8.932532e-01_rb,8.955965e-01_rb,&amp;<a name='7150'>
        &amp; 8.976567e-01_rb,8.994887e-01_rb,9.011334e-01_rb,9.026221e-01_rb,9.039791e-01_rb,&amp;<a name='7151'>
        &amp; 9.052237e-01_rb,9.063715e-01_rb,9.074349e-01_rb,9.084245e-01_rb,9.093489e-01_rb,&amp;<a name='7152'>
        &amp; 9.102154e-01_rb,9.110303e-01_rb,9.117987e-01_rb,9.125253e-01_rb,9.132140e-01_rb,&amp;<a name='7153'>
        &amp; 9.138682e-01_rb,9.144910e-01_rb,9.150850e-01_rb,9.156524e-01_rb,9.161955e-01_rb,&amp;<a name='7154'>
        &amp; 9.167160e-01_rb,9.172157e-01_rb,9.176959e-01_rb,9.181581e-01_rb,9.186034e-01_rb,&amp;<a name='7155'>
        &amp; 9.190330e-01_rb,9.194478e-01_rb,9.198488e-01_rb,9.202368e-01_rb,9.206126e-01_rb,&amp;<a name='7156'>
        &amp; 9.209768e-01_rb,9.213301e-01_rb,9.216731e-01_rb /)<a name='7157'>
      asyice2(:, 19) = (/ &amp;<a name='7158'>
<font color=#447700>! band 19<a name='7159'></font>
        &amp; 8.116560e-01_rb,8.488278e-01_rb,8.674331e-01_rb,8.788148e-01_rb,8.865810e-01_rb,&amp;<a name='7160'>
        &amp; 8.922595e-01_rb,8.966149e-01_rb,9.000747e-01_rb,9.028980e-01_rb,9.052513e-01_rb,&amp;<a name='7161'>
        &amp; 9.072468e-01_rb,9.089632e-01_rb,9.104574e-01_rb,9.117713e-01_rb,9.129371e-01_rb,&amp;<a name='7162'>
        &amp; 9.139793e-01_rb,9.149174e-01_rb,9.157668e-01_rb,9.165400e-01_rb,9.172473e-01_rb,&amp;<a name='7163'>
        &amp; 9.178970e-01_rb,9.184962e-01_rb,9.190508e-01_rb,9.195658e-01_rb,9.200455e-01_rb,&amp;<a name='7164'>
        &amp; 9.204935e-01_rb,9.209130e-01_rb,9.213067e-01_rb,9.216771e-01_rb,9.220262e-01_rb,&amp;<a name='7165'>
        &amp; 9.223560e-01_rb,9.226680e-01_rb,9.229636e-01_rb,9.232443e-01_rb,9.235112e-01_rb,&amp;<a name='7166'>
        &amp; 9.237652e-01_rb,9.240074e-01_rb,9.242385e-01_rb,9.244594e-01_rb,9.246708e-01_rb,&amp;<a name='7167'>
        &amp; 9.248733e-01_rb,9.250674e-01_rb,9.252536e-01_rb /)<a name='7168'>
      asyice2(:, 20) = (/ &amp;<a name='7169'>
<font color=#447700>! band 20<a name='7170'></font>
        &amp; 8.047113e-01_rb,8.402864e-01_rb,8.570332e-01_rb,8.668455e-01_rb,8.733206e-01_rb,&amp;<a name='7171'>
        &amp; 8.779272e-01_rb,8.813796e-01_rb,8.840676e-01_rb,8.862225e-01_rb,8.879904e-01_rb,&amp;<a name='7172'>
        &amp; 8.894682e-01_rb,8.907228e-01_rb,8.918019e-01_rb,8.927404e-01_rb,8.935645e-01_rb,&amp;<a name='7173'>
        &amp; 8.942943e-01_rb,8.949452e-01_rb,8.955296e-01_rb,8.960574e-01_rb,8.965366e-01_rb,&amp;<a name='7174'>
        &amp; 8.969736e-01_rb,8.973740e-01_rb,8.977422e-01_rb,8.980820e-01_rb,8.983966e-01_rb,&amp;<a name='7175'>
        &amp; 8.986889e-01_rb,8.989611e-01_rb,8.992153e-01_rb,8.994533e-01_rb,8.996766e-01_rb,&amp;<a name='7176'>
        &amp; 8.998865e-01_rb,9.000843e-01_rb,9.002709e-01_rb,9.004474e-01_rb,9.006146e-01_rb,&amp;<a name='7177'>
        &amp; 9.007731e-01_rb,9.009237e-01_rb,9.010670e-01_rb,9.012034e-01_rb,9.013336e-01_rb,&amp;<a name='7178'>
        &amp; 9.014579e-01_rb,9.015767e-01_rb,9.016904e-01_rb /)<a name='7179'>
      asyice2(:, 21) = (/ &amp;<a name='7180'>
<font color=#447700>! band 21<a name='7181'></font>
        &amp; 8.179122e-01_rb,8.480726e-01_rb,8.621945e-01_rb,8.704354e-01_rb,8.758555e-01_rb,&amp;<a name='7182'>
        &amp; 8.797007e-01_rb,8.825750e-01_rb,8.848078e-01_rb,8.865939e-01_rb,8.880564e-01_rb,&amp;<a name='7183'>
        &amp; 8.892765e-01_rb,8.903105e-01_rb,8.911982e-01_rb,8.919689e-01_rb,8.926446e-01_rb,&amp;<a name='7184'>
        &amp; 8.932419e-01_rb,8.937738e-01_rb,8.942506e-01_rb,8.946806e-01_rb,8.950702e-01_rb,&amp;<a name='7185'>
        &amp; 8.954251e-01_rb,8.957497e-01_rb,8.960477e-01_rb,8.963223e-01_rb,8.965762e-01_rb,&amp;<a name='7186'>
        &amp; 8.968116e-01_rb,8.970306e-01_rb,8.972347e-01_rb,8.974255e-01_rb,8.976042e-01_rb,&amp;<a name='7187'>
        &amp; 8.977720e-01_rb,8.979298e-01_rb,8.980784e-01_rb,8.982188e-01_rb,8.983515e-01_rb,&amp;<a name='7188'>
        &amp; 8.984771e-01_rb,8.985963e-01_rb,8.987095e-01_rb,8.988171e-01_rb,8.989195e-01_rb,&amp;<a name='7189'>
        &amp; 8.990172e-01_rb,8.991104e-01_rb,8.991994e-01_rb /)<a name='7190'>
      asyice2(:, 22) = (/ &amp;<a name='7191'>
<font color=#447700>! band 22<a name='7192'></font>
        &amp; 8.169789e-01_rb,8.455024e-01_rb,8.586925e-01_rb,8.663283e-01_rb,8.713217e-01_rb,&amp;<a name='7193'>
        &amp; 8.748488e-01_rb,8.774765e-01_rb,8.795122e-01_rb,8.811370e-01_rb,8.824649e-01_rb,&amp;<a name='7194'>
        &amp; 8.835711e-01_rb,8.845073e-01_rb,8.853103e-01_rb,8.860068e-01_rb,8.866170e-01_rb,&amp;<a name='7195'>
        &amp; 8.871560e-01_rb,8.876358e-01_rb,8.880658e-01_rb,8.884533e-01_rb,8.888044e-01_rb,&amp;<a name='7196'>
        &amp; 8.891242e-01_rb,8.894166e-01_rb,8.896851e-01_rb,8.899324e-01_rb,8.901612e-01_rb,&amp;<a name='7197'>
        &amp; 8.903733e-01_rb,8.905706e-01_rb,8.907545e-01_rb,8.909265e-01_rb,8.910876e-01_rb,&amp;<a name='7198'>
        &amp; 8.912388e-01_rb,8.913812e-01_rb,8.915153e-01_rb,8.916419e-01_rb,8.917617e-01_rb,&amp;<a name='7199'>
        &amp; 8.918752e-01_rb,8.919829e-01_rb,8.920851e-01_rb,8.921824e-01_rb,8.922751e-01_rb,&amp;<a name='7200'>
        &amp; 8.923635e-01_rb,8.924478e-01_rb,8.925284e-01_rb /)<a name='7201'>
      asyice2(:, 23) = (/ &amp;<a name='7202'>
<font color=#447700>! band 23<a name='7203'></font>
        &amp; 8.387642e-01_rb,8.569979e-01_rb,8.658630e-01_rb,8.711825e-01_rb,8.747605e-01_rb,&amp;<a name='7204'>
        &amp; 8.773472e-01_rb,8.793129e-01_rb,8.808621e-01_rb,8.821179e-01_rb,8.831583e-01_rb,&amp;<a name='7205'>
        &amp; 8.840361e-01_rb,8.847875e-01_rb,8.854388e-01_rb,8.860094e-01_rb,8.865138e-01_rb,&amp;<a name='7206'>
        &amp; 8.869634e-01_rb,8.873668e-01_rb,8.877310e-01_rb,8.880617e-01_rb,8.883635e-01_rb,&amp;<a name='7207'>
        &amp; 8.886401e-01_rb,8.888947e-01_rb,8.891298e-01_rb,8.893477e-01_rb,8.895504e-01_rb,&amp;<a name='7208'>
        &amp; 8.897393e-01_rb,8.899159e-01_rb,8.900815e-01_rb,8.902370e-01_rb,8.903833e-01_rb,&amp;<a name='7209'>
        &amp; 8.905214e-01_rb,8.906518e-01_rb,8.907753e-01_rb,8.908924e-01_rb,8.910036e-01_rb,&amp;<a name='7210'>
        &amp; 8.911094e-01_rb,8.912101e-01_rb,8.913062e-01_rb,8.913979e-01_rb,8.914856e-01_rb,&amp;<a name='7211'>
        &amp; 8.915695e-01_rb,8.916498e-01_rb,8.917269e-01_rb /)<a name='7212'>
      asyice2(:, 24) = (/ &amp;<a name='7213'>
<font color=#447700>! band 24<a name='7214'></font>
        &amp; 8.522208e-01_rb,8.648132e-01_rb,8.711224e-01_rb,8.749901e-01_rb,8.776354e-01_rb,&amp;<a name='7215'>
        &amp; 8.795743e-01_rb,8.810649e-01_rb,8.822518e-01_rb,8.832225e-01_rb,8.840333e-01_rb,&amp;<a name='7216'>
        &amp; 8.847224e-01_rb,8.853162e-01_rb,8.858342e-01_rb,8.862906e-01_rb,8.866962e-01_rb,&amp;<a name='7217'>
        &amp; 8.870595e-01_rb,8.873871e-01_rb,8.876842e-01_rb,8.879551e-01_rb,8.882032e-01_rb,&amp;<a name='7218'>
        &amp; 8.884316e-01_rb,8.886425e-01_rb,8.888380e-01_rb,8.890199e-01_rb,8.891895e-01_rb,&amp;<a name='7219'>
        &amp; 8.893481e-01_rb,8.894968e-01_rb,8.896366e-01_rb,8.897683e-01_rb,8.898926e-01_rb,&amp;<a name='7220'>
        &amp; 8.900102e-01_rb,8.901215e-01_rb,8.902272e-01_rb,8.903276e-01_rb,8.904232e-01_rb,&amp;<a name='7221'>
        &amp; 8.905144e-01_rb,8.906014e-01_rb,8.906845e-01_rb,8.907640e-01_rb,8.908402e-01_rb,&amp;<a name='7222'>
        &amp; 8.909132e-01_rb,8.909834e-01_rb,8.910507e-01_rb /)<a name='7223'>
      asyice2(:, 25) = (/ &amp;<a name='7224'>
<font color=#447700>! band 25<a name='7225'></font>
        &amp; 8.578202e-01_rb,8.683033e-01_rb,8.735431e-01_rb,8.767488e-01_rb,8.789378e-01_rb,&amp;<a name='7226'>
        &amp; 8.805399e-01_rb,8.817701e-01_rb,8.827485e-01_rb,8.835480e-01_rb,8.842152e-01_rb,&amp;<a name='7227'>
        &amp; 8.847817e-01_rb,8.852696e-01_rb,8.856949e-01_rb,8.860694e-01_rb,8.864020e-01_rb,&amp;<a name='7228'>
        &amp; 8.866997e-01_rb,8.869681e-01_rb,8.872113e-01_rb,8.874330e-01_rb,8.876360e-01_rb,&amp;<a name='7229'>
        &amp; 8.878227e-01_rb,8.879951e-01_rb,8.881548e-01_rb,8.883033e-01_rb,8.884418e-01_rb,&amp;<a name='7230'>
        &amp; 8.885712e-01_rb,8.886926e-01_rb,8.888066e-01_rb,8.889139e-01_rb,8.890152e-01_rb,&amp;<a name='7231'>
        &amp; 8.891110e-01_rb,8.892017e-01_rb,8.892877e-01_rb,8.893695e-01_rb,8.894473e-01_rb,&amp;<a name='7232'>
        &amp; 8.895214e-01_rb,8.895921e-01_rb,8.896597e-01_rb,8.897243e-01_rb,8.897862e-01_rb,&amp;<a name='7233'>
        &amp; 8.898456e-01_rb,8.899025e-01_rb,8.899572e-01_rb /)<a name='7234'>
      asyice2(:, 26) = (/ &amp;<a name='7235'>
<font color=#447700>! band 26<a name='7236'></font>
        &amp; 8.625615e-01_rb,8.713831e-01_rb,8.755799e-01_rb,8.780560e-01_rb,8.796983e-01_rb,&amp;<a name='7237'>
        &amp; 8.808714e-01_rb,8.817534e-01_rb,8.824420e-01_rb,8.829953e-01_rb,8.834501e-01_rb,&amp;<a name='7238'>
        &amp; 8.838310e-01_rb,8.841549e-01_rb,8.844338e-01_rb,8.846767e-01_rb,8.848902e-01_rb,&amp;<a name='7239'>
        &amp; 8.850795e-01_rb,8.852484e-01_rb,8.854002e-01_rb,8.855374e-01_rb,8.856620e-01_rb,&amp;<a name='7240'>
        &amp; 8.857758e-01_rb,8.858800e-01_rb,8.859759e-01_rb,8.860644e-01_rb,8.861464e-01_rb,&amp;<a name='7241'>
        &amp; 8.862225e-01_rb,8.862935e-01_rb,8.863598e-01_rb,8.864218e-01_rb,8.864800e-01_rb,&amp;<a name='7242'>
        &amp; 8.865347e-01_rb,8.865863e-01_rb,8.866349e-01_rb,8.866809e-01_rb,8.867245e-01_rb,&amp;<a name='7243'>
        &amp; 8.867658e-01_rb,8.868050e-01_rb,8.868423e-01_rb,8.868778e-01_rb,8.869117e-01_rb,&amp;<a name='7244'>
        &amp; 8.869440e-01_rb,8.869749e-01_rb,8.870044e-01_rb /)<a name='7245'>
      asyice2(:, 27) = (/ &amp;<a name='7246'>
<font color=#447700>! band 27<a name='7247'></font>
        &amp; 8.587495e-01_rb,8.684764e-01_rb,8.728189e-01_rb,8.752872e-01_rb,8.768846e-01_rb,&amp;<a name='7248'>
        &amp; 8.780060e-01_rb,8.788386e-01_rb,8.794824e-01_rb,8.799960e-01_rb,8.804159e-01_rb,&amp;<a name='7249'>
        &amp; 8.807660e-01_rb,8.810626e-01_rb,8.813175e-01_rb,8.815390e-01_rb,8.817335e-01_rb,&amp;<a name='7250'>
        &amp; 8.819057e-01_rb,8.820593e-01_rb,8.821973e-01_rb,8.823220e-01_rb,8.824353e-01_rb,&amp;<a name='7251'>
        &amp; 8.825387e-01_rb,8.826336e-01_rb,8.827209e-01_rb,8.828016e-01_rb,8.828764e-01_rb,&amp;<a name='7252'>
        &amp; 8.829459e-01_rb,8.830108e-01_rb,8.830715e-01_rb,8.831283e-01_rb,8.831817e-01_rb,&amp;<a name='7253'>
        &amp; 8.832320e-01_rb,8.832795e-01_rb,8.833244e-01_rb,8.833668e-01_rb,8.834071e-01_rb,&amp;<a name='7254'>
        &amp; 8.834454e-01_rb,8.834817e-01_rb,8.835164e-01_rb,8.835495e-01_rb,8.835811e-01_rb,&amp;<a name='7255'>
        &amp; 8.836113e-01_rb,8.836402e-01_rb,8.836679e-01_rb /)<a name='7256'>
      asyice2(:, 28) = (/ &amp;<a name='7257'>
<font color=#447700>! band 28<a name='7258'></font>
        &amp; 8.561110e-01_rb,8.678583e-01_rb,8.727554e-01_rb,8.753892e-01_rb,8.770154e-01_rb,&amp;<a name='7259'>
        &amp; 8.781109e-01_rb,8.788949e-01_rb,8.794812e-01_rb,8.799348e-01_rb,8.802952e-01_rb,&amp;<a name='7260'>
        &amp; 8.805880e-01_rb,8.808300e-01_rb,8.810331e-01_rb,8.812058e-01_rb,8.813543e-01_rb,&amp;<a name='7261'>
        &amp; 8.814832e-01_rb,8.815960e-01_rb,8.816956e-01_rb,8.817839e-01_rb,8.818629e-01_rb,&amp;<a name='7262'>
        &amp; 8.819339e-01_rb,8.819979e-01_rb,8.820560e-01_rb,8.821089e-01_rb,8.821573e-01_rb,&amp;<a name='7263'>
        &amp; 8.822016e-01_rb,8.822425e-01_rb,8.822801e-01_rb,8.823150e-01_rb,8.823474e-01_rb,&amp;<a name='7264'>
        &amp; 8.823775e-01_rb,8.824056e-01_rb,8.824318e-01_rb,8.824564e-01_rb,8.824795e-01_rb,&amp;<a name='7265'>
        &amp; 8.825011e-01_rb,8.825215e-01_rb,8.825408e-01_rb,8.825589e-01_rb,8.825761e-01_rb,&amp;<a name='7266'>
        &amp; 8.825924e-01_rb,8.826078e-01_rb,8.826224e-01_rb /)<a name='7267'>
      asyice2(:, 29) = (/ &amp;<a name='7268'>
<font color=#447700>! band 29<a name='7269'></font>
        &amp; 8.311124e-01_rb,8.688197e-01_rb,8.900274e-01_rb,9.040696e-01_rb,9.142334e-01_rb,&amp;<a name='7270'>
        &amp; 9.220181e-01_rb,9.282195e-01_rb,9.333048e-01_rb,9.375689e-01_rb,9.412085e-01_rb,&amp;<a name='7271'>
        &amp; 9.443604e-01_rb,9.471230e-01_rb,9.495694e-01_rb,9.517549e-01_rb,9.537224e-01_rb,&amp;<a name='7272'>
        &amp; 9.555057e-01_rb,9.571316e-01_rb,9.586222e-01_rb,9.599952e-01_rb,9.612656e-01_rb,&amp;<a name='7273'>
        &amp; 9.624458e-01_rb,9.635461e-01_rb,9.645756e-01_rb,9.655418e-01_rb,9.664513e-01_rb,&amp;<a name='7274'>
        &amp; 9.673098e-01_rb,9.681222e-01_rb,9.688928e-01_rb,9.696256e-01_rb,9.703237e-01_rb,&amp;<a name='7275'>
        &amp; 9.709903e-01_rb,9.716280e-01_rb,9.722391e-01_rb,9.728258e-01_rb,9.733901e-01_rb,&amp;<a name='7276'>
        &amp; 9.739336e-01_rb,9.744579e-01_rb,9.749645e-01_rb,9.754546e-01_rb,9.759294e-01_rb,&amp;<a name='7277'>
        &amp; 9.763901e-01_rb,9.768376e-01_rb,9.772727e-01_rb /)<a name='7278'>
<a name='7279'>
<font color=#447700>! Hexagonal Ice Particle Parameterization<a name='7280'></font>
<font color=#447700>! extinction units (ext coef/iwc): [(m^-1)/(g m^-3)]<a name='7281'></font>
      extice3(:, 16) = (/ &amp;<a name='7282'>
<font color=#447700>! band 16<a name='7283'></font>
        &amp; 5.194013e-01_rb,3.215089e-01_rb,2.327917e-01_rb,1.824424e-01_rb,1.499977e-01_rb,&amp;<a name='7284'>
        &amp; 1.273492e-01_rb,1.106421e-01_rb,9.780982e-02_rb,8.764435e-02_rb,7.939266e-02_rb,&amp;<a name='7285'>
        &amp; 7.256081e-02_rb,6.681137e-02_rb,6.190600e-02_rb,5.767154e-02_rb,5.397915e-02_rb,&amp;<a name='7286'>
        &amp; 5.073102e-02_rb,4.785151e-02_rb,4.528125e-02_rb,4.297296e-02_rb,4.088853e-02_rb,&amp;<a name='7287'>
        &amp; 3.899690e-02_rb,3.727251e-02_rb,3.569411e-02_rb,3.424393e-02_rb,3.290694e-02_rb,&amp;<a name='7288'>
        &amp; 3.167040e-02_rb,3.052340e-02_rb,2.945654e-02_rb,2.846172e-02_rb,2.753188e-02_rb,&amp;<a name='7289'>
        &amp; 2.666085e-02_rb,2.584322e-02_rb,2.507423e-02_rb,2.434967e-02_rb,2.366579e-02_rb,&amp;<a name='7290'>
        &amp; 2.301926e-02_rb,2.240711e-02_rb,2.182666e-02_rb,2.127551e-02_rb,2.075150e-02_rb,&amp;<a name='7291'>
        &amp; 2.025267e-02_rb,1.977725e-02_rb,1.932364e-02_rb,1.889035e-02_rb,1.847607e-02_rb,&amp;<a name='7292'>
        &amp; 1.807956e-02_rb /)<a name='7293'>
      extice3(:, 17) = (/ &amp;<a name='7294'>
<font color=#447700>! band 17<a name='7295'></font>
        &amp; 4.901155e-01_rb,3.065286e-01_rb,2.230800e-01_rb,1.753951e-01_rb,1.445402e-01_rb,&amp;<a name='7296'>
        &amp; 1.229417e-01_rb,1.069777e-01_rb,9.469760e-02_rb,8.495824e-02_rb,7.704501e-02_rb,&amp;<a name='7297'>
        &amp; 7.048834e-02_rb,6.496693e-02_rb,6.025353e-02_rb,5.618286e-02_rb,5.263186e-02_rb,&amp;<a name='7298'>
        &amp; 4.950698e-02_rb,4.673585e-02_rb,4.426164e-02_rb,4.203904e-02_rb,4.003153e-02_rb,&amp;<a name='7299'>
        &amp; 3.820932e-02_rb,3.654790e-02_rb,3.502688e-02_rb,3.362919e-02_rb,3.234041e-02_rb,&amp;<a name='7300'>
        &amp; 3.114829e-02_rb,3.004234e-02_rb,2.901356e-02_rb,2.805413e-02_rb,2.715727e-02_rb,&amp;<a name='7301'>
        &amp; 2.631705e-02_rb,2.552828e-02_rb,2.478637e-02_rb,2.408725e-02_rb,2.342734e-02_rb,&amp;<a name='7302'>
        &amp; 2.280343e-02_rb,2.221264e-02_rb,2.165242e-02_rb,2.112043e-02_rb,2.061461e-02_rb,&amp;<a name='7303'>
        &amp; 2.013308e-02_rb,1.967411e-02_rb,1.923616e-02_rb,1.881783e-02_rb,1.841781e-02_rb,&amp;<a name='7304'>
        &amp; 1.803494e-02_rb /)<a name='7305'>
      extice3(:, 18) = (/ &amp;<a name='7306'>
<font color=#447700>! band 18<a name='7307'></font>
        &amp; 5.056264e-01_rb,3.160261e-01_rb,2.298442e-01_rb,1.805973e-01_rb,1.487318e-01_rb,&amp;<a name='7308'>
        &amp; 1.264258e-01_rb,1.099389e-01_rb,9.725656e-02_rb,8.719819e-02_rb,7.902576e-02_rb,&amp;<a name='7309'>
        &amp; 7.225433e-02_rb,6.655206e-02_rb,6.168427e-02_rb,5.748028e-02_rb,5.381296e-02_rb,&amp;<a name='7310'>
        &amp; 5.058572e-02_rb,4.772383e-02_rb,4.516857e-02_rb,4.287317e-02_rb,4.079990e-02_rb,&amp;<a name='7311'>
        &amp; 3.891801e-02_rb,3.720217e-02_rb,3.563133e-02_rb,3.418786e-02_rb,3.285686e-02_rb,&amp;<a name='7312'>
        &amp; 3.162569e-02_rb,3.048352e-02_rb,2.942104e-02_rb,2.843018e-02_rb,2.750395e-02_rb,&amp;<a name='7313'>
        &amp; 2.663621e-02_rb,2.582160e-02_rb,2.505539e-02_rb,2.433337e-02_rb,2.365185e-02_rb,&amp;<a name='7314'>
        &amp; 2.300750e-02_rb,2.239736e-02_rb,2.181878e-02_rb,2.126937e-02_rb,2.074699e-02_rb,&amp;<a name='7315'>
        &amp; 2.024968e-02_rb,1.977567e-02_rb,1.932338e-02_rb,1.889134e-02_rb,1.847823e-02_rb,&amp;<a name='7316'>
        &amp; 1.808281e-02_rb /)<a name='7317'>
      extice3(:, 19) = (/ &amp;<a name='7318'>
<font color=#447700>! band 19<a name='7319'></font>
        &amp; 4.881605e-01_rb,3.055237e-01_rb,2.225070e-01_rb,1.750688e-01_rb,1.443736e-01_rb,&amp;<a name='7320'>
        &amp; 1.228869e-01_rb,1.070054e-01_rb,9.478893e-02_rb,8.509997e-02_rb,7.722769e-02_rb,&amp;<a name='7321'>
        &amp; 7.070495e-02_rb,6.521211e-02_rb,6.052311e-02_rb,5.647351e-02_rb,5.294088e-02_rb,&amp;<a name='7322'>
        &amp; 4.983217e-02_rb,4.707539e-02_rb,4.461398e-02_rb,4.240288e-02_rb,4.040575e-02_rb,&amp;<a name='7323'>
        &amp; 3.859298e-02_rb,3.694016e-02_rb,3.542701e-02_rb,3.403655e-02_rb,3.275444e-02_rb,&amp;<a name='7324'>
        &amp; 3.156849e-02_rb,3.046827e-02_rb,2.944481e-02_rb,2.849034e-02_rb,2.759812e-02_rb,&amp;<a name='7325'>
        &amp; 2.676226e-02_rb,2.597757e-02_rb,2.523949e-02_rb,2.454400e-02_rb,2.388750e-02_rb,&amp;<a name='7326'>
        &amp; 2.326682e-02_rb,2.267909e-02_rb,2.212176e-02_rb,2.159253e-02_rb,2.108933e-02_rb,&amp;<a name='7327'>
        &amp; 2.061028e-02_rb,2.015369e-02_rb,1.971801e-02_rb,1.930184e-02_rb,1.890389e-02_rb,&amp;<a name='7328'>
        &amp; 1.852300e-02_rb /)<a name='7329'>
      extice3(:, 20) = (/ &amp;<a name='7330'>
<font color=#447700>! band 20<a name='7331'></font>
        &amp; 5.103703e-01_rb,3.188144e-01_rb,2.317435e-01_rb,1.819887e-01_rb,1.497944e-01_rb,&amp;<a name='7332'>
        &amp; 1.272584e-01_rb,1.106013e-01_rb,9.778822e-02_rb,8.762610e-02_rb,7.936938e-02_rb,&amp;<a name='7333'>
        &amp; 7.252809e-02_rb,6.676701e-02_rb,6.184901e-02_rb,5.760165e-02_rb,5.389651e-02_rb,&amp;<a name='7334'>
        &amp; 5.063598e-02_rb,4.774457e-02_rb,4.516295e-02_rb,4.284387e-02_rb,4.074922e-02_rb,&amp;<a name='7335'>
        &amp; 3.884792e-02_rb,3.711438e-02_rb,3.552734e-02_rb,3.406898e-02_rb,3.272425e-02_rb,&amp;<a name='7336'>
        &amp; 3.148038e-02_rb,3.032643e-02_rb,2.925299e-02_rb,2.825191e-02_rb,2.731612e-02_rb,&amp;<a name='7337'>
        &amp; 2.643943e-02_rb,2.561642e-02_rb,2.484230e-02_rb,2.411284e-02_rb,2.342429e-02_rb,&amp;<a name='7338'>
        &amp; 2.277329e-02_rb,2.215686e-02_rb,2.157231e-02_rb,2.101724e-02_rb,2.048946e-02_rb,&amp;<a name='7339'>
        &amp; 1.998702e-02_rb,1.950813e-02_rb,1.905118e-02_rb,1.861468e-02_rb,1.819730e-02_rb,&amp;<a name='7340'>
        &amp; 1.779781e-02_rb /)<a name='7341'>
      extice3(:, 21) = (/ &amp;<a name='7342'>
<font color=#447700>! band 21<a name='7343'></font>
        &amp; 5.031161e-01_rb,3.144511e-01_rb,2.286942e-01_rb,1.796903e-01_rb,1.479819e-01_rb,&amp;<a name='7344'>
        &amp; 1.257860e-01_rb,1.093803e-01_rb,9.676059e-02_rb,8.675183e-02_rb,7.861971e-02_rb,&amp;<a name='7345'>
        &amp; 7.188168e-02_rb,6.620754e-02_rb,6.136376e-02_rb,5.718050e-02_rb,5.353127e-02_rb,&amp;<a name='7346'>
        &amp; 5.031995e-02_rb,4.747218e-02_rb,4.492952e-02_rb,4.264544e-02_rb,4.058240e-02_rb,&amp;<a name='7347'>
        &amp; 3.870979e-02_rb,3.700242e-02_rb,3.543933e-02_rb,3.400297e-02_rb,3.267854e-02_rb,&amp;<a name='7348'>
        &amp; 3.145345e-02_rb,3.031691e-02_rb,2.925967e-02_rb,2.827370e-02_rb,2.735203e-02_rb,&amp;<a name='7349'>
        &amp; 2.648858e-02_rb,2.567798e-02_rb,2.491555e-02_rb,2.419710e-02_rb,2.351893e-02_rb,&amp;<a name='7350'>
        &amp; 2.287776e-02_rb,2.227063e-02_rb,2.169491e-02_rb,2.114821e-02_rb,2.062840e-02_rb,&amp;<a name='7351'>
        &amp; 2.013354e-02_rb,1.966188e-02_rb,1.921182e-02_rb,1.878191e-02_rb,1.837083e-02_rb,&amp;<a name='7352'>
        &amp; 1.797737e-02_rb /)<a name='7353'>
      extice3(:, 22) = (/ &amp;<a name='7354'>
<font color=#447700>! band 22<a name='7355'></font>
        &amp; 4.949453e-01_rb,3.095918e-01_rb,2.253402e-01_rb,1.771964e-01_rb,1.460446e-01_rb,&amp;<a name='7356'>
        &amp; 1.242383e-01_rb,1.081206e-01_rb,9.572235e-02_rb,8.588928e-02_rb,7.789990e-02_rb,&amp;<a name='7357'>
        &amp; 7.128013e-02_rb,6.570559e-02_rb,6.094684e-02_rb,5.683701e-02_rb,5.325183e-02_rb,&amp;<a name='7358'>
        &amp; 5.009688e-02_rb,4.729909e-02_rb,4.480106e-02_rb,4.255708e-02_rb,4.053025e-02_rb,&amp;<a name='7359'>
        &amp; 3.869051e-02_rb,3.701310e-02_rb,3.547745e-02_rb,3.406631e-02_rb,3.276512e-02_rb,&amp;<a name='7360'>
        &amp; 3.156153e-02_rb,3.044494e-02_rb,2.940626e-02_rb,2.843759e-02_rb,2.753211e-02_rb,&amp;<a name='7361'>
        &amp; 2.668381e-02_rb,2.588744e-02_rb,2.513839e-02_rb,2.443255e-02_rb,2.376629e-02_rb,&amp;<a name='7362'>
        &amp; 2.313637e-02_rb,2.253990e-02_rb,2.197428e-02_rb,2.143718e-02_rb,2.092649e-02_rb,&amp;<a name='7363'>
        &amp; 2.044032e-02_rb,1.997694e-02_rb,1.953478e-02_rb,1.911241e-02_rb,1.870855e-02_rb,&amp;<a name='7364'>
        &amp; 1.832199e-02_rb /)<a name='7365'>
      extice3(:, 23) = (/ &amp;<a name='7366'>
<font color=#447700>! band 23<a name='7367'></font>
        &amp; 5.052816e-01_rb,3.157665e-01_rb,2.296233e-01_rb,1.803986e-01_rb,1.485473e-01_rb,&amp;<a name='7368'>
        &amp; 1.262514e-01_rb,1.097718e-01_rb,9.709524e-02_rb,8.704139e-02_rb,7.887264e-02_rb,&amp;<a name='7369'>
        &amp; 7.210424e-02_rb,6.640454e-02_rb,6.153894e-02_rb,5.733683e-02_rb,5.367116e-02_rb,&amp;<a name='7370'>
        &amp; 5.044537e-02_rb,4.758477e-02_rb,4.503066e-02_rb,4.273629e-02_rb,4.066395e-02_rb,&amp;<a name='7371'>
        &amp; 3.878291e-02_rb,3.706784e-02_rb,3.549771e-02_rb,3.405488e-02_rb,3.272448e-02_rb,&amp;<a name='7372'>
        &amp; 3.149387e-02_rb,3.035221e-02_rb,2.929020e-02_rb,2.829979e-02_rb,2.737397e-02_rb,&amp;<a name='7373'>
        &amp; 2.650663e-02_rb,2.569238e-02_rb,2.492651e-02_rb,2.420482e-02_rb,2.352361e-02_rb,&amp;<a name='7374'>
        &amp; 2.287954e-02_rb,2.226968e-02_rb,2.169136e-02_rb,2.114220e-02_rb,2.062005e-02_rb,&amp;<a name='7375'>
        &amp; 2.012296e-02_rb,1.964917e-02_rb,1.919709e-02_rb,1.876524e-02_rb,1.835231e-02_rb,&amp;<a name='7376'>
        &amp; 1.795707e-02_rb /)<a name='7377'>
      extice3(:, 24) = (/ &amp;<a name='7378'>
<font color=#447700>! band 24<a name='7379'></font>
        &amp; 5.042067e-01_rb,3.151195e-01_rb,2.291708e-01_rb,1.800573e-01_rb,1.482779e-01_rb,&amp;<a name='7380'>
        &amp; 1.260324e-01_rb,1.095900e-01_rb,9.694202e-02_rb,8.691087e-02_rb,7.876056e-02_rb,&amp;<a name='7381'>
        &amp; 7.200745e-02_rb,6.632062e-02_rb,6.146600e-02_rb,5.727338e-02_rb,5.361599e-02_rb,&amp;<a name='7382'>
        &amp; 5.039749e-02_rb,4.754334e-02_rb,4.499500e-02_rb,4.270580e-02_rb,4.063815e-02_rb,&amp;<a name='7383'>
        &amp; 3.876135e-02_rb,3.705016e-02_rb,3.548357e-02_rb,3.404400e-02_rb,3.271661e-02_rb,&amp;<a name='7384'>
        &amp; 3.148877e-02_rb,3.034969e-02_rb,2.929008e-02_rb,2.830191e-02_rb,2.737818e-02_rb,&amp;<a name='7385'>
        &amp; 2.651279e-02_rb,2.570039e-02_rb,2.493624e-02_rb,2.421618e-02_rb,2.353650e-02_rb,&amp;<a name='7386'>
        &amp; 2.289390e-02_rb,2.228541e-02_rb,2.170840e-02_rb,2.116048e-02_rb,2.063950e-02_rb,&amp;<a name='7387'>
        &amp; 2.014354e-02_rb,1.967082e-02_rb,1.921975e-02_rb,1.878888e-02_rb,1.837688e-02_rb,&amp;<a name='7388'>
        &amp; 1.798254e-02_rb /)<a name='7389'>
      extice3(:, 25) = (/ &amp;<a name='7390'>
<font color=#447700>! band 25<a name='7391'></font>
        &amp; 5.022507e-01_rb,3.139246e-01_rb,2.283218e-01_rb,1.794059e-01_rb,1.477544e-01_rb,&amp;<a name='7392'>
        &amp; 1.255984e-01_rb,1.092222e-01_rb,9.662516e-02_rb,8.663439e-02_rb,7.851688e-02_rb,&amp;<a name='7393'>
        &amp; 7.179095e-02_rb,6.612700e-02_rb,6.129193e-02_rb,5.711618e-02_rb,5.347351e-02_rb,&amp;<a name='7394'>
        &amp; 5.026796e-02_rb,4.742530e-02_rb,4.488721e-02_rb,4.260724e-02_rb,4.054790e-02_rb,&amp;<a name='7395'>
        &amp; 3.867866e-02_rb,3.697435e-02_rb,3.541407e-02_rb,3.398029e-02_rb,3.265824e-02_rb,&amp;<a name='7396'>
        &amp; 3.143535e-02_rb,3.030085e-02_rb,2.924551e-02_rb,2.826131e-02_rb,2.734130e-02_rb,&amp;<a name='7397'>
        &amp; 2.647939e-02_rb,2.567026e-02_rb,2.490919e-02_rb,2.419203e-02_rb,2.351509e-02_rb,&amp;<a name='7398'>
        &amp; 2.287507e-02_rb,2.226903e-02_rb,2.169434e-02_rb,2.114862e-02_rb,2.062975e-02_rb,&amp;<a name='7399'>
        &amp; 2.013578e-02_rb,1.966496e-02_rb,1.921571e-02_rb,1.878658e-02_rb,1.837623e-02_rb,&amp;<a name='7400'>
        &amp; 1.798348e-02_rb /)<a name='7401'>
      extice3(:, 26) = (/ &amp;<a name='7402'>
<font color=#447700>! band 26<a name='7403'></font>
        &amp; 5.068316e-01_rb,3.166869e-01_rb,2.302576e-01_rb,1.808693e-01_rb,1.489122e-01_rb,&amp;<a name='7404'>
        &amp; 1.265423e-01_rb,1.100080e-01_rb,9.728926e-02_rb,8.720201e-02_rb,7.900612e-02_rb,&amp;<a name='7405'>
        &amp; 7.221524e-02_rb,6.649660e-02_rb,6.161484e-02_rb,5.739877e-02_rb,5.372093e-02_rb,&amp;<a name='7406'>
        &amp; 5.048442e-02_rb,4.761431e-02_rb,4.505172e-02_rb,4.274972e-02_rb,4.067050e-02_rb,&amp;<a name='7407'>
        &amp; 3.878321e-02_rb,3.706244e-02_rb,3.548710e-02_rb,3.403948e-02_rb,3.270466e-02_rb,&amp;<a name='7408'>
        &amp; 3.146995e-02_rb,3.032450e-02_rb,2.925897e-02_rb,2.826527e-02_rb,2.733638e-02_rb,&amp;<a name='7409'>
        &amp; 2.646615e-02_rb,2.564920e-02_rb,2.488078e-02_rb,2.415670e-02_rb,2.347322e-02_rb,&amp;<a name='7410'>
        &amp; 2.282702e-02_rb,2.221513e-02_rb,2.163489e-02_rb,2.108390e-02_rb,2.056002e-02_rb,&amp;<a name='7411'>
        &amp; 2.006128e-02_rb,1.958591e-02_rb,1.913232e-02_rb,1.869904e-02_rb,1.828474e-02_rb,&amp;<a name='7412'>
        &amp; 1.788819e-02_rb /)<a name='7413'>
      extice3(:, 27) = (/ &amp;<a name='7414'>
<font color=#447700>! band 27<a name='7415'></font>
        &amp; 5.077707e-01_rb,3.172636e-01_rb,2.306695e-01_rb,1.811871e-01_rb,1.491691e-01_rb,&amp;<a name='7416'>
        &amp; 1.267565e-01_rb,1.101907e-01_rb,9.744773e-02_rb,8.734125e-02_rb,7.912973e-02_rb,&amp;<a name='7417'>
        &amp; 7.232591e-02_rb,6.659637e-02_rb,6.170530e-02_rb,5.748120e-02_rb,5.379634e-02_rb,&amp;<a name='7418'>
        &amp; 5.055367e-02_rb,4.767809e-02_rb,4.511061e-02_rb,4.280423e-02_rb,4.072104e-02_rb,&amp;<a name='7419'>
        &amp; 3.883015e-02_rb,3.710611e-02_rb,3.552776e-02_rb,3.407738e-02_rb,3.274002e-02_rb,&amp;<a name='7420'>
        &amp; 3.150296e-02_rb,3.035532e-02_rb,2.928776e-02_rb,2.829216e-02_rb,2.736150e-02_rb,&amp;<a name='7421'>
        &amp; 2.648961e-02_rb,2.567111e-02_rb,2.490123e-02_rb,2.417576e-02_rb,2.349098e-02_rb,&amp;<a name='7422'>
        &amp; 2.284354e-02_rb,2.223049e-02_rb,2.164914e-02_rb,2.109711e-02_rb,2.057222e-02_rb,&amp;<a name='7423'>
        &amp; 2.007253e-02_rb,1.959626e-02_rb,1.914181e-02_rb,1.870770e-02_rb,1.829261e-02_rb,&amp;<a name='7424'>
        &amp; 1.789531e-02_rb /)<a name='7425'>
      extice3(:, 28) = (/ &amp;<a name='7426'>
<font color=#447700>! band 28<a name='7427'></font>
        &amp; 5.062281e-01_rb,3.163402e-01_rb,2.300275e-01_rb,1.807060e-01_rb,1.487921e-01_rb,&amp;<a name='7428'>
        &amp; 1.264523e-01_rb,1.099403e-01_rb,9.723879e-02_rb,8.716516e-02_rb,7.898034e-02_rb,&amp;<a name='7429'>
        &amp; 7.219863e-02_rb,6.648771e-02_rb,6.161254e-02_rb,5.740217e-02_rb,5.372929e-02_rb,&amp;<a name='7430'>
        &amp; 5.049716e-02_rb,4.763092e-02_rb,4.507179e-02_rb,4.277290e-02_rb,4.069649e-02_rb,&amp;<a name='7431'>
        &amp; 3.881175e-02_rb,3.709331e-02_rb,3.552008e-02_rb,3.407442e-02_rb,3.274141e-02_rb,&amp;<a name='7432'>
        &amp; 3.150837e-02_rb,3.036447e-02_rb,2.930037e-02_rb,2.830801e-02_rb,2.738037e-02_rb,&amp;<a name='7433'>
        &amp; 2.651132e-02_rb,2.569547e-02_rb,2.492810e-02_rb,2.420499e-02_rb,2.352243e-02_rb,&amp;<a name='7434'>
        &amp; 2.287710e-02_rb,2.226604e-02_rb,2.168658e-02_rb,2.113634e-02_rb,2.061316e-02_rb,&amp;<a name='7435'>
        &amp; 2.011510e-02_rb,1.964038e-02_rb,1.918740e-02_rb,1.875471e-02_rb,1.834096e-02_rb,&amp;<a name='7436'>
        &amp; 1.794495e-02_rb /)<a name='7437'>
      extice3(:, 29) = (/ &amp;<a name='7438'>
<font color=#447700>! band 29<a name='7439'></font>
        &amp; 1.338834e-01_rb,1.924912e-01_rb,1.755523e-01_rb,1.534793e-01_rb,1.343937e-01_rb,&amp;<a name='7440'>
        &amp; 1.187883e-01_rb,1.060654e-01_rb,9.559106e-02_rb,8.685880e-02_rb,7.948698e-02_rb,&amp;<a name='7441'>
        &amp; 7.319086e-02_rb,6.775669e-02_rb,6.302215e-02_rb,5.886236e-02_rb,5.517996e-02_rb,&amp;<a name='7442'>
        &amp; 5.189810e-02_rb,4.895539e-02_rb,4.630225e-02_rb,4.389823e-02_rb,4.171002e-02_rb,&amp;<a name='7443'>
        &amp; 3.970998e-02_rb,3.787493e-02_rb,3.618537e-02_rb,3.462471e-02_rb,3.317880e-02_rb,&amp;<a name='7444'>
        &amp; 3.183547e-02_rb,3.058421e-02_rb,2.941590e-02_rb,2.832256e-02_rb,2.729724e-02_rb,&amp;<a name='7445'>
        &amp; 2.633377e-02_rb,2.542675e-02_rb,2.457136e-02_rb,2.376332e-02_rb,2.299882e-02_rb,&amp;<a name='7446'>
        &amp; 2.227443e-02_rb,2.158707e-02_rb,2.093400e-02_rb,2.031270e-02_rb,1.972091e-02_rb,&amp;<a name='7447'>
        &amp; 1.915659e-02_rb,1.861787e-02_rb,1.810304e-02_rb,1.761055e-02_rb,1.713899e-02_rb,&amp;<a name='7448'>
        &amp; 1.668704e-02_rb /)<a name='7449'>
<a name='7450'>
<font color=#447700>! single-scattering albedo: unitless<a name='7451'></font>
      ssaice3(:, 16) = (/ &amp;<a name='7452'>
<font color=#447700>! band 16<a name='7453'></font>
        &amp; 6.749442e-01_rb,6.649947e-01_rb,6.565828e-01_rb,6.489928e-01_rb,6.420046e-01_rb,&amp;<a name='7454'>
        &amp; 6.355231e-01_rb,6.294964e-01_rb,6.238901e-01_rb,6.186783e-01_rb,6.138395e-01_rb,&amp;<a name='7455'>
        &amp; 6.093543e-01_rb,6.052049e-01_rb,6.013742e-01_rb,5.978457e-01_rb,5.946030e-01_rb,&amp;<a name='7456'>
        &amp; 5.916302e-01_rb,5.889115e-01_rb,5.864310e-01_rb,5.841731e-01_rb,5.821221e-01_rb,&amp;<a name='7457'>
        &amp; 5.802624e-01_rb,5.785785e-01_rb,5.770549e-01_rb,5.756759e-01_rb,5.744262e-01_rb,&amp;<a name='7458'>
        &amp; 5.732901e-01_rb,5.722524e-01_rb,5.712974e-01_rb,5.704097e-01_rb,5.695739e-01_rb,&amp;<a name='7459'>
        &amp; 5.687747e-01_rb,5.679964e-01_rb,5.672238e-01_rb,5.664415e-01_rb,5.656340e-01_rb,&amp;<a name='7460'>
        &amp; 5.647860e-01_rb,5.638821e-01_rb,5.629070e-01_rb,5.618452e-01_rb,5.606815e-01_rb,&amp;<a name='7461'>
        &amp; 5.594006e-01_rb,5.579870e-01_rb,5.564255e-01_rb,5.547008e-01_rb,5.527976e-01_rb,&amp;<a name='7462'>
        &amp; 5.507005e-01_rb /)<a name='7463'>
      ssaice3(:, 17) = (/ &amp;<a name='7464'>
<font color=#447700>! band 17<a name='7465'></font>
        &amp; 7.628550e-01_rb,7.567297e-01_rb,7.508463e-01_rb,7.451972e-01_rb,7.397745e-01_rb,&amp;<a name='7466'>
        &amp; 7.345705e-01_rb,7.295775e-01_rb,7.247881e-01_rb,7.201945e-01_rb,7.157894e-01_rb,&amp;<a name='7467'>
        &amp; 7.115652e-01_rb,7.075145e-01_rb,7.036300e-01_rb,6.999044e-01_rb,6.963304e-01_rb,&amp;<a name='7468'>
        &amp; 6.929007e-01_rb,6.896083e-01_rb,6.864460e-01_rb,6.834067e-01_rb,6.804833e-01_rb,&amp;<a name='7469'>
        &amp; 6.776690e-01_rb,6.749567e-01_rb,6.723397e-01_rb,6.698109e-01_rb,6.673637e-01_rb,&amp;<a name='7470'>
        &amp; 6.649913e-01_rb,6.626870e-01_rb,6.604441e-01_rb,6.582561e-01_rb,6.561163e-01_rb,&amp;<a name='7471'>
        &amp; 6.540182e-01_rb,6.519554e-01_rb,6.499215e-01_rb,6.479099e-01_rb,6.459145e-01_rb,&amp;<a name='7472'>
        &amp; 6.439289e-01_rb,6.419468e-01_rb,6.399621e-01_rb,6.379686e-01_rb,6.359601e-01_rb,&amp;<a name='7473'>
        &amp; 6.339306e-01_rb,6.318740e-01_rb,6.297845e-01_rb,6.276559e-01_rb,6.254825e-01_rb,&amp;<a name='7474'>
        &amp; 6.232583e-01_rb /)<a name='7475'>
      ssaice3(:, 18) = (/ &amp;<a name='7476'>
<font color=#447700>! band 18<a name='7477'></font>
        &amp; 9.924147e-01_rb,9.882792e-01_rb,9.842257e-01_rb,9.802522e-01_rb,9.763566e-01_rb,&amp;<a name='7478'>
        &amp; 9.725367e-01_rb,9.687905e-01_rb,9.651157e-01_rb,9.615104e-01_rb,9.579725e-01_rb,&amp;<a name='7479'>
        &amp; 9.544997e-01_rb,9.510901e-01_rb,9.477416e-01_rb,9.444520e-01_rb,9.412194e-01_rb,&amp;<a name='7480'>
        &amp; 9.380415e-01_rb,9.349165e-01_rb,9.318421e-01_rb,9.288164e-01_rb,9.258373e-01_rb,&amp;<a name='7481'>
        &amp; 9.229027e-01_rb,9.200106e-01_rb,9.171589e-01_rb,9.143457e-01_rb,9.115688e-01_rb,&amp;<a name='7482'>
        &amp; 9.088263e-01_rb,9.061161e-01_rb,9.034362e-01_rb,9.007846e-01_rb,8.981592e-01_rb,&amp;<a name='7483'>
        &amp; 8.955581e-01_rb,8.929792e-01_rb,8.904206e-01_rb,8.878803e-01_rb,8.853562e-01_rb,&amp;<a name='7484'>
        &amp; 8.828464e-01_rb,8.803488e-01_rb,8.778616e-01_rb,8.753827e-01_rb,8.729102e-01_rb,&amp;<a name='7485'>
        &amp; 8.704421e-01_rb,8.679764e-01_rb,8.655112e-01_rb,8.630445e-01_rb,8.605744e-01_rb,&amp;<a name='7486'>
        &amp; 8.580989e-01_rb /)<a name='7487'>
      ssaice3(:, 19) = (/ &amp;<a name='7488'>
<font color=#447700>! band 19<a name='7489'></font>
        &amp; 9.629413e-01_rb,9.517182e-01_rb,9.409209e-01_rb,9.305366e-01_rb,9.205529e-01_rb,&amp;<a name='7490'>
        &amp; 9.109569e-01_rb,9.017362e-01_rb,8.928780e-01_rb,8.843699e-01_rb,8.761992e-01_rb,&amp;<a name='7491'>
        &amp; 8.683536e-01_rb,8.608204e-01_rb,8.535873e-01_rb,8.466417e-01_rb,8.399712e-01_rb,&amp;<a name='7492'>
        &amp; 8.335635e-01_rb,8.274062e-01_rb,8.214868e-01_rb,8.157932e-01_rb,8.103129e-01_rb,&amp;<a name='7493'>
        &amp; 8.050336e-01_rb,7.999432e-01_rb,7.950294e-01_rb,7.902798e-01_rb,7.856825e-01_rb,&amp;<a name='7494'>
        &amp; 7.812250e-01_rb,7.768954e-01_rb,7.726815e-01_rb,7.685711e-01_rb,7.645522e-01_rb,&amp;<a name='7495'>
        &amp; 7.606126e-01_rb,7.567404e-01_rb,7.529234e-01_rb,7.491498e-01_rb,7.454074e-01_rb,&amp;<a name='7496'>
        &amp; 7.416844e-01_rb,7.379688e-01_rb,7.342485e-01_rb,7.305118e-01_rb,7.267468e-01_rb,&amp;<a name='7497'>
        &amp; 7.229415e-01_rb,7.190841e-01_rb,7.151628e-01_rb,7.111657e-01_rb,7.070811e-01_rb,&amp;<a name='7498'>
        &amp; 7.028972e-01_rb /)<a name='7499'>
      ssaice3(:, 20) = (/ &amp;<a name='7500'>
<font color=#447700>! band 20<a name='7501'></font>
        &amp; 9.942270e-01_rb,9.909206e-01_rb,9.876775e-01_rb,9.844960e-01_rb,9.813746e-01_rb,&amp;<a name='7502'>
        &amp; 9.783114e-01_rb,9.753049e-01_rb,9.723535e-01_rb,9.694553e-01_rb,9.666088e-01_rb,&amp;<a name='7503'>
        &amp; 9.638123e-01_rb,9.610641e-01_rb,9.583626e-01_rb,9.557060e-01_rb,9.530928e-01_rb,&amp;<a name='7504'>
        &amp; 9.505211e-01_rb,9.479895e-01_rb,9.454961e-01_rb,9.430393e-01_rb,9.406174e-01_rb,&amp;<a name='7505'>
        &amp; 9.382288e-01_rb,9.358717e-01_rb,9.335446e-01_rb,9.312456e-01_rb,9.289731e-01_rb,&amp;<a name='7506'>
        &amp; 9.267255e-01_rb,9.245010e-01_rb,9.222980e-01_rb,9.201147e-01_rb,9.179496e-01_rb,&amp;<a name='7507'>
        &amp; 9.158008e-01_rb,9.136667e-01_rb,9.115457e-01_rb,9.094359e-01_rb,9.073358e-01_rb,&amp;<a name='7508'>
        &amp; 9.052436e-01_rb,9.031577e-01_rb,9.010763e-01_rb,8.989977e-01_rb,8.969203e-01_rb,&amp;<a name='7509'>
        &amp; 8.948423e-01_rb,8.927620e-01_rb,8.906778e-01_rb,8.885879e-01_rb,8.864907e-01_rb,&amp;<a name='7510'>
        &amp; 8.843843e-01_rb /)<a name='7511'>
      ssaice3(:, 21) = (/ &amp;<a name='7512'>
<font color=#447700>! band 21<a name='7513'></font>
        &amp; 9.934014e-01_rb,9.899331e-01_rb,9.865537e-01_rb,9.832610e-01_rb,9.800523e-01_rb,&amp;<a name='7514'>
        &amp; 9.769254e-01_rb,9.738777e-01_rb,9.709069e-01_rb,9.680106e-01_rb,9.651862e-01_rb,&amp;<a name='7515'>
        &amp; 9.624315e-01_rb,9.597439e-01_rb,9.571212e-01_rb,9.545608e-01_rb,9.520605e-01_rb,&amp;<a name='7516'>
        &amp; 9.496177e-01_rb,9.472301e-01_rb,9.448954e-01_rb,9.426111e-01_rb,9.403749e-01_rb,&amp;<a name='7517'>
        &amp; 9.381843e-01_rb,9.360370e-01_rb,9.339307e-01_rb,9.318629e-01_rb,9.298313e-01_rb,&amp;<a name='7518'>
        &amp; 9.278336e-01_rb,9.258673e-01_rb,9.239302e-01_rb,9.220198e-01_rb,9.201338e-01_rb,&amp;<a name='7519'>
        &amp; 9.182700e-01_rb,9.164258e-01_rb,9.145991e-01_rb,9.127874e-01_rb,9.109884e-01_rb,&amp;<a name='7520'>
        &amp; 9.091999e-01_rb,9.074194e-01_rb,9.056447e-01_rb,9.038735e-01_rb,9.021033e-01_rb,&amp;<a name='7521'>
        &amp; 9.003320e-01_rb,8.985572e-01_rb,8.967766e-01_rb,8.949879e-01_rb,8.931888e-01_rb,&amp;<a name='7522'>
        &amp; 8.913770e-01_rb /)<a name='7523'>
      ssaice3(:, 22) = (/ &amp;<a name='7524'>
<font color=#447700>! band 22<a name='7525'></font>
        &amp; 9.994833e-01_rb,9.992055e-01_rb,9.989278e-01_rb,9.986500e-01_rb,9.983724e-01_rb,&amp;<a name='7526'>
        &amp; 9.980947e-01_rb,9.978172e-01_rb,9.975397e-01_rb,9.972623e-01_rb,9.969849e-01_rb,&amp;<a name='7527'>
        &amp; 9.967077e-01_rb,9.964305e-01_rb,9.961535e-01_rb,9.958765e-01_rb,9.955997e-01_rb,&amp;<a name='7528'>
        &amp; 9.953230e-01_rb,9.950464e-01_rb,9.947699e-01_rb,9.944936e-01_rb,9.942174e-01_rb,&amp;<a name='7529'>
        &amp; 9.939414e-01_rb,9.936656e-01_rb,9.933899e-01_rb,9.931144e-01_rb,9.928390e-01_rb,&amp;<a name='7530'>
        &amp; 9.925639e-01_rb,9.922889e-01_rb,9.920141e-01_rb,9.917396e-01_rb,9.914652e-01_rb,&amp;<a name='7531'>
        &amp; 9.911911e-01_rb,9.909171e-01_rb,9.906434e-01_rb,9.903700e-01_rb,9.900967e-01_rb,&amp;<a name='7532'>
        &amp; 9.898237e-01_rb,9.895510e-01_rb,9.892784e-01_rb,9.890062e-01_rb,9.887342e-01_rb,&amp;<a name='7533'>
        &amp; 9.884625e-01_rb,9.881911e-01_rb,9.879199e-01_rb,9.876490e-01_rb,9.873784e-01_rb,&amp;<a name='7534'>
        &amp; 9.871081e-01_rb /)<a name='7535'>
      ssaice3(:, 23) = (/ &amp;<a name='7536'>
<font color=#447700>! band 23<a name='7537'></font>
        &amp; 9.999343e-01_rb,9.998917e-01_rb,9.998492e-01_rb,9.998067e-01_rb,9.997642e-01_rb,&amp;<a name='7538'>
        &amp; 9.997218e-01_rb,9.996795e-01_rb,9.996372e-01_rb,9.995949e-01_rb,9.995528e-01_rb,&amp;<a name='7539'>
        &amp; 9.995106e-01_rb,9.994686e-01_rb,9.994265e-01_rb,9.993845e-01_rb,9.993426e-01_rb,&amp;<a name='7540'>
        &amp; 9.993007e-01_rb,9.992589e-01_rb,9.992171e-01_rb,9.991754e-01_rb,9.991337e-01_rb,&amp;<a name='7541'>
        &amp; 9.990921e-01_rb,9.990505e-01_rb,9.990089e-01_rb,9.989674e-01_rb,9.989260e-01_rb,&amp;<a name='7542'>
        &amp; 9.988846e-01_rb,9.988432e-01_rb,9.988019e-01_rb,9.987606e-01_rb,9.987194e-01_rb,&amp;<a name='7543'>
        &amp; 9.986782e-01_rb,9.986370e-01_rb,9.985959e-01_rb,9.985549e-01_rb,9.985139e-01_rb,&amp;<a name='7544'>
        &amp; 9.984729e-01_rb,9.984319e-01_rb,9.983910e-01_rb,9.983502e-01_rb,9.983094e-01_rb,&amp;<a name='7545'>
        &amp; 9.982686e-01_rb,9.982279e-01_rb,9.981872e-01_rb,9.981465e-01_rb,9.981059e-01_rb,&amp;<a name='7546'>
        &amp; 9.980653e-01_rb /)<a name='7547'>
      ssaice3(:, 24) = (/ &amp;<a name='7548'>
<font color=#447700>! band 24<a name='7549'></font>
        &amp; 9.999978e-01_rb,9.999965e-01_rb,9.999952e-01_rb,9.999939e-01_rb,9.999926e-01_rb,&amp;<a name='7550'>
        &amp; 9.999913e-01_rb,9.999900e-01_rb,9.999887e-01_rb,9.999873e-01_rb,9.999860e-01_rb,&amp;<a name='7551'>
        &amp; 9.999847e-01_rb,9.999834e-01_rb,9.999821e-01_rb,9.999808e-01_rb,9.999795e-01_rb,&amp;<a name='7552'>
        &amp; 9.999782e-01_rb,9.999769e-01_rb,9.999756e-01_rb,9.999743e-01_rb,9.999730e-01_rb,&amp;<a name='7553'>
        &amp; 9.999717e-01_rb,9.999704e-01_rb,9.999691e-01_rb,9.999678e-01_rb,9.999665e-01_rb,&amp;<a name='7554'>
        &amp; 9.999652e-01_rb,9.999639e-01_rb,9.999626e-01_rb,9.999613e-01_rb,9.999600e-01_rb,&amp;<a name='7555'>
        &amp; 9.999587e-01_rb,9.999574e-01_rb,9.999561e-01_rb,9.999548e-01_rb,9.999535e-01_rb,&amp;<a name='7556'>
        &amp; 9.999522e-01_rb,9.999509e-01_rb,9.999496e-01_rb,9.999483e-01_rb,9.999470e-01_rb,&amp;<a name='7557'>
        &amp; 9.999457e-01_rb,9.999444e-01_rb,9.999431e-01_rb,9.999418e-01_rb,9.999405e-01_rb,&amp;<a name='7558'>
        &amp; 9.999392e-01_rb /)<a name='7559'>
      ssaice3(:, 25) = (/ &amp;<a name='7560'>
<font color=#447700>! band 25<a name='7561'></font>
        &amp; 9.999994e-01_rb,9.999993e-01_rb,9.999991e-01_rb,9.999990e-01_rb,9.999989e-01_rb,&amp;<a name='7562'>
        &amp; 9.999987e-01_rb,9.999986e-01_rb,9.999984e-01_rb,9.999983e-01_rb,9.999982e-01_rb,&amp;<a name='7563'>
        &amp; 9.999980e-01_rb,9.999979e-01_rb,9.999977e-01_rb,9.999976e-01_rb,9.999975e-01_rb,&amp;<a name='7564'>
        &amp; 9.999973e-01_rb,9.999972e-01_rb,9.999970e-01_rb,9.999969e-01_rb,9.999967e-01_rb,&amp;<a name='7565'>
        &amp; 9.999966e-01_rb,9.999965e-01_rb,9.999963e-01_rb,9.999962e-01_rb,9.999960e-01_rb,&amp;<a name='7566'>
        &amp; 9.999959e-01_rb,9.999957e-01_rb,9.999956e-01_rb,9.999954e-01_rb,9.999953e-01_rb,&amp;<a name='7567'>
        &amp; 9.999952e-01_rb,9.999950e-01_rb,9.999949e-01_rb,9.999947e-01_rb,9.999946e-01_rb,&amp;<a name='7568'>
        &amp; 9.999944e-01_rb,9.999943e-01_rb,9.999941e-01_rb,9.999940e-01_rb,9.999939e-01_rb,&amp;<a name='7569'>
        &amp; 9.999937e-01_rb,9.999936e-01_rb,9.999934e-01_rb,9.999933e-01_rb,9.999931e-01_rb,&amp;<a name='7570'>
        &amp; 9.999930e-01_rb /)<a name='7571'>
      ssaice3(:, 26) = (/ &amp;<a name='7572'>
<font color=#447700>! band 26<a name='7573'></font>
        &amp; 9.999997e-01_rb,9.999995e-01_rb,9.999992e-01_rb,9.999990e-01_rb,9.999987e-01_rb,&amp;<a name='7574'>
        &amp; 9.999985e-01_rb,9.999983e-01_rb,9.999980e-01_rb,9.999978e-01_rb,9.999976e-01_rb,&amp;<a name='7575'>
        &amp; 9.999973e-01_rb,9.999971e-01_rb,9.999969e-01_rb,9.999967e-01_rb,9.999965e-01_rb,&amp;<a name='7576'>
        &amp; 9.999963e-01_rb,9.999960e-01_rb,9.999958e-01_rb,9.999956e-01_rb,9.999954e-01_rb,&amp;<a name='7577'>
        &amp; 9.999952e-01_rb,9.999950e-01_rb,9.999948e-01_rb,9.999946e-01_rb,9.999944e-01_rb,&amp;<a name='7578'>
        &amp; 9.999942e-01_rb,9.999939e-01_rb,9.999937e-01_rb,9.999935e-01_rb,9.999933e-01_rb,&amp;<a name='7579'>
        &amp; 9.999931e-01_rb,9.999929e-01_rb,9.999927e-01_rb,9.999925e-01_rb,9.999923e-01_rb,&amp;<a name='7580'>
        &amp; 9.999920e-01_rb,9.999918e-01_rb,9.999916e-01_rb,9.999914e-01_rb,9.999911e-01_rb,&amp;<a name='7581'>
        &amp; 9.999909e-01_rb,9.999907e-01_rb,9.999905e-01_rb,9.999902e-01_rb,9.999900e-01_rb,&amp;<a name='7582'>
        &amp; 9.999897e-01_rb /)<a name='7583'>
      ssaice3(:, 27) = (/ &amp;<a name='7584'>
<font color=#447700>! band 27<a name='7585'></font>
        &amp; 9.999991e-01_rb,9.999985e-01_rb,9.999980e-01_rb,9.999974e-01_rb,9.999968e-01_rb,&amp;<a name='7586'>
        &amp; 9.999963e-01_rb,9.999957e-01_rb,9.999951e-01_rb,9.999946e-01_rb,9.999940e-01_rb,&amp;<a name='7587'>
        &amp; 9.999934e-01_rb,9.999929e-01_rb,9.999923e-01_rb,9.999918e-01_rb,9.999912e-01_rb,&amp;<a name='7588'>
        &amp; 9.999907e-01_rb,9.999901e-01_rb,9.999896e-01_rb,9.999891e-01_rb,9.999885e-01_rb,&amp;<a name='7589'>
        &amp; 9.999880e-01_rb,9.999874e-01_rb,9.999869e-01_rb,9.999863e-01_rb,9.999858e-01_rb,&amp;<a name='7590'>
        &amp; 9.999853e-01_rb,9.999847e-01_rb,9.999842e-01_rb,9.999836e-01_rb,9.999831e-01_rb,&amp;<a name='7591'>
        &amp; 9.999826e-01_rb,9.999820e-01_rb,9.999815e-01_rb,9.999809e-01_rb,9.999804e-01_rb,&amp;<a name='7592'>
        &amp; 9.999798e-01_rb,9.999793e-01_rb,9.999787e-01_rb,9.999782e-01_rb,9.999776e-01_rb,&amp;<a name='7593'>
        &amp; 9.999770e-01_rb,9.999765e-01_rb,9.999759e-01_rb,9.999754e-01_rb,9.999748e-01_rb,&amp;<a name='7594'>
        &amp; 9.999742e-01_rb /)<a name='7595'>
      ssaice3(:, 28) = (/ &amp;<a name='7596'>
<font color=#447700>! band 28<a name='7597'></font>
        &amp; 9.999975e-01_rb,9.999961e-01_rb,9.999946e-01_rb,9.999931e-01_rb,9.999917e-01_rb,&amp;<a name='7598'>
        &amp; 9.999903e-01_rb,9.999888e-01_rb,9.999874e-01_rb,9.999859e-01_rb,9.999845e-01_rb,&amp;<a name='7599'>
        &amp; 9.999831e-01_rb,9.999816e-01_rb,9.999802e-01_rb,9.999788e-01_rb,9.999774e-01_rb,&amp;<a name='7600'>
        &amp; 9.999759e-01_rb,9.999745e-01_rb,9.999731e-01_rb,9.999717e-01_rb,9.999702e-01_rb,&amp;<a name='7601'>
        &amp; 9.999688e-01_rb,9.999674e-01_rb,9.999660e-01_rb,9.999646e-01_rb,9.999631e-01_rb,&amp;<a name='7602'>
        &amp; 9.999617e-01_rb,9.999603e-01_rb,9.999589e-01_rb,9.999574e-01_rb,9.999560e-01_rb,&amp;<a name='7603'>
        &amp; 9.999546e-01_rb,9.999532e-01_rb,9.999517e-01_rb,9.999503e-01_rb,9.999489e-01_rb,&amp;<a name='7604'>
        &amp; 9.999474e-01_rb,9.999460e-01_rb,9.999446e-01_rb,9.999431e-01_rb,9.999417e-01_rb,&amp;<a name='7605'>
        &amp; 9.999403e-01_rb,9.999388e-01_rb,9.999374e-01_rb,9.999359e-01_rb,9.999345e-01_rb,&amp;<a name='7606'>
        &amp; 9.999330e-01_rb /)<a name='7607'>
      ssaice3(:, 29) = (/ &amp;<a name='7608'>
<font color=#447700>! band 29<a name='7609'></font>
        &amp; 4.526500e-01_rb,5.287890e-01_rb,5.410487e-01_rb,5.459865e-01_rb,5.485149e-01_rb,&amp;<a name='7610'>
        &amp; 5.498914e-01_rb,5.505895e-01_rb,5.508310e-01_rb,5.507364e-01_rb,5.503793e-01_rb,&amp;<a name='7611'>
        &amp; 5.498090e-01_rb,5.490612e-01_rb,5.481637e-01_rb,5.471395e-01_rb,5.460083e-01_rb,&amp;<a name='7612'>
        &amp; 5.447878e-01_rb,5.434946e-01_rb,5.421442e-01_rb,5.407514e-01_rb,5.393309e-01_rb,&amp;<a name='7613'>
        &amp; 5.378970e-01_rb,5.364641e-01_rb,5.350464e-01_rb,5.336582e-01_rb,5.323140e-01_rb,&amp;<a name='7614'>
        &amp; 5.310283e-01_rb,5.298158e-01_rb,5.286914e-01_rb,5.276704e-01_rb,5.267680e-01_rb,&amp;<a name='7615'>
        &amp; 5.260000e-01_rb,5.253823e-01_rb,5.249311e-01_rb,5.246629e-01_rb,5.245946e-01_rb,&amp;<a name='7616'>
        &amp; 5.247434e-01_rb,5.251268e-01_rb,5.257626e-01_rb,5.266693e-01_rb,5.278653e-01_rb,&amp;<a name='7617'>
        &amp; 5.293698e-01_rb,5.312022e-01_rb,5.333823e-01_rb,5.359305e-01_rb,5.388676e-01_rb,&amp;<a name='7618'>
        &amp; 5.422146e-01_rb /)<a name='7619'>
<a name='7620'>
<font color=#447700>! asymmetry factor: unitless<a name='7621'></font>
      asyice3(:, 16) = (/ &amp;<a name='7622'>
<font color=#447700>! band 16<a name='7623'></font>
        &amp; 8.340752e-01_rb,8.435170e-01_rb,8.517487e-01_rb,8.592064e-01_rb,8.660387e-01_rb,&amp;<a name='7624'>
        &amp; 8.723204e-01_rb,8.780997e-01_rb,8.834137e-01_rb,8.882934e-01_rb,8.927662e-01_rb,&amp;<a name='7625'>
        &amp; 8.968577e-01_rb,9.005914e-01_rb,9.039899e-01_rb,9.070745e-01_rb,9.098659e-01_rb,&amp;<a name='7626'>
        &amp; 9.123836e-01_rb,9.146466e-01_rb,9.166734e-01_rb,9.184817e-01_rb,9.200886e-01_rb,&amp;<a name='7627'>
        &amp; 9.215109e-01_rb,9.227648e-01_rb,9.238661e-01_rb,9.248304e-01_rb,9.256727e-01_rb,&amp;<a name='7628'>
        &amp; 9.264078e-01_rb,9.270505e-01_rb,9.276150e-01_rb,9.281156e-01_rb,9.285662e-01_rb,&amp;<a name='7629'>
        &amp; 9.289806e-01_rb,9.293726e-01_rb,9.297557e-01_rb,9.301435e-01_rb,9.305491e-01_rb,&amp;<a name='7630'>
        &amp; 9.309859e-01_rb,9.314671e-01_rb,9.320055e-01_rb,9.326140e-01_rb,9.333053e-01_rb,&amp;<a name='7631'>
        &amp; 9.340919e-01_rb,9.349861e-01_rb,9.360000e-01_rb,9.371451e-01_rb,9.384329e-01_rb,&amp;<a name='7632'>
        &amp; 9.398744e-01_rb /)<a name='7633'>
      asyice3(:, 17) = (/ &amp;<a name='7634'>
<font color=#447700>! band 17<a name='7635'></font>
        &amp; 8.728160e-01_rb,8.777333e-01_rb,8.823754e-01_rb,8.867535e-01_rb,8.908785e-01_rb,&amp;<a name='7636'>
        &amp; 8.947611e-01_rb,8.984118e-01_rb,9.018408e-01_rb,9.050582e-01_rb,9.080739e-01_rb,&amp;<a name='7637'>
        &amp; 9.108976e-01_rb,9.135388e-01_rb,9.160068e-01_rb,9.183106e-01_rb,9.204595e-01_rb,&amp;<a name='7638'>
        &amp; 9.224620e-01_rb,9.243271e-01_rb,9.260632e-01_rb,9.276788e-01_rb,9.291822e-01_rb,&amp;<a name='7639'>
        &amp; 9.305817e-01_rb,9.318853e-01_rb,9.331012e-01_rb,9.342372e-01_rb,9.353013e-01_rb,&amp;<a name='7640'>
        &amp; 9.363013e-01_rb,9.372450e-01_rb,9.381400e-01_rb,9.389939e-01_rb,9.398145e-01_rb,&amp;<a name='7641'>
        &amp; 9.406092e-01_rb,9.413856e-01_rb,9.421511e-01_rb,9.429131e-01_rb,9.436790e-01_rb,&amp;<a name='7642'>
        &amp; 9.444561e-01_rb,9.452517e-01_rb,9.460729e-01_rb,9.469270e-01_rb,9.478209e-01_rb,&amp;<a name='7643'>
        &amp; 9.487617e-01_rb,9.497562e-01_rb,9.508112e-01_rb,9.519335e-01_rb,9.531294e-01_rb,&amp;<a name='7644'>
        &amp; 9.544055e-01_rb /)<a name='7645'>
      asyice3(:, 18) = (/ &amp;<a name='7646'>
<font color=#447700>! band 18<a name='7647'></font>
        &amp; 7.897566e-01_rb,7.948704e-01_rb,7.998041e-01_rb,8.045623e-01_rb,8.091495e-01_rb,&amp;<a name='7648'>
        &amp; 8.135702e-01_rb,8.178290e-01_rb,8.219305e-01_rb,8.258790e-01_rb,8.296792e-01_rb,&amp;<a name='7649'>
        &amp; 8.333355e-01_rb,8.368524e-01_rb,8.402343e-01_rb,8.434856e-01_rb,8.466108e-01_rb,&amp;<a name='7650'>
        &amp; 8.496143e-01_rb,8.525004e-01_rb,8.552737e-01_rb,8.579384e-01_rb,8.604990e-01_rb,&amp;<a name='7651'>
        &amp; 8.629597e-01_rb,8.653250e-01_rb,8.675992e-01_rb,8.697867e-01_rb,8.718916e-01_rb,&amp;<a name='7652'>
        &amp; 8.739185e-01_rb,8.758715e-01_rb,8.777551e-01_rb,8.795734e-01_rb,8.813308e-01_rb,&amp;<a name='7653'>
        &amp; 8.830315e-01_rb,8.846799e-01_rb,8.862802e-01_rb,8.878366e-01_rb,8.893534e-01_rb,&amp;<a name='7654'>
        &amp; 8.908350e-01_rb,8.922854e-01_rb,8.937090e-01_rb,8.951099e-01_rb,8.964925e-01_rb,&amp;<a name='7655'>
        &amp; 8.978609e-01_rb,8.992192e-01_rb,9.005718e-01_rb,9.019229e-01_rb,9.032765e-01_rb,&amp;<a name='7656'>
        &amp; 9.046369e-01_rb /)<a name='7657'>
      asyice3(:, 19) = (/ &amp;<a name='7658'>
<font color=#447700>! band 19<a name='7659'></font>
        &amp; 7.812615e-01_rb,7.887764e-01_rb,7.959664e-01_rb,8.028413e-01_rb,8.094109e-01_rb,&amp;<a name='7660'>
        &amp; 8.156849e-01_rb,8.216730e-01_rb,8.273846e-01_rb,8.328294e-01_rb,8.380166e-01_rb,&amp;<a name='7661'>
        &amp; 8.429556e-01_rb,8.476556e-01_rb,8.521258e-01_rb,8.563753e-01_rb,8.604131e-01_rb,&amp;<a name='7662'>
        &amp; 8.642481e-01_rb,8.678893e-01_rb,8.713455e-01_rb,8.746254e-01_rb,8.777378e-01_rb,&amp;<a name='7663'>
        &amp; 8.806914e-01_rb,8.834948e-01_rb,8.861566e-01_rb,8.886854e-01_rb,8.910897e-01_rb,&amp;<a name='7664'>
        &amp; 8.933779e-01_rb,8.955586e-01_rb,8.976402e-01_rb,8.996311e-01_rb,9.015398e-01_rb,&amp;<a name='7665'>
        &amp; 9.033745e-01_rb,9.051436e-01_rb,9.068555e-01_rb,9.085185e-01_rb,9.101410e-01_rb,&amp;<a name='7666'>
        &amp; 9.117311e-01_rb,9.132972e-01_rb,9.148476e-01_rb,9.163905e-01_rb,9.179340e-01_rb,&amp;<a name='7667'>
        &amp; 9.194864e-01_rb,9.210559e-01_rb,9.226505e-01_rb,9.242784e-01_rb,9.259476e-01_rb,&amp;<a name='7668'>
        &amp; 9.276661e-01_rb /)<a name='7669'>
      asyice3(:, 20) = (/ &amp;<a name='7670'>
<font color=#447700>! band 20<a name='7671'></font>
        &amp; 7.640720e-01_rb,7.691119e-01_rb,7.739941e-01_rb,7.787222e-01_rb,7.832998e-01_rb,&amp;<a name='7672'>
        &amp; 7.877304e-01_rb,7.920177e-01_rb,7.961652e-01_rb,8.001765e-01_rb,8.040551e-01_rb,&amp;<a name='7673'>
        &amp; 8.078044e-01_rb,8.114280e-01_rb,8.149294e-01_rb,8.183119e-01_rb,8.215791e-01_rb,&amp;<a name='7674'>
        &amp; 8.247344e-01_rb,8.277812e-01_rb,8.307229e-01_rb,8.335629e-01_rb,8.363046e-01_rb,&amp;<a name='7675'>
        &amp; 8.389514e-01_rb,8.415067e-01_rb,8.439738e-01_rb,8.463560e-01_rb,8.486568e-01_rb,&amp;<a name='7676'>
        &amp; 8.508795e-01_rb,8.530274e-01_rb,8.551039e-01_rb,8.571122e-01_rb,8.590558e-01_rb,&amp;<a name='7677'>
        &amp; 8.609378e-01_rb,8.627618e-01_rb,8.645309e-01_rb,8.662485e-01_rb,8.679178e-01_rb,&amp;<a name='7678'>
        &amp; 8.695423e-01_rb,8.711251e-01_rb,8.726697e-01_rb,8.741792e-01_rb,8.756571e-01_rb,&amp;<a name='7679'>
        &amp; 8.771065e-01_rb,8.785307e-01_rb,8.799331e-01_rb,8.813169e-01_rb,8.826854e-01_rb,&amp;<a name='7680'>
        &amp; 8.840419e-01_rb /)<a name='7681'>
      asyice3(:, 21) = (/ &amp;<a name='7682'>
<font color=#447700>! band 21<a name='7683'></font>
        &amp; 7.602598e-01_rb,7.651572e-01_rb,7.699014e-01_rb,7.744962e-01_rb,7.789452e-01_rb,&amp;<a name='7684'>
        &amp; 7.832522e-01_rb,7.874205e-01_rb,7.914538e-01_rb,7.953555e-01_rb,7.991290e-01_rb,&amp;<a name='7685'>
        &amp; 8.027777e-01_rb,8.063049e-01_rb,8.097140e-01_rb,8.130081e-01_rb,8.161906e-01_rb,&amp;<a name='7686'>
        &amp; 8.192645e-01_rb,8.222331e-01_rb,8.250993e-01_rb,8.278664e-01_rb,8.305374e-01_rb,&amp;<a name='7687'>
        &amp; 8.331153e-01_rb,8.356030e-01_rb,8.380037e-01_rb,8.403201e-01_rb,8.425553e-01_rb,&amp;<a name='7688'>
        &amp; 8.447121e-01_rb,8.467935e-01_rb,8.488022e-01_rb,8.507412e-01_rb,8.526132e-01_rb,&amp;<a name='7689'>
        &amp; 8.544210e-01_rb,8.561675e-01_rb,8.578554e-01_rb,8.594875e-01_rb,8.610665e-01_rb,&amp;<a name='7690'>
        &amp; 8.625951e-01_rb,8.640760e-01_rb,8.655119e-01_rb,8.669055e-01_rb,8.682594e-01_rb,&amp;<a name='7691'>
        &amp; 8.695763e-01_rb,8.708587e-01_rb,8.721094e-01_rb,8.733308e-01_rb,8.745255e-01_rb,&amp;<a name='7692'>
        &amp; 8.756961e-01_rb /)<a name='7693'>
      asyice3(:, 22) = (/ &amp;<a name='7694'>
<font color=#447700>! band 22<a name='7695'></font>
        &amp; 7.568957e-01_rb,7.606995e-01_rb,7.644072e-01_rb,7.680204e-01_rb,7.715402e-01_rb,&amp;<a name='7696'>
        &amp; 7.749682e-01_rb,7.783057e-01_rb,7.815541e-01_rb,7.847148e-01_rb,7.877892e-01_rb,&amp;<a name='7697'>
        &amp; 7.907786e-01_rb,7.936846e-01_rb,7.965084e-01_rb,7.992515e-01_rb,8.019153e-01_rb,&amp;<a name='7698'>
        &amp; 8.045011e-01_rb,8.070103e-01_rb,8.094444e-01_rb,8.118048e-01_rb,8.140927e-01_rb,&amp;<a name='7699'>
        &amp; 8.163097e-01_rb,8.184571e-01_rb,8.205364e-01_rb,8.225488e-01_rb,8.244958e-01_rb,&amp;<a name='7700'>
        &amp; 8.263789e-01_rb,8.281993e-01_rb,8.299586e-01_rb,8.316580e-01_rb,8.332991e-01_rb,&amp;<a name='7701'>
        &amp; 8.348831e-01_rb,8.364115e-01_rb,8.378857e-01_rb,8.393071e-01_rb,8.406770e-01_rb,&amp;<a name='7702'>
        &amp; 8.419969e-01_rb,8.432682e-01_rb,8.444923e-01_rb,8.456706e-01_rb,8.468044e-01_rb,&amp;<a name='7703'>
        &amp; 8.478952e-01_rb,8.489444e-01_rb,8.499533e-01_rb,8.509234e-01_rb,8.518561e-01_rb,&amp;<a name='7704'>
        &amp; 8.527528e-01_rb /)<a name='7705'>
      asyice3(:, 23) = (/ &amp;<a name='7706'>
<font color=#447700>! band 23<a name='7707'></font>
        &amp; 7.575066e-01_rb,7.606912e-01_rb,7.638236e-01_rb,7.669035e-01_rb,7.699306e-01_rb,&amp;<a name='7708'>
        &amp; 7.729046e-01_rb,7.758254e-01_rb,7.786926e-01_rb,7.815060e-01_rb,7.842654e-01_rb,&amp;<a name='7709'>
        &amp; 7.869705e-01_rb,7.896211e-01_rb,7.922168e-01_rb,7.947574e-01_rb,7.972428e-01_rb,&amp;<a name='7710'>
        &amp; 7.996726e-01_rb,8.020466e-01_rb,8.043646e-01_rb,8.066262e-01_rb,8.088313e-01_rb,&amp;<a name='7711'>
        &amp; 8.109796e-01_rb,8.130709e-01_rb,8.151049e-01_rb,8.170814e-01_rb,8.190001e-01_rb,&amp;<a name='7712'>
        &amp; 8.208608e-01_rb,8.226632e-01_rb,8.244071e-01_rb,8.260924e-01_rb,8.277186e-01_rb,&amp;<a name='7713'>
        &amp; 8.292856e-01_rb,8.307932e-01_rb,8.322411e-01_rb,8.336291e-01_rb,8.349570e-01_rb,&amp;<a name='7714'>
        &amp; 8.362244e-01_rb,8.374312e-01_rb,8.385772e-01_rb,8.396621e-01_rb,8.406856e-01_rb,&amp;<a name='7715'>
        &amp; 8.416476e-01_rb,8.425479e-01_rb,8.433861e-01_rb,8.441620e-01_rb,8.448755e-01_rb,&amp;<a name='7716'>
        &amp; 8.455263e-01_rb /)<a name='7717'>
      asyice3(:, 24) = (/ &amp;<a name='7718'>
<font color=#447700>! band 24<a name='7719'></font>
        &amp; 7.568829e-01_rb,7.597947e-01_rb,7.626745e-01_rb,7.655212e-01_rb,7.683337e-01_rb,&amp;<a name='7720'>
        &amp; 7.711111e-01_rb,7.738523e-01_rb,7.765565e-01_rb,7.792225e-01_rb,7.818494e-01_rb,&amp;<a name='7721'>
        &amp; 7.844362e-01_rb,7.869819e-01_rb,7.894854e-01_rb,7.919459e-01_rb,7.943623e-01_rb,&amp;<a name='7722'>
        &amp; 7.967337e-01_rb,7.990590e-01_rb,8.013373e-01_rb,8.035676e-01_rb,8.057488e-01_rb,&amp;<a name='7723'>
        &amp; 8.078802e-01_rb,8.099605e-01_rb,8.119890e-01_rb,8.139645e-01_rb,8.158862e-01_rb,&amp;<a name='7724'>
        &amp; 8.177530e-01_rb,8.195641e-01_rb,8.213183e-01_rb,8.230149e-01_rb,8.246527e-01_rb,&amp;<a name='7725'>
        &amp; 8.262308e-01_rb,8.277483e-01_rb,8.292042e-01_rb,8.305976e-01_rb,8.319275e-01_rb,&amp;<a name='7726'>
        &amp; 8.331929e-01_rb,8.343929e-01_rb,8.355265e-01_rb,8.365928e-01_rb,8.375909e-01_rb,&amp;<a name='7727'>
        &amp; 8.385197e-01_rb,8.393784e-01_rb,8.401659e-01_rb,8.408815e-01_rb,8.415240e-01_rb,&amp;<a name='7728'>
        &amp; 8.420926e-01_rb /)<a name='7729'>
      asyice3(:, 25) = (/ &amp;<a name='7730'>
<font color=#447700>! band 25<a name='7731'></font>
        &amp; 7.548616e-01_rb,7.575454e-01_rb,7.602153e-01_rb,7.628696e-01_rb,7.655067e-01_rb,&amp;<a name='7732'>
        &amp; 7.681249e-01_rb,7.707225e-01_rb,7.732978e-01_rb,7.758492e-01_rb,7.783750e-01_rb,&amp;<a name='7733'>
        &amp; 7.808735e-01_rb,7.833430e-01_rb,7.857819e-01_rb,7.881886e-01_rb,7.905612e-01_rb,&amp;<a name='7734'>
        &amp; 7.928983e-01_rb,7.951980e-01_rb,7.974588e-01_rb,7.996789e-01_rb,8.018567e-01_rb,&amp;<a name='7735'>
        &amp; 8.039905e-01_rb,8.060787e-01_rb,8.081196e-01_rb,8.101115e-01_rb,8.120527e-01_rb,&amp;<a name='7736'>
        &amp; 8.139416e-01_rb,8.157764e-01_rb,8.175557e-01_rb,8.192776e-01_rb,8.209405e-01_rb,&amp;<a name='7737'>
        &amp; 8.225427e-01_rb,8.240826e-01_rb,8.255585e-01_rb,8.269688e-01_rb,8.283117e-01_rb,&amp;<a name='7738'>
        &amp; 8.295856e-01_rb,8.307889e-01_rb,8.319198e-01_rb,8.329767e-01_rb,8.339579e-01_rb,&amp;<a name='7739'>
        &amp; 8.348619e-01_rb,8.356868e-01_rb,8.364311e-01_rb,8.370930e-01_rb,8.376710e-01_rb,&amp;<a name='7740'>
        &amp; 8.381633e-01_rb /)<a name='7741'>
      asyice3(:, 26) = (/ &amp;<a name='7742'>
<font color=#447700>! band 26<a name='7743'></font>
        &amp; 7.491854e-01_rb,7.518523e-01_rb,7.545089e-01_rb,7.571534e-01_rb,7.597839e-01_rb,&amp;<a name='7744'>
        &amp; 7.623987e-01_rb,7.649959e-01_rb,7.675737e-01_rb,7.701303e-01_rb,7.726639e-01_rb,&amp;<a name='7745'>
        &amp; 7.751727e-01_rb,7.776548e-01_rb,7.801084e-01_rb,7.825318e-01_rb,7.849230e-01_rb,&amp;<a name='7746'>
        &amp; 7.872804e-01_rb,7.896020e-01_rb,7.918862e-01_rb,7.941309e-01_rb,7.963345e-01_rb,&amp;<a name='7747'>
        &amp; 7.984951e-01_rb,8.006109e-01_rb,8.026802e-01_rb,8.047009e-01_rb,8.066715e-01_rb,&amp;<a name='7748'>
        &amp; 8.085900e-01_rb,8.104546e-01_rb,8.122636e-01_rb,8.140150e-01_rb,8.157072e-01_rb,&amp;<a name='7749'>
        &amp; 8.173382e-01_rb,8.189063e-01_rb,8.204096e-01_rb,8.218464e-01_rb,8.232148e-01_rb,&amp;<a name='7750'>
        &amp; 8.245130e-01_rb,8.257391e-01_rb,8.268915e-01_rb,8.279682e-01_rb,8.289675e-01_rb,&amp;<a name='7751'>
        &amp; 8.298875e-01_rb,8.307264e-01_rb,8.314824e-01_rb,8.321537e-01_rb,8.327385e-01_rb,&amp;<a name='7752'>
        &amp; 8.332350e-01_rb /)<a name='7753'>
      asyice3(:, 27) = (/ &amp;<a name='7754'>
<font color=#447700>! band 27<a name='7755'></font>
        &amp; 7.397086e-01_rb,7.424069e-01_rb,7.450955e-01_rb,7.477725e-01_rb,7.504362e-01_rb,&amp;<a name='7756'>
        &amp; 7.530846e-01_rb,7.557159e-01_rb,7.583283e-01_rb,7.609199e-01_rb,7.634888e-01_rb,&amp;<a name='7757'>
        &amp; 7.660332e-01_rb,7.685512e-01_rb,7.710411e-01_rb,7.735009e-01_rb,7.759288e-01_rb,&amp;<a name='7758'>
        &amp; 7.783229e-01_rb,7.806814e-01_rb,7.830024e-01_rb,7.852841e-01_rb,7.875246e-01_rb,&amp;<a name='7759'>
        &amp; 7.897221e-01_rb,7.918748e-01_rb,7.939807e-01_rb,7.960380e-01_rb,7.980449e-01_rb,&amp;<a name='7760'>
        &amp; 7.999995e-01_rb,8.019000e-01_rb,8.037445e-01_rb,8.055311e-01_rb,8.072581e-01_rb,&amp;<a name='7761'>
        &amp; 8.089235e-01_rb,8.105255e-01_rb,8.120623e-01_rb,8.135319e-01_rb,8.149326e-01_rb,&amp;<a name='7762'>
        &amp; 8.162626e-01_rb,8.175198e-01_rb,8.187025e-01_rb,8.198089e-01_rb,8.208371e-01_rb,&amp;<a name='7763'>
        &amp; 8.217852e-01_rb,8.226514e-01_rb,8.234338e-01_rb,8.241306e-01_rb,8.247399e-01_rb,&amp;<a name='7764'>
        &amp; 8.252599e-01_rb /)<a name='7765'>
      asyice3(:, 28) = (/ &amp;<a name='7766'>
<font color=#447700>! band 28<a name='7767'></font>
        &amp; 7.224533e-01_rb,7.251681e-01_rb,7.278728e-01_rb,7.305654e-01_rb,7.332444e-01_rb,&amp;<a name='7768'>
        &amp; 7.359078e-01_rb,7.385539e-01_rb,7.411808e-01_rb,7.437869e-01_rb,7.463702e-01_rb,&amp;<a name='7769'>
        &amp; 7.489291e-01_rb,7.514616e-01_rb,7.539661e-01_rb,7.564408e-01_rb,7.588837e-01_rb,&amp;<a name='7770'>
        &amp; 7.612933e-01_rb,7.636676e-01_rb,7.660049e-01_rb,7.683034e-01_rb,7.705612e-01_rb,&amp;<a name='7771'>
        &amp; 7.727767e-01_rb,7.749480e-01_rb,7.770733e-01_rb,7.791509e-01_rb,7.811789e-01_rb,&amp;<a name='7772'>
        &amp; 7.831556e-01_rb,7.850791e-01_rb,7.869478e-01_rb,7.887597e-01_rb,7.905131e-01_rb,&amp;<a name='7773'>
        &amp; 7.922062e-01_rb,7.938372e-01_rb,7.954044e-01_rb,7.969059e-01_rb,7.983399e-01_rb,&amp;<a name='7774'>
        &amp; 7.997047e-01_rb,8.009985e-01_rb,8.022195e-01_rb,8.033658e-01_rb,8.044357e-01_rb,&amp;<a name='7775'>
        &amp; 8.054275e-01_rb,8.063392e-01_rb,8.071692e-01_rb,8.079157e-01_rb,8.085768e-01_rb,&amp;<a name='7776'>
        &amp; 8.091507e-01_rb /)<a name='7777'>
      asyice3(:, 29) = (/ &amp;<a name='7778'>
<font color=#447700>! band 29<a name='7779'></font>
        &amp; 8.850026e-01_rb,9.005489e-01_rb,9.069242e-01_rb,9.121799e-01_rb,9.168987e-01_rb,&amp;<a name='7780'>
        &amp; 9.212259e-01_rb,9.252176e-01_rb,9.289028e-01_rb,9.323000e-01_rb,9.354235e-01_rb,&amp;<a name='7781'>
        &amp; 9.382858e-01_rb,9.408985e-01_rb,9.432734e-01_rb,9.454218e-01_rb,9.473557e-01_rb,&amp;<a name='7782'>
        &amp; 9.490871e-01_rb,9.506282e-01_rb,9.519917e-01_rb,9.531904e-01_rb,9.542374e-01_rb,&amp;<a name='7783'>
        &amp; 9.551461e-01_rb,9.559298e-01_rb,9.566023e-01_rb,9.571775e-01_rb,9.576692e-01_rb,&amp;<a name='7784'>
        &amp; 9.580916e-01_rb,9.584589e-01_rb,9.587853e-01_rb,9.590851e-01_rb,9.593729e-01_rb,&amp;<a name='7785'>
        &amp; 9.596632e-01_rb,9.599705e-01_rb,9.603096e-01_rb,9.606954e-01_rb,9.611427e-01_rb,&amp;<a name='7786'>
        &amp; 9.616667e-01_rb,9.622826e-01_rb,9.630060e-01_rb,9.638524e-01_rb,9.648379e-01_rb,&amp;<a name='7787'>
        &amp; 9.659788e-01_rb,9.672916e-01_rb,9.687933e-01_rb,9.705014e-01_rb,9.724337e-01_rb,&amp;<a name='7788'>
        &amp; 9.746084e-01_rb /)<a name='7789'>
<a name='7790'>
<font color=#447700>! fdelta: unitless<a name='7791'></font>
      fdlice3(:, 16) = (/ &amp;<a name='7792'>
<font color=#447700>! band 16<a name='7793'></font>
        &amp; 4.959277e-02_rb,4.685292e-02_rb,4.426104e-02_rb,4.181231e-02_rb,3.950191e-02_rb,&amp;<a name='7794'>
        &amp; 3.732500e-02_rb,3.527675e-02_rb,3.335235e-02_rb,3.154697e-02_rb,2.985578e-02_rb,&amp;<a name='7795'>
        &amp; 2.827395e-02_rb,2.679666e-02_rb,2.541909e-02_rb,2.413640e-02_rb,2.294378e-02_rb,&amp;<a name='7796'>
        &amp; 2.183639e-02_rb,2.080940e-02_rb,1.985801e-02_rb,1.897736e-02_rb,1.816265e-02_rb,&amp;<a name='7797'>
        &amp; 1.740905e-02_rb,1.671172e-02_rb,1.606585e-02_rb,1.546661e-02_rb,1.490917e-02_rb,&amp;<a name='7798'>
        &amp; 1.438870e-02_rb,1.390038e-02_rb,1.343939e-02_rb,1.300089e-02_rb,1.258006e-02_rb,&amp;<a name='7799'>
        &amp; 1.217208e-02_rb,1.177212e-02_rb,1.137536e-02_rb,1.097696e-02_rb,1.057210e-02_rb,&amp;<a name='7800'>
        &amp; 1.015596e-02_rb,9.723704e-03_rb,9.270516e-03_rb,8.791565e-03_rb,8.282026e-03_rb,&amp;<a name='7801'>
        &amp; 7.737072e-03_rb,7.151879e-03_rb,6.521619e-03_rb,5.841467e-03_rb,5.106597e-03_rb,&amp;<a name='7802'>
        &amp; 4.312183e-03_rb /)<a name='7803'>
      fdlice3(:, 17) = (/ &amp;<a name='7804'>
<font color=#447700>! band 17<a name='7805'></font>
        &amp; 5.071224e-02_rb,5.000217e-02_rb,4.933872e-02_rb,4.871992e-02_rb,4.814380e-02_rb,&amp;<a name='7806'>
        &amp; 4.760839e-02_rb,4.711170e-02_rb,4.665177e-02_rb,4.622662e-02_rb,4.583426e-02_rb,&amp;<a name='7807'>
        &amp; 4.547274e-02_rb,4.514007e-02_rb,4.483428e-02_rb,4.455340e-02_rb,4.429544e-02_rb,&amp;<a name='7808'>
        &amp; 4.405844e-02_rb,4.384041e-02_rb,4.363939e-02_rb,4.345340e-02_rb,4.328047e-02_rb,&amp;<a name='7809'>
        &amp; 4.311861e-02_rb,4.296586e-02_rb,4.282024e-02_rb,4.267977e-02_rb,4.254248e-02_rb,&amp;<a name='7810'>
        &amp; 4.240640e-02_rb,4.226955e-02_rb,4.212995e-02_rb,4.198564e-02_rb,4.183462e-02_rb,&amp;<a name='7811'>
        &amp; 4.167494e-02_rb,4.150462e-02_rb,4.132167e-02_rb,4.112413e-02_rb,4.091003e-02_rb,&amp;<a name='7812'>
        &amp; 4.067737e-02_rb,4.042420e-02_rb,4.014854e-02_rb,3.984840e-02_rb,3.952183e-02_rb,&amp;<a name='7813'>
        &amp; 3.916683e-02_rb,3.878144e-02_rb,3.836368e-02_rb,3.791158e-02_rb,3.742316e-02_rb,&amp;<a name='7814'>
        &amp; 3.689645e-02_rb /)<a name='7815'>
      fdlice3(:, 18) = (/ &amp;<a name='7816'>
<font color=#447700>! band 18<a name='7817'></font>
        &amp; 1.062938e-01_rb,1.065234e-01_rb,1.067822e-01_rb,1.070682e-01_rb,1.073793e-01_rb,&amp;<a name='7818'>
        &amp; 1.077137e-01_rb,1.080693e-01_rb,1.084442e-01_rb,1.088364e-01_rb,1.092439e-01_rb,&amp;<a name='7819'>
        &amp; 1.096647e-01_rb,1.100970e-01_rb,1.105387e-01_rb,1.109878e-01_rb,1.114423e-01_rb,&amp;<a name='7820'>
        &amp; 1.119004e-01_rb,1.123599e-01_rb,1.128190e-01_rb,1.132757e-01_rb,1.137279e-01_rb,&amp;<a name='7821'>
        &amp; 1.141738e-01_rb,1.146113e-01_rb,1.150385e-01_rb,1.154534e-01_rb,1.158540e-01_rb,&amp;<a name='7822'>
        &amp; 1.162383e-01_rb,1.166045e-01_rb,1.169504e-01_rb,1.172741e-01_rb,1.175738e-01_rb,&amp;<a name='7823'>
        &amp; 1.178472e-01_rb,1.180926e-01_rb,1.183080e-01_rb,1.184913e-01_rb,1.186405e-01_rb,&amp;<a name='7824'>
        &amp; 1.187538e-01_rb,1.188291e-01_rb,1.188645e-01_rb,1.188580e-01_rb,1.188076e-01_rb,&amp;<a name='7825'>
        &amp; 1.187113e-01_rb,1.185672e-01_rb,1.183733e-01_rb,1.181277e-01_rb,1.178282e-01_rb,&amp;<a name='7826'>
        &amp; 1.174731e-01_rb /)<a name='7827'>
      fdlice3(:, 19) = (/ &amp;<a name='7828'>
<font color=#447700>! band 19<a name='7829'></font>
        &amp; 1.076195e-01_rb,1.065195e-01_rb,1.054696e-01_rb,1.044673e-01_rb,1.035099e-01_rb,&amp;<a name='7830'>
        &amp; 1.025951e-01_rb,1.017203e-01_rb,1.008831e-01_rb,1.000808e-01_rb,9.931116e-02_rb,&amp;<a name='7831'>
        &amp; 9.857151e-02_rb,9.785939e-02_rb,9.717230e-02_rb,9.650774e-02_rb,9.586322e-02_rb,&amp;<a name='7832'>
        &amp; 9.523623e-02_rb,9.462427e-02_rb,9.402484e-02_rb,9.343544e-02_rb,9.285358e-02_rb,&amp;<a name='7833'>
        &amp; 9.227675e-02_rb,9.170245e-02_rb,9.112818e-02_rb,9.055144e-02_rb,8.996974e-02_rb,&amp;<a name='7834'>
        &amp; 8.938056e-02_rb,8.878142e-02_rb,8.816981e-02_rb,8.754323e-02_rb,8.689919e-02_rb,&amp;<a name='7835'>
        &amp; 8.623517e-02_rb,8.554869e-02_rb,8.483724e-02_rb,8.409832e-02_rb,8.332943e-02_rb,&amp;<a name='7836'>
        &amp; 8.252807e-02_rb,8.169175e-02_rb,8.081795e-02_rb,7.990419e-02_rb,7.894796e-02_rb,&amp;<a name='7837'>
        &amp; 7.794676e-02_rb,7.689809e-02_rb,7.579945e-02_rb,7.464834e-02_rb,7.344227e-02_rb,&amp;<a name='7838'>
        &amp; 7.217872e-02_rb /)<a name='7839'>
      fdlice3(:, 20) = (/ &amp;<a name='7840'>
<font color=#447700>! band 20<a name='7841'></font>
        &amp; 1.119014e-01_rb,1.122706e-01_rb,1.126690e-01_rb,1.130947e-01_rb,1.135456e-01_rb,&amp;<a name='7842'>
        &amp; 1.140199e-01_rb,1.145154e-01_rb,1.150302e-01_rb,1.155623e-01_rb,1.161096e-01_rb,&amp;<a name='7843'>
        &amp; 1.166703e-01_rb,1.172422e-01_rb,1.178233e-01_rb,1.184118e-01_rb,1.190055e-01_rb,&amp;<a name='7844'>
        &amp; 1.196025e-01_rb,1.202008e-01_rb,1.207983e-01_rb,1.213931e-01_rb,1.219832e-01_rb,&amp;<a name='7845'>
        &amp; 1.225665e-01_rb,1.231411e-01_rb,1.237050e-01_rb,1.242561e-01_rb,1.247926e-01_rb,&amp;<a name='7846'>
        &amp; 1.253122e-01_rb,1.258132e-01_rb,1.262934e-01_rb,1.267509e-01_rb,1.271836e-01_rb,&amp;<a name='7847'>
        &amp; 1.275896e-01_rb,1.279669e-01_rb,1.283134e-01_rb,1.286272e-01_rb,1.289063e-01_rb,&amp;<a name='7848'>
        &amp; 1.291486e-01_rb,1.293522e-01_rb,1.295150e-01_rb,1.296351e-01_rb,1.297104e-01_rb,&amp;<a name='7849'>
        &amp; 1.297390e-01_rb,1.297189e-01_rb,1.296480e-01_rb,1.295244e-01_rb,1.293460e-01_rb,&amp;<a name='7850'>
        &amp; 1.291109e-01_rb /)<a name='7851'>
      fdlice3(:, 21) = (/ &amp;<a name='7852'>
<font color=#447700>! band 21<a name='7853'></font>
        &amp; 1.133298e-01_rb,1.136777e-01_rb,1.140556e-01_rb,1.144615e-01_rb,1.148934e-01_rb,&amp;<a name='7854'>
        &amp; 1.153492e-01_rb,1.158269e-01_rb,1.163243e-01_rb,1.168396e-01_rb,1.173706e-01_rb,&amp;<a name='7855'>
        &amp; 1.179152e-01_rb,1.184715e-01_rb,1.190374e-01_rb,1.196108e-01_rb,1.201897e-01_rb,&amp;<a name='7856'>
        &amp; 1.207720e-01_rb,1.213558e-01_rb,1.219389e-01_rb,1.225194e-01_rb,1.230951e-01_rb,&amp;<a name='7857'>
        &amp; 1.236640e-01_rb,1.242241e-01_rb,1.247733e-01_rb,1.253096e-01_rb,1.258309e-01_rb,&amp;<a name='7858'>
        &amp; 1.263352e-01_rb,1.268205e-01_rb,1.272847e-01_rb,1.277257e-01_rb,1.281415e-01_rb,&amp;<a name='7859'>
        &amp; 1.285300e-01_rb,1.288893e-01_rb,1.292173e-01_rb,1.295118e-01_rb,1.297710e-01_rb,&amp;<a name='7860'>
        &amp; 1.299927e-01_rb,1.301748e-01_rb,1.303154e-01_rb,1.304124e-01_rb,1.304637e-01_rb,&amp;<a name='7861'>
        &amp; 1.304673e-01_rb,1.304212e-01_rb,1.303233e-01_rb,1.301715e-01_rb,1.299638e-01_rb,&amp;<a name='7862'>
        &amp; 1.296983e-01_rb /)<a name='7863'>
      fdlice3(:, 22) = (/ &amp;<a name='7864'>
<font color=#447700>! band 22<a name='7865'></font>
        &amp; 1.145360e-01_rb,1.153256e-01_rb,1.161453e-01_rb,1.169929e-01_rb,1.178666e-01_rb,&amp;<a name='7866'>
        &amp; 1.187641e-01_rb,1.196835e-01_rb,1.206227e-01_rb,1.215796e-01_rb,1.225522e-01_rb,&amp;<a name='7867'>
        &amp; 1.235383e-01_rb,1.245361e-01_rb,1.255433e-01_rb,1.265579e-01_rb,1.275779e-01_rb,&amp;<a name='7868'>
        &amp; 1.286011e-01_rb,1.296257e-01_rb,1.306494e-01_rb,1.316703e-01_rb,1.326862e-01_rb,&amp;<a name='7869'>
        &amp; 1.336951e-01_rb,1.346950e-01_rb,1.356838e-01_rb,1.366594e-01_rb,1.376198e-01_rb,&amp;<a name='7870'>
        &amp; 1.385629e-01_rb,1.394866e-01_rb,1.403889e-01_rb,1.412678e-01_rb,1.421212e-01_rb,&amp;<a name='7871'>
        &amp; 1.429469e-01_rb,1.437430e-01_rb,1.445074e-01_rb,1.452381e-01_rb,1.459329e-01_rb,&amp;<a name='7872'>
        &amp; 1.465899e-01_rb,1.472069e-01_rb,1.477819e-01_rb,1.483128e-01_rb,1.487976e-01_rb,&amp;<a name='7873'>
        &amp; 1.492343e-01_rb,1.496207e-01_rb,1.499548e-01_rb,1.502346e-01_rb,1.504579e-01_rb,&amp;<a name='7874'>
        &amp; 1.506227e-01_rb /)<a name='7875'>
      fdlice3(:, 23) = (/ &amp;<a name='7876'>
<font color=#447700>! band 23<a name='7877'></font>
        &amp; 1.153263e-01_rb,1.161445e-01_rb,1.169932e-01_rb,1.178703e-01_rb,1.187738e-01_rb,&amp;<a name='7878'>
        &amp; 1.197016e-01_rb,1.206516e-01_rb,1.216217e-01_rb,1.226099e-01_rb,1.236141e-01_rb,&amp;<a name='7879'>
        &amp; 1.246322e-01_rb,1.256621e-01_rb,1.267017e-01_rb,1.277491e-01_rb,1.288020e-01_rb,&amp;<a name='7880'>
        &amp; 1.298584e-01_rb,1.309163e-01_rb,1.319736e-01_rb,1.330281e-01_rb,1.340778e-01_rb,&amp;<a name='7881'>
        &amp; 1.351207e-01_rb,1.361546e-01_rb,1.371775e-01_rb,1.381873e-01_rb,1.391820e-01_rb,&amp;<a name='7882'>
        &amp; 1.401593e-01_rb,1.411174e-01_rb,1.420540e-01_rb,1.429671e-01_rb,1.438547e-01_rb,&amp;<a name='7883'>
        &amp; 1.447146e-01_rb,1.455449e-01_rb,1.463433e-01_rb,1.471078e-01_rb,1.478364e-01_rb,&amp;<a name='7884'>
        &amp; 1.485270e-01_rb,1.491774e-01_rb,1.497857e-01_rb,1.503497e-01_rb,1.508674e-01_rb,&amp;<a name='7885'>
        &amp; 1.513367e-01_rb,1.517554e-01_rb,1.521216e-01_rb,1.524332e-01_rb,1.526880e-01_rb,&amp;<a name='7886'>
        &amp; 1.528840e-01_rb /)<a name='7887'>
      fdlice3(:, 24) = (/ &amp;<a name='7888'>
<font color=#447700>! band 24<a name='7889'></font>
        &amp; 1.160842e-01_rb,1.169118e-01_rb,1.177697e-01_rb,1.186556e-01_rb,1.195676e-01_rb,&amp;<a name='7890'>
        &amp; 1.205036e-01_rb,1.214616e-01_rb,1.224394e-01_rb,1.234349e-01_rb,1.244463e-01_rb,&amp;<a name='7891'>
        &amp; 1.254712e-01_rb,1.265078e-01_rb,1.275539e-01_rb,1.286075e-01_rb,1.296664e-01_rb,&amp;<a name='7892'>
        &amp; 1.307287e-01_rb,1.317923e-01_rb,1.328550e-01_rb,1.339149e-01_rb,1.349699e-01_rb,&amp;<a name='7893'>
        &amp; 1.360179e-01_rb,1.370567e-01_rb,1.380845e-01_rb,1.390991e-01_rb,1.400984e-01_rb,&amp;<a name='7894'>
        &amp; 1.410803e-01_rb,1.420429e-01_rb,1.429840e-01_rb,1.439016e-01_rb,1.447936e-01_rb,&amp;<a name='7895'>
        &amp; 1.456579e-01_rb,1.464925e-01_rb,1.472953e-01_rb,1.480642e-01_rb,1.487972e-01_rb,&amp;<a name='7896'>
        &amp; 1.494923e-01_rb,1.501472e-01_rb,1.507601e-01_rb,1.513287e-01_rb,1.518511e-01_rb,&amp;<a name='7897'>
        &amp; 1.523252e-01_rb,1.527489e-01_rb,1.531201e-01_rb,1.534368e-01_rb,1.536969e-01_rb,&amp;<a name='7898'>
        &amp; 1.538984e-01_rb /)<a name='7899'>
      fdlice3(:, 25) = (/ &amp;<a name='7900'>
<font color=#447700>! band 25<a name='7901'></font>
        &amp; 1.168725e-01_rb,1.177088e-01_rb,1.185747e-01_rb,1.194680e-01_rb,1.203867e-01_rb,&amp;<a name='7902'>
        &amp; 1.213288e-01_rb,1.222923e-01_rb,1.232750e-01_rb,1.242750e-01_rb,1.252903e-01_rb,&amp;<a name='7903'>
        &amp; 1.263187e-01_rb,1.273583e-01_rb,1.284069e-01_rb,1.294626e-01_rb,1.305233e-01_rb,&amp;<a name='7904'>
        &amp; 1.315870e-01_rb,1.326517e-01_rb,1.337152e-01_rb,1.347756e-01_rb,1.358308e-01_rb,&amp;<a name='7905'>
        &amp; 1.368788e-01_rb,1.379175e-01_rb,1.389449e-01_rb,1.399590e-01_rb,1.409577e-01_rb,&amp;<a name='7906'>
        &amp; 1.419389e-01_rb,1.429007e-01_rb,1.438410e-01_rb,1.447577e-01_rb,1.456488e-01_rb,&amp;<a name='7907'>
        &amp; 1.465123e-01_rb,1.473461e-01_rb,1.481483e-01_rb,1.489166e-01_rb,1.496492e-01_rb,&amp;<a name='7908'>
        &amp; 1.503439e-01_rb,1.509988e-01_rb,1.516118e-01_rb,1.521808e-01_rb,1.527038e-01_rb,&amp;<a name='7909'>
        &amp; 1.531788e-01_rb,1.536037e-01_rb,1.539764e-01_rb,1.542951e-01_rb,1.545575e-01_rb,&amp;<a name='7910'>
        &amp; 1.547617e-01_rb /)<a name='7911'>
      fdlice3(:, 26) = (/ &amp;<a name='7912'>
<font color=#447700>!band 26<a name='7913'></font>
        &amp; 1.180509e-01_rb,1.189025e-01_rb,1.197820e-01_rb,1.206875e-01_rb,1.216171e-01_rb,&amp;<a name='7914'>
        &amp; 1.225687e-01_rb,1.235404e-01_rb,1.245303e-01_rb,1.255363e-01_rb,1.265564e-01_rb,&amp;<a name='7915'>
        &amp; 1.275888e-01_rb,1.286313e-01_rb,1.296821e-01_rb,1.307392e-01_rb,1.318006e-01_rb,&amp;<a name='7916'>
        &amp; 1.328643e-01_rb,1.339284e-01_rb,1.349908e-01_rb,1.360497e-01_rb,1.371029e-01_rb,&amp;<a name='7917'>
        &amp; 1.381486e-01_rb,1.391848e-01_rb,1.402095e-01_rb,1.412208e-01_rb,1.422165e-01_rb,&amp;<a name='7918'>
        &amp; 1.431949e-01_rb,1.441539e-01_rb,1.450915e-01_rb,1.460058e-01_rb,1.468947e-01_rb,&amp;<a name='7919'>
        &amp; 1.477564e-01_rb,1.485888e-01_rb,1.493900e-01_rb,1.501580e-01_rb,1.508907e-01_rb,&amp;<a name='7920'>
        &amp; 1.515864e-01_rb,1.522428e-01_rb,1.528582e-01_rb,1.534305e-01_rb,1.539578e-01_rb,&amp;<a name='7921'>
        &amp; 1.544380e-01_rb,1.548692e-01_rb,1.552494e-01_rb,1.555767e-01_rb,1.558490e-01_rb,&amp;<a name='7922'>
        &amp; 1.560645e-01_rb /)<a name='7923'>
      fdlice3(:, 27) = (/ &amp;<a name='7924'>
<font color=#447700>! band 27<a name='7925'></font>
        &amp; 1.200480e-01_rb,1.209267e-01_rb,1.218304e-01_rb,1.227575e-01_rb,1.237059e-01_rb,&amp;<a name='7926'>
        &amp; 1.246739e-01_rb,1.256595e-01_rb,1.266610e-01_rb,1.276765e-01_rb,1.287041e-01_rb,&amp;<a name='7927'>
        &amp; 1.297420e-01_rb,1.307883e-01_rb,1.318412e-01_rb,1.328988e-01_rb,1.339593e-01_rb,&amp;<a name='7928'>
        &amp; 1.350207e-01_rb,1.360813e-01_rb,1.371393e-01_rb,1.381926e-01_rb,1.392396e-01_rb,&amp;<a name='7929'>
        &amp; 1.402783e-01_rb,1.413069e-01_rb,1.423235e-01_rb,1.433263e-01_rb,1.443134e-01_rb,&amp;<a name='7930'>
        &amp; 1.452830e-01_rb,1.462332e-01_rb,1.471622e-01_rb,1.480681e-01_rb,1.489490e-01_rb,&amp;<a name='7931'>
        &amp; 1.498032e-01_rb,1.506286e-01_rb,1.514236e-01_rb,1.521863e-01_rb,1.529147e-01_rb,&amp;<a name='7932'>
        &amp; 1.536070e-01_rb,1.542614e-01_rb,1.548761e-01_rb,1.554491e-01_rb,1.559787e-01_rb,&amp;<a name='7933'>
        &amp; 1.564629e-01_rb,1.568999e-01_rb,1.572879e-01_rb,1.576249e-01_rb,1.579093e-01_rb,&amp;<a name='7934'>
        &amp; 1.581390e-01_rb /)<a name='7935'>
      fdlice3(:, 28) = (/ &amp;<a name='7936'>
<font color=#447700>! band 28<a name='7937'></font>
        &amp; 1.247813e-01_rb,1.256496e-01_rb,1.265417e-01_rb,1.274560e-01_rb,1.283905e-01_rb,&amp;<a name='7938'>
        &amp; 1.293436e-01_rb,1.303135e-01_rb,1.312983e-01_rb,1.322964e-01_rb,1.333060e-01_rb,&amp;<a name='7939'>
        &amp; 1.343252e-01_rb,1.353523e-01_rb,1.363855e-01_rb,1.374231e-01_rb,1.384632e-01_rb,&amp;<a name='7940'>
        &amp; 1.395042e-01_rb,1.405441e-01_rb,1.415813e-01_rb,1.426140e-01_rb,1.436404e-01_rb,&amp;<a name='7941'>
        &amp; 1.446587e-01_rb,1.456672e-01_rb,1.466640e-01_rb,1.476475e-01_rb,1.486157e-01_rb,&amp;<a name='7942'>
        &amp; 1.495671e-01_rb,1.504997e-01_rb,1.514117e-01_rb,1.523016e-01_rb,1.531673e-01_rb,&amp;<a name='7943'>
        &amp; 1.540073e-01_rb,1.548197e-01_rb,1.556026e-01_rb,1.563545e-01_rb,1.570734e-01_rb,&amp;<a name='7944'>
        &amp; 1.577576e-01_rb,1.584054e-01_rb,1.590149e-01_rb,1.595843e-01_rb,1.601120e-01_rb,&amp;<a name='7945'>
        &amp; 1.605962e-01_rb,1.610349e-01_rb,1.614266e-01_rb,1.617693e-01_rb,1.620614e-01_rb,&amp;<a name='7946'>
        &amp; 1.623011e-01_rb /)<a name='7947'>
      fdlice3(:, 29) = (/ &amp;<a name='7948'>
<font color=#447700>! band 29<a name='7949'></font>
        &amp; 1.006055e-01_rb,9.549582e-02_rb,9.063960e-02_rb,8.602900e-02_rb,8.165612e-02_rb,&amp;<a name='7950'>
        &amp; 7.751308e-02_rb,7.359199e-02_rb,6.988496e-02_rb,6.638412e-02_rb,6.308156e-02_rb,&amp;<a name='7951'>
        &amp; 5.996942e-02_rb,5.703979e-02_rb,5.428481e-02_rb,5.169657e-02_rb,4.926719e-02_rb,&amp;<a name='7952'>
        &amp; 4.698880e-02_rb,4.485349e-02_rb,4.285339e-02_rb,4.098061e-02_rb,3.922727e-02_rb,&amp;<a name='7953'>
        &amp; 3.758547e-02_rb,3.604733e-02_rb,3.460497e-02_rb,3.325051e-02_rb,3.197604e-02_rb,&amp;<a name='7954'>
        &amp; 3.077369e-02_rb,2.963558e-02_rb,2.855381e-02_rb,2.752050e-02_rb,2.652776e-02_rb,&amp;<a name='7955'>
        &amp; 2.556772e-02_rb,2.463247e-02_rb,2.371415e-02_rb,2.280485e-02_rb,2.189670e-02_rb,&amp;<a name='7956'>
        &amp; 2.098180e-02_rb,2.005228e-02_rb,1.910024e-02_rb,1.811781e-02_rb,1.709709e-02_rb,&amp;<a name='7957'>
        &amp; 1.603020e-02_rb,1.490925e-02_rb,1.372635e-02_rb,1.247363e-02_rb,1.114319e-02_rb,&amp;<a name='7958'>
        &amp; 9.727157e-03_rb /)<a name='7959'>
<a name='7960'>
      end subroutine swcldpr<a name='7961'>
<a name='7962'>
      end module rrtmg_sw_init<a name='7963'>
<a name='7964'>
<font color=#447700>!     path:      $Source: /cvsroot/NWP/WRFV3/phys/module_ra_rrtmg_sw.F,v $<a name='7965'></font>
<font color=#447700>!     author:    $Author: trn $<a name='7966'></font>
<font color=#447700>!     revision:  $Revision: 1.3 $<a name='7967'></font>
<font color=#447700>!     created:   $Date: 2009/04/16 19:54:22 $<a name='7968'></font>
<font color=#447700>!<a name='7969'></font>
<A NAME='RRTMG_SW_VRTQDR'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_VRTQDR' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='7970'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_vrtqdr</font> <A href='../../call_to/RRTMG_SW_VRTQDR.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_VRTQDR.html' TARGET='index'>1</A><a name='7971'>
<a name='7972'>
<font color=#447700>!  --------------------------------------------------------------------------<a name='7973'></font>
<font color=#447700>! |                                                                          |<a name='7974'></font>
<font color=#447700>! |  Copyright 2002-2008, Atmospheric &amp; Environmental Research, Inc. (AER).  |<a name='7975'></font>
<font color=#447700>! |  This software may be used, copied, or redistributed as long as it is    |<a name='7976'></font>
<font color=#447700>! |  not sold and this copyright notice is reproduced on each copy made.     |<a name='7977'></font>
<font color=#447700>! |  This model is provided as is without any express or implied warranties. |<a name='7978'></font>
<font color=#447700>! |                       (http://www.rtweb.aer.com/)                        |<a name='7979'></font>
<font color=#447700>! |                                                                          |<a name='7980'></font>
<font color=#447700>!  --------------------------------------------------------------------------<a name='7981'></font>
<a name='7982'>
<font color=#447700>! ------- Modules -------<a name='7983'></font>
<a name='7984'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_VRTQDR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_59">, only: im =&gt; kind_im, rb =&gt; kind_rb<a name='7985'>
<font color=#447700>!      use parrrsw, only: ngptsw<a name='7986'></font>
<a name='7987'>
      implicit none<a name='7988'>
<a name='7989'>
      contains<a name='7990'>
<a name='7991'>
<font color=#447700>! --------------------------------------------------------------------------<a name='7992'></font>
<A NAME='VRTQDR_SW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#VRTQDR_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='7993'>
      <font color=#993300>subroutine </font><font color=#cc0000>vrtqdr_sw</font>(klev, kw, &amp; <A href='../../call_to/VRTQDR_SW.html' TARGET='index'>4</A><a name='7994'>
                           pref, prefd, ptra, ptrad, &amp;<a name='7995'>
                           pdbt, prdnd, prup, prupd, ptdbt, &amp;<a name='7996'>
                           pfd, pfu)<a name='7997'>
<font color=#447700>! --------------------------------------------------------------------------<a name='7998'></font>
 <a name='7999'>
<font color=#447700>! Purpose: This routine performs the vertical quadrature integration<a name='8000'></font>
<font color=#447700>!<a name='8001'></font>
<font color=#447700>! Interface:  *vrtqdr_sw* is called from *spcvrt_sw* and *spcvmc_sw*<a name='8002'></font>
<font color=#447700>!<a name='8003'></font>
<font color=#447700>! Modifications.<a name='8004'></font>
<font color=#447700>! <a name='8005'></font>
<font color=#447700>! Original: H. Barker<a name='8006'></font>
<font color=#447700>! Revision: Integrated with rrtmg_sw, J.-J. Morcrette, ECMWF, Oct 2002<a name='8007'></font>
<font color=#447700>! Revision: Reformatted for consistency with rrtmg_lw: MJIacono, AER, Jul 2006<a name='8008'></font>
<font color=#447700>!<a name='8009'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='8010'></font>
<a name='8011'>
<font color=#447700>! ------- Declarations -------<a name='8012'></font>
<a name='8013'>
<font color=#447700>! Input<a name='8014'></font>
<a name='8015'>
      integer(kind=im), intent (in) :: klev                   <font color=#447700>! number of model layers<a name='8016'></font>
      integer(kind=im), intent (in) :: kw                     <font color=#447700>! g-point index<a name='8017'></font>
<a name='8018'>
      real(kind=rb), intent(in) :: pref(:)                    <font color=#447700>! direct beam reflectivity<a name='8019'></font>
                                                              <font color=#447700>!   Dimensions: (nlayers+1)<a name='8020'></font>
      real(kind=rb), intent(in) :: prefd(:)                   <font color=#447700>! diffuse beam reflectivity<a name='8021'></font>
                                                              <font color=#447700>!   Dimensions: (nlayers+1)<a name='8022'></font>
      real(kind=rb), intent(in) :: ptra(:)                    <font color=#447700>! direct beam transmissivity<a name='8023'></font>
                                                              <font color=#447700>!   Dimensions: (nlayers+1)<a name='8024'></font>
      real(kind=rb), intent(in) :: ptrad(:)                   <font color=#447700>! diffuse beam transmissivity<a name='8025'></font>
                                                              <font color=#447700>!   Dimensions: (nlayers+1)<a name='8026'></font>
<a name='8027'>
      real(kind=rb), intent(in) :: pdbt(:)<a name='8028'>
                                                              <font color=#447700>!   Dimensions: (nlayers+1)<a name='8029'></font>
      real(kind=rb), intent(in) :: ptdbt(:)<a name='8030'>
                                                              <font color=#447700>!   Dimensions: (nlayers+1)<a name='8031'></font>
<a name='8032'>
      real(kind=rb), intent(inout) :: prdnd(:)<a name='8033'>
                                                              <font color=#447700>!   Dimensions: (nlayers+1)<a name='8034'></font>
      real(kind=rb), intent(inout) :: prup(:)<a name='8035'>
                                                              <font color=#447700>!   Dimensions: (nlayers+1)<a name='8036'></font>
      real(kind=rb), intent(inout) :: prupd(:)<a name='8037'>
                                                              <font color=#447700>!   Dimensions: (nlayers+1)<a name='8038'></font>
<a name='8039'>
<font color=#447700>! Output<a name='8040'></font>
      real(kind=rb), intent(out) :: pfd(:,:)                  <font color=#447700>! downwelling flux (W/m2)<a name='8041'></font>
                                                              <font color=#447700>!   Dimensions: (nlayers+1,ngptsw)<a name='8042'></font>
                                                              <font color=#447700>! unadjusted for earth/sun distance or zenith angle<a name='8043'></font>
      real(kind=rb), intent(out) :: pfu(:,:)                  <font color=#447700>! upwelling flux (W/m2)<a name='8044'></font>
                                                              <font color=#447700>!   Dimensions: (nlayers+1,ngptsw)<a name='8045'></font>
                                                              <font color=#447700>! unadjusted for earth/sun distance or zenith angle<a name='8046'></font>
<a name='8047'>
<font color=#447700>! Local<a name='8048'></font>
<a name='8049'>
      integer(kind=im) :: ikp, ikx, jk<a name='8050'>
<a name='8051'>
      real(kind=rb) :: zreflect<a name='8052'>
      real(kind=rb) :: ztdn(klev+1)  <a name='8053'>
<a name='8054'>
<font color=#447700>! Definitions<a name='8055'></font>
<font color=#447700>!<a name='8056'></font>
<font color=#447700>! pref(jk)   direct reflectance<a name='8057'></font>
<font color=#447700>! prefd(jk)  diffuse reflectance<a name='8058'></font>
<font color=#447700>! ptra(jk)   direct transmittance<a name='8059'></font>
<font color=#447700>! ptrad(jk)  diffuse transmittance<a name='8060'></font>
<font color=#447700>!<a name='8061'></font>
<font color=#447700>! pdbt(jk)   layer mean direct beam transmittance<a name='8062'></font>
<font color=#447700>! ptdbt(jk)  total direct beam transmittance at levels<a name='8063'></font>
<font color=#447700>!<a name='8064'></font>
<font color=#447700>!-----------------------------------------------------------------------------<a name='8065'></font>
                   <a name='8066'>
<font color=#447700>! Link lowest layer with surface<a name='8067'></font>
             <a name='8068'>
      zreflect = 1._rb / (1._rb - prefd(klev+1) * prefd(klev))<a name='8069'>
      prup(klev) = pref(klev) + (ptrad(klev) * &amp;<a name='8070'>
                 ((ptra(klev) - pdbt(klev)) * prefd(klev+1) + &amp;<a name='8071'>
                   pdbt(klev) * pref(klev+1))) * zreflect<a name='8072'>
      prupd(klev) = prefd(klev) + ptrad(klev) * ptrad(klev) * &amp;<a name='8073'>
                    prefd(klev+1) * zreflect<a name='8074'>
<a name='8075'>
<font color=#447700>! Pass from bottom to top <a name='8076'></font>
<a name='8077'>
      do jk = 1,klev-1<a name='8078'>
         ikp = klev+1-jk                       <a name='8079'>
         ikx = ikp-1<a name='8080'>
         zreflect = 1._rb / (1._rb -prupd(ikp) * prefd(ikx))<a name='8081'>
         prup(ikx) = pref(ikx) + (ptrad(ikx) * &amp;<a name='8082'>
                   ((ptra(ikx) - pdbt(ikx)) * prupd(ikp) + &amp;<a name='8083'>
                     pdbt(ikx) * prup(ikp))) * zreflect<a name='8084'>
         prupd(ikx) = prefd(ikx) + ptrad(ikx) * ptrad(ikx) * &amp;<a name='8085'>
                      prupd(ikp) * zreflect<a name='8086'>
      enddo<a name='8087'>
    <a name='8088'>
<font color=#447700>! Upper boundary conditions<a name='8089'></font>
<a name='8090'>
      ztdn(1) = 1._rb<a name='8091'>
      prdnd(1) = 0._rb<a name='8092'>
      ztdn(2) = ptra(1)<a name='8093'>
      prdnd(2) = prefd(1)<a name='8094'>
<a name='8095'>
<font color=#447700>! Pass from top to bottom<a name='8096'></font>
<a name='8097'>
      do jk = 2,klev<a name='8098'>
         ikp = jk+1<a name='8099'>
         zreflect = 1._rb / (1._rb - prefd(jk) * prdnd(jk))<a name='8100'>
         ztdn(ikp) = ptdbt(jk) * ptra(jk) + &amp;<a name='8101'>
                    (ptrad(jk) * ((ztdn(jk) - ptdbt(jk)) + &amp;<a name='8102'>
                     ptdbt(jk) * pref(jk) * prdnd(jk))) * zreflect<a name='8103'>
         prdnd(ikp) = prefd(jk) + ptrad(jk) * ptrad(jk) * &amp;<a name='8104'>
                      prdnd(jk) * zreflect<a name='8105'>
      enddo<a name='8106'>
    <a name='8107'>
<font color=#447700>! Up and down-welling fluxes at levels<a name='8108'></font>
<a name='8109'>
      do jk = 1,klev+1<a name='8110'>
         zreflect = 1._rb / (1._rb - prdnd(jk) * prupd(jk))<a name='8111'>
         pfu(jk,kw) = (ptdbt(jk) * prup(jk) + &amp;<a name='8112'>
                      (ztdn(jk) - ptdbt(jk)) * prupd(jk)) * zreflect<a name='8113'>
         pfd(jk,kw) = ptdbt(jk) + (ztdn(jk) - ptdbt(jk)+ &amp;<a name='8114'>
                      ptdbt(jk) * prup(jk) * prdnd(jk)) * zreflect<a name='8115'>
      enddo<a name='8116'>
<a name='8117'>
      end subroutine vrtqdr_sw<a name='8118'>
<a name='8119'>
      end module rrtmg_sw_vrtqdr<a name='8120'>
<a name='8121'>
<font color=#447700>!     path:      $Source: /cvsroot/NWP/WRFV3/phys/module_ra_rrtmg_sw.F,v $<a name='8122'></font>
<font color=#447700>!     author:    $Author: trn $<a name='8123'></font>
<font color=#447700>!     revision:  $Revision: 1.3 $<a name='8124'></font>
<font color=#447700>!     created:   $Date: 2009/04/16 19:54:22 $<a name='8125'></font>
<a name='8126'>
<A NAME='RRTMG_SW_SPCVMC'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SPCVMC' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='8127'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_spcvmc</font> <A href='../../call_to/RRTMG_SW_SPCVMC.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_SPCVMC.html' TARGET='index'>8</A><a name='8128'>
<a name='8129'>
<font color=#447700>!  --------------------------------------------------------------------------<a name='8130'></font>
<font color=#447700>! |                                                                          |<a name='8131'></font>
<font color=#447700>! |  Copyright 2002-2008, Atmospheric &amp; Environmental Research, Inc. (AER).  |<a name='8132'></font>
<font color=#447700>! |  This software may be used, copied, or redistributed as long as it is    |<a name='8133'></font>
<font color=#447700>! |  not sold and this copyright notice is reproduced on each copy made.     |<a name='8134'></font>
<font color=#447700>! |  This model is provided as is without any express or implied warranties. |<a name='8135'></font>
<font color=#447700>! |                       (http://www.rtweb.aer.com/)                        |<a name='8136'></font>
<font color=#447700>! |                                                                          |<a name='8137'></font>
<font color=#447700>!  --------------------------------------------------------------------------<a name='8138'></font>
<a name='8139'>
<font color=#447700>! ------- Modules -------<a name='8140'></font>
<a name='8141'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SPCVMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_60">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='8142'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SPCVMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_35">, only : nbndsw, ngptsw, mxmol, jpband<a name='8143'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_TBL'>rrsw_tbl</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SPCVMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_TBL_3">, only : tblint, bpade, od_lo, exp_tbl<a name='8144'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_VSN'>rrsw_vsn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SPCVMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_8">, only : hvrspc, hnamspc<a name='8145'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_WVN'>rrsw_wvn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SPCVMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_5">, only : ngc, ngs<a name='8146'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_REFTRA'>rrtmg_sw_reftra</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SPCVMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_REFTRA_1">, only: reftra_sw<a name='8147'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_TAUMOL'>rrtmg_sw_taumol</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SPCVMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_TAUMOL_1">, only: taumol_sw<a name='8148'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_VRTQDR'>rrtmg_sw_vrtqdr</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SPCVMC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_VRTQDR_1">, only: vrtqdr_sw<a name='8149'>
<a name='8150'>
      implicit none<a name='8151'>
<a name='8152'>
      contains<a name='8153'>
<a name='8154'>
<font color=#447700>! ---------------------------------------------------------------------------<a name='8155'></font>
<A NAME='SPCVMC_SW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SPCVMC_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='8156'>
      <font color=#993300>subroutine </font><font color=#cc0000>spcvmc_sw</font> &amp; <A href='../../call_to/SPCVMC_SW.html' TARGET='index'>2</A>,<A href='../../call_from/SPCVMC_SW.html' TARGET='index'>10</A><a name='8157'>
            (nlayers, istart, iend, icpr, iout, &amp;<a name='8158'>
             pavel, tavel, pz, tz, tbound, palbd, palbp, &amp;<a name='8159'>
             pcldfmc, ptaucmc, pasycmc, pomgcmc, ptaormc, &amp;<a name='8160'>
             ptaua, pasya, pomga, prmu0, coldry, wkl, adjflux, &amp;<a name='8161'>
             laytrop, layswtch, laylow, jp, jt, jt1, &amp;<a name='8162'>
             co2mult, colch4, colco2, colh2o, colmol, coln2o, colo2, colo3, &amp;<a name='8163'>
             fac00, fac01, fac10, fac11, &amp;<a name='8164'>
             selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='8165'>
             pbbfd, pbbfu, pbbcd, pbbcu, puvfd, puvcd, pnifd, pnicd, &amp;<a name='8166'>
             pbbfddir, pbbcddir, puvfddir, puvcddir, pnifddir, pnicddir)<a name='8167'>
<font color=#447700>! ---------------------------------------------------------------------------<a name='8168'></font>
<font color=#447700>!<a name='8169'></font>
<font color=#447700>! Purpose: Contains spectral loop to compute the shortwave radiative fluxes, <a name='8170'></font>
<font color=#447700>!          using the two-stream method of H. Barker and McICA, the Monte-Carlo<a name='8171'></font>
<font color=#447700>!          Independent Column Approximation, for the representation of <a name='8172'></font>
<font color=#447700>!          sub-grid cloud variability (i.e. cloud overlap).<a name='8173'></font>
<font color=#447700>!<a name='8174'></font>
<font color=#447700>! Interface:  *spcvmc_sw* is called from *rrtmg_sw.F90* or rrtmg_sw.1col.F90*<a name='8175'></font>
<font color=#447700>!<a name='8176'></font>
<font color=#447700>! Method:<a name='8177'></font>
<font color=#447700>!    Adapted from two-stream model of H. Barker;<a name='8178'></font>
<font color=#447700>!    Two-stream model options (selected with kmodts in rrtmg_sw_reftra.F90):<a name='8179'></font>
<font color=#447700>!        1: Eddington, 2: PIFM, Zdunkowski et al., 3: discret ordinates<a name='8180'></font>
<font color=#447700>!<a name='8181'></font>
<font color=#447700>! Modifications:<a name='8182'></font>
<font color=#447700>!<a name='8183'></font>
<font color=#447700>! Original: H. Barker<a name='8184'></font>
<font color=#447700>! Revision: Merge with RRTMG_SW: J.-J.Morcrette, ECMWF, Feb 2003<a name='8185'></font>
<font color=#447700>! Revision: Add adjustment for Earth/Sun distance : MJIacono, AER, Oct 2003<a name='8186'></font>
<font color=#447700>! Revision: Bug fix for use of PALBP and PALBD: MJIacono, AER, Nov 2003<a name='8187'></font>
<font color=#447700>! Revision: Bug fix to apply delta scaling to clear sky: AER, Dec 2004<a name='8188'></font>
<font color=#447700>! Revision: Code modified so that delta scaling is not done in cloudy profiles<a name='8189'></font>
<font color=#447700>!           if routine cldprop is used; delta scaling can be applied by swithcing<a name='8190'></font>
<font color=#447700>!           code below if cldprop is not used to get cloud properties. <a name='8191'></font>
<font color=#447700>!           AER, Jan 2005<a name='8192'></font>
<font color=#447700>! Revision: Modified to use McICA: MJIacono, AER, Nov 2005<a name='8193'></font>
<font color=#447700>! Revision: Uniform formatting for RRTMG: MJIacono, AER, Jul 2006 <a name='8194'></font>
<font color=#447700>! Revision: Use exponential lookup table for transmittance: MJIacono, AER, <a name='8195'></font>
<font color=#447700>!           Aug 2007 <a name='8196'></font>
<font color=#447700>!<a name='8197'></font>
<font color=#447700>! ------------------------------------------------------------------<a name='8198'></font>
<a name='8199'>
<font color=#447700>! ------- Declarations ------<a name='8200'></font>
<a name='8201'>
<font color=#447700>! ------- Input -------<a name='8202'></font>
<a name='8203'>
      integer(kind=im), intent(in) :: nlayers<a name='8204'>
      integer(kind=im), intent(in) :: istart<a name='8205'>
      integer(kind=im), intent(in) :: iend<a name='8206'>
      integer(kind=im), intent(in) :: icpr<a name='8207'>
      integer(kind=im), intent(in) :: iout<a name='8208'>
      integer(kind=im), intent(in) :: laytrop<a name='8209'>
      integer(kind=im), intent(in) :: layswtch<a name='8210'>
      integer(kind=im), intent(in) :: laylow<a name='8211'>
<a name='8212'>
      integer(kind=im), intent(in) :: indfor(:)<a name='8213'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8214'></font>
      integer(kind=im), intent(in) :: indself(:)<a name='8215'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8216'></font>
      integer(kind=im), intent(in) :: jp(:)<a name='8217'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8218'></font>
      integer(kind=im), intent(in) :: jt(:)<a name='8219'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8220'></font>
      integer(kind=im), intent(in) :: jt1(:)<a name='8221'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8222'></font>
<a name='8223'>
      real(kind=rb), intent(in) :: pavel(:)                    <font color=#447700>! layer pressure (hPa, mb) <a name='8224'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8225'></font>
      real(kind=rb), intent(in) :: tavel(:)                    <font color=#447700>! layer temperature (K)<a name='8226'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8227'></font>
      real(kind=rb), intent(in) :: pz(0:)                      <font color=#447700>! level (interface) pressure (hPa, mb)<a name='8228'></font>
                                                               <font color=#447700>!   Dimensions: (0:nlayers)<a name='8229'></font>
      real(kind=rb), intent(in) :: tz(0:)                      <font color=#447700>! level temperatures (hPa, mb)<a name='8230'></font>
                                                               <font color=#447700>!   Dimensions: (0:nlayers)<a name='8231'></font>
      real(kind=rb), intent(in) :: tbound                      <font color=#447700>! surface temperature (K)<a name='8232'></font>
      real(kind=rb), intent(in) :: wkl(:,:)                    <font color=#447700>! molecular amounts (mol/cm2) <a name='8233'></font>
                                                               <font color=#447700>!   Dimensions: (mxmol,nlayers)<a name='8234'></font>
      real(kind=rb), intent(in) :: coldry(:)                   <font color=#447700>! dry air column density (mol/cm2)<a name='8235'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8236'></font>
      real(kind=rb), intent(in) :: colmol(:)<a name='8237'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8238'></font>
      real(kind=rb), intent(in) :: adjflux(:)                  <font color=#447700>! Earth/Sun distance adjustment<a name='8239'></font>
                                                               <font color=#447700>!   Dimensions: (jpband)<a name='8240'></font>
<a name='8241'>
      real(kind=rb), intent(in) :: palbd(:)                    <font color=#447700>! surface albedo (diffuse)<a name='8242'></font>
                                                               <font color=#447700>!   Dimensions: (nbndsw)<a name='8243'></font>
      real(kind=rb), intent(in) :: palbp(:)                    <font color=#447700>! surface albedo (direct)<a name='8244'></font>
                                                               <font color=#447700>!   Dimensions: (nbndsw)<a name='8245'></font>
      real(kind=rb), intent(in) :: prmu0                       <font color=#447700>! cosine of solar zenith angle<a name='8246'></font>
      real(kind=rb), intent(in) :: pcldfmc(:,:)                <font color=#447700>! cloud fraction [mcica]<a name='8247'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers,ngptsw)<a name='8248'></font>
      real(kind=rb), intent(in) :: ptaucmc(:,:)                <font color=#447700>! cloud optical depth [mcica]<a name='8249'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers,ngptsw)<a name='8250'></font>
      real(kind=rb), intent(in) :: pasycmc(:,:)                <font color=#447700>! cloud asymmetry parameter [mcica]<a name='8251'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers,ngptsw)<a name='8252'></font>
      real(kind=rb), intent(in) :: pomgcmc(:,:)                <font color=#447700>! cloud single scattering albedo [mcica]<a name='8253'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers,ngptsw)<a name='8254'></font>
      real(kind=rb), intent(in) :: ptaormc(:,:)                <font color=#447700>! cloud optical depth, non-delta scaled [mcica]<a name='8255'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers,ngptsw)<a name='8256'></font>
      real(kind=rb), intent(in) :: ptaua(:,:)                  <font color=#447700>! aerosol optical depth<a name='8257'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers,nbndsw)<a name='8258'></font>
      real(kind=rb), intent(in) :: pasya(:,:)                  <font color=#447700>! aerosol asymmetry parameter<a name='8259'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers,nbndsw)<a name='8260'></font>
      real(kind=rb), intent(in) :: pomga(:,:)                  <font color=#447700>! aerosol single scattering albedo<a name='8261'></font>
                                                               <font color=#447700>!   Dimensions: (nlayers,nbndsw)<a name='8262'></font>
<a name='8263'>
      real(kind=rb), intent(in) :: colh2o(:)<a name='8264'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8265'></font>
      real(kind=rb), intent(in) :: colco2(:)<a name='8266'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8267'></font>
      real(kind=rb), intent(in) :: colch4(:)<a name='8268'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8269'></font>
      real(kind=rb), intent(in) :: co2mult(:)<a name='8270'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8271'></font>
      real(kind=rb), intent(in) :: colo3(:)<a name='8272'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8273'></font>
      real(kind=rb), intent(in) :: colo2(:)<a name='8274'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8275'></font>
      real(kind=rb), intent(in) :: coln2o(:)<a name='8276'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8277'></font>
<a name='8278'>
      real(kind=rb), intent(in) :: forfac(:)<a name='8279'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8280'></font>
      real(kind=rb), intent(in) :: forfrac(:)<a name='8281'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8282'></font>
      real(kind=rb), intent(in) :: selffac(:)<a name='8283'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8284'></font>
      real(kind=rb), intent(in) :: selffrac(:)<a name='8285'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8286'></font>
      real(kind=rb), intent(in) :: fac00(:)<a name='8287'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8288'></font>
      real(kind=rb), intent(in) :: fac01(:)<a name='8289'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8290'></font>
      real(kind=rb), intent(in) :: fac10(:)<a name='8291'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8292'></font>
      real(kind=rb), intent(in) :: fac11(:)<a name='8293'>
                                                               <font color=#447700>!   Dimensions: (nlayers)<a name='8294'></font>
<a name='8295'>
<font color=#447700>! ------- Output -------<a name='8296'></font>
                                                               <font color=#447700>!   All Dimensions: (nlayers+1)<a name='8297'></font>
      real(kind=rb), intent(out) :: pbbcd(:)<a name='8298'>
      real(kind=rb), intent(out) :: pbbcu(:)<a name='8299'>
      real(kind=rb), intent(out) :: pbbfd(:)<a name='8300'>
      real(kind=rb), intent(out) :: pbbfu(:)<a name='8301'>
      real(kind=rb), intent(out) :: pbbfddir(:)<a name='8302'>
      real(kind=rb), intent(out) :: pbbcddir(:)<a name='8303'>
<a name='8304'>
      real(kind=rb), intent(out) :: puvcd(:)<a name='8305'>
      real(kind=rb), intent(out) :: puvfd(:)<a name='8306'>
      real(kind=rb), intent(out) :: puvcddir(:)<a name='8307'>
      real(kind=rb), intent(out) :: puvfddir(:)<a name='8308'>
<a name='8309'>
      real(kind=rb), intent(out) :: pnicd(:)<a name='8310'>
      real(kind=rb), intent(out) :: pnifd(:)<a name='8311'>
      real(kind=rb), intent(out) :: pnicddir(:)<a name='8312'>
      real(kind=rb), intent(out) :: pnifddir(:)<a name='8313'>
<a name='8314'>
<font color=#447700>! Output - inactive                                            !   All Dimensions: (nlayers+1)<a name='8315'></font>
<font color=#447700>!      real(kind=rb), intent(out) :: puvcu(:)<a name='8316'></font>
<font color=#447700>!      real(kind=rb), intent(out) :: puvfu(:)<a name='8317'></font>
<font color=#447700>!      real(kind=rb), intent(out) :: pnicu(:)<a name='8318'></font>
<font color=#447700>!      real(kind=rb), intent(out) :: pnifu(:)<a name='8319'></font>
<font color=#447700>!      real(kind=rb), intent(out) :: pvscd(:)<a name='8320'></font>
<font color=#447700>!      real(kind=rb), intent(out) :: pvscu(:)<a name='8321'></font>
<font color=#447700>!      real(kind=rb), intent(out) :: pvsfd(:)<a name='8322'></font>
<font color=#447700>!      real(kind=rb), intent(out) :: pvsfu(:)<a name='8323'></font>
<a name='8324'>
<font color=#447700>! ------- Local -------<a name='8325'></font>
<a name='8326'>
      logical :: lrtchkclr(nlayers),lrtchkcld(nlayers)<a name='8327'>
<a name='8328'>
      integer(kind=im)  :: klev<a name='8329'>
      integer(kind=im) :: ib1, ib2, ibm, igt, ikl, ikp, ikx<a name='8330'>
      integer(kind=im) :: iw, jb, jg, jl, jk<a name='8331'>
<font color=#447700>!      integer(kind=im), parameter :: nuv = ?? <a name='8332'></font>
<font color=#447700>!      integer(kind=im), parameter :: nvs = ?? <a name='8333'></font>
      integer(kind=im) :: itind<a name='8334'>
<a name='8335'>
      real(kind=rb) :: tblind, ze1<a name='8336'>
      real(kind=rb) :: zclear, zcloud<a name='8337'>
      real(kind=rb) :: zdbt(nlayers+1), zdbt_nodel(nlayers+1)<a name='8338'>
      real(kind=rb) :: zgc(nlayers), zgcc(nlayers), zgco(nlayers)<a name='8339'>
      real(kind=rb) :: zomc(nlayers), zomcc(nlayers), zomco(nlayers)<a name='8340'>
      real(kind=rb) :: zrdnd(nlayers+1), zrdndc(nlayers+1)<a name='8341'>
      real(kind=rb) :: zref(nlayers+1), zrefc(nlayers+1), zrefo(nlayers+1)<a name='8342'>
      real(kind=rb) :: zrefd(nlayers+1), zrefdc(nlayers+1), zrefdo(nlayers+1)<a name='8343'>
      real(kind=rb) :: zrup(nlayers+1), zrupd(nlayers+1)<a name='8344'>
      real(kind=rb) :: zrupc(nlayers+1), zrupdc(nlayers+1)<a name='8345'>
      real(kind=rb) :: zs1(nlayers+1)<a name='8346'>
      real(kind=rb) :: ztauc(nlayers), ztauo(nlayers)<a name='8347'>
      real(kind=rb) :: ztdn(nlayers+1), ztdnd(nlayers+1), ztdbt(nlayers+1)<a name='8348'>
      real(kind=rb) :: ztoc(nlayers), ztor(nlayers)<a name='8349'>
      real(kind=rb) :: ztra(nlayers+1), ztrac(nlayers+1), ztrao(nlayers+1)<a name='8350'>
      real(kind=rb) :: ztrad(nlayers+1), ztradc(nlayers+1), ztrado(nlayers+1)<a name='8351'>
      real(kind=rb) :: zdbtc(nlayers+1), ztdbtc(nlayers+1)<a name='8352'>
      real(kind=rb) :: zincflx(ngptsw), zdbtc_nodel(nlayers+1) <a name='8353'>
      real(kind=rb) :: ztdbt_nodel(nlayers+1), ztdbtc_nodel(nlayers+1)<a name='8354'>
<a name='8355'>
      real(kind=rb) :: zdbtmc, zdbtmo, zf, zgw, zreflect<a name='8356'>
      real(kind=rb) :: zwf, tauorig, repclc<a name='8357'>
<font color=#447700>!     real(kind=rb) :: zincflux                                   ! inactive<a name='8358'></font>
<a name='8359'>
<font color=#447700>! Arrays from rrtmg_sw_taumoln routines<a name='8360'></font>
<a name='8361'>
<font color=#447700>!      real(kind=rb) :: ztaug(nlayers,16), ztaur(nlayers,16)<a name='8362'></font>
<font color=#447700>!      real(kind=rb) :: zsflxzen(16)<a name='8363'></font>
      real(kind=rb) :: ztaug(nlayers,ngptsw), ztaur(nlayers,ngptsw)<a name='8364'>
      real(kind=rb) :: zsflxzen(ngptsw)<a name='8365'>
<a name='8366'>
<font color=#447700>! Arrays from rrtmg_sw_vrtqdr routine<a name='8367'></font>
<a name='8368'>
      real(kind=rb) :: zcd(nlayers+1,ngptsw), zcu(nlayers+1,ngptsw)<a name='8369'>
      real(kind=rb) :: zfd(nlayers+1,ngptsw), zfu(nlayers+1,ngptsw)<a name='8370'>
<a name='8371'>
<font color=#447700>! Inactive arrays<a name='8372'></font>
<font color=#447700>!     real(kind=rb) :: zbbcd(nlayers+1), zbbcu(nlayers+1)<a name='8373'></font>
<font color=#447700>!     real(kind=rb) :: zbbfd(nlayers+1), zbbfu(nlayers+1)<a name='8374'></font>
<font color=#447700>!     real(kind=rb) :: zbbfddir(nlayers+1), zbbcddir(nlayers+1)<a name='8375'></font>
<a name='8376'>
<font color=#447700>! ------------------------------------------------------------------<a name='8377'></font>
<a name='8378'>
<font color=#447700>! Initializations<a name='8379'></font>
<a name='8380'>
      ib1 = istart<a name='8381'>
      ib2 = iend<a name='8382'>
      klev = nlayers<a name='8383'>
      iw = 0<a name='8384'>
      repclc = 1.e-12_rb<a name='8385'>
<font color=#447700>!      zincflux = 0.0_rb<a name='8386'></font>
<a name='8387'>
      do jk=1,klev+1<a name='8388'>
         pbbcd(jk)=0._rb<a name='8389'>
         pbbcu(jk)=0._rb<a name='8390'>
         pbbfd(jk)=0._rb<a name='8391'>
         pbbfu(jk)=0._rb<a name='8392'>
         pbbcddir(jk)=0._rb<a name='8393'>
         pbbfddir(jk)=0._rb<a name='8394'>
         puvcd(jk)=0._rb<a name='8395'>
         puvfd(jk)=0._rb<a name='8396'>
         puvcddir(jk)=0._rb<a name='8397'>
         puvfddir(jk)=0._rb<a name='8398'>
         pnicd(jk)=0._rb<a name='8399'>
         pnifd(jk)=0._rb<a name='8400'>
         pnicddir(jk)=0._rb<a name='8401'>
         pnifddir(jk)=0._rb<a name='8402'>
      enddo<a name='8403'>
<a name='8404'>
<a name='8405'>
<font color=#447700>! Calculate the optical depths for gaseous absorption and Rayleigh scattering<a name='8406'></font>
<a name='8407'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW'>taumol_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL_SW_1">(klev, &amp;<a name='8408'>
                     colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='8409'>
                     laytrop, jp, jt, jt1, &amp;<a name='8410'>
                     fac00, fac01, fac10, fac11, &amp;<a name='8411'>
                     selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='8412'>
                     zsflxzen, ztaug, ztaur)<a name='8413'>
<a name='8414'>
<font color=#447700>! Top of shortwave spectral band loop, jb = 16 -&gt; 29; ibm = 1 -&gt; 14<a name='8415'></font>
<a name='8416'>
      do jb = ib1, ib2<a name='8417'>
         ibm = jb-15<a name='8418'>
         igt = ngc(ibm)<a name='8419'>
<a name='8420'>
<font color=#447700>! Reinitialize g-point counter for each band if output for each band is requested.<a name='8421'></font>
         if (iout.gt.0.and.ibm.ge.2) iw = ngs(ibm-1)<a name='8422'>
<a name='8423'>
<font color=#447700>!        do jk=1,klev+1<a name='8424'></font>
<font color=#447700>!           zbbcd(jk)=0.0_rb<a name='8425'></font>
<font color=#447700>!           zbbcu(jk)=0.0_rb<a name='8426'></font>
<font color=#447700>!           zbbfd(jk)=0.0_rb<a name='8427'></font>
<font color=#447700>!           zbbfu(jk)=0.0_rb<a name='8428'></font>
<font color=#447700>!        enddo<a name='8429'></font>
<a name='8430'>
<font color=#447700>! Top of g-point interval loop within each band (iw is cumulative counter) <a name='8431'></font>
         do jg = 1,igt<a name='8432'>
            iw = iw+1<a name='8433'>
<a name='8434'>
<font color=#447700>! Apply adjustment for correct Earth/Sun distance and zenith angle to incoming solar flux<a name='8435'></font>
            zincflx(iw) = adjflux(jb) * zsflxzen(iw) * prmu0<a name='8436'>
<font color=#447700>!             zincflux = zincflux + adjflux(jb) * zsflxzen(iw) * prmu0           ! inactive<a name='8437'></font>
<a name='8438'>
<font color=#447700>! Compute layer reflectances and transmittances for direct and diffuse sources, <a name='8439'></font>
<font color=#447700>! first clear then cloudy<a name='8440'></font>
<a name='8441'>
<font color=#447700>! zrefc(jk)  direct albedo for clear<a name='8442'></font>
<font color=#447700>! zrefo(jk)  direct albedo for cloud<a name='8443'></font>
<font color=#447700>! zrefdc(jk) diffuse albedo for clear<a name='8444'></font>
<font color=#447700>! zrefdo(jk) diffuse albedo for cloud<a name='8445'></font>
<font color=#447700>! ztrac(jk)  direct transmittance for clear<a name='8446'></font>
<font color=#447700>! ztrao(jk)  direct transmittance for cloudy<a name='8447'></font>
<font color=#447700>! ztradc(jk) diffuse transmittance for clear<a name='8448'></font>
<font color=#447700>! ztrado(jk) diffuse transmittance for cloudy<a name='8449'></font>
<font color=#447700>!  <a name='8450'></font>
<font color=#447700>! zref(jk)   direct reflectance<a name='8451'></font>
<font color=#447700>! zrefd(jk)  diffuse reflectance<a name='8452'></font>
<font color=#447700>! ztra(jk)   direct transmittance<a name='8453'></font>
<font color=#447700>! ztrad(jk)  diffuse transmittance<a name='8454'></font>
<font color=#447700>!<a name='8455'></font>
<font color=#447700>! zdbtc(jk)  clear direct beam transmittance<a name='8456'></font>
<font color=#447700>! zdbto(jk)  cloudy direct beam transmittance<a name='8457'></font>
<font color=#447700>! zdbt(jk)   layer mean direct beam transmittance<a name='8458'></font>
<font color=#447700>! ztdbt(jk)  total direct beam transmittance at levels<a name='8459'></font>
<a name='8460'>
<font color=#447700>! Clear-sky    <a name='8461'></font>
<font color=#447700>!   TOA direct beam    <a name='8462'></font>
            ztdbtc(1)=1.0_rb<a name='8463'>
            ztdbtc_nodel(1)=1.0_rb<a name='8464'>
<font color=#447700>!   Surface values<a name='8465'></font>
            zdbtc(klev+1) =0.0_rb<a name='8466'>
            ztrac(klev+1) =0.0_rb<a name='8467'>
            ztradc(klev+1)=0.0_rb<a name='8468'>
            zrefc(klev+1) =palbp(ibm)<a name='8469'>
            zrefdc(klev+1)=palbd(ibm)<a name='8470'>
            zrupc(klev+1) =palbp(ibm)<a name='8471'>
            zrupdc(klev+1)=palbd(ibm)<a name='8472'>
           <a name='8473'>
<font color=#447700>! Total sky    <a name='8474'></font>
<font color=#447700>!   TOA direct beam    <a name='8475'></font>
            ztdbt(1)=1.0_rb<a name='8476'>
            ztdbt_nodel(1)=1.0_rb<a name='8477'>
<font color=#447700>!   Surface values<a name='8478'></font>
            zdbt(klev+1) =0.0_rb<a name='8479'>
            ztra(klev+1) =0.0_rb<a name='8480'>
            ztrad(klev+1)=0.0_rb<a name='8481'>
            zref(klev+1) =palbp(ibm)<a name='8482'>
            zrefd(klev+1)=palbd(ibm)<a name='8483'>
            zrup(klev+1) =palbp(ibm)<a name='8484'>
            zrupd(klev+1)=palbd(ibm)<a name='8485'>
    <a name='8486'>
<font color=#447700>! Top of layer loop<a name='8487'></font>
            do jk=1,klev<a name='8488'>
<a name='8489'>
<font color=#447700>! Note: two-stream calculations proceed from top to bottom; <a name='8490'></font>
<font color=#447700>!   RRTMG_SW quantities are given bottom to top and are reversed here<a name='8491'></font>
<a name='8492'>
               ikl=klev+1-jk<a name='8493'>
<a name='8494'>
<font color=#447700>! Set logical flag to do REFTRA calculation<a name='8495'></font>
<font color=#447700>!   Do REFTRA for all clear layers<a name='8496'></font>
               lrtchkclr(jk)=.true.<a name='8497'>
<a name='8498'>
<font color=#447700>!   Do REFTRA only for cloudy layers in profile, since already done for clear layers<a name='8499'></font>
               lrtchkcld(jk)=.false.<a name='8500'>
               lrtchkcld(jk)=(pcldfmc(ikl,iw) &gt; repclc)<a name='8501'>
<a name='8502'>
<font color=#447700>! Clear-sky optical parameters - this section inactive     <a name='8503'></font>
<font color=#447700>!   Original<a name='8504'></font>
<font color=#447700>!               ztauc(jk) = ztaur(ikl,iw) + ztaug(ikl,iw)<a name='8505'></font>
<font color=#447700>!               zomcc(jk) = ztaur(ikl,iw) / ztauc(jk)<a name='8506'></font>
<font color=#447700>!               zgcc(jk) = 0.0001_rb<a name='8507'></font>
<font color=#447700>!   Total sky optical parameters        <a name='8508'></font>
<font color=#447700>!               ztauo(jk) = ztaur(ikl,iw) + ztaug(ikl,iw) + ptaucmc(ikl,iw)<a name='8509'></font>
<font color=#447700>!               zomco(jk) = ptaucmc(ikl,iw) * pomgcmc(ikl,iw) + ztaur(ikl,iw)<a name='8510'></font>
<font color=#447700>!               zgco (jk) = (ptaucmc(ikl,iw) * pomgcmc(ikl,iw) * pasycmc(ikl,iw) + &amp;<a name='8511'></font>
<font color=#447700>!                           ztaur(ikl,iw) * 0.0001_rb) / zomco(jk)<a name='8512'></font>
<font color=#447700>!               zomco(jk) = zomco(jk) / ztauo(jk)<a name='8513'></font>
<a name='8514'>
<font color=#447700>! Clear-sky optical parameters including aerosols<a name='8515'></font>
               ztauc(jk) = ztaur(ikl,iw) + ztaug(ikl,iw) + ptaua(ikl,ibm)<a name='8516'>
               zomcc(jk) = ztaur(ikl,iw) * 1.0_rb + ptaua(ikl,ibm) * pomga(ikl,ibm)<a name='8517'>
               zgcc(jk) = pasya(ikl,ibm) * pomga(ikl,ibm) * ptaua(ikl,ibm) / zomcc(jk)<a name='8518'>
               zomcc(jk) = zomcc(jk) / ztauc(jk)<a name='8519'>
<a name='8520'>
<font color=#447700>! Pre-delta-scaling clear and cloudy direct beam transmittance (must use 'orig', unscaled cloud OD)       <a name='8521'></font>
<font color=#447700>!   \/\/\/ This block of code is only needed for direct beam calculation<a name='8522'></font>
<font color=#447700>!     <a name='8523'></font>
               zclear = 1.0_rb - pcldfmc(ikl,iw)<a name='8524'>
               zcloud = pcldfmc(ikl,iw)<a name='8525'>
<a name='8526'>
<font color=#447700>! Clear<a name='8527'></font>
<font color=#447700>!                zdbtmc = exp(-ztauc(jk) / prmu0)<a name='8528'></font>
<a name='8529'>
<font color=#447700>! Use exponential lookup table for transmittance, or expansion of <a name='8530'></font>
<font color=#447700>! exponential for low tau<a name='8531'></font>
               ze1 = ztauc(jk) / prmu0<a name='8532'>
               if (ze1 .le. od_lo) then<a name='8533'>
                  zdbtmc = 1._rb - ze1 + 0.5_rb * ze1 * ze1<a name='8534'>
               else <a name='8535'>
                  tblind = ze1 / (bpade + ze1)<a name='8536'>
                  itind = tblint * tblind + 0.5_rb<a name='8537'>
                  zdbtmc = exp_tbl(itind)<a name='8538'>
               endif<a name='8539'>
<a name='8540'>
               zdbtc_nodel(jk) = zdbtmc<a name='8541'>
               ztdbtc_nodel(jk+1) = zdbtc_nodel(jk) * ztdbtc_nodel(jk)<a name='8542'>
<a name='8543'>
<font color=#447700>! Clear + Cloud<a name='8544'></font>
               tauorig = ztauc(jk) + ptaormc(ikl,iw)<a name='8545'>
<font color=#447700>!                zdbtmo = exp(-tauorig / prmu0)<a name='8546'></font>
<a name='8547'>
<font color=#447700>! Use exponential lookup table for transmittance, or expansion of <a name='8548'></font>
<font color=#447700>! exponential for low tau<a name='8549'></font>
               ze1 = tauorig / prmu0<a name='8550'>
               if (ze1 .le. od_lo) then<a name='8551'>
                  zdbtmo = 1._rb - ze1 + 0.5_rb * ze1 * ze1<a name='8552'>
               else<a name='8553'>
                  tblind = ze1 / (bpade + ze1)<a name='8554'>
                  itind = tblint * tblind + 0.5_rb<a name='8555'>
                  zdbtmo = exp_tbl(itind)<a name='8556'>
               endif<a name='8557'>
<a name='8558'>
               zdbt_nodel(jk) = zclear*zdbtmc + zcloud*zdbtmo<a name='8559'>
               ztdbt_nodel(jk+1) = zdbt_nodel(jk) * ztdbt_nodel(jk)<a name='8560'>
<font color=#447700>!   /\/\/\ Above code only needed for direct beam calculation<a name='8561'></font>
<a name='8562'>
<a name='8563'>
<font color=#447700>! Delta scaling - clear   <a name='8564'></font>
               zf = zgcc(jk) * zgcc(jk)<a name='8565'>
               zwf = zomcc(jk) * zf<a name='8566'>
               ztauc(jk) = (1.0_rb - zwf) * ztauc(jk)<a name='8567'>
               zomcc(jk) = (zomcc(jk) - zwf) / (1.0_rb - zwf)<a name='8568'>
               zgcc (jk) = (zgcc(jk) - zf) / (1.0_rb - zf)<a name='8569'>
<a name='8570'>
<font color=#447700>! Total sky optical parameters (cloud properties already delta-scaled)<a name='8571'></font>
<font color=#447700>!   Use this code if cloud properties are derived in rrtmg_sw_cldprop       <a name='8572'></font>
               if (icpr .ge. 1) then<a name='8573'>
                  ztauo(jk) = ztauc(jk) + ptaucmc(ikl,iw)<a name='8574'>
                  zomco(jk) = ztauc(jk) * zomcc(jk) + ptaucmc(ikl,iw) * pomgcmc(ikl,iw) <a name='8575'>
                  zgco (jk) = (ptaucmc(ikl,iw) * pomgcmc(ikl,iw) * pasycmc(ikl,iw) + &amp;<a name='8576'>
                              ztauc(jk) * zomcc(jk) * zgcc(jk)) / zomco(jk)<a name='8577'>
                  zomco(jk) = zomco(jk) / ztauo(jk)<a name='8578'>
<a name='8579'>
<font color=#447700>! Total sky optical parameters (if cloud properties not delta scaled)<a name='8580'></font>
<font color=#447700>!   Use this code if cloud properties are not derived in rrtmg_sw_cldprop       <a name='8581'></font>
               elseif (icpr .eq. 0) then<a name='8582'>
                  ztauo(jk) = ztaur(ikl,iw) + ztaug(ikl,iw) + ptaua(ikl,ibm) + ptaucmc(ikl,iw)<a name='8583'>
                  zomco(jk) = ptaua(ikl,ibm) * pomga(ikl,ibm) + ptaucmc(ikl,iw) * pomgcmc(ikl,iw) + &amp;<a name='8584'>
                              ztaur(ikl,iw) * 1.0_rb<a name='8585'>
                  zgco (jk) = (ptaucmc(ikl,iw) * pomgcmc(ikl,iw) * pasycmc(ikl,iw) + &amp;<a name='8586'>
                              ptaua(ikl,ibm)*pomga(ikl,ibm)*pasya(ikl,ibm)) / zomco(jk)<a name='8587'>
                  zomco(jk) = zomco(jk) / ztauo(jk)<a name='8588'>
<a name='8589'>
<font color=#447700>! Delta scaling - clouds <a name='8590'></font>
<font color=#447700>!   Use only if subroutine rrtmg_sw_cldprop is not used to get cloud properties and to apply delta scaling<a name='8591'></font>
                  zf = zgco(jk) * zgco(jk)<a name='8592'>
                  zwf = zomco(jk) * zf<a name='8593'>
                  ztauo(jk) = (1._rb - zwf) * ztauo(jk)<a name='8594'>
                  zomco(jk) = (zomco(jk) - zwf) / (1.0_rb - zwf)<a name='8595'>
                  zgco (jk) = (zgco(jk) - zf) / (1.0_rb - zf)<a name='8596'>
               endif <a name='8597'>
<a name='8598'>
<font color=#447700>! End of layer loop<a name='8599'></font>
            enddo    <a name='8600'>
<a name='8601'>
<font color=#447700>! Clear sky reflectivities<a name='8602'></font>
            call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#REFTRA_SW'>reftra_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="REFTRA_SW_1"> (klev, &amp;<a name='8603'>
                            lrtchkclr, zgcc, prmu0, ztauc, zomcc, &amp;<a name='8604'>
                            zrefc, zrefdc, ztrac, ztradc)<a name='8605'>
<a name='8606'>
<font color=#447700>! Total sky reflectivities      <a name='8607'></font>
            call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#REFTRA_SW'>reftra_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="REFTRA_SW_2"> (klev, &amp;<a name='8608'>
                            lrtchkcld, zgco, prmu0, ztauo, zomco, &amp;<a name='8609'>
                            zrefo, zrefdo, ztrao, ztrado)<a name='8610'>
<a name='8611'>
            do jk=1,klev<a name='8612'>
<a name='8613'>
<font color=#447700>! Combine clear and cloudy contributions for total sky<a name='8614'></font>
               ikl = klev+1-jk <a name='8615'>
               zclear = 1.0_rb - pcldfmc(ikl,iw)<a name='8616'>
               zcloud = pcldfmc(ikl,iw)<a name='8617'>
<a name='8618'>
               zref(jk) = zclear*zrefc(jk) + zcloud*zrefo(jk)<a name='8619'>
               zrefd(jk)= zclear*zrefdc(jk) + zcloud*zrefdo(jk)<a name='8620'>
               ztra(jk) = zclear*ztrac(jk) + zcloud*ztrao(jk)<a name='8621'>
               ztrad(jk)= zclear*ztradc(jk) + zcloud*ztrado(jk)<a name='8622'>
<a name='8623'>
<font color=#447700>! Direct beam transmittance        <a name='8624'></font>
<a name='8625'>
<font color=#447700>! Clear<a name='8626'></font>
<font color=#447700>!                zdbtmc = exp(-ztauc(jk) / prmu0)<a name='8627'></font>
<a name='8628'>
<font color=#447700>! Use exponential lookup table for transmittance, or expansion of <a name='8629'></font>
<font color=#447700>! exponential for low tau<a name='8630'></font>
               ze1 = ztauc(jk) / prmu0<a name='8631'>
               if (ze1 .le. od_lo) then<a name='8632'>
                  zdbtmc = 1._rb - ze1 + 0.5_rb * ze1 * ze1<a name='8633'>
               else<a name='8634'>
                  tblind = ze1 / (bpade + ze1)<a name='8635'>
                  itind = tblint * tblind + 0.5_rb<a name='8636'>
                  zdbtmc = exp_tbl(itind)<a name='8637'>
               endif<a name='8638'>
<a name='8639'>
               zdbtc(jk) = zdbtmc<a name='8640'>
               ztdbtc(jk+1) = zdbtc(jk)*ztdbtc(jk)<a name='8641'>
<a name='8642'>
<font color=#447700>! Clear + Cloud<a name='8643'></font>
<font color=#447700>!                zdbtmo = exp(-ztauo(jk) / prmu0)<a name='8644'></font>
<a name='8645'>
<font color=#447700>! Use exponential lookup table for transmittance, or expansion of <a name='8646'></font>
<font color=#447700>! exponential for low tau<a name='8647'></font>
               ze1 = ztauo(jk) / prmu0<a name='8648'>
               if (ze1 .le. od_lo) then<a name='8649'>
                  zdbtmo = 1._rb - ze1 + 0.5_rb * ze1 * ze1<a name='8650'>
               else<a name='8651'>
                  tblind = ze1 / (bpade + ze1)<a name='8652'>
                  itind = tblint * tblind + 0.5_rb<a name='8653'>
                  zdbtmo = exp_tbl(itind)<a name='8654'>
               endif<a name='8655'>
<a name='8656'>
               zdbt(jk) = zclear*zdbtmc + zcloud*zdbtmo<a name='8657'>
               ztdbt(jk+1) = zdbt(jk)*ztdbt(jk)<a name='8658'>
        <a name='8659'>
            enddo           <a name='8660'>
                 <a name='8661'>
<font color=#447700>! Vertical quadrature for clear-sky fluxes<a name='8662'></font>
<a name='8663'>
            call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#VRTQDR_SW'>vrtqdr_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="VRTQDR_SW_1">(klev, iw, &amp;<a name='8664'>
                           zrefc, zrefdc, ztrac, ztradc, &amp;<a name='8665'>
                           zdbtc, zrdndc, zrupc, zrupdc, ztdbtc, &amp;<a name='8666'>
                           zcd, zcu)<a name='8667'>
      <a name='8668'>
<font color=#447700>! Vertical quadrature for cloudy fluxes<a name='8669'></font>
<a name='8670'>
            call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#VRTQDR_SW'>vrtqdr_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="VRTQDR_SW_2">(klev, iw, &amp;<a name='8671'>
                           zref, zrefd, ztra, ztrad, &amp;<a name='8672'>
                           zdbt, zrdnd, zrup, zrupd, ztdbt, &amp;<a name='8673'>
                           zfd, zfu)<a name='8674'>
<a name='8675'>
<font color=#447700>! Upwelling and downwelling fluxes at levels<a name='8676'></font>
<font color=#447700>!   Two-stream calculations go from top to bottom; <a name='8677'></font>
<font color=#447700>!   layer indexing is reversed to go bottom to top for output arrays<a name='8678'></font>
<a name='8679'>
            do jk=1,klev+1<a name='8680'>
               ikl=klev+2-jk<a name='8681'>
<a name='8682'>
<font color=#447700>! Accumulate spectral fluxes over bands - inactive<a name='8683'></font>
<font color=#447700>!               zbbfu(ikl) = zbbfu(ikl) + zincflx(iw)*zfu(jk,iw)  <a name='8684'></font>
<font color=#447700>!               zbbfd(ikl) = zbbfd(ikl) + zincflx(iw)*zfd(jk,iw)<a name='8685'></font>
<font color=#447700>!               zbbcu(ikl) = zbbcu(ikl) + zincflx(iw)*zcu(jk,iw)<a name='8686'></font>
<font color=#447700>!               zbbcd(ikl) = zbbcd(ikl) + zincflx(iw)*zcd(jk,iw)<a name='8687'></font>
<font color=#447700>!               zbbfddir(ikl) = zbbfddir(ikl) + zincflx(iw)*ztdbt_nodel(jk)<a name='8688'></font>
<font color=#447700>!               zbbcddir(ikl) = zbbcddir(ikl) + zincflx(iw)*ztdbtc_nodel(jk)<a name='8689'></font>
<a name='8690'>
<font color=#447700>! Accumulate spectral fluxes over whole spectrum  <a name='8691'></font>
               pbbfu(ikl) = pbbfu(ikl) + zincflx(iw)*zfu(jk,iw)<a name='8692'>
               pbbfd(ikl) = pbbfd(ikl) + zincflx(iw)*zfd(jk,iw)<a name='8693'>
               pbbcu(ikl) = pbbcu(ikl) + zincflx(iw)*zcu(jk,iw)<a name='8694'>
               pbbcd(ikl) = pbbcd(ikl) + zincflx(iw)*zcd(jk,iw)<a name='8695'>
               pbbfddir(ikl) = pbbfddir(ikl) + zincflx(iw)*ztdbt_nodel(jk)<a name='8696'>
               pbbcddir(ikl) = pbbcddir(ikl) + zincflx(iw)*ztdbtc_nodel(jk)<a name='8697'>
<a name='8698'>
<font color=#447700>! Accumulate direct fluxes for UV/visible bands<a name='8699'></font>
               if (ibm &gt;= 10 .and. ibm &lt;= 13) then<a name='8700'>
                  puvcd(ikl) = puvcd(ikl) + zincflx(iw)*zcd(jk,iw)<a name='8701'>
                  puvfd(ikl) = puvfd(ikl) + zincflx(iw)*zfd(jk,iw)<a name='8702'>
                  puvcddir(ikl) = puvcddir(ikl) + zincflx(iw)*ztdbtc_nodel(jk)<a name='8703'>
                  puvfddir(ikl) = puvfddir(ikl) + zincflx(iw)*ztdbt_nodel(jk)<a name='8704'>
<font color=#447700>! Accumulate direct fluxes for near-IR bands<a name='8705'></font>
               else if (ibm == 14 .or. ibm &lt;= 9) then  <a name='8706'>
                  pnicd(ikl) = pnicd(ikl) + zincflx(iw)*zcd(jk,iw)<a name='8707'>
                  pnifd(ikl) = pnifd(ikl) + zincflx(iw)*zfd(jk,iw)<a name='8708'>
                  pnicddir(ikl) = pnicddir(ikl) + zincflx(iw)*ztdbtc_nodel(jk)<a name='8709'>
                  pnifddir(ikl) = pnifddir(ikl) + zincflx(iw)*ztdbt_nodel(jk)<a name='8710'>
               endif<a name='8711'>
<a name='8712'>
            enddo<a name='8713'>
<a name='8714'>
<font color=#447700>! End loop on jg, g-point interval<a name='8715'></font>
         enddo             <a name='8716'>
<a name='8717'>
<font color=#447700>! End loop on jb, spectral band<a name='8718'></font>
      enddo                    <a name='8719'>
<a name='8720'>
      end subroutine spcvmc_sw<a name='8721'>
<a name='8722'>
      end module rrtmg_sw_spcvmc<a name='8723'>
<a name='8724'>
<font color=#447700>!     path:      $Source: /cvsroot/NWP/WRFV3/phys/module_ra_rrtmg_sw.F,v $<a name='8725'></font>
<font color=#447700>!     author:    $Author: trn $<a name='8726'></font>
<font color=#447700>!     revision:  $Revision: 1.3 $<a name='8727'></font>
<font color=#447700>!     created:   $Date: 2009/04/16 19:54:22 $<a name='8728'></font>
<font color=#447700>!<a name='8729'></font>
<A NAME='RRTMG_SW_RAD'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_RAD' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='8730'>
       <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_rad</font> <A href='../../call_to/RRTMG_SW_RAD.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_RAD.html' TARGET='index'>6</A><a name='8731'>
<a name='8732'>
<font color=#447700>!  --------------------------------------------------------------------------<a name='8733'></font>
<font color=#447700>! |                                                                          |<a name='8734'></font>
<font color=#447700>! |  Copyright 2002-2008, Atmospheric &amp; Environmental Research, Inc. (AER).  |<a name='8735'></font>
<font color=#447700>! |  This software may be used, copied, or redistributed as long as it is    |<a name='8736'></font>
<font color=#447700>! |  not sold and this copyright notice is reproduced on each copy made.     |<a name='8737'></font>
<font color=#447700>! |  This model is provided as is without any express or implied warranties. |<a name='8738'></font>
<font color=#447700>! |                       (http://www.rtweb.aer.com/)                        |<a name='8739'></font>
<font color=#447700>! |                                                                          |<a name='8740'></font>
<font color=#447700>!  --------------------------------------------------------------------------<a name='8741'></font>
<font color=#447700>!<a name='8742'></font>
<font color=#447700>! ****************************************************************************<a name='8743'></font>
<font color=#447700>! *                                                                          *<a name='8744'></font>
<font color=#447700>! *                             RRTMG_SW                                     *<a name='8745'></font>
<font color=#447700>! *                                                                          *<a name='8746'></font>
<font color=#447700>! *                                                                          *<a name='8747'></font>
<font color=#447700>! *                                                                          *<a name='8748'></font>
<font color=#447700>! *                 a rapid radiative transfer model                         *<a name='8749'></font>
<font color=#447700>! *                  for the solar spectral region                           *<a name='8750'></font>
<font color=#447700>! *           for application to general circulation models                  *<a name='8751'></font>
<font color=#447700>! *                                                                          *<a name='8752'></font>
<font color=#447700>! *                                                                          *<a name='8753'></font>
<font color=#447700>! *           Atmospheric and Environmental Research, Inc.                   *<a name='8754'></font>
<font color=#447700>! *                       131 Hartwell Avenue                                *<a name='8755'></font>
<font color=#447700>! *                       Lexington, MA 02421                                *<a name='8756'></font>
<font color=#447700>! *                                                                          *<a name='8757'></font>
<font color=#447700>! *                                                                          *<a name='8758'></font>
<font color=#447700>! *                          Eli J. Mlawer                                   *<a name='8759'></font>
<font color=#447700>! *                       Jennifer S. Delamere                               *<a name='8760'></font>
<font color=#447700>! *                        Michael J. Iacono                                 *<a name='8761'></font>
<font color=#447700>! *                        Shepard A. Clough                                 *<a name='8762'></font>
<font color=#447700>! *                                                                          *<a name='8763'></font>
<font color=#447700>! *                                                                          *<a name='8764'></font>
<font color=#447700>! *                                                                          *<a name='8765'></font>
<font color=#447700>! *                                                                          *<a name='8766'></font>
<font color=#447700>! *                                                                          *<a name='8767'></font>
<font color=#447700>! *                                                                          *<a name='8768'></font>
<font color=#447700>! *                      email:  miacono@aer.com                             *<a name='8769'></font>
<font color=#447700>! *                      email:  emlawer@aer.com                             *<a name='8770'></font>
<font color=#447700>! *                      email:  jdelamer@aer.com                            *<a name='8771'></font>
<font color=#447700>! *                                                                          *<a name='8772'></font>
<font color=#447700>! *       The authors wish to acknowledge the contributions of the           *<a name='8773'></font>
<font color=#447700>! *       following people:  Steven J. Taubman, Patrick D. Brown,            *<a name='8774'></font>
<font color=#447700>! *       Ronald E. Farren, Luke Chen, Robert Bergstrom.                     *<a name='8775'></font>
<font color=#447700>! *                                                                          *<a name='8776'></font>
<font color=#447700>! ****************************************************************************<a name='8777'></font>
<a name='8778'>
<font color=#447700>! --------- Modules ---------<a name='8779'></font>
<a name='8780'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#PARKIND'>parkind</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_RAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARKIND_61">, only : im =&gt; kind_im, rb =&gt; kind_rb<a name='8781'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_VSN'>rrsw_vsn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_RAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_9"><a name='8782'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MCICA_SUBCOL_GEN_SW'>mcica_subcol_gen_sw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_RAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MCICA_SUBCOL_GEN_SW_1">, only: mcica_subcol_sw<a name='8783'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_CLDPRMC'>rrtmg_sw_cldprmc</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_RAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_CLDPRMC_1">, only: cldprmc_sw<a name='8784'>
<font color=#447700>! *** Move the required call to rrtmg_sw_ini below and the following <a name='8785'></font>
<font color=#447700>! use association to GCM initialization area ***<a name='8786'></font>
<font color=#447700>!      use rrtmg_sw_init, only: rrtmg_sw_ini<a name='8787'></font>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SETCOEF'>rrtmg_sw_setcoef</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_RAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_SETCOEF_2">, only: setcoef_sw<a name='8788'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_SPCVMC'>rrtmg_sw_spcvmc</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_RAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_SPCVMC_1">, only: spcvmc_sw<a name='8789'>
<a name='8790'>
      implicit none<a name='8791'>
<a name='8792'>
<font color=#447700>! public interfaces/functions/subroutines<a name='8793'></font>
      public :: rrtmg_sw, inatm_sw, earth_sun<a name='8794'>
<a name='8795'>
<font color=#447700>!------------------------------------------------------------------<a name='8796'></font>
      contains<a name='8797'>
<font color=#447700>!------------------------------------------------------------------<a name='8798'></font>
<a name='8799'>
<font color=#447700>!------------------------------------------------------------------<a name='8800'></font>
<font color=#447700>! Public subroutines<a name='8801'></font>
<font color=#447700>!------------------------------------------------------------------<a name='8802'></font>
<a name='8803'>
<A NAME='RRTMG_SW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='8804'>
      <font color=#993300>subroutine </font><font color=#cc0000>rrtmg_sw</font> &amp; <A href='../../call_to/RRTMG_SW.html' TARGET='index'>2</A>,<A href='../../call_from/RRTMG_SW.html' TARGET='index'>22</A><a name='8805'>
            (ncol    ,nlay    ,icld    , &amp;<a name='8806'>
             play    ,plev    ,tlay    ,tlev    ,tsfc   , &amp;<a name='8807'>
             h2ovmr , o3vmr   ,co2vmr  ,ch4vmr  ,n2ovmr ,o2vmr , &amp;<a name='8808'>
             asdir   ,asdif   ,aldir   ,aldif   , &amp;<a name='8809'>
             coszen  ,adjes   ,dyofyr  ,scon    , &amp;<a name='8810'>
             inflgsw ,iceflgsw,liqflgsw,cldfmcl , &amp;<a name='8811'>
             taucmcl ,ssacmcl ,asmcmcl ,fsfcmcl , &amp;<a name='8812'>
             ciwpmcl ,clwpmcl ,cswpmcl ,reicmcl ,relqmcl ,resnmcl, &amp;<a name='8813'>
             tauaer  ,ssaaer  ,asmaer  ,ecaer   , &amp;<a name='8814'>
             swuflx  ,swdflx  ,swhr    ,swuflxc ,swdflxc ,swhrc, aer_opt,  &amp;<a name='8815'>
<font color=#447700>! --------- Add the following four compenants for ssib shortwave down radiation ---!<a name='8816'></font>
<font color=#447700>! -------------------      by Zhenxin 2011-06-20      --------------------------------!<a name='8817'></font>
             sibvisdir, sibvisdif, sibnirdir, sibnirdif,         &amp;<a name='8818'>
<font color=#447700>! ----------------------  End,  Zhenxin 2011-06-20    --------------------------------!<a name='8819'></font>
             swdkdir,swdkdif                                &amp; <font color=#447700>! jararias, 2013/08/10<a name='8820'></font>
                                                                )<a name='8821'>
<a name='8822'>
<a name='8823'>
<font color=#447700>! ------- Description -------<a name='8824'></font>
<a name='8825'>
<font color=#447700>! This program is the driver for RRTMG_SW, the AER SW radiation model for <a name='8826'></font>
<font color=#447700>!  application to GCMs, that has been adapted from RRTM_SW for improved<a name='8827'></font>
<font color=#447700>!  efficiency and to provide fractional cloudiness and cloud overlap<a name='8828'></font>
<font color=#447700>!  capability using McICA.<a name='8829'></font>
<font color=#447700>!<a name='8830'></font>
<font color=#447700>! Note: The call to RRTMG_SW_INI should be moved to the GCM initialization <a name='8831'></font>
<font color=#447700>!  area, since this has to be called only once. <a name='8832'></font>
<font color=#447700>!<a name='8833'></font>
<font color=#447700>! This routine<a name='8834'></font>
<font color=#447700>!    b) calls INATM_SW to read in the atmospheric profile;<a name='8835'></font>
<font color=#447700>!       all layering in RRTMG is ordered from surface to toa. <a name='8836'></font>
<font color=#447700>!    c) calls CLDPRMC_SW to set cloud optical depth for McICA based<a name='8837'></font>
<font color=#447700>!       on input cloud properties<a name='8838'></font>
<font color=#447700>!    d) calls SETCOEF_SW to calculate various quantities needed for <a name='8839'></font>
<font color=#447700>!       the radiative transfer algorithm<a name='8840'></font>
<font color=#447700>!    e) calls SPCVMC to call the two-stream model that in turn <a name='8841'></font>
<font color=#447700>!       calls TAUMOL to calculate gaseous optical depths for each <a name='8842'></font>
<font color=#447700>!       of the 16 spectral bands and to perform the radiative transfer<a name='8843'></font>
<font color=#447700>!       using McICA, the Monte-Carlo Independent Column Approximation,<a name='8844'></font>
<font color=#447700>!       to represent sub-grid scale cloud variability<a name='8845'></font>
<font color=#447700>!    f) passes the calculated fluxes and cooling rates back to GCM<a name='8846'></font>
<font color=#447700>!<a name='8847'></font>
<font color=#447700>! Two modes of operation are possible:<a name='8848'></font>
<font color=#447700>!     The mode is chosen by using either rrtmg_sw.nomcica.f90 (to not use<a name='8849'></font>
<font color=#447700>!     McICA) or rrtmg_sw.f90 (to use McICA) to interface with a GCM.<a name='8850'></font>
<font color=#447700>!<a name='8851'></font>
<font color=#447700>!    1) Standard, single forward model calculation (imca = 0); this is <a name='8852'></font>
<font color=#447700>!       valid only for clear sky or fully overcast clouds<a name='8853'></font>
<font color=#447700>!    2) Monte Carlo Independent Column Approximation (McICA, Pincus et al., <a name='8854'></font>
<font color=#447700>!       JC, 2003) method is applied to the forward model calculation (imca = 1)<a name='8855'></font>
<font color=#447700>!       This method is valid for clear sky or partial cloud conditions.<a name='8856'></font>
<font color=#447700>!<a name='8857'></font>
<font color=#447700>! This call to RRTMG_SW must be preceeded by a call to the module<a name='8858'></font>
<font color=#447700>!     mcica_subcol_gen_sw.f90 to run the McICA sub-column cloud generator,<a name='8859'></font>
<font color=#447700>!     which will provide the cloud physical or cloud optical properties<a name='8860'></font>
<font color=#447700>!     on the RRTMG quadrature point (ngptsw) dimension.<a name='8861'></font>
<font color=#447700>!<a name='8862'></font>
<font color=#447700>! Two methods of cloud property input are possible:<a name='8863'></font>
<font color=#447700>!     Cloud properties can be input in one of two ways (controlled by input <a name='8864'></font>
<font color=#447700>!     flags inflag, iceflag and liqflag; see text file rrtmg_sw_instructions<a name='8865'></font>
<font color=#447700>!     and subroutine rrtmg_sw_cldprop.f90 for further details):<a name='8866'></font>
<font color=#447700>!<a name='8867'></font>
<font color=#447700>!    1) Input cloud fraction, cloud optical depth, single scattering albedo <a name='8868'></font>
<font color=#447700>!       and asymmetry parameter directly (inflgsw = 0)<a name='8869'></font>
<font color=#447700>!    2) Input cloud fraction and cloud physical properties: ice fracion,<a name='8870'></font>
<font color=#447700>!       ice and liquid particle sizes (inflgsw = 1 or 2);  <a name='8871'></font>
<font color=#447700>!       cloud optical properties are calculated by cldprop or cldprmc based<a name='8872'></font>
<font color=#447700>!       on input settings of iceflgsw and liqflgsw<a name='8873'></font>
<font color=#447700>!<a name='8874'></font>
<font color=#447700>! Two methods of aerosol property input are possible:<a name='8875'></font>
<font color=#447700>!     Aerosol properties can be input in one of two ways (controlled by input <a name='8876'></font>
<font color=#447700>!     flag iaer, see text file rrtmg_sw_instructions for further details):<a name='8877'></font>
<font color=#447700>!<a name='8878'></font>
<font color=#447700>!    1) Input aerosol optical depth, single scattering albedo and asymmetry<a name='8879'></font>
<font color=#447700>!       parameter directly by layer and spectral band (iaer=10)<a name='8880'></font>
<font color=#447700>!    2) Input aerosol optical depth and 0.55 micron directly by layer and use<a name='8881'></font>
<font color=#447700>!       one or more of six ECMWF aerosol types (iaer=6)<a name='8882'></font>
<font color=#447700>!<a name='8883'></font>
<font color=#447700>!<a name='8884'></font>
<font color=#447700>! ------- Modifications -------<a name='8885'></font>
<font color=#447700>!<a name='8886'></font>
<font color=#447700>! This version of RRTMG_SW has been modified from RRTM_SW to use a reduced<a name='8887'></font>
<font color=#447700>! set of g-point intervals and a two-stream model for application to GCMs. <a name='8888'></font>
<font color=#447700>!<a name='8889'></font>
<font color=#447700>!-- Original version (derived from RRTM_SW)<a name='8890'></font>
<font color=#447700>!     2002: AER. Inc.<a name='8891'></font>
<font color=#447700>!-- Conversion to F90 formatting; addition of 2-stream radiative transfer<a name='8892'></font>
<font color=#447700>!     Feb 2003: J.-J. Morcrette, ECMWF<a name='8893'></font>
<font color=#447700>!-- Additional modifications for GCM application<a name='8894'></font>
<font color=#447700>!     Aug 2003: M. J. Iacono, AER Inc.<a name='8895'></font>
<font color=#447700>!-- Total number of g-points reduced from 224 to 112.  Original<a name='8896'></font>
<font color=#447700>!   set of 224 can be restored by exchanging code in module parrrsw.f90 <a name='8897'></font>
<font color=#447700>!   and in file rrtmg_sw_init.f90.<a name='8898'></font>
<font color=#447700>!     Apr 2004: M. J. Iacono, AER, Inc.<a name='8899'></font>
<font color=#447700>!-- Modifications to include output for direct and diffuse <a name='8900'></font>
<font color=#447700>!   downward fluxes.  There are output as "true" fluxes without<a name='8901'></font>
<font color=#447700>!   any delta scaling applied.  Code can be commented to exclude<a name='8902'></font>
<font color=#447700>!   this calculation in source file rrtmg_sw_spcvrt.f90.<a name='8903'></font>
<font color=#447700>!     Jan 2005: E. J. Mlawer, M. J. Iacono, AER, Inc.<a name='8904'></font>
<font color=#447700>!-- Revised to add McICA capability.<a name='8905'></font>
<font color=#447700>!     Nov 2005: M. J. Iacono, AER, Inc.<a name='8906'></font>
<font color=#447700>!-- Reformatted for consistency with rrtmg_lw.<a name='8907'></font>
<font color=#447700>!     Feb 2007: M. J. Iacono, AER, Inc.<a name='8908'></font>
<font color=#447700>!-- Modifications to formatting to use assumed-shape arrays. <a name='8909'></font>
<font color=#447700>!     Aug 2007: M. J. Iacono, AER, Inc.<a name='8910'></font>
<a name='8911'>
<font color=#447700>! --------- Modules ---------<a name='8912'></font>
<a name='8913'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_36">, only : nbndsw, ngptsw, naerec, nstr, nmol, mxmol, &amp;<a name='8914'>
                          jpband, jpb1, jpb2<a name='8915'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_AER'>rrsw_aer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_AER_2">, only : rsrtaua, rsrpiza, rsrasya<a name='8916'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_CON'>rrsw_con</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CON_4">, only : heatfac, oneminus, pi<a name='8917'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_WVN'>rrsw_wvn</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_6">, only : wavenum1, wavenum2<a name='8918'>
<a name='8919'>
<font color=#447700>! ------- Declarations<a name='8920'></font>
<a name='8921'>
<font color=#447700>! ----- Input -----<a name='8922'></font>
<a name='8923'>
      integer(kind=im), intent(in) :: ncol            <font color=#447700>! Number of horizontal columns     <a name='8924'></font>
      integer(kind=im), intent(in) :: nlay            <font color=#447700>! Number of model layers<a name='8925'></font>
      integer(kind=im), intent(inout) :: icld         <font color=#447700>! Cloud overlap method<a name='8926'></font>
                                                      <font color=#447700>!    0: Clear only<a name='8927'></font>
                                                      <font color=#447700>!    1: Random<a name='8928'></font>
                                                      <font color=#447700>!    2: Maximum/random<a name='8929'></font>
                                                      <font color=#447700>!    3: Maximum<a name='8930'></font>
<a name='8931'>
      real(kind=rb), intent(in) :: play(:,:)          <font color=#447700>! Layer pressures (hPa, mb)<a name='8932'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='8933'></font>
      real(kind=rb), intent(in) :: plev(:,:)          <font color=#447700>! Interface pressures (hPa, mb)<a name='8934'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='8935'></font>
      real(kind=rb), intent(in) :: tlay(:,:)          <font color=#447700>! Layer temperatures (K)<a name='8936'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='8937'></font>
      real(kind=rb), intent(in) :: tlev(:,:)          <font color=#447700>! Interface temperatures (K)<a name='8938'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='8939'></font>
      real(kind=rb), intent(in) :: tsfc(:)            <font color=#447700>! Surface temperature (K)<a name='8940'></font>
                                                      <font color=#447700>!    Dimensions: (ncol)<a name='8941'></font>
      real(kind=rb), intent(in) :: h2ovmr(:,:)        <font color=#447700>! H2O volume mixing ratio<a name='8942'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='8943'></font>
      real(kind=rb), intent(in) :: o3vmr(:,:)         <font color=#447700>! O3 volume mixing ratio<a name='8944'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='8945'></font>
      real(kind=rb), intent(in) :: co2vmr(:,:)        <font color=#447700>! CO2 volume mixing ratio<a name='8946'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='8947'></font>
      real(kind=rb), intent(in) :: ch4vmr(:,:)        <font color=#447700>! Methane volume mixing ratio<a name='8948'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='8949'></font>
      real(kind=rb), intent(in) :: n2ovmr(:,:)        <font color=#447700>! Nitrous oxide volume mixing ratio<a name='8950'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='8951'></font>
      real(kind=rb), intent(in) :: o2vmr(:,:)         <font color=#447700>! Oxygen volume mixing ratio<a name='8952'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='8953'></font>
      real(kind=rb), intent(in) :: asdir(:)           <font color=#447700>! UV/vis surface albedo direct rad<a name='8954'></font>
                                                      <font color=#447700>!    Dimensions: (ncol)<a name='8955'></font>
      real(kind=rb), intent(in) :: aldir(:)           <font color=#447700>! Near-IR surface albedo direct rad<a name='8956'></font>
                                                      <font color=#447700>!    Dimensions: (ncol)<a name='8957'></font>
      real(kind=rb), intent(in) :: asdif(:)           <font color=#447700>! UV/vis surface albedo: diffuse rad<a name='8958'></font>
                                                      <font color=#447700>!    Dimensions: (ncol)<a name='8959'></font>
      real(kind=rb), intent(in) :: aldif(:)           <font color=#447700>! Near-IR surface albedo: diffuse rad<a name='8960'></font>
                                                      <font color=#447700>!    Dimensions: (ncol)<a name='8961'></font>
<a name='8962'>
      integer(kind=im), intent(in) :: dyofyr          <font color=#447700>! Day of the year (used to get Earth/Sun<a name='8963'></font>
                                                      <font color=#447700>!  distance if adjflx not provided)<a name='8964'></font>
      real(kind=rb), intent(in) :: adjes              <font color=#447700>! Flux adjustment for Earth/Sun distance<a name='8965'></font>
      real(kind=rb), intent(in) :: coszen(:)          <font color=#447700>! Cosine of solar zenith angle<a name='8966'></font>
                                                      <font color=#447700>!    Dimensions: (ncol)<a name='8967'></font>
      real(kind=rb), intent(in) :: scon               <font color=#447700>! Solar constant (W/m2)<a name='8968'></font>
<a name='8969'>
      integer(kind=im), intent(in) :: inflgsw         <font color=#447700>! Flag for cloud optical properties<a name='8970'></font>
      integer(kind=im), intent(in) :: iceflgsw        <font color=#447700>! Flag for ice particle specification<a name='8971'></font>
      integer(kind=im), intent(in) :: liqflgsw        <font color=#447700>! Flag for liquid droplet specification<a name='8972'></font>
<a name='8973'>
      real(kind=rb), intent(in) :: cldfmcl(:,:,:)     <font color=#447700>! Cloud fraction<a name='8974'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='8975'></font>
      real(kind=rb), intent(in) :: taucmcl(:,:,:)     <font color=#447700>! In-cloud optical depth<a name='8976'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='8977'></font>
      real(kind=rb), intent(in) :: ssacmcl(:,:,:)     <font color=#447700>! In-cloud single scattering albedo<a name='8978'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='8979'></font>
      real(kind=rb), intent(in) :: asmcmcl(:,:,:)     <font color=#447700>! In-cloud asymmetry parameter<a name='8980'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='8981'></font>
      real(kind=rb), intent(in) :: fsfcmcl(:,:,:)     <font color=#447700>! In-cloud forward scattering fraction<a name='8982'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='8983'></font>
      real(kind=rb), intent(in) :: ciwpmcl(:,:,:)     <font color=#447700>! In-cloud ice water path (g/m2)<a name='8984'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='8985'></font>
      real(kind=rb), intent(in) :: clwpmcl(:,:,:)     <font color=#447700>! In-cloud liquid water path (g/m2)<a name='8986'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='8987'></font>
      real(kind=rb), intent(in) :: cswpmcl(:,:,:)     <font color=#447700>! In-cloud snow water path (g/m2)<a name='8988'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='8989'></font>
      real(kind=rb), intent(in) :: reicmcl(:,:)       <font color=#447700>! Cloud ice effective radius (microns)<a name='8990'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='8991'></font>
                                                      <font color=#447700>! specific definition of reicmcl depends on setting of iceflglw:<a name='8992'></font>
                                                      <font color=#447700>! iceflglw = 0: ice effective radius, r_ec, (Ebert and Curry, 1992),<a name='8993'></font>
                                                      <font color=#447700>!               r_ec must be &gt;= 10.0 microns<a name='8994'></font>
                                                      <font color=#447700>! iceflglw = 1: ice effective radius, r_ec, (Ebert and Curry, 1992),<a name='8995'></font>
                                                      <font color=#447700>!               r_ec range is limited to 13.0 to 130.0 microns<a name='8996'></font>
                                                      <font color=#447700>! iceflglw = 2: ice effective radius, r_k, (Key, Streamer Ref. Manual, 1996)<a name='8997'></font>
                                                      <font color=#447700>!               r_k range is limited to 5.0 to 131.0 microns<a name='8998'></font>
                                                      <font color=#447700>! iceflglw = 3: generalized effective size, dge, (Fu, 1996),<a name='8999'></font>
                                                      <font color=#447700>!               dge range is limited to 5.0 to 140.0 microns<a name='9000'></font>
                                                      <font color=#447700>!               [dge = 1.0315 * r_ec]<a name='9001'></font>
      real(kind=rb), intent(in) :: relqmcl(:,:)       <font color=#447700>! Cloud water drop effective radius (microns)<a name='9002'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='9003'></font>
      real(kind=rb), intent(in) :: resnmcl(:,:)       <font color=#447700>! Cloud snow effective radius (microns)<a name='9004'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='9005'></font>
      real(kind=rb), intent(in) :: tauaer(:,:,:)      <font color=#447700>! Aerosol optical depth (iaer=10 only)<a name='9006'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='9007'></font>
                                                      <font color=#447700>! (non-delta scaled)      <a name='9008'></font>
      real(kind=rb), intent(in) :: ssaaer(:,:,:)      <font color=#447700>! Aerosol single scattering albedo (iaer=10 only)<a name='9009'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='9010'></font>
                                                      <font color=#447700>! (non-delta scaled)      <a name='9011'></font>
      real(kind=rb), intent(in) :: asmaer(:,:,:)      <font color=#447700>! Aerosol asymmetry parameter (iaer=10 only)<a name='9012'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='9013'></font>
                                                      <font color=#447700>! (non-delta scaled)      <a name='9014'></font>
      real(kind=rb), intent(in) :: ecaer(:,:,:)       <font color=#447700>! Aerosol optical depth at 0.55 micron (iaer=6 only)<a name='9015'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,naerec)<a name='9016'></font>
                                                      <font color=#447700>! (non-delta scaled)      <a name='9017'></font>
<a name='9018'>
<font color=#447700>! ----- Output -----<a name='9019'></font>
<a name='9020'>
      real(kind=rb), intent(out) :: swuflx(:,:)       <font color=#447700>! Total sky shortwave upward flux (W/m2)<a name='9021'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='9022'></font>
      real(kind=rb), intent(out) :: swdflx(:,:)       <font color=#447700>! Total sky shortwave downward flux (W/m2)<a name='9023'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='9024'></font>
      real(kind=rb), intent(out) :: sibvisdir(:,:)    <font color=#447700>! visible direct downward flux  (W/m2)<a name='9025'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1) Zhenxin (2011/06/20)<a name='9026'></font>
      real(kind=rb), intent(out) :: sibvisdif(:,:)    <font color=#447700>! visible diffusion downward flux  (W/m2)<a name='9027'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1) Zhenxin (2011/06/20)<a name='9028'></font>
      real(kind=rb), intent(out) :: sibnirdir(:,:)    <font color=#447700>! Near IR direct downward flux  (W/m2)<a name='9029'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)  Zhenxin (2011/06/20)<a name='9030'></font>
      real(kind=rb), intent(out) :: sibnirdif(:,:)    <font color=#447700>! Near IR diffusion downward flux  (W/m2)<a name='9031'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1) Zhenxin (2011/06/20)<a name='9032'></font>
      real(kind=rb), intent(out) :: swhr(:,:)         <font color=#447700>! Total sky shortwave radiative heating rate (K/d)<a name='9033'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='9034'></font>
      real(kind=rb), intent(out) :: swuflxc(:,:)      <font color=#447700>! Clear sky shortwave upward flux (W/m2)<a name='9035'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='9036'></font>
      real(kind=rb), intent(out) :: swdflxc(:,:)      <font color=#447700>! Clear sky shortwave downward flux (W/m2)<a name='9037'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='9038'></font>
      real(kind=rb), intent(out) :: swhrc(:,:)        <font color=#447700>! Clear sky shortwave radiative heating rate (K/d)<a name='9039'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='9040'></font>
<a name='9041'>
      integer, intent(in)        :: aer_opt<a name='9042'>
      real(kind=rb), intent(out) :: &amp;<a name='9043'>
        swdkdir(:,:), &amp; <font color=#447700>! Total shortwave downward direct flux (W/m2),  Dimensions: (ncol,nlay) jararias, 2013/08/10<a name='9044'></font>
        swdkdif(:,:)    <font color=#447700>! Total shortwave downward diffuse flux (W/m2), Dimensions: (ncol,nlay) jararias, 2013/08/10<a name='9045'></font>
<a name='9046'>
<a name='9047'>
<a name='9048'>
<a name='9049'>
<a name='9050'>
<font color=#447700>! ----- Local -----<a name='9051'></font>
<a name='9052'>
<font color=#447700>! Control<a name='9053'></font>
      integer(kind=im) :: nlayers             <font color=#447700>! total number of layers<a name='9054'></font>
      integer(kind=im) :: istart              <font color=#447700>! beginning band of calculation<a name='9055'></font>
      integer(kind=im) :: iend                <font color=#447700>! ending band of calculation<a name='9056'></font>
      integer(kind=im) :: icpr                <font color=#447700>! cldprop/cldprmc use flag<a name='9057'></font>
      integer(kind=im) :: iout                <font color=#447700>! output option flag (inactive)<a name='9058'></font>
      integer(kind=im) :: iaer                <font color=#447700>! aerosol option flag<a name='9059'></font>
      integer(kind=im) :: idelm               <font color=#447700>! delta-m scaling flag (inactive)<a name='9060'></font>
      integer(kind=im) :: isccos              <font color=#447700>! instrumental cosine response flag (inactive)<a name='9061'></font>
      integer(kind=im) :: iplon               <font color=#447700>! column loop index<a name='9062'></font>
      integer(kind=im) :: i                   <font color=#447700>! layer loop index                       ! jk<a name='9063'></font>
      integer(kind=im) :: ib                  <font color=#447700>! band loop index                        ! jsw<a name='9064'></font>
      integer(kind=im) :: ia, ig              <font color=#447700>! indices<a name='9065'></font>
      integer(kind=im) :: k                   <font color=#447700>! layer loop index<a name='9066'></font>
      integer(kind=im) :: ims                 <font color=#447700>! value for changing mcica permute seed<a name='9067'></font>
      integer(kind=im) :: imca                <font color=#447700>! flag for mcica [0=off, 1=on]<a name='9068'></font>
<a name='9069'>
      real(kind=rb) :: zepsec, zepzen         <font color=#447700>! epsilon<a name='9070'></font>
      real(kind=rb) :: zdpgcp                 <font color=#447700>! flux to heating conversion ratio<a name='9071'></font>
<a name='9072'>
<font color=#447700>! Atmosphere<a name='9073'></font>
      real(kind=rb) :: pavel(nlay+1)          <font color=#447700>! layer pressures (mb) <a name='9074'></font>
      real(kind=rb) :: tavel(nlay+1)          <font color=#447700>! layer temperatures (K)<a name='9075'></font>
      real(kind=rb) :: pz(0:nlay+1)           <font color=#447700>! level (interface) pressures (hPa, mb)<a name='9076'></font>
      real(kind=rb) :: tz(0:nlay+1)           <font color=#447700>! level (interface) temperatures (K)<a name='9077'></font>
      real(kind=rb) :: tbound                 <font color=#447700>! surface temperature (K)<a name='9078'></font>
      real(kind=rb) :: pdp(nlay+1)            <font color=#447700>! layer pressure thickness (hPa, mb)<a name='9079'></font>
      real(kind=rb) :: coldry(nlay+1)         <font color=#447700>! dry air column amount<a name='9080'></font>
      real(kind=rb) :: wkl(mxmol,nlay+1)      <font color=#447700>! molecular amounts (mol/cm-2)<a name='9081'></font>
<a name='9082'>
<font color=#447700>!      real(kind=rb) :: earth_sun             ! function for Earth/Sun distance factor<a name='9083'></font>
      real(kind=rb) :: cossza                 <font color=#447700>! Cosine of solar zenith angle<a name='9084'></font>
      real(kind=rb) :: adjflux(jpband)        <font color=#447700>! adjustment for current Earth/Sun distance<a name='9085'></font>
      real(kind=rb) :: solvar(jpband)         <font color=#447700>! solar constant scaling factor from rrtmg_sw<a name='9086'></font>
                                              <font color=#447700>!  default value of 1368.22 Wm-2 at 1 AU<a name='9087'></font>
      real(kind=rb) :: albdir(nbndsw)         <font color=#447700>! surface albedo, direct          ! zalbp<a name='9088'></font>
      real(kind=rb) :: albdif(nbndsw)         <font color=#447700>! surface albedo, diffuse         ! zalbd<a name='9089'></font>
<a name='9090'>
      real(kind=rb) :: taua(nlay+1,nbndsw)    <font color=#447700>! Aerosol optical depth<a name='9091'></font>
      real(kind=rb) :: ssaa(nlay+1,nbndsw)    <font color=#447700>! Aerosol single scattering albedo<a name='9092'></font>
      real(kind=rb) :: asma(nlay+1,nbndsw)    <font color=#447700>! Aerosol asymmetry parameter<a name='9093'></font>
<a name='9094'>
<font color=#447700>! Atmosphere - setcoef<a name='9095'></font>
      integer(kind=im) :: laytrop             <font color=#447700>! tropopause layer index<a name='9096'></font>
      integer(kind=im) :: layswtch            <font color=#447700>! tropopause layer index<a name='9097'></font>
      integer(kind=im) :: laylow              <font color=#447700>! tropopause layer index<a name='9098'></font>
      integer(kind=im) :: jp(nlay+1)          <font color=#447700>! <a name='9099'></font>
      integer(kind=im) :: jt(nlay+1)          <font color=#447700>!<a name='9100'></font>
      integer(kind=im) :: jt1(nlay+1)         <font color=#447700>!<a name='9101'></font>
<a name='9102'>
      real(kind=rb) :: colh2o(nlay+1)         <font color=#447700>! column amount (h2o)<a name='9103'></font>
      real(kind=rb) :: colco2(nlay+1)         <font color=#447700>! column amount (co2)<a name='9104'></font>
      real(kind=rb) :: colo3(nlay+1)          <font color=#447700>! column amount (o3)<a name='9105'></font>
      real(kind=rb) :: coln2o(nlay+1)         <font color=#447700>! column amount (n2o)<a name='9106'></font>
      real(kind=rb) :: colch4(nlay+1)         <font color=#447700>! column amount (ch4)<a name='9107'></font>
      real(kind=rb) :: colo2(nlay+1)          <font color=#447700>! column amount (o2)<a name='9108'></font>
      real(kind=rb) :: colmol(nlay+1)         <font color=#447700>! column amount<a name='9109'></font>
      real(kind=rb) :: co2mult(nlay+1)        <font color=#447700>! column amount <a name='9110'></font>
<a name='9111'>
      integer(kind=im) :: indself(nlay+1)<a name='9112'>
      integer(kind=im) :: indfor(nlay+1)<a name='9113'>
      real(kind=rb) :: selffac(nlay+1)<a name='9114'>
      real(kind=rb) :: selffrac(nlay+1)<a name='9115'>
      real(kind=rb) :: forfac(nlay+1)<a name='9116'>
      real(kind=rb) :: forfrac(nlay+1)<a name='9117'>
<a name='9118'>
      real(kind=rb) :: &amp;                      <font color=#447700>!<a name='9119'></font>
                         fac00(nlay+1), fac01(nlay+1), &amp;<a name='9120'>
                         fac10(nlay+1), fac11(nlay+1) <a name='9121'>
<a name='9122'>
<font color=#447700>! Atmosphere/clouds - cldprop<a name='9123'></font>
      integer(kind=im) :: ncbands             <font color=#447700>! number of cloud spectral bands<a name='9124'></font>
      integer(kind=im) :: inflag              <font color=#447700>! flag for cloud property method<a name='9125'></font>
      integer(kind=im) :: iceflag             <font color=#447700>! flag for ice cloud properties<a name='9126'></font>
      integer(kind=im) :: liqflag             <font color=#447700>! flag for liquid cloud properties<a name='9127'></font>
<a name='9128'>
<font color=#447700>!      real(kind=rb) :: cldfrac(nlay+1)        ! layer cloud fraction<a name='9129'></font>
<font color=#447700>!      real(kind=rb) :: tauc(nlay+1)           ! in-cloud optical depth (non-delta scaled)<a name='9130'></font>
<font color=#447700>!      real(kind=rb) :: ssac(nlay+1)           ! in-cloud single scattering albedo (non-delta scaled)<a name='9131'></font>
<font color=#447700>!      real(kind=rb) :: asmc(nlay+1)           ! in-cloud asymmetry parameter (non-delta scaled)<a name='9132'></font>
<font color=#447700>!      real(kind=rb) :: fsfc(nlay+1)           ! in-cloud forward scattering fraction (non-delta scaled)<a name='9133'></font>
<font color=#447700>!      real(kind=rb) :: ciwp(nlay+1)           ! in-cloud ice water path<a name='9134'></font>
<font color=#447700>!      real(kind=rb) :: clwp(nlay+1)           ! in-cloud liquid water path<a name='9135'></font>
<font color=#447700>!      real(kind=rb) :: rei(nlay+1)            ! cloud ice particle size<a name='9136'></font>
<font color=#447700>!      real(kind=rb) :: rel(nlay+1)            ! cloud liquid particle size<a name='9137'></font>
<a name='9138'>
<font color=#447700>!      real(kind=rb) :: taucloud(nlay+1,jpband)  ! in-cloud optical depth<a name='9139'></font>
<font color=#447700>!      real(kind=rb) :: taucldorig(nlay+1,jpband)! in-cloud optical depth (non-delta scaled)<a name='9140'></font>
<font color=#447700>!      real(kind=rb) :: ssacloud(nlay+1,jpband)  ! in-cloud single scattering albedo<a name='9141'></font>
<font color=#447700>!      real(kind=rb) :: asmcloud(nlay+1,jpband)  ! in-cloud asymmetry parameter<a name='9142'></font>
<a name='9143'>
<font color=#447700>! Atmosphere/clouds - cldprmc [mcica]<a name='9144'></font>
      real(kind=rb) :: cldfmc(ngptsw,nlay+1)    <font color=#447700>! cloud fraction [mcica]<a name='9145'></font>
      real(kind=rb) :: ciwpmc(ngptsw,nlay+1)    <font color=#447700>! in-cloud ice water path [mcica]<a name='9146'></font>
      real(kind=rb) :: clwpmc(ngptsw,nlay+1)    <font color=#447700>! in-cloud liquid water path [mcica]<a name='9147'></font>
      real(kind=rb) :: cswpmc(ngptsw,nlay+1)    <font color=#447700>! in-cloud snow water path [mcica]<a name='9148'></font>
      real(kind=rb) :: relqmc(nlay+1)           <font color=#447700>! liquid particle effective radius (microns)<a name='9149'></font>
      real(kind=rb) :: reicmc(nlay+1)           <font color=#447700>! ice particle effective size (microns)<a name='9150'></font>
      real(kind=rb) :: resnmc(nlay+1)           <font color=#447700>! snow particle effective size (microns)<a name='9151'></font>
      real(kind=rb) :: taucmc(ngptsw,nlay+1)    <font color=#447700>! in-cloud optical depth [mcica]<a name='9152'></font>
      real(kind=rb) :: taormc(ngptsw,nlay+1)    <font color=#447700>! unscaled in-cloud optical depth [mcica]<a name='9153'></font>
      real(kind=rb) :: ssacmc(ngptsw,nlay+1)    <font color=#447700>! in-cloud single scattering albedo [mcica]<a name='9154'></font>
      real(kind=rb) :: asmcmc(ngptsw,nlay+1)    <font color=#447700>! in-cloud asymmetry parameter [mcica]<a name='9155'></font>
      real(kind=rb) :: fsfcmc(ngptsw,nlay+1)    <font color=#447700>! in-cloud forward scattering fraction [mcica]<a name='9156'></font>
<a name='9157'>
<font color=#447700>! Atmosphere/clouds/aerosol - spcvrt,spcvmc<a name='9158'></font>
      real(kind=rb) :: ztauc(nlay+1,nbndsw)     <font color=#447700>! cloud optical depth<a name='9159'></font>
      real(kind=rb) :: ztaucorig(nlay+1,nbndsw) <font color=#447700>! unscaled cloud optical depth<a name='9160'></font>
      real(kind=rb) :: zasyc(nlay+1,nbndsw)     <font color=#447700>! cloud asymmetry parameter <a name='9161'></font>
                                                <font color=#447700>!  (first moment of phase function)<a name='9162'></font>
      real(kind=rb) :: zomgc(nlay+1,nbndsw)     <font color=#447700>! cloud single scattering albedo<a name='9163'></font>
      real(kind=rb) :: ztaua(nlay+1,nbndsw)     <font color=#447700>! total aerosol optical depth<a name='9164'></font>
      real(kind=rb) :: zasya(nlay+1,nbndsw)     <font color=#447700>! total aerosol asymmetry parameter <a name='9165'></font>
      real(kind=rb) :: zomga(nlay+1,nbndsw)     <font color=#447700>! total aerosol single scattering albedo<a name='9166'></font>
<a name='9167'>
      real(kind=rb) :: zcldfmc(nlay+1,ngptsw)   <font color=#447700>! cloud fraction [mcica]<a name='9168'></font>
      real(kind=rb) :: ztaucmc(nlay+1,ngptsw)   <font color=#447700>! cloud optical depth [mcica]<a name='9169'></font>
      real(kind=rb) :: ztaormc(nlay+1,ngptsw)   <font color=#447700>! unscaled cloud optical depth [mcica]<a name='9170'></font>
      real(kind=rb) :: zasycmc(nlay+1,ngptsw)   <font color=#447700>! cloud asymmetry parameter [mcica] <a name='9171'></font>
      real(kind=rb) :: zomgcmc(nlay+1,ngptsw)   <font color=#447700>! cloud single scattering albedo [mcica]<a name='9172'></font>
<a name='9173'>
      real(kind=rb) :: zbbfu(nlay+2)          <font color=#447700>! temporary upward shortwave flux (w/m2)<a name='9174'></font>
      real(kind=rb) :: zbbfd(nlay+2)          <font color=#447700>! temporary downward shortwave flux (w/m2)<a name='9175'></font>
      real(kind=rb) :: zbbcu(nlay+2)          <font color=#447700>! temporary clear sky upward shortwave flux (w/m2)<a name='9176'></font>
      real(kind=rb) :: zbbcd(nlay+2)          <font color=#447700>! temporary clear sky downward shortwave flux (w/m2)<a name='9177'></font>
      real(kind=rb) :: zbbfddir(nlay+2)       <font color=#447700>! temporary downward direct shortwave flux (w/m2)<a name='9178'></font>
      real(kind=rb) :: zbbcddir(nlay+2)       <font color=#447700>! temporary clear sky downward direct shortwave flux (w/m2)<a name='9179'></font>
      real(kind=rb) :: zuvfd(nlay+2)          <font color=#447700>! temporary UV downward shortwave flux (w/m2)<a name='9180'></font>
      real(kind=rb) :: zuvcd(nlay+2)          <font color=#447700>! temporary clear sky UV downward shortwave flux (w/m2)<a name='9181'></font>
      real(kind=rb) :: zuvfddir(nlay+2)       <font color=#447700>! temporary UV downward direct shortwave flux (w/m2)<a name='9182'></font>
      real(kind=rb) :: zuvcddir(nlay+2)       <font color=#447700>! temporary clear sky UV downward direct shortwave flux (w/m2)<a name='9183'></font>
      real(kind=rb) :: znifd(nlay+2)          <font color=#447700>! temporary near-IR downward shortwave flux (w/m2)<a name='9184'></font>
      real(kind=rb) :: znicd(nlay+2)          <font color=#447700>! temporary clear sky near-IR downward shortwave flux (w/m2)<a name='9185'></font>
      real(kind=rb) :: znifddir(nlay+2)       <font color=#447700>! temporary near-IR downward direct shortwave flux (w/m2)<a name='9186'></font>
      real(kind=rb) :: znicddir(nlay+2)       <font color=#447700>! temporary clear sky near-IR downward direct shortwave flux (w/m2)<a name='9187'></font>
<a name='9188'>
<font color=#447700>! Optional output fields <a name='9189'></font>
      real(kind=rb) :: swnflx(nlay+2)         <font color=#447700>! Total sky shortwave net flux (W/m2)<a name='9190'></font>
      real(kind=rb) :: swnflxc(nlay+2)        <font color=#447700>! Clear sky shortwave net flux (W/m2)<a name='9191'></font>
      real(kind=rb) :: dirdflux(nlay+2)       <font color=#447700>! Direct downward shortwave surface flux<a name='9192'></font>
      real(kind=rb) :: difdflux(nlay+2)       <font color=#447700>! Diffuse downward shortwave surface flux<a name='9193'></font>
      real(kind=rb) :: uvdflx(nlay+2)         <font color=#447700>! Total sky downward shortwave flux, UV/vis  <a name='9194'></font>
      real(kind=rb) :: nidflx(nlay+2)         <font color=#447700>! Total sky downward shortwave flux, near-IR <a name='9195'></font>
      real(kind=rb) :: dirdnuv(nlay+2)        <font color=#447700>! Direct downward shortwave flux, UV/vis<a name='9196'></font>
      real(kind=rb) :: difdnuv(nlay+2)        <font color=#447700>! Diffuse downward shortwave flux, UV/vis<a name='9197'></font>
      real(kind=rb) :: dirdnir(nlay+2)        <font color=#447700>! Direct downward shortwave flux, near-IR<a name='9198'></font>
      real(kind=rb) :: difdnir(nlay+2)        <font color=#447700>! Diffuse downward shortwave flux, near-IR<a name='9199'></font>
<a name='9200'>
<font color=#447700>! Output - inactive<a name='9201'></font>
<font color=#447700>!      real(kind=rb) :: zuvfu(nlay+2)         ! temporary upward UV shortwave flux (w/m2)<a name='9202'></font>
<font color=#447700>!      real(kind=rb) :: zuvfd(nlay+2)         ! temporary downward UV shortwave flux (w/m2)<a name='9203'></font>
<font color=#447700>!      real(kind=rb) :: zuvcu(nlay+2)         ! temporary clear sky upward UV shortwave flux (w/m2)<a name='9204'></font>
<font color=#447700>!      real(kind=rb) :: zuvcd(nlay+2)         ! temporary clear sky downward UV shortwave flux (w/m2)<a name='9205'></font>
<font color=#447700>!      real(kind=rb) :: zvsfu(nlay+2)         ! temporary upward visible shortwave flux (w/m2)<a name='9206'></font>
<font color=#447700>!      real(kind=rb) :: zvsfd(nlay+2)         ! temporary downward visible shortwave flux (w/m2)<a name='9207'></font>
<font color=#447700>!      real(kind=rb) :: zvscu(nlay+2)         ! temporary clear sky upward visible shortwave flux (w/m2)<a name='9208'></font>
<font color=#447700>!      real(kind=rb) :: zvscd(nlay+2)         ! temporary clear sky downward visible shortwave flux (w/m2)<a name='9209'></font>
<font color=#447700>!      real(kind=rb) :: znifu(nlay+2)         ! temporary upward near-IR shortwave flux (w/m2)<a name='9210'></font>
<font color=#447700>!      real(kind=rb) :: znifd(nlay+2)         ! temporary downward near-IR shortwave flux (w/m2)<a name='9211'></font>
<font color=#447700>!      real(kind=rb) :: znicu(nlay+2)         ! temporary clear sky upward near-IR shortwave flux (w/m2)<a name='9212'></font>
<font color=#447700>!      real(kind=rb) :: znicd(nlay+2)         ! temporary clear sky downward near-IR shortwave flux (w/m2)<a name='9213'></font>
<a name='9214'>
<a name='9215'>
<font color=#447700>! Initializations<a name='9216'></font>
<a name='9217'>
      iout = 0 <font color=#447700>!BSINGH(PNNL) initializing iout to zero(Might be wrong!) as this variable is never initialized but used in spcvmc_sw<a name='9218'></font>
      zepsec = 1.e-06_rb<a name='9219'>
      zepzen = 1.e-10_rb<a name='9220'>
<font color=#447700>!jm not thread safe      oneminus = 1.0_rb - zepsec<a name='9221'></font>
<font color=#447700>!jm not thread safe      pi = 2._rb * asin(1._rb)<a name='9222'></font>
<a name='9223'>
      istart = jpb1<a name='9224'>
      iend = jpb2<a name='9225'>
      icpr = 0<a name='9226'>
      ims = 2<a name='9227'>
<a name='9228'>
<font color=#447700>! In a GCM with or without McICA, set nlon to the longitude dimension<a name='9229'></font>
<font color=#447700>!<a name='9230'></font>
<font color=#447700>! Set imca to select calculation type:<a name='9231'></font>
<font color=#447700>!  imca = 0, use standard forward model calculation (clear and overcast only)<a name='9232'></font>
<font color=#447700>!  imca = 1, use McICA for Monte Carlo treatment of sub-grid cloud variability<a name='9233'></font>
<font color=#447700>!            (clear, overcast or partial cloud conditions)<a name='9234'></font>
<a name='9235'>
<font color=#447700>! *** This version uses McICA (imca = 1) ***<a name='9236'></font>
<a name='9237'>
<font color=#447700>! Set icld to select of clear or cloud calculation and cloud <a name='9238'></font>
<font color=#447700>! overlap method (read by subroutine readprof from input file INPUT_RRTM):  <a name='9239'></font>
<font color=#447700>! icld = 0, clear only<a name='9240'></font>
<font color=#447700>! icld = 1, with clouds using random cloud overlap (McICA only)<a name='9241'></font>
<font color=#447700>! icld = 2, with clouds using maximum/random cloud overlap (McICA only)<a name='9242'></font>
<font color=#447700>! icld = 3, with clouds using maximum cloud overlap (McICA only)<a name='9243'></font>
      if (icld.lt.0.or.icld.gt.3) icld = 2<a name='9244'>
<a name='9245'>
<font color=#447700>! Set iaer to select aerosol option<a name='9246'></font>
<font color=#447700>! iaer = 0, no aerosols<a name='9247'></font>
<font color=#447700>! iaer = 6, use six ECMWF aerosol types<a name='9248'></font>
<font color=#447700>!           input aerosol optical depth at 0.55 microns for each aerosol type (ecaer)<a name='9249'></font>
<font color=#447700>! iaer = 10, input total aerosol optical depth, single scattering albedo <a name='9250'></font>
<font color=#447700>!            and asymmetry parameter (tauaer, ssaaer, asmaer) directly<a name='9251'></font>
      if ( aer_opt.eq.0 .or. aer_opt.eq.2 .or. aer_opt.eq.3) then<a name='9252'>
      iaer = 10<a name='9253'>
      else if ( aer_opt .eq. 1 ) then<a name='9254'>
      iaer = 6<a name='9255'>
      endif<a name='9256'>
<a name='9257'>
<font color=#447700>! Call model and data initialization, compute lookup tables, perform<a name='9258'></font>
<font color=#447700>! reduction of g-points from 224 to 112 for input absorption<a name='9259'></font>
<font color=#447700>! coefficient data and other arrays.<a name='9260'></font>
<font color=#447700>!<a name='9261'></font>
<font color=#447700>! In a GCM this call should be placed in the model initialization<a name='9262'></font>
<font color=#447700>! area, since this has to be called only once.  <a name='9263'></font>
<font color=#447700>!      call rrtmg_sw_ini(cpdair)<a name='9264'></font>
<a name='9265'>
<font color=#447700>! This is the main longitude/column loop in RRTMG.<a name='9266'></font>
<font color=#447700>! Modify to loop over all columns (nlon) or over daylight columns<a name='9267'></font>
<a name='9268'>
      do iplon = 1, ncol<a name='9269'>
<a name='9270'>
<font color=#447700>! Prepare atmosphere profile from GCM for use in RRTMG, and define<a name='9271'></font>
<font color=#447700>! other input parameters<a name='9272'></font>
<a name='9273'>
         call <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW'>inatm_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INATM_SW_1"> (iplon, nlay, icld, iaer, &amp;<a name='9274'>
              play, plev, tlay, tlev, tsfc, h2ovmr, &amp;<a name='9275'>
              o3vmr, co2vmr, ch4vmr, n2ovmr, o2vmr, &amp;<a name='9276'>
              adjes, dyofyr, scon, inflgsw, iceflgsw, liqflgsw, &amp;<a name='9277'>
              cldfmcl, taucmcl, ssacmcl, asmcmcl, fsfcmcl, ciwpmcl, clwpmcl, cswpmcl, &amp;<a name='9278'>
              reicmcl, relqmcl, resnmcl, tauaer, ssaaer, asmaer, &amp;<a name='9279'>
              nlayers, pavel, pz, pdp, tavel, tz, tbound, coldry, wkl, &amp;<a name='9280'>
              adjflux, solvar, inflag, iceflag, liqflag, cldfmc, taucmc, &amp;<a name='9281'>
              ssacmc, asmcmc, fsfcmc, ciwpmc, clwpmc, cswpmc, reicmc, relqmc, resnmc, &amp;<a name='9282'>
              taua, ssaa, asma)<a name='9283'>
<a name='9284'>
<font color=#447700>!  For cloudy atmosphere, use cldprop to set cloud optical properties based on<a name='9285'></font>
<font color=#447700>!  input cloud physical properties.  Select method based on choices described<a name='9286'></font>
<font color=#447700>!  in cldprop.  Cloud fraction, water path, liquid droplet and ice particle<a name='9287'></font>
<font color=#447700>!  effective radius must be passed in cldprop.  Cloud fraction and cloud<a name='9288'></font>
<font color=#447700>!  optical properties are transferred to rrtmg_sw arrays in cldprop.  <a name='9289'></font>
<a name='9290'>
         call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW'>cldprmc_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CLDPRMC_SW_1">(nlayers, inflag, iceflag, liqflag, cldfmc, &amp;<a name='9291'>
                         ciwpmc, clwpmc, cswpmc, reicmc, relqmc, resnmc, &amp;<a name='9292'>
                         taormc, taucmc, ssacmc, asmcmc, fsfcmc)<a name='9293'>
         icpr = 1<a name='9294'>
<a name='9295'>
<font color=#447700>! Calculate coefficients for the temperature and pressure dependence of the <a name='9296'></font>
<font color=#447700>! molecular absorption coefficients by interpolating data from stored<a name='9297'></font>
<font color=#447700>! reference atmospheres.<a name='9298'></font>
<a name='9299'>
         call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SETCOEF_SW'>setcoef_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SETCOEF_SW_1">(nlayers, pavel, tavel, pz, tz, tbound, coldry, wkl, &amp;<a name='9300'>
                         laytrop, layswtch, laylow, jp, jt, jt1, &amp;<a name='9301'>
                         co2mult, colch4, colco2, colh2o, colmol, coln2o, &amp;<a name='9302'>
                         colo2, colo3, fac00, fac01, fac10, fac11, &amp;<a name='9303'>
                         selffac, selffrac, indself, forfac, forfrac, indfor)<a name='9304'>
<a name='9305'>
<a name='9306'>
<font color=#447700>! Cosine of the solar zenith angle <a name='9307'></font>
<font color=#447700>!  Prevent using value of zero; ideally, SW model is not called from host model when sun <a name='9308'></font>
<font color=#447700>!  is below horizon<a name='9309'></font>
<a name='9310'>
         cossza = coszen(iplon)<a name='9311'>
         if (cossza .le. zepzen) cossza = zepzen<a name='9312'>
<a name='9313'>
<font color=#447700>! Transfer albedo, cloud and aerosol properties into arrays for 2-stream radiative transfer <a name='9314'></font>
<a name='9315'>
<font color=#447700>! Surface albedo<a name='9316'></font>
<font color=#447700>!  Near-IR bands 16-24 and 29 (1-9 and 14), 820-16000 cm-1, 0.625-12.195 microns<a name='9317'></font>
         do ib=1,9<a name='9318'>
            albdir(ib) = aldir(iplon)<a name='9319'>
            albdif(ib) = aldif(iplon)<a name='9320'>
         enddo<a name='9321'>
         albdir(nbndsw) = aldir(iplon)<a name='9322'>
         albdif(nbndsw) = aldif(iplon)<a name='9323'>
<font color=#447700>!  UV/visible bands 25-28 (10-13), 16000-50000 cm-1, 0.200-0.625 micron<a name='9324'></font>
         do ib=10,13<a name='9325'>
            albdir(ib) = asdir(iplon)<a name='9326'>
            albdif(ib) = asdif(iplon)<a name='9327'>
         enddo<a name='9328'>
<a name='9329'>
<a name='9330'>
<font color=#447700>! Clouds<a name='9331'></font>
         if (icld.eq.0) then<a name='9332'>
<a name='9333'>
            zcldfmc(:,:) = 0._rb<a name='9334'>
            ztaucmc(:,:) = 0._rb<a name='9335'>
            ztaormc(:,:) = 0._rb<a name='9336'>
            zasycmc(:,:) = 0._rb<a name='9337'>
            zomgcmc(:,:) = 1._rb<a name='9338'>
<a name='9339'>
         elseif (icld.ge.1) then<a name='9340'>
            do i=1,nlayers<a name='9341'>
               do ig=1,ngptsw<a name='9342'>
                  zcldfmc(i,ig) = cldfmc(ig,i)<a name='9343'>
                  ztaucmc(i,ig) = taucmc(ig,i)<a name='9344'>
                  ztaormc(i,ig) = taormc(ig,i)<a name='9345'>
                  zasycmc(i,ig) = asmcmc(ig,i)<a name='9346'>
                  zomgcmc(i,ig) = ssacmc(ig,i)<a name='9347'>
               enddo<a name='9348'>
            enddo<a name='9349'>
<a name='9350'>
         endif   <a name='9351'>
<a name='9352'>
<font color=#447700>! Aerosol<a name='9353'></font>
<font color=#447700>! IAER = 0: no aerosols<a name='9354'></font>
         if (iaer.eq.0) then<a name='9355'>
<a name='9356'>
            ztaua(:,:) = 0._rb<a name='9357'>
            zasya(:,:) = 0._rb<a name='9358'>
            zomga(:,:) = 1._rb<a name='9359'>
<a name='9360'>
<font color=#447700>! IAER = 6: Use ECMWF six aerosol types. See rrsw_aer.f90 for details.<a name='9361'></font>
<font color=#447700>! Input aerosol optical thickness at 0.55 micron for each aerosol type (ecaer), <a name='9362'></font>
<font color=#447700>! or set manually here for each aerosol and layer.<a name='9363'></font>
         elseif (iaer.eq.6) then<a name='9364'>
<a name='9365'>
<font color=#447700>!            do i = 1, nlayers<a name='9366'></font>
<font color=#447700>!               do ia = 1, naerec<a name='9367'></font>
<font color=#447700>!                  ecaer(iplon,i,ia) = 1.0e-15_rb<a name='9368'></font>
<font color=#447700>!               enddo<a name='9369'></font>
<font color=#447700>!            enddo<a name='9370'></font>
<a name='9371'>
            do i = 1, nlayers<a name='9372'>
               do ib = 1, nbndsw<a name='9373'>
                  ztaua(i,ib) = 0._rb<a name='9374'>
                  zasya(i,ib) = 0._rb<a name='9375'>
                  zomga(i,ib) = 0._rb<a name='9376'>
                  do ia = 1, naerec<a name='9377'>
                     ztaua(i,ib) = ztaua(i,ib) + rsrtaua(ib,ia) * ecaer(iplon,i,ia)<a name='9378'>
                     zomga(i,ib) = zomga(i,ib) + rsrtaua(ib,ia) * ecaer(iplon,i,ia) * &amp;<a name='9379'>
                                   rsrpiza(ib,ia)<a name='9380'>
                     zasya(i,ib) = zasya(i,ib) + rsrtaua(ib,ia) * ecaer(iplon,i,ia) * &amp;<a name='9381'>
                                   rsrpiza(ib,ia) * rsrasya(ib,ia)<a name='9382'>
                  enddo<a name='9383'>
                  if (zomga(i,ib) /= 0._rb) then<a name='9384'>
                     zasya(i,ib) = zasya(i,ib) / zomga(i,ib)<a name='9385'>
                  endif<a name='9386'>
                  if (ztaua(i,ib) /= 0._rb) then<a name='9387'>
                     zomga(i,ib) = zomga(i,ib) / ztaua(i,ib)<a name='9388'>
                  endif<a name='9389'>
               enddo<a name='9390'>
            enddo<a name='9391'>
<a name='9392'>
<font color=#447700>! IAER=10: Direct specification of aerosol optical properties from GCM<a name='9393'></font>
         elseif (iaer.eq.10) then<a name='9394'>
<a name='9395'>
            do i = 1 ,nlayers<a name='9396'>
               do ib = 1 ,nbndsw<a name='9397'>
                  ztaua(i,ib) = taua(i,ib)<a name='9398'>
                  zasya(i,ib) = asma(i,ib)<a name='9399'>
                  zomga(i,ib) = ssaa(i,ib)<a name='9400'>
               enddo<a name='9401'>
            enddo<a name='9402'>
<a name='9403'>
         endif<a name='9404'>
<a name='9405'>
<a name='9406'>
<font color=#447700>! Call the 2-stream radiation transfer model<a name='9407'></font>
<a name='9408'>
         do i=1,nlayers+1<a name='9409'>
            zbbcu(i) = 0._rb<a name='9410'>
            zbbcd(i) = 0._rb<a name='9411'>
            zbbfu(i) = 0._rb<a name='9412'>
            zbbfd(i) = 0._rb<a name='9413'>
            zbbcddir(i) = 0._rb<a name='9414'>
            zbbfddir(i) = 0._rb<a name='9415'>
            zuvcd(i) = 0._rb<a name='9416'>
            zuvfd(i) = 0._rb<a name='9417'>
            zuvcddir(i) = 0._rb<a name='9418'>
            zuvfddir(i) = 0._rb<a name='9419'>
            znicd(i) = 0._rb<a name='9420'>
            znifd(i) = 0._rb<a name='9421'>
            znicddir(i) = 0._rb<a name='9422'>
            znifddir(i) = 0._rb<a name='9423'>
         enddo<a name='9424'>
<a name='9425'>
         call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW'>spcvmc_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SPCVMC_SW_1"> &amp;<a name='9426'>
             (nlayers, istart, iend, icpr, iout, &amp;<a name='9427'>
              pavel, tavel, pz, tz, tbound, albdif, albdir, &amp;<a name='9428'>
              zcldfmc, ztaucmc, zasycmc, zomgcmc, ztaormc, &amp;<a name='9429'>
              ztaua, zasya, zomga, cossza, coldry, wkl, adjflux, &amp;	 <a name='9430'>
              laytrop, layswtch, laylow, jp, jt, jt1, &amp;<a name='9431'>
              co2mult, colch4, colco2, colh2o, colmol, coln2o, colo2, colo3, &amp;<a name='9432'>
              fac00, fac01, fac10, fac11, &amp;<a name='9433'>
              selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='9434'>
              zbbfd, zbbfu, zbbcd, zbbcu, zuvfd, zuvcd, znifd, znicd, &amp;<a name='9435'>
              zbbfddir, zbbcddir, zuvfddir, zuvcddir, znifddir, znicddir)<a name='9436'>
<a name='9437'>
<font color=#447700>! Transfer up and down, clear and total sky fluxes to output arrays.<a name='9438'></font>
<font color=#447700>! Vertical indexing goes from bottom to top; reverse here for GCM if necessary.<a name='9439'></font>
<a name='9440'>
         do i = 1, nlayers+1<a name='9441'>
            swuflxc(iplon,i) = zbbcu(i)<a name='9442'>
            swdflxc(iplon,i) = zbbcd(i)<a name='9443'>
            swuflx(iplon,i) = zbbfu(i)<a name='9444'>
            swdflx(iplon,i) = zbbfd(i)<a name='9445'>
            uvdflx(i) = zuvfd(i)<a name='9446'>
            nidflx(i) = znifd(i)<a name='9447'>
<a name='9448'>
<font color=#447700>!  Direct/diffuse fluxes<a name='9449'></font>
            dirdflux(i) = zbbfddir(i)<a name='9450'>
            difdflux(i) = swdflx(iplon,i) - dirdflux(i)<a name='9451'>
            swdkdir(iplon,i) = dirdflux(i) <font color=#447700>! all-sky direct flux   jararias, 2013/08/10<a name='9452'></font>
            swdkdif(iplon,i) = difdflux(i) <font color=#447700>! all-sky diffuse flux  jararias, 2013/08/10<a name='9453'></font>
<a name='9454'>
<font color=#447700>!  UV/visible direct/diffuse fluxes<a name='9455'></font>
            dirdnuv(i) = zuvfddir(i)<a name='9456'>
            difdnuv(i) = zuvfd(i) - dirdnuv(i)<a name='9457'>
<font color=#447700>!  ------- Zhenxin add vis/uv downwards dir or dif here --!<a name='9458'></font>
            sibvisdir(iplon,i) = dirdnuv(i)<a name='9459'>
            sibvisdif(iplon,i) = difdnuv(i)<a name='9460'>
<font color=#447700>!  ----- End of Zhenxin addition  ------------!<a name='9461'></font>
<font color=#447700>!  Near-IR direct/diffuse fluxes<a name='9462'></font>
            dirdnir(i) = znifddir(i)<a name='9463'>
            difdnir(i) = znifd(i) - dirdnir(i)<a name='9464'>
<font color=#447700>!  ---------Zhenxin add nir downwards dir and dif here --!<a name='9465'></font>
            sibnirdir(iplon,i) = dirdnir(i)<a name='9466'>
            sibnirdif(iplon,i) = difdnir(i)<a name='9467'>
<font color=#447700>!  --------    End of Zhenxin addition 2011-05  ---------!<a name='9468'></font>
         enddo<a name='9469'>
<a name='9470'>
<font color=#447700>!  Total and clear sky net fluxes<a name='9471'></font>
         do i = 1, nlayers+1<a name='9472'>
            swnflxc(i) = swdflxc(iplon,i) - swuflxc(iplon,i)<a name='9473'>
            swnflx(i) = swdflx(iplon,i) - swuflx(iplon,i)<a name='9474'>
         enddo<a name='9475'>
<a name='9476'>
<font color=#447700>!  Total and clear sky heating rates<a name='9477'></font>
         do i = 1, nlayers<a name='9478'>
            zdpgcp = heatfac / pdp(i)<a name='9479'>
            swhrc(iplon,i) = (swnflxc(i+1) - swnflxc(i)) * zdpgcp<a name='9480'>
            swhr(iplon,i) = (swnflx(i+1) - swnflx(i)) * zdpgcp<a name='9481'>
         enddo<a name='9482'>
         swhrc(iplon,nlayers) = 0._rb<a name='9483'>
         swhr(iplon,nlayers) = 0._rb<a name='9484'>
<a name='9485'>
<font color=#447700>! End longitude loop<a name='9486'></font>
      enddo<a name='9487'>
<a name='9488'>
      end subroutine rrtmg_sw<a name='9489'>
<a name='9490'>
<font color=#447700>!*************************************************************************<a name='9491'></font>
<A NAME='EARTH_SUN'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#EARTH_SUN' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='9492'>
      real(kind=rb) <font color=#993300>function </font><font color=#cc0000>earth_sun</font>(idn) <A href='../../call_to/EARTH_SUN.html' TARGET='index'>2</A>,<A href='../../call_from/EARTH_SUN.html' TARGET='index'>8</A><a name='9493'>
<font color=#447700>!*************************************************************************<a name='9494'></font>
<font color=#447700>!<a name='9495'></font>
<font color=#447700>!  Purpose: Function to calculate the correction factor of Earth's orbit<a name='9496'></font>
<font color=#447700>!  for current day of the year<a name='9497'></font>
<a name='9498'>
<font color=#447700>!  idn        : Day of the year<a name='9499'></font>
<font color=#447700>!  earth_sun  : square of the ratio of mean to actual Earth-Sun distance<a name='9500'></font>
<a name='9501'>
<font color=#447700>! ------- Modules -------<a name='9502'></font>
<a name='9503'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_CON'>rrsw_con</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#EARTH_SUN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CON_5">, only : pi<a name='9504'>
<a name='9505'>
      integer(kind=im), intent(in) :: idn<a name='9506'>
<a name='9507'>
      real(kind=rb) :: gamma<a name='9508'>
<a name='9509'>
      gamma = 2._rb*pi*(idn-1)/365._rb<a name='9510'>
<a name='9511'>
<font color=#447700>! Use Iqbal's equation 1.2.1<a name='9512'></font>
<a name='9513'>
      earth_sun = 1.000110_rb + .034221_rb * cos(gamma) + .001289_rb * sin(gamma) + &amp;<a name='9514'>
                   .000719_rb * cos(2._rb*gamma) + .000077_rb * sin(2._rb*gamma)<a name='9515'>
<a name='9516'>
      end function earth_sun<a name='9517'>
<a name='9518'>
<font color=#447700>!***************************************************************************<a name='9519'></font>
<A NAME='INATM_SW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='9520'>
      <font color=#993300>subroutine </font><font color=#cc0000>inatm_sw</font> (iplon, nlay, icld, iaer, &amp; <A href='../../call_to/INATM_SW.html' TARGET='index'>1</A>,<A href='../../call_from/INATM_SW.html' TARGET='index'>13</A><a name='9521'>
            play, plev, tlay, tlev, tsfc, h2ovmr, &amp;<a name='9522'>
            o3vmr, co2vmr, ch4vmr, n2ovmr, o2vmr, &amp;<a name='9523'>
            adjes, dyofyr, scon, inflgsw, iceflgsw, liqflgsw, &amp;<a name='9524'>
            cldfmcl, taucmcl, ssacmcl, asmcmcl, fsfcmcl, ciwpmcl, clwpmcl, cswpmcl, &amp;<a name='9525'>
            reicmcl, relqmcl, resnmcl, tauaer, ssaaer, asmaer, &amp;<a name='9526'>
            nlayers, pavel, pz, pdp, tavel, tz, tbound, coldry, wkl, &amp;<a name='9527'>
            adjflux, solvar, inflag, iceflag, liqflag, cldfmc, taucmc, &amp;<a name='9528'>
            ssacmc, asmcmc, fsfcmc, ciwpmc, clwpmc, cswpmc, reicmc, relqmc, resnmc, &amp;<a name='9529'>
            taua, ssaa, asma)                                       <a name='9530'>
<font color=#447700>!***************************************************************************<a name='9531'></font>
<font color=#447700>!<a name='9532'></font>
<font color=#447700>!  Input atmospheric profile from GCM, and prepare it for use in RRTMG_SW.<a name='9533'></font>
<font color=#447700>!  Set other RRTMG_SW input parameters.  <a name='9534'></font>
<font color=#447700>!<a name='9535'></font>
<font color=#447700>!***************************************************************************<a name='9536'></font>
<a name='9537'>
<font color=#447700>! --------- Modules ----------<a name='9538'></font>
<a name='9539'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_37">, only : nbndsw, ngptsw, nstr, nmol, mxmol, &amp;<a name='9540'>
                          jpband, jpb1, jpb2, rrsw_scon<a name='9541'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_CON'>rrsw_con</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CON_6">, only : heatfac, oneminus, pi, grav, avogad<a name='9542'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_WVN'>rrsw_wvn</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_7">, only : ng, nspa, nspb, wavenum1, wavenum2, delwave<a name='9543'>
<a name='9544'>
<font color=#447700>! ------- Declarations -------<a name='9545'></font>
<a name='9546'>
<font color=#447700>! ----- Input -----<a name='9547'></font>
      integer(kind=im), intent(in) :: iplon           <font color=#447700>! column loop index<a name='9548'></font>
      integer(kind=im), intent(in) :: nlay            <font color=#447700>! number of model layers<a name='9549'></font>
      integer(kind=im), intent(in) :: icld            <font color=#447700>! clear/cloud and cloud overlap flag<a name='9550'></font>
      integer(kind=im), intent(in) :: iaer            <font color=#447700>! aerosol option flag<a name='9551'></font>
<a name='9552'>
      real(kind=rb), intent(in) :: play(:,:)          <font color=#447700>! Layer pressures (hPa, mb)<a name='9553'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay)<a name='9554'></font>
      real(kind=rb), intent(in) :: plev(:,:)          <font color=#447700>! Interface pressures (hPa, mb)<a name='9555'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay+1)<a name='9556'></font>
      real(kind=rb), intent(in) :: tlay(:,:)          <font color=#447700>! Layer temperatures (K)<a name='9557'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay)<a name='9558'></font>
      real(kind=rb), intent(in) :: tlev(:,:)          <font color=#447700>! Interface temperatures (K)<a name='9559'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay+1)<a name='9560'></font>
      real(kind=rb), intent(in) :: tsfc(:)            <font color=#447700>! Surface temperature (K)<a name='9561'></font>
                                                      <font color=#447700>! Dimensions: (ncol)<a name='9562'></font>
      real(kind=rb), intent(in) :: h2ovmr(:,:)        <font color=#447700>! H2O volume mixing ratio<a name='9563'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay)<a name='9564'></font>
      real(kind=rb), intent(in) :: o3vmr(:,:)         <font color=#447700>! O3 volume mixing ratio<a name='9565'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay)<a name='9566'></font>
      real(kind=rb), intent(in) :: co2vmr(:,:)        <font color=#447700>! CO2 volume mixing ratio<a name='9567'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay)<a name='9568'></font>
      real(kind=rb), intent(in) :: ch4vmr(:,:)        <font color=#447700>! Methane volume mixing ratio<a name='9569'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay)<a name='9570'></font>
      real(kind=rb), intent(in) :: n2ovmr(:,:)        <font color=#447700>! Nitrous oxide volume mixing ratio<a name='9571'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay)<a name='9572'></font>
      real(kind=rb), intent(in) :: o2vmr(:,:)         <font color=#447700>! Oxygen volume mixing ratio<a name='9573'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay)<a name='9574'></font>
<a name='9575'>
      integer(kind=im), intent(in) :: dyofyr          <font color=#447700>! Day of the year (used to get Earth/Sun<a name='9576'></font>
                                                      <font color=#447700>!  distance if adjflx not provided)<a name='9577'></font>
      real(kind=rb), intent(in) :: adjes              <font color=#447700>! Flux adjustment for Earth/Sun distance<a name='9578'></font>
      real(kind=rb), intent(in) :: scon               <font color=#447700>! Solar constant (W/m2)<a name='9579'></font>
<a name='9580'>
      integer(kind=im), intent(in) :: inflgsw         <font color=#447700>! Flag for cloud optical properties<a name='9581'></font>
      integer(kind=im), intent(in) :: iceflgsw        <font color=#447700>! Flag for ice particle specification<a name='9582'></font>
      integer(kind=im), intent(in) :: liqflgsw        <font color=#447700>! Flag for liquid droplet specification<a name='9583'></font>
<a name='9584'>
      real(kind=rb), intent(in) :: cldfmcl(:,:,:)     <font color=#447700>! Cloud fraction<a name='9585'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,ncol,nlay)<a name='9586'></font>
      real(kind=rb), intent(in) :: taucmcl(:,:,:)     <font color=#447700>! In-cloud optical depth (optional)<a name='9587'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,ncol,nlay)<a name='9588'></font>
      real(kind=rb), intent(in) :: ssacmcl(:,:,:)     <font color=#447700>! In-cloud single scattering albedo<a name='9589'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,ncol,nlay)<a name='9590'></font>
      real(kind=rb), intent(in) :: asmcmcl(:,:,:)     <font color=#447700>! In-cloud asymmetry parameter<a name='9591'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,ncol,nlay)<a name='9592'></font>
      real(kind=rb), intent(in) :: fsfcmcl(:,:,:)     <font color=#447700>! In-cloud forward scattering fraction<a name='9593'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,ncol,nlay)<a name='9594'></font>
      real(kind=rb), intent(in) :: ciwpmcl(:,:,:)     <font color=#447700>! In-cloud ice water path (g/m2)<a name='9595'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,ncol,nlay)<a name='9596'></font>
      real(kind=rb), intent(in) :: clwpmcl(:,:,:)     <font color=#447700>! In-cloud liquid water path (g/m2)<a name='9597'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,ncol,nlay)<a name='9598'></font>
      real(kind=rb), intent(in) :: cswpmcl(:,:,:)     <font color=#447700>! In-cloud snow water path (g/m2)<a name='9599'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,ncol,nlay)<a name='9600'></font>
      real(kind=rb), intent(in) :: reicmcl(:,:)       <font color=#447700>! Cloud ice effective size (microns)<a name='9601'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay)<a name='9602'></font>
      real(kind=rb), intent(in) :: relqmcl(:,:)       <font color=#447700>! Cloud water drop effective radius (microns)<a name='9603'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay)<a name='9604'></font>
      real(kind=rb), intent(in) :: resnmcl(:,:)       <font color=#447700>! Cloud snow effective radius (microns)<a name='9605'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay)<a name='9606'></font>
<a name='9607'>
      real(kind=rb), intent(in) :: tauaer(:,:,:)      <font color=#447700>! Aerosol optical depth<a name='9608'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay,nbndsw)<a name='9609'></font>
      real(kind=rb), intent(in) :: ssaaer(:,:,:)      <font color=#447700>! Aerosol single scattering albedo<a name='9610'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay,nbndsw)<a name='9611'></font>
      real(kind=rb), intent(in) :: asmaer(:,:,:)      <font color=#447700>! Aerosol asymmetry parameter<a name='9612'></font>
                                                      <font color=#447700>! Dimensions: (ncol,nlay,nbndsw)<a name='9613'></font>
<a name='9614'>
<font color=#447700>! Atmosphere<a name='9615'></font>
      integer(kind=im), intent(out) :: nlayers        <font color=#447700>! number of layers<a name='9616'></font>
<a name='9617'>
      real(kind=rb), intent(out) :: pavel(:)          <font color=#447700>! layer pressures (mb) <a name='9618'></font>
                                                      <font color=#447700>! Dimensions: (nlay)<a name='9619'></font>
      real(kind=rb), intent(out) :: tavel(:)          <font color=#447700>! layer temperatures (K)<a name='9620'></font>
                                                      <font color=#447700>! Dimensions: (nlay)<a name='9621'></font>
      real(kind=rb), intent(out) :: pz(0:)            <font color=#447700>! level (interface) pressures (hPa, mb)<a name='9622'></font>
                                                      <font color=#447700>! Dimensions: (0:nlay)<a name='9623'></font>
      real(kind=rb), intent(out) :: tz(0:)            <font color=#447700>! level (interface) temperatures (K)<a name='9624'></font>
                                                      <font color=#447700>! Dimensions: (0:nlay)<a name='9625'></font>
      real(kind=rb), intent(out) :: tbound            <font color=#447700>! surface temperature (K)<a name='9626'></font>
      real(kind=rb), intent(out) :: pdp(:)            <font color=#447700>! layer pressure thickness (hPa, mb)<a name='9627'></font>
                                                      <font color=#447700>! Dimensions: (nlay)<a name='9628'></font>
      real(kind=rb), intent(out) :: coldry(:)         <font color=#447700>! dry air column density (mol/cm2)<a name='9629'></font>
                                                      <font color=#447700>! Dimensions: (nlay)<a name='9630'></font>
      real(kind=rb), intent(out) :: wkl(:,:)          <font color=#447700>! molecular amounts (mol/cm-2)<a name='9631'></font>
                                                      <font color=#447700>! Dimensions: (mxmol,nlay)<a name='9632'></font>
<a name='9633'>
      real(kind=rb), intent(out) :: adjflux(:)        <font color=#447700>! adjustment for current Earth/Sun distance<a name='9634'></font>
                                                      <font color=#447700>! Dimensions: (jpband)<a name='9635'></font>
      real(kind=rb), intent(out) :: solvar(:)         <font color=#447700>! solar constant scaling factor from rrtmg_sw<a name='9636'></font>
                                                      <font color=#447700>! Dimensions: (jpband)<a name='9637'></font>
                                                      <font color=#447700>!  default value of 1368.22 Wm-2 at 1 AU<a name='9638'></font>
      real(kind=rb), intent(out) :: taua(:,:)         <font color=#447700>! Aerosol optical depth<a name='9639'></font>
                                                      <font color=#447700>! Dimensions: (nlay,nbndsw)<a name='9640'></font>
      real(kind=rb), intent(out) :: ssaa(:,:)         <font color=#447700>! Aerosol single scattering albedo<a name='9641'></font>
                                                      <font color=#447700>! Dimensions: (nlay,nbndsw)<a name='9642'></font>
      real(kind=rb), intent(out) :: asma(:,:)         <font color=#447700>! Aerosol asymmetry parameter<a name='9643'></font>
                                                      <font color=#447700>! Dimensions: (nlay,nbndsw)<a name='9644'></font>
<a name='9645'>
<font color=#447700>! Atmosphere/clouds - cldprop<a name='9646'></font>
      integer(kind=im), intent(out) :: inflag         <font color=#447700>! flag for cloud property method<a name='9647'></font>
      integer(kind=im), intent(out) :: iceflag        <font color=#447700>! flag for ice cloud properties<a name='9648'></font>
      integer(kind=im), intent(out) :: liqflag        <font color=#447700>! flag for liquid cloud properties<a name='9649'></font>
<a name='9650'>
      real(kind=rb), intent(out) :: cldfmc(:,:)       <font color=#447700>! layer cloud fraction<a name='9651'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,nlay)<a name='9652'></font>
      real(kind=rb), intent(out) :: taucmc(:,:)       <font color=#447700>! in-cloud optical depth (non-delta scaled)<a name='9653'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,nlay)<a name='9654'></font>
      real(kind=rb), intent(out) :: ssacmc(:,:)       <font color=#447700>! in-cloud single scattering albedo (non-delta-scaled)<a name='9655'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,nlay)<a name='9656'></font>
      real(kind=rb), intent(out) :: asmcmc(:,:)       <font color=#447700>! in-cloud asymmetry parameter (non-delta scaled)<a name='9657'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,nlay)<a name='9658'></font>
      real(kind=rb), intent(out) :: fsfcmc(:,:)       <font color=#447700>! in-cloud forward scattering fraction (non-delta scaled)<a name='9659'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,nlay)<a name='9660'></font>
      real(kind=rb), intent(out) :: ciwpmc(:,:)       <font color=#447700>! in-cloud ice water path<a name='9661'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,nlay)<a name='9662'></font>
      real(kind=rb), intent(out) :: clwpmc(:,:)       <font color=#447700>! in-cloud liquid water path<a name='9663'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,nlay)<a name='9664'></font>
      real(kind=rb), intent(out) :: cswpmc(:,:)       <font color=#447700>! in-cloud snow path<a name='9665'></font>
                                                      <font color=#447700>! Dimensions: (ngptsw,nlay)<a name='9666'></font>
      real(kind=rb), intent(out) :: relqmc(:)         <font color=#447700>! liquid particle effective radius (microns)<a name='9667'></font>
                                                      <font color=#447700>! Dimensions: (nlay)<a name='9668'></font>
      real(kind=rb), intent(out) :: reicmc(:)         <font color=#447700>! ice particle effective size (microns)<a name='9669'></font>
                                                      <font color=#447700>! Dimensions: (nlay)<a name='9670'></font>
      real(kind=rb), intent(out) :: resnmc(:)         <font color=#447700>! snow particle effective size (microns)<a name='9671'></font>
                                                      <font color=#447700>! Dimensions: (nlay)<a name='9672'></font>
<a name='9673'>
<font color=#447700>! ----- Local -----<a name='9674'></font>
      real(kind=rb), parameter :: amd = 28.9660_rb    <font color=#447700>! Effective molecular weight of dry air (g/mol)<a name='9675'></font>
      real(kind=rb), parameter :: amw = 18.0160_rb    <font color=#447700>! Molecular weight of water vapor (g/mol)<a name='9676'></font>
<font color=#447700>!      real(kind=rb), parameter :: amc = 44.0098_rb   ! Molecular weight of carbon dioxide (g/mol)<a name='9677'></font>
<font color=#447700>!      real(kind=rb), parameter :: amo = 47.9998_rb   ! Molecular weight of ozone (g/mol)<a name='9678'></font>
<font color=#447700>!      real(kind=rb), parameter :: amo2 = 31.9999_rb  ! Molecular weight of oxygen (g/mol)<a name='9679'></font>
<font color=#447700>!      real(kind=rb), parameter :: amch4 = 16.0430_rb ! Molecular weight of methane (g/mol)<a name='9680'></font>
<font color=#447700>!      real(kind=rb), parameter :: amn2o = 44.0128_rb ! Molecular weight of nitrous oxide (g/mol)<a name='9681'></font>
<a name='9682'>
<font color=#447700>! Set molecular weight ratios (for converting mmr to vmr)<a name='9683'></font>
<font color=#447700>!  e.g. h2ovmr = h2ommr * amdw)<a name='9684'></font>
      real(kind=rb), parameter :: amdw = 1.607793_rb  <font color=#447700>! Molecular weight of dry air / water vapor<a name='9685'></font>
      real(kind=rb), parameter :: amdc = 0.658114_rb  <font color=#447700>! Molecular weight of dry air / carbon dioxide<a name='9686'></font>
      real(kind=rb), parameter :: amdo = 0.603428_rb  <font color=#447700>! Molecular weight of dry air / ozone<a name='9687'></font>
      real(kind=rb), parameter :: amdm = 1.805423_rb  <font color=#447700>! Molecular weight of dry air / methane<a name='9688'></font>
      real(kind=rb), parameter :: amdn = 0.658090_rb  <font color=#447700>! Molecular weight of dry air / nitrous oxide<a name='9689'></font>
      real(kind=rb), parameter :: amdo2 = 0.905140_rb <font color=#447700>! Molecular weight of dry air / oxygen<a name='9690'></font>
<a name='9691'>
      real(kind=rb), parameter :: sbc = 5.67e-08_rb   <font color=#447700>! Stefan-Boltzmann constant (W/m2K4)<a name='9692'></font>
<a name='9693'>
      integer(kind=im) :: isp, l, ix, n, imol, ib, ig   <font color=#447700>! Loop indices<a name='9694'></font>
      real(kind=rb) :: amm, summol                      <font color=#447700>! <a name='9695'></font>
      real(kind=rb) :: adjflx                           <font color=#447700>! flux adjustment for Earth/Sun distance<a name='9696'></font>
<font color=#447700>!      real(kind=rb) :: earth_sun                        ! function for Earth/Sun distance adjustment<a name='9697'></font>
<a name='9698'>
      nlayers = nlay<a name='9699'>
<a name='9700'>
<font color=#447700>!  Initialize all molecular amounts to zero here, then pass input amounts<a name='9701'></font>
<font color=#447700>!  into RRTM array WKL below.<a name='9702'></font>
<a name='9703'>
       wkl(:,:) = 0.0_rb<a name='9704'>
       cldfmc(:,:) = 0.0_rb<a name='9705'>
       taucmc(:,:) = 0.0_rb<a name='9706'>
       ssacmc(:,:) = 1.0_rb<a name='9707'>
       asmcmc(:,:) = 0.0_rb<a name='9708'>
       fsfcmc(:,:) = 0.0_rb<a name='9709'>
       ciwpmc(:,:) = 0.0_rb<a name='9710'>
       clwpmc(:,:) = 0.0_rb<a name='9711'>
       cswpmc(:,:) = 0.0_rb<a name='9712'>
       reicmc(:) = 0.0_rb<a name='9713'>
       relqmc(:) = 0.0_rb<a name='9714'>
       resnmc(:) = 0.0_rb<a name='9715'>
       taua(:,:) = 0.0_rb<a name='9716'>
       ssaa(:,:) = 1.0_rb<a name='9717'>
       asma(:,:) = 0.0_rb<a name='9718'>
 <a name='9719'>
<font color=#447700>! Set flux adjustment for current Earth/Sun distance (two options).<a name='9720'></font>
<font color=#447700>! 1) Use Earth/Sun distance flux adjustment provided by GCM (input as adjes);<a name='9721'></font>
      adjflx = adjes<a name='9722'>
<font color=#447700>!<a name='9723'></font>
<font color=#447700>! 2) Calculate Earth/Sun distance from DYOFYR, the cumulative day of the year.<a name='9724'></font>
<font color=#447700>!    (Set adjflx to 1. to use constant Earth/Sun distance of 1 AU). <a name='9725'></font>
      if (dyofyr .gt. 0) then<a name='9726'>
         adjflx = <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#EARTH_SUN'>earth_sun</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EARTH_SUN_1">(dyofyr)<a name='9727'>
      endif<a name='9728'>
<a name='9729'>
<font color=#447700>! Set incoming solar flux adjustment to include adjustment for<a name='9730'></font>
<font color=#447700>! current Earth/Sun distance (ADJFLX) and scaling of default internal<a name='9731'></font>
<font color=#447700>! solar constant (rrsw_scon = 1368.22 Wm-2) by band (SOLVAR).  SOLVAR can be set <a name='9732'></font>
<font color=#447700>! to a single scaling factor as needed, or to a different value in each <a name='9733'></font>
<font color=#447700>! band, which may be necessary for paleoclimate simulations. <a name='9734'></font>
<font color=#447700>! <a name='9735'></font>
      do ib = jpb1,jpb2<a name='9736'>
<font color=#447700>!         solvar(ib) = 1._rb<a name='9737'></font>
         solvar(ib) = scon / rrsw_scon <a name='9738'>
         adjflux(ib) = adjflx * solvar(ib)<a name='9739'>
      enddo<a name='9740'>
<a name='9741'>
<font color=#447700>!  Set surface temperature.<a name='9742'></font>
      tbound = tsfc(iplon)<a name='9743'>
<a name='9744'>
<font color=#447700>!  Install input GCM arrays into RRTMG_SW arrays for pressure, temperature,<a name='9745'></font>
<font color=#447700>!  and molecular amounts.  <a name='9746'></font>
<font color=#447700>!  Pressures are input in mb, or are converted to mb here.<a name='9747'></font>
<font color=#447700>!  Molecular amounts are input in volume mixing ratio, or are converted from <a name='9748'></font>
<font color=#447700>!  mass mixing ratio (or specific humidity for h2o) to volume mixing ratio<a name='9749'></font>
<font color=#447700>!  here. These are then converted to molecular amount (molec/cm2) below.  <a name='9750'></font>
<font color=#447700>!  The dry air column COLDRY (in molec/cm2) is calculated from the level <a name='9751'></font>
<font color=#447700>!  pressures, pz (in mb), based on the hydrostatic equation and includes a <a name='9752'></font>
<font color=#447700>!  correction to account for h2o in the layer.  The molecular weight of moist <a name='9753'></font>
<font color=#447700>!  air (amm) is calculated for each layer.  <a name='9754'></font>
<font color=#447700>!  Note: In RRTMG, layer indexing goes from bottom to top, and coding below<a name='9755'></font>
<font color=#447700>!  assumes GCM input fields are also bottom to top. Input layer indexing<a name='9756'></font>
<font color=#447700>!  from GCM fields should be reversed here if necessary.<a name='9757'></font>
<a name='9758'>
      pz(0) = plev(iplon,1)<a name='9759'>
      tz(0) = tlev(iplon,1)<a name='9760'>
      do l = 1, nlayers<a name='9761'>
         pavel(l) = play(iplon,l)<a name='9762'>
         tavel(l) = tlay(iplon,l)<a name='9763'>
         pz(l) = plev(iplon,l+1)<a name='9764'>
         tz(l) = tlev(iplon,l+1)<a name='9765'>
         pdp(l) = pz(l-1) - pz(l)<a name='9766'>
<font color=#447700>! For h2o input in vmr:<a name='9767'></font>
         wkl(1,l) = h2ovmr(iplon,l)<a name='9768'>
<font color=#447700>! For h2o input in mmr:<a name='9769'></font>
<font color=#447700>!         wkl(1,l) = h2o(iplon,l)*amdw<a name='9770'></font>
<font color=#447700>! For h2o input in specific humidity;<a name='9771'></font>
<font color=#447700>!         wkl(1,l) = (h2o(iplon,l)/(1._rb - h2o(iplon,l)))*amdw<a name='9772'></font>
         wkl(2,l) = co2vmr(iplon,l)<a name='9773'>
         wkl(3,l) = o3vmr(iplon,l)<a name='9774'>
         wkl(4,l) = n2ovmr(iplon,l)<a name='9775'>
         wkl(6,l) = ch4vmr(iplon,l)<a name='9776'>
         wkl(7,l) = o2vmr(iplon,l)<a name='9777'>
         amm = (1._rb - wkl(1,l)) * amd + wkl(1,l) * amw            <a name='9778'>
         coldry(l) = (pz(l-1)-pz(l)) * 1.e3_rb * avogad / &amp;<a name='9779'>
                     (1.e2_rb * grav * amm * (1._rb + wkl(1,l)))<a name='9780'>
      enddo<a name='9781'>
<a name='9782'>
<font color=#447700>! The following section can be used to set values for an additional layer (from<a name='9783'></font>
<font color=#447700>! the GCM top level to 1.e-4 mb) for improved calculation of TOA fluxes. <a name='9784'></font>
<font color=#447700>! Temperature and molecular amounts in the extra model layer are set to <a name='9785'></font>
<font color=#447700>! their values in the top GCM model layer, though these can be modified<a name='9786'></font>
<font color=#447700>! here if necessary. <a name='9787'></font>
<font color=#447700>! If this feature is utilized, increase nlayers by one above, limit the two<a name='9788'></font>
<font color=#447700>! loops above to (nlayers-1), and set the top most (nlayers) layer values here. <a name='9789'></font>
<a name='9790'>
<font color=#447700>!      pavel(nlayers) = 0.5_rb * pz(nlayers-1)<a name='9791'></font>
<font color=#447700>!      tavel(nlayers) = tavel(nlayers-1)<a name='9792'></font>
<font color=#447700>!      pz(nlayers) = 1.e-4_rb<a name='9793'></font>
<font color=#447700>!      tz(nlayers-1) = 0.5_rb * (tavel(nlayers)+tavel(nlayers-1))<a name='9794'></font>
<font color=#447700>!      tz(nlayers) = tz(nlayers-1)<a name='9795'></font>
<font color=#447700>!      pdp(nlayers) = pz(nlayers-1) - pz(nlayers)<a name='9796'></font>
<font color=#447700>!      wkl(1,nlayers) = wkl(1,nlayers-1)<a name='9797'></font>
<font color=#447700>!      wkl(2,nlayers) = wkl(2,nlayers-1)<a name='9798'></font>
<font color=#447700>!      wkl(3,nlayers) = wkl(3,nlayers-1)<a name='9799'></font>
<font color=#447700>!      wkl(4,nlayers) = wkl(4,nlayers-1)<a name='9800'></font>
<font color=#447700>!      wkl(6,nlayers) = wkl(6,nlayers-1)<a name='9801'></font>
<font color=#447700>!      wkl(7,nlayers) = wkl(7,nlayers-1)<a name='9802'></font>
<font color=#447700>!      amm = (1._rb - wkl(1,nlayers-1)) * amd + wkl(1,nlayers-1) * amw<a name='9803'></font>
<font color=#447700>!      coldry(nlayers) = (pz(nlayers-1)) * 1.e3_rb * avogad / &amp;<a name='9804'></font>
<font color=#447700>!                        (1.e2_rb * grav * amm * (1._rb + wkl(1,nlayers-1)))<a name='9805'></font>
<a name='9806'>
<font color=#447700>! At this point all molecular amounts in wkl are in volume mixing ratio; <a name='9807'></font>
<font color=#447700>! convert to molec/cm2 based on coldry for use in rrtm.  <a name='9808'></font>
<a name='9809'>
      do l = 1, nlayers<a name='9810'>
         do imol = 1, nmol<a name='9811'>
            wkl(imol,l) = coldry(l) * wkl(imol,l)<a name='9812'>
         enddo<a name='9813'>
      enddo<a name='9814'>
<a name='9815'>
<font color=#447700>! Transfer aerosol optical properties to RRTM variables;<a name='9816'></font>
<font color=#447700>! modify to reverse layer indexing here if necessary.<a name='9817'></font>
<a name='9818'>
      if (iaer .ge. 1) then <a name='9819'>
         do l = 1, nlayers<a name='9820'>
            do ib = 1, nbndsw<a name='9821'>
               taua(l,ib) = tauaer(iplon,l,ib)<a name='9822'>
               ssaa(l,ib) = ssaaer(iplon,l,ib)<a name='9823'>
               asma(l,ib) = asmaer(iplon,l,ib)<a name='9824'>
            enddo<a name='9825'>
         enddo<a name='9826'>
      endif<a name='9827'>
<a name='9828'>
<font color=#447700>! Transfer cloud fraction and cloud optical properties to RRTM variables;<a name='9829'></font>
<font color=#447700>! modify to reverse layer indexing here if necessary.<a name='9830'></font>
<a name='9831'>
      if (icld .ge. 1) then <a name='9832'>
         inflag = inflgsw<a name='9833'>
         iceflag = iceflgsw<a name='9834'>
         liqflag = liqflgsw<a name='9835'>
<a name='9836'>
<font color=#447700>! Move incoming GCM cloud arrays to RRTMG cloud arrays.<a name='9837'></font>
<font color=#447700>! For GCM input, incoming reicmcl is defined based on selected ice parameterization (inflgsw)<a name='9838'></font>
<a name='9839'>
         do l = 1, nlayers<a name='9840'>
            do ig = 1, ngptsw<a name='9841'>
               cldfmc(ig,l) = cldfmcl(ig,iplon,l)<a name='9842'>
               taucmc(ig,l) = taucmcl(ig,iplon,l)<a name='9843'>
               ssacmc(ig,l) = ssacmcl(ig,iplon,l)<a name='9844'>
               asmcmc(ig,l) = asmcmcl(ig,iplon,l)<a name='9845'>
               fsfcmc(ig,l) = fsfcmcl(ig,iplon,l)<a name='9846'>
               ciwpmc(ig,l) = ciwpmcl(ig,iplon,l)<a name='9847'>
               clwpmc(ig,l) = clwpmcl(ig,iplon,l)<a name='9848'>
               if (iceflag.eq.5) then<a name='9849'>
                  cswpmc(ig,l)=cswpmcl(ig,iplon,l)<a name='9850'>
               endif <a name='9851'>
            enddo<a name='9852'>
            reicmc(l) = reicmcl(iplon,l)<a name='9853'>
            relqmc(l) = relqmcl(iplon,l)<a name='9854'>
            if (iceflag.eq.5) then<a name='9855'>
               resnmc(l) = resnmcl(iplon,l)<a name='9856'>
            endif <a name='9857'>
         enddo<a name='9858'>
<a name='9859'>
<font color=#447700>! If an extra layer is being used in RRTMG, set all cloud properties to zero in the extra layer.<a name='9860'></font>
<a name='9861'>
<font color=#447700>!         cldfmc(:,nlayers) = 0.0_rb<a name='9862'></font>
<font color=#447700>!         taucmc(:,nlayers) = 0.0_rb<a name='9863'></font>
<font color=#447700>!         ssacmc(:,nlayers) = 1.0_rb<a name='9864'></font>
<font color=#447700>!         asmcmc(:,nlayers) = 0.0_rb<a name='9865'></font>
<font color=#447700>!         fsfcmc(:,nlayers) = 0.0_rb<a name='9866'></font>
<font color=#447700>!         ciwpmc(:,nlayers) = 0.0_rb<a name='9867'></font>
<font color=#447700>!         clwpmc(:,nlayers) = 0.0_rb<a name='9868'></font>
<font color=#447700>!         reicmc(nlayers) = 0.0_rb<a name='9869'></font>
<font color=#447700>!         relqmc(nlayers) = 0.0_rb<a name='9870'></font>
      <a name='9871'>
      endif<a name='9872'>
<a name='9873'>
      end subroutine inatm_sw<a name='9874'>
<a name='9875'>
      end module rrtmg_sw_rad<a name='9876'>
<a name='9877'>
<font color=#447700>!------------------------------------------------------------------<a name='9878'></font>
<A NAME='MODULE_RA_RRTMG_SW'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MODULE_RA_RRTMG_SW' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='9879'>
<font color=#993300>MODULE </font><font color=#cc0000>module_ra_rrtmg_sw</font> <A href='../../call_to/MODULE_RA_RRTMG_SW.html' TARGET='index'>2</A><a name='9880'>
<a name='9881'>
use <A href='../../html_code/share/module_model_constants.F.html#MODULE_MODEL_CONSTANTS'>module_model_constants</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MODEL_CONSTANTS_85">, only : cp<a name='9882'>
USE <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_80"><a name='9883'>
#if (HWRF == 1)<a name='9884'>
USE <A href='../../html_code/frame/module_state_description.F.html#MODULE_STATE_DESCRIPTION'>module_state_description</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_STATE_DESCRIPTION_146">, ONLY : FER_MP_HIRES, FER_MP_HIRES_ADVECT, ETAMP_HWRF <a name='9885'>
#else<a name='9886'>
USE <A href='../../html_code/frame/module_state_description.F.html#MODULE_STATE_DESCRIPTION'>module_state_description</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_STATE_DESCRIPTION_147">, ONLY : FER_MP_HIRES, FER_MP_HIRES_ADVECT<a name='9887'>
#endif<a name='9888'>
<font color=#447700>!USE module_dm<a name='9889'></font>
<a name='9890'>
use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#PARRRSW'>parrrsw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_38">, only : nbndsw, ngptsw, naerec<a name='9891'>
use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_INIT'>rrtmg_sw_init</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_INIT_1">, only: rrtmg_sw_ini<a name='9892'>
use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SW_RAD'>rrtmg_sw_rad</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_RAD_1">, only: rrtmg_sw<a name='9893'>
use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MCICA_SUBCOL_GEN_SW'>mcica_subcol_gen_sw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MCICA_SUBCOL_GEN_SW_2">, only: mcica_subcol_sw<a name='9894'>
<a name='9895'>
use <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#MODULE_RA_RRTMG_LW'>module_ra_rrtmg_lw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#INATM_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_RRTMG_LW_2">, only : inirad, o3data, relcalc, reicalc, retab<a name='9896'>
<font color=#447700>!                               mcica_random_numbers, randomNumberSequence, &amp;<a name='9897'></font>
<font color=#447700>!                               new_RandomNumberSequence, getRandomReal<a name='9898'></font>
<a name='9899'>
CONTAINS<a name='9900'>
<a name='9901'>
<font color=#447700>!------------------------------------------------------------------<a name='9902'></font>
<A NAME='RRTMG_SWRAD'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='9903'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>RRTMG_SWRAD</font>(                                        &amp; <A href='../../call_to/RRTMG_SWRAD.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SWRAD.html' TARGET='index'>19</A><a name='9904'>
                       rthratensw,                                &amp;<a name='9905'>
                       swupt, swuptc, swdnt, swdntc,              &amp;<a name='9906'>
                       swupb, swupbc, swdnb, swdnbc,              &amp;<a name='9907'>
<font color=#447700>!                      swupflx, swupflxc, swdnflx, swdnflxc,      &amp;<a name='9908'></font>
                       swcf, gsw,                                 &amp;<a name='9909'>
                       xtime, gmt, xlat, xlong,                   &amp;<a name='9910'>
                       radt, degrad, declin,                      &amp;<a name='9911'>
                       coszr, julday, solcon,                     &amp;<a name='9912'>
                       albedo, t3d, t8w, tsk,                     &amp;<a name='9913'>
                       p3d, p8w, pi3d, rho3d,                     &amp;<a name='9914'>
                       dz8w, cldfra3d, lradius, iradius,          &amp; <a name='9915'>
                       is_cammgmp_used, r, g,                     &amp;<a name='9916'>
                       re_cloud,re_ice,re_snow,                   &amp;<a name='9917'>
                       has_reqc,has_reqi,has_reqs,                &amp;<a name='9918'>
                       icloud, warm_rain,                         &amp;<a name='9919'>
                       f_ice_phy, f_rain_phy,                     &amp;<a name='9920'>
                       xland, xice, snow,                         &amp;<a name='9921'>
                       qv3d, qc3d, qr3d,                          &amp;<a name='9922'>
                       qi3d, qs3d, qg3d,                          &amp;<a name='9923'>
                       o3input, o33d,                             &amp;<a name='9924'>
                       aer_opt, aerod, no_src,                    &amp;<a name='9925'>
                       alswvisdir, alswvisdif,                    &amp;  <font color=#447700>!Zhenxin ssib alb comp (06/20/2011)<a name='9926'></font>
                       alswnirdir, alswnirdif,                    &amp;  <font color=#447700>!Zhenxin ssib alb comp (06/20/2011)<a name='9927'></font>
                       swvisdir, swvisdif,                        &amp;  <font color=#447700>!Zhenxin ssib swr comp (06/20/2011)<a name='9928'></font>
                       swnirdir, swnirdif,                        &amp;  <font color=#447700>!Zhenxin ssib swi comp (06/20/2011)<a name='9929'></font>
                       sf_surface_physics,                        &amp;  <font color=#447700>!Zhenxin<a name='9930'></font>
                       f_qv, f_qc, f_qr, f_qi, f_qs, f_qg,        &amp;<a name='9931'>
                       tauaer300,tauaer400,tauaer600,tauaer999,   &amp; <font color=#447700>! czhao <a name='9932'></font>
                       gaer300,gaer400,gaer600,gaer999,           &amp; <font color=#447700>! czhao <a name='9933'></font>
                       waer300,waer400,waer600,waer999,           &amp; <font color=#447700>! czhao <a name='9934'></font>
                       aer_ra_feedback,                           &amp;<a name='9935'>
<font color=#447700>!jdfcz                 progn,prescribe,                           &amp;<a name='9936'></font>
                       progn,                                     &amp;<a name='9937'>
                       qndrop3d,f_qndrop,                         &amp; <font color=#447700>!czhao<a name='9938'></font>
                       mp_physics,                                &amp; <font color=#447700>!wang 2014/12<a name='9939'></font>
                       ids,ide, jds,jde, kds,kde,                 &amp; <a name='9940'>
                       ims,ime, jms,jme, kms,kme,                 &amp;<a name='9941'>
                       its,ite, jts,jte, kts,kte,                 &amp;<a name='9942'>
                       swupflx, swupflxc, swdnflx, swdnflxc,      &amp;<a name='9943'>
                       tauaer3d_sw,ssaaer3d_sw,asyaer3d_sw,       &amp; <font color=#447700>! jararias 2013/11<a name='9944'></font>
                       swddir, swddni, swddif,                    &amp; <font color=#447700>! jararias 2013/08<a name='9945'></font>
                       xcoszen,julian                             &amp; <font color=#447700>! jararias 2013/08<a name='9946'></font>
                                                                  )<a name='9947'>
<font color=#447700>!------------------------------------------------------------------<a name='9948'></font>
   IMPLICIT NONE<a name='9949'>
<font color=#447700>!------------------------------------------------------------------<a name='9950'></font>
   LOGICAL, INTENT(IN )      ::        warm_rain<a name='9951'>
   LOGICAL, INTENT(IN )      ::   is_CAMMGMP_used <font color=#447700>! Added for CAM5 RRTMG&lt;-&gt;CAMMGMP<a name='9952'></font>
<font color=#447700>!<a name='9953'></font>
   INTEGER, INTENT(IN )      ::        ids,ide, jds,jde, kds,kde, &amp;<a name='9954'>
                                       ims,ime, jms,jme, kms,kme, &amp;<a name='9955'>
                                       its,ite, jts,jte, kts,kte<a name='9956'>
<a name='9957'>
   INTEGER, INTENT(IN )      ::        ICLOUD<a name='9958'>
   INTEGER, INTENT(IN )      ::        MP_PHYSICS<a name='9959'>
<font color=#447700>!<a name='9960'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='9961'>
         INTENT(IN   ) ::                                   dz8w, &amp;<a name='9962'>
                                                             t3d, &amp;<a name='9963'>
                                                             t8w, &amp;<a name='9964'>
                                                             p3d, &amp;<a name='9965'>
                                                             p8w, &amp;<a name='9966'>
                                                            pi3d, &amp;<a name='9967'>
                                                           rho3d<a name='9968'>
<a name='9969'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='9970'>
         INTENT(INOUT)  ::                            RTHRATENSW<a name='9971'>
<a name='9972'>
   REAL, DIMENSION( ims:ime, jms:jme )                          , &amp;<a name='9973'>
         INTENT(INOUT)  ::                                   GSW, &amp;<a name='9974'>
                                                            SWCF, &amp;<a name='9975'>
                                                           COSZR<a name='9976'>
<a name='9977'>
   INTEGER, INTENT(IN  )     ::                           JULDAY<a name='9978'>
   REAL, INTENT(IN    )      ::                      RADT,DEGRAD, &amp;<a name='9979'>
                                         XTIME,DECLIN,SOLCON,GMT<a name='9980'>
<a name='9981'>
   REAL, DIMENSION( ims:ime, jms:jme )                          , &amp;<a name='9982'>
         INTENT(IN   )  ::                                  XLAT, &amp;<a name='9983'>
                                                           XLONG, &amp;<a name='9984'>
                                                           XLAND, &amp;<a name='9985'>
                                                            XICE, &amp;<a name='9986'>
                                                            SNOW, &amp;<a name='9987'>
                                                             TSK, &amp;<a name='9988'>
                                                          ALBEDO<a name='9989'>
<font color=#447700>!<a name='9990'></font>
<font color=#447700>!!! -------------------  Zhenxin (2011-06/20) ------------------<a name='9991'></font>
   REAL, DIMENSION( ims:ime, jms:jme )                         , &amp;<a name='9992'>
         OPTIONAL                                               , &amp;<a name='9993'>
         INTENT(IN)     ::                            ALSWVISDIR, &amp;     <font color=#447700>! ssib albedo of sw and lw<a name='9994'></font>
                                                      ALSWVISDIF, &amp;<a name='9995'>
                                                      ALSWNIRDIR, &amp;<a name='9996'>
                                                      ALSWNIRDIF<a name='9997'>
<a name='9998'>
   REAL, DIMENSION( ims:ime, jms:jme )                         , &amp;<a name='9999'>
         OPTIONAL                                               , &amp;<a name='10000'>
         INTENT(OUT)    ::                              SWVISDIR, &amp;<a name='10001'>
                                                        SWVISDIF, &amp;<a name='10002'>
                                                        SWNIRDIR, &amp;<a name='10003'>
                                                        SWNIRDIF        <font color=#447700>! ssib sw dir and diff rad<a name='10004'></font>
   INTEGER, INTENT(IN) :: sf_surface_physics                            <font color=#447700>! ssib para<a name='10005'></font>
<a name='10006'>
<font color=#447700>!  ----------------------- end Zhenxin --------------------------<a name='10007'></font>
<font color=#447700>!<a name='10008'></font>
<a name='10009'>
<font color=#447700>! ------------------------ jararias 2013/08/10 -----------------<a name='10010'></font>
   real, dimension(ims:ime,jms:jme), intent(out) :: &amp;<a name='10011'>
            swddir,  &amp;  <font color=#447700>! All-sky broadband surface direct horiz irradiance<a name='10012'></font>
            swddni,  &amp;  <font color=#447700>! All-sky broadband surface direct normal irradiance<a name='10013'></font>
            swddif      <font color=#447700>! All-sky broadband surface diffuse irradiance<a name='10014'></font>
   real, optional, intent(in) :: &amp;<a name='10015'>
            julian      <font color=#447700>! julian day (1-366)<a name='10016'></font>
   real, dimension(ims:ime,jms:jme), intent(in) :: &amp;<a name='10017'>
            xcoszen     <font color=#447700>! cosine of the solar zenith angle<a name='10018'></font>
   real, dimension(:,:,:,:), pointer :: tauaer3d_sw,ssaaer3d_sw,asyaer3d_sw<a name='10019'>
<font color=#447700>! ------------------------ jararias end snippet -----------------<a name='10020'></font>
<a name='10021'>
   REAL, INTENT(IN  )   ::                                   R,G<a name='10022'>
<font color=#447700>!<a name='10023'></font>
<font color=#447700>! Optional<a name='10024'></font>
<font color=#447700>!<a name='10025'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='10026'>
         OPTIONAL                                               , &amp;<a name='10027'>
         INTENT(IN   ) ::                                         &amp;<a name='10028'>
                                                        CLDFRA3D, &amp;<a name='10029'>
                                                         LRADIUS, &amp;<a name='10030'>
                                                         IRADIUS, &amp;<a name='10031'>
                                                            QV3D, &amp;<a name='10032'>
                                                            QC3D, &amp;<a name='10033'>
                                                            QR3D, &amp;<a name='10034'>
                                                            QI3D, &amp;<a name='10035'>
                                                            QS3D, &amp;<a name='10036'>
                                                            QG3D, &amp;<a name='10037'>
                                                        QNDROP3D<a name='10038'>
<a name='10039'>
<font color=#447700>!..Added by G. Thompson to couple cloud physics effective radii.<a name='10040'></font>
   REAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(IN)::       &amp;<a name='10041'>
                                                        RE_CLOUD, &amp;<a name='10042'>
                                                          RE_ICE, &amp;<a name='10043'>
                                                         RE_SNOW<a name='10044'>
   INTEGER, INTENT(IN):: has_reqc, has_reqi, has_reqs<a name='10045'>
<a name='10046'>
   real pi,third,relconst,lwpmin,rhoh2o<a name='10047'>
<a name='10048'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='10049'>
         OPTIONAL                                               , &amp;<a name='10050'>
         INTENT(IN   ) ::                                         &amp;<a name='10051'>
                                                       F_ICE_PHY, &amp;<a name='10052'>
                                                      F_RAIN_PHY<a name='10053'>
<a name='10054'>
   LOGICAL, OPTIONAL, INTENT(IN)   ::                             &amp;<a name='10055'>
                                F_QV,F_QC,F_QR,F_QI,F_QS,F_QG,F_QNDROP<a name='10056'>
<a name='10057'>
<font color=#447700>! Optional<a name='10058'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ), OPTIONAL ,       &amp;<a name='10059'>
         INTENT(IN    ) :: tauaer300,tauaer400,tauaer600,tauaer999, &amp; <font color=#447700>! czhao <a name='10060'></font>
                                 gaer300,gaer400,gaer600,gaer999, &amp; <font color=#447700>! czhao <a name='10061'></font>
                                 waer300,waer400,waer600,waer999    <font color=#447700>! czhao <a name='10062'></font>
<a name='10063'>
   INTEGER,    INTENT(IN  ), OPTIONAL   ::       aer_ra_feedback<a name='10064'>
<font color=#447700>!jdfcz   INTEGER,    INTENT(IN  ), OPTIONAL   ::       progn,prescribe<a name='10065'></font>
   INTEGER,    INTENT(IN  ), OPTIONAL   ::       progn<a name='10066'>
<font color=#447700>!  Ozone<a name='10067'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='10068'>
         OPTIONAL                                               , &amp;<a name='10069'>
         INTENT(IN   ) :: O33D<a name='10070'>
   INTEGER, OPTIONAL, INTENT(IN ) :: o3input<a name='10071'>
<font color=#447700>!  EC aerosol: no_src = naerec = 6<a name='10072'></font>
   INTEGER,           INTENT(IN ) :: no_src<a name='10073'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme, 1:no_src )       , &amp;<a name='10074'>
         OPTIONAL                                               , &amp;<a name='10075'>
         INTENT(IN   ) :: aerod<a name='10076'>
   INTEGER, OPTIONAL, INTENT(IN ) :: aer_opt<a name='10077'>
<a name='10078'>
      <font color=#447700>!wavelength corresponding to wavenum1 and wavenum2 (cm-1)<a name='10079'></font>
      real, save :: wavemin(nbndsw) <font color=#447700>! Min wavelength (um) of 14 intervals<a name='10080'></font>
      data wavemin /3.077,2.500,2.150,1.942,1.626,1.299, &amp;<a name='10081'>
      1.242,0.778,0.625,0.442,0.345,0.263,0.200,3.846/<a name='10082'>
      real, save :: wavemax(nbndsw) <font color=#447700>! Max wavelength (um) of interval<a name='10083'></font>
      data wavemax/3.846,3.077,2.500,2.150,1.942,1.626, &amp;<a name='10084'>
      1.299,1.242,0.778,0.625,0.442,0.345,0.263,12.195/<a name='10085'>
      real wavemid(nbndsw) <font color=#447700>! Mid wavelength (um) of interval<a name='10086'></font>
      real, parameter :: thresh=1.e-9<a name='10087'>
      real ang,slope<a name='10088'>
      character(len=200) :: msg<a name='10089'>
<a name='10090'>
<font color=#447700>! Top of atmosphere and surface shortwave fluxes (W m-2)<a name='10091'></font>
   REAL, DIMENSION( ims:ime, jms:jme ),                           &amp;<a name='10092'>
         OPTIONAL, INTENT(INOUT) ::                               &amp;<a name='10093'>
                                       SWUPT,SWUPTC,SWDNT,SWDNTC, &amp;<a name='10094'>
                                       SWUPB,SWUPBC,SWDNB,SWDNBC<a name='10095'>
<a name='10096'>
<font color=#447700>! Layer shortwave fluxes (including extra layer above model top)<a name='10097'></font>
<font color=#447700>! Vertical ordering is from bottom to top (W m-2)<a name='10098'></font>
   REAL, DIMENSION( ims:ime, kms:kme+2, jms:jme ),                &amp;<a name='10099'>
         OPTIONAL, INTENT(OUT) ::                                 &amp;<a name='10100'>
                               SWUPFLX,SWUPFLXC,SWDNFLX,SWDNFLXC<a name='10101'>
<a name='10102'>
<font color=#447700>!  LOCAL VARS<a name='10103'></font>
 <a name='10104'>
   REAL, DIMENSION( kts:kte+1 ) ::                          Pw1D, &amp;<a name='10105'>
                                                            Tw1D<a name='10106'>
<a name='10107'>
   REAL, DIMENSION( kts:kte ) ::                          TTEN1D, &amp;<a name='10108'>
                                                        CLDFRA1D, &amp;<a name='10109'>
                                                            DZ1D, &amp;<a name='10110'>
                                                             P1D, &amp;<a name='10111'>
                                                             T1D, &amp;<a name='10112'>
                                                            QV1D, &amp;<a name='10113'>
                                                            QC1D, &amp;<a name='10114'>
                                                            QR1D, &amp;<a name='10115'>
                                                            QI1D, &amp;<a name='10116'>
                                                           RHO1D, &amp;<a name='10117'>
                                                            QS1D, &amp;<a name='10118'>
                                                            QG1D, &amp;<a name='10119'>
                                                            O31D, &amp;<a name='10120'>
                                                          qndrop1d <a name='10121'>
<a name='10122'>
<font color=#447700>!BSF: From eq. (5) on p. 2434 in McFarquhar &amp; Heymsfield (1996)<a name='10123'></font>
      real, parameter :: re_50C=1250.0/9.917, re_40C=1250.0/9.337,     &amp;<a name='10124'>
                         re_30C=1250.0/9.208, re_20C=1250.0/9.387<a name='10125'>
<a name='10126'>
<font color=#447700>! Added local arrays for RRTMG<a name='10127'></font>
    integer ::                                              ncol, &amp;<a name='10128'>
                                                            nlay, &amp;<a name='10129'>
                                                            icld, &amp;<a name='10130'>
                                                         inflgsw, &amp;<a name='10131'>
                                                        iceflgsw, &amp;<a name='10132'>
                                                        liqflgsw<a name='10133'>
<font color=#447700>! Dimension with extra layer from model top to TOA<a name='10134'></font>
    real, dimension( 1, kts:kte+2 )  ::                     plev, &amp;<a name='10135'>
                                                            tlev<a name='10136'>
    real, dimension( 1, kts:kte+1 )  ::                     play, &amp;<a name='10137'>
                                                            tlay, &amp;<a name='10138'>
                                                          h2ovmr, &amp;<a name='10139'>
                                                           o3vmr, &amp;<a name='10140'>
                                                          co2vmr, &amp;<a name='10141'>
                                                           o2vmr, &amp;<a name='10142'>
                                                          ch4vmr, &amp;<a name='10143'>
                                                          n2ovmr<a name='10144'>
    real, dimension( kts:kte+1 )  ::                       o3mmr<a name='10145'>
<font color=#447700>! Surface albedo (for UV/visible and near-IR spectral regions,<a name='10146'></font>
<font color=#447700>! and for direct and diffuse radiation)<a name='10147'></font>
    real, dimension( 1 )  ::                               asdir, &amp;<a name='10148'>
                                                           asdif, &amp;<a name='10149'>
                                                           aldir, &amp;<a name='10150'>
                                                           aldif<a name='10151'>
<font color=#447700>! Dimension with extra layer from model top to TOA, <a name='10152'></font>
<font color=#447700>! though no clouds are allowed in extra layer<a name='10153'></font>
    real, dimension( 1, kts:kte+1 )  ::                   clwpth, &amp;<a name='10154'>
                                                          ciwpth, &amp;<a name='10155'>
                                                          cswpth, &amp;<a name='10156'>
                                                             rel, &amp;<a name='10157'>
                                                             rei, &amp;<a name='10158'>
                                                             res, &amp;<a name='10159'>
                                                         cldfrac, &amp;<a name='10160'>
                                                         relqmcl, &amp;<a name='10161'>
                                                         reicmcl, &amp;<a name='10162'>
                                                         resnmcl<a name='10163'>
    real, dimension( nbndsw, 1, kts:kte+1 )  ::           taucld, &amp;<a name='10164'>
                                                          ssacld, &amp;<a name='10165'>
                                                          asmcld, &amp;<a name='10166'>
                                                          fsfcld<a name='10167'>
    real, dimension( ngptsw, 1, kts:kte+1 )  ::          cldfmcl, &amp;<a name='10168'>
                                                         clwpmcl, &amp;<a name='10169'>
                                                         ciwpmcl, &amp;<a name='10170'>
                                                         cswpmcl, &amp;<a name='10171'>
                                                         taucmcl, &amp;<a name='10172'>
                                                         ssacmcl, &amp;<a name='10173'>
                                                         asmcmcl, &amp;<a name='10174'>
                                                         fsfcmcl<a name='10175'>
    real, dimension( 1, kts:kte+1, nbndsw )  ::           tauaer, &amp;<a name='10176'>
                                                          ssaaer, &amp;<a name='10177'>
                                                          asmaer   <a name='10178'>
    real, dimension( 1, kts:kte+1, naerec )  ::            ecaer<a name='10179'>
<a name='10180'>
<font color=#447700>! Output arrays contain extra layer from model top to TOA<a name='10181'></font>
    real, dimension( 1, kts:kte+2 )  ::                   swuflx, &amp;<a name='10182'>
                                                          swdflx, &amp;<a name='10183'>
                                                         swuflxc, &amp;<a name='10184'>
                                                         swdflxc, &amp;<a name='10185'>
                                                       sibvisdir, &amp;  <font color=#447700>! Zhenxin 2011-06-20<a name='10186'></font>
                                                       sibvisdif, &amp;<a name='10187'>
                                                       sibnirdir, &amp;<a name='10188'>
                                                       sibnirdif     <font color=#447700>! Zhenxin 2011-06-20<a name='10189'></font>
<a name='10190'>
    real, dimension( 1, kts:kte+2 ) ::                   swdkdir, &amp;  <font color=#447700>! jararias, 2013/08/10<a name='10191'></font>
                                                         swdkdif     <font color=#447700>! jararias, 2013/08/10<a name='10192'></font>
<a name='10193'>
    real, dimension( 1, kts:kte+1 )  ::                     swhr, &amp;<a name='10194'>
                                                           swhrc<a name='10195'>
<a name='10196'>
    real, dimension ( 1 ) ::                                tsfc, &amp;<a name='10197'>
                                                              ps, &amp;<a name='10198'>
                                                          coszen<a name='10199'>
    real ::                                                   ro, &amp;<a name='10200'>
                                                              dz, &amp;<a name='10201'>
                                                           adjes, &amp;<a name='10202'>
                                                            scon, &amp;  <a name='10203'>
                                                  snow_mass_factor<a name='10204'>
    integer ::                                            dyofyr<a name='10205'>
<a name='10206'>
    integer:: idx_rei<a name='10207'>
    real:: corr<a name='10208'>
<a name='10209'>
<font color=#447700>! Set trace gas volume mixing ratios, 2005 values, IPCC (2007)<a name='10210'></font>
<font color=#447700>! carbon dioxide (379 ppmv)<a name='10211'></font>
    real :: co2<a name='10212'>
    data co2 / 379.e-6 / <a name='10213'>
<font color=#447700>! methane (1774 ppbv)<a name='10214'></font>
    real :: ch4<a name='10215'>
    data ch4 / 1774.e-9 / <a name='10216'>
<font color=#447700>! nitrous oxide (319 ppbv)<a name='10217'></font>
    real :: n2o<a name='10218'>
    data n2o / 319.e-9 / <a name='10219'>
<font color=#447700>! Set oxygen volume mixing ratio (for o2mmr=0.23143)<a name='10220'></font>
    real :: o2<a name='10221'>
    data o2 / 0.209488 /<a name='10222'>
<a name='10223'>
    integer :: iplon, irng, permuteseed<a name='10224'>
    integer :: nb<a name='10225'>
<a name='10226'>
<font color=#447700>! For old lw cloud property specification<a name='10227'></font>
<font color=#447700>! Cloud and precipitation absorption coefficients<a name='10228'></font>
<font color=#447700>!    real :: abcw,abice,abrn,absn<a name='10229'></font>
<font color=#447700>!    data abcw /0.144/<a name='10230'></font>
<font color=#447700>!    data abice /0.0735/<a name='10231'></font>
<font color=#447700>!    data abrn /0.330e-3/<a name='10232'></font>
<font color=#447700>!    data absn /2.34e-3/<a name='10233'></font>
<a name='10234'>
<font color=#447700>! Molecular weights and ratios for converting mmr to vmr units<a name='10235'></font>
<font color=#447700>!    real :: amd       ! Effective molecular weight of dry air (g/mol)  <a name='10236'></font>
<font color=#447700>!    real :: amw       ! Molecular weight of water vapor (g/mol)        <a name='10237'></font>
<font color=#447700>!    real :: amo       ! Molecular weight of ozone (g/mol)              <a name='10238'></font>
<font color=#447700>!    real :: amo2      ! Molecular weight of oxygen (g/mol)              <a name='10239'></font>
<font color=#447700>! Atomic weights for conversion from mass to volume mixing ratios                <a name='10240'></font>
<font color=#447700>!    data amd   /  28.9660   /                                                  <a name='10241'></font>
<font color=#447700>!    data amw   /  18.0160   /                                                  <a name='10242'></font>
<font color=#447700>!    data amo   /  47.9998   /                                                  <a name='10243'></font>
<font color=#447700>!    data amo2  /  31.9999   /<a name='10244'></font>
                                                                                 <a name='10245'>
    real :: amdw     <font color=#447700>! Molecular weight of dry air / water vapor  <a name='10246'></font>
    real :: amdo     <font color=#447700>! Molecular weight of dry air / ozone<a name='10247'></font>
    real :: amdo2    <font color=#447700>! Molecular weight of dry air / oxygen<a name='10248'></font>
    data amdw /  1.607793 /                                                    <a name='10249'>
    data amdo /  0.603461 /<a name='10250'>
    data amdo2 / 0.905190 /<a name='10251'>
    <a name='10252'>
<font color=#447700>!!<a name='10253'></font>
    real, dimension(1, 1:kte-kts+1 )  :: pdel          <font color=#447700>! Layer pressure thickness (mb)<a name='10254'></font>
<a name='10255'>
    real, dimension(1, 1:kte-kts+1) ::   cicewp, &amp;     <font color=#447700>! in-cloud cloud ice water path<a name='10256'></font>
                                         cliqwp, &amp;     <font color=#447700>! in-cloud cloud liquid water path<a name='10257'></font>
                                         csnowp, &amp;     <font color=#447700>! in-cloud snow water path<a name='10258'></font>
                                          reliq, &amp;     <font color=#447700>! effective drop radius (microns)<a name='10259'></font>
                                          reice        <font color=#447700>! ice effective drop size (microns)<a name='10260'></font>
    real, dimension(1, 1:kte-kts+1):: recloud1d, &amp;<a name='10261'>
                                        reice1d, &amp;<a name='10262'>
                                       resnow1d<a name='10263'>
    real :: gliqwp, gicewp, gsnowp, gravmks, tem1,tem2,tem3<a name='10264'>
<a name='10265'>
<font color=#447700>!<a name='10266'></font>
<font color=#447700>!    REAL   ::  TSFC,GLW0,OLR0,EMISS0,FP<a name='10267'></font>
    REAL   ::  FP<a name='10268'>
<a name='10269'>
<font color=#447700>!    real, dimension(1:ite-its+1 )          ::   clat     ! latitude in radians for columns<a name='10270'></font>
    real :: coszrs                      <font color=#447700>! Cosine of solar zenith angle for present latitude <a name='10271'></font>
    logical :: dorrsw                   <font color=#447700>! Flag to allow shortwave calculation<a name='10272'></font>
<a name='10273'>
    real, dimension (1) :: landfrac, landm, snowh, icefrac<a name='10274'>
<a name='10275'>
    integer :: pcols, pver<a name='10276'>
<a name='10277'>
    INTEGER :: i,j,K, na<a name='10278'>
    LOGICAL :: predicate<a name='10279'>
<a name='10280'>
    REAL :: da, eot <font color=#447700>! jararias, 14/08/2013<a name='10281'></font>
<a name='10282'>
<font color=#447700>!------------------------------------------------------------------<a name='10283'></font>
#if ( WRF_CHEM == 1 )<a name='10284'>
      IF ( aer_ra_feedback == 1) then<a name='10285'>
      IF ( .NOT. &amp;<a name='10286'>
      ( PRESENT(tauaer300) .AND. &amp;<a name='10287'>
        PRESENT(tauaer400) .AND. &amp;<a name='10288'>
        PRESENT(tauaer600) .AND. &amp;<a name='10289'>
        PRESENT(tauaer999) .AND. &amp;<a name='10290'>
        PRESENT(gaer300) .AND. &amp;<a name='10291'>
        PRESENT(gaer400) .AND. &amp;<a name='10292'>
        PRESENT(gaer600) .AND. &amp;<a name='10293'>
        PRESENT(gaer999) .AND. &amp;<a name='10294'>
        PRESENT(waer300) .AND. &amp;<a name='10295'>
        PRESENT(waer400) .AND. &amp;<a name='10296'>
        PRESENT(waer600) .AND. &amp;<a name='10297'>
        PRESENT(waer999) ) ) THEN<a name='10298'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1083">  &amp;<a name='10299'>
      ('Warning: missing fields required for aerosol radiation' )<a name='10300'>
      ENDIF<a name='10301'>
      ENDIF<a name='10302'>
#endif<a name='10303'>
<a name='10304'>
<font color=#447700>!-----CALCULATE SHORT WAVE RADIATION<a name='10305'></font>
<font color=#447700>!                                                              <a name='10306'></font>
<font color=#447700>! All fields are ordered vertically from bottom to top<a name='10307'></font>
<font color=#447700>! Pressures are in mb<a name='10308'></font>
<a name='10309'>
<font color=#447700>! latitude loop<a name='10310'></font>
  j_loop: do j = jts,jte<a name='10311'>
<a name='10312'>
<font color=#447700>! longitude loop<a name='10313'></font>
     i_loop: do i = its,ite<a name='10314'>
         rho1d(kts:kte)=rho3d(i,kts:kte,j) <font color=#447700>! BUG FIX (SGT): this was uninitialized<a name='10315'></font>
<font color=#447700>!<a name='10316'></font>
<font color=#447700>! Do shortwave by default, deactivate below if sun below horizon<a name='10317'></font>
         dorrsw = .true.<a name='10318'>
<a name='10319'>
<font color=#447700>! Cosine solar zenith angle for current time step<a name='10320'></font>
<font color=#447700>!<a name='10321'></font>
          <font color=#447700>! jararias, 14/08/2013<a name='10322'></font>
          coszr(i,j)=xcoszen(i,j)<a name='10323'>
          coszrs=xcoszen(i,j)<a name='10324'>
<a name='10325'>
<font color=#447700>! Set flag to prevent shortwave calculation when sun below horizon<a name='10326'></font>
         if (coszrs.le.0.0) dorrsw = .false.<a name='10327'>
<font color=#447700>! Perform shortwave calculation if sun above horizon<a name='10328'></font>
         if (dorrsw) then<a name='10329'>
<a name='10330'>
         do k=kts,kte+1<a name='10331'>
            Pw1D(K) = p8w(I,K,J)/100.<a name='10332'>
            Tw1D(K) = t8w(I,K,J)<a name='10333'>
         enddo<a name='10334'>
<a name='10335'>
         DO K=kts,kte<a name='10336'>
            QV1D(K)=0.<a name='10337'>
            QC1D(K)=0.<a name='10338'>
            QR1D(K)=0.<a name='10339'>
            QI1D(K)=0.<a name='10340'>
            QS1D(K)=0.<a name='10341'>
            CLDFRA1D(k)=0.<a name='10342'>
            QNDROP1D(k)=0.<a name='10343'>
         ENDDO<a name='10344'>
<a name='10345'>
         DO K=kts,kte<a name='10346'>
            QV1D(K)=QV3D(I,K,J)<a name='10347'>
            QV1D(K)=max(0.,QV1D(K))<a name='10348'>
         ENDDO<a name='10349'>
<a name='10350'>
         IF (PRESENT(O33D)) THEN<a name='10351'>
            DO K=kts,kte<a name='10352'>
               O31D(K)=O33D(I,K,J)<a name='10353'>
            ENDDO<a name='10354'>
         ELSE<a name='10355'>
            DO K=kts,kte<a name='10356'>
               O31D(K)=0.0<a name='10357'>
            ENDDO<a name='10358'>
         ENDIF<a name='10359'>
<a name='10360'>
         DO K=kts,kte<a name='10361'>
            TTEN1D(K)=0.<a name='10362'>
            T1D(K)=t3d(I,K,J)<a name='10363'>
            P1D(K)=p3d(I,K,J)/100.<a name='10364'>
            DZ1D(K)=dz8w(I,K,J)<a name='10365'>
         ENDDO<a name='10366'>
<a name='10367'>
<font color=#447700>! moist variables<a name='10368'></font>
<a name='10369'>
         IF (ICLOUD .ne. 0) THEN<a name='10370'>
            IF ( PRESENT( CLDFRA3D ) ) THEN<a name='10371'>
              DO K=kts,kte<a name='10372'>
                 CLDFRA1D(k)=CLDFRA3D(I,K,J)<a name='10373'>
              ENDDO<a name='10374'>
            ENDIF<a name='10375'>
<a name='10376'>
            IF (PRESENT(F_QC) .AND. PRESENT(QC3D)) THEN<a name='10377'>
              IF ( F_QC) THEN<a name='10378'>
                 DO K=kts,kte<a name='10379'>
                    QC1D(K)=QC3D(I,K,J)<a name='10380'>
                    QC1D(K)=max(0.,QC1D(K))<a name='10381'>
                 ENDDO<a name='10382'>
              ENDIF<a name='10383'>
            ENDIF<a name='10384'>
<a name='10385'>
            IF (PRESENT(F_QR) .AND. PRESENT(QR3D)) THEN<a name='10386'>
              IF ( F_QR) THEN<a name='10387'>
                 DO K=kts,kte<a name='10388'>
                    QR1D(K)=QR3D(I,K,J)<a name='10389'>
                    QR1D(K)=max(0.,QR1D(K))<a name='10390'>
                 ENDDO<a name='10391'>
              ENDIF<a name='10392'>
            ENDIF<a name='10393'>
<a name='10394'>
            IF ( PRESENT(F_QNDROP).AND.PRESENT(QNDROP3D)) THEN<a name='10395'>
             IF (F_QNDROP) THEN<a name='10396'>
              DO K=kts,kte<a name='10397'>
               qndrop1d(K)=qndrop3d(I,K,J)<a name='10398'>
              ENDDO<a name='10399'>
             ENDIF<a name='10400'>
            ENDIF<a name='10401'>
<a name='10402'>
<font color=#447700>! This logic is tortured because cannot test F_QI unless<a name='10403'></font>
<font color=#447700>! it is present, and order of evaluation of expressions<a name='10404'></font>
<font color=#447700>! is not specified in Fortran<a name='10405'></font>
<a name='10406'>
            IF ( PRESENT ( F_QI ) ) THEN<a name='10407'>
              predicate = F_QI<a name='10408'>
            ELSE<a name='10409'>
              predicate = .FALSE.<a name='10410'>
            ENDIF<a name='10411'>
<a name='10412'>
<font color=#447700>! For MP option 3<a name='10413'></font>
            IF (.NOT. predicate .and. .not. warm_rain) THEN<a name='10414'>
               DO K=kts,kte<a name='10415'>
                  IF (T1D(K) .lt. 273.15) THEN<a name='10416'>
                  QI1D(K)=QC1D(K)<a name='10417'>
                  QS1D(K)=QR1D(K)<a name='10418'>
                  QC1D(K)=0.<a name='10419'>
                  QR1D(K)=0.<a name='10420'>
                  ENDIF<a name='10421'>
               ENDDO<a name='10422'>
            ENDIF<a name='10423'>
<a name='10424'>
            IF (PRESENT(F_QI) .AND. PRESENT(QI3D)) THEN<a name='10425'>
               IF (F_QI) THEN<a name='10426'>
                  DO K=kts,kte<a name='10427'>
                     QI1D(K)=QI3D(I,K,J)<a name='10428'>
                     QI1D(K)=max(0.,QI1D(K))<a name='10429'>
                  ENDDO<a name='10430'>
               ENDIF<a name='10431'>
            ENDIF<a name='10432'>
<a name='10433'>
            IF (PRESENT(F_QS) .AND. PRESENT(QS3D)) THEN<a name='10434'>
               IF (F_QS) THEN<a name='10435'>
                  DO K=kts,kte<a name='10436'>
                     QS1D(K)=QS3D(I,K,J)<a name='10437'>
                     QS1D(K)=max(0.,QS1D(K))<a name='10438'>
                  ENDDO<a name='10439'>
               ENDIF<a name='10440'>
            ENDIF<a name='10441'>
<a name='10442'>
            IF (PRESENT(F_QG) .AND. PRESENT(QG3D)) THEN<a name='10443'>
               IF (F_QG) THEN<a name='10444'>
                  DO K=kts,kte<a name='10445'>
                     QG1D(K)=QG3D(I,K,J)<a name='10446'>
                     QG1D(K)=max(0.,QG1D(K))<a name='10447'>
                  ENDDO<a name='10448'>
               ENDIF<a name='10449'>
            ENDIF<a name='10450'>
<a name='10451'>
<font color=#447700>! mji - For MP option 5<a name='10452'></font>
            IF ( PRESENT(F_QI) .and. PRESENT(F_QC) .and. PRESENT(F_QS) .and. PRESENT(F_ICE_PHY) ) THEN<a name='10453'>
               IF ( F_QC .and. .not. F_QI .and. F_QS ) THEN<a name='10454'>
                  DO K=kts,kte<a name='10455'>
                     qi1d(k) = 0.1*qs3d(i,k,j)<a name='10456'>
                     qs1d(k) = 0.9*qs3d(i,k,j)<a name='10457'>
                     qc1d(k) = qc3d(i,k,j)<a name='10458'>
                     qi1d(k) = max(0.,qi1d(k))<a name='10459'>
                     qc1d(k) = max(0.,qc1d(k))<a name='10460'>
                  ENDDO<a name='10461'>
               ENDIF<a name='10462'>
            ENDIF<a name='10463'>
<a name='10464'>
         ENDIF<a name='10465'>
<font color=#447700>! For mp option=5 or 85  (new Ferrier- Aligo or called fer_hires<a name='10466'></font>
<font color=#447700>! scheme), QI3D saves all frozen water (ice+snow)<a name='10467'></font>
#if (HWRF == 1)<a name='10468'>
           IF ( mp_physics == FER_MP_HIRES .OR. &amp;<a name='10469'>
                mp_physics == FER_MP_HIRES_ADVECT .OR. &amp;<a name='10470'>
                mp_physics == ETAMP_HWRF ) THEN<a name='10471'>
#else<a name='10472'>
           IF ( mp_physics == FER_MP_HIRES .OR. &amp;<a name='10473'>
                mp_physics == FER_MP_HIRES_ADVECT) THEN<a name='10474'>
#endif<a name='10475'>
                  DO K=kts,kte<a name='10476'>
                     qi1d(k) = qi3d(i,k,j)<a name='10477'>
                     qs1d(k) = 0.0<a name='10478'>
                     qc1d(k) = qc3d(i,k,j)<a name='10479'>
                     qi1d(k) = max(0.,qi1d(k))<a name='10480'>
                     qc1d(k) = max(0.,qc1d(k))<a name='10481'>
                  ENDDO<a name='10482'>
           ENDIF<a name='10483'>
<font color=#447700>!<a name='10484'></font>
<font color=#447700>!         EMISS0=EMISS(I,J)<a name='10485'></font>
<font color=#447700>!         GLW0=0. <a name='10486'></font>
<font color=#447700>!         OLR0=0. <a name='10487'></font>
<font color=#447700>!         TSFC=TSK(I,J)<a name='10488'></font>
         DO K=kts,kte<a name='10489'>
            QV1D(K)=AMAX1(QV1D(K),1.E-12) <a name='10490'>
         ENDDO<a name='10491'>
<a name='10492'>
<font color=#447700>! Set up input for shortwave<a name='10493'></font>
         ncol = 1<a name='10494'>
<font color=#447700>! Add extra layer from top of model to top of atmosphere<a name='10495'></font>
         nlay = (kte - kts + 1) + 1<a name='10496'>
<a name='10497'>
<font color=#447700>! Select cloud liquid and ice optics parameterization options<a name='10498'></font>
<font color=#447700>! For passing in cloud optical properties directly:<a name='10499'></font>
<font color=#447700>!         icld = 2<a name='10500'></font>
<font color=#447700>!         inflgsw = 0<a name='10501'></font>
<font color=#447700>!         iceflgsw = 0<a name='10502'></font>
<font color=#447700>!         liqflgsw = 0<a name='10503'></font>
<font color=#447700>! For passing in cloud physical properties; cloud optics parameterized in RRTMG:<a name='10504'></font>
         icld = 2<a name='10505'>
         inflgsw = 2<a name='10506'>
         iceflgsw = 3<a name='10507'>
         liqflgsw = 1<a name='10508'>
<a name='10509'>
<font color=#447700>!Mukul change the flags here with reference to the new effective cloud/ice/snow radius<a name='10510'></font>
         IF (ICLOUD .ne. 0) THEN<a name='10511'>
            IF ( has_reqc .ne. 0) THEN<a name='10512'>
               inflgsw = 3<a name='10513'>
               DO K=kts,kte<a name='10514'>
                  recloud1D(ncol,K) = MAX(2.5, re_cloud(I,K,J)*1.E6)<a name='10515'>
                  if (recloud1D(ncol,K).LE.2.5.AND.cldfra3d(i,k,j).gt.0. &amp;<a name='10516'>
     &amp;                            .AND. (XLAND(I,J)-1.5).GT.0.) then      <font color=#447700>!--- Ocean<a name='10517'></font>
                     recloud1D(ncol,K) = 10.5<a name='10518'>
                  elseif (recloud1D(ncol,K).LE.2.5.AND.cldfra3d(i,k,j).gt.0. &amp;<a name='10519'>
     &amp;                            .AND. (XLAND(I,J)-1.5).LT.0.) then      <font color=#447700>!--- Land<a name='10520'></font>
                     recloud1D(ncol,K) = 7.5<a name='10521'>
                  endif<a name='10522'>
               ENDDO<a name='10523'>
            ELSE<a name='10524'>
               DO K=kts,kte<a name='10525'>
#if (EM_CORE==1)<a name='10526'>
                  recloud1D(ncol,K) = 5.0<a name='10527'>
#else<a name='10528'>
                  recloud1D(ncol,K) = 10.0  <font color=#447700>! was 5.0<a name='10529'></font>
#endif<a name='10530'>
               ENDDO<a name='10531'>
            ENDIF<a name='10532'>
<a name='10533'>
            IF ( has_reqi .ne. 0) THEN<a name='10534'>
               inflgsw  = 4<a name='10535'>
               iceflgsw = 4<a name='10536'>
               DO K=kts,kte<a name='10537'>
                  reice1D(ncol,K) = MAX(5., re_ice(I,K,J)*1.E6)<a name='10538'>
                  if (reice1D(ncol,K).LE.5..AND.cldfra3d(i,k,j).gt.0.) then<a name='10539'>
                     idx_rei = int(t3d(i,k,j)-179.)<a name='10540'>
                     idx_rei = min(max(idx_rei,1),75)<a name='10541'>
                     corr = t3d(i,k,j) - int(t3d(i,k,j))<a name='10542'>
                     reice1D(ncol,K) = retab(idx_rei)*(1.-corr) +      &amp;<a name='10543'>
     &amp;                                 retab(idx_rei+1)*corr<a name='10544'>
                     reice1D(ncol,K) = MAX(reice1D(ncol,K), 5.0)<a name='10545'>
                  endif<a name='10546'>
               ENDDO<a name='10547'>
            ELSE<a name='10548'>
               DO K=kts,kte<a name='10549'>
                  reice1D(ncol,K) = 10.<a name='10550'>
               ENDDO<a name='10551'>
            ENDIF<a name='10552'>
<a name='10553'>
            IF ( has_reqs .ne. 0) THEN<a name='10554'>
               inflgsw  = 5<a name='10555'>
               iceflgsw = 5<a name='10556'>
               DO K=kts,kte<a name='10557'>
                  resnow1D(ncol,K) = MAX(10., re_snow(I,K,J)*1.E6)<a name='10558'>
               ENDDO<a name='10559'>
            ELSE<a name='10560'>
               DO K=kts,kte<a name='10561'>
#if (EM_CORE==1) <a name='10562'>
                  resnow1D(ncol,K) = 10.0<a name='10563'>
#else<a name='10564'>
                 tem2 = 25.0  <font color=#447700>!- was 10.0<a name='10565'></font>
                 tem3=1.e3*rho1d(k)*qi1d(k)  <font color=#447700>!- IWC (g m^-3)<a name='10566'></font>
                 if (tem3&gt;thresh) then       <font color=#447700>!- Only when IWC&gt;1.e-9 g m^-3<a name='10567'></font>
                   tem1=t1d(k)-273.15<a name='10568'>
                   if (tem1 &lt; -50.0) then<a name='10569'>
                     tem2 = re_50C*tem3**0.109<a name='10570'>
                   elseif (tem1 &lt; -40.0) then<a name='10571'>
                      tem2 = re_40C*tem3**0.08<a name='10572'>
                   elseif (tem1 &lt; -30.0) then<a name='10573'>
                      tem2 = re_30C*tem3**0.055<a name='10574'>
                   else<a name='10575'>
                      tem2 = re_20C*tem3**0.031<a name='10576'>
                   endif<a name='10577'>
                    tem2 = max(25.,tem2)<a name='10578'>
                 endif<a name='10579'>
                 reice1D(ncol,K) = min(tem2, 135.72)   <font color=#447700>!- 1.0315*reice &lt;= 140 microns <a name='10580'></font>
#endif<a name='10581'>
               ENDDO<a name='10582'>
            ENDIF<a name='10583'>
<a name='10584'>
<font color=#447700>! special case for P3 microphysics<a name='10585'></font>
<font color=#447700>! put ice into snow category for optics, then set ice to zero<a name='10586'></font>
            IF ( has_reqs .eq. 0 .and. has_reqi .ne. 0 .and. has_reqc .ne. 0) THEN<a name='10587'>
               inflgsw  = 5<a name='10588'>
               iceflgsw = 5<a name='10589'>
               DO K=kts,kte<a name='10590'>
                  resnow1D(ncol,K) = MAX(10., re_ice(I,K,J)*1.E6)<a name='10591'>
                  QS1D(K)=QI3D(I,K,J)<a name='10592'>
                  QI1D(K)=0.<a name='10593'>
                  reice1D(ncol,K)=10.<a name='10594'>
               END DO<a name='10595'>
<a name='10596'>
            END IF<a name='10597'>
<a name='10598'>
         ENDIF<a name='10599'>
<a name='10600'>
<font color=#447700>! Set cosine of solar zenith angle<a name='10601'></font>
         coszen(ncol) = coszrs<a name='10602'>
<font color=#447700>! Set solar constant<a name='10603'></font>
         scon = solcon<a name='10604'>
<font color=#447700>! For Earth/Sun distance adjustment in RRTMG<a name='10605'></font>
<font color=#447700>!         dyofyr = julday<a name='10606'></font>
<font color=#447700>!         adjes = 0.0 <a name='10607'></font>
<font color=#447700>! For WRF, solar constant is already provided with eccentricity adjustment,<a name='10608'></font>
<font color=#447700>! so do not do this in RRTMG<a name='10609'></font>
         dyofyr = 0<a name='10610'>
         adjes = 1.0 <a name='10611'>
<a name='10612'>
<font color=#447700>! Layer indexing goes bottom to top here for all fields.<a name='10613'></font>
<font color=#447700>! Water vapor and ozone are converted from mmr to vmr. <a name='10614'></font>
<font color=#447700>! Pressures are in units of mb here. <a name='10615'></font>
         plev(ncol,1) = pw1d(1)<a name='10616'>
         tlev(ncol,1) = tw1d(1)<a name='10617'>
         tsfc(ncol) = tsk(i,j)<a name='10618'>
         do k = kts, kte<a name='10619'>
            play(ncol,k) = p1d(k)<a name='10620'>
            plev(ncol,k+1) = pw1d(k+1)<a name='10621'>
            pdel(ncol,k) = plev(ncol,k) - plev(ncol,k+1)<a name='10622'>
            tlay(ncol,k) = t1d(k)<a name='10623'>
            tlev(ncol,k+1) = tw1d(k+1)<a name='10624'>
            h2ovmr(ncol,k) = qv1d(k) * amdw<a name='10625'>
            co2vmr(ncol,k) = co2<a name='10626'>
            o2vmr(ncol,k) = o2<a name='10627'>
            ch4vmr(ncol,k) = ch4<a name='10628'>
            n2ovmr(ncol,k) = n2o<a name='10629'>
         enddo<a name='10630'>
<a name='10631'>
<font color=#447700>!  Define profile values for extra layer from model top to top of atmosphere. <a name='10632'></font>
<font color=#447700>!  The top layer temperature for all gridpoints is set to the top layer-1 <a name='10633'></font>
<font color=#447700>!  temperature plus a constant (0 K) that represents an isothermal layer    <a name='10634'></font>
<font color=#447700>!  above ptop.  Top layer interface temperatures are linearly interpolated <a name='10635'></font>
<font color=#447700>!  from the layer temperatures.  <a name='10636'></font>
<a name='10637'>
         play(ncol,kte+1) = 0.5 * plev(ncol,kte+1)<a name='10638'>
         tlay(ncol,kte+1) = tlev(ncol,kte+1) + 0.0<a name='10639'>
         plev(ncol,kte+2) = 1.0e-5<a name='10640'>
         tlev(ncol,kte+2) = tlev(ncol,kte+1) + 0.0<a name='10641'>
         tlev(ncol,kte+2) = tlev(ncol,kte+1) + 0.0<a name='10642'>
         h2ovmr(ncol,kte+1) = h2ovmr(ncol,kte) <a name='10643'>
         co2vmr(ncol,kte+1) = co2vmr(ncol,kte) <a name='10644'>
         o2vmr(ncol,kte+1) = o2vmr(ncol,kte) <a name='10645'>
         ch4vmr(ncol,kte+1) = ch4vmr(ncol,kte) <a name='10646'>
         n2ovmr(ncol,kte+1) = n2ovmr(ncol,kte) <a name='10647'>
<a name='10648'>
<font color=#447700>! Get ozone profile including amount in extra layer above model top<a name='10649'></font>
         call <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#INIRAD'>inirad</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INIRAD_5"> (o3mmr,plev,kts,kte)<a name='10650'>
<a name='10651'>
        if(present(o33d)) then<a name='10652'>
         do k = kts, kte+1<a name='10653'>
            o3vmr(ncol,k) = o3mmr(k) * amdo<a name='10654'>
            IF ( PRESENT( O33D ) ) THEN<a name='10655'>
            if(o3input .eq. 2)then<a name='10656'>
               if(k.le.kte)then<a name='10657'>
                 o3vmr(ncol,k) = o31d(k)<a name='10658'>
               else<a name='10659'>
<font color=#447700>! apply shifted climatology profile above model top<a name='10660'></font>
                 o3vmr(ncol,k) = o31d(kte) - o3mmr(kte)*amdo + o3mmr(k)*amdo<a name='10661'>
                 if(o3vmr(ncol,k) .le. 0.)o3vmr(ncol,k) = o3mmr(k)*amdo<a name='10662'>
               endif<a name='10663'>
            endif<a name='10664'>
            ENDIF<a name='10665'>
         enddo<a name='10666'>
        else<a name='10667'>
         do k = kts, kte+1<a name='10668'>
            o3vmr(ncol,k) = o3mmr(k) * amdo<a name='10669'>
         enddo<a name='10670'>
        endif<a name='10671'>
<a name='10672'>
<font color=#447700>! Set surface albedo for direct and diffuse radiation in UV/visible and<a name='10673'></font>
<font color=#447700>! near-IR spectral regions<a name='10674'></font>
<font color=#447700>! -------------- Zhenxin 2011-06-20 ----------- !<a name='10675'></font>
<a name='10676'>
<font color=#447700>! ------- 1.  Commented by Zhenxin 2011-06-20 for SSiB coupling modified ---- !<a name='10677'></font>
<font color=#447700>!         asdir(ncol) = albedo(i,j)<a name='10678'></font>
<font color=#447700>!         asdif(ncol) = albedo(i,j)<a name='10679'></font>
<font color=#447700>!         aldir(ncol) = albedo(i,j)<a name='10680'></font>
<font color=#447700>!         aldif(ncol) = albedo(i,j)<a name='10681'></font>
<font color=#447700>! -------    End of Comments    ------ !<a name='10682'></font>
<a name='10683'>
<font color=#447700>! ------- 2. New Addiation  ------ !<a name='10684'></font>
    IF ( sf_surface_physics .eq. 8 .AND. XLAND(i,j) .LT. 1.5) THEN<a name='10685'>
         asdir(ncol) = ALSWVISDIR(I,J)<a name='10686'>
         asdif(ncol) = ALSWVISDIF(I,J)<a name='10687'>
         aldir(ncol) = ALSWNIRDIR(I,J)<a name='10688'>
         aldif(ncol) = ALSWNIRDIF(I,J)<a name='10689'>
    ELSE<a name='10690'>
         asdir(ncol) = albedo(i,j)<a name='10691'>
         asdif(ncol) = albedo(i,j)<a name='10692'>
         aldir(ncol) = albedo(i,j)<a name='10693'>
         aldif(ncol) = albedo(i,j)<a name='10694'>
    ENDIF<a name='10695'>
<a name='10696'>
<font color=#447700>! ---------- End of Addiation ------!<a name='10697'></font>
<font color=#447700>! ----------  End of fds_Zhenxin 2011-06-20   --------------!<a name='10698'></font>
<a name='10699'>
<font color=#447700>! Define cloud optical properties for radiation (inflgsw = 0)<a name='10700'></font>
<font color=#447700>! This option is not currently active<a name='10701'></font>
<font color=#447700>! Cloud and precipitation paths in g/m2 <a name='10702'></font>
<font color=#447700>! qi=0 if no ice phase<a name='10703'></font>
<font color=#447700>! qs=0 if no ice phase<a name='10704'></font>
         if (inflgsw .eq. 0) then<a name='10705'>
<a name='10706'>
<font color=#447700>! Set cloud fraction and cloud optical properties here; not yet active<a name='10707'></font>
            do k = kts, kte<a name='10708'>
               cldfrac(ncol,k) = cldfra1d(k)<a name='10709'>
               do nb = 1, nbndsw<a name='10710'>
                  taucld(nb,ncol,k) = 0.0<a name='10711'>
                  ssacld(nb,ncol,k) = 1.0<a name='10712'>
                  asmcld(nb,ncol,k) = 0.0<a name='10713'>
                  fsfcld(nb,ncol,k) = 0.0<a name='10714'>
               enddo<a name='10715'>
            enddo<a name='10716'>
<a name='10717'>
<font color=#447700>! Zero out cloud physical property arrays; not used when passing optical properties<a name='10718'></font>
<font color=#447700>! into radiation<a name='10719'></font>
            do k = kts, kte<a name='10720'>
               clwpth(ncol,k) = 0.0<a name='10721'>
               ciwpth(ncol,k) = 0.0<a name='10722'>
               rel(ncol,k) = 10.0<a name='10723'>
               rei(ncol,k) = 10.<a name='10724'>
            enddo<a name='10725'>
         endif<a name='10726'>
<a name='10727'>
<font color=#447700>! Define cloud physical properties for radiation (inflgsw = 1 or 2)<a name='10728'></font>
<font color=#447700>! Cloud fraction<a name='10729'></font>
<font color=#447700>! Set cloud arrays if passing cloud physical properties into radiation<a name='10730'></font>
         if (inflgsw .gt. 0) then <a name='10731'>
            do k = kts, kte<a name='10732'>
               cldfrac(ncol,k) = cldfra1d(k)<a name='10733'>
            enddo<a name='10734'>
<a name='10735'>
<font color=#447700>! Compute cloud water/ice paths and particle sizes for input to radiation (CAM method)<a name='10736'></font>
            pcols = ncol<a name='10737'>
            pver = kte - kts + 1<a name='10738'>
            gravmks = g<a name='10739'>
            landfrac(ncol) = 2.-XLAND(I,J)<a name='10740'>
            landm(ncol) = landfrac(ncol)<a name='10741'>
            snowh(ncol) = 0.001*SNOW(I,J)<a name='10742'>
            icefrac(ncol) = XICE(I,J)<a name='10743'>
<a name='10744'>
<font color=#447700>! From module_ra_cam: Convert liquid and ice mixing ratios to water paths;<a name='10745'></font>
<font color=#447700>! pdel is in mb here; convert back to Pa (*100.)<a name='10746'></font>
<font color=#447700>! Water paths are in units of g/m2<a name='10747'></font>
<font color=#447700>! snow added as ice cloud (JD 091022)<a name='10748'></font>
            do k = kts, kte<a name='10749'>
               gicewp = (qi1d(k)+qs1d(k)) * pdel(ncol,k)*100.0 / gravmks * 1000.0     <font color=#447700>! Grid box ice water path.<a name='10750'></font>
               gliqwp = qc1d(k) * pdel(ncol,k)*100.0 / gravmks * 1000.0     <font color=#447700>! Grid box liquid water path.<a name='10751'></font>
               cicewp(ncol,k) = gicewp / max(0.01,cldfrac(ncol,k))               <font color=#447700>! In-cloud ice water path.<a name='10752'></font>
               cliqwp(ncol,k) = gliqwp / max(0.01,cldfrac(ncol,k))               <font color=#447700>! In-cloud liquid water path.<a name='10753'></font>
            end do<a name='10754'>
<a name='10755'>
<font color=#447700>! Mukul<a name='10756'></font>
<font color=#447700>!..The ice water path is already sum of cloud ice and snow, but when we have explicit<a name='10757'></font>
<font color=#447700>!.. ice effective radius, overwrite the ice path with only the cloud ice variable,<a name='10758'></font>
<font color=#447700>!.. leaving out the snow for its own effect.<a name='10759'></font>
           if(iceflgsw.ge.4)then <a name='10760'>
              do k = kts, kte<a name='10761'>
                     gicewp = qi1d(k) * pdel(ncol,k)*100.0 / gravmks * 1000.0     <font color=#447700>! Grid box ice water path.<a name='10762'></font>
                     cicewp(ncol,k) = gicewp / max(0.01,cldfrac(ncol,k))               <font color=#447700>! In-cloud ice water path.<a name='10763'></font>
              end do<a name='10764'>
           end if<a name='10765'>
<a name='10766'>
<font color=#447700>!..Here the snow path is adjusted if (radiation) effective radius of snow is<a name='10767'></font>
<font color=#447700>!.. larger than what we currently have in the lookup tables.  Since mass goes<a name='10768'></font>
<font color=#447700>!.. rather close to diameter squared, adjust the mixing ratio of snow used<a name='10769'></font>
<font color=#447700>!.. to compute its water path in combination with the max diameter.  Not a<a name='10770'></font>
<font color=#447700>!.. perfect fix, but certainly better than using all snow mass when diameter is<a name='10771'></font>
<font color=#447700>!.. far larger than table currently contains and crystal sizes much larger than<a name='10772'></font>
<font color=#447700>!.. about 140 microns have lesser impact than those much smaller sizes.<a name='10773'></font>
<a name='10774'>
           if(iceflgsw.eq.5)then<a name='10775'>
              do k = kts, kte<a name='10776'>
                 snow_mass_factor = 1.0                 <a name='10777'>
                 if (resnow1d(ncol,k) .gt. 130.)then <a name='10778'>
                     snow_mass_factor = (130.0/resnow1d(ncol,k))*(130.0/resnow1d(ncol,k))<a name='10779'>
                     resnow1d(ncol,k)   = 130.0<a name='10780'>
                 endif<a name='10781'>
                 gsnowp = qs1d(k) * snow_mass_factor * pdel(ncol,k)*100.0 / gravmks * 1000.0     <font color=#447700>! Grid box snow water path.<a name='10782'></font>
                 csnowp(ncol,k) = gsnowp / max(0.01,cldfrac(ncol,k))<a name='10783'>
              end do<a name='10784'>
           end if<a name='10785'>
<a name='10786'>
<a name='10787'>
<font color=#447700>!link the aerosol feedback to cloud  -czhao<a name='10788'></font>
  if( PRESENT( progn ) ) then<a name='10789'>
    if (progn == 1) then<a name='10790'>
<font color=#447700>!jdfcz     if(prescribe==0) then<a name='10791'></font>
<a name='10792'>
      pi = 4.*atan(1.0)<a name='10793'>
      third=1./3.<a name='10794'>
      rhoh2o=1.e3<a name='10795'>
      relconst=3/(4.*pi*rhoh2o)<a name='10796'>
<font color=#447700>!     minimun liquid water path to calculate rel<a name='10797'></font>
<font color=#447700>!     corresponds to optical depth of 1.e-3 for radius 4 microns.<a name='10798'></font>
      lwpmin=3.e-5<a name='10799'>
      do k = kts, kte<a name='10800'>
         reliq(ncol,k) = 10.<a name='10801'>
         if( PRESENT( F_QNDROP ) ) then<a name='10802'>
            if( F_QNDROP ) then<a name='10803'>
              if ( qc1d(k)*pdel(ncol,k).gt.lwpmin.and. &amp;<a name='10804'>
                   qndrop1d(k).gt.1000. ) then<a name='10805'>
               reliq(ncol,k)=(relconst*qc1d(k)/qndrop1d(k))**third <font color=#447700>! effective radius in m<a name='10806'></font>
<font color=#447700>!           apply scaling from Martin et al., JAS 51, 1830.<a name='10807'></font>
               reliq(ncol,k)=1.1*reliq(ncol,k)<a name='10808'>
               reliq(ncol,k)=reliq(ncol,k)*1.e6 <font color=#447700>! convert from m to microns<a name='10809'></font>
               reliq(ncol,k)=max(reliq(ncol,k),4.)<a name='10810'>
               reliq(ncol,k)=min(reliq(ncol,k),20.)<a name='10811'>
              end if<a name='10812'>
            end if<a name='10813'>
         end if<a name='10814'>
      end do<a name='10815'>
<font color=#447700>!jdfcz     else ! prescribe <a name='10816'></font>
<font color=#447700>! following Kiehl<a name='10817'></font>
<font color=#447700>!     call relcalc(ncol, pcols, pver, tlay, landfrac, landm, icefrac, reliq, snowh)<a name='10818'></font>
<font color=#447700>!      write(0,*) 'sw prescribe aerosol',maxval(qndrop3d)<a name='10819'></font>
<font color=#447700>!jdfcz     endif<a name='10820'></font>
    else  <font color=#447700>! progn   (progn=1)<a name='10821'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#RELCALC'>relcalc</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RELCALC_5">(ncol, pcols, pver, tlay, landfrac, landm, icefrac, reliq, snowh)<a name='10822'>
    endif<a name='10823'>
  else   <font color=#447700>!progn   (PRESENT)<a name='10824'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#RELCALC'>relcalc</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RELCALC_6">(ncol, pcols, pver, tlay, landfrac, landm, icefrac, reliq, snowh)<a name='10825'>
  endif<a name='10826'>
<a name='10827'>
<font color=#447700>! following Kristjansson and Mitchell<a name='10828'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#REICALC'>reicalc</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="REICALC_3">(ncol, pcols, pver, tlay, reice)<a name='10829'>
<a name='10830'>
<a name='10831'>
<a name='10832'>
<font color=#447700>!..If we already have effective radius of cloud and ice, then just overwrite what<a name='10833'></font>
<font color=#447700>!.. was computed in the relcalc and reicalc subroutines above.<a name='10834'></font>
<a name='10835'>
      if (inflgsw .ge. 3) then<a name='10836'>
         do k = kts, kte<a name='10837'>
            reliq(ncol,k) = recloud1d(ncol,k)<a name='10838'>
         end do<a name='10839'>
      endif<a name='10840'>
#if (EM_CORE==1) <a name='10841'>
      if (iceflgsw .ge. 4) then<a name='10842'>
#else<a name='10843'>
      if (iceflgsw .ge. 3) then   <font color=#447700>!BSF: was .ge. 4<a name='10844'></font>
#endif<a name='10845'>
         do k = kts, kte<a name='10846'>
            reice(ncol,k) = reice1d(ncol,k)<a name='10847'>
         end do<a name='10848'>
      endif<a name='10849'>
<a name='10850'>
<a name='10851'>
#if 0<a name='10852'>
      if (i==80.and.j==30) then<a name='10853'>
#if defined( DM_PARALLEL ) &amp;&amp; <font color=#447700>! defined( STUBMPI) <a name='10854'></font>
      if( PRESENT( progn ) ) write(0,*) 'aerosol indirect',progn<a name='10855'>
      write(0,*)'sw water eff radius',reliq(ncol,10),reliq(ncol,20),reliq(ncol,25)<a name='10856'>
      write(0,*)'sw ice eff radius',reice(ncol,10),reice(ncol,20),reice(ncol,25)<a name='10857'>
#endif<a name='10858'>
      endif<a name='10859'>
#endif<a name='10860'>
<a name='10861'>
<a name='10862'>
<font color=#447700>! Limit upper bound of reice for Fu ice parameterization and convert<a name='10863'></font>
<font color=#447700>! from effective radius to generalized effective size (*1.0315; Fu, 1996)<a name='10864'></font>
            if (iceflgsw .eq. 3) then<a name='10865'>
               do k = kts, kte<a name='10866'>
                  reice(ncol,k) = reice(ncol,k) * 1.0315<a name='10867'>
                  reice(ncol,k) = min(140.0,reice(ncol,k))<a name='10868'>
               end do<a name='10869'>
            endif<a name='10870'>
            <a name='10871'>
<font color=#447700>!if CAMMGMP is used, use output from CAMMGMP            <a name='10872'></font>
<font color=#447700>!PMA<a name='10873'></font>
            if(is_CAMMGMP_used) then<a name='10874'>
               do k = kts, kte<a name='10875'>
                  if ( qi1d(k) .gt. 1.e-20 .or. qs1d(k) .gt. 1.e-20) then<a name='10876'>
                     reice(ncol,k) = iradius(i,k,j)<a name='10877'>
                  else<a name='10878'>
                     reice(ncol,k) = 25.<a name='10879'>
                  end if<a name='10880'>
                  reice(ncol,k) = max(5., min(140.0,reice(ncol,k)))<a name='10881'>
                  if ( qc1d(k) .gt. 1.e-20) then<a name='10882'>
                     reliq(ncol,k) = lradius(i,k,j)<a name='10883'>
                  else<a name='10884'>
                     reliq(ncol,k) = 10.<a name='10885'>
                  end if<a name='10886'>
                  reliq(ncol,k) = max(2.5, min(60.0,reliq(ncol,k)))<a name='10887'>
               enddo<a name='10888'>
            endif<a name='10889'>
<a name='10890'>
<font color=#447700>! Set cloud physical property arrays<a name='10891'></font>
            do k = kts, kte<a name='10892'>
               clwpth(ncol,k) = cliqwp(ncol,k)<a name='10893'>
               ciwpth(ncol,k) = cicewp(ncol,k)<a name='10894'>
               rel(ncol,k) = reliq(ncol,k)<a name='10895'>
               rei(ncol,k) = reice(ncol,k)<a name='10896'>
            enddo<a name='10897'>
<a name='10898'>
<font color=#447700>!Mukul<a name='10899'></font>
            if (inflgsw .eq. 5) then<a name='10900'>
               do k = kts, kte<a name='10901'>
                  cswpth(ncol,k) = csnowp(ncol,k)<a name='10902'>
                  res(ncol,k) = resnow1d(ncol,k)<a name='10903'>
               end do<a name='10904'>
            else<a name='10905'>
               do k = kts, kte<a name='10906'>
                  cswpth(ncol,k) = 0.0<a name='10907'>
                  res(ncol,k) = 10.0<a name='10908'>
               end do<a name='10909'>
            endif<a name='10910'>
<a name='10911'>
<font color=#447700>! Zero out cloud optical properties here, calculated in radiation <a name='10912'></font>
            do k = kts, kte<a name='10913'>
               do nb = 1, nbndsw<a name='10914'>
                  taucld(nb,ncol,k) = 0.0<a name='10915'>
                  ssacld(nb,ncol,k) = 1.0<a name='10916'>
                  asmcld(nb,ncol,k) = 0.0<a name='10917'>
                  fsfcld(nb,ncol,k) = 0.0<a name='10918'>
               enddo<a name='10919'>
            enddo<a name='10920'>
         endif<a name='10921'>
<a name='10922'>
<font color=#447700>! No clouds are allowed in the extra layer from model top to TOA<a name='10923'></font>
         clwpth(ncol,kte+1) = 0.<a name='10924'>
         ciwpth(ncol,kte+1) = 0.<a name='10925'>
         cswpth(ncol,kte+1) = 0.<a name='10926'>
         rel(ncol,kte+1) = 10.<a name='10927'>
         rei(ncol,kte+1) = 10.<a name='10928'>
         res(ncol,kte+1) = 10.<a name='10929'>
         cldfrac(ncol,kte+1) = 0.<a name='10930'>
         do nb = 1, nbndsw<a name='10931'>
            taucld(nb,ncol,kte+1) = 0.<a name='10932'>
            ssacld(nb,ncol,kte+1) = 1.<a name='10933'>
            asmcld(nb,ncol,kte+1) = 0.<a name='10934'>
            fsfcld(nb,ncol,kte+1) = 0.<a name='10935'>
         enddo<a name='10936'>
<a name='10937'>
         iplon = 1<a name='10938'>
         irng = 0<a name='10939'>
         permuteseed = 1<a name='10940'>
<a name='10941'>
<font color=#447700>! Sub-column generator for McICA<a name='10942'></font>
<a name='10943'>
         call <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#MCICA_SUBCOL_SW'>mcica_subcol_sw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MCICA_SUBCOL_SW_1">(iplon, ncol, nlay, icld, permuteseed, irng, play, &amp;<a name='10944'>
                       cldfrac, ciwpth, clwpth, cswpth, rei, rel, res, taucld, ssacld, asmcld, fsfcld, &amp;<a name='10945'>
                       cldfmcl, ciwpmcl, clwpmcl, cswpmcl, reicmcl, relqmcl, resnmcl, &amp;<a name='10946'>
                       taucmcl, ssacmcl, asmcmcl, fsfcmcl)<a name='10947'>
<a name='10948'>
<a name='10949'>
<font color=#447700>!--------------------------------------------------------------------------<a name='10950'></font>
<font color=#447700>! Aerosol optical depth, single scattering albedo and asymmetry parameter -czhao 03/2010<a name='10951'></font>
<font color=#447700>!--------------------------------------------------------------------------<a name='10952'></font>
<font color=#447700>! by layer for each RRTMG shortwave band<a name='10953'></font>
<font color=#447700>! No aerosols in top layer above model top (kte+1).<a name='10954'></font>
<font color=#447700>!cz        do nb = 1, nbndsw<a name='10955'></font>
<font color=#447700>!cz           do k = kts, kte+1<a name='10956'></font>
<font color=#447700>!cz              tauaer(ncol,k,nb) = 0.<a name='10957'></font>
<font color=#447700>!cz              ssaaer(ncol,k,nb) = 1.<a name='10958'></font>
<font color=#447700>!cz              asmaer(ncol,k,nb) = 0.<a name='10959'></font>
<font color=#447700>!cz           enddo<a name='10960'></font>
<font color=#447700>!cz        enddo<a name='10961'></font>
<a name='10962'>
<font color=#447700>! ... Aerosol effects. Added aerosol feedbacks from Chem , 03/2010 -czhao<a name='10963'></font>
<font color=#447700>!<a name='10964'></font>
      do nb = 1, nbndsw<a name='10965'>
      do k = kts,kte+1<a name='10966'>
         tauaer(ncol,k,nb) = 0.<a name='10967'>
         ssaaer(ncol,k,nb) = 1.<a name='10968'>
         asmaer(ncol,k,nb) = 0.<a name='10969'>
      end do<a name='10970'>
      end do<a name='10971'>
<a name='10972'>
      if ( associated (tauaer3d_sw) ) then<a name='10973'>
<font color=#447700>! ---- jararias 11/2012<a name='10974'></font>
            do nb=1,nbndsw<a name='10975'>
               do k=kts,kte<a name='10976'>
                  tauaer(ncol,k,nb)=tauaer3d_sw(i,k,j,nb)<a name='10977'>
                  ssaaer(ncol,k,nb)=ssaaer3d_sw(i,k,j,nb)<a name='10978'>
                  asmaer(ncol,k,nb)=asyaer3d_sw(i,k,j,nb)<a name='10979'>
               end do<a name='10980'>
            end do<a name='10981'>
      end if<a name='10982'>
<a name='10983'>
#if ( WRF_CHEM == 1 )<a name='10984'>
   IF ( AER_RA_FEEDBACK == 1) then<a name='10985'>
      do nb = 1, nbndsw<a name='10986'>
         wavemid(nb)=0.5*(wavemin(nb)+wavemax(nb))  <font color=#447700>! um<a name='10987'></font>
      do k = kts,kte      <font color=#447700>!wig<a name='10988'></font>
<a name='10989'>
<font color=#447700>! convert optical properties at 300,400,600, and 999 to conform to the band wavelengths<a name='10990'></font>
<font color=#447700>! tauaer - use angstrom exponent<a name='10991'></font>
        if(tauaer300(i,k,j).gt.thresh .and. tauaer999(i,k,j).gt.thresh) then<a name='10992'>
           ang=alog(tauaer300(i,k,j)/tauaer999(i,k,j))/alog(999./300.)<a name='10993'>
           tauaer(ncol,k,nb)=tauaer400(i,k,j)*(0.4/wavemid(nb))**ang<a name='10994'>
           <font color=#447700>!tauaer(ncol,k,nb)=tauaer600(i,k,j)*(0.6/wavemid(nb))**ang <a name='10995'></font>
           if (i==30.and.j==49.and.k==2.and.nb==12) then<a name='10996'>
            write(0,*) 'TAU from 600 vs 400 in RRTMG',tauaer600(i,k,j),tauaer400(i,k,j)<a name='10997'>
            print*, 'TAU from 600 vs 400 in RRTMG',tauaer600(i,k,j),tauaer400(i,k,j)<a name='10998'>
            write(0,*) tauaer600(i,k,j)*(0.6/wavemid(nb))**ang,tauaer400(i,k,j)*(0.4/wavemid(nb))**ang<a name='10999'>
            print*, tauaer600(i,k,j)*(0.6/wavemid(nb))**ang,tauaer400(i,k,j)*(0.4/wavemid(nb))**ang<a name='11000'>
           endif<a name='11001'>
<font color=#447700>! ssa - linear interpolation; extrapolation<a name='11002'></font>
           slope=(waer600(i,k,j)-waer400(i,k,j))/.2<a name='11003'>
           ssaaer(ncol,k,nb) = slope*(wavemid(nb)-.6)+waer600(i,k,j)<a name='11004'>
           if(ssaaer(ncol,k,nb).lt.0.4) ssaaer(ncol,k,nb)=0.4<a name='11005'>
           if(ssaaer(ncol,k,nb).ge.1.0) ssaaer(ncol,k,nb)=1.0<a name='11006'>
<font color=#447700>! g - linear interpolation;extrapolation<a name='11007'></font>
           slope=(gaer600(i,k,j)-gaer400(i,k,j))/.2<a name='11008'>
           asmaer(ncol,k,nb) = slope*(wavemid(nb)-.6)+gaer600(i,k,j) <font color=#447700>! notice reversed varaibles<a name='11009'></font>
           if(asmaer(ncol,k,nb).lt.0.5) asmaer(ncol,k,nb)=0.5<a name='11010'>
           if(asmaer(ncol,k,nb).ge.1.0) asmaer(ncol,k,nb)=1.0<a name='11011'>
        endif<a name='11012'>
      end do <font color=#447700>! k<a name='11013'></font>
      end do <font color=#447700>! nb<a name='11014'></font>
<a name='11015'>
<font color=#447700>!wig beg<a name='11016'></font>
      do nb = 1, nbndsw<a name='11017'>
         slope = 0.  <font color=#447700>!use slope as a sum holder<a name='11018'></font>
         do k = kts,kte<a name='11019'>
            slope = slope + tauaer(ncol,k,nb)<a name='11020'>
         end do<a name='11021'>
         if( slope &lt; 0. ) then<a name='11022'>
            write(msg,'("ERROR: Negative total optical depth of ",f8.2," at point i,j,nb=",3i5)') slope,i,j,nb<a name='11023'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1084">(msg)<a name='11024'>
         else if( slope &gt; 6. ) then<a name='11025'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_866">("-------------------------")<a name='11026'>
            write(msg,'("WARNING: Large total sw optical depth of ",f8.2," at point i,j,nb=",3i5)') slope,i,j,nb<a name='11027'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_867">(msg)<a name='11028'>
<a name='11029'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_868">("Diagnostics 1: k, tauaer300, tauaer400, tauaer600, tauaer999, tauaer")<a name='11030'>
            do k=kts,kte<a name='11031'>
               write(msg,'(i4,5f8.2)') k, tauaer300(i,k,j), tauaer400(i,k,j), &amp;<a name='11032'>
                    tauaer600(i,k,j), tauaer999(i,k,j),tauaer(ncol,k,nb)<a name='11033'>
               call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_869">(msg)<a name='11034'>
               <font color=#447700>!czhao set an up-limit here to avoid segmentation fault <a name='11035'></font>
               <font color=#447700>!from extreme AOD<a name='11036'></font>
               tauaer(ncol,k,nb)=tauaer(ncol,k,nb)*6.0/slope <a name='11037'>
            end do<a name='11038'>
<a name='11039'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_870">("Diagnostics 2: k, gaer300, gaer400, gaer600, gaer999")<a name='11040'>
            do k=kts,kte<a name='11041'>
               write(msg,'(i4,4f8.2)') k, gaer300(i,k,j), gaer400(i,k,j), &amp;<a name='11042'>
                    gaer600(i,k,j), gaer999(i,k,j)<a name='11043'>
               call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_871">(msg)<a name='11044'>
            end do<a name='11045'>
<a name='11046'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_872">("Diagnostics 3: k, waer300, waer400, waer600, waer999")<a name='11047'>
            do k=kts,kte<a name='11048'>
               write(msg,'(i4,4f8.2)') k, waer300(i,k,j), waer400(i,k,j), &amp;<a name='11049'>
                    waer600(i,k,j), waer999(i,k,j)<a name='11050'>
               call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_873">(msg)<a name='11051'>
            end do<a name='11052'>
<a name='11053'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_874">("Diagnostics 4: k, ssaal, asyal, taual")<a name='11054'>
            do k=kts-1,kte<a name='11055'>
               write(msg,'(i4,3f8.2)') k, ssaaer(i,k,nb), asmaer(i,k,nb), tauaer(i,k,nb)<a name='11056'>
               call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_875">(msg)<a name='11057'>
            end do<a name='11058'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_876">("-------------------------")<a name='11059'>
         endif<a name='11060'>
      enddo  <font color=#447700>! nb<a name='11061'></font>
      endif  <font color=#447700>! aer_ra_feedback<a name='11062'></font>
#endif<a name='11063'>
<a name='11064'>
<a name='11065'>
<font color=#447700>! Zero array for input of aerosol optical thickness for use with<a name='11066'></font>
<font color=#447700>! ECMWF aerosol types (not used)<a name='11067'></font>
         do na = 1, naerec<a name='11068'>
            do k = kts, kte+1<a name='11069'>
               ecaer(ncol,k,na) = 0.<a name='11070'>
            enddo<a name='11071'>
         enddo<a name='11072'>
<a name='11073'>
      IF ( PRESENT( aerod ) ) THEN<a name='11074'>
      if ( aer_opt .eq. 0 ) then<a name='11075'>
         do na = 1, naerec<a name='11076'>
            do k = kts, kte+1<a name='11077'>
               ecaer(ncol,k,na) = 0.<a name='11078'>
            enddo<a name='11079'>
         enddo<a name='11080'>
      else if ( aer_opt .eq. 1 ) then<a name='11081'>
         do na = 1, naerec<a name='11082'>
            do k = kts, kte<a name='11083'>
               ecaer(ncol,k,na) = aerod(i,k,j,na)<a name='11084'>
            enddo<a name='11085'>
<font color=#447700>! assuming 0 or same value at the top?<a name='11086'></font>
<font color=#447700>!           ecaer(ncol,kte+1,na) = ecaer(ncol,kte,na)<a name='11087'></font>
            ecaer(ncol,kte+1,na) = 0.<a name='11088'>
         enddo<a name='11089'>
      endif<a name='11090'>
      ENDIF<a name='11091'>
<a name='11092'>
<font color=#447700>! Call RRTMG shortwave radiation model<a name='11093'></font>
<a name='11094'>
         call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW'>rrtmg_sw</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_1"> &amp;<a name='11095'>
            (ncol    ,nlay    ,icld    , &amp;<a name='11096'>
             play    ,plev    ,tlay    ,tlev    ,tsfc   , &amp;<a name='11097'>
             h2ovmr , o3vmr   ,co2vmr  ,ch4vmr  ,n2ovmr ,o2vmr , &amp;<a name='11098'>
             asdir   ,asdif   ,aldir   ,aldif   , &amp;<a name='11099'>
             coszen  ,adjes   ,dyofyr  ,scon    , &amp;<a name='11100'>
             inflgsw ,iceflgsw,liqflgsw,cldfmcl , &amp;<a name='11101'>
             taucmcl ,ssacmcl ,asmcmcl ,fsfcmcl , &amp;<a name='11102'>
             ciwpmcl ,clwpmcl ,cswpmcl, reicmcl ,relqmcl ,resnmcl, &amp;<a name='11103'>
             tauaer  ,ssaaer  ,asmaer  ,ecaer   , &amp;<a name='11104'>
             swuflx  ,swdflx  ,swhr    ,swuflxc ,swdflxc ,swhrc, aer_opt, &amp;<a name='11105'>
<font color=#447700>! -----      Zhenxin added for ssib coupiling 2011-06-20 --------!<a name='11106'></font>
             sibvisdir, sibvisdif, sibnirdir, sibnirdif,         &amp;<a name='11107'>
<font color=#447700>! --------------------   End of addiation by Zhenxin 2011-06-20 ------!<a name='11108'></font>
             swdkdir, swdkdif                      &amp;  <font color=#447700>! jararias, 2012/08/10<a name='11109'></font>
                                                   )<a name='11110'>
<a name='11111'>
<a name='11112'>
<font color=#447700>! Output net absorbed shortwave surface flux and shortwave cloud forcing<a name='11113'></font>
<font color=#447700>! at the top of atmosphere (W/m2)<a name='11114'></font>
         gsw(i,j) = swdflx(1,1) - swuflx(1,1)<a name='11115'>
         swcf(i,j) = (swdflx(1,kte+2) - swuflx(1,kte+2)) - (swdflxc(1,kte+2) - swuflxc(1,kte+2))<a name='11116'>
<a name='11117'>
         if (present(swupt)) then <a name='11118'>
<font color=#447700>! Output up and down toa fluxes for total and clear sky<a name='11119'></font>
            swupt(i,j)     = swuflx(1,kte+2)<a name='11120'>
            swuptc(i,j)    = swuflxc(1,kte+2)<a name='11121'>
            swdnt(i,j)     = swdflx(1,kte+2)<a name='11122'>
            swdntc(i,j)    = swdflxc(1,kte+2)<a name='11123'>
<font color=#447700>! Output up and down surface fluxes for total and clear sky<a name='11124'></font>
            swupb(i,j)     = swuflx(1,1)<a name='11125'>
            swupbc(i,j)    = swuflxc(1,1)<a name='11126'>
            swdnb(i,j)     = swdflx(1,1)<a name='11127'>
<font color=#447700>! Added by Zhenxin for 4 compenants of swdown radiation<a name='11128'></font>
            swvisdir(i,j)  = sibvisdir(1,1)<a name='11129'>
            swvisdif(i,j)  = sibvisdif(1,1)<a name='11130'>
            swnirdir(i,j)  = sibnirdir(1,1)<a name='11131'>
            swnirdif(i,j)  = sibnirdif(1,1)<a name='11132'>
<font color=#447700>!  Ended, Zhenxin (2011/06/20)<a name='11133'></font>
            swdnbc(i,j)    = swdflxc(1,1)<a name='11134'>
         endif<a name='11135'>
            swddir(i,j)    = swdkdir(1,1)          <font color=#447700>! jararias 2013/08/10<a name='11136'></font>
            swddni(i,j)    = swddir(i,j) / coszrs  <font color=#447700>! jararias 2013/08/10<a name='11137'></font>
            swddif(i,j)    = swdkdif(1,1)          <font color=#447700>! jararias 2013/08/10<a name='11138'></font>
<a name='11139'>
<font color=#447700>! Output up and down layer fluxes for total and clear sky.<a name='11140'></font>
<font color=#447700>! Vertical ordering is from bottom to top in units of W m-2. <a name='11141'></font>
         if ( present (swupflx) ) then<a name='11142'>
         do k=kts,kte+2<a name='11143'>
            swupflx(i,k,j)  = swuflx(1,k)<a name='11144'>
            swupflxc(i,k,j) = swuflxc(1,k)<a name='11145'>
            swdnflx(i,k,j)  = swdflx(1,k)<a name='11146'>
            swdnflxc(i,k,j) = swdflxc(1,k)<a name='11147'>
         enddo<a name='11148'>
         endif<a name='11149'>
<a name='11150'>
<font color=#447700>! Output heating rate tendency; convert heating rate from K/d to K/s<a name='11151'></font>
<font color=#447700>! Heating rate arrays are ordered vertically from bottom to top here. <a name='11152'></font>
         do k=kts,kte <a name='11153'>
            tten1d(k) = swhr(ncol,k)/86400.<a name='11154'>
            rthratensw(i,k,j) = tten1d(k)/pi3d(i,k,j)<a name='11155'>
         enddo<a name='11156'>
      else<a name='11157'>
         if (present(swupt)) then <a name='11158'>
<font color=#447700>! Output up and down toa fluxes for total and clear sky<a name='11159'></font>
            swupt(i,j)     = 0.<a name='11160'>
            swuptc(i,j)    = 0.<a name='11161'>
            swdnt(i,j)     = 0.<a name='11162'>
            swdntc(i,j)    = 0.<a name='11163'>
<font color=#447700>! Output up and down surface fluxes for total and clear sky<a name='11164'></font>
            swupb(i,j)     = 0.<a name='11165'>
            swupbc(i,j)    = 0.<a name='11166'>
            swdnb(i,j)     = 0.<a name='11167'>
            swdnbc(i,j)    = 0.<a name='11168'>
            swvisdir(i,j)  = 0.  <font color=#447700>! Add by Zhenxin (2011/06/20)<a name='11169'></font>
            swvisdif(i,j)  = 0.<a name='11170'>
            swnirdir(i,j)  = 0.<a name='11171'>
            swnirdif(i,j)  = 0.  <font color=#447700>! Add by Zhenxin (2011/06/20)<a name='11172'></font>
         endif<a name='11173'>
            swddir(i,j)    = 0.  <font color=#447700>! jararias 2013/08/10<a name='11174'></font>
            swddni(i,j)    = 0.  <font color=#447700>! jararias 2013/08/10<a name='11175'></font>
            swddif(i,j)    = 0.  <font color=#447700>! jararias 2013/08/10<a name='11176'></font>
            swcf(i,j)      = 0.<a name='11177'>
<a name='11178'>
      endif<a name='11179'>
<font color=#447700>!<a name='11180'></font>
      end do i_loop<a name='11181'>
   end do j_loop                                           <a name='11182'>
<a name='11183'>
<a name='11184'>
<font color=#447700>!-------------------------------------------------------------------<a name='11185'></font>
<a name='11186'>
   END SUBROUTINE RRTMG_SWRAD<a name='11187'>
<a name='11188'>
 <a name='11189'>
<font color=#447700>!====================================================================<a name='11190'></font>
<A NAME='RRTMG_SWINIT'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWINIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='11191'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>rrtmg_swinit</font>(                                         &amp; <A href='../../call_to/RRTMG_SWINIT.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SWINIT.html' TARGET='index'>2</A><a name='11192'>
                       allowed_to_read ,                            &amp;<a name='11193'>
                       ids, ide, jds, jde, kds, kde,                &amp;<a name='11194'>
                       ims, ime, jms, jme, kms, kme,                &amp;<a name='11195'>
                       its, ite, jts, jte, kts, kte                 )<a name='11196'>
<font color=#447700>!--------------------------------------------------------------------<a name='11197'></font>
   IMPLICIT NONE<a name='11198'>
<font color=#447700>!--------------------------------------------------------------------<a name='11199'></font>
<a name='11200'>
   LOGICAL , INTENT(IN)           :: allowed_to_read<a name='11201'>
   INTEGER , INTENT(IN)           :: ids, ide, jds, jde, kds, kde,  &amp;<a name='11202'>
                                     ims, ime, jms, jme, kms, kme,  &amp;<a name='11203'>
                                     its, ite, jts, jte, kts, kte<a name='11204'>
<a name='11205'>
<font color=#447700>! Read in absorption coefficients and other data<a name='11206'></font>
   IF ( allowed_to_read ) THEN<a name='11207'>
     CALL <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE'>rrtmg_swlookuptable</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SWLOOKUPTABLE_1"><a name='11208'>
   ENDIF<a name='11209'>
<a name='11210'>
<font color=#447700>! Perform g-point reduction and other initializations<a name='11211'></font>
<font color=#447700>! Specific heat of dry air (cp) used in flux to heating rate conversion factor.<a name='11212'></font>
   call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI'>rrtmg_sw_ini</A><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_INI_1">(cp)<a name='11213'>
<a name='11214'>
   END SUBROUTINE rrtmg_swinit<a name='11215'>
<a name='11216'>
<a name='11217'>
<font color=#447700>! **************************************************************************     <a name='11218'></font>
<A NAME='RRTMG_SWLOOKUPTABLE'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRTMG_SWLOOKUPTABLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='11219'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>rrtmg_swlookuptable</font> <A href='../../call_to/RRTMG_SWLOOKUPTABLE.html' TARGET='index'>2</A>,<A href='../../call_from/RRTMG_SWLOOKUPTABLE.html' TARGET='index'>34</A><a name='11220'>
<font color=#447700>! **************************************************************************     <a name='11221'></font>
<a name='11222'>
IMPLICIT NONE<a name='11223'>
<a name='11224'>
<font color=#447700>! Local                                    <a name='11225'></font>
      INTEGER :: i<a name='11226'>
      LOGICAL                 :: opened<a name='11227'>
      LOGICAL , EXTERNAL      :: wrf_dm_on_monitor<a name='11228'>
<a name='11229'>
      CHARACTER*80 errmess<a name='11230'>
      INTEGER rrtmg_unit<a name='11231'>
<a name='11232'>
      IF ( wrf_dm_on_monitor() ) THEN<a name='11233'>
        DO i = 10,99<a name='11234'>
          INQUIRE ( i , OPENED = opened )<a name='11235'>
          IF ( .NOT. opened ) THEN<a name='11236'>
            rrtmg_unit = i<a name='11237'>
            GOTO 2010<a name='11238'>
          ENDIF<a name='11239'>
        ENDDO<a name='11240'>
        rrtmg_unit = -1<a name='11241'>
 2010   CONTINUE<a name='11242'>
      ENDIF<a name='11243'>
      CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_352"> ( rrtmg_unit , IWORDSIZE )<a name='11244'>
      IF ( rrtmg_unit &lt; 0 ) THEN<a name='11245'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1085"> ( 'module_ra_rrtmg_sw: rrtm_swlookuptable: Can not '// &amp;<a name='11246'>
                               'find unused fortran unit to read in lookup table.' )<a name='11247'>
      ENDIF<a name='11248'>
<a name='11249'>
      IF ( wrf_dm_on_monitor() ) THEN<a name='11250'>
        OPEN(rrtmg_unit,FILE='RRTMG_SW_DATA',                  &amp;<a name='11251'>
             FORM='UNFORMATTED',STATUS='OLD',ERR=9009)<a name='11252'>
      ENDIF<a name='11253'>
<a name='11254'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16'>sw_kgb16</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB16_1">(rrtmg_unit)<a name='11255'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17'>sw_kgb17</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB17_1">(rrtmg_unit)<a name='11256'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18'>sw_kgb18</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB18_1">(rrtmg_unit)<a name='11257'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19'>sw_kgb19</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB19_1">(rrtmg_unit)<a name='11258'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20'>sw_kgb20</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB20_1">(rrtmg_unit)<a name='11259'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21'>sw_kgb21</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB21_1">(rrtmg_unit)<a name='11260'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22'>sw_kgb22</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB22_1">(rrtmg_unit)<a name='11261'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23'>sw_kgb23</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB23_1">(rrtmg_unit)<a name='11262'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24'>sw_kgb24</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB24_1">(rrtmg_unit)<a name='11263'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB25'>sw_kgb25</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB25_1">(rrtmg_unit)<a name='11264'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB26'>sw_kgb26</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB26_1">(rrtmg_unit)<a name='11265'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27'>sw_kgb27</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB27_1">(rrtmg_unit)<a name='11266'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28'>sw_kgb28</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB28_1">(rrtmg_unit)<a name='11267'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29'>sw_kgb29</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB29_1">(rrtmg_unit)<a name='11268'>
<a name='11269'>
     IF ( wrf_dm_on_monitor() ) CLOSE (rrtmg_unit)<a name='11270'>
<a name='11271'>
     RETURN<a name='11272'>
9009 CONTINUE<a name='11273'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error opening RRTMG_SW_DATA on unit ',rrtmg_unit<a name='11274'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1086">(errmess)<a name='11275'>
<a name='11276'>
     END SUBROUTINE rrtmg_swlookuptable<a name='11277'>
<a name='11278'>
<font color=#447700>! **************************************************************************<a name='11279'></font>
<font color=#447700>!  RRTMG Shortwave Radiative Transfer Model<a name='11280'></font>
<font color=#447700>!  Atmospheric and Environmental Research, Inc., Cambridge, MA<a name='11281'></font>
<font color=#447700>!<a name='11282'></font>
<font color=#447700>!  Original by J.Delamere, Atmospheric &amp; Environmental Research.<a name='11283'></font>
<font color=#447700>!  Reformatted for F90: JJMorcrette, ECMWF<a name='11284'></font>
<font color=#447700>!  Revision for GCMs:  Michael J. Iacono, AER, July 2002<a name='11285'></font>
<font color=#447700>!  Further F90 reformatting:  Michael J. Iacono, AER, June 2006<a name='11286'></font>
<font color=#447700>!<a name='11287'></font>
<font color=#447700>!  This file contains 14 READ statements that include the <a name='11288'></font>
<font color=#447700>!  absorption coefficients and other data for each of the 14 shortwave<a name='11289'></font>
<font color=#447700>!  spectral bands used in RRTMG_SW.  Here, the data are defined for 16<a name='11290'></font>
<font color=#447700>!  g-points, or sub-intervals, per band.  These data are combined and<a name='11291'></font>
<font color=#447700>!  weighted using a mapping procedure in module RRTMG_SW_INIT to reduce<a name='11292'></font>
<font color=#447700>!  the total number of g-points from 224 to 112 for use in the GCM.<a name='11293'></font>
<font color=#447700>! **************************************************************************<a name='11294'></font>
<a name='11295'>
<font color=#447700>! **************************************************************************<a name='11296'></font>
<A NAME='SW_KGB16'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB16' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='11297'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb16</font>(rrtmg_unit) <A href='../../call_to/SW_KGB16.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB16.html' TARGET='index'>10</A><a name='11298'>
<font color=#447700>! **************************************************************************<a name='11299'></font>
<a name='11300'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG16'>rrsw_kg16</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG16_3">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='11301'>
                            rayl, strrat1, layreffr<a name='11302'>
<a name='11303'>
      implicit none<a name='11304'>
      save<a name='11305'>
<a name='11306'>
<font color=#447700>! Input<a name='11307'></font>
      integer, intent(in) :: rrtmg_unit<a name='11308'>
<a name='11309'>
<font color=#447700>! Local                                    <a name='11310'></font>
      character*80 errmess<a name='11311'>
      logical, external  :: wrf_dm_on_monitor<a name='11312'>
<a name='11313'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='11314'></font>
<a name='11315'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 2925 cm-1.<a name='11316'></font>
<a name='11317'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='11318'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='11319'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='11320'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='11321'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='11322'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='11323'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='11324'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='11325'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='11326'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='11327'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='11328'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='11329'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='11330'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='11331'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='11332'></font>
<a name='11333'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='11334'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='11335'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='11336'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='11337'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='11338'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='11339'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='11340'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='11341'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='11342'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='11343'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='11344'></font>
<a name='11345'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='11346'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='11347'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='11348'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='11349'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='11350'></font>
<a name='11351'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='11352'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='11353'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='11354'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='11355'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='11356'></font>
<a name='11357'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_353"> ( A , size ( A ) * RWORDSIZE )<a name='11358'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_28"> ( A , 1 )<a name='11359'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_11"> ( A , 1 )<a name='11360'>
<a name='11361'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='11362'>
         rayl, strrat1, layreffr, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='11363'>
      DM_BCAST_REAL(rayl)<a name='11364'>
      DM_BCAST_REAL(strrat1)<a name='11365'>
      DM_BCAST_INTEGER(layreffr)<a name='11366'>
      DM_BCAST_MACRO(kao)<a name='11367'>
      DM_BCAST_MACRO(kbo)<a name='11368'>
      DM_BCAST_MACRO(selfrefo)<a name='11369'>
      DM_BCAST_MACRO(forrefo)<a name='11370'>
      DM_BCAST_MACRO(sfluxrefo)<a name='11371'>
<a name='11372'>
     RETURN<a name='11373'>
9010 CONTINUE<a name='11374'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='11375'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1087">(errmess)<a name='11376'>
<a name='11377'>
      end subroutine sw_kgb16<a name='11378'>
<a name='11379'>
<font color=#447700>! **************************************************************************<a name='11380'></font>
<A NAME='SW_KGB17'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB17' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='11381'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb17</font>(rrtmg_unit) <A href='../../call_to/SW_KGB17.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB17.html' TARGET='index'>10</A><a name='11382'>
<font color=#447700>! **************************************************************************<a name='11383'></font>
<a name='11384'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG17'>rrsw_kg17</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG17_3">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='11385'>
                            rayl, strrat, layreffr<a name='11386'>
<a name='11387'>
      implicit none<a name='11388'>
      save<a name='11389'>
<a name='11390'>
<font color=#447700>! Input<a name='11391'></font>
      integer, intent(in) :: rrtmg_unit<a name='11392'>
<a name='11393'>
<font color=#447700>! Local                                    <a name='11394'></font>
      character*80 errmess<a name='11395'>
      logical, external  :: wrf_dm_on_monitor<a name='11396'>
<a name='11397'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='11398'></font>
<a name='11399'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 3625 cm-1.<a name='11400'></font>
<a name='11401'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='11402'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='11403'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='11404'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='11405'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='11406'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='11407'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='11408'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='11409'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='11410'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='11411'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='11412'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='11413'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='11414'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='11415'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='11416'></font>
<a name='11417'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='11418'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='11419'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='11420'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='11421'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='11422'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='11423'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='11424'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='11425'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='11426'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='11427'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='11428'></font>
<a name='11429'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='11430'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='11431'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='11432'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='11433'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='11434'></font>
<a name='11435'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='11436'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='11437'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='11438'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='11439'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='11440'></font>
<a name='11441'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_354"> ( A , size ( A ) * RWORDSIZE )<a name='11442'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_29"> ( A , 1 )<a name='11443'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_12"> ( A , 1 )<a name='11444'>
<a name='11445'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='11446'>
         rayl, strrat, layreffr, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='11447'>
      DM_BCAST_REAL(rayl)<a name='11448'>
      DM_BCAST_REAL(strrat)<a name='11449'>
      DM_BCAST_INTEGER(layreffr)<a name='11450'>
      DM_BCAST_MACRO(kao)<a name='11451'>
      DM_BCAST_MACRO(kbo)<a name='11452'>
      DM_BCAST_MACRO(selfrefo)<a name='11453'>
      DM_BCAST_MACRO(forrefo)<a name='11454'>
      DM_BCAST_MACRO(sfluxrefo)<a name='11455'>
<a name='11456'>
     RETURN<a name='11457'>
9010 CONTINUE<a name='11458'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='11459'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1088">(errmess)<a name='11460'>
<a name='11461'>
      end subroutine sw_kgb17<a name='11462'>
<a name='11463'>
<font color=#447700>! **************************************************************************<a name='11464'></font>
<A NAME='SW_KGB18'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB18' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='11465'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb18</font>(rrtmg_unit) <A href='../../call_to/SW_KGB18.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB18.html' TARGET='index'>10</A><a name='11466'>
<font color=#447700>! **************************************************************************<a name='11467'></font>
<a name='11468'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG18'>rrsw_kg18</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG18_3">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='11469'>
                            rayl, strrat, layreffr<a name='11470'>
<a name='11471'>
      implicit none<a name='11472'>
      save<a name='11473'>
<a name='11474'>
<font color=#447700>! Input<a name='11475'></font>
      integer, intent(in) :: rrtmg_unit<a name='11476'>
<a name='11477'>
<font color=#447700>! Local                                    <a name='11478'></font>
      character*80 errmess<a name='11479'>
      logical, external  :: wrf_dm_on_monitor<a name='11480'>
<a name='11481'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='11482'></font>
<a name='11483'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 4325 cm-1.<a name='11484'></font>
<a name='11485'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='11486'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='11487'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='11488'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='11489'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='11490'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='11491'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='11492'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='11493'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='11494'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='11495'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='11496'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='11497'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='11498'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='11499'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='11500'></font>
<a name='11501'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='11502'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='11503'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='11504'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='11505'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='11506'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='11507'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='11508'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='11509'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='11510'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='11511'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='11512'></font>
<a name='11513'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='11514'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='11515'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='11516'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='11517'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='11518'></font>
<a name='11519'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='11520'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='11521'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='11522'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='11523'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='11524'></font>
<a name='11525'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_355"> ( A , size ( A ) * RWORDSIZE )<a name='11526'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_30"> ( A , 1 )<a name='11527'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_13"> ( A , 1 )<a name='11528'>
<a name='11529'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='11530'>
         rayl, strrat, layreffr, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='11531'>
      DM_BCAST_REAL(rayl)<a name='11532'>
      DM_BCAST_REAL(strrat)<a name='11533'>
      DM_BCAST_INTEGER(layreffr)<a name='11534'>
      DM_BCAST_MACRO(kao)<a name='11535'>
      DM_BCAST_MACRO(kbo)<a name='11536'>
      DM_BCAST_MACRO(selfrefo)<a name='11537'>
      DM_BCAST_MACRO(forrefo)<a name='11538'>
      DM_BCAST_MACRO(sfluxrefo)<a name='11539'>
<a name='11540'>
     RETURN<a name='11541'>
9010 CONTINUE<a name='11542'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='11543'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1089">(errmess)<a name='11544'>
<a name='11545'>
      end subroutine sw_kgb18 <a name='11546'>
<a name='11547'>
<font color=#447700>! **************************************************************************<a name='11548'></font>
<A NAME='SW_KGB19'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB19' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='11549'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb19</font>(rrtmg_unit) <A href='../../call_to/SW_KGB19.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB19.html' TARGET='index'>10</A><a name='11550'>
<font color=#447700>! **************************************************************************<a name='11551'></font>
<a name='11552'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG19'>rrsw_kg19</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG19_3">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='11553'>
                            rayl, strrat, layreffr<a name='11554'>
<a name='11555'>
      implicit none<a name='11556'>
      save<a name='11557'>
<a name='11558'>
<font color=#447700>! Input<a name='11559'></font>
      integer, intent(in) :: rrtmg_unit<a name='11560'>
<a name='11561'>
<font color=#447700>! Local                                    <a name='11562'></font>
      character*80 errmess<a name='11563'>
      logical, external  :: wrf_dm_on_monitor<a name='11564'>
<a name='11565'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='11566'></font>
<a name='11567'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 4900 cm-1.<a name='11568'></font>
<a name='11569'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='11570'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='11571'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='11572'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='11573'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='11574'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='11575'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='11576'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='11577'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='11578'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='11579'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='11580'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='11581'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='11582'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='11583'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='11584'></font>
<a name='11585'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='11586'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='11587'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='11588'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='11589'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='11590'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='11591'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='11592'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='11593'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='11594'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='11595'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='11596'></font>
<a name='11597'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='11598'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='11599'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='11600'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='11601'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='11602'></font>
<a name='11603'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='11604'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='11605'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='11606'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='11607'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='11608'></font>
<a name='11609'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_356"> ( A , size ( A ) * RWORDSIZE )<a name='11610'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_31"> ( A , 1 )<a name='11611'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_14"> ( A , 1 )<a name='11612'>
<a name='11613'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='11614'>
         rayl, strrat, layreffr, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='11615'>
      DM_BCAST_REAL(rayl)<a name='11616'>
      DM_BCAST_REAL(strrat)<a name='11617'>
      DM_BCAST_INTEGER(layreffr)<a name='11618'>
      DM_BCAST_MACRO(kao)<a name='11619'>
      DM_BCAST_MACRO(kbo)<a name='11620'>
      DM_BCAST_MACRO(selfrefo)<a name='11621'>
      DM_BCAST_MACRO(forrefo)<a name='11622'>
      DM_BCAST_MACRO(sfluxrefo)<a name='11623'>
<a name='11624'>
     RETURN<a name='11625'>
9010 CONTINUE<a name='11626'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='11627'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1090">(errmess)<a name='11628'>
<a name='11629'>
      end subroutine sw_kgb19<a name='11630'>
<a name='11631'>
<font color=#447700>! **************************************************************************<a name='11632'></font>
<A NAME='SW_KGB20'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB20' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='11633'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb20</font>(rrtmg_unit) <A href='../../call_to/SW_KGB20.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB20.html' TARGET='index'>10</A><a name='11634'>
<font color=#447700>! **************************************************************************<a name='11635'></font>
<a name='11636'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG20'>rrsw_kg20</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG20_3">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='11637'>
                            absch4o, rayl, layreffr<a name='11638'>
<a name='11639'>
      implicit none<a name='11640'>
      save<a name='11641'>
<a name='11642'>
<font color=#447700>! Input<a name='11643'></font>
      integer, intent(in) :: rrtmg_unit<a name='11644'>
<a name='11645'>
<font color=#447700>! Local                                    <a name='11646'></font>
      character*80 errmess<a name='11647'>
      logical, external  :: wrf_dm_on_monitor<a name='11648'>
<a name='11649'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='11650'></font>
<a name='11651'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 5670 cm-1.<a name='11652'></font>
<a name='11653'>
<font color=#447700>!     Array absch4o contains the absorption coefficients for methane.<a name='11654'></font>
<a name='11655'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='11656'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='11657'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='11658'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='11659'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='11660'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='11661'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='11662'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='11663'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='11664'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='11665'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='11666'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='11667'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='11668'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='11669'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='11670'></font>
<a name='11671'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='11672'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='11673'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='11674'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='11675'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='11676'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='11677'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='11678'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='11679'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='11680'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='11681'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='11682'></font>
<a name='11683'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='11684'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='11685'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='11686'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='11687'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='11688'></font>
<a name='11689'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='11690'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='11691'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='11692'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='11693'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='11694'></font>
<a name='11695'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_357"> ( A , size ( A ) * RWORDSIZE )<a name='11696'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_32"> ( A , 1 )<a name='11697'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_15"> ( A , 1 )<a name='11698'>
<a name='11699'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='11700'>
         rayl, layreffr, absch4o, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='11701'>
      DM_BCAST_REAL(rayl)<a name='11702'>
      DM_BCAST_INTEGER(layreffr)<a name='11703'>
      DM_BCAST_MACRO(absch4o)<a name='11704'>
      DM_BCAST_MACRO(kao)<a name='11705'>
      DM_BCAST_MACRO(kbo)<a name='11706'>
      DM_BCAST_MACRO(selfrefo)<a name='11707'>
      DM_BCAST_MACRO(forrefo)<a name='11708'>
      DM_BCAST_MACRO(sfluxrefo)<a name='11709'>
<a name='11710'>
     RETURN<a name='11711'>
9010 CONTINUE<a name='11712'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='11713'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1091">(errmess)<a name='11714'>
<a name='11715'>
      end subroutine sw_kgb20<a name='11716'>
<a name='11717'>
<font color=#447700>! **************************************************************************<a name='11718'></font>
<A NAME='SW_KGB21'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB21' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='11719'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb21</font>(rrtmg_unit) <A href='../../call_to/SW_KGB21.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB21.html' TARGET='index'>10</A><a name='11720'>
<font color=#447700>! **************************************************************************<a name='11721'></font>
<a name='11722'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG21'>rrsw_kg21</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG21_3">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='11723'>
                            rayl, strrat, layreffr<a name='11724'>
<a name='11725'>
      implicit none<a name='11726'>
      save<a name='11727'>
<a name='11728'>
<font color=#447700>! Input<a name='11729'></font>
      integer, intent(in) :: rrtmg_unit<a name='11730'>
<a name='11731'>
<font color=#447700>! Local                                    <a name='11732'></font>
      character*80 errmess<a name='11733'>
      logical, external  :: wrf_dm_on_monitor<a name='11734'>
<a name='11735'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='11736'></font>
<a name='11737'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 6925 cm-1.<a name='11738'></font>
<a name='11739'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='11740'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='11741'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='11742'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='11743'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='11744'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='11745'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='11746'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='11747'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='11748'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='11749'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='11750'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='11751'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='11752'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='11753'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='11754'></font>
<a name='11755'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='11756'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='11757'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='11758'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='11759'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='11760'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='11761'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='11762'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='11763'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='11764'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='11765'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='11766'></font>
<a name='11767'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='11768'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='11769'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='11770'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='11771'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='11772'></font>
<a name='11773'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='11774'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='11775'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='11776'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='11777'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='11778'></font>
<a name='11779'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_358"> ( A , size ( A ) * RWORDSIZE )<a name='11780'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_33"> ( A , 1 )<a name='11781'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_16"> ( A , 1 )<a name='11782'>
<a name='11783'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='11784'>
         rayl, strrat, layreffr, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='11785'>
      DM_BCAST_REAL(rayl)<a name='11786'>
      DM_BCAST_REAL(strrat)<a name='11787'>
      DM_BCAST_INTEGER(layreffr)<a name='11788'>
      DM_BCAST_MACRO(kao)<a name='11789'>
      DM_BCAST_MACRO(kbo)<a name='11790'>
      DM_BCAST_MACRO(selfrefo)<a name='11791'>
      DM_BCAST_MACRO(forrefo)<a name='11792'>
      DM_BCAST_MACRO(sfluxrefo)<a name='11793'>
<a name='11794'>
     RETURN<a name='11795'>
9010 CONTINUE<a name='11796'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='11797'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1092">(errmess)<a name='11798'>
<a name='11799'>
      end subroutine sw_kgb21<a name='11800'>
<a name='11801'>
<font color=#447700>! **************************************************************************<a name='11802'></font>
<A NAME='SW_KGB22'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB22' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='11803'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb22</font>(rrtmg_unit) <A href='../../call_to/SW_KGB22.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB22.html' TARGET='index'>10</A><a name='11804'>
<font color=#447700>! **************************************************************************<a name='11805'></font>
<a name='11806'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG22'>rrsw_kg22</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG22_3">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='11807'>
                            rayl, strrat, layreffr<a name='11808'>
<a name='11809'>
      implicit none<a name='11810'>
      save<a name='11811'>
<a name='11812'>
<font color=#447700>! Input<a name='11813'></font>
      integer, intent(in) :: rrtmg_unit<a name='11814'>
<a name='11815'>
<font color=#447700>! Local                                    <a name='11816'></font>
      character*80 errmess<a name='11817'>
      logical, external  :: wrf_dm_on_monitor<a name='11818'>
<a name='11819'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='11820'></font>
<a name='11821'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 8000 cm-1.<a name='11822'></font>
<a name='11823'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='11824'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='11825'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='11826'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='11827'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='11828'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='11829'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='11830'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='11831'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='11832'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='11833'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='11834'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='11835'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='11836'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='11837'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='11838'></font>
<a name='11839'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='11840'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='11841'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='11842'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='11843'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='11844'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='11845'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='11846'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='11847'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='11848'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='11849'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='11850'></font>
<a name='11851'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='11852'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='11853'></font>
<font color=#447700>!     index refers to reference temperature (296_rb,260_rb,224,260) and <a name='11854'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='11855'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='11856'></font>
<a name='11857'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='11858'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='11859'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='11860'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='11861'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='11862'></font>
<a name='11863'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_359"> ( A , size ( A ) * RWORDSIZE )<a name='11864'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_34"> ( A , 1 )<a name='11865'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_17"> ( A , 1 )<a name='11866'>
<a name='11867'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='11868'>
         rayl, strrat, layreffr, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='11869'>
      DM_BCAST_REAL(rayl)<a name='11870'>
      DM_BCAST_REAL(strrat)<a name='11871'>
      DM_BCAST_INTEGER(layreffr)<a name='11872'>
      DM_BCAST_MACRO(kao)<a name='11873'>
      DM_BCAST_MACRO(kbo)<a name='11874'>
      DM_BCAST_MACRO(selfrefo)<a name='11875'>
      DM_BCAST_MACRO(forrefo)<a name='11876'>
      DM_BCAST_MACRO(sfluxrefo)<a name='11877'>
<a name='11878'>
     RETURN<a name='11879'>
9010 CONTINUE<a name='11880'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='11881'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1093">(errmess)<a name='11882'>
<a name='11883'>
      end subroutine sw_kgb22<a name='11884'>
<a name='11885'>
<font color=#447700>! **************************************************************************<a name='11886'></font>
<A NAME='SW_KGB23'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB23' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='11887'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb23</font>(rrtmg_unit) <A href='../../call_to/SW_KGB23.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB23.html' TARGET='index'>10</A><a name='11888'>
<font color=#447700>! **************************************************************************<a name='11889'></font>
<a name='11890'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG23'>rrsw_kg23</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG23_3">, only : kao, selfrefo, forrefo, sfluxrefo, &amp;<a name='11891'>
                            raylo, givfac, layreffr<a name='11892'>
<a name='11893'>
      implicit none<a name='11894'>
      save<a name='11895'>
<a name='11896'>
<font color=#447700>! Input<a name='11897'></font>
      integer, intent(in) :: rrtmg_unit<a name='11898'>
<a name='11899'>
<font color=#447700>! Local                                    <a name='11900'></font>
      character*80 errmess<a name='11901'>
      logical, external  :: wrf_dm_on_monitor<a name='11902'>
<a name='11903'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='11904'></font>
<a name='11905'>
<font color=#447700>!     Array raylo contains the Rayleigh extinction coefficient at all v for this band<a name='11906'></font>
<a name='11907'>
<font color=#447700>!     Array givfac is the average Giver et al. correction factor for this band. <a name='11908'></font>
<a name='11909'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='11910'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='11911'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='11912'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='11913'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='11914'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='11915'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='11916'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='11917'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='11918'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='11919'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='11920'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='11921'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='11922'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='11923'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='11924'></font>
<a name='11925'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='11926'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='11927'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='11928'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='11929'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='11930'></font>
<a name='11931'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='11932'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='11933'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='11934'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='11935'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='11936'></font>
<a name='11937'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_360"> ( A , size ( A ) * RWORDSIZE )<a name='11938'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_35"> ( A , 1 )<a name='11939'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_18"> ( A , 1 )<a name='11940'>
<a name='11941'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='11942'>
         raylo, givfac, layreffr, kao, selfrefo, forrefo, sfluxrefo<a name='11943'>
      DM_BCAST_MACRO(raylo)<a name='11944'>
      DM_BCAST_REAL(givfac)<a name='11945'>
      DM_BCAST_INTEGER(layreffr)<a name='11946'>
      DM_BCAST_MACRO(kao)<a name='11947'>
      DM_BCAST_MACRO(selfrefo)<a name='11948'>
      DM_BCAST_MACRO(forrefo)<a name='11949'>
      DM_BCAST_MACRO(sfluxrefo)<a name='11950'>
<a name='11951'>
     RETURN<a name='11952'>
9010 CONTINUE<a name='11953'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='11954'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1094">(errmess)<a name='11955'>
<a name='11956'>
      end subroutine sw_kgb23<a name='11957'>
<a name='11958'>
<font color=#447700>! **************************************************************************<a name='11959'></font>
<A NAME='SW_KGB24'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB24' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='11960'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb24</font>(rrtmg_unit) <A href='../../call_to/SW_KGB24.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB24.html' TARGET='index'>10</A><a name='11961'>
<font color=#447700>! **************************************************************************<a name='11962'></font>
<a name='11963'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG24'>rrsw_kg24</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG24_3">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='11964'>
                            raylao, raylbo, abso3ao, abso3bo, strrat, layreffr<a name='11965'>
<a name='11966'>
      implicit none<a name='11967'>
      save<a name='11968'>
<a name='11969'>
<font color=#447700>! Input<a name='11970'></font>
      integer, intent(in) :: rrtmg_unit<a name='11971'>
<a name='11972'>
<font color=#447700>! Local                                    <a name='11973'></font>
      character*80 errmess<a name='11974'>
      logical, external  :: wrf_dm_on_monitor<a name='11975'>
<a name='11976'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='11977'></font>
<a name='11978'>
<font color=#447700>!     Arrays raylao and raylbo contain the Rayleigh extinction coefficient at <a name='11979'></font>
<font color=#447700>!     all v for this band for the upper and lower atmosphere.<a name='11980'></font>
<a name='11981'>
<font color=#447700>!     Arrays abso3ao and abso3bo contain the ozone absorption coefficient at <a name='11982'></font>
<font color=#447700>!     all v for this band for the upper and lower atmosphere.<a name='11983'></font>
<a name='11984'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='11985'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='11986'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='11987'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='11988'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='11989'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='11990'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='11991'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='11992'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='11993'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='11994'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='11995'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='11996'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='11997'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='11998'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='11999'></font>
<a name='12000'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='12001'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='12002'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='12003'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='12004'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='12005'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='12006'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='12007'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='12008'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='12009'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='12010'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='12011'></font>
<a name='12012'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='12013'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='12014'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='12015'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='12016'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='12017'></font>
<a name='12018'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='12019'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='12020'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='12021'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='12022'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='12023'></font>
<a name='12024'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_361"> ( A , size ( A ) * RWORDSIZE )<a name='12025'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_36"> ( A , 1 )<a name='12026'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_19"> ( A , 1 )<a name='12027'>
<a name='12028'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='12029'>
         raylao, raylbo, strrat, layreffr, abso3ao, abso3bo, kao, kbo, selfrefo, &amp;<a name='12030'>
         forrefo, sfluxrefo<a name='12031'>
      DM_BCAST_MACRO(raylao)<a name='12032'>
      DM_BCAST_MACRO(raylbo)<a name='12033'>
      DM_BCAST_REAL(strrat)<a name='12034'>
      DM_BCAST_INTEGER(layreffr)<a name='12035'>
      DM_BCAST_MACRO(abso3ao)<a name='12036'>
      DM_BCAST_MACRO(abso3bo)<a name='12037'>
      DM_BCAST_MACRO(kao)<a name='12038'>
      DM_BCAST_MACRO(kbo)<a name='12039'>
      DM_BCAST_MACRO(selfrefo)<a name='12040'>
      DM_BCAST_MACRO(forrefo)<a name='12041'>
      DM_BCAST_MACRO(sfluxrefo)<a name='12042'>
<a name='12043'>
     RETURN<a name='12044'>
9010 CONTINUE<a name='12045'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='12046'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1095">(errmess)<a name='12047'>
<a name='12048'>
      end subroutine sw_kgb24<a name='12049'>
<a name='12050'>
<font color=#447700>! **************************************************************************<a name='12051'></font>
<A NAME='SW_KGB25'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB25' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12052'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb25</font>(rrtmg_unit) <A href='../../call_to/SW_KGB25.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB25.html' TARGET='index'>8</A><a name='12053'>
<font color=#447700>! **************************************************************************<a name='12054'></font>
<a name='12055'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG25'>rrsw_kg25</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG25_3">, only : kao, sfluxrefo, &amp;<a name='12056'>
                            raylo, abso3ao, abso3bo, layreffr<a name='12057'>
<a name='12058'>
      implicit none<a name='12059'>
      save<a name='12060'>
<a name='12061'>
<font color=#447700>! Input<a name='12062'></font>
      integer, intent(in) :: rrtmg_unit<a name='12063'>
<a name='12064'>
<font color=#447700>! Local                                    <a name='12065'></font>
      character*80 errmess<a name='12066'>
      logical, external  :: wrf_dm_on_monitor<a name='12067'>
<a name='12068'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='12069'></font>
<a name='12070'>
<font color=#447700>!     Array raylo contains the Rayleigh extinction coefficient at all v = 2925 cm-1.<a name='12071'></font>
<a name='12072'>
<font color=#447700>!     Arrays abso3ao and abso3bo contain the ozone absorption coefficient at <a name='12073'></font>
<font color=#447700>!     all v for this band for the upper and lower atmosphere.<a name='12074'></font>
<a name='12075'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='12076'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='12077'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='12078'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='12079'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='12080'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='12081'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='12082'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='12083'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='12084'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='12085'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='12086'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='12087'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='12088'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='12089'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='12090'></font>
<a name='12091'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_362"> ( A , size ( A ) * RWORDSIZE )<a name='12092'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_20"> ( A , 1 )<a name='12093'>
<a name='12094'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='12095'>
         raylo, layreffr, abso3ao, abso3bo, kao, sfluxrefo<a name='12096'>
      DM_BCAST_MACRO(raylo)<a name='12097'>
      DM_BCAST_INTEGER(layreffr)<a name='12098'>
      DM_BCAST_MACRO(abso3ao)<a name='12099'>
      DM_BCAST_MACRO(abso3bo)<a name='12100'>
      DM_BCAST_MACRO(kao)<a name='12101'>
      DM_BCAST_MACRO(sfluxrefo)<a name='12102'>
<a name='12103'>
     RETURN<a name='12104'>
9010 CONTINUE<a name='12105'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='12106'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1096">(errmess)<a name='12107'>
<a name='12108'>
      end subroutine sw_kgb25<a name='12109'>
<a name='12110'>
<font color=#447700>! **************************************************************************<a name='12111'></font>
<A NAME='SW_KGB26'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB26' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12112'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb26</font>(rrtmg_unit) <A href='../../call_to/SW_KGB26.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB26.html' TARGET='index'>6</A><a name='12113'>
<font color=#447700>! **************************************************************************<a name='12114'></font>
<a name='12115'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG26'>rrsw_kg26</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG26_3">, only : sfluxrefo, raylo<a name='12116'>
<a name='12117'>
      implicit none<a name='12118'>
      save<a name='12119'>
<a name='12120'>
<font color=#447700>! Input<a name='12121'></font>
      integer, intent(in) :: rrtmg_unit<a name='12122'>
<a name='12123'>
<font color=#447700>! Local                                    <a name='12124'></font>
      character*80 errmess<a name='12125'>
      logical, external  :: wrf_dm_on_monitor<a name='12126'>
<a name='12127'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='12128'></font>
<a name='12129'>
<font color=#447700>!     Array raylo contains the Rayleigh extinction coefficient at all v for this band.<a name='12130'></font>
<a name='12131'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_363"> ( A , size ( A ) * RWORDSIZE )<a name='12132'>
<a name='12133'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='12134'>
         raylo, sfluxrefo<a name='12135'>
      DM_BCAST_MACRO(raylo)<a name='12136'>
      DM_BCAST_MACRO(sfluxrefo)<a name='12137'>
<a name='12138'>
     RETURN<a name='12139'>
9010 CONTINUE<a name='12140'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='12141'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1097">(errmess)<a name='12142'>
<a name='12143'>
      end subroutine sw_kgb26<a name='12144'>
<a name='12145'>
<font color=#447700>! **************************************************************************<a name='12146'></font>
<A NAME='SW_KGB27'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB27' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12147'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb27</font>(rrtmg_unit) <A href='../../call_to/SW_KGB27.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB27.html' TARGET='index'>10</A><a name='12148'>
<font color=#447700>! **************************************************************************<a name='12149'></font>
<a name='12150'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG27'>rrsw_kg27</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG27_3">, only : kao, kbo, sfluxrefo, raylo, &amp;<a name='12151'>
                            scalekur, layreffr<a name='12152'>
<a name='12153'>
      implicit none<a name='12154'>
      save<a name='12155'>
<a name='12156'>
<font color=#447700>! Input<a name='12157'></font>
      integer, intent(in) :: rrtmg_unit<a name='12158'>
<a name='12159'>
<font color=#447700>! Local                                    <a name='12160'></font>
      character*80 errmess<a name='12161'>
      logical, external  :: wrf_dm_on_monitor<a name='12162'>
<a name='12163'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='12164'></font>
<font color=#447700>!     The values in array sfluxrefo were obtained using the "low resolution"<a name='12165'></font>
<font color=#447700>!     version of the Kurucz solar source function.  For unknown reasons,<a name='12166'></font>
<font color=#447700>!     the total irradiance in this band differs from the corresponding<a name='12167'></font>
<font color=#447700>!     total in the "high-resolution" version of the Kurucz function.<a name='12168'></font>
<font color=#447700>!     Therefore, these values are scaled by the factor SCALEKUR.<a name='12169'></font>
<a name='12170'>
<font color=#447700>!     Array raylo contains the Rayleigh extinction coefficient at all v = 2925 cm-1.<a name='12171'></font>
<a name='12172'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='12173'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='12174'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='12175'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='12176'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='12177'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='12178'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='12179'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='12180'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='12181'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='12182'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='12183'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='12184'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='12185'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='12186'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='12187'></font>
<a name='12188'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='12189'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='12190'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='12191'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='12192'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='12193'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='12194'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='12195'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='12196'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='12197'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='12198'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='12199'></font>
<a name='12200'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_364"> ( A , size ( A ) * RWORDSIZE )<a name='12201'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_37"> ( A , 1 )<a name='12202'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_21"> ( A , 1 )<a name='12203'>
<a name='12204'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='12205'>
         raylo, scalekur, layreffr, kao, kbo, sfluxrefo<a name='12206'>
      DM_BCAST_MACRO(raylo)<a name='12207'>
      DM_BCAST_REAL(scalekur)<a name='12208'>
      DM_BCAST_INTEGER(layreffr)<a name='12209'>
      DM_BCAST_MACRO(kao)<a name='12210'>
      DM_BCAST_MACRO(kbo)<a name='12211'>
      DM_BCAST_MACRO(sfluxrefo)<a name='12212'>
<a name='12213'>
     RETURN<a name='12214'>
9010 CONTINUE<a name='12215'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='12216'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1098">(errmess)<a name='12217'>
<a name='12218'>
      end subroutine sw_kgb27<a name='12219'>
<a name='12220'>
<font color=#447700>! **************************************************************************<a name='12221'></font>
<A NAME='SW_KGB28'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB28' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12222'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb28</font>(rrtmg_unit) <A href='../../call_to/SW_KGB28.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB28.html' TARGET='index'>10</A><a name='12223'>
<font color=#447700>! **************************************************************************<a name='12224'></font>
<a name='12225'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG28'>rrsw_kg28</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG28_3">, only : kao, kbo, sfluxrefo, &amp;<a name='12226'>
                            rayl, strrat, layreffr<a name='12227'>
<a name='12228'>
      implicit none<a name='12229'>
      save<a name='12230'>
<a name='12231'>
<font color=#447700>! Input<a name='12232'></font>
      integer, intent(in) :: rrtmg_unit<a name='12233'>
<a name='12234'>
<font color=#447700>! Local                                    <a name='12235'></font>
      character*80 errmess<a name='12236'>
      logical, external  :: wrf_dm_on_monitor<a name='12237'>
<a name='12238'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='12239'></font>
<a name='12240'>
<font color=#447700>!     Array raylo contains the Rayleigh extinction coefficient at all v = ???? cm-1.<a name='12241'></font>
<a name='12242'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='12243'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='12244'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='12245'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='12246'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='12247'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='12248'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='12249'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='12250'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='12251'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='12252'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='12253'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='12254'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='12255'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='12256'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='12257'></font>
<a name='12258'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='12259'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='12260'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='12261'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='12262'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='12263'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='12264'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='12265'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='12266'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='12267'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='12268'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='12269'></font>
<a name='12270'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_365"> ( A , size ( A ) * RWORDSIZE )<a name='12271'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_38"> ( A , 1 )<a name='12272'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_22"> ( A , 1 )<a name='12273'>
<a name='12274'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='12275'>
         rayl, strrat, layreffr, kao, kbo, sfluxrefo<a name='12276'>
      DM_BCAST_REAL(rayl)<a name='12277'>
      DM_BCAST_REAL(strrat)<a name='12278'>
      DM_BCAST_INTEGER(layreffr)<a name='12279'>
      DM_BCAST_MACRO(kao)<a name='12280'>
      DM_BCAST_MACRO(kbo)<a name='12281'>
      DM_BCAST_MACRO(sfluxrefo)<a name='12282'>
<a name='12283'>
     RETURN<a name='12284'>
9010 CONTINUE<a name='12285'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='12286'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1099">(errmess)<a name='12287'>
<a name='12288'>
      end subroutine sw_kgb28<a name='12289'>
<a name='12290'>
<font color=#447700>! **************************************************************************<a name='12291'></font>
<A NAME='SW_KGB29'><A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#SW_KGB29' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12292'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb29</font>(rrtmg_unit) <A href='../../call_to/SW_KGB29.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB29.html' TARGET='index'>10</A><a name='12293'>
<font color=#447700>! **************************************************************************<a name='12294'></font>
<a name='12295'>
      use <A href='../../html_code/phys/module_ra_rrtmg_sw.F.html#RRSW_KG29'>rrsw_kg29</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG29_3">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='12296'>
                            absh2oo, absco2o, rayl, layreffr<a name='12297'>
<a name='12298'>
      implicit none<a name='12299'>
      save<a name='12300'>
<a name='12301'>
<font color=#447700>! Input<a name='12302'></font>
      integer, intent(in) :: rrtmg_unit<a name='12303'>
<a name='12304'>
<font color=#447700>! Local                                    <a name='12305'></font>
      character*80 errmess<a name='12306'>
      logical, external  :: wrf_dm_on_monitor<a name='12307'>
<a name='12308'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='12309'></font>
<a name='12310'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at all v = 2200 cm-1.<a name='12311'></font>
<a name='12312'>
<font color=#447700>!     Array absh2oo contains the water vapor absorption coefficient for this band.<a name='12313'></font>
<a name='12314'>
<font color=#447700>!     Array absco2o contains the carbon dioxide absorption coefficient for this band.<a name='12315'></font>
<a name='12316'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='12317'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='12318'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='12319'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='12320'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='12321'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='12322'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='12323'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='12324'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='12325'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='12326'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='12327'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='12328'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='12329'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='12330'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='12331'></font>
<a name='12332'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='12333'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='12334'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='12335'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='12336'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='12337'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='12338'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='12339'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='12340'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='12341'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='12342'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='12343'></font>
<a name='12344'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='12345'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='12346'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='12347'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='12348'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='12349'></font>
<a name='12350'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='12351'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='12352'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='12353'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='12354'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='12355'></font>
<a name='12356'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_366"> ( A , size ( A ) * RWORDSIZE )<a name='12357'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_39"> ( A , 1 )<a name='12358'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_23"> ( A , 1 )<a name='12359'>
<a name='12360'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='12361'>
         rayl, layreffr, absh2oo, absco2o, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='12362'>
      DM_BCAST_REAL(rayl)<a name='12363'>
      DM_BCAST_INTEGER(layreffr)<a name='12364'>
      DM_BCAST_MACRO(absh2oo)<a name='12365'>
      DM_BCAST_MACRO(absco2o)<a name='12366'>
      DM_BCAST_MACRO(kao)<a name='12367'>
      DM_BCAST_MACRO(kbo)<a name='12368'>
      DM_BCAST_MACRO(selfrefo)<a name='12369'>
      DM_BCAST_MACRO(forrefo)<a name='12370'>
      DM_BCAST_MACRO(sfluxrefo)<a name='12371'>
<a name='12372'>
     RETURN<a name='12373'>
9010 CONTINUE<a name='12374'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_sw: error reading RRTMG_SW_DATA on unit ',rrtmg_unit<a name='12375'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1100">(errmess)<a name='12376'>
<a name='12377'>
      end subroutine sw_kgb29<a name='12378'>
<a name='12379'>
<font color=#447700>!------------------------------------------------------------------<a name='12380'></font>
<a name='12381'>
END MODULE module_ra_rrtmg_sw<a name='12382'>
<font color=#447700>!***********************************************************************<a name='12383'></font>
</pre></body></html>