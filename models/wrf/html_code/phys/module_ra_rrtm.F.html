<HTML> <BODY BGCOLOR=#ddddee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<a name='2'>
<A NAME='MODULE_RA_RRTM'><A href='../../html_code/phys/module_ra_rrtm.F.html#MODULE_RA_RRTM' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='3'>
<font color=#993300>MODULE </font><font color=#cc0000>module_ra_rrtm</font> <A href='../../call_to/MODULE_RA_RRTM.html' TARGET='index'>2</A><a name='4'>
<a name='5'>
<font color=#447700>! Parameters<a name='6'></font>
<a name='7'>
      INTEGER, PRIVATE :: IDATA<a name='8'>
      INTEGER, PARAMETER :: MG=16 <a name='9'>
      INTEGER, PARAMETER :: NBANDS=16<a name='10'>
      INTEGER, PARAMETER :: NGPT=140<a name='11'>
      INTEGER, PARAMETER :: NG1=8<a name='12'>
      INTEGER, PARAMETER :: NG2=14<a name='13'>
      INTEGER, PARAMETER :: NG3=16<a name='14'>
      INTEGER, PARAMETER :: NG4=14<a name='15'>
      INTEGER, PARAMETER :: NG5=16 <a name='16'>
      INTEGER, PARAMETER :: NG6=8<a name='17'>
      INTEGER, PARAMETER :: NG7=12<a name='18'>
      INTEGER, PARAMETER :: NG8=8<a name='19'>
      INTEGER, PARAMETER :: NG9=12<a name='20'>
      INTEGER, PARAMETER :: NG10=6 <a name='21'>
      INTEGER, PARAMETER :: NG11=8<a name='22'>
      INTEGER, PARAMETER :: NG12=8<a name='23'>
      INTEGER, PARAMETER :: NG13=4<a name='24'>
      INTEGER, PARAMETER :: NG14=2<a name='25'>
      INTEGER, PARAMETER :: NG15=2<a name='26'>
      INTEGER, PARAMETER :: NG16=2<a name='27'>
      INTEGER, PARAMETER :: MAXINPX=35<a name='28'>
      INTEGER, PARAMETER :: MAXXSEC=4<a name='29'>
<a name='30'>
      INTEGER, PARAMETER :: NMOL = 6<a name='31'>
      REAL, PARAMETER :: ONEMINUS = 1. - 1.E-6<a name='32'>
      REAL, PARAMETER :: deltap = 4.  <font color=#447700>! Pressure interval for buffer layer in mb<a name='33'></font>
<a name='34'>
<font color=#447700>! var<a name='35'></font>
<a name='36'>
      REAL    , SAVE    :: FLUXFAC<a name='37'>
      INTEGER , SAVE    :: NLAYERS      <a name='38'>
<font color=#447700>!<a name='39'></font>
<font color=#447700>! data 1<a name='40'></font>
<font color=#447700>!<a name='41'></font>
      REAL,SAVE ::  abscoefL1(5,13,MG),    abscoefH1(5,13:59,MG),   &amp;<a name='42'>
                    SELFREF1(10,MG)<a name='43'>
      REAL,SAVE ::  abscoefL2(5,13,MG),    abscoefH2(5,13:59,MG),   &amp;<a name='44'>
                    SELFREF2(10,MG)<a name='45'>
      REAL,SAVE ::  abscoefL3(10,5,13,MG), abscoefH3(5,5,13:59,MG), &amp;<a name='46'>
                    SELFREF3(10,MG)<a name='47'>
      REAL,SAVE ::  abscoefL4(9,5,13,MG),  abscoefH4(6,5,13:59,MG), &amp;<a name='48'>
                    SELFREF4(10,MG)<a name='49'>
      REAL,SAVE ::  abscoefL5(9,5,13,MG),  abscoefH5(5,5,13:59,MG), &amp;<a name='50'>
                    SELFREF5(10,MG)<a name='51'>
      REAL,SAVE ::  abscoefL6(5,13,MG),    SELFREF6(10,MG)<a name='52'>
      REAL,SAVE ::  abscoefL7(9,5,13,MG),  abscoefH7(5,13:59,MG),   &amp;<a name='53'>
                    SELFREF7(10,MG)<a name='54'>
      REAL,SAVE ::  abscoefL8(5,7,MG),     abscoefH8(5,7:59,MG),    &amp;<a name='55'>
                    SELFREF8(10,MG)<a name='56'>
      REAL,SAVE ::  abscoefL9(11,5,13,MG), abscoefH9(5,13:59,MG),   &amp;<a name='57'>
                    SELFREF9(10,MG)<a name='58'>
      REAL,SAVE ::  abscoefL10(5,13,MG),   abscoefH10(5,13:59,MG)  <a name='59'>
      REAL,SAVE ::  abscoefL11(5,13,MG),   abscoefH11(5,13:59,MG),  &amp;<a name='60'>
                    SELFREF11(10,MG)<a name='61'>
      REAL,SAVE ::  abscoefL12(9,5,13,MG), SELFREF12(10,MG)<a name='62'>
      REAL,SAVE ::  abscoefL13(9,5,13,MG), SELFREF13(10,MG)<a name='63'>
      REAL,SAVE ::  abscoefL14(5,13,MG),   abscoefH14(5,13:59,MG),  &amp;<a name='64'>
                    SELFREF14(10,MG)<a name='65'>
      REAL,SAVE ::  abscoefL15(9,5,13,MG), SELFREF15(10,MG)<a name='66'>
      REAL,SAVE ::  abscoefL16(9,5,13,MG), SELFREF16(10,MG)<a name='67'>
<a name='68'>
<font color=#447700>!<a name='69'></font>
<font color=#447700>! data 2<a name='70'></font>
<font color=#447700>!<a name='71'></font>
      INTEGER,SAVE ::  NGM(MG*NBANDS), NGC(NBANDS), NGS(NBANDS),       &amp;<a name='72'>
                    NGN(NGPT), NGB(NGPT)<a name='73'>
      REAL,SAVE ::  WT(MG)<a name='74'>
<font color=#447700>!<a name='75'></font>
<font color=#447700>! data 3<a name='76'></font>
<font color=#447700>!<a name='77'></font>
      REAL,SAVE ::  FRACREFA1(MG), FRACREFB1(MG), FORREF1(MG)   <a name='78'>
      REAL,SAVE ::  FRACREFA2(MG,13), FRACREFB2(MG), FORREF2(MG)<a name='79'>
      REAL,SAVE ::  FRACREFA3(MG,10), FRACREFB3(MG,5)        <a name='80'>
      REAL,SAVE ::  FORREF3(MG), ABSN2OA3(MG), ABSN2OB3(MG)   <a name='81'>
      REAL,SAVE ::  FRACREFA4(MG,9), FRACREFB4(MG,6)        <a name='82'>
      REAL,SAVE ::  FRACREFA5(MG,9), FRACREFB5(MG,5), CCL45(MG) <a name='83'>
      REAL,SAVE ::  FRACREFA6(MG), ABSCO26(MG), CFC11ADJ6(MG), CFC126(MG)    <a name='84'>
      REAL,SAVE ::  FRACREFA7(MG,9), FRACREFB7(MG), ABSCO27(MG)        <a name='85'>
      REAL,SAVE ::  FRACREFA8(MG), FRACREFB8(MG), ABSCO2A8(MG), ABSCO2B8(MG)<a name='86'>
      REAL,SAVE ::  ABSN2OA8(MG), ABSN2OB8(MG), CFC128(MG), CFC22ADJ8(MG)  <a name='87'>
      REAL,SAVE ::  FRACREFA9(MG,9), FRACREFB9(MG), ABSN2O9(3*MG)<a name='88'>
      REAL,SAVE ::  FRACREFA10(MG), FRACREFB10(MG)        <a name='89'>
      REAL,SAVE ::  FRACREFA11(MG), FRACREFB11(MG)        <a name='90'>
      REAL,SAVE ::  FRACREFA12(MG,9)        <a name='91'>
      REAL,SAVE ::  FRACREFA13(MG,9)        <a name='92'>
      REAL,SAVE ::  FRACREFA14(MG), FRACREFB14(MG)<a name='93'>
      REAL,SAVE ::  FRACREFA15(MG,9)<a name='94'>
      REAL,SAVE ::  FRACREFA16(MG,9)<a name='95'>
<font color=#447700>!<a name='96'></font>
<font color=#447700>! data 4<a name='97'></font>
<font color=#447700>!<a name='98'></font>
      INTEGER,SAVE :: NXMOL, IXINDX(MAXINPX)<a name='99'>
<a name='100'>
<font color=#447700>! data 5 <a name='101'></font>
<a name='102'>
      REAL,SAVE    :: WAVENUM1(NBANDS),WAVENUM2(NBANDS),DELWAVE(NBANDS)<a name='103'>
<a name='104'>
<font color=#447700>! data 6<a name='105'></font>
<a name='106'>
      INTEGER,SAVE :: NG(NBANDS),NSPA(NBANDS),NSPB(NBANDS)<a name='107'>
      REAL,   SAVE :: HEATFAC<a name='108'>
      REAL,   SAVE :: PREF(59),PREFLOG(59),TREF(59)<a name='109'>
<a name='110'>
<font color=#447700>! data 7 <a name='111'></font>
<a name='112'>
      REAL,   SAVE :: TOTPLNK(181,NBANDS), TOTPLK16(181)<a name='113'>
<a name='114'>
<font color=#447700>! data<a name='115'></font>
<a name='116'>
      REAL,    SAVE :: TAU(0:5000),TF(0:5000),TRANS(0:5000)<a name='117'>
<font color=#447700>!<a name='118'></font>
      REAL,    SAVE :: ABSA1(5*13,NG1), ABSB1(5*(59-13+1),NG1),         &amp;<a name='119'>
                       SELFREFC1(10,NG1), FORREFC1(NG1)<a name='120'>
      REAL,    SAVE :: ABSA2(5*13,NG2), ABSB2(5*(59-13+1),NG2),         &amp;<a name='121'>
                       SELFREFC2(10,NG2), FORREFC2(NG2)<a name='122'>
      REAL,    SAVE :: ABSA3(10*5*13,NG3), ABSB3(5*5*(59-13+1),NG3),    &amp;     <a name='123'>
                       SELFREFC3(10,NG3), FORREFC3(NG3),                &amp;<a name='124'>
                       ABSN2OAC3(NG3), ABSN2OBC3(NG3)        <a name='125'>
      REAL,    SAVE :: ABSA4(9*5*13,NG4), ABSB4(6*5*(59-13+1),NG4),     &amp;<a name='126'>
                       SELFREFC4(10,NG4)        <a name='127'>
      REAL,    SAVE :: ABSA5(9*5*13,NG5), ABSB5(5*5*(59-13+1),NG5),     &amp;<a name='128'>
                       SELFREFC5(10,NG5), CCL4C5(NG5)        <a name='129'>
      REAL,    SAVE :: ABSA6(5*13,NG6), SELFREFC6(10,NG6),              &amp;        <a name='130'>
                       ABSCO2C6(NG6), CFC11ADJC6(NG6), CFC12C6(NG6)  <a name='131'>
      REAL,    SAVE :: ABSA7(9*5*13,NG7), ABSB7(5*(59-13+1),NG7),       &amp;  <a name='132'>
                       SELFREFC7(10,NG7), ABSCO2C7(NG7)        <a name='133'>
      REAL,    SAVE :: ABSA8(5*7,NG8), ABSB8(5*(59-7+1),NG8),           &amp;<a name='134'>
                       SELFREFC8(10,NG8),                               &amp;<a name='135'>
                       ABSCO2AC8(NG8), ABSCO2BC8(NG8),                  &amp;<a name='136'>
                       ABSN2OAC8(NG8), ABSN2OBC8(NG8),                  &amp;       <a name='137'>
                       CFC12C8(NG8), CFC22ADJC8(NG8)      <a name='138'>
      REAL,    SAVE :: ABSA9(11*5*13,NG9), ABSB9(5*(59-13+1),NG9),      &amp;<a name='139'>
                       SELFREFC9(10,NG9), ABSN2OC9(3*NG9)<a name='140'>
      REAL,    SAVE :: ABSA10(5*13,NG10), ABSB10(5*(59-13+1),NG10)<a name='141'>
      REAL,    SAVE :: ABSA11(5*13,NG11), ABSB11(5*(59-13+1),NG11),     &amp;<a name='142'>
                       SELFREFC11(10,NG11)<a name='143'>
      REAL,    SAVE :: ABSA12(9*5*13,NG12), SELFREFC12(10,NG12)<a name='144'>
      REAL,    SAVE :: ABSA13(9*5*13,NG13), SELFREFC13(10,NG13)<a name='145'>
      REAL,    SAVE :: ABSA14(5*13,NG14), ABSB14(5*(59-13+1),NG14),    &amp;<a name='146'>
                       SELFREFC14(10,NG14)<a name='147'>
      REAL,    SAVE :: ABSA15(9*5*13,NG15), SELFREFC15(10,NG15)<a name='148'>
      REAL,    SAVE :: ABSA16(9*5*13,NG16), SELFREFC16(10,NG16)<a name='149'>
<a name='150'>
      REAL,    SAVE :: FRACREFAC1(NG1), FRACREFBC1(NG1)<a name='151'>
      REAL,    SAVE :: FRACREFAC2(NG2,13), FRACREFBC2(NG2)<a name='152'>
      REAL,    SAVE :: FRACREFAC3(NG3,10), FRACREFBC3(NG3,5)<a name='153'>
      REAL,    SAVE :: FRACREFAC4(NG4,9), FRACREFBC4(NG4,6)<a name='154'>
      REAL,    SAVE :: FRACREFAC5(NG5,9), FRACREFBC5(NG5,5)      <a name='155'>
      REAL,    SAVE :: FRACREFAC6(NG6)                              <a name='156'>
      REAL,    SAVE :: FRACREFAC7(NG7,9), FRACREFBC7(NG7)    <a name='157'>
      REAL,    SAVE :: FRACREFAC8(NG8), FRACREFBC8(NG8)  <a name='158'>
      REAL,    SAVE :: FRACREFAC9(NG9,9), FRACREFBC9(NG9)      <a name='159'>
      REAL,    SAVE :: FRACREFAC10(NG10), FRACREFBC10(NG10)       <a name='160'>
      REAL,    SAVE :: FRACREFAC11(NG11), FRACREFBC11(NG11)  <a name='161'>
      REAL,    SAVE :: FRACREFAC12(NG12,9)                     <a name='162'>
      REAL,    SAVE :: FRACREFAC13(NG13,9)           <a name='163'>
      REAL,    SAVE :: FRACREFAC14(NG14), FRACREFBC14(NG14)    <a name='164'>
      REAL,    SAVE :: FRACREFAC15(NG15,9)                      <a name='165'>
      REAL,    SAVE :: FRACREFAC16(NG16,9)                 <a name='166'>
      <a name='167'>
      REAL,    SAVE :: CORR1(0:200),CORR2(0:200)<a name='168'>
      REAL,    SAVE :: BPADE<a name='169'>
      REAL,    SAVE :: RWGT(MG*NBANDS)<a name='170'>
<a name='171'>
<font color=#447700>!----------------------------------------------------------------------------<a name='172'></font>
<font color=#447700>!<a name='173'></font>
<font color=#447700>! start data 2<a name='174'></font>
                                                                                 <a name='175'>
<font color=#447700>!     Arrays for the g-point reduction from 256 to 140 for the 16 LW bands:      <a name='176'></font>
<font color=#447700>!     This mapping from 256 to 140 points has been carefully selected to         <a name='177'></font>
<font color=#447700>!     minimize the effect on the resulting fluxes and cooling rates, and         <a name='178'></font>
<font color=#447700>!     caution should be used if the mapping is modified.                         <a name='179'></font>
<font color=#447700>!                                                                                <a name='180'></font>
<font color=#447700>!     NGPT    The total number of new g-points                                   <a name='181'></font>
<font color=#447700>!     NGC     The number of new g-points in each band                            <a name='182'></font>
<font color=#447700>!     NGM     The index of each new g-point relative to the original             <a name='183'></font>
<font color=#447700>!             16 g-points for each band.                                         <a name='184'></font>
<font color=#447700>!     NGN     The number of original g-points that are combined to make          <a name='185'></font>
<font color=#447700>!             each new g-point in each band.                                     <a name='186'></font>
<font color=#447700>!     NGB     The band index for each new g-point.                               <a name='187'></font>
<font color=#447700>!     WT      RRTM weights for 16 g-points.                                      <a name='188'></font>
                                                                                 <a name='189'>
<font color=#447700>! Data Statements                                                                <a name='190'></font>
      DATA NGC  /8,14,16,14,16,8,12,8,12,6,8,8,4,2,2,2/                          <a name='191'>
      DATA NGS  /8,22,38,52,68,76,88,96,108,114,122,130,134,136,138,140/         <a name='192'>
      DATA NGM  /1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8, &amp;             <font color=#447700>! Band 1            <a name='193'></font>
                 1,2,3,4,5,6,7,8,9,10,11,12,13,13,14,14, &amp;      <font color=#447700>! Band 2            <a name='194'></font>
                 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;      <font color=#447700>! Band 3            <a name='195'></font>
                 1,2,3,4,5,6,7,8,9,10,11,12,13,14,14,14, &amp;      <font color=#447700>! Band 4            <a name='196'></font>
                 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;      <font color=#447700>! Band 5            <a name='197'></font>
                 1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8, &amp;             <font color=#447700>! Band 6            <a name='198'></font>
                 1,1,2,2,3,4,5,6,7,8,9,10,11,11,12,12, &amp;        <font color=#447700>! Band 7            <a name='199'></font>
                 1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8, &amp;             <font color=#447700>! Band 8            <a name='200'></font>
                 1,2,3,4,5,6,7,8,9,9,10,10,11,11,12,12, &amp;       <font color=#447700>! Band 9            <a name='201'></font>
                 1,1,2,2,3,3,4,4,5,5,5,5,6,6,6,6, &amp;             <font color=#447700>! Band 10           <a name='202'></font>
                 1,2,3,3,4,4,5,5,6,6,7,7,7,8,8,8, &amp;             <font color=#447700>! Band 11           <a name='203'></font>
                 1,2,3,4,5,5,6,6,7,7,7,7,8,8,8,8, &amp;             <font color=#447700>! Band 12           <a name='204'></font>
                 1,1,1,2,2,2,3,3,3,3,4,4,4,4,4,4, &amp;             <font color=#447700>! Band 13           <a name='205'></font>
                 1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2, &amp;             <font color=#447700>! Band 14           <a name='206'></font>
                 1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2, &amp;             <font color=#447700>! Band 15           <a name='207'></font>
                 1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2/               <font color=#447700>! Band 16           <a name='208'></font>
      DATA NGN  /2,2,2,2,2,2,2,2, &amp;                             <font color=#447700>! Band 1            <a name='209'></font>
                 1,1,1,1,1,1,1,1,1,1,1,1,2,2, &amp;                 <font color=#447700>! Band 2            <a name='210'></font>
                 16*1, &amp;                                        <font color=#447700>! Band 3            <a name='211'></font>
                 1,1,1,1,1,1,1,1,1,1,1,1,1,3, &amp;                 <font color=#447700>! Band 4            <a name='212'></font>
                 16*1, &amp;                                        <font color=#447700>! Band 5            <a name='213'></font>
                 2,2,2,2,2,2,2,2, &amp;                             <font color=#447700>! Band 6            <a name='214'></font>
                 2,2,1,1,1,1,1,1,1,1,2,2, &amp;                     <font color=#447700>! Band 7            <a name='215'></font>
                 2,2,2,2,2,2,2,2, &amp;                             <font color=#447700>! Band 8            <a name='216'></font>
                 1,1,1,1,1,1,1,1,2,2,2,2, &amp;                     <font color=#447700>! Band 9            <a name='217'></font>
                 2,2,2,2,4,4, &amp;                                 <font color=#447700>! Band 10           <a name='218'></font>
                 1,1,2,2,2,2,3,3, &amp;                             <font color=#447700>! Band 11           <a name='219'></font>
                 1,1,1,1,2,2,4,4, &amp;                             <font color=#447700>! Band 12           <a name='220'></font>
                 3,3,4,6, &amp;                                     <font color=#447700>! Band 13           <a name='221'></font>
                 8,8, &amp;                                         <font color=#447700>! Band 14           <a name='222'></font>
                 8,8, &amp;                                         <font color=#447700>! Band 15           <a name='223'></font>
                 8,8/                                           <font color=#447700>! Band 16           <a name='224'></font>
      DATA NGB  /8*1, &amp;                                         <font color=#447700>! Band 1            <a name='225'></font>
                 14*2, &amp;                                        <font color=#447700>! Band 2            <a name='226'></font>
                 16*3, &amp;                                        <font color=#447700>! Band 3            <a name='227'></font>
                 14*4, &amp;                                        <font color=#447700>! Band 4            <a name='228'></font>
                 16*5, &amp;                                        <font color=#447700>! Band 5            <a name='229'></font>
                 8*6, &amp;                                         <font color=#447700>! Band 6            <a name='230'></font>
                 12*7, &amp;                                        <font color=#447700>! Band 7            <a name='231'></font>
                 8*8, &amp;                                         <font color=#447700>! Band 8            <a name='232'></font>
                 12*9, &amp;                                        <font color=#447700>! Band 9            <a name='233'></font>
                 6*10, &amp;                                        <font color=#447700>! Band 10           <a name='234'></font>
                 8*11, &amp;                                        <font color=#447700>! Band 11           <a name='235'></font>
                 8*12, &amp;                                        <font color=#447700>! Band 12           <a name='236'></font>
                 4*13, &amp;                                        <font color=#447700>! Band 13           <a name='237'></font>
                 2*14, &amp;                                        <font color=#447700>! Band 14           <a name='238'></font>
                 2*15, &amp;                                        <font color=#447700>! Band 15           <a name='239'></font>
                 2*16/                                       <font color=#447700>! Band 16           <a name='240'></font>
      DATA WT/ &amp;                                                                  <a name='241'>
           0.1527534276,0.1491729617,0.1420961469,0.1316886544, &amp;                   <a name='242'>
           0.1181945205,0.1019300893,0.0832767040,0.0626720116, &amp;                   <a name='243'>
           0.0424925,0.0046269894,0.0038279891,0.0030260086, &amp;                      <a name='244'>
           0.0022199750,0.0014140010,0.000533,0.000075/                          <a name='245'>
<a name='246'>
<font color=#447700>!<a name='247'></font>
<font color=#447700>! end of data 2<a name='248'></font>
<font color=#447700>!<a name='249'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='250'></font>
<a name='251'>
<font color=#447700>! start data 3<a name='252'></font>
<a name='253'>
                                                                                 <a name='254'>
<font color=#447700>! Data<a name='255'></font>
<a name='256'>
      DATA FRACREFA1/ &amp;                                                            <a name='257'>
          0.08452097,0.17952873,0.16214369,0.13602182, &amp;                            <a name='258'>
          0.12760490,0.10302561,0.08392423,0.06337652, &amp;                            <a name='259'>
          0.04206551,0.00487497,0.00410743,0.00344421, &amp;                            <a name='260'>
          0.00285731,0.00157327,0.00080648,0.00012406/                           <a name='261'>
      DATA FRACREFB1/ &amp;                                                            <a name='262'>
          0.15492001,0.17384727,0.15165100,0.12675308, &amp;                            <a name='263'>
          0.10986247,0.09006091,0.07584465,0.05990077, &amp;                            <a name='264'>
          0.04113461,0.00438638,0.00374754,0.00313924, &amp;                            <a name='265'>
          0.00234381,0.00167167,0.00062744,0.00010889/                           <a name='266'>
                                                                                 <a name='267'>
      DATA FORREF1/   &amp;                                                            <a name='268'>
         -4.50470E-02,-1.18908E-01,-7.21730E-02,-2.83862E-02, &amp;                     <a name='269'>
         -3.01961E-02,-1.56877E-02,-1.53684E-02,-1.29135E-02, &amp;                     <a name='270'>
         -1.27963E-02,-1.81742E-03, 4.40008E-05, 1.05260E-02, &amp;                     <a name='271'>
          2.17290E-02, 1.65571E-02, 7.60751E-02, 1.47405E-01/                    <a name='272'>
<a name='273'>
                                                                                 <a name='274'>
<font color=#447700>! Data                                                                           <a name='275'></font>
                                                                                 <a name='276'>
<font color=#447700>!     The ith set of reference fractions are from the ith reference              <a name='277'></font>
<font color=#447700>!     pressure level.                                                            <a name='278'></font>
<a name='279'>
      DATA FRACREFA2/ &amp;<a name='280'>
          0.18068060,0.16803175,0.15140158,0.12221480, 0.10240850,0.09330297,0.07518960,0.05611294, &amp;<a name='281'>
          0.03781487,0.00387192,0.00321285,0.00244440, 0.00179546,0.00107704,0.00038798,0.00005060, &amp;<a name='282'>
          0.17927621,0.16731168,0.15129538,0.12328085, 0.10243484,0.09354796,0.07538418,0.05633071, &amp;<a name='283'>
          0.03810832,0.00398347,0.00320262,0.00250029, 0.00178666,0.00111127,0.00039438,0.00005169, &amp;<a name='284'>
          0.17762886,0.16638555,0.15115446,0.12470623, 0.10253213,0.09383459,0.07560240,0.05646568, &amp;<a name='285'>
          0.03844077,0.00409142,0.00322521,0.00254918, 0.00179296,0.00113652,0.00040169,0.00005259, &amp;<a name='286'>
          0.17566043,0.16539773,0.15092199,0.12571971, 0.10340609,0.09426189,0.07559051,0.05678188, &amp;<a name='287'>
          0.03881499,0.00414102,0.00328551,0.00258795, 0.00181648,0.00115145,0.00040969,0.00005357, &amp;<a name='288'>
          0.17335825,0.16442548,0.15070701,0.12667464, 0.10452303,0.09450833,0.07599410,0.05706393, &amp;<a name='289'>
          0.03910370,0.00417880,0.00335256,0.00261708, 0.00185491,0.00116627,0.00041759,0.00005464, &amp;<a name='290'>
          0.17082544,0.16321516,0.15044247,0.12797612, 0.10574646,0.09470057,0.07647423,0.05738756, &amp;<a name='291'>
          0.03935621,0.00423789,0.00342651,0.00264549, 0.00190188,0.00118281,0.00042592,0.00005583, &amp;<a name='292'>
          0.16809277,0.16193336,0.15013184,0.12937409, 0.10720784,0.09485368,0.07692636,0.05771774, &amp;<a name='293'>
          0.03966988,0.00427754,0.00349696,0.00268946, 0.00193536,0.00120222,0.00043462,0.00005712, &amp;<a name='294'>
          0.16517997,0.16059248,0.14984852,0.13079269, 0.10865030,0.09492947,0.07759736,0.05812201, &amp;<a name='295'>
          0.03997169,0.00432356,0.00355308,0.00274031, 0.00197243,0.00122401,0.00044359,0.00005849, &amp;<a name='296'>
          0.16209179,0.15912023,0.14938223,0.13198245, 0.11077233,0.09487948,0.07831636,0.05863440, &amp;<a name='297'>
          0.04028239,0.00436804,0.00360407,0.00279885, 0.00200364,0.00124861,0.00045521,0.00005996, &amp;<a name='298'>
          0.15962425,0.15789343,0.14898103,0.13275230, 0.11253940,0.09503502,0.07884382,0.05908009, &amp;<a name='299'>
          0.04053524,0.00439971,0.00364269,0.00284965, 0.00202758,0.00127076,0.00046408,0.00006114, &amp;<a name='300'>
          0.15926200,0.15770932,0.14891729,0.13283882, 0.11276010,0.09507311,0.07892222,0.05919230, &amp;<a name='301'>
          0.04054824,0.00440833,0.00365575,0.00286459, 0.00203786,0.00128405,0.00046504,0.00006146, &amp;<a name='302'>
          0.15926351,0.15770483,0.14891177,0.13279966, 0.11268171,0.09515216,0.07890341,0.05924807, &amp;<a name='303'>
          0.04052851,0.00440870,0.00365425,0.00286878, 0.00205747,0.00128916,0.00046589,0.00006221, &amp;<a name='304'>
          0.15937765,0.15775780,0.14892603,0.13273248, 0.11252731,0.09521657,0.07885858,0.05927679, &amp;<a name='305'>
          0.04050184,0.00440285,0.00365748,0.00286791, 0.00207507,0.00129193,0.00046679,0.00006308/<a name='306'>
<font color=#447700>!     From P = 0.432 mb.                                                         <a name='307'></font>
      DATA FRACREFB2/ &amp;                                                             <a name='308'>
          0.17444289,0.16467269,0.15021490,0.12460902, &amp;                         <a name='309'>
          0.10400643,0.09481928,0.07590704,0.05752856, &amp;                         <a name='310'>
          0.03931715,0.00428572,0.00349352,0.00278938, &amp;                         <a name='311'>
          0.00203448,0.00130037,0.00051560,0.00006255/                           <a name='312'>
                                                                                 <a name='313'>
      DATA FORREF2/ &amp;                                                               <a name='314'>
         -2.34550E-03,-8.42698E-03,-2.01816E-02,-5.66701E-02, &amp;                  <a name='315'>
         -8.93189E-02,-6.37487E-02,-4.56455E-02,-4.41417E-02, &amp;                  <a name='316'>
         -4.48605E-02,-4.74696E-02,-5.16648E-02,-5.63099E-02, &amp;                  <a name='317'>
         -4.74781E-02,-3.84704E-02,-2.49905E-02, 2.02114E-03/                    <a name='318'>
                                                                                 <a name='319'>
<font color=#447700>! Data                                                                           <a name='320'></font>
                                                                                 <a name='321'>
      DATA FRACREFA3/ &amp;                                                             <a name='322'>
<font color=#447700>!     From P = 1053.6 mb.                                                        <a name='323'></font>
          0.15116400,0.14875700,0.14232300,0.13234501, 0.11881600,0.10224100,0.08345580,0.06267490, &amp;                         <a name='324'>
          0.04250650,0.00462650,0.00382259,0.00302600, 0.00222004,0.00141397,0.00053379,0.00007421, &amp;                         <a name='325'>
          0.15266000,0.14888400,0.14195900,0.13179500, 0.11842700,0.10209000,0.08336130,0.06264370, &amp;                         <a name='326'>
          0.04247660,0.00461946,0.00381536,0.00302601, 0.00222004,0.00141397,0.00053302,0.00007498, &amp;                         <a name='327'>
          0.15282799,0.14903000,0.14192399,0.13174300, 0.11835300,0.10202700,0.08329830,0.06264830, &amp;                         <a name='328'>
          0.04246910,0.00460242,0.00381904,0.00301573, 0.00222004,0.00141397,0.00053379,0.00007421, &amp;                         <a name='329'>
          0.15298399,0.14902800,0.14193401,0.13173500, 0.11833300,0.10195800,0.08324730,0.06264770, &amp;                         <a name='330'>
          0.04246490,0.00460489,0.00381123,0.00301893, 0.00221093,0.00141397,0.00053379,0.00007421, &amp;                         <a name='331'>
          0.15307599,0.14907201,0.14198899,0.13169800, 0.11827300,0.10192300,0.08321600,0.06263490, &amp;                         <a name='332'>
          0.04245600,0.00460846,0.00380836,0.00301663, 0.00221402,0.00141167,0.00052807,0.00007376, &amp;                         <a name='333'>
          0.15311401,0.14915401,0.14207301,0.13167299, 0.11819300,0.10188900,0.08318760,0.06261960, &amp;                         <a name='334'>
          0.04243890,0.00461584,0.00380929,0.00300815, 0.00221736,0.00140588,0.00052776,0.00007376, &amp;                         <a name='335'>
          0.15316001,0.14925499,0.14213000,0.13170999, 0.11807700,0.10181400,0.08317400,0.06260300, &amp;                         <a name='336'>
          0.04242720,0.00461520,0.00381381,0.00301285, 0.00220275,0.00140371,0.00052776,0.00007376, &amp;                         <a name='337'>
          0.15321200,0.14940999,0.14222500,0.13164200, 0.11798200,0.10174500,0.08317500,0.06253640, &amp;                         <a name='338'>
          0.04243130,0.00461724,0.00381534,0.00300320, 0.00220091,0.00140364,0.00052852,0.00007300, &amp;                         <a name='339'>
          0.15312800,0.14973100,0.14234400,0.13168900, 0.11795200,0.10156100,0.08302990,0.06252240, &amp;                         <a name='340'>
          0.04240980,0.00461035,0.00381381,0.00300176, 0.00220160,0.00140284,0.00052774,0.00007376, &amp;                         <a name='341'>
          0.15292500,0.14978001,0.14242400,0.13172600, 0.11798800,0.10156400,0.08303050,0.06251670, &amp;                         <a name='342'>
          0.04240970,0.00461302,0.00381452,0.00300250, 0.00220126,0.00140324,0.00052850,0.00007300/                           <a name='343'>
      DATA FRACREFB3/ &amp;                                                             <a name='344'>
<font color=#447700>!     From P = 64.1 mb.                                                          <a name='345'></font>
          0.16340201,0.15607700,0.14601400,0.13182700, &amp;                         <a name='346'>
          0.11524700,0.09666570,0.07825360,0.05849780, &amp;                         <a name='347'>
          0.03949650,0.00427980,0.00353719,0.00279303, &amp;                         <a name='348'>
          0.00204788,0.00130139,0.00049055,0.00006904, &amp;                         <a name='349'>
          0.15762900,0.15494700,0.14659800,0.13267800, &amp;                         <a name='350'>
          0.11562700,0.09838360,0.07930420,0.05962700, &amp;                         <a name='351'>
          0.04036360,0.00438053,0.00361463,0.00285723, &amp;                         <a name='352'>
          0.00208345,0.00132135,0.00050528,0.00008003, &amp;                         <a name='353'>
          0.15641500,0.15394500,0.14633600,0.13180400, &amp;                         <a name='354'>
          0.11617100,0.09924170,0.08000510,0.06021420, &amp;                         <a name='355'>
          0.04082730,0.00441694,0.00365364,0.00287723, &amp;                         <a name='356'>
          0.00210914,0.00135784,0.00054651,0.00008003, &amp;                         <a name='357'>
          0.15482700,0.15286300,0.14392500,0.13244100, &amp;                         <a name='358'>
          0.11712000,0.09994920,0.08119200,0.06104360, &amp;                         <a name='359'>
          0.04135600,0.00446685,0.00368377,0.00290767, &amp;                         <a name='360'>
          0.00215445,0.00142865,0.00056142,0.00008003, &amp;                         <a name='361'>
          0.15975100,0.15653500,0.14214399,0.12892200, &amp;                         <a name='362'>
          0.11508400,0.09906020,0.08087940,0.06078190, &amp;                         <a name='363'>
          0.04140530,0.00452724,0.00374558,0.00295328, &amp;                         <a name='364'>
          0.00218509,0.00138644,0.00056018,0.00008003/                           <a name='365'>
                                                                                 <a name='366'>
      DATA ABSN2OA3/ &amp;                                                              <a name='367'>
          1.50387E-01,2.91407E-01,6.28803E-01,9.65619E-01, &amp;                     <a name='368'>
          1.15054E-00,2.23424E-00,1.83392E-00,1.39033E-00, &amp;                     <a name='369'>
          4.28457E-01,2.73502E-01,1.84307E-01,1.61325E-01, &amp;                     <a name='370'>
          7.66314E-02,1.33862E-01,6.71196E-07,1.59293E-06/                       <a name='371'>
      DATA ABSN2OB3/ &amp;                                                              <a name='372'>
          9.37044E-05,1.23318E-03,7.91720E-03,5.33005E-02, &amp;                     <a name='373'>
          1.72343E-01,4.29571E-01,1.01288E+00,3.83863E+00, &amp;                     <a name='374'>
          1.15312E+01,1.08383E+00,2.24847E+00,1.51268E+00, &amp;                     <a name='375'>
          3.33177E-01,7.82102E-01,3.44631E-01,1.61039E-03/                       <a name='376'>
      DATA FORREF3/ &amp;                                                               <a name='377'>
          1.76842E-04, 1.77913E-04, 1.25186E-04, 1.07912E-04, &amp;                  <a name='378'>
          1.05217E-04, 7.48726E-05, 1.11701E-04, 7.68921E-05, &amp;                  <a name='379'>
          9.87242E-05, 9.85711E-05, 6.16557E-05,-1.61291E-05, &amp;                  <a name='380'>
         -1.26794E-04,-1.19011E-04,-2.67814E-04, 6.95005E-05/                    <a name='381'>
                                                                                 <a name='382'>
<font color=#447700>! Data                                                                           <a name='383'></font>
                                                                                 <a name='384'>
      DATA FRACREFA4/ &amp;                                                             <a name='385'>
<font color=#447700>!     From P =                                                                   <a name='386'></font>
          0.15579100,0.14918099,0.14113800,0.13127001, &amp;                         <a name='387'>
          0.11796300,0.10174300,0.08282370,0.06238150, &amp;                         <a name='388'>
          0.04213440,0.00458968,0.00377949,0.00298736, &amp;                         <a name='389'>
          0.00220743,0.00140644,0.00053024,0.00007459, &amp;                         <a name='390'>
          0.15292799,0.15004000,0.14211500,0.13176700, &amp;                         <a name='391'>
          0.11821100,0.10186300,0.08288040,0.06241390, &amp;                         <a name='392'>
          0.04220720,0.00459006,0.00377919,0.00298743, &amp;                         <a name='393'>
          0.00220743,0.00140644,0.00053024,0.00007459, &amp;                         <a name='394'>
          0.14386199,0.15125300,0.14650001,0.13377000, &amp;                         <a name='395'>
          0.11895900,0.10229400,0.08312110,0.06239520, &amp;                         <a name='396'>
          0.04225560,0.00459428,0.00378865,0.00298860, &amp;                         <a name='397'>
          0.00220743,0.00140644,0.00053024,0.00007459, &amp;                         <a name='398'>
          0.14359100,0.14561599,0.14479300,0.13740200, &amp;                         <a name='399'>
          0.12150100,0.10315400,0.08355480,0.06247240, &amp;                         <a name='400'>
          0.04230980,0.00459916,0.00378373,0.00300063, &amp;                         <a name='401'>
          0.00221111,0.00140644,0.00053024,0.00007459, &amp;                         <a name='402'>
          0.14337599,0.14451601,0.14238000,0.13520500, &amp;                         <a name='403'>
          0.12354200,0.10581200,0.08451810,0.06262440, &amp;                         <a name='404'>
          0.04239590,0.00460297,0.00378701,0.00300466, &amp;                         <a name='405'>
          0.00221899,0.00141020,0.00053024,0.00007459, &amp;                         <a name='406'>
          0.14322001,0.14397401,0.14117201,0.13401900, &amp;                         <a name='407'>
          0.12255500,0.10774100,0.08617650,0.06296420, &amp;                         <a name='408'>
          0.04249590,0.00463406,0.00378241,0.00302037, &amp;                         <a name='409'>
          0.00221583,0.00141103,0.00053814,0.00007991, &amp;                         <a name='410'>
          0.14309500,0.14364301,0.14043900,0.13348100, &amp;                         <a name='411'>
          0.12211600,0.10684700,0.08820590,0.06374610, &amp;                         <a name='412'>
          0.04264730,0.00464231,0.00384022,0.00303427, &amp;                         <a name='413'>
          0.00221825,0.00140943,0.00055564,0.00007991, &amp;                         <a name='414'>
          0.15579100,0.14918099,0.14113800,0.13127001, &amp;                         <a name='415'>
          0.11796300,0.10174300,0.08282370,0.06238150, &amp;                         <a name='416'>
          0.04213440,0.00458968,0.00377949,0.00298736, &amp;                         <a name='417'>
          0.00220743,0.00140644,0.00053024,0.00007459, &amp;                         <a name='418'>
          0.15937001,0.15159500,0.14242800,0.13078900, &amp;                         <a name='419'>
          0.11671300,0.10035700,0.08143450,0.06093850, &amp;                         <a name='420'>
          0.04105320,0.00446233,0.00369844,0.00293784, &amp;                         <a name='421'>
          0.00216425,0.00143403,0.00054571,0.00007991/                           <a name='422'>
      DATA FRACREFB4/ &amp;                                                             <a name='423'>
<font color=#447700>!     From P = 1.17 mb.                                                          <a name='424'></font>
          0.15558299,0.14930600,0.14104301,0.13124099, &amp;                         <a name='425'>
          0.11792900,0.10159200,0.08314130,0.06240450, &amp;                         <a name='426'>
          0.04217020,0.00459313,0.00379798,0.00299835, &amp;                         <a name='427'>
          0.00218950,0.00140615,0.00053010,0.00007457, &amp;                         <a name='428'>
          0.15592700,0.14918999,0.14095700,0.13115700, &amp;                         <a name='429'>
          0.11788900,0.10158000,0.08313780,0.06240240, &amp;                         <a name='430'>
          0.04217000,0.00459313,0.00379798,0.00299835, &amp;                         <a name='431'>
          0.00218950,0.00140615,0.00053010,0.00007457, &amp;                         <a name='432'>
          0.15949000,0.15014900,0.14162201,0.13080800, &amp;                         <a name='433'>
          0.11713500,0.10057100,0.08170080,0.06128110, &amp;                         <a name='434'>
          0.04165600,0.00459202,0.00379835,0.00299717, &amp;                         <a name='435'>
          0.00218958,0.00140616,0.00053010,0.00007457, &amp;                         <a name='436'>
          0.15967900,0.15038200,0.14196999,0.13074800, &amp;                         <a name='437'>
          0.11701700,0.10053000,0.08160790,0.06122690, &amp;                         <a name='438'>
          0.04128310,0.00456598,0.00379486,0.00299457, &amp;                         <a name='439'>
          0.00219016,0.00140619,0.00053011,0.00007456, &amp;                         <a name='440'>
          0.15989800,0.15057300,0.14207700,0.13068600, &amp;                         <a name='441'>
          0.11682900,0.10053900,0.08163610,0.06121870, &amp;                         <a name='442'>
          0.04121690,0.00449061,0.00371235,0.00294207, &amp;                         <a name='443'>
          0.00217778,0.00139877,0.00053011,0.00007455, &amp;                         <a name='444'>
          0.15950100,0.15112500,0.14199100,0.13071300, &amp;                         <a name='445'>
          0.11680800,0.10054600,0.08179050,0.06120910, &amp;                         <a name='446'>
          0.04126050,0.00444324,0.00366843,0.00289369, &amp;                         <a name='447'>
          0.00211550,0.00134746,0.00050874,0.00007863/                           <a name='448'>
                                                                                 <a name='449'>
<font color=#447700>! Data                                                                           <a name='450'></font>
                                                                                 <a name='451'>
      DATA FRACREFA5/ &amp;                                                             <a name='452'>
<font color=#447700>!     From P = 387.6 mb.                                                         <a name='453'></font>
          0.13966499,0.14138900,0.13763399,0.13076700, &amp;                         <a name='454'>
          0.12299100,0.10747700,0.08942000,0.06769200, &amp;                         <a name='455'>
          0.04587610,0.00501173,0.00415809,0.00328398, &amp;                         <a name='456'>
          0.00240015,0.00156222,0.00059104,0.00008323, &amp;                         <a name='457'>
          0.13958199,0.14332899,0.13785399,0.13205400, &amp;                         <a name='458'>
          0.12199700,0.10679600,0.08861080,0.06712320, &amp;                         <a name='459'>
          0.04556030,0.00500863,0.00416315,0.00328629, &amp;                         <a name='460'>
          0.00240023,0.00156220,0.00059104,0.00008323, &amp;                         <a name='461'>
          0.13907100,0.14250501,0.13889600,0.13297300, &amp;                         <a name='462'>
          0.12218700,0.10683800,0.08839260,0.06677310, &amp;                         <a name='463'>
          0.04538570,0.00495402,0.00409863,0.00328219, &amp;                         <a name='464'>
          0.00240805,0.00156266,0.00059104,0.00008323, &amp;                         <a name='465'>
          0.13867700,0.14190100,0.13932300,0.13327099, &amp;                         <a name='466'>
          0.12280800,0.10692500,0.08844510,0.06658510, &amp;                         <a name='467'>
          0.04519340,0.00492276,0.00408832,0.00323856, &amp;                         <a name='468'>
          0.00239289,0.00155698,0.00059104,0.00008323, &amp;                         <a name='469'>
          0.13845000,0.14158800,0.13929300,0.13295600, &amp;                         <a name='470'>
          0.12348300,0.10736700,0.08859480,0.06650610, &amp;                         <a name='471'>
          0.04498230,0.00491335,0.00406968,0.00322901, &amp;                         <a name='472'>
          0.00234666,0.00155235,0.00058813,0.00008323, &amp;                         <a name='473'>
          0.13837101,0.14113200,0.13930500,0.13283101, &amp;                         <a name='474'>
          0.12349200,0.10796400,0.08890490,0.06646480, &amp;                         <a name='475'>
          0.04485990,0.00489554,0.00405264,0.00320313, &amp;                         <a name='476'>
          0.00234742,0.00151159,0.00058438,0.00008253, &amp;                         <a name='477'>
          0.13834500,0.14093500,0.13896500,0.13262001, &amp;                         <a name='478'>
          0.12326900,0.10828900,0.08950050,0.06674610, &amp;                         <a name='479'>
          0.04476560,0.00489624,0.00400962,0.00317423, &amp;                         <a name='480'>
          0.00233479,0.00148249,0.00058590,0.00008253, &amp;                         <a name='481'>
          0.13831300,0.14069000,0.13871400,0.13247600, &amp;                         <a name='482'>
          0.12251400,0.10831300,0.08977090,0.06776920, &amp;                         <a name='483'>
          0.04498390,0.00484111,0.00398948,0.00316069, &amp;                         <a name='484'>
          0.00229741,0.00150104,0.00058608,0.00008253, &amp;                         <a name='485'>
          0.14027201,0.14420401,0.14215700,0.13446601, &amp;                         <a name='486'>
          0.12303700,0.10596100,0.08650370,0.06409570, &amp;                         <a name='487'>
          0.04312310,0.00471110,0.00393954,0.00310850, &amp;                         <a name='488'>
          0.00229588,0.00146366,0.00058194,0.00008253/                           <a name='489'>
      DATA FRACREFB5/ &amp;                                                             <a name='490'>
<font color=#447700>!     From P = 1.17 mb.                                                          <a name='491'></font>
          0.14339100,0.14358699,0.13935301,0.13306700, &amp;                         <a name='492'>
          0.12135700,0.10590600,0.08688240,0.06553220, &amp;                         <a name='493'>
          0.04446740,0.00483580,0.00399413,0.00316225, &amp;                         <a name='494'>
          0.00233007,0.00149135,0.00056246,0.00008059, &amp;                         <a name='495'>
          0.14330500,0.14430299,0.14053699,0.13355300, &amp;                         <a name='496'>
          0.12151200,0.10529100,0.08627630,0.06505230, &amp;                         <a name='497'>
          0.04385850,0.00476555,0.00395010,0.00313878, &amp;                         <a name='498'>
          0.00232273,0.00149354,0.00056246,0.00008059, &amp;                         <a name='499'>
          0.14328399,0.14442700,0.14078601,0.13390100, &amp;                         <a name='500'>
          0.12132600,0.10510600,0.08613660,0.06494630, &amp;                         <a name='501'>
          0.04381310,0.00475378,0.00394166,0.00313076, &amp;                         <a name='502'>
          0.00231235,0.00149159,0.00056301,0.00008059, &amp;                         <a name='503'>
          0.14326900,0.14453100,0.14114200,0.13397101, &amp;                         <a name='504'>
          0.12127200,0.10493400,0.08601380,0.06483360, &amp;                         <a name='505'>
          0.04378900,0.00474655,0.00393549,0.00312583, &amp;                         <a name='506'>
          0.00230686,0.00148433,0.00056502,0.00008059, &amp;                         <a name='507'>
          0.14328900,0.14532700,0.14179000,0.13384600, &amp;                         <a name='508'>
          0.12093700,0.10461500,0.08573010,0.06461340, &amp;                         <a name='509'>
          0.04366570,0.00473087,0.00392539,0.00311238, &amp;                         <a name='510'>
          0.00229865,0.00147572,0.00056517,0.00007939/                           <a name='511'>
                                                                                 <a name='512'>
      DATA CCL45/ &amp;                                                                 <a name='513'>
           26.1407,  53.9776,  63.8085,  36.1701, &amp;                              <a name='514'>
           15.4099, 10.23116,  4.82948,  5.03836, &amp;                              <a name='515'>
           1.75558,0.,0.,0., &amp;                                                   <a name='516'>
           0.,0.,0.,0./                                                          <a name='517'>
                                                                                 <a name='518'>
<font color=#447700>! Data                                                                           <a name='519'></font>
                                                                                 <a name='520'>
      DATA FRACREFA6/ &amp;                                                             <a name='521'>
<font color=#447700>!     From P = 706 mb.                                                           <a name='522'></font>
          0.13739009,0.14259538,0.14033118,0.13547136, &amp;                         <a name='523'>
          0.12569460,0.11028396,0.08626066,0.06245148, &amp;                         <a name='524'>
          0.04309394,0.00473551,0.00403920,0.00321695, &amp;                         <a name='525'>
          0.00232470,0.00147662,0.00056095,0.00007373/                           <a name='526'>
                                                                                 <a name='527'>
      DATA CFC11ADJ6/ &amp;                                                             <a name='528'>
           0.,  0., 36.7627,  150.757,   &amp;                                      <a name='529'>
           81.4109, 74.9112, 56.9325, 49.3226, &amp;                                 <a name='530'>
           57.1074, 66.1202, 109.557, 89.0562, &amp;                                 <a name='531'>
           149.865, 196.140, 258.393, 80.9923/                                   <a name='532'>
      DATA CFC126/ &amp;                                                                <a name='533'>
           62.8368, 43.2626, 26.7549, 22.2487, &amp;                                 <a name='534'>
           23.5029, 34.8323, 26.2335, 23.2306, &amp;                                 <a name='535'>
           18.4062, 13.9534, 22.6268, 24.2604, &amp;                                 <a name='536'>
           30.0088, 26.3634, 15.8237, 57.5050/                                   <a name='537'>
      DATA ABSCO26/ &amp;                                                               <a name='538'>
           7.44852E-05, 6.29208E-05, 7.34031E-05, 6.65218E-05, &amp;                 <a name='539'>
           7.87511E-05, 1.22489E-04, 3.39785E-04, 9.33040E-04, &amp;                 <a name='540'>
           1.54323E-03, 4.07220E-04, 4.34332E-04, 8.76418E-05, &amp;                 <a name='541'>
           9.80381E-05, 3.51680E-05, 5.31766E-05, 1.01542E-05/                   <a name='542'>
                                                                                 <a name='543'>
<font color=#447700>! Data                                                                           <a name='544'></font>
                                                                                 <a name='545'>
      DATA FRACREFA7/ &amp;                                                             <a name='546'>
          0.16461779, 0.14889984, 0.14233345, 0.13156526, &amp;                      <a name='547'>
          0.11679733, 0.09988949, 0.08078653, 0.06006384, &amp;                      <a name='548'>
          0.04028391, 0.00435899, 0.00359173, 0.00281707, &amp;                      <a name='549'>
          0.00206767, 0.00135012, 0.00050720, 0.00007146, &amp;                      <a name='550'>
          0.16442357, 0.14944240, 0.14245804, 0.13111183, &amp;                      <a name='551'>
          0.11688625, 0.09983791, 0.08085148, 0.05993948, &amp;                      <a name='552'>
          0.04028057, 0.00435939, 0.00358708, 0.00284036, &amp;                      <a name='553'>
          0.00208869, 0.00133256, 0.00049260, 0.00006931, &amp;                      <a name='554'>
          0.16368519, 0.15018989, 0.14262174, 0.13084342, &amp;                      <a name='555'>
          0.11682195, 0.09996257, 0.08074036, 0.05985692, &amp;                      <a name='556'>
          0.04045362, 0.00436208, 0.00358257, 0.00287122, &amp;                      <a name='557'>
          0.00211004, 0.00133804, 0.00049260, 0.00006931, &amp;                      <a name='558'>
          0.16274056, 0.15133780, 0.14228874, 0.13081114, &amp;                      <a name='559'>
          0.11688486, 0.09979610, 0.08073687, 0.05996741, &amp;                      <a name='560'>
          0.04040616, 0.00439869, 0.00368910, 0.00293041, &amp;                      <a name='561'>
          0.00211604, 0.00133536, 0.00049260, 0.00006931, &amp;                      <a name='562'>
          0.16176532, 0.15207882, 0.14226955, 0.13079646, &amp;                      <a name='563'>
          0.11688191, 0.09966998, 0.08066384, 0.06020275, &amp;                      <a name='564'>
          0.04047901, 0.00446696, 0.00377456, 0.00294410, &amp;                      <a name='565'>
          0.00211082, 0.00133536, 0.00049260, 0.00006931, &amp;                      <a name='566'>
          0.15993737, 0.15305527, 0.14259829, 0.13078023, &amp;                      <a name='567'>
          0.11686983, 0.09980131, 0.08058286, 0.06031430, &amp;                      <a name='568'>
          0.04082833, 0.00450509, 0.00377574, 0.00294823, &amp;                      <a name='569'>
          0.00210977, 0.00133302, 0.00049260, 0.00006931, &amp;                      <a name='570'>
          0.15371189, 0.15592396, 0.14430280, 0.13076764, &amp;                      <a name='571'>
          0.11720382, 0.10023471, 0.08066396, 0.06073554, &amp;                      <a name='572'>
          0.04121581, 0.00451202, 0.00377832, 0.00294609, &amp;                      <a name='573'>
          0.00210943, 0.00133336, 0.00049260, 0.00006931, &amp;                      <a name='574'>
          0.14262275, 0.14572631, 0.14560597, 0.13736825, &amp;                      <a name='575'>
          0.12271351, 0.10419556, 0.08294533, 0.06199794, &amp;                      <a name='576'>
          0.04157615, 0.00452842, 0.00377704, 0.00293852, &amp;                      <a name='577'>
          0.00211034, 0.00133278, 0.00049259, 0.00006931, &amp;                      <a name='578'>
          0.14500433, 0.14590444, 0.14430299, 0.13770708, &amp;                      <a name='579'>
          0.12288283, 0.10350952, 0.08269450, 0.06130579, &amp;                      <a name='580'>
          0.04144571, 0.00452096, 0.00377382, 0.00294532, &amp;                      <a name='581'>
          0.00210943, 0.00133228, 0.00049260, 0.00006931/                        <a name='582'>
      DATA FRACREFB7/ &amp;                                                             <a name='583'>
          0.15355594,0.15310939,0.14274909,0.13129812, &amp;                         <a name='584'>
          0.11736792,0.10118213,0.08215259,0.06165591, &amp;                         <a name='585'>
          0.04164486,0.00451141,0.00372837,0.00294095, &amp;                         <a name='586'>
          0.00215259,0.00136792,0.00051233,0.00007075/                           <a name='587'>
                                                                                 <a name='588'>
      DATA ABSCO27/ &amp;                                                               <a name='589'>
          9.30038E-05, 1.74061E-04, 2.09293E-04, 2.52360E-04, &amp;                  <a name='590'>
          3.13404E-04, 4.16619E-04, 6.27394E-04, 1.29386E-03, &amp;                  <a name='591'>
          4.05192E-03, 3.97050E-03, 7.00634E-04, 6.06617E-04, &amp;                  <a name='592'>
          7.66978E-04, 6.70661E-04, 7.89971E-04, 7.55709E-04/                    <a name='593'>
                                                                                 <a name='594'>
<font color=#447700>! Data                                                                           <a name='595'></font>
                                                                                 <a name='596'>
      DATA FRACREFA8/ &amp;                                                             <a name='597'>
<font color=#447700>!     From P = 1053.6 mb.                                                        <a name='598'></font>
          0.15309700,0.15450300,0.14458799,0.13098200, &amp;                         <a name='599'>
          0.11817900,0.09953490,0.08132080,0.06139960, &amp;                         <a name='600'>
          0.04132010,0.00446788,0.00372533,0.00294053, &amp;                         <a name='601'>
          0.00211371,0.00128122,0.00048050,0.00006759/                           <a name='602'>
      DATA FRACREFB8/ &amp;                                                             <a name='603'>
<font color=#447700>!     From P = 28.9 mb.                                                          <a name='604'></font>
          0.14105400,0.14728899,0.14264800,0.13331699, &amp;                         <a name='605'>
          0.12034100,0.10467000,0.08574980,0.06469390, &amp;                         <a name='606'>
          0.04394640,0.00481284,0.00397375,0.00315006, &amp;                         <a name='607'>
          0.00228636,0.00144606,0.00054604,0.00007697/                           <a name='608'>
                                                                                 <a name='609'>
      DATA CFC128/ &amp;                                                                <a name='610'>
           85.4027, 89.4696, 74.0959, 67.7480, &amp;                                 <a name='611'>
           61.2444, 59.9073, 60.8296, 63.0998, &amp;                                 <a name='612'>
           59.6110, 64.0735, 57.2622, 58.9721, &amp;                                 <a name='613'>
           43.5505, 26.1192, 32.7023, 32.8667/                                   <a name='614'>
      DATA CFC22ADJ8/ &amp;                                                             <a name='615'>
<font color=#447700>!     Original CFC22 is multiplied by 1.485 to account for the 780-850 cm-1      <a name='616'></font>
<font color=#447700>!     and 1290-1335 cm-1 bands.                                                  <a name='617'></font>
           135.335, 89.6642, 76.2375, 65.9748, &amp;                                 <a name='618'>
           63.1164, 60.2935, 64.0299, 75.4264, &amp;                                 <a name='619'>
           51.3018, 7.07911, 5.86928, 0.398693, &amp;                                <a name='620'>
           2.82885, 9.12751, 6.28271, 0./                                        <a name='621'>
      DATA ABSCO2A8/ &amp;                                                              <a name='622'>
           1.11233E-05, 3.92400E-05, 6.62059E-05, 8.51687E-05, &amp;                 <a name='623'>
           7.79035E-05, 1.34058E-04, 2.82553E-04, 5.41741E-04, &amp;                 <a name='624'>
           1.47029E-05, 2.34982E-05, 6.91094E-08, 8.48917E-08, &amp;                 <a name='625'>
           6.58783E-08, 4.64849E-08, 3.62742E-08, 3.62742E-08/                   <a name='626'>
      DATA ABSCO2B8/ &amp;                                                              <a name='627'>
           4.10977E-09, 5.65200E-08, 1.70800E-07, 4.16840E-07, &amp;                 <a name='628'>
           9.53684E-07, 2.36468E-06, 7.29502E-06, 4.93883E-05, &amp;                 <a name='629'>
           5.10440E-04, 9.75248E-04, 1.36495E-03, 2.40451E-03, &amp;                 <a name='630'>
           4.50277E-03, 2.24486E-02, 4.06756E-02, 2.17447E-10/                   <a name='631'>
      DATA ABSN2OA8/ &amp;                                                              <a name='632'>
           1.28527E-02,5.28651E-02,1.01668E-01,1.57224E-01, &amp;                    <a name='633'>
           2.76947E-01,4.93048E-01,6.71387E-01,3.48809E-01, &amp;                    <a name='634'>
           4.19840E-01,3.13558E-01,2.44432E-01,2.05108E-01, &amp;                    <a name='635'>
           1.21423E-01,1.22158E-01,1.49702E-01,1.47799E-01/                      <a name='636'>
      DATA ABSN2OB8/ &amp;                                                              <a name='637'>
           3.15864E-03,4.87347E-03,8.63235E-03,2.16053E-02, &amp;                    <a name='638'>
           3.63699E-02,7.89149E-02,3.53807E-01,1.27140E-00, &amp;                    <a name='639'>
           2.31464E-00,7.75834E-02,5.15063E-02,4.07059E-02, &amp;                    <a name='640'>
           5.91947E-02,5.83546E-02,3.12716E-01,1.47456E-01/                      <a name='641'>
                                                                                 <a name='642'>
<font color=#447700>!  Data                                                                          <a name='643'></font>
                                                                                 <a name='644'>
      DATA FRACREFA9/ &amp;                                                             <a name='645'>
<font color=#447700>!     From P = 1053.6 mb.                                                        <a name='646'></font>
          0.16898900,0.15898301,0.13575301,0.12600900, &amp;                         <a name='647'>
          0.11545800,0.09879170,0.08106830,0.06063440, &amp;                         <a name='648'>
          0.03988780,0.00421760,0.00346635,0.00278779, &amp;                         <a name='649'>
          0.00206225,0.00132324,0.00050033,0.00007038, &amp;                         <a name='650'>
          0.18209399,0.15315101,0.13571000,0.12504999, &amp;                         <a name='651'>
          0.11379100,0.09680810,0.08008570,0.05970280, &amp;                         <a name='652'>
          0.03942860,0.00413383,0.00343186,0.00275558, &amp;                         <a name='653'>
          0.00204657,0.00130219,0.00045454,0.00005664, &amp;                         <a name='654'>
          0.18459500,0.15512000,0.13395500,0.12576801, &amp;                         <a name='655'>
          0.11276800,0.09645190,0.07956650,0.05903340, &amp;                         <a name='656'>
          0.03887050,0.00412226,0.00339453,0.00273518, &amp;                         <a name='657'>
          0.00196922,0.00119411,0.00040263,0.00005664, &amp;                         <a name='658'>
          0.18458800,0.15859900,0.13278100,0.12589300, &amp;                         <a name='659'>
          0.11272700,0.09599660,0.07903030,0.05843600, &amp;                         <a name='660'>
          0.03843400,0.00405181,0.00337980,0.00263818, &amp;                         <a name='661'>
          0.00186869,0.00111807,0.00040263,0.00005664, &amp;                         <a name='662'>
          0.18459301,0.16176100,0.13235000,0.12528200, &amp;                         <a name='663'>
          0.11237100,0.09618840,0.07833760,0.05800770, &amp;                         <a name='664'>
          0.03787610,0.00408253,0.00330363,0.00250445, &amp;                         <a name='665'>
          0.00176725,0.00111753,0.00040263,0.00005664, &amp;                         <a name='666'>
          0.18454400,0.16505300,0.13221300,0.12476600, &amp;                         <a name='667'>
          0.11158300,0.09618120,0.07797340,0.05740380, &amp;                         <a name='668'>
          0.03742820,0.00392691,0.00312208,0.00246306, &amp;                         <a name='669'>
          0.00176735,0.00111721,0.00040263,0.00005664, &amp;                         <a name='670'>
          0.18452001,0.16697501,0.13445500,0.12391300, &amp;                         <a name='671'>
          0.11059100,0.09596890,0.07761050,0.05643200, &amp;                         <a name='672'>
          0.03686520,0.00377086,0.00309351,0.00246297, &amp;                         <a name='673'>
          0.00176765,0.00111700,0.00040263,0.00005664, &amp;                         <a name='674'>
          0.18460999,0.16854499,0.13922299,0.12266400, &amp;                         <a name='675'>
          0.10962200,0.09452030,0.07653800,0.05551340, &amp;                         <a name='676'>
          0.03609660,0.00377043,0.00309367,0.00246304, &amp;                         <a name='677'>
          0.00176749,0.00111689,0.00040263,0.00005664, &amp;                         <a name='678'>
          0.18312500,0.16787501,0.14720701,0.12766500, &amp;                         <a name='679'>
          0.10890900,0.08935530,0.07310870,0.05443140, &amp;                         <a name='680'>
          0.03566380,0.00376446,0.00309521,0.00246510, &amp;                         <a name='681'>
          0.00176139,0.00111543,0.00040263,0.00005664/                           <a name='682'>
      DATA FRACREFB9/ &amp;                                                             <a name='683'>
<font color=#447700>!     From P = 0.071 mb.                                                         <a name='684'></font>
          0.20148601,0.15252700,0.13376500,0.12184600, &amp;                         <a name='685'>
          0.10767800,0.09307410,0.07674570,0.05876940, &amp;                         <a name='686'>
          0.04001480,0.00424612,0.00346896,0.00269954, &amp;                         <a name='687'>
          0.00196864,0.00122562,0.00043628,0.00004892/                           <a name='688'>
                                                                                 <a name='689'>
      DATA ABSN2O9/ &amp;                                                               <a name='690'>
<font color=#447700>!     From P = 952 mb.                                                           <a name='691'></font>
           3.26267E-01,2.42869E-00,1.15455E+01,7.39478E-00, &amp;                    <a name='692'>
           5.16550E-00,2.54474E-00,3.53082E-00,3.82278E-00, &amp;                    <a name='693'>
           1.81297E-00,6.65313E-01,1.23652E-01,1.83895E-03, &amp;                    <a name='694'>
           1.70592E-03,2.68434E-09,0.,0., &amp;                                      <a name='695'>
<font color=#447700>!     From P = 620 mb.                                                           <a name='696'></font>
           2.08632E-01,1.11865E+00,4.95975E+00,8.10907E+00, &amp;                    <a name='697'>
           1.10408E+01,5.45460E+00,4.18611E+00,3.53422E+00, &amp;                    <a name='698'>
           2.54164E+00,3.65093E-01,5.84480E-01,2.26918E-01, &amp;                    <a name='699'>
           1.36230E-03,5.54400E-10,6.83703E-10,0., &amp;                             <a name='700'>
<font color=#447700>!     From P = 313 mb.                                                           <a name='701'></font>
           6.20022E-02,2.69521E-01,9.81928E-01,1.65004E-00, &amp;                    <a name='702'>
           3.08089E-00,5.38696E-00,1.14600E+01,2.41211E+01, &amp;                    <a name='703'>
           1.69655E+01,1.37556E-00,5.43254E-01,3.52079E-01, &amp;                    <a name='704'>
           4.31888E-01,4.82523E-06,5.74747E-11,0./                               <a name='705'>
                                                                                 <a name='706'>
<font color=#447700>! Data                                                                           <a name='707'></font>
                                                                                 <a name='708'>
      DATA FRACREFA10/ &amp;                                                             <a name='709'>
<font color=#447700>!     From P = 473 mb.                                                           <a name='710'></font>
          0.16271301,0.15141940,0.14065412,0.12899506, &amp;                         <a name='711'>
          0.11607002,0.10142808,0.08116794,0.06104711, &amp;                         <a name='712'>
          0.04146209,0.00447386,0.00372902,0.00287258, &amp;                         <a name='713'>
          0.00206028,0.00134634,0.00049232,0.00006927/                           <a name='714'>
      DATA FRACREFB10/ &amp;                                                             <a name='715'>
<font color=#447700>!     From P = 1.17 mb.                                                          <a name='716'></font>
          0.16571465,0.15262246,0.14036226,0.12620729, &amp;                         <a name='717'>
          0.11477834,0.09967982,0.08155201,0.06159503, &amp;                         <a name='718'>
          0.04196607,0.00453940,0.00376881,0.00300437, &amp;                         <a name='719'>
          0.00223034,0.00139432,0.00051516,0.00007095/                           <a name='720'>
                                                                                 <a name='721'>
<font color=#447700>! Data                                                                           <a name='722'></font>
                                                                                 <a name='723'>
      DATA FRACREFA11/ &amp;                                                             <a name='724'>
<font color=#447700>!     From P = 473 mb.                                                           <a name='725'></font>
          0.14152819,0.13811260,0.14312185,0.13705885, &amp;                         <a name='726'>
          0.11944738,0.10570189,0.08866373,0.06565409, &amp;                         <a name='727'>
          0.04428961,0.00481540,0.00387058,0.00329187, &amp;                         <a name='728'>
          0.00238294,0.00150971,0.00049287,0.00005980/                           <a name='729'>
      DATA FRACREFB11/ &amp;                                                             <a name='730'>
<font color=#447700>!     From P = 1.17 mb.                                                          <a name='731'></font>
          0.10874039,0.15164889,0.15149839,0.14515044, &amp;                         <a name='732'>
          0.12486220,0.10725017,0.08715712,0.06463144, &amp;                         <a name='733'>
          0.04332319,0.00441193,0.00393819,0.00305960, &amp;                         <a name='734'>
          0.00224221,0.00145100,0.00055586,0.00007934/                           <a name='735'>
                                                                                 <a name='736'>
<font color=#447700>! Data                                                                           <a name='737'></font>
                                                                                 <a name='738'>
      DATA FRACREFA12/ &amp;                                                             <a name='739'>
<font color=#447700>!     From P = 706.3 mb.                                                         <a name='740'></font>
          0.21245100,0.15164700,0.14486700,0.13075501, &amp;                         <a name='741'>
          0.11629600,0.09266050,0.06579930,0.04524000, &amp;                         <a name='742'>
          0.03072870,0.00284297,0.00234660,0.00185208, &amp;                         <a name='743'>
          0.00133978,0.00082214,0.00031016,0.00004363, &amp;                         <a name='744'>
          0.14703900,0.16937999,0.15605700,0.14159000, &amp;                         <a name='745'>
          0.12088500,0.10058500,0.06809110,0.05131470, &amp;                         <a name='746'>
          0.03487040,0.00327281,0.00250183,0.00190024, &amp;                         <a name='747'>
          0.00133978,0.00082214,0.00031016,0.00004363, &amp;                         <a name='748'>
          0.13689300,0.16610400,0.15723500,0.14299500, &amp;                         <a name='749'>
          0.12399400,0.09907820,0.07169690,0.05367370, &amp;                         <a name='750'>
          0.03671630,0.00378148,0.00290510,0.00221076, &amp;                         <a name='751'>
          0.00142810,0.00093527,0.00031016,0.00004363, &amp;                         <a name='752'>
          0.13054299,0.16273800,0.15874299,0.14279599, &amp;                         <a name='753'>
          0.12674300,0.09664900,0.07462200,0.05620080, &amp;                         <a name='754'>
          0.03789090,0.00411690,0.00322920,0.00245036, &amp;                         <a name='755'>
          0.00178303,0.00098595,0.00040802,0.00010150, &amp;                         <a name='756'>
          0.12828299,0.15824600,0.15688400,0.14449100, &amp;                         <a name='757'>
          0.12787800,0.09517830,0.07679350,0.05890820, &amp;                         <a name='758'>
          0.03883570,0.00442304,0.00346796,0.00255333, &amp;                         <a name='759'>
          0.00212519,0.00116168,0.00067065,0.00010150, &amp;                         <a name='760'>
          0.12649800,0.15195100,0.15646499,0.14569700, &amp;                         <a name='761'>
          0.12669300,0.09653520,0.07887920,0.06106920, &amp;                         <a name='762'>
          0.04043910,0.00430390,0.00364453,0.00314360, &amp;                         <a name='763'>
          0.00203206,0.00187787,0.00067075,0.00010150, &amp;                         <a name='764'>
          0.12500300,0.14460599,0.15672199,0.14724600, &amp;                         <a name='765'>
          0.11978900,0.10190200,0.08196710,0.06315770, &amp;                         <a name='766'>
          0.04240100,0.00433645,0.00404097,0.00329466, &amp;                         <a name='767'>
          0.00288491,0.00187803,0.00067093,0.00010150, &amp;                         <a name='768'>
          0.12317200,0.14118700,0.15242000,0.13794300, &amp;                         <a name='769'>
          0.12119200,0.10655400,0.08808350,0.06521370, &amp;                         <a name='770'>
          0.04505680,0.00485949,0.00477105,0.00401468, &amp;                         <a name='771'>
          0.00288491,0.00187786,0.00067110,0.00010150, &amp;                         <a name='772'>
          0.10193600,0.11693000,0.13236099,0.14053200, &amp;                         <a name='773'>
          0.13749801,0.12193100,0.10221000,0.07448910, &amp;                         <a name='774'>
          0.05205320,0.00572312,0.00476882,0.00403380, &amp;                         <a name='775'>
          0.00288871,0.00187396,0.00067218,0.00010150/                           <a name='776'>
                                                                                 <a name='777'>
<font color=#447700>! Data                                                                           <a name='778'></font>
                                                                                 <a name='779'>
      DATA FRACREFA13/ &amp;                                                             <a name='780'>
<font color=#447700>!     From P = 706.3 mb.                                                         <a name='781'></font>
          0.17683899,0.17319500,0.15712699,0.13604601, &amp;                         <a name='782'>
          0.10776200,0.08750010,0.06808820,0.04905150, &amp;                         <a name='783'>
          0.03280360,0.00350836,0.00281864,0.00219862, &amp;                         <a name='784'>
          0.00160943,0.00101885,0.00038147,0.00005348, &amp;                         <a name='785'>
          0.17535400,0.16999300,0.15610200,0.13589200, &amp;                         <a name='786'>
          0.10842100,0.08988550,0.06943920,0.04974900, &amp;                         <a name='787'>
          0.03323400,0.00352752,0.00289402,0.00231003, &amp;                         <a name='788'>
          0.00174659,0.00101884,0.00038147,0.00005348, &amp;                         <a name='789'>
          0.17409500,0.16846400,0.15641899,0.13503000, &amp;                         <a name='790'>
          0.10838600,0.08985800,0.07092720,0.05075710, &amp;                         <a name='791'>
          0.03364180,0.00354241,0.00303507,0.00243391, &amp;                         <a name='792'>
          0.00177502,0.00114638,0.00043585,0.00005348, &amp;                         <a name='793'>
          0.17248300,0.16778600,0.15543500,0.13496999, &amp;                         <a name='794'>
          0.10826300,0.09028740,0.07156720,0.05187120, &amp;                         <a name='795'>
          0.03424890,0.00363933,0.00324715,0.00255030, &amp;                         <a name='796'>
          0.00187380,0.00116978,0.00051229,0.00009768, &amp;                         <a name='797'>
          0.17061099,0.16715799,0.15405200,0.13471501, &amp;                         <a name='798'>
          0.10896400,0.09069460,0.07229760,0.05218280, &amp;                         <a name='799'>
          0.03555340,0.00379576,0.00330240,0.00274693, &amp;                         <a name='800'>
          0.00201587,0.00119598,0.00061885,0.00009768, &amp;                         <a name='801'>
          0.16789700,0.16629100,0.15270300,0.13360199, &amp;                         <a name='802'>
          0.11047200,0.09151080,0.07325000,0.05261450, &amp;                         <a name='803'>
          0.03657990,0.00450092,0.00349537,0.00283321, &amp;                         <a name='804'>
          0.00208396,0.00140354,0.00066587,0.00009768, &amp;                         <a name='805'>
          0.16412200,0.16387400,0.15211500,0.13062200, &amp;                         <a name='806'>
          0.11325100,0.09348130,0.07381380,0.05434740, &amp;                         <a name='807'>
          0.03803160,0.00481346,0.00393592,0.00296633, &amp;                         <a name='808'>
          0.00222532,0.00163762,0.00066648,0.00009768, &amp;                         <a name='809'>
          0.15513401,0.15768200,0.14850400,0.13330200, &amp;                         <a name='810'>
          0.11446500,0.09868230,0.07642050,0.05624170, &amp;                         <a name='811'>
          0.04197810,0.00502288,0.00429452,0.00315347, &amp;                         <a name='812'>
          0.00263559,0.00171772,0.00066860,0.00009768, &amp;                         <a name='813'>
          0.15732600,0.15223300,0.14271900,0.13563600, &amp;                         <a name='814'>
          0.11859600,0.10274200,0.07934560,0.05763410, &amp;                         <a name='815'>
          0.03921740,0.00437741,0.00337921,0.00280212, &amp;                         <a name='816'>
          0.00200156,0.00124812,0.00064664,0.00009768/                           <a name='817'>
                                                                                 <a name='818'>
<font color=#447700>! Data                                                                           <a name='819'></font>
                                                                                 <a name='820'>
      DATA FRACREFA14/ &amp;                                                             <a name='821'>
<font color=#447700>!     From P = 1053.6 mb.                                                        <a name='822'></font>
          0.18446200,0.16795200,0.14949700,0.12036000, &amp;                         <a name='823'>
          0.10440100,0.09024280,0.07435880,0.05629380, &amp;                         <a name='824'>
          0.03825420,0.00417276,0.00345278,0.00272949, &amp;                         <a name='825'>
          0.00200378,0.00127404,0.00050721,0.00004141/                           <a name='826'>
      DATA FRACREFB14/ &amp;                                                             <a name='827'>
<font color=#447700>!     From P = 0.64 mb.                                                          <a name='828'></font>
          0.19128500,0.16495700,0.14146100,0.11904500, &amp;                         <a name='829'>
          0.10350200,0.09151190,0.07604270,0.05806020, &amp;                         <a name='830'>
          0.03979950,0.00423959,0.00357439,0.00287559, &amp;                         <a name='831'>
          0.00198860,0.00116529,0.00043616,0.00005987/                           <a name='832'>
                                                                                 <a name='833'>
<font color=#447700>! Data                                                                           <a name='834'></font>
                                                                                 <a name='835'>
      DATA FRACREFA15/ &amp;                                                             <a name='836'>
<font color=#447700>!     From P = 1053.6 mb.                                                        <a name='837'></font>
          0.11287100,0.12070200,0.12729000,0.12858100, &amp;                         <a name='838'>
          0.12743001,0.11961800,0.10290400,0.07888980, &amp;                         <a name='839'>
          0.05900120,0.00667979,0.00552926,0.00436993, &amp;                         <a name='840'>
          0.00320611,0.00204765,0.00077371,0.00010894, &amp;                         <a name='841'>
          0.13918801,0.16353001,0.16155800,0.14090499, &amp;                         <a name='842'>
          0.11322300,0.08757720,0.07225720,0.05173390, &amp;                         <a name='843'>
          0.04731360,0.00667979,0.00552926,0.00436993, &amp;                         <a name='844'>
          0.00320611,0.00204765,0.00077371,0.00010894, &amp;                         <a name='845'>
          0.14687300,0.17853101,0.15664500,0.13351700, &amp;                         <a name='846'>
          0.10791200,0.08684320,0.07158090,0.05198410, &amp;                         <a name='847'>
          0.04340110,0.00667979,0.00552926,0.00436993, &amp;                         <a name='848'>
          0.00320611,0.00204765,0.00077371,0.00010894, &amp;                         <a name='849'>
          0.15760700,0.17759100,0.15158001,0.13193300, &amp;                         <a name='850'>
          0.10742800,0.08693760,0.07159490,0.05196250, &amp;                         <a name='851'>
          0.04065270,0.00667979,0.00552926,0.00436993, &amp;                         <a name='852'>
          0.00320611,0.00204765,0.00077371,0.00010894, &amp;                         <a name='853'>
          0.16646700,0.17299300,0.15018500,0.13138700, &amp;                         <a name='854'>
          0.10735900,0.08713110,0.07130330,0.05279420, &amp;                         <a name='855'>
          0.03766730,0.00667979,0.00552926,0.00436993, &amp;                         <a name='856'>
          0.00320611,0.00204765,0.00077371,0.00010894, &amp;                         <a name='857'>
          0.17546000,0.16666500,0.14969499,0.13105400, &amp;                         <a name='858'>
          0.10782500,0.08718610,0.07156770,0.05308320, &amp;                         <a name='859'>
          0.03753960,0.00432465,0.00509623,0.00436993, &amp;                         <a name='860'>
          0.00320611,0.00204765,0.00077371,0.00010894, &amp;                         <a name='861'>
          0.18378501,0.16064601,0.14940400,0.13146400, &amp;                         <a name='862'>
          0.10810300,0.08775740,0.07115360,0.05400040, &amp;                         <a name='863'>
          0.03689970,0.00388333,0.00323610,0.00353414, &amp;                         <a name='864'>
          0.00320611,0.00204765,0.00077371,0.00010894, &amp;                         <a name='865'>
          0.18966800,0.15744300,0.14993000,0.13152599, &amp;                         <a name='866'>
          0.10899200,0.08858690,0.07142920,0.05399600, &amp;                         <a name='867'>
          0.03433460,0.00374886,0.00302066,0.00240653, &amp;                         <a name='868'>
          0.00199205,0.00204765,0.00077371,0.00010894, &amp;                         <a name='869'>
          0.11887100,0.12479600,0.12569501,0.12839900, &amp;                         <a name='870'>
          0.12473500,0.12012800,0.11086700,0.08493590, &amp;                         <a name='871'>
          0.05063770,0.00328723,0.00266849,0.00210232, &amp;                         <a name='872'>
          0.00152114,0.00095635,0.00035374,0.00004980/                           <a name='873'>
                                                                                 <a name='874'>
<font color=#447700>! Data                                                                           <a name='875'></font>
                                                                                 <a name='876'>
      DATA FRACREFA16/ &amp;                                                             <a name='877'>
<font color=#447700>!     From P = 862.6 mb.                                                         <a name='878'></font>
          0.17356300,0.18880001,0.17704099,0.13661300, &amp;                         <a name='879'>
          0.10691600,0.08222480,0.05939860,0.04230810, &amp;                         <a name='880'>
          0.02526330,0.00244532,0.00193541,0.00150415, &amp;                         <a name='881'>
          0.00103528,0.00067068,0.00024951,0.00003348, &amp;                         <a name='882'>
          0.17779499,0.19837400,0.16557600,0.13470000, &amp;                         <a name='883'>
          0.11013600,0.08342720,0.05987030,0.03938700, &amp;                         <a name='884'>
          0.02293650,0.00238849,0.00192400,0.00149921, &amp;                         <a name='885'>
          0.00103539,0.00067150,0.00024822,0.00003348, &amp;                         <a name='886'>
          0.18535601,0.19407199,0.16053200,0.13300700, &amp;                         <a name='887'>
          0.10779000,0.08408500,0.06480450,0.04070160, &amp;                         <a name='888'>
          0.02203590,0.00227779,0.00189074,0.00146888, &amp;                         <a name='889'>
          0.00103147,0.00066770,0.00024751,0.00003348, &amp;                         <a name='890'>
          0.19139200,0.18917400,0.15748601,0.13240699, &amp;                         <a name='891'>
          0.10557300,0.08383260,0.06724060,0.04364450, &amp;                         <a name='892'>
          0.02175820,0.00225436,0.00184421,0.00143153, &amp;                         <a name='893'>
          0.00103027,0.00066066,0.00024222,0.00003148, &amp;                         <a name='894'>
          0.19547801,0.18539500,0.15442000,0.13114899, &amp;                         <a name='895'>
          0.10515600,0.08350350,0.06909780,0.04671630, &amp;                         <a name='896'>
          0.02168820,0.00224400,0.00182009,0.00139098, &amp;                         <a name='897'>
          0.00102582,0.00065367,0.00023202,0.00003148, &amp;                         <a name='898'>
          0.19757500,0.18266800,0.15208900,0.12897800, &amp;                         <a name='899'>
          0.10637200,0.08391220,0.06989830,0.04964120, &amp;                         <a name='900'>
          0.02155800,0.00224310,0.00177358,0.00138184, &amp;                         <a name='901'>
          0.00101538,0.00063370,0.00023227,0.00003148, &amp;                         <a name='902'>
          0.20145500,0.17692900,0.14940600,0.12690400, &amp;                         <a name='903'>
          0.10828800,0.08553720,0.07004940,0.05153430, &amp;                         <a name='904'>
          0.02268740,0.00216943,0.00178603,0.00137754, &amp;                         <a name='905'>
          0.00098344,0.00063165,0.00023218,0.00003148, &amp;                         <a name='906'>
          0.20383500,0.17047501,0.14570600,0.12679300, &amp;                         <a name='907'>
          0.11043100,0.08719150,0.07045440,0.05345420, &amp;                         <a name='908'>
          0.02448340,0.00215839,0.00175893,0.00138296, &amp;                         <a name='909'>
          0.00098318,0.00063188,0.00023199,0.00003148, &amp;                         <a name='910'>
          0.18680701,0.15961801,0.15092900,0.13049100, &amp;                         <a name='911'>
          0.11418400,0.09380540,0.07093450,0.05664280, &amp;                         <a name='912'>
          0.02938410,0.00217751,0.00176766,0.00138275, &amp;                         <a name='913'>
          0.00098377,0.00063181,0.00023193,0.00003148/                           <a name='914'>
               <a name='915'>
<a name='916'>
<font color=#447700>!<a name='917'></font>
<font color=#447700>! end of data 3<a name='918'></font>
<font color=#447700>!<a name='919'></font>
<a name='920'>
<font color=#447700>!-----------------------------------------------------------------------<a name='921'></font>
<a name='922'>
<font color=#447700>! start data 4<a name='923'></font>
<a name='924'>
      DATA NXMOL  /2/<a name='925'>
      DATA IXINDX /0,2,3,0,31*0/<a name='926'>
                                                                  <a name='927'>
<font color=#447700>!<a name='928'></font>
<font color=#447700>! end of data 4<a name='929'></font>
<font color=#447700>!<a name='930'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='931'></font>
<a name='932'>
<font color=#447700>! start data 5<a name='933'></font>
                                                                  <a name='934'>
<font color=#447700>!     <a name='935'></font>
<font color=#447700>!  Longwave spectral band data                                                   <a name='936'></font>
<a name='937'>
      DATA WAVENUM1(1) /10./, WAVENUM2(1) /250./, DELWAVE(1) /240./              <a name='938'>
      DATA WAVENUM1(2) /250./, WAVENUM2(2) /500./, DELWAVE(2) /250./             <a name='939'>
      DATA WAVENUM1(3) /500./, WAVENUM2(3) /630./, DELWAVE(3) /130./             <a name='940'>
      DATA WAVENUM1(4) /630./, WAVENUM2(4) /700./, DELWAVE(4) /70./              <a name='941'>
      DATA WAVENUM1(5) /700./, WAVENUM2(5) /820./, DELWAVE(5) /120./             <a name='942'>
      DATA WAVENUM1(6) /820./, WAVENUM2(6) /980./, DELWAVE(6) /160./             <a name='943'>
      DATA WAVENUM1(7) /980./, WAVENUM2(7) /1080./, DELWAVE(7) /100./            <a name='944'>
      DATA WAVENUM1(8) /1080./, WAVENUM2(8) /1180./, DELWAVE(8) /100./           <a name='945'>
      DATA WAVENUM1(9) /1180./, WAVENUM2(9) /1390./, DELWAVE(9) /210./           <a name='946'>
      DATA WAVENUM1(10) /1390./,WAVENUM2(10) /1480./,DELWAVE(10) /90./           <a name='947'>
      DATA WAVENUM1(11) /1480./,WAVENUM2(11) /1800./,DELWAVE(11) /320./          <a name='948'>
      DATA WAVENUM1(12) /1800./,WAVENUM2(12) /2080./,DELWAVE(12) /280./          <a name='949'>
      DATA WAVENUM1(13) /2080./,WAVENUM2(13) /2250./,DELWAVE(13) /170./          <a name='950'>
      DATA WAVENUM1(14) /2250./,WAVENUM2(14) /2380./,DELWAVE(14) /130./          <a name='951'>
      DATA WAVENUM1(15) /2380./,WAVENUM2(15) /2600./,DELWAVE(15) /220./          <a name='952'>
      DATA WAVENUM1(16) /2600./,WAVENUM2(16) /3000./,DELWAVE(16) /400./          <a name='953'>
                                                                                 <a name='954'>
<font color=#447700>!<a name='955'></font>
<font color=#447700>! end of data 5<a name='956'></font>
<font color=#447700>!<a name='957'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='958'></font>
<a name='959'>
<font color=#447700>! start data 6<a name='960'></font>
<a name='961'>
              <a name='962'>
      DATA NG  /16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16/                 <a name='963'>
      DATA NSPA /1, 1,10, 9, 9, 1, 9, 1,11, 1, 1, 9, 9, 1, 9, 9/                 <a name='964'>
      DATA NSPB /1, 1, 5, 6, 5, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0/                 <a name='965'>
                                                                                 <a name='966'>
<font color=#447700>!     HEATFAC is the factor by which one must multiply delta-flux/               <a name='967'></font>
<font color=#447700>!     delta-pressure, with flux in w/m-2 and pressure in mbar, to get            <a name='968'></font>
<font color=#447700>!     the heating rate in units of degrees/day.  It is equal to                  <a name='969'></font>
<font color=#447700>!           (g)x(#sec/day)x(1e-5)/(specific heat of air at const. p)             <a name='970'></font>
<font color=#447700>!        =  (9.8066)(3600)(1e-5)/(1.004)                                         <a name='971'></font>
<a name='972'>
      DATA HEATFAC /8.4391/                                                      <a name='973'>
                                                                           <a name='974'>
<font color=#447700>!     These pressures are chosen such that the ln of the first pressure          <a name='975'></font>
<font color=#447700>!     has only a few non-zero digits (i.e. ln(PREF(1)) = 6.96000) and            <a name='976'></font>
<font color=#447700>!     each subsequent ln(pressure) differs from the previous one by 0.2.         <a name='977'></font>
<a name='978'>
      DATA PREF / &amp;                                                                 <a name='979'>
          1.05363E+03,8.62642E+02,7.06272E+02,5.78246E+02,4.73428E+02, &amp; <a name='980'>
          3.87610E+02,3.17348E+02,2.59823E+02,2.12725E+02,1.74164E+02, &amp; <a name='981'>
          1.42594E+02,1.16746E+02,9.55835E+01,7.82571E+01,6.40715E+01, &amp; <a name='982'>
          5.24573E+01,4.29484E+01,3.51632E+01,2.87892E+01,2.35706E+01, &amp; <a name='983'>
          1.92980E+01,1.57998E+01,1.29358E+01,1.05910E+01,8.67114E+00, &amp; <a name='984'>
          7.09933E+00,5.81244E+00,4.75882E+00,3.89619E+00,3.18993E+00, &amp; <a name='985'>
          2.61170E+00,2.13828E+00,1.75067E+00,1.43333E+00,1.17351E+00, &amp; <a name='986'>
          9.60789E-01,7.86628E-01,6.44036E-01,5.27292E-01,4.31710E-01, &amp; <a name='987'>
          3.53455E-01,2.89384E-01,2.36928E-01,1.93980E-01,1.58817E-01, &amp; <a name='988'>
          1.30029E-01,1.06458E-01,8.71608E-02,7.13612E-02,5.84256E-02, &amp; <a name='989'>
          4.78349E-02,3.91639E-02,3.20647E-02,2.62523E-02,2.14936E-02, &amp; <a name='990'>
          1.75975E-02,1.44076E-02,1.17959E-02,9.65769E-03/                       <a name='991'>
      DATA PREFLOG / &amp;                                                              <a name='992'>
           6.9600E+00, 6.7600E+00, 6.5600E+00, 6.3600E+00, 6.1600E+00, &amp; <a name='993'>
           5.9600E+00, 5.7600E+00, 5.5600E+00, 5.3600E+00, 5.1600E+00, &amp; <a name='994'>
           4.9600E+00, 4.7600E+00, 4.5600E+00, 4.3600E+00, 4.1600E+00, &amp; <a name='995'>
           3.9600E+00, 3.7600E+00, 3.5600E+00, 3.3600E+00, 3.1600E+00, &amp; <a name='996'>
           2.9600E+00, 2.7600E+00, 2.5600E+00, 2.3600E+00, 2.1600E+00, &amp; <a name='997'>
           1.9600E+00, 1.7600E+00, 1.5600E+00, 1.3600E+00, 1.1600E+00, &amp; <a name='998'>
           9.6000E-01, 7.6000E-01, 5.6000E-01, 3.6000E-01, 1.6000E-01, &amp; <a name='999'>
          -4.0000E-02,-2.4000E-01,-4.4000E-01,-6.4000E-01,-8.4000E-01, &amp; <a name='1000'>
          -1.0400E+00,-1.2400E+00,-1.4400E+00,-1.6400E+00,-1.8400E+00, &amp; <a name='1001'>
          -2.0400E+00,-2.2400E+00,-2.4400E+00,-2.6400E+00,-2.8400E+00, &amp; <a name='1002'>
          -3.0400E+00,-3.2400E+00,-3.4400E+00,-3.6400E+00,-3.8400E+00, &amp; <a name='1003'>
          -4.0400E+00,-4.2400E+00,-4.4400E+00,-4.6400E+00/                       <a name='1004'>
<font color=#447700>!     These are the temperatures associated with the respective                  <a name='1005'></font>
<font color=#447700>!     pressures for the MLS standard atmosphere.                                 <a name='1006'></font>
      DATA TREF / &amp;                                                                 <a name='1007'>
           2.9420E+02, 2.8799E+02, 2.7894E+02, 2.6925E+02, 2.5983E+02, &amp; <a name='1008'>
           2.5017E+02, 2.4077E+02, 2.3179E+02, 2.2306E+02, 2.1578E+02, &amp; <a name='1009'>
           2.1570E+02, 2.1570E+02, 2.1570E+02, 2.1706E+02, 2.1858E+02, &amp; <a name='1010'>
           2.2018E+02, 2.2174E+02, 2.2328E+02, 2.2479E+02, 2.2655E+02, &amp; <a name='1011'>
           2.2834E+02, 2.3113E+02, 2.3401E+02, 2.3703E+02, 2.4022E+02, &amp; <a name='1012'>
           2.4371E+02, 2.4726E+02, 2.5085E+02, 2.5457E+02, 2.5832E+02, &amp; <a name='1013'>
           2.6216E+02, 2.6606E+02, 2.6999E+02, 2.7340E+02, 2.7536E+02, &amp; <a name='1014'>
           2.7568E+02, 2.7372E+02, 2.7163E+02, 2.6955E+02, 2.6593E+02, &amp; <a name='1015'>
           2.6211E+02, 2.5828E+02, 2.5360E+02, 2.4854E+02, 2.4348E+02, &amp; <a name='1016'>
           2.3809E+02, 2.3206E+02, 2.2603E+02, 2.2000E+02, 2.1435E+02, &amp; <a name='1017'>
           2.0887E+02, 2.0340E+02, 1.9792E+02, 1.9290E+02, 1.8809E+02, &amp; <a name='1018'>
           1.8329E+02, 1.7849E+02, 1.7394E+02, 1.7212E+02/                       <a name='1019'>
                                                                                 <a name='1020'>
<font color=#447700>!<a name='1021'></font>
<font color=#447700>! end of data 6<a name='1022'></font>
<font color=#447700>!<a name='1023'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='1024'></font>
<a name='1025'>
<font color=#447700>! start data 7<a name='1026'></font>
<a name='1027'>
      DATA (TOTPLNK(IDATA, 1),IDATA=1,50)/ &amp;                                                <a name='1028'>
      1.13735E-06,1.15150E-06,1.16569E-06,1.17992E-06,1.19419E-06, &amp; <a name='1029'>
      1.20850E-06,1.22285E-06,1.23723E-06,1.25164E-06,1.26610E-06, &amp; <a name='1030'>
      1.28059E-06,1.29511E-06,1.30967E-06,1.32426E-06,1.33889E-06, &amp; <a name='1031'>
      1.35355E-06,1.36824E-06,1.38296E-06,1.39772E-06,1.41250E-06, &amp; <a name='1032'>
      1.42732E-06,1.44217E-06,1.45704E-06,1.47195E-06,1.48689E-06, &amp; <a name='1033'>
      1.50185E-06,1.51684E-06,1.53186E-06,1.54691E-06,1.56198E-06, &amp; <a name='1034'>
      1.57709E-06,1.59222E-06,1.60737E-06,1.62255E-06,1.63776E-06, &amp; <a name='1035'>
      1.65299E-06,1.66825E-06,1.68352E-06,1.69883E-06,1.71416E-06, &amp; <a name='1036'>
      1.72951E-06,1.74488E-06,1.76028E-06,1.77570E-06,1.79114E-06, &amp; <a name='1037'>
      1.80661E-06,1.82210E-06,1.83760E-06,1.85313E-06,1.86868E-06/               <a name='1038'>
      DATA (TOTPLNK(IDATA, 1),IDATA=51,100)/ &amp;                                              <a name='1039'>
      1.88425E-06,1.89985E-06,1.91546E-06,1.93109E-06,1.94674E-06, &amp; <a name='1040'>
      1.96241E-06,1.97811E-06,1.99381E-06,2.00954E-06,2.02529E-06, &amp; <a name='1041'>
      2.04105E-06,2.05684E-06,2.07264E-06,2.08846E-06,2.10429E-06, &amp; <a name='1042'>
      2.12015E-06,2.13602E-06,2.15190E-06,2.16781E-06,2.18373E-06, &amp; <a name='1043'>
      2.19966E-06,2.21562E-06,2.23159E-06,2.24758E-06,2.26358E-06, &amp; <a name='1044'>
      2.27959E-06,2.29562E-06,2.31167E-06,2.32773E-06,2.34381E-06, &amp; <a name='1045'>
      2.35990E-06,2.37601E-06,2.39212E-06,2.40825E-06,2.42440E-06, &amp; <a name='1046'>
      2.44056E-06,2.45673E-06,2.47292E-06,2.48912E-06,2.50533E-06, &amp; <a name='1047'>
      2.52157E-06,2.53781E-06,2.55406E-06,2.57032E-06,2.58660E-06, &amp; <a name='1048'>
      2.60289E-06,2.61919E-06,2.63550E-06,2.65183E-06,2.66817E-06/               <a name='1049'>
      DATA (TOTPLNK(IDATA, 1),IDATA=101,150)/ &amp;                                             <a name='1050'>
      2.68452E-06,2.70088E-06,2.71726E-06,2.73364E-06,2.75003E-06, &amp; <a name='1051'>
      2.76644E-06,2.78286E-06,2.79929E-06,2.81572E-06,2.83218E-06, &amp; <a name='1052'>
      2.84864E-06,2.86510E-06,2.88159E-06,2.89807E-06,2.91458E-06, &amp; <a name='1053'>
      2.93109E-06,2.94762E-06,2.96415E-06,2.98068E-06,2.99724E-06, &amp; <a name='1054'>
      3.01379E-06,3.03036E-06,3.04693E-06,3.06353E-06,3.08013E-06, &amp; <a name='1055'>
      3.09674E-06,3.11335E-06,3.12998E-06,3.14661E-06,3.16324E-06, &amp; <a name='1056'>
      3.17989E-06,3.19656E-06,3.21323E-06,3.22991E-06,3.24658E-06, &amp; <a name='1057'>
      3.26328E-06,3.27998E-06,3.29669E-06,3.31341E-06,3.33013E-06, &amp; <a name='1058'>
      3.34686E-06,3.36360E-06,3.38034E-06,3.39709E-06,3.41387E-06, &amp; <a name='1059'>
      3.43063E-06,3.44742E-06,3.46420E-06,3.48099E-06,3.49779E-06/               <a name='1060'>
      DATA (TOTPLNK(IDATA, 1),IDATA=151,181)/ &amp;                                             <a name='1061'>
      3.51461E-06,3.53141E-06,3.54824E-06,3.56506E-06,3.58191E-06, &amp; <a name='1062'>
      3.59875E-06,3.61559E-06,3.63244E-06,3.64931E-06,3.66617E-06, &amp; <a name='1063'>
      3.68305E-06,3.69992E-06,3.71682E-06,3.73372E-06,3.75061E-06, &amp; <a name='1064'>
      3.76753E-06,3.78443E-06,3.80136E-06,3.81829E-06,3.83522E-06, &amp; <a name='1065'>
      3.85215E-06,3.86910E-06,3.88605E-06,3.90301E-06,3.91997E-06, &amp; <a name='1066'>
      3.93694E-06,3.95390E-06,3.97087E-06,3.98788E-06,4.00485E-06, &amp; <a name='1067'>
      4.02187E-06/                                                               <a name='1068'>
      DATA (TOTPLNK(IDATA, 2),IDATA=1,50)/ &amp;                                                <a name='1069'>
      2.13441E-06,2.18076E-06,2.22758E-06,2.27489E-06,2.32268E-06, &amp; <a name='1070'>
      2.37093E-06,2.41966E-06,2.46886E-06,2.51852E-06,2.56864E-06, &amp; <a name='1071'>
      2.61922E-06,2.67026E-06,2.72175E-06,2.77370E-06,2.82609E-06, &amp; <a name='1072'>
      2.87893E-06,2.93221E-06,2.98593E-06,3.04008E-06,3.09468E-06, &amp; <a name='1073'>
      3.14970E-06,3.20515E-06,3.26103E-06,3.31732E-06,3.37404E-06, &amp; <a name='1074'>
      3.43118E-06,3.48873E-06,3.54669E-06,3.60506E-06,3.66383E-06, &amp; <a name='1075'>
      3.72301E-06,3.78259E-06,3.84256E-06,3.90293E-06,3.96368E-06, &amp; <a name='1076'>
      4.02483E-06,4.08636E-06,4.14828E-06,4.21057E-06,4.27324E-06, &amp; <a name='1077'>
      4.33629E-06,4.39971E-06,4.46350E-06,4.52765E-06,4.59217E-06, &amp; <a name='1078'>
      4.65705E-06,4.72228E-06,4.78787E-06,4.85382E-06,4.92011E-06/               <a name='1079'>
      DATA (TOTPLNK(IDATA, 2),IDATA=51,100)/ &amp;                                              <a name='1080'>
      4.98675E-06,5.05374E-06,5.12106E-06,5.18873E-06,5.25674E-06, &amp; <a name='1081'>
      5.32507E-06,5.39374E-06,5.46274E-06,5.53207E-06,5.60172E-06, &amp; <a name='1082'>
      5.67169E-06,5.74198E-06,5.81259E-06,5.88352E-06,5.95475E-06, &amp; <a name='1083'>
      6.02629E-06,6.09815E-06,6.17030E-06,6.24276E-06,6.31552E-06, &amp; <a name='1084'>
      6.38858E-06,6.46192E-06,6.53557E-06,6.60950E-06,6.68373E-06, &amp; <a name='1085'>
      6.75824E-06,6.83303E-06,6.90810E-06,6.98346E-06,7.05909E-06, &amp; <a name='1086'>
      7.13500E-06,7.21117E-06,7.28763E-06,7.36435E-06,7.44134E-06, &amp; <a name='1087'>
      7.51859E-06,7.59611E-06,7.67388E-06,7.75192E-06,7.83021E-06, &amp; <a name='1088'>
      7.90875E-06,7.98755E-06,8.06660E-06,8.14589E-06,8.22544E-06, &amp; <a name='1089'>
      8.30522E-06,8.38526E-06,8.46553E-06,8.54604E-06,8.62679E-06/               <a name='1090'>
      DATA (TOTPLNK(IDATA, 2),IDATA=101,150)/ &amp;                                             <a name='1091'>
      8.70777E-06,8.78899E-06,8.87043E-06,8.95211E-06,9.03402E-06, &amp; <a name='1092'>
      9.11616E-06,9.19852E-06,9.28109E-06,9.36390E-06,9.44692E-06, &amp; <a name='1093'>
      9.53015E-06,9.61361E-06,9.69729E-06,9.78117E-06,9.86526E-06, &amp; <a name='1094'>
      9.94957E-06,1.00341E-05,1.01188E-05,1.02037E-05,1.02888E-05, &amp; <a name='1095'>
      1.03742E-05,1.04597E-05,1.05454E-05,1.06313E-05,1.07175E-05, &amp; <a name='1096'>
      1.08038E-05,1.08903E-05,1.09770E-05,1.10639E-05,1.11509E-05, &amp; <a name='1097'>
      1.12382E-05,1.13257E-05,1.14133E-05,1.15011E-05,1.15891E-05, &amp; <a name='1098'>
      1.16773E-05,1.17656E-05,1.18542E-05,1.19429E-05,1.20317E-05, &amp; <a name='1099'>
      1.21208E-05,1.22100E-05,1.22994E-05,1.23890E-05,1.24787E-05, &amp; <a name='1100'>
      1.25686E-05,1.26587E-05,1.27489E-05,1.28393E-05,1.29299E-05/               <a name='1101'>
      DATA (TOTPLNK(IDATA, 2),IDATA=151,181)/ &amp;                                             <a name='1102'>
      1.30206E-05,1.31115E-05,1.32025E-05,1.32937E-05,1.33850E-05, &amp; <a name='1103'>
      1.34765E-05,1.35682E-05,1.36600E-05,1.37520E-05,1.38441E-05, &amp; <a name='1104'>
      1.39364E-05,1.40288E-05,1.41213E-05,1.42140E-05,1.43069E-05, &amp; <a name='1105'>
      1.43999E-05,1.44930E-05,1.45863E-05,1.46797E-05,1.47733E-05, &amp; <a name='1106'>
      1.48670E-05,1.49608E-05,1.50548E-05,1.51489E-05,1.52431E-05, &amp; <a name='1107'>
      1.53375E-05,1.54320E-05,1.55267E-05,1.56214E-05,1.57164E-05, &amp; <a name='1108'>
      1.58114E-05/                                                               <a name='1109'>
      DATA (TOTPLNK(IDATA, 3),IDATA=1,50)/ &amp;                                                <a name='1110'>
      1.34822E-06,1.39134E-06,1.43530E-06,1.48010E-06,1.52574E-06, &amp; <a name='1111'>
      1.57222E-06,1.61956E-06,1.66774E-06,1.71678E-06,1.76666E-06, &amp; <a name='1112'>
      1.81741E-06,1.86901E-06,1.92147E-06,1.97479E-06,2.02898E-06, &amp; <a name='1113'>
      2.08402E-06,2.13993E-06,2.19671E-06,2.25435E-06,2.31285E-06, &amp; <a name='1114'>
      2.37222E-06,2.43246E-06,2.49356E-06,2.55553E-06,2.61837E-06, &amp; <a name='1115'>
      2.68207E-06,2.74664E-06,2.81207E-06,2.87837E-06,2.94554E-06, &amp; <a name='1116'>
      3.01356E-06,3.08245E-06,3.15221E-06,3.22282E-06,3.29429E-06, &amp; <a name='1117'>
      3.36662E-06,3.43982E-06,3.51386E-06,3.58876E-06,3.66451E-06, &amp; <a name='1118'>
      3.74112E-06,3.81857E-06,3.89688E-06,3.97602E-06,4.05601E-06, &amp; <a name='1119'>
      4.13685E-06,4.21852E-06,4.30104E-06,4.38438E-06,4.46857E-06/               <a name='1120'>
      DATA (TOTPLNK(IDATA, 3),IDATA=51,100)/ &amp;                                              <a name='1121'>
      4.55358E-06,4.63943E-06,4.72610E-06,4.81359E-06,4.90191E-06, &amp; <a name='1122'>
      4.99105E-06,5.08100E-06,5.17176E-06,5.26335E-06,5.35573E-06, &amp; <a name='1123'>
      5.44892E-06,5.54292E-06,5.63772E-06,5.73331E-06,5.82970E-06, &amp; <a name='1124'>
      5.92688E-06,6.02485E-06,6.12360E-06,6.22314E-06,6.32346E-06, &amp; <a name='1125'>
      6.42455E-06,6.52641E-06,6.62906E-06,6.73247E-06,6.83664E-06, &amp; <a name='1126'>
      6.94156E-06,7.04725E-06,7.15370E-06,7.26089E-06,7.36883E-06, &amp; <a name='1127'>
      7.47752E-06,7.58695E-06,7.69712E-06,7.80801E-06,7.91965E-06, &amp; <a name='1128'>
      8.03201E-06,8.14510E-06,8.25891E-06,8.37343E-06,8.48867E-06, &amp; <a name='1129'>
      8.60463E-06,8.72128E-06,8.83865E-06,8.95672E-06,9.07548E-06, &amp; <a name='1130'>
      9.19495E-06,9.31510E-06,9.43594E-06,9.55745E-06,9.67966E-06/               <a name='1131'>
      DATA (TOTPLNK(IDATA, 3),IDATA=101,150)/ &amp;                                             <a name='1132'>
      9.80254E-06,9.92609E-06,1.00503E-05,1.01752E-05,1.03008E-05, &amp; <a name='1133'>
      1.04270E-05,1.05539E-05,1.06814E-05,1.08096E-05,1.09384E-05, &amp; <a name='1134'>
      1.10679E-05,1.11980E-05,1.13288E-05,1.14601E-05,1.15922E-05, &amp; <a name='1135'>
      1.17248E-05,1.18581E-05,1.19920E-05,1.21265E-05,1.22616E-05, &amp; <a name='1136'>
      1.23973E-05,1.25337E-05,1.26706E-05,1.28081E-05,1.29463E-05, &amp; <a name='1137'>
      1.30850E-05,1.32243E-05,1.33642E-05,1.35047E-05,1.36458E-05, &amp; <a name='1138'>
      1.37875E-05,1.39297E-05,1.40725E-05,1.42159E-05,1.43598E-05, &amp; <a name='1139'>
      1.45044E-05,1.46494E-05,1.47950E-05,1.49412E-05,1.50879E-05, &amp; <a name='1140'>
      1.52352E-05,1.53830E-05,1.55314E-05,1.56803E-05,1.58297E-05, &amp; <a name='1141'>
      1.59797E-05,1.61302E-05,1.62812E-05,1.64327E-05,1.65848E-05/               <a name='1142'>
      DATA (TOTPLNK(IDATA, 3),IDATA=151,181)/ &amp;                                             <a name='1143'>
      1.67374E-05,1.68904E-05,1.70441E-05,1.71982E-05,1.73528E-05, &amp; <a name='1144'>
      1.75079E-05,1.76635E-05,1.78197E-05,1.79763E-05,1.81334E-05, &amp; <a name='1145'>
      1.82910E-05,1.84491E-05,1.86076E-05,1.87667E-05,1.89262E-05, &amp; <a name='1146'>
      1.90862E-05,1.92467E-05,1.94076E-05,1.95690E-05,1.97309E-05, &amp; <a name='1147'>
      1.98932E-05,2.00560E-05,2.02193E-05,2.03830E-05,2.05472E-05, &amp; <a name='1148'>
      2.07118E-05,2.08768E-05,2.10423E-05,2.12083E-05,2.13747E-05, &amp; <a name='1149'>
      2.15414E-05/                                                               <a name='1150'>
      DATA (TOTPLNK(IDATA, 4),IDATA=1,50)/ &amp;                                                <a name='1151'>
      8.90528E-07,9.24222E-07,9.58757E-07,9.94141E-07,1.03038E-06, &amp; <a name='1152'>
      1.06748E-06,1.10545E-06,1.14430E-06,1.18403E-06,1.22465E-06, &amp; <a name='1153'>
      1.26618E-06,1.30860E-06,1.35193E-06,1.39619E-06,1.44136E-06, &amp; <a name='1154'>
      1.48746E-06,1.53449E-06,1.58246E-06,1.63138E-06,1.68124E-06, &amp; <a name='1155'>
      1.73206E-06,1.78383E-06,1.83657E-06,1.89028E-06,1.94495E-06, &amp; <a name='1156'>
      2.00060E-06,2.05724E-06,2.11485E-06,2.17344E-06,2.23303E-06, &amp; <a name='1157'>
      2.29361E-06,2.35519E-06,2.41777E-06,2.48134E-06,2.54592E-06, &amp; <a name='1158'>
      2.61151E-06,2.67810E-06,2.74571E-06,2.81433E-06,2.88396E-06, &amp; <a name='1159'>
      2.95461E-06,3.02628E-06,3.09896E-06,3.17267E-06,3.24741E-06, &amp; <a name='1160'>
      3.32316E-06,3.39994E-06,3.47774E-06,3.55657E-06,3.63642E-06/               <a name='1161'>
      DATA (TOTPLNK(IDATA, 4),IDATA=51,100)/ &amp;                                              <a name='1162'>
      3.71731E-06,3.79922E-06,3.88216E-06,3.96612E-06,4.05112E-06, &amp; <a name='1163'>
      4.13714E-06,4.22419E-06,4.31227E-06,4.40137E-06,4.49151E-06, &amp; <a name='1164'>
      4.58266E-06,4.67485E-06,4.76806E-06,4.86229E-06,4.95754E-06, &amp; <a name='1165'>
      5.05383E-06,5.15113E-06,5.24946E-06,5.34879E-06,5.44916E-06, &amp; <a name='1166'>
      5.55053E-06,5.65292E-06,5.75632E-06,5.86073E-06,5.96616E-06, &amp; <a name='1167'>
      6.07260E-06,6.18003E-06,6.28848E-06,6.39794E-06,6.50838E-06, &amp; <a name='1168'>
      6.61983E-06,6.73229E-06,6.84573E-06,6.96016E-06,7.07559E-06, &amp; <a name='1169'>
      7.19200E-06,7.30940E-06,7.42779E-06,7.54715E-06,7.66749E-06, &amp; <a name='1170'>
      7.78882E-06,7.91110E-06,8.03436E-06,8.15859E-06,8.28379E-06, &amp; <a name='1171'>
      8.40994E-06,8.53706E-06,8.66515E-06,8.79418E-06,8.92416E-06/               <a name='1172'>
      DATA (TOTPLNK(IDATA, 4),IDATA=101,150)/ &amp;                                             <a name='1173'>
      9.05510E-06,9.18697E-06,9.31979E-06,9.45356E-06,9.58826E-06, &amp; <a name='1174'>
      9.72389E-06,9.86046E-06,9.99793E-06,1.01364E-05,1.02757E-05, &amp; <a name='1175'>
      1.04159E-05,1.05571E-05,1.06992E-05,1.08422E-05,1.09861E-05, &amp; <a name='1176'>
      1.11309E-05,1.12766E-05,1.14232E-05,1.15707E-05,1.17190E-05, &amp; <a name='1177'>
      1.18683E-05,1.20184E-05,1.21695E-05,1.23214E-05,1.24741E-05, &amp; <a name='1178'>
      1.26277E-05,1.27822E-05,1.29376E-05,1.30939E-05,1.32509E-05, &amp; <a name='1179'>
      1.34088E-05,1.35676E-05,1.37273E-05,1.38877E-05,1.40490E-05, &amp; <a name='1180'>
      1.42112E-05,1.43742E-05,1.45380E-05,1.47026E-05,1.48680E-05, &amp; <a name='1181'>
      1.50343E-05,1.52014E-05,1.53692E-05,1.55379E-05,1.57074E-05, &amp; <a name='1182'>
      1.58778E-05,1.60488E-05,1.62207E-05,1.63934E-05,1.65669E-05/               <a name='1183'>
      DATA (TOTPLNK(IDATA, 4),IDATA=151,181)/ &amp;                                             <a name='1184'>
      1.67411E-05,1.69162E-05,1.70920E-05,1.72685E-05,1.74459E-05, &amp; <a name='1185'>
      1.76240E-05,1.78029E-05,1.79825E-05,1.81629E-05,1.83440E-05, &amp; <a name='1186'>
      1.85259E-05,1.87086E-05,1.88919E-05,1.90760E-05,1.92609E-05, &amp; <a name='1187'>
      1.94465E-05,1.96327E-05,1.98199E-05,2.00076E-05,2.01961E-05, &amp; <a name='1188'>
      2.03853E-05,2.05752E-05,2.07658E-05,2.09571E-05,2.11491E-05, &amp; <a name='1189'>
      2.13418E-05,2.15352E-05,2.17294E-05,2.19241E-05,2.21196E-05, &amp; <a name='1190'>
      2.23158E-05/                                                               <a name='1191'>
      DATA (TOTPLNK(IDATA, 5),IDATA=1,50)/ &amp;                                                <a name='1192'>
      5.70230E-07,5.94788E-07,6.20085E-07,6.46130E-07,6.72936E-07, &amp; <a name='1193'>
      7.00512E-07,7.28869E-07,7.58019E-07,7.87971E-07,8.18734E-07, &amp; <a name='1194'>
      8.50320E-07,8.82738E-07,9.15999E-07,9.50110E-07,9.85084E-07, &amp; <a name='1195'>
      1.02093E-06,1.05765E-06,1.09527E-06,1.13378E-06,1.17320E-06, &amp; <a name='1196'>
      1.21353E-06,1.25479E-06,1.29698E-06,1.34011E-06,1.38419E-06, &amp; <a name='1197'>
      1.42923E-06,1.47523E-06,1.52221E-06,1.57016E-06,1.61910E-06, &amp; <a name='1198'>
      1.66904E-06,1.71997E-06,1.77192E-06,1.82488E-06,1.87886E-06, &amp; <a name='1199'>
      1.93387E-06,1.98991E-06,2.04699E-06,2.10512E-06,2.16430E-06, &amp; <a name='1200'>
      2.22454E-06,2.28584E-06,2.34821E-06,2.41166E-06,2.47618E-06, &amp; <a name='1201'>
      2.54178E-06,2.60847E-06,2.67626E-06,2.74514E-06,2.81512E-06/               <a name='1202'>
      DATA (TOTPLNK(IDATA, 5),IDATA=51,100)/ &amp;                                              <a name='1203'>
      2.88621E-06,2.95841E-06,3.03172E-06,3.10615E-06,3.18170E-06, &amp; <a name='1204'>
      3.25838E-06,3.33618E-06,3.41511E-06,3.49518E-06,3.57639E-06, &amp; <a name='1205'>
      3.65873E-06,3.74221E-06,3.82684E-06,3.91262E-06,3.99955E-06, &amp; <a name='1206'>
      4.08763E-06,4.17686E-06,4.26725E-06,4.35880E-06,4.45150E-06, &amp; <a name='1207'>
      4.54537E-06,4.64039E-06,4.73659E-06,4.83394E-06,4.93246E-06, &amp; <a name='1208'>
      5.03215E-06,5.13301E-06,5.23504E-06,5.33823E-06,5.44260E-06, &amp; <a name='1209'>
      5.54814E-06,5.65484E-06,5.76272E-06,5.87177E-06,5.98199E-06, &amp; <a name='1210'>
      6.09339E-06,6.20596E-06,6.31969E-06,6.43460E-06,6.55068E-06, &amp; <a name='1211'>
      6.66793E-06,6.78636E-06,6.90595E-06,7.02670E-06,7.14863E-06, &amp; <a name='1212'>
      7.27173E-06,7.39599E-06,7.52142E-06,7.64802E-06,7.77577E-06/               <a name='1213'>
      DATA (TOTPLNK(IDATA, 5),IDATA=101,150)/ &amp;                                             <a name='1214'>
      7.90469E-06,8.03477E-06,8.16601E-06,8.29841E-06,8.43198E-06, &amp; <a name='1215'>
      8.56669E-06,8.70256E-06,8.83957E-06,8.97775E-06,9.11706E-06, &amp; <a name='1216'>
      9.25753E-06,9.39915E-06,9.54190E-06,9.68580E-06,9.83085E-06, &amp; <a name='1217'>
      9.97704E-06,1.01243E-05,1.02728E-05,1.04224E-05,1.05731E-05, &amp; <a name='1218'>
      1.07249E-05,1.08779E-05,1.10320E-05,1.11872E-05,1.13435E-05, &amp; <a name='1219'>
      1.15009E-05,1.16595E-05,1.18191E-05,1.19799E-05,1.21418E-05, &amp; <a name='1220'>
      1.23048E-05,1.24688E-05,1.26340E-05,1.28003E-05,1.29676E-05, &amp; <a name='1221'>
      1.31361E-05,1.33056E-05,1.34762E-05,1.36479E-05,1.38207E-05, &amp; <a name='1222'>
      1.39945E-05,1.41694E-05,1.43454E-05,1.45225E-05,1.47006E-05, &amp; <a name='1223'>
      1.48797E-05,1.50600E-05,1.52413E-05,1.54236E-05,1.56070E-05/               <a name='1224'>
      DATA (TOTPLNK(IDATA, 5),IDATA=151,181)/ &amp;                                             <a name='1225'>
      1.57914E-05,1.59768E-05,1.61633E-05,1.63509E-05,1.65394E-05, &amp; <a name='1226'>
      1.67290E-05,1.69197E-05,1.71113E-05,1.73040E-05,1.74976E-05, &amp; <a name='1227'>
      1.76923E-05,1.78880E-05,1.80847E-05,1.82824E-05,1.84811E-05, &amp; <a name='1228'>
      1.86808E-05,1.88814E-05,1.90831E-05,1.92857E-05,1.94894E-05, &amp; <a name='1229'>
      1.96940E-05,1.98996E-05,2.01061E-05,2.03136E-05,2.05221E-05, &amp; <a name='1230'>
      2.07316E-05,2.09420E-05,2.11533E-05,2.13657E-05,2.15789E-05, &amp; <a name='1231'>
      2.17931E-05/                                                               <a name='1232'>
      DATA (TOTPLNK(IDATA, 6),IDATA=1,50)/ &amp;                                                <a name='1233'>
      2.73493E-07,2.87408E-07,3.01848E-07,3.16825E-07,3.32352E-07, &amp; <a name='1234'>
      3.48439E-07,3.65100E-07,3.82346E-07,4.00189E-07,4.18641E-07, &amp; <a name='1235'>
      4.37715E-07,4.57422E-07,4.77774E-07,4.98784E-07,5.20464E-07, &amp; <a name='1236'>
      5.42824E-07,5.65879E-07,5.89638E-07,6.14115E-07,6.39320E-07, &amp; <a name='1237'>
      6.65266E-07,6.91965E-07,7.19427E-07,7.47666E-07,7.76691E-07, &amp; <a name='1238'>
      8.06516E-07,8.37151E-07,8.68607E-07,9.00896E-07,9.34029E-07, &amp; <a name='1239'>
      9.68018E-07,1.00287E-06,1.03860E-06,1.07522E-06,1.11274E-06, &amp; <a name='1240'>
      1.15117E-06,1.19052E-06,1.23079E-06,1.27201E-06,1.31418E-06, &amp; <a name='1241'>
      1.35731E-06,1.40141E-06,1.44650E-06,1.49257E-06,1.53965E-06, &amp; <a name='1242'>
      1.58773E-06,1.63684E-06,1.68697E-06,1.73815E-06,1.79037E-06/               <a name='1243'>
      DATA (TOTPLNK(IDATA, 6),IDATA=51,100)/ &amp;                                              <a name='1244'>
      1.84365E-06,1.89799E-06,1.95341E-06,2.00991E-06,2.06750E-06, &amp; <a name='1245'>
      2.12619E-06,2.18599E-06,2.24691E-06,2.30895E-06,2.37212E-06, &amp; <a name='1246'>
      2.43643E-06,2.50189E-06,2.56851E-06,2.63628E-06,2.70523E-06, &amp; <a name='1247'>
      2.77536E-06,2.84666E-06,2.91916E-06,2.99286E-06,3.06776E-06, &amp; <a name='1248'>
      3.14387E-06,3.22120E-06,3.29975E-06,3.37953E-06,3.46054E-06, &amp; <a name='1249'>
      3.54280E-06,3.62630E-06,3.71105E-06,3.79707E-06,3.88434E-06, &amp; <a name='1250'>
      3.97288E-06,4.06270E-06,4.15380E-06,4.24617E-06,4.33984E-06, &amp; <a name='1251'>
      4.43479E-06,4.53104E-06,4.62860E-06,4.72746E-06,4.82763E-06, &amp; <a name='1252'>
      4.92911E-06,5.03191E-06,5.13603E-06,5.24147E-06,5.34824E-06, &amp; <a name='1253'>
      5.45634E-06,5.56578E-06,5.67656E-06,5.78867E-06,5.90213E-06/               <a name='1254'>
      DATA (TOTPLNK(IDATA, 6),IDATA=101,150)/ &amp;                                             <a name='1255'>
      6.01694E-06,6.13309E-06,6.25060E-06,6.36947E-06,6.48968E-06, &amp; <a name='1256'>
      6.61126E-06,6.73420E-06,6.85850E-06,6.98417E-06,7.11120E-06, &amp; <a name='1257'>
      7.23961E-06,7.36938E-06,7.50053E-06,7.63305E-06,7.76694E-06, &amp; <a name='1258'>
      7.90221E-06,8.03887E-06,8.17690E-06,8.31632E-06,8.45710E-06, &amp; <a name='1259'>
      8.59928E-06,8.74282E-06,8.88776E-06,9.03409E-06,9.18179E-06, &amp; <a name='1260'>
      9.33088E-06,9.48136E-06,9.63323E-06,9.78648E-06,9.94111E-06, &amp; <a name='1261'>
      1.00971E-05,1.02545E-05,1.04133E-05,1.05735E-05,1.07351E-05, &amp; <a name='1262'>
      1.08980E-05,1.10624E-05,1.12281E-05,1.13952E-05,1.15637E-05, &amp; <a name='1263'>
      1.17335E-05,1.19048E-05,1.20774E-05,1.22514E-05,1.24268E-05, &amp; <a name='1264'>
      1.26036E-05,1.27817E-05,1.29612E-05,1.31421E-05,1.33244E-05/               <a name='1265'>
      DATA (TOTPLNK(IDATA, 6),IDATA=151,181)/ &amp;                                             <a name='1266'>
      1.35080E-05,1.36930E-05,1.38794E-05,1.40672E-05,1.42563E-05, &amp; <a name='1267'>
      1.44468E-05,1.46386E-05,1.48318E-05,1.50264E-05,1.52223E-05, &amp; <a name='1268'>
      1.54196E-05,1.56182E-05,1.58182E-05,1.60196E-05,1.62223E-05, &amp; <a name='1269'>
      1.64263E-05,1.66317E-05,1.68384E-05,1.70465E-05,1.72559E-05, &amp; <a name='1270'>
      1.74666E-05,1.76787E-05,1.78921E-05,1.81069E-05,1.83230E-05, &amp; <a name='1271'>
      1.85404E-05,1.87591E-05,1.89791E-05,1.92005E-05,1.94232E-05, &amp; <a name='1272'>
      1.96471E-05/                                                               <a name='1273'>
      DATA (TOTPLNK(IDATA, 7),IDATA=1,50)/ &amp;                                                <a name='1274'>
      1.25349E-07,1.32735E-07,1.40458E-07,1.48527E-07,1.56954E-07, &amp; <a name='1275'>
      1.65748E-07,1.74920E-07,1.84481E-07,1.94443E-07,2.04814E-07, &amp; <a name='1276'>
      2.15608E-07,2.26835E-07,2.38507E-07,2.50634E-07,2.63229E-07, &amp; <a name='1277'>
      2.76301E-07,2.89864E-07,3.03930E-07,3.18508E-07,3.33612E-07, &amp; <a name='1278'>
      3.49253E-07,3.65443E-07,3.82195E-07,3.99519E-07,4.17428E-07, &amp; <a name='1279'>
      4.35934E-07,4.55050E-07,4.74785E-07,4.95155E-07,5.16170E-07, &amp; <a name='1280'>
      5.37844E-07,5.60186E-07,5.83211E-07,6.06929E-07,6.31355E-07, &amp; <a name='1281'>
      6.56498E-07,6.82373E-07,7.08990E-07,7.36362E-07,7.64501E-07, &amp; <a name='1282'>
      7.93420E-07,8.23130E-07,8.53643E-07,8.84971E-07,9.17128E-07, &amp; <a name='1283'>
      9.50123E-07,9.83969E-07,1.01868E-06,1.05426E-06,1.09073E-06/               <a name='1284'>
      DATA (TOTPLNK(IDATA, 7),IDATA=51,100)/ &amp;                                              <a name='1285'>
      1.12810E-06,1.16638E-06,1.20558E-06,1.24572E-06,1.28680E-06, &amp; <a name='1286'>
      1.32883E-06,1.37183E-06,1.41581E-06,1.46078E-06,1.50675E-06, &amp; <a name='1287'>
      1.55374E-06,1.60174E-06,1.65078E-06,1.70087E-06,1.75200E-06, &amp; <a name='1288'>
      1.80421E-06,1.85749E-06,1.91186E-06,1.96732E-06,2.02389E-06, &amp; <a name='1289'>
      2.08159E-06,2.14040E-06,2.20035E-06,2.26146E-06,2.32372E-06, &amp; <a name='1290'>
      2.38714E-06,2.45174E-06,2.51753E-06,2.58451E-06,2.65270E-06, &amp; <a name='1291'>
      2.72210E-06,2.79272E-06,2.86457E-06,2.93767E-06,3.01201E-06, &amp; <a name='1292'>
      3.08761E-06,3.16448E-06,3.24261E-06,3.32204E-06,3.40275E-06, &amp; <a name='1293'>
      3.48476E-06,3.56808E-06,3.65271E-06,3.73866E-06,3.82595E-06, &amp; <a name='1294'>
      3.91456E-06,4.00453E-06,4.09584E-06,4.18851E-06,4.28254E-06/               <a name='1295'>
      DATA (TOTPLNK(IDATA, 7),IDATA=101,150)/ &amp;                                             <a name='1296'>
      4.37796E-06,4.47475E-06,4.57293E-06,4.67249E-06,4.77346E-06, &amp; <a name='1297'>
      4.87583E-06,4.97961E-06,5.08481E-06,5.19143E-06,5.29948E-06, &amp; <a name='1298'>
      5.40896E-06,5.51989E-06,5.63226E-06,5.74608E-06,5.86136E-06, &amp; <a name='1299'>
      5.97810E-06,6.09631E-06,6.21597E-06,6.33713E-06,6.45976E-06, &amp; <a name='1300'>
      6.58388E-06,6.70950E-06,6.83661E-06,6.96521E-06,7.09531E-06, &amp; <a name='1301'>
      7.22692E-06,7.36005E-06,7.49468E-06,7.63084E-06,7.76851E-06, &amp; <a name='1302'>
      7.90773E-06,8.04846E-06,8.19072E-06,8.33452E-06,8.47985E-06, &amp; <a name='1303'>
      8.62674E-06,8.77517E-06,8.92514E-06,9.07666E-06,9.22975E-06, &amp; <a name='1304'>
      9.38437E-06,9.54057E-06,9.69832E-06,9.85762E-06,1.00185E-05, &amp; <a name='1305'>
      1.01810E-05,1.03450E-05,1.05106E-05,1.06777E-05,1.08465E-05/               <a name='1306'>
      DATA (TOTPLNK(IDATA, 7),IDATA=151,181)/ &amp;                                             <a name='1307'>
      1.10168E-05,1.11887E-05,1.13621E-05,1.15372E-05,1.17138E-05, &amp; <a name='1308'>
      1.18920E-05,1.20718E-05,1.22532E-05,1.24362E-05,1.26207E-05, &amp; <a name='1309'>
      1.28069E-05,1.29946E-05,1.31839E-05,1.33749E-05,1.35674E-05, &amp; <a name='1310'>
      1.37615E-05,1.39572E-05,1.41544E-05,1.43533E-05,1.45538E-05, &amp; <a name='1311'>
      1.47558E-05,1.49595E-05,1.51647E-05,1.53716E-05,1.55800E-05, &amp; <a name='1312'>
      1.57900E-05,1.60017E-05,1.62149E-05,1.64296E-05,1.66460E-05, &amp; <a name='1313'>
      1.68640E-05/                                                               <a name='1314'>
      DATA (TOTPLNK(IDATA, 8),IDATA=1,50)/ &amp;                                                <a name='1315'>
      6.74445E-08,7.18176E-08,7.64153E-08,8.12456E-08,8.63170E-08, &amp; <a name='1316'>
      9.16378E-08,9.72168E-08,1.03063E-07,1.09184E-07,1.15591E-07, &amp; <a name='1317'>
      1.22292E-07,1.29296E-07,1.36613E-07,1.44253E-07,1.52226E-07, &amp; <a name='1318'>
      1.60540E-07,1.69207E-07,1.78236E-07,1.87637E-07,1.97421E-07, &amp; <a name='1319'>
      2.07599E-07,2.18181E-07,2.29177E-07,2.40598E-07,2.52456E-07, &amp; <a name='1320'>
      2.64761E-07,2.77523E-07,2.90755E-07,3.04468E-07,3.18673E-07, &amp; <a name='1321'>
      3.33381E-07,3.48603E-07,3.64352E-07,3.80638E-07,3.97474E-07, &amp; <a name='1322'>
      4.14871E-07,4.32841E-07,4.51395E-07,4.70547E-07,4.90306E-07, &amp; <a name='1323'>
      5.10687E-07,5.31699E-07,5.53357E-07,5.75670E-07,5.98652E-07, &amp; <a name='1324'>
      6.22315E-07,6.46672E-07,6.71731E-07,6.97511E-07,7.24018E-07/               <a name='1325'>
      DATA (TOTPLNK(IDATA, 8),IDATA=51,100)/ &amp;                                              <a name='1326'>
      7.51266E-07,7.79269E-07,8.08038E-07,8.37584E-07,8.67922E-07, &amp; <a name='1327'>
      8.99061E-07,9.31016E-07,9.63797E-07,9.97417E-07,1.03189E-06, &amp; <a name='1328'>
      1.06722E-06,1.10343E-06,1.14053E-06,1.17853E-06,1.21743E-06, &amp; <a name='1329'>
      1.25726E-06,1.29803E-06,1.33974E-06,1.38241E-06,1.42606E-06, &amp; <a name='1330'>
      1.47068E-06,1.51630E-06,1.56293E-06,1.61056E-06,1.65924E-06, &amp; <a name='1331'>
      1.70894E-06,1.75971E-06,1.81153E-06,1.86443E-06,1.91841E-06, &amp; <a name='1332'>
      1.97350E-06,2.02968E-06,2.08699E-06,2.14543E-06,2.20500E-06, &amp; <a name='1333'>
      2.26573E-06,2.32762E-06,2.39068E-06,2.45492E-06,2.52036E-06, &amp; <a name='1334'>
      2.58700E-06,2.65485E-06,2.72393E-06,2.79424E-06,2.86580E-06, &amp; <a name='1335'>
      2.93861E-06,3.01269E-06,3.08803E-06,3.16467E-06,3.24259E-06/               <a name='1336'>
      DATA (TOTPLNK(IDATA, 8),IDATA=101,150)/ &amp;                                             <a name='1337'>
      3.32181E-06,3.40235E-06,3.48420E-06,3.56739E-06,3.65192E-06, &amp; <a name='1338'>
      3.73779E-06,3.82502E-06,3.91362E-06,4.00359E-06,4.09494E-06, &amp; <a name='1339'>
      4.18768E-06,4.28182E-06,4.37737E-06,4.47434E-06,4.57273E-06, &amp; <a name='1340'>
      4.67254E-06,4.77380E-06,4.87651E-06,4.98067E-06,5.08630E-06, &amp; <a name='1341'>
      5.19339E-06,5.30196E-06,5.41201E-06,5.52356E-06,5.63660E-06, &amp; <a name='1342'>
      5.75116E-06,5.86722E-06,5.98479E-06,6.10390E-06,6.22453E-06, &amp; <a name='1343'>
      6.34669E-06,6.47042E-06,6.59569E-06,6.72252E-06,6.85090E-06, &amp; <a name='1344'>
      6.98085E-06,7.11238E-06,7.24549E-06,7.38019E-06,7.51646E-06, &amp; <a name='1345'>
      7.65434E-06,7.79382E-06,7.93490E-06,8.07760E-06,8.22192E-06, &amp; <a name='1346'>
      8.36784E-06,8.51540E-06,8.66459E-06,8.81542E-06,8.96786E-06/               <a name='1347'>
      DATA (TOTPLNK(IDATA, 8),IDATA=151,181)/ &amp;                                             <a name='1348'>
      9.12197E-06,9.27772E-06,9.43513E-06,9.59419E-06,9.75490E-06, &amp; <a name='1349'>
      9.91728E-06,1.00813E-05,1.02471E-05,1.04144E-05,1.05835E-05, &amp; <a name='1350'>
      1.07543E-05,1.09267E-05,1.11008E-05,1.12766E-05,1.14541E-05, &amp; <a name='1351'>
      1.16333E-05,1.18142E-05,1.19969E-05,1.21812E-05,1.23672E-05, &amp; <a name='1352'>
      1.25549E-05,1.27443E-05,1.29355E-05,1.31284E-05,1.33229E-05, &amp; <a name='1353'>
      1.35193E-05,1.37173E-05,1.39170E-05,1.41185E-05,1.43217E-05, &amp; <a name='1354'>
      1.45267E-05/                                                               <a name='1355'>
      DATA (TOTPLNK(IDATA, 9),IDATA=1,50)/ &amp;                                                <a name='1356'>
      2.61522E-08,2.80613E-08,3.00838E-08,3.22250E-08,3.44899E-08, &amp; <a name='1357'>
      3.68841E-08,3.94129E-08,4.20820E-08,4.48973E-08,4.78646E-08, &amp; <a name='1358'>
      5.09901E-08,5.42799E-08,5.77405E-08,6.13784E-08,6.52001E-08, &amp; <a name='1359'>
      6.92126E-08,7.34227E-08,7.78375E-08,8.24643E-08,8.73103E-08, &amp; <a name='1360'>
      9.23832E-08,9.76905E-08,1.03240E-07,1.09039E-07,1.15097E-07, &amp; <a name='1361'>
      1.21421E-07,1.28020E-07,1.34902E-07,1.42075E-07,1.49548E-07, &amp; <a name='1362'>
      1.57331E-07,1.65432E-07,1.73860E-07,1.82624E-07,1.91734E-07, &amp; <a name='1363'>
      2.01198E-07,2.11028E-07,2.21231E-07,2.31818E-07,2.42799E-07, &amp; <a name='1364'>
      2.54184E-07,2.65983E-07,2.78205E-07,2.90862E-07,3.03963E-07, &amp; <a name='1365'>
      3.17519E-07,3.31541E-07,3.46039E-07,3.61024E-07,3.76507E-07/               <a name='1366'>
      DATA (TOTPLNK(IDATA, 9),IDATA=51,100)/ &amp;                                              <a name='1367'>
      3.92498E-07,4.09008E-07,4.26050E-07,4.43633E-07,4.61769E-07, &amp; <a name='1368'>
      4.80469E-07,4.99744E-07,5.19606E-07,5.40067E-07,5.61136E-07, &amp; <a name='1369'>
      5.82828E-07,6.05152E-07,6.28120E-07,6.51745E-07,6.76038E-07, &amp; <a name='1370'>
      7.01010E-07,7.26674E-07,7.53041E-07,7.80124E-07,8.07933E-07, &amp; <a name='1371'>
      8.36482E-07,8.65781E-07,8.95845E-07,9.26683E-07,9.58308E-07, &amp; <a name='1372'>
      9.90732E-07,1.02397E-06,1.05803E-06,1.09292E-06,1.12866E-06, &amp; <a name='1373'>
      1.16526E-06,1.20274E-06,1.24109E-06,1.28034E-06,1.32050E-06, &amp; <a name='1374'>
      1.36158E-06,1.40359E-06,1.44655E-06,1.49046E-06,1.53534E-06, &amp; <a name='1375'>
      1.58120E-06,1.62805E-06,1.67591E-06,1.72478E-06,1.77468E-06, &amp; <a name='1376'>
      1.82561E-06,1.87760E-06,1.93066E-06,1.98479E-06,2.04000E-06/               <a name='1377'>
      DATA (TOTPLNK(IDATA, 9),IDATA=101,150)/ &amp;                                             <a name='1378'>
      2.09631E-06,2.15373E-06,2.21228E-06,2.27196E-06,2.33278E-06, &amp; <a name='1379'>
      2.39475E-06,2.45790E-06,2.52222E-06,2.58773E-06,2.65445E-06, &amp; <a name='1380'>
      2.72238E-06,2.79152E-06,2.86191E-06,2.93354E-06,3.00643E-06, &amp; <a name='1381'>
      3.08058E-06,3.15601E-06,3.23273E-06,3.31075E-06,3.39009E-06, &amp; <a name='1382'>
      3.47074E-06,3.55272E-06,3.63605E-06,3.72072E-06,3.80676E-06, &amp; <a name='1383'>
      3.89417E-06,3.98297E-06,4.07315E-06,4.16474E-06,4.25774E-06, &amp; <a name='1384'>
      4.35217E-06,4.44802E-06,4.54532E-06,4.64406E-06,4.74428E-06, &amp; <a name='1385'>
      4.84595E-06,4.94911E-06,5.05376E-06,5.15990E-06,5.26755E-06, &amp; <a name='1386'>
      5.37671E-06,5.48741E-06,5.59963E-06,5.71340E-06,5.82871E-06, &amp; <a name='1387'>
      5.94559E-06,6.06403E-06,6.18404E-06,6.30565E-06,6.42885E-06/               <a name='1388'>
      DATA (TOTPLNK(IDATA, 9),IDATA=151,181)/ &amp;                                             <a name='1389'>
      6.55364E-06,6.68004E-06,6.80806E-06,6.93771E-06,7.06898E-06, &amp; <a name='1390'>
      7.20190E-06,7.33646E-06,7.47267E-06,7.61056E-06,7.75010E-06, &amp; <a name='1391'>
      7.89133E-06,8.03423E-06,8.17884E-06,8.32514E-06,8.47314E-06, &amp; <a name='1392'>
      8.62284E-06,8.77427E-06,8.92743E-06,9.08231E-06,9.23893E-06, &amp; <a name='1393'>
      9.39729E-06,9.55741E-06,9.71927E-06,9.88291E-06,1.00483E-05, &amp; <a name='1394'>
      1.02155E-05,1.03844E-05,1.05552E-05,1.07277E-05,1.09020E-05, &amp; <a name='1395'>
      1.10781E-05/                                                               <a name='1396'>
      DATA (TOTPLNK(IDATA,10),IDATA=1,50)/ &amp;                                                <a name='1397'>
      8.89300E-09,9.63263E-09,1.04235E-08,1.12685E-08,1.21703E-08, &amp; <a name='1398'>
      1.31321E-08,1.41570E-08,1.52482E-08,1.64090E-08,1.76428E-08, &amp; <a name='1399'>
      1.89533E-08,2.03441E-08,2.18190E-08,2.33820E-08,2.50370E-08, &amp; <a name='1400'>
      2.67884E-08,2.86402E-08,3.05969E-08,3.26632E-08,3.48436E-08, &amp; <a name='1401'>
      3.71429E-08,3.95660E-08,4.21179E-08,4.48040E-08,4.76294E-08, &amp; <a name='1402'>
      5.05996E-08,5.37201E-08,5.69966E-08,6.04349E-08,6.40411E-08, &amp; <a name='1403'>
      6.78211E-08,7.17812E-08,7.59276E-08,8.02670E-08,8.48059E-08, &amp; <a name='1404'>
      8.95508E-08,9.45090E-08,9.96873E-08,1.05093E-07,1.10733E-07, &amp; <a name='1405'>
      1.16614E-07,1.22745E-07,1.29133E-07,1.35786E-07,1.42711E-07, &amp; <a name='1406'>
      1.49916E-07,1.57410E-07,1.65202E-07,1.73298E-07,1.81709E-07/               <a name='1407'>
      DATA (TOTPLNK(IDATA,10),IDATA=51,100)/ &amp;                                              <a name='1408'>
      1.90441E-07,1.99505E-07,2.08908E-07,2.18660E-07,2.28770E-07, &amp; <a name='1409'>
      2.39247E-07,2.50101E-07,2.61340E-07,2.72974E-07,2.85013E-07, &amp; <a name='1410'>
      2.97467E-07,3.10345E-07,3.23657E-07,3.37413E-07,3.51623E-07, &amp; <a name='1411'>
      3.66298E-07,3.81448E-07,3.97082E-07,4.13212E-07,4.29848E-07, &amp; <a name='1412'>
      4.47000E-07,4.64680E-07,4.82898E-07,5.01664E-07,5.20991E-07, &amp; <a name='1413'>
      5.40888E-07,5.61369E-07,5.82440E-07,6.04118E-07,6.26410E-07, &amp; <a name='1414'>
      6.49329E-07,6.72887E-07,6.97095E-07,7.21964E-07,7.47506E-07, &amp; <a name='1415'>
      7.73732E-07,8.00655E-07,8.28287E-07,8.56635E-07,8.85717E-07, &amp; <a name='1416'>
      9.15542E-07,9.46122E-07,9.77469E-07,1.00960E-06,1.04251E-06, &amp; <a name='1417'>
      1.07623E-06,1.11077E-06,1.14613E-06,1.18233E-06,1.21939E-06/               <a name='1418'>
      DATA (TOTPLNK(IDATA,10),IDATA=101,150)/ &amp;                                             <a name='1419'>
      1.25730E-06,1.29610E-06,1.33578E-06,1.37636E-06,1.41785E-06, &amp; <a name='1420'>
      1.46027E-06,1.50362E-06,1.54792E-06,1.59319E-06,1.63942E-06, &amp; <a name='1421'>
      1.68665E-06,1.73487E-06,1.78410E-06,1.83435E-06,1.88564E-06, &amp; <a name='1422'>
      1.93797E-06,1.99136E-06,2.04582E-06,2.10137E-06,2.15801E-06, &amp; <a name='1423'>
      2.21576E-06,2.27463E-06,2.33462E-06,2.39577E-06,2.45806E-06, &amp; <a name='1424'>
      2.52153E-06,2.58617E-06,2.65201E-06,2.71905E-06,2.78730E-06, &amp; <a name='1425'>
      2.85678E-06,2.92749E-06,2.99946E-06,3.07269E-06,3.14720E-06, &amp; <a name='1426'>
      3.22299E-06,3.30007E-06,3.37847E-06,3.45818E-06,3.53923E-06, &amp; <a name='1427'>
      3.62161E-06,3.70535E-06,3.79046E-06,3.87695E-06,3.96481E-06, &amp; <a name='1428'>
      4.05409E-06,4.14477E-06,4.23687E-06,4.33040E-06,4.42538E-06/               <a name='1429'>
      DATA (TOTPLNK(IDATA,10),IDATA=151,181)/ &amp;                                             <a name='1430'>
      4.52180E-06,4.61969E-06,4.71905E-06,4.81991E-06,4.92226E-06, &amp; <a name='1431'>
      5.02611E-06,5.13148E-06,5.23839E-06,5.34681E-06,5.45681E-06, &amp; <a name='1432'>
      5.56835E-06,5.68146E-06,5.79614E-06,5.91242E-06,6.03030E-06, &amp; <a name='1433'>
      6.14978E-06,6.27088E-06,6.39360E-06,6.51798E-06,6.64398E-06, &amp; <a name='1434'>
      6.77165E-06,6.90099E-06,7.03198E-06,7.16468E-06,7.29906E-06, &amp; <a name='1435'>
      7.43514E-06,7.57294E-06,7.71244E-06,7.85369E-06,7.99666E-06, &amp; <a name='1436'>
      8.14138E-06/                                                               <a name='1437'>
      DATA (TOTPLNK(IDATA,11),IDATA=1,50)/ &amp;                                                <a name='1438'>
      2.53767E-09,2.77242E-09,3.02564E-09,3.29851E-09,3.59228E-09, &amp; <a name='1439'>
      3.90825E-09,4.24777E-09,4.61227E-09,5.00322E-09,5.42219E-09, &amp; <a name='1440'>
      5.87080E-09,6.35072E-09,6.86370E-09,7.41159E-09,7.99628E-09, &amp; <a name='1441'>
      8.61974E-09,9.28404E-09,9.99130E-09,1.07437E-08,1.15436E-08, &amp; <a name='1442'>
      1.23933E-08,1.32953E-08,1.42522E-08,1.52665E-08,1.63410E-08, &amp; <a name='1443'>
      1.74786E-08,1.86820E-08,1.99542E-08,2.12985E-08,2.27179E-08, &amp; <a name='1444'>
      2.42158E-08,2.57954E-08,2.74604E-08,2.92141E-08,3.10604E-08, &amp; <a name='1445'>
      3.30029E-08,3.50457E-08,3.71925E-08,3.94476E-08,4.18149E-08, &amp; <a name='1446'>
      4.42991E-08,4.69043E-08,4.96352E-08,5.24961E-08,5.54921E-08, &amp; <a name='1447'>
      5.86277E-08,6.19081E-08,6.53381E-08,6.89231E-08,7.26681E-08/               <a name='1448'>
      DATA (TOTPLNK(IDATA,11),IDATA=51,100)/ &amp;                                              <a name='1449'>
      7.65788E-08,8.06604E-08,8.49187E-08,8.93591E-08,9.39879E-08, &amp; <a name='1450'>
      9.88106E-08,1.03834E-07,1.09063E-07,1.14504E-07,1.20165E-07, &amp; <a name='1451'>
      1.26051E-07,1.32169E-07,1.38525E-07,1.45128E-07,1.51982E-07, &amp; <a name='1452'>
      1.59096E-07,1.66477E-07,1.74132E-07,1.82068E-07,1.90292E-07, &amp; <a name='1453'>
      1.98813E-07,2.07638E-07,2.16775E-07,2.26231E-07,2.36015E-07, &amp; <a name='1454'>
      2.46135E-07,2.56599E-07,2.67415E-07,2.78592E-07,2.90137E-07, &amp; <a name='1455'>
      3.02061E-07,3.14371E-07,3.27077E-07,3.40186E-07,3.53710E-07, &amp; <a name='1456'>
      3.67655E-07,3.82031E-07,3.96848E-07,4.12116E-07,4.27842E-07, &amp; <a name='1457'>
      4.44039E-07,4.60713E-07,4.77876E-07,4.95537E-07,5.13706E-07, &amp; <a name='1458'>
      5.32392E-07,5.51608E-07,5.71360E-07,5.91662E-07,6.12521E-07/               <a name='1459'>
      DATA (TOTPLNK(IDATA,11),IDATA=101,150)/ &amp;                                             <a name='1460'>
      6.33950E-07,6.55958E-07,6.78556E-07,7.01753E-07,7.25562E-07, &amp; <a name='1461'>
      7.49992E-07,7.75055E-07,8.00760E-07,8.27120E-07,8.54145E-07, &amp; <a name='1462'>
      8.81845E-07,9.10233E-07,9.39318E-07,9.69113E-07,9.99627E-07, &amp; <a name='1463'>
      1.03087E-06,1.06286E-06,1.09561E-06,1.12912E-06,1.16340E-06, &amp; <a name='1464'>
      1.19848E-06,1.23435E-06,1.27104E-06,1.30855E-06,1.34690E-06, &amp; <a name='1465'>
      1.38609E-06,1.42614E-06,1.46706E-06,1.50886E-06,1.55155E-06, &amp; <a name='1466'>
      1.59515E-06,1.63967E-06,1.68512E-06,1.73150E-06,1.77884E-06, &amp; <a name='1467'>
      1.82715E-06,1.87643E-06,1.92670E-06,1.97797E-06,2.03026E-06, &amp; <a name='1468'>
      2.08356E-06,2.13791E-06,2.19330E-06,2.24975E-06,2.30728E-06, &amp; <a name='1469'>
      2.36589E-06,2.42560E-06,2.48641E-06,2.54835E-06,2.61142E-06/               <a name='1470'>
      DATA (TOTPLNK(IDATA,11),IDATA=151,181)/ &amp;                                             <a name='1471'>
      2.67563E-06,2.74100E-06,2.80754E-06,2.87526E-06,2.94417E-06, &amp; <a name='1472'>
      3.01429E-06,3.08562E-06,3.15819E-06,3.23199E-06,3.30704E-06, &amp; <a name='1473'>
      3.38336E-06,3.46096E-06,3.53984E-06,3.62002E-06,3.70151E-06, &amp; <a name='1474'>
      3.78433E-06,3.86848E-06,3.95399E-06,4.04084E-06,4.12907E-06, &amp; <a name='1475'>
      4.21868E-06,4.30968E-06,4.40209E-06,4.49592E-06,4.59117E-06, &amp; <a name='1476'>
      4.68786E-06,4.78600E-06,4.88561E-06,4.98669E-06,5.08926E-06, &amp; <a name='1477'>
      5.19332E-06/                                                               <a name='1478'>
      DATA (TOTPLNK(IDATA,12),IDATA=1,50)/ &amp;                                                <a name='1479'>
      2.73921E-10,3.04500E-10,3.38056E-10,3.74835E-10,4.15099E-10, &amp; <a name='1480'>
      4.59126E-10,5.07214E-10,5.59679E-10,6.16857E-10,6.79103E-10, &amp; <a name='1481'>
      7.46796E-10,8.20335E-10,9.00144E-10,9.86671E-10,1.08039E-09, &amp; <a name='1482'>
      1.18180E-09,1.29142E-09,1.40982E-09,1.53757E-09,1.67529E-09, &amp; <a name='1483'>
      1.82363E-09,1.98327E-09,2.15492E-09,2.33932E-09,2.53726E-09, &amp; <a name='1484'>
      2.74957E-09,2.97710E-09,3.22075E-09,3.48145E-09,3.76020E-09, &amp; <a name='1485'>
      4.05801E-09,4.37595E-09,4.71513E-09,5.07672E-09,5.46193E-09, &amp; <a name='1486'>
      5.87201E-09,6.30827E-09,6.77205E-09,7.26480E-09,7.78794E-09, &amp; <a name='1487'>
      8.34304E-09,8.93163E-09,9.55537E-09,1.02159E-08,1.09151E-08, &amp; <a name='1488'>
      1.16547E-08,1.24365E-08,1.32625E-08,1.41348E-08,1.50554E-08/               <a name='1489'>
      DATA (TOTPLNK(IDATA,12),IDATA=51,100)/ &amp;                                              <a name='1490'>
      1.60264E-08,1.70500E-08,1.81285E-08,1.92642E-08,2.04596E-08, &amp; <a name='1491'>
      2.17171E-08,2.30394E-08,2.44289E-08,2.58885E-08,2.74209E-08, &amp; <a name='1492'>
      2.90290E-08,3.07157E-08,3.24841E-08,3.43371E-08,3.62782E-08, &amp; <a name='1493'>
      3.83103E-08,4.04371E-08,4.26617E-08,4.49878E-08,4.74190E-08, &amp; <a name='1494'>
      4.99589E-08,5.26113E-08,5.53801E-08,5.82692E-08,6.12826E-08, &amp; <a name='1495'>
      6.44245E-08,6.76991E-08,7.11105E-08,7.46634E-08,7.83621E-08, &amp; <a name='1496'>
      8.22112E-08,8.62154E-08,9.03795E-08,9.47081E-08,9.92066E-08, &amp; <a name='1497'>
      1.03879E-07,1.08732E-07,1.13770E-07,1.18998E-07,1.24422E-07, &amp; <a name='1498'>
      1.30048E-07,1.35880E-07,1.41924E-07,1.48187E-07,1.54675E-07, &amp; <a name='1499'>
      1.61392E-07,1.68346E-07,1.75543E-07,1.82988E-07,1.90688E-07/               <a name='1500'>
      DATA (TOTPLNK(IDATA,12),IDATA=101,150)/ &amp;                                             <a name='1501'>
      1.98650E-07,2.06880E-07,2.15385E-07,2.24172E-07,2.33247E-07, &amp; <a name='1502'>
      2.42617E-07,2.52289E-07,2.62272E-07,2.72571E-07,2.83193E-07, &amp; <a name='1503'>
      2.94147E-07,3.05440E-07,3.17080E-07,3.29074E-07,3.41430E-07, &amp; <a name='1504'>
      3.54155E-07,3.67259E-07,3.80747E-07,3.94631E-07,4.08916E-07, &amp; <a name='1505'>
      4.23611E-07,4.38725E-07,4.54267E-07,4.70245E-07,4.86666E-07, &amp; <a name='1506'>
      5.03541E-07,5.20879E-07,5.38687E-07,5.56975E-07,5.75751E-07, &amp; <a name='1507'>
      5.95026E-07,6.14808E-07,6.35107E-07,6.55932E-07,6.77293E-07, &amp; <a name='1508'>
      6.99197E-07,7.21656E-07,7.44681E-07,7.68278E-07,7.92460E-07, &amp; <a name='1509'>
      8.17235E-07,8.42614E-07,8.68606E-07,8.95223E-07,9.22473E-07, &amp; <a name='1510'>
      9.50366E-07,9.78915E-07,1.00813E-06,1.03802E-06,1.06859E-06/               <a name='1511'>
      DATA (TOTPLNK(IDATA,12),IDATA=151,181)/ &amp;                                             <a name='1512'>
      1.09986E-06,1.13184E-06,1.16453E-06,1.19796E-06,1.23212E-06, &amp; <a name='1513'>
      1.26703E-06,1.30270E-06,1.33915E-06,1.37637E-06,1.41440E-06, &amp; <a name='1514'>
      1.45322E-06,1.49286E-06,1.53333E-06,1.57464E-06,1.61679E-06, &amp; <a name='1515'>
      1.65981E-06,1.70370E-06,1.74847E-06,1.79414E-06,1.84071E-06, &amp; <a name='1516'>
      1.88821E-06,1.93663E-06,1.98599E-06,2.03631E-06,2.08759E-06, &amp; <a name='1517'>
      2.13985E-06,2.19310E-06,2.24734E-06,2.30260E-06,2.35888E-06, &amp; <a name='1518'>
      2.41619E-06/                                                               <a name='1519'>
      DATA (TOTPLNK(IDATA,13),IDATA=1,50)/ &amp;                                                <a name='1520'>
      4.53634E-11,5.11435E-11,5.75754E-11,6.47222E-11,7.26531E-11, &amp; <a name='1521'>
      8.14420E-11,9.11690E-11,1.01921E-10,1.13790E-10,1.26877E-10, &amp; <a name='1522'>
      1.41288E-10,1.57140E-10,1.74555E-10,1.93665E-10,2.14613E-10, &amp; <a name='1523'>
      2.37548E-10,2.62633E-10,2.90039E-10,3.19948E-10,3.52558E-10, &amp; <a name='1524'>
      3.88073E-10,4.26716E-10,4.68719E-10,5.14331E-10,5.63815E-10, &amp; <a name='1525'>
      6.17448E-10,6.75526E-10,7.38358E-10,8.06277E-10,8.79625E-10, &amp; <a name='1526'>
      9.58770E-10,1.04410E-09,1.13602E-09,1.23495E-09,1.34135E-09, &amp; <a name='1527'>
      1.45568E-09,1.57845E-09,1.71017E-09,1.85139E-09,2.00268E-09, &amp; <a name='1528'>
      2.16464E-09,2.33789E-09,2.52309E-09,2.72093E-09,2.93212E-09, &amp; <a name='1529'>
      3.15740E-09,3.39757E-09,3.65341E-09,3.92579E-09,4.21559E-09/               <a name='1530'>
      DATA (TOTPLNK(IDATA,13),IDATA=51,100)/ &amp;                                              <a name='1531'>
      4.52372E-09,4.85115E-09,5.19886E-09,5.56788E-09,5.95928E-09, &amp; <a name='1532'>
      6.37419E-09,6.81375E-09,7.27917E-09,7.77168E-09,8.29256E-09, &amp; <a name='1533'>
      8.84317E-09,9.42487E-09,1.00391E-08,1.06873E-08,1.13710E-08, &amp; <a name='1534'>
      1.20919E-08,1.28515E-08,1.36514E-08,1.44935E-08,1.53796E-08, &amp; <a name='1535'>
      1.63114E-08,1.72909E-08,1.83201E-08,1.94008E-08,2.05354E-08, &amp; <a name='1536'>
      2.17258E-08,2.29742E-08,2.42830E-08,2.56545E-08,2.70910E-08, &amp; <a name='1537'>
      2.85950E-08,3.01689E-08,3.18155E-08,3.35373E-08,3.53372E-08, &amp; <a name='1538'>
      3.72177E-08,3.91818E-08,4.12325E-08,4.33727E-08,4.56056E-08, &amp; <a name='1539'>
      4.79342E-08,5.03617E-08,5.28915E-08,5.55270E-08,5.82715E-08, &amp; <a name='1540'>
      6.11286E-08,6.41019E-08,6.71951E-08,7.04119E-08,7.37560E-08/               <a name='1541'>
      DATA (TOTPLNK(IDATA,13),IDATA=101,150)/ &amp;                                             <a name='1542'>
      7.72315E-08,8.08424E-08,8.45927E-08,8.84866E-08,9.25281E-08, &amp; <a name='1543'>
      9.67218E-08,1.01072E-07,1.05583E-07,1.10260E-07,1.15107E-07, &amp; <a name='1544'>
      1.20128E-07,1.25330E-07,1.30716E-07,1.36291E-07,1.42061E-07, &amp; <a name='1545'>
      1.48031E-07,1.54206E-07,1.60592E-07,1.67192E-07,1.74015E-07, &amp; <a name='1546'>
      1.81064E-07,1.88345E-07,1.95865E-07,2.03628E-07,2.11643E-07, &amp; <a name='1547'>
      2.19912E-07,2.28443E-07,2.37244E-07,2.46318E-07,2.55673E-07, &amp; <a name='1548'>
      2.65316E-07,2.75252E-07,2.85489E-07,2.96033E-07,3.06891E-07, &amp; <a name='1549'>
      3.18070E-07,3.29576E-07,3.41417E-07,3.53600E-07,3.66133E-07, &amp; <a name='1550'>
      3.79021E-07,3.92274E-07,4.05897E-07,4.19899E-07,4.34288E-07, &amp; <a name='1551'>
      4.49071E-07,4.64255E-07,4.79850E-07,4.95863E-07,5.12300E-07/               <a name='1552'>
      DATA (TOTPLNK(IDATA,13),IDATA=151,181)/ &amp;                                             <a name='1553'>
      5.29172E-07,5.46486E-07,5.64250E-07,5.82473E-07,6.01164E-07, &amp; <a name='1554'>
      6.20329E-07,6.39979E-07,6.60122E-07,6.80767E-07,7.01922E-07, &amp; <a name='1555'>
      7.23596E-07,7.45800E-07,7.68539E-07,7.91826E-07,8.15669E-07, &amp; <a name='1556'>
      8.40076E-07,8.65058E-07,8.90623E-07,9.16783E-07,9.43544E-07, &amp; <a name='1557'>
      9.70917E-07,9.98912E-07,1.02754E-06,1.05681E-06,1.08673E-06, &amp; <a name='1558'>
      1.11731E-06,1.14856E-06,1.18050E-06,1.21312E-06,1.24645E-06, &amp; <a name='1559'>
      1.28049E-06/                                                               <a name='1560'>
      DATA (TOTPLNK(IDATA,14),IDATA=1,50)/ &amp;                                                <a name='1561'>
      1.40113E-11,1.59358E-11,1.80960E-11,2.05171E-11,2.32266E-11, &amp; <a name='1562'>
      2.62546E-11,2.96335E-11,3.33990E-11,3.75896E-11,4.22469E-11, &amp; <a name='1563'>
      4.74164E-11,5.31466E-11,5.94905E-11,6.65054E-11,7.42522E-11, &amp; <a name='1564'>
      8.27975E-11,9.22122E-11,1.02573E-10,1.13961E-10,1.26466E-10, &amp; <a name='1565'>
      1.40181E-10,1.55206E-10,1.71651E-10,1.89630E-10,2.09265E-10, &amp; <a name='1566'>
      2.30689E-10,2.54040E-10,2.79467E-10,3.07128E-10,3.37190E-10, &amp; <a name='1567'>
      3.69833E-10,4.05243E-10,4.43623E-10,4.85183E-10,5.30149E-10, &amp; <a name='1568'>
      5.78755E-10,6.31255E-10,6.87910E-10,7.49002E-10,8.14824E-10, &amp; <a name='1569'>
      8.85687E-10,9.61914E-10,1.04385E-09,1.13186E-09,1.22631E-09, &amp; <a name='1570'>
      1.32761E-09,1.43617E-09,1.55243E-09,1.67686E-09,1.80992E-09/               <a name='1571'>
      DATA (TOTPLNK(IDATA,14),IDATA=51,100)/ &amp;                                              <a name='1572'>
      1.95212E-09,2.10399E-09,2.26607E-09,2.43895E-09,2.62321E-09, &amp; <a name='1573'>
      2.81949E-09,3.02844E-09,3.25073E-09,3.48707E-09,3.73820E-09, &amp; <a name='1574'>
      4.00490E-09,4.28794E-09,4.58819E-09,4.90647E-09,5.24371E-09, &amp; <a name='1575'>
      5.60081E-09,5.97875E-09,6.37854E-09,6.80120E-09,7.24782E-09, &amp; <a name='1576'>
      7.71950E-09,8.21740E-09,8.74271E-09,9.29666E-09,9.88054E-09, &amp; <a name='1577'>
      1.04956E-08,1.11434E-08,1.18251E-08,1.25422E-08,1.32964E-08, &amp; <a name='1578'>
      1.40890E-08,1.49217E-08,1.57961E-08,1.67140E-08,1.76771E-08, &amp; <a name='1579'>
      1.86870E-08,1.97458E-08,2.08553E-08,2.20175E-08,2.32342E-08, &amp; <a name='1580'>
      2.45077E-08,2.58401E-08,2.72334E-08,2.86900E-08,3.02122E-08, &amp; <a name='1581'>
      3.18021E-08,3.34624E-08,3.51954E-08,3.70037E-08,3.88899E-08/               <a name='1582'>
      DATA (TOTPLNK(IDATA,14),IDATA=101,150)/ &amp;                                             <a name='1583'>
      4.08568E-08,4.29068E-08,4.50429E-08,4.72678E-08,4.95847E-08, &amp; <a name='1584'>
      5.19963E-08,5.45058E-08,5.71161E-08,5.98309E-08,6.26529E-08, &amp; <a name='1585'>
      6.55857E-08,6.86327E-08,7.17971E-08,7.50829E-08,7.84933E-08, &amp; <a name='1586'>
      8.20323E-08,8.57035E-08,8.95105E-08,9.34579E-08,9.75488E-08, &amp; <a name='1587'>
      1.01788E-07,1.06179E-07,1.10727E-07,1.15434E-07,1.20307E-07, &amp; <a name='1588'>
      1.25350E-07,1.30566E-07,1.35961E-07,1.41539E-07,1.47304E-07, &amp; <a name='1589'>
      1.53263E-07,1.59419E-07,1.65778E-07,1.72345E-07,1.79124E-07, &amp; <a name='1590'>
      1.86122E-07,1.93343E-07,2.00792E-07,2.08476E-07,2.16400E-07, &amp; <a name='1591'>
      2.24568E-07,2.32988E-07,2.41666E-07,2.50605E-07,2.59813E-07, &amp; <a name='1592'>
      2.69297E-07,2.79060E-07,2.89111E-07,2.99455E-07,3.10099E-07/               <a name='1593'>
      DATA (TOTPLNK(IDATA,14),IDATA=151,181)/ &amp;                                             <a name='1594'>
      3.21049E-07,3.32311E-07,3.43893E-07,3.55801E-07,3.68041E-07, &amp; <a name='1595'>
      3.80621E-07,3.93547E-07,4.06826E-07,4.20465E-07,4.34473E-07, &amp; <a name='1596'>
      4.48856E-07,4.63620E-07,4.78774E-07,4.94325E-07,5.10280E-07, &amp; <a name='1597'>
      5.26648E-07,5.43436E-07,5.60652E-07,5.78302E-07,5.96397E-07, &amp; <a name='1598'>
      6.14943E-07,6.33949E-07,6.53421E-07,6.73370E-07,6.93803E-07, &amp; <a name='1599'>
      7.14731E-07,7.36157E-07,7.58095E-07,7.80549E-07,8.03533E-07, &amp; <a name='1600'>
      8.27050E-07/                                                               <a name='1601'>
      DATA (TOTPLNK(IDATA,15),IDATA=1,50)/ &amp;                                                <a name='1602'>
      3.90483E-12,4.47999E-12,5.13122E-12,5.86739E-12,6.69829E-12, &amp; <a name='1603'>
      7.63467E-12,8.68833E-12,9.87221E-12,1.12005E-11,1.26885E-11, &amp; <a name='1604'>
      1.43534E-11,1.62134E-11,1.82888E-11,2.06012E-11,2.31745E-11, &amp; <a name='1605'>
      2.60343E-11,2.92087E-11,3.27277E-11,3.66242E-11,4.09334E-11, &amp; <a name='1606'>
      4.56935E-11,5.09455E-11,5.67338E-11,6.31057E-11,7.01127E-11, &amp; <a name='1607'>
      7.78096E-11,8.62554E-11,9.55130E-11,1.05651E-10,1.16740E-10, &amp; <a name='1608'>
      1.28858E-10,1.42089E-10,1.56519E-10,1.72243E-10,1.89361E-10, &amp; <a name='1609'>
      2.07978E-10,2.28209E-10,2.50173E-10,2.73999E-10,2.99820E-10, &amp; <a name='1610'>
      3.27782E-10,3.58034E-10,3.90739E-10,4.26067E-10,4.64196E-10, &amp; <a name='1611'>
      5.05317E-10,5.49631E-10,5.97347E-10,6.48689E-10,7.03891E-10/               <a name='1612'>
      DATA (TOTPLNK(IDATA,15),IDATA=51,100)/ &amp;                                              <a name='1613'>
      7.63201E-10,8.26876E-10,8.95192E-10,9.68430E-10,1.04690E-09, &amp; <a name='1614'>
      1.13091E-09,1.22079E-09,1.31689E-09,1.41957E-09,1.52922E-09, &amp; <a name='1615'>
      1.64623E-09,1.77101E-09,1.90401E-09,2.04567E-09,2.19647E-09, &amp; <a name='1616'>
      2.35690E-09,2.52749E-09,2.70875E-09,2.90127E-09,3.10560E-09, &amp; <a name='1617'>
      3.32238E-09,3.55222E-09,3.79578E-09,4.05375E-09,4.32682E-09, &amp; <a name='1618'>
      4.61574E-09,4.92128E-09,5.24420E-09,5.58536E-09,5.94558E-09, &amp; <a name='1619'>
      6.32575E-09,6.72678E-09,7.14964E-09,7.59526E-09,8.06470E-09, &amp; <a name='1620'>
      8.55897E-09,9.07916E-09,9.62638E-09,1.02018E-08,1.08066E-08, &amp; <a name='1621'>
      1.14420E-08,1.21092E-08,1.28097E-08,1.35446E-08,1.43155E-08, &amp; <a name='1622'>
      1.51237E-08,1.59708E-08,1.68581E-08,1.77873E-08,1.87599E-08/               <a name='1623'>
      DATA (TOTPLNK(IDATA,15),IDATA=101,150)/ &amp;                                             <a name='1624'>
      1.97777E-08,2.08423E-08,2.19555E-08,2.31190E-08,2.43348E-08, &amp; <a name='1625'>
      2.56045E-08,2.69302E-08,2.83140E-08,2.97578E-08,3.12636E-08, &amp; <a name='1626'>
      3.28337E-08,3.44702E-08,3.61755E-08,3.79516E-08,3.98012E-08, &amp; <a name='1627'>
      4.17265E-08,4.37300E-08,4.58143E-08,4.79819E-08,5.02355E-08, &amp; <a name='1628'>
      5.25777E-08,5.50114E-08,5.75393E-08,6.01644E-08,6.28896E-08, &amp; <a name='1629'>
      6.57177E-08,6.86521E-08,7.16959E-08,7.48520E-08,7.81239E-08, &amp; <a name='1630'>
      8.15148E-08,8.50282E-08,8.86675E-08,9.24362E-08,9.63380E-08, &amp; <a name='1631'>
      1.00376E-07,1.04555E-07,1.08878E-07,1.13349E-07,1.17972E-07, &amp; <a name='1632'>
      1.22751E-07,1.27690E-07,1.32793E-07,1.38064E-07,1.43508E-07, &amp; <a name='1633'>
      1.49129E-07,1.54931E-07,1.60920E-07,1.67099E-07,1.73473E-07/               <a name='1634'>
      DATA (TOTPLNK(IDATA,15),IDATA=151,181)/ &amp;                                             <a name='1635'>
      1.80046E-07,1.86825E-07,1.93812E-07,2.01014E-07,2.08436E-07, &amp; <a name='1636'>
      2.16082E-07,2.23957E-07,2.32067E-07,2.40418E-07,2.49013E-07, &amp; <a name='1637'>
      2.57860E-07,2.66963E-07,2.76328E-07,2.85961E-07,2.95868E-07, &amp; <a name='1638'>
      3.06053E-07,3.16524E-07,3.27286E-07,3.38345E-07,3.49707E-07, &amp; <a name='1639'>
      3.61379E-07,3.73367E-07,3.85676E-07,3.98315E-07,4.11287E-07, &amp; <a name='1640'>
      4.24602E-07,4.38265E-07,4.52283E-07,4.66662E-07,4.81410E-07, &amp; <a name='1641'>
      4.96535E-07/                                                               <a name='1642'>
      DATA (TOTPLNK(IDATA,16),IDATA=1,50)/ &amp;                                                <a name='1643'>
      4.65378E-13,5.41927E-13,6.29913E-13,7.30869E-13,8.46510E-13, &amp; <a name='1644'>
      9.78750E-13,1.12972E-12,1.30181E-12,1.49764E-12,1.72016E-12, &amp; <a name='1645'>
      1.97260E-12,2.25858E-12,2.58206E-12,2.94744E-12,3.35955E-12, &amp; <a name='1646'>
      3.82372E-12,4.34581E-12,4.93225E-12,5.59010E-12,6.32711E-12, &amp; <a name='1647'>
      7.15171E-12,8.07317E-12,9.10159E-12,1.02480E-11,1.15244E-11, &amp; <a name='1648'>
      1.29438E-11,1.45204E-11,1.62697E-11,1.82084E-11,2.03545E-11, &amp; <a name='1649'>
      2.27278E-11,2.53494E-11,2.82424E-11,3.14313E-11,3.49431E-11, &amp; <a name='1650'>
      3.88064E-11,4.30522E-11,4.77139E-11,5.28273E-11,5.84308E-11, &amp; <a name='1651'>
      6.45658E-11,7.12764E-11,7.86103E-11,8.66176E-11,9.53534E-11, &amp; <a name='1652'>
      1.04875E-10,1.15245E-10,1.26528E-10,1.38796E-10,1.52123E-10/               <a name='1653'>
      DATA (TOTPLNK(IDATA,16),IDATA=51,100)/ &amp;                                              <a name='1654'>
      1.66590E-10,1.82281E-10,1.99287E-10,2.17704E-10,2.37632E-10, &amp; <a name='1655'>
      2.59182E-10,2.82468E-10,3.07610E-10,3.34738E-10,3.63988E-10, &amp; <a name='1656'>
      3.95504E-10,4.29438E-10,4.65951E-10,5.05212E-10,5.47402E-10, &amp; <a name='1657'>
      5.92707E-10,6.41329E-10,6.93477E-10,7.49371E-10,8.09242E-10, &amp; <a name='1658'>
      8.73338E-10,9.41911E-10,1.01524E-09,1.09359E-09,1.17728E-09, &amp; <a name='1659'>
      1.26660E-09,1.36190E-09,1.46350E-09,1.57177E-09,1.68709E-09, &amp; <a name='1660'>
      1.80984E-09,1.94044E-09,2.07932E-09,2.22693E-09,2.38373E-09, &amp; <a name='1661'>
      2.55021E-09,2.72689E-09,2.91429E-09,3.11298E-09,3.32353E-09, &amp; <a name='1662'>
      3.54655E-09,3.78265E-09,4.03251E-09,4.29679E-09,4.57620E-09, &amp; <a name='1663'>
      4.87148E-09,5.18341E-09,5.51276E-09,5.86037E-09,6.22708E-09/               <a name='1664'>
      DATA (TOTPLNK(IDATA,16),IDATA=101,150)/ &amp;                                             <a name='1665'>
      6.61381E-09,7.02145E-09,7.45097E-09,7.90336E-09,8.37967E-09, &amp; <a name='1666'>
      8.88092E-09,9.40827E-09,9.96280E-09,1.05457E-08,1.11583E-08, &amp; <a name='1667'>
      1.18017E-08,1.24773E-08,1.31865E-08,1.39306E-08,1.47111E-08, &amp; <a name='1668'>
      1.55295E-08,1.63872E-08,1.72860E-08,1.82274E-08,1.92132E-08, &amp; <a name='1669'>
      2.02450E-08,2.13247E-08,2.24541E-08,2.36352E-08,2.48699E-08, &amp; <a name='1670'>
      2.61602E-08,2.75082E-08,2.89161E-08,3.03860E-08,3.19203E-08, &amp; <a name='1671'>
      3.35213E-08,3.51913E-08,3.69330E-08,3.87486E-08,4.06411E-08, &amp; <a name='1672'>
      4.26129E-08,4.46668E-08,4.68058E-08,4.90325E-08,5.13502E-08, &amp; <a name='1673'>
      5.37617E-08,5.62703E-08,5.88791E-08,6.15915E-08,6.44107E-08, &amp; <a name='1674'>
      6.73404E-08,7.03841E-08,7.35453E-08,7.68278E-08,8.02355E-08/               <a name='1675'>
      DATA (TOTPLNK(IDATA,16),IDATA=151,181)/ &amp;                                             <a name='1676'>
      8.37721E-08,8.74419E-08,9.12486E-08,9.51968E-08,9.92905E-08, &amp; <a name='1677'>
      1.03534E-07,1.07932E-07,1.12490E-07,1.17211E-07,1.22100E-07, &amp; <a name='1678'>
      1.27163E-07,1.32404E-07,1.37829E-07,1.43443E-07,1.49250E-07, &amp; <a name='1679'>
      1.55257E-07,1.61470E-07,1.67893E-07,1.74532E-07,1.81394E-07, &amp; <a name='1680'>
      1.88485E-07,1.95810E-07,2.03375E-07,2.11189E-07,2.19256E-07, &amp; <a name='1681'>
      2.27583E-07,2.36177E-07,2.45046E-07,2.54196E-07,2.63634E-07, &amp; <a name='1682'>
      2.73367E-07/                                                               <a name='1683'>
                                                                                 <a name='1684'>
      DATA (TOTPLK16(IDATA),IDATA=1,50)/ &amp;                                                  <a name='1685'>
      4.46128E-13,5.19008E-13,6.02681E-13,6.98580E-13,8.08302E-13, &amp; <a name='1686'>
      9.33629E-13,1.07654E-12,1.23925E-12,1.42419E-12,1.63407E-12, &amp; <a name='1687'>
      1.87190E-12,2.14099E-12,2.44498E-12,2.78793E-12,3.17424E-12, &amp; <a name='1688'>
      3.60881E-12,4.09698E-12,4.64461E-12,5.25813E-12,5.94456E-12, &amp; <a name='1689'>
      6.71156E-12,7.56752E-12,8.52154E-12,9.58357E-12,1.07644E-11, &amp; <a name='1690'>
      1.20758E-11,1.35304E-11,1.51420E-11,1.69256E-11,1.88973E-11, &amp; <a name='1691'>
      2.10746E-11,2.34762E-11,2.61227E-11,2.90356E-11,3.22388E-11, &amp; <a name='1692'>
      3.57574E-11,3.96187E-11,4.38519E-11,4.84883E-11,5.35616E-11, &amp; <a name='1693'>
      5.91075E-11,6.51647E-11,7.17743E-11,7.89797E-11,8.68284E-11, &amp; <a name='1694'>
      9.53697E-11,1.04658E-10,1.14748E-10,1.25701E-10,1.37582E-10/               <a name='1695'>
      DATA (TOTPLK16(IDATA),IDATA=51,100)/ &amp;                                                <a name='1696'>
      1.50457E-10,1.64400E-10,1.79487E-10,1.95799E-10,2.13422E-10, &amp; <a name='1697'>
      2.32446E-10,2.52970E-10,2.75094E-10,2.98925E-10,3.24578E-10, &amp; <a name='1698'>
      3.52172E-10,3.81833E-10,4.13695E-10,4.47897E-10,4.84588E-10, &amp; <a name='1699'>
      5.23922E-10,5.66063E-10,6.11182E-10,6.59459E-10,7.11081E-10, &amp; <a name='1700'>
      7.66251E-10,8.25172E-10,8.88065E-10,9.55155E-10,1.02668E-09, &amp; <a name='1701'>
      1.10290E-09,1.18406E-09,1.27044E-09,1.36233E-09,1.46002E-09, &amp; <a name='1702'>
      1.56382E-09,1.67406E-09,1.79108E-09,1.91522E-09,2.04686E-09, &amp; <a name='1703'>
      2.18637E-09,2.33416E-09,2.49063E-09,2.65622E-09,2.83136E-09, &amp; <a name='1704'>
      3.01653E-09,3.21221E-09,3.41890E-09,3.63712E-09,3.86740E-09, &amp; <a name='1705'>
      4.11030E-09,4.36641E-09,4.63631E-09,4.92064E-09,5.22003E-09/               <a name='1706'>
      DATA (TOTPLK16(IDATA),IDATA=101,150)/ &amp;                                               <a name='1707'>
      5.53516E-09,5.86670E-09,6.21538E-09,6.58191E-09,6.96708E-09, &amp; <a name='1708'>
      7.37165E-09,7.79645E-09,8.24229E-09,8.71007E-09,9.20066E-09, &amp; <a name='1709'>
      9.71498E-09,1.02540E-08,1.08186E-08,1.14100E-08,1.20290E-08, &amp; <a name='1710'>
      1.26767E-08,1.33544E-08,1.40630E-08,1.48038E-08,1.55780E-08, &amp; <a name='1711'>
      1.63867E-08,1.72313E-08,1.81130E-08,1.90332E-08,1.99932E-08, &amp; <a name='1712'>
      2.09945E-08,2.20385E-08,2.31267E-08,2.42605E-08,2.54416E-08, &amp; <a name='1713'>
      2.66716E-08,2.79520E-08,2.92846E-08,3.06711E-08,3.21133E-08, &amp; <a name='1714'>
      3.36128E-08,3.51717E-08,3.67918E-08,3.84749E-08,4.02232E-08, &amp; <a name='1715'>
      4.20386E-08,4.39231E-08,4.58790E-08,4.79083E-08,5.00132E-08, &amp; <a name='1716'>
      5.21961E-08,5.44592E-08,5.68049E-08,5.92356E-08,6.17537E-08/               <a name='1717'>
      DATA (TOTPLK16(IDATA),IDATA=151,181)/ &amp;                                               <a name='1718'>
      6.43617E-08,6.70622E-08,6.98578E-08,7.27511E-08,7.57449E-08, &amp; <a name='1719'>
      7.88419E-08,8.20449E-08,8.53568E-08,8.87805E-08,9.23190E-08, &amp; <a name='1720'>
      9.59753E-08,9.97526E-08,1.03654E-07,1.07682E-07,1.11841E-07, &amp; <a name='1721'>
      1.16134E-07,1.20564E-07,1.25135E-07,1.29850E-07,1.34712E-07, &amp; <a name='1722'>
      1.39726E-07,1.44894E-07,1.50221E-07,1.55711E-07,1.61367E-07, &amp; <a name='1723'>
      1.67193E-07,1.73193E-07,1.79371E-07,1.85732E-07,1.92279E-07, &amp; <a name='1724'>
      1.99016E-07/                                                               <a name='1725'>
<a name='1726'>
                                                            <a name='1727'>
                <a name='1728'>
<a name='1729'>
CONTAINS<a name='1730'>
<a name='1731'>
<font color=#447700>!------------------------------------------------------------------<a name='1732'></font>
<A NAME='RRTMLWRAD'><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTMLWRAD' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1733'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>RRTMLWRAD</font>(                                          &amp; <A href='../../call_to/RRTMLWRAD.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMLWRAD.html' TARGET='index'>6</A><a name='1734'>
                        p_top                                     &amp;<a name='1735'>
                       ,rthraten,glw,olr,emiss                    &amp;<a name='1736'>
                       ,p8w,p3d,pi3d                              &amp;<a name='1737'>
                       ,dz8w,tsk,t3d,t8w,rho3d,r,g                &amp;<a name='1738'>
                       ,icloud, warm_rain                         &amp;<a name='1739'>
                       ,ids,ide, jds,jde, kds,kde                 &amp; <a name='1740'>
                       ,ims,ime, jms,jme, kms,kme                 &amp;<a name='1741'>
                       ,its,ite, jts,jte, kts,kte                 &amp;<a name='1742'>
                       ,qv3d,qc3d,qr3d                            &amp;<a name='1743'>
                       ,qi3d,qs3d,qg3d,cldfra3d                   &amp;<a name='1744'>
                       ,f_qv,f_qc,f_qr,f_qi,f_qs,f_qg             &amp;<a name='1745'>
<font color=#447700>!ccc Added for time-varying trace gases.<a name='1746'></font>
                       ,yr, julian                                )<a name='1747'>
<font color=#447700>!ccc<a name='1748'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1749'></font>
<font color=#447700>!ccc<a name='1750'></font>
   USE <A href='../../html_code/phys/module_ra_clWRF_support.F.html#MODULE_RA_CLWRF_SUPPORT'>MODULE_RA_CLWRF_SUPPORT</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTMLWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_CLWRF_SUPPORT_2">, ONLY :  read_CAMgases<a name='1751'>
<font color=#447700>!ccc<a name='1752'></font>
   <a name='1753'>
   IMPLICIT NONE<a name='1754'>
<font color=#447700>!------------------------------------------------------------------<a name='1755'></font>
   LOGICAL, INTENT(IN )      ::        warm_rain<a name='1756'>
<font color=#447700>!<a name='1757'></font>
   INTEGER, INTENT(IN )      ::        ids,ide, jds,jde, kds,kde, &amp;<a name='1758'>
                                       ims,ime, jms,jme, kms,kme, &amp;<a name='1759'>
                                       its,ite, jts,jte, kts,kte<a name='1760'>
<a name='1761'>
   INTEGER, INTENT(IN )      ::        ICLOUD<a name='1762'>
<font color=#447700>!<a name='1763'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='1764'>
         INTENT(IN   ) ::                                   dz8w, &amp;<a name='1765'>
                                                             T3D, &amp;<a name='1766'>
                                                             t8w, &amp;<a name='1767'>
                                                             p8w, &amp;<a name='1768'>
                                                             P3D, &amp;<a name='1769'>
                                                            pi3D, &amp;<a name='1770'>
                                                           rho3D<a name='1771'>
<font color=#447700>!<a name='1772'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='1773'>
         INTENT(INOUT)  ::                              RTHRATEN<a name='1774'>
<font color=#447700>!<a name='1775'></font>
   REAL, DIMENSION( ims:ime, jms:jme )                          , &amp;<a name='1776'>
         INTENT(IN   )  ::                                 EMISS, &amp;<a name='1777'>
                                                             TSK<a name='1778'>
<font color=#447700>!<a name='1779'></font>
   REAL, DIMENSION( ims:ime, jms:jme )                          , &amp;<a name='1780'>
         INTENT(INOUT)  ::                                   GLW, &amp;<a name='1781'>
                                                             OLR<a name='1782'>
<font color=#447700>!<a name='1783'></font>
   REAL, INTENT(IN  )   ::                                   R,G<a name='1784'>
<a name='1785'>
<font color=#447700>!ccc Added for time-varying trace gases.<a name='1786'></font>
   INTEGER, INTENT(IN ) ::                                    yr<a name='1787'>
   REAL, INTENT(IN )    ::                                julian<a name='1788'>
<font color=#447700>!ccc<a name='1789'></font>
<a name='1790'>
<font color=#447700>!<a name='1791'></font>
<font color=#447700>! Optional<a name='1792'></font>
<font color=#447700>!<a name='1793'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='1794'>
         OPTIONAL                                               , &amp;<a name='1795'>
         INTENT(IN   ) ::                                         &amp;<a name='1796'>
                                                        CLDFRA3D, &amp;<a name='1797'>
                                                            QV3D, &amp;<a name='1798'>
                                                            QC3D, &amp;<a name='1799'>
                                                            QR3D, &amp;<a name='1800'>
                                                            QI3D, &amp;<a name='1801'>
                                                            QS3D, &amp;<a name='1802'>
                                                            QG3D<a name='1803'>
<a name='1804'>
   LOGICAL, OPTIONAL, INTENT(IN )      ::        F_QV,F_QC,F_QR,F_QI,F_QS,F_QG<a name='1805'>
<a name='1806'>
<font color=#447700>!  LOCAL VARS<a name='1807'></font>
 <a name='1808'>
   REAL, DIMENSION( kts:kte+1 ) ::                          Pw1D, &amp;<a name='1809'>
                                                            Tw1D<a name='1810'>
<a name='1811'>
   REAL, DIMENSION( kts:kte ) ::                          TTEN1D, &amp;<a name='1812'>
                                                        CLDFRA1D, &amp;<a name='1813'>
                                                            DZ1D, &amp;<a name='1814'>
                                                             P1D, &amp;<a name='1815'>
                                                             T1D, &amp;<a name='1816'>
                                                            QV1D, &amp;<a name='1817'>
                                                            QC1D, &amp;<a name='1818'>
                                                            QR1D, &amp;<a name='1819'>
                                                            QI1D, &amp;<a name='1820'>
                                                            QS1D, &amp;<a name='1821'>
                                                            QG1D<a name='1822'>
<font color=#447700>!<a name='1823'></font>
    REAL   ::                              TSFC,GLW0,OLR0,EMISS0<a name='1824'>
<font color=#447700>!<a name='1825'></font>
    INTEGER:: i,j,K,NK<a name='1826'>
    LOGICAL :: predicate<a name='1827'>
<a name='1828'>
<font color=#447700>! Add variables for variable trace gas concentrations (ccc)<a name='1829'></font>
    REAL(8)  :: co2vmr, n2ovmr, ch4vmr<a name='1830'>
    LOGICAL, EXTERNAL :: wrf_dm_on_monitor<a name='1831'>
    CHARACTER(LEN=256) :: message<a name='1832'>
<a name='1833'>
<font color=#447700>! p_top for vertical nesting<a name='1834'></font>
    REAL, INTENT(IN   ) :: p_top<a name='1835'>
<a name='1836'>
<font color=#447700>!------------------------------------------------------------------<a name='1837'></font>
<a name='1838'>
    IF ( p_top .GT. 0 ) THEN <font color=#447700>! flag value for NMM = -1<a name='1839'></font>
<font color=#447700>!            NLAYERS is recalculated<a name='1840'></font>
<font color=#447700>!            every time the radiation scheme is called. This is<a name='1841'></font>
<font color=#447700>!            necessary if e_vert parent .NE. e_vert nest since<a name='1842'></font>
<font color=#447700>!            NLAYERS could then be different for each domain.<a name='1843'></font>
       CALL <A href='../../html_code/phys/module_ra_rrtm.F.html#RRTMINIT'>rrtminit</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTMLWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMINIT_2">(                               &amp;<a name='1844'>
                      p_top, .FALSE. ,              &amp;<a name='1845'>
                      ids, ide, jds, jde, kds, kde, &amp;<a name='1846'>
                      ims, ime, jms, jme, kms, kme, &amp;<a name='1847'>
                      its, ite, jts, jte, kts, kte  )<a name='1848'>
    END IF<a name='1849'>
<a name='1850'>
<font color=#447700>!----- Calculate the trace gas concentrations from file.<a name='1851'></font>
<font color=#447700>!ccc<a name='1852'></font>
#ifdef CLWRFGHG<a name='1853'>
   CALL <A href='../../html_code/phys/module_ra_clWRF_support.F.html#READ_CAMGASES'>read_CAMgases</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTMLWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="READ_CAMGASES_2">(yr,julian,"RRTM",co2vmr,n2ovmr,ch4vmr)<a name='1854'>
#else<a name='1855'>
<font color=#447700>! values used in pre-V3.5<a name='1856'></font>
<font color=#447700>!  co2vmr = 330.e-6<a name='1857'></font>
<font color=#447700>!  n2ovmr = 0.<a name='1858'></font>
<font color=#447700>!  ch4vmr = 0.<a name='1859'></font>
<font color=#447700>! values updated to RRTMG in V3.5<a name='1860'></font>
   co2vmr = 379.e-6<a name='1861'>
   n2ovmr = 319.e-9<a name='1862'>
   ch4vmr = 1774.e-9<a name='1863'>
#endif<a name='1864'>
 <a name='1865'>
  IF ( wrf_dm_on_monitor() ) THEN<a name='1866'>
     WRITE(message,*)'CAM-CLWRF interpolated values______ year:',yr,' julian day:',julian<a name='1867'>
     call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTMLWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_775">( 100, message)<a name='1868'>
     WRITE(message,*)'  CAM-CLWRF co2vmr: ',co2vmr,' n2ovmr:',n2ovmr,' ch4vmr:',ch4vmr<a name='1869'>
     call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTMLWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_776">( 100, message)<a name='1870'>
   ENDIF<a name='1871'>
<a name='1872'>
<a name='1873'>
<font color=#447700>!-----CALCULATE LONG WAVE RADIATION<a name='1874'></font>
<font color=#447700>!                                                              <a name='1875'></font>
   j_loop: DO J=jts,jte<a name='1876'>
   i_loop: DO I=its,ite<a name='1877'>
<a name='1878'>
<font color=#447700>! reverse vars <a name='1879'></font>
<font color=#447700>! p1D pw1D are in mb<a name='1880'></font>
<a name='1881'>
         do k=kts,kte+1<a name='1882'>
            NK=kme-k+kms<a name='1883'>
            Pw1D(K) = p8w(I,NK,J)/100.<a name='1884'>
            Tw1D(K) = t8w(I,NK,J)<a name='1885'>
         enddo<a name='1886'>
<a name='1887'>
         DO K=kts,kte<a name='1888'>
            QV1D(K)=0.<a name='1889'>
            QC1D(K)=0.<a name='1890'>
            QR1D(K)=0.<a name='1891'>
            QI1D(K)=0.<a name='1892'>
            QS1D(K)=0.<a name='1893'>
            CLDFRA1D(k)=0.<a name='1894'>
         ENDDO<a name='1895'>
<a name='1896'>
         DO K=kts,kte<a name='1897'>
            NK=kme-1-K+kms<a name='1898'>
            QV1D(K)=QV3D(I,NK,J)<a name='1899'>
            QV1D(K)=max(0.,QV1D(K))<a name='1900'>
         ENDDO<a name='1901'>
<a name='1902'>
         DO K=kts,kte<a name='1903'>
            NK=kme-1-K+kms<a name='1904'>
            TTEN1D(K)=0.<a name='1905'>
            T1D(K)=T3D(I,NK,J)<a name='1906'>
            P1D(K)=P3D(I,NK,J)/100.<a name='1907'>
            DZ1D(K)=dz8w(I,NK,J)<a name='1908'>
         ENDDO<a name='1909'>
<a name='1910'>
         IF (ICLOUD .ne. 0) THEN<a name='1911'>
            IF ( PRESENT( CLDFRA3D ) ) THEN<a name='1912'>
              DO K=kts,kte<a name='1913'>
                 NK=kme-1-K+kms<a name='1914'>
                 CLDFRA1D(k)=CLDFRA3D(I,NK,J)<a name='1915'>
              ENDDO<a name='1916'>
            ENDIF<a name='1917'>
<a name='1918'>
            IF (PRESENT(F_QC) .AND. PRESENT(QC3D)) THEN<a name='1919'>
              IF ( F_QC) THEN<a name='1920'>
                 DO K=kts,kte<a name='1921'>
                    NK=kme-1-K+kms<a name='1922'>
                    QC1D(K)=QC3D(I,NK,J)<a name='1923'>
                    QC1D(K)=max(0.,QC1D(K))<a name='1924'>
                 ENDDO<a name='1925'>
              ENDIF<a name='1926'>
            ENDIF<a name='1927'>
<a name='1928'>
            IF (PRESENT(F_QR) .AND. PRESENT(QR3D)) THEN<a name='1929'>
              IF ( F_QR) THEN<a name='1930'>
                 DO K=kts,kte<a name='1931'>
                    NK=kme-1-K+kms<a name='1932'>
                    QR1D(K)=QR3D(I,NK,J)<a name='1933'>
                    QR1D(K)=max(0.,QR1D(K))<a name='1934'>
                 ENDDO<a name='1935'>
              ENDIF<a name='1936'>
            ENDIF<a name='1937'>
<a name='1938'>
<font color=#447700>! This logic is tortured because cannot test F_QI unless<a name='1939'></font>
<font color=#447700>! it is present, and order of evaluation of expressions<a name='1940'></font>
<font color=#447700>! is not specified in Fortran<a name='1941'></font>
<a name='1942'>
            IF ( PRESENT ( F_QI ) ) THEN<a name='1943'>
              predicate = F_QI<a name='1944'>
            ELSE<a name='1945'>
              predicate = .FALSE.<a name='1946'>
            ENDIF<a name='1947'>
<a name='1948'>
            IF (.NOT. predicate .and. .not. warm_rain) THEN<a name='1949'>
               DO K=kts,kte<a name='1950'>
                  IF (T1D(K) .lt. 273.15) THEN<a name='1951'>
                  QI1D(K)=QC1D(K)<a name='1952'>
                  QS1D(K)=QR1D(K)<a name='1953'>
                  QC1D(K)=0.<a name='1954'>
                  QR1D(K)=0.<a name='1955'>
                  ENDIF<a name='1956'>
               ENDDO<a name='1957'>
            ENDIF<a name='1958'>
<a name='1959'>
            IF (PRESENT(F_QI) .AND. PRESENT(QI3D)) THEN<a name='1960'>
               DO K=kts,kte<a name='1961'>
                  NK=kme-1-K+kms<a name='1962'>
                  QI1D(K)=QI3D(I,NK,J)<a name='1963'>
                  QI1D(K)=max(0.,QI1D(K))<a name='1964'>
               ENDDO<a name='1965'>
            ENDIF<a name='1966'>
<a name='1967'>
            IF (PRESENT(F_QS) .AND. PRESENT(QS3D)) THEN<a name='1968'>
               IF (F_QS) THEN<a name='1969'>
                  DO K=kts,kte<a name='1970'>
                     NK=kme-1-K+kms<a name='1971'>
                     QS1D(K)=QS3D(I,NK,J)<a name='1972'>
                     QS1D(K)=max(0.,QS1D(K))<a name='1973'>
                  ENDDO<a name='1974'>
               ENDIF<a name='1975'>
            ENDIF<a name='1976'>
<a name='1977'>
            IF (PRESENT(F_QG) .AND. PRESENT(QG3D)) THEN<a name='1978'>
               IF (F_QG) THEN<a name='1979'>
                  DO K=kts,kte<a name='1980'>
                     NK=kme-1-K+kms<a name='1981'>
                     QG1D(K)=QG3D(I,NK,J)<a name='1982'>
                     QG1D(K)=max(0.,QG1D(K))<a name='1983'>
                  ENDDO<a name='1984'>
               ENDIF<a name='1985'>
            ENDIF<a name='1986'>
<a name='1987'>
         ENDIF<a name='1988'>
<a name='1989'>
         EMISS0=EMISS(I,J)<a name='1990'>
         GLW0=0. <a name='1991'>
         OLR0=0. <a name='1992'>
         TSFC=TSK(I,J)<a name='1993'>
<a name='1994'>
         CALL <A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM'>RRTM</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTMLWRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTM_1">(tten1d,glw0,olr0,tsfc,cldfra1d,t1d,tw1d,qv1d,qc1d,   &amp;<a name='1995'>
                   qr1d,qi1d,qs1d,qg1d,p1d,pW1d,dz1d,              &amp;<a name='1996'>
                   emiss0,r,g,                                     &amp;<a name='1997'>
<font color=#447700>!ccc Added for time-varying trace gases.<a name='1998'></font>
                   co2vmr, n2ovmr, ch4vmr,                             &amp;<a name='1999'>
<font color=#447700>!ccc<a name='2000'></font>
                   kts,kte                                         )<a name='2001'>
 <a name='2002'>
         GLW(I,J)=GLW0<a name='2003'>
         OLR(I,J)=OLR0 <a name='2004'>
 <a name='2005'>
         DO K=kts,kte<a name='2006'>
            nk=kme-1-k+kms<a name='2007'>
            rthraten(i,k,j)=rthraten(i,k,j)+tten1d(nk)/pi3d(i,k,j)<a name='2008'>
         ENDDO<a name='2009'>
<a name='2010'>
      END DO i_loop<a name='2011'>
   END DO j_loop                                           <a name='2012'>
<a name='2013'>
<font color=#447700>!-------------------------------------------------------------------<a name='2014'></font>
<a name='2015'>
   END SUBROUTINE RRTMLWRAD<a name='2016'>
<a name='2017'>
<a name='2018'>
<font color=#447700>!****************************************************************************    <a name='2019'></font>
<font color=#447700>!*                                                                          *    <a name='2020'></font>
<font color=#447700>!*                               RRTM                                       *    <a name='2021'></font>
<font color=#447700>!*                                                                          *    <a name='2022'></font>
<font color=#447700>!*                                                                          *    <a name='2023'></font>
<font color=#447700>!*                                                                          *    <a name='2024'></font>
<font color=#447700>!*                   RAPID RADIATIVE TRANSFER MODEL                         *    <a name='2025'></font>
<font color=#447700>!*                                                                          *    <a name='2026'></font>
<font color=#447700>!*                                                                          *    <a name='2027'></font>
<font color=#447700>!*            ATMOSPHERIC AND ENVIRONMENTAL RESEARCH, INC.                  *    <a name='2028'></font>
<font color=#447700>!*                        840 MEMORIAL DRIVE                                *    <a name='2029'></font>
<font color=#447700>!*                        CAMBRIDGE, MA 02139                               *    <a name='2030'></font>
<font color=#447700>!*                                                                          *    <a name='2031'></font>
<font color=#447700>!*                                                                          *    <a name='2032'></font>
<font color=#447700>!*                           ELI J. MLAWER                                  *    <a name='2033'></font>
<font color=#447700>!*                         STEVEN J. TAUBMAN~                               *    <a name='2034'></font>
<font color=#447700>!*                         SHEPARD A. CLOUGH                                *    <a name='2035'></font>
<font color=#447700>!*                                                                          *    <a name='2036'></font>
<font color=#447700>!*                                                                          *    <a name='2037'></font>
<font color=#447700>!*                         ~currently at GFDL                               *    <a name='2038'></font>
<font color=#447700>!*                                                                          *    <a name='2039'></font>
<font color=#447700>!*                                                                          *    <a name='2040'></font>
<font color=#447700>!*                                                                          *    <a name='2041'></font>
<font color=#447700>!*                       email:  mlawer@aer.com                             *    <a name='2042'></font>
<font color=#447700>!*                                                                          *    <a name='2043'></font>
<font color=#447700>!*        The authors wish to acknowledge the contributions of the          *    <a name='2044'></font>
<font color=#447700>!*        following people:  Patrick D. Brown, Michael J. Iacono,           *    <a name='2045'></font>
<font color=#447700>!*        Ronald E. Farren, Luke Chen, Robert Bergstrom.                    *    <a name='2046'></font>
<font color=#447700>!*                                                                          *    <a name='2047'></font>
<font color=#447700>!****************************************************************************    <a name='2048'></font>
                                                                                 <a name='2049'>
<font color=#447700>! *** This version of RRTM has been altered to interface with the                <a name='2050'></font>
<font color=#447700>! *** NCAR MM5 mesoscale model for the calculation of longwave radiative         <a name='2051'></font>
<font color=#447700>! *** transfer (based on a code for interface with CCM model by M. J. Iacono)    <a name='2052'></font>
<font color=#447700>! *** J. Dudhia ; March, 1999                                                    <a name='2053'></font>
<font color=#447700>!---------------------------------------------------------------------<a name='2054'></font>
<A NAME='RRTM'><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2055'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>RRTM</font>(TTEN,GLW,OLR,TSFC,CLDFRA,T,Tw,QV,QC,              &amp; <A href='../../call_to/RRTM.html' TARGET='index'>1</A>,<A href='../../call_from/RRTM.html' TARGET='index'>5</A><a name='2056'>
                   QR,QI,QS,QG,P,Pw,DZ,                              &amp;<a name='2057'>
                   EMISS,R,G,                                        &amp;<a name='2058'>
<font color=#447700>!ccc Added for time-varying trace gases.<a name='2059'></font>
                   CO2VMR, N2OVMR, CH4VMR,                                    &amp;<a name='2060'>
<font color=#447700>!ccc<a name='2061'></font>
                   kts,kte                                           )<a name='2062'>
<font color=#447700>!---------------------------------------------------------------------<a name='2063'></font>
<font color=#447700>! *** This program is the driver for RRTM, the AER LW radiation model.           <a name='2064'></font>
<font color=#447700>!     This routine:                                                              <a name='2065'></font>
<font color=#447700>!     Calls MM5ATM to provide atmosphere in column and boundary values           <a name='2066'></font>
<font color=#447700>!     a) calls GASABS to calculate gaseous optical depths                        <a name='2067'></font>
<font color=#447700>!     b) calls SETCOEF to calculate various quantities needed for                <a name='2068'></font>
<font color=#447700>!        the radiative transfer algorithm                                        <a name='2069'></font>
<font color=#447700>!     c) calls RTRN (for both clear and cloudy columns) to do the                <a name='2070'></font>
<font color=#447700>!        radiative transfer calculation                                          <a name='2071'></font>
<font color=#447700>!     d) passes the necessary flux and cooling rate back to MM5                  <a name='2072'></font>
<font color=#447700>!---------------------------------------------------------------------<a name='2073'></font>
      IMPLICIT NONE<a name='2074'>
<font color=#447700>!---------------------------------------------------------------------<a name='2075'></font>
<a name='2076'>
      INTEGER, INTENT(IN ) ::      kts, kte<a name='2077'>
<font color=#447700>!<a name='2078'></font>
      REAL, DIMENSION( kts:kte+1 ), INTENT(IN   ) ::             Pw, &amp;<a name='2079'>
                                                                 Tw<a name='2080'>
<a name='2081'>
      REAL, DIMENSION( kts:kte ), INTENT(IN   ) ::           CLDFRA, &amp;<a name='2082'>
                                                                  T, &amp;<a name='2083'>
                                                                  P, &amp;<a name='2084'>
                                                                 DZ<a name='2085'>
<font color=#447700>!<a name='2086'></font>
      REAL, DIMENSION( kts:kte ), INTENT(INOUT) ::                   &amp;<a name='2087'>
                                                                 QV<a name='2088'>
      REAL, DIMENSION( kts:kte ), INTENT(IN   ) ::                   &amp;<a name='2089'>
                                                                 QC, &amp;<a name='2090'>
                                                                 QR, &amp;<a name='2091'>
                                                                 QI, &amp;<a name='2092'>
                                                                 QS, &amp;<a name='2093'>
                                                                 QG<a name='2094'>
<font color=#447700>!<a name='2095'></font>
      REAL, DIMENSION( kts:kte ), INTENT(INOUT)::              TTEN<a name='2096'>
<font color=#447700>!   <a name='2097'></font>
      REAL, INTENT(IN  )   ::                           R, G, EMISS<a name='2098'>
<a name='2099'>
<font color=#447700>!ccc Added for time-varying trace gases.<a name='2100'></font>
<font color=#447700>! Trace gases variables<a name='2101'></font>
      REAL(8), INTENT(IN )    ::                                co2vmr, n2ovmr, ch4vmr<a name='2102'>
<font color=#447700>!ccc<a name='2103'></font>
<a name='2104'>
<font color=#447700>!<a name='2105'></font>
      REAL, INTENT(INOUT)  ::                          TSFC,GLW,OLR<a name='2106'>
<a name='2107'>
<font color=#447700>! LOCAL VAR<a name='2108'></font>
<a name='2109'>
      INTEGER, DIMENSION( NGPT,kts:NLAYERS ) ::                ITR<a name='2110'>
<a name='2111'>
      REAL,    DIMENSION( NGPT,kts:NLAYERS ) ::                PFRAC, &amp;<a name='2112'>
                                                               TAUG<a name='2113'>
<a name='2114'>
      REAL,    DIMENSION( 35,kts:NLAYERS )       ::              WKL<a name='2115'>
<a name='2116'>
      REAL,    DIMENSION( MAXXSEC,kts:NLAYERS )  ::              WX<a name='2117'>
<a name='2118'>
      REAL, DIMENSION( kts:kte )  ::                         O3PROF<a name='2119'>
<a name='2120'>
      REAL, DIMENSION( kts:NLAYERS )  ::                      PAVEL, &amp;<a name='2121'>
                                                              TAVEL, &amp;<a name='2122'>
                                                            CLDFRAC, &amp;<a name='2123'>
                                                           TAUCLOUD, &amp;   <a name='2124'>
                                                             COLDRY, &amp; <a name='2125'>
                                                             COLH2O, &amp;<a name='2126'>
                                                             COLCO2, &amp;<a name='2127'>
                                                              COLO3, &amp;<a name='2128'>
                                                             COLN2O, &amp;<a name='2129'>
                                                             COLCH4, &amp;<a name='2130'>
                                                              COLO2, &amp;<a name='2131'>
                                                            CO2MULT, &amp;<a name='2132'>
                                                              FAC00, &amp;<a name='2133'>
                                                              FAC01, &amp;<a name='2134'>
                                                              FAC10, &amp;<a name='2135'>
                                                              FAC11, &amp;<a name='2136'>
                                                             FORFAC, &amp;<a name='2137'>
                                                            SELFFAC, &amp;<a name='2138'>
                                                           SELFFRAC<a name='2139'>
                                                <a name='2140'>
<font color=#447700>!                       <a name='2141'></font>
      INTEGER, DIMENSION( kts:NLAYERS ) ::                  ICLDLYR, &amp;<a name='2142'>
                                                                 JP, &amp;<a name='2143'>
                                                                 JT, &amp;<a name='2144'>
                                                                JT1, &amp;<a name='2145'>
                                                            INDSELF<a name='2146'>
<a name='2147'>
      REAL, DIMENSION(   0:NLAYERS )  ::                         PZ, &amp;<a name='2148'>
                                                                 TZ, &amp;<a name='2149'>
                                                           TOTDFLUX, &amp;<a name='2150'>
                                                           TOTUFLUX, &amp;<a name='2151'>
                                                                HTR<a name='2152'>
<font color=#447700>!     <a name='2153'></font>
      INTEGER ::  I,K,ktep1<a name='2154'>
      INTEGER ::  LAYTROP,LAYSWTCH,LAYLOW<a name='2155'>
      REAL    ::  TBOUND<a name='2156'>
      REAL, DIMENSION(NBANDS) ::  SEMISS<a name='2157'>
<a name='2158'>
<a name='2159'>
<font color=#447700>!---------------------------------------------------------------------------<a name='2160'></font>
<font color=#447700>! RRTM Definitions                                                               <a name='2161'></font>
<font color=#447700>!    NGPT                         ! Total number of g-point subintervals         <a name='2162'></font>
<font color=#447700>!    MXLAY                        ! Maximum number of model layers               <a name='2163'></font>
<font color=#447700>!    NBANDS                       ! Number of longwave spectral bands            <a name='2164'></font>
<font color=#447700>!    PI                           ! Geometric constant                           <a name='2165'></font>
<font color=#447700>!    FLUXFAC                      ! Radiance to flux conversion factor           <a name='2166'></font>
<font color=#447700>!    HEATFAC                      ! Heating rate conversion factor               <a name='2167'></font>
<font color=#447700>!    NG(NBANDS)                   ! Number of g-points per band for input        <a name='2168'></font>
<font color=#447700>!                                   absorption coefficient data                  <a name='2169'></font>
<font color=#447700>!    NSPA(NBANDS),NSPB(NBANDS)    ! Number of reference atmospheres per band     <a name='2170'></font>
<font color=#447700>!    WAVENUM1(NBANDS)             ! Longwave band lower limit (wavenumbers)      <a name='2171'></font>
<font color=#447700>!    WAVENUM2(NBANDS)             ! Longwave band upper limit (wavenumbers)      <a name='2172'></font>
<font color=#447700>!    DELWAVE                      ! Longwave band width (wavenumbers)            <a name='2173'></font>
<font color=#447700>!    NLAYERS                      ! Number of model layers (mkx+1)               <a name='2174'></font>
<font color=#447700>!    PAVEL(MXLAY)                 ! Layer pressures (mb)                         <a name='2175'></font>
<font color=#447700>!    PZ(0:MXLAY)                  ! Level (interface) pressures (mb)             <a name='2176'></font>
<font color=#447700>!    TAVEL(MXLAY)                 ! Layer temperatures (K)                       <a name='2177'></font>
<font color=#447700>!    TZ(0:MXLAY)                  ! Level (interface) temperatures(mb)           <a name='2178'></font>
<font color=#447700>!    TBOUND                       ! Surface temperature (K)                      <a name='2179'></font>
<font color=#447700>!    CLDFRAC(MXLAY)               ! Layer cloud fraction                         <a name='2180'></font>
<font color=#447700>!    TAUCLOUD(MXLAY)              ! Layer cloud optical depth                    <a name='2181'></font>
<font color=#447700>!    ITR(NGPT,MXLAY)              ! Integer look-up table index                  <a name='2182'></font>
<font color=#447700>!    PFRAC(NGPT,MXLAY)            ! Planck fractions                             <a name='2183'></font>
<font color=#447700>!    ICLDLYR(MXLAY)               ! Flag for cloudy layers                       <a name='2184'></font>
<font color=#447700>!    TOTUFLUX(0:MXLAY)            ! Upward longwave flux (W/m2)                  <a name='2185'></font>
<font color=#447700>!    TOTDFLUX(0:MXLAY)            ! Downward longwave flux (W/m2)                <a name='2186'></font>
<font color=#447700>!    FNET(0:MXLAY)                ! Net longwave flux (W/m2)                     <a name='2187'></font>
<font color=#447700>!    HTR(0:MXLAY)                 ! Longwave heating rate (K/day)                <a name='2188'></font>
<font color=#447700>!    CLRNTTOA                     ! Clear-sky TOA outgoing flux (W/m2)           <a name='2189'></font>
<font color=#447700>!    CLRNTSRF                     ! Clear-sky net surface flux (W/m2)            <a name='2190'></font>
<font color=#447700>!    TOTUCLFL(0:MXLAY)            ! Clear-sky upward longwave flux (W/m2)        <a name='2191'></font>
<font color=#447700>!    TOTDCLFL(0:MXLAY)            ! Clear-sky downward longwave flux (W/m2)      <a name='2192'></font>
<font color=#447700>!    FNETC(0:MXLAY)               ! Clear-sky net longwave flux (W/m2)           <a name='2193'></font>
<font color=#447700>!    HTRC(0:MXLAY)                ! Clear-sky longwave heating rate (K/day)      <a name='2194'></font>
<font color=#447700>!                                                                                <a name='2195'></font>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='2196'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='2197'></font>
<font color=#447700>! carry constants.                                                               <a name='2198'></font>
<font color=#447700>!---------------------------------------------------------------------------<a name='2199'></font>
<a name='2200'>
<font color=#447700>!     ktep1=kte+1<a name='2201'></font>
      ktep1=NLAYERS<a name='2202'>
<font color=#447700>!<a name='2203'></font>
<font color=#447700>!    CLOUD EMISSIVITIES (M^2/G)                                                  <a name='2204'></font>
<font color=#447700>!    THESE ARE CONSISTENT WITH LWRAD (ABCW=0.5*(ABUP+ABDOWN))                    <a name='2205'></font>
<font color=#447700>!     <a name='2206'></font>
<font color=#447700>!     ONEMINUS = 1. - 1.E-6                                                      <a name='2207'></font>
<font color=#447700>!     PI   = 2.*ASIN(1.)                                                           <a name='2208'></font>
<font color=#447700>!     FLUXFAC = PI   * 2.D4                     <a name='2209'></font>
<font color=#447700>!<a name='2210'></font>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#INIRAD'>INIRAD</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INIRAD_1"> (O3PROF,Pw,kts,kte)<a name='2211'>
                                                                              <a name='2212'>
<font color=#447700>!  Prepare atmospheric profile from CCM for use in RRTM, and define              <a name='2213'></font>
<font color=#447700>!  other RRTM input parameters.  Arrays are passed back through the              <a name='2214'></font>
<font color=#447700>!  existing RRTM commons and arrays.                                             <a name='2215'></font>
         <a name='2216'>
         CALL <A href='../../html_code/phys/module_ra_rrtm.F.html#MM5ATM'>MM5ATM</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MM5ATM_1">(CLDFRA,O3PROF,T,Tw,TSFC,QV,QC,QR,QI,QS,QG,    &amp;<a name='2217'>
                     P,Pw,DZ,EMISS,R,G,                            &amp;<a name='2218'>
                     PAVEL,TAVEL,PZ,TZ,CLDFRAC,TAUCLOUD,COLDRY,    &amp;<a name='2219'>
                     WKL,WX,TBOUND,SEMISS,                         &amp;<a name='2220'>
<font color=#447700>!ccc Added for time-varying trace gases.<a name='2221'></font>
                     CO2VMR, N2OVMR, CH4VMR,                               &amp;<a name='2222'>
<font color=#447700>!ccc<a name='2223'></font>
                     kts,kte                                       )<a name='2224'>
<a name='2225'>
<font color=#447700>!  Calculate information needed by the radiative transfer routine                <a name='2226'></font>
<font color=#447700>!  that is specific to this atmosphere, especially some of the                   <a name='2227'></font>
<font color=#447700>!  coefficients and indices needed to compute the optical depths                 <a name='2228'></font>
<font color=#447700>!  by interpolating data from stored reference atmospheres.                      <a name='2229'></font>
                                                                                 <a name='2230'>
         CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#SETCOEF'>SETCOEF</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SETCOEF_1">(kts,ktep1,                                   &amp;<a name='2231'>
                      PAVEL,TAVEL,COLDRY,COLH2O,COLCO2,COLO3,      &amp;<a name='2232'>
                      COLN2O,COLCH4,COLO2,CO2MULT,                 &amp;<a name='2233'>
                      FAC00,FAC01,FAC10,FAC11,                     &amp;<a name='2234'>
                      FORFAC,SELFFAC,SELFFRAC,                     &amp;<a name='2235'>
                      JP,JT,JT1,INDSELF,WKL,LAYTROP,LAYSWTCH,LAYLOW)<a name='2236'>
<a name='2237'>
         CALL <A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS'>GASABS</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GASABS_1">(kts,ktep1,                                 &amp;<a name='2238'>
                     COLDRY,COLH2O,COLCO2,COLO3,COLN2O,COLCH4,  &amp;<a name='2239'>
                     COLO2,CO2MULT,                             &amp;<a name='2240'>
                     FAC00,FAC01,FAC10,FAC11,                   &amp;<a name='2241'>
                     FORFAC,SELFFAC,SELFFRAC,                   &amp;<a name='2242'>
                     JP,JT,JT1,INDSELF,ITR,WX,PFRAC,TAUG,       &amp;<a name='2243'>
                     LAYTROP,LAYSWTCH,LAYLOW                    )<a name='2244'>
<a name='2245'>
<font color=#447700>!  Check for cloud in column.  Use original CCM LW threshold: if total           <a name='2246'></font>
<font color=#447700>!  clear sky fraction &lt; 0.999, then column is cloudy, otherwise consider         <a name='2247'></font>
<font color=#447700>!  it clear.  Also, set up flag array, icldlyr, for use in radiative             <a name='2248'></font>
<font color=#447700>!  transfer.  Set icldlyr to one for each layer with cloud.  If tclrsf           <a name='2249'></font>
<font color=#447700>!  is not available, icldlyr can be set from cldfrac alone.                      <a name='2250'></font>
                                                                                 <a name='2251'>
        do 1500 k = 1, nlayers                                                   <a name='2252'>
           if (cldfrac(k).gt.0.) then                                            <a name='2253'>
              icldlyr(k) = 1<a name='2254'>
           else                                                                  <a name='2255'>
              icldlyr(k) = 0                                                     <a name='2256'>
           endif                                                                 <a name='2257'>
 1500   continue                                                                 <a name='2258'>
                                                                                 <a name='2259'>
<font color=#447700>!  Call the radiative transfer routine.                                      <a name='2260'></font>
                                                                                 <a name='2261'>
           CALL <A href='../../html_code/phys/module_ra_rrtm.F.html#RTRN'>RTRN</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RTRN_1">(kts,ktep1,                                  &amp;<a name='2262'>
                     TAVEL, PZ, TZ, CLDFRAC, TAUCLOUD, TOTDFLUX, &amp;<a name='2263'>
                     TOTUFLUX, HTR, ICLDLYR, ITR, PFRAC, TBOUND,SEMISS     )<a name='2264'>
                                                                                 <a name='2265'>
<font color=#447700>!  Pass total sky up and down flux profiles to CCM output arrays and             <a name='2266'></font>
<font color=#447700>!  convert from mks to cgs units for CCM.  Pass clear sky TOA and surface        <a name='2267'></font>
<font color=#447700>!  net fluxes to CCM fields for diagnostics.  Pass total sky heating rate        <a name='2268'></font>
<font color=#447700>!  profile to CCM output arrays and convert units to K/sec.  The vertical        <a name='2269'></font>
<font color=#447700>!  array index (bottom to top in RRTM) is reversed for CCM fields.               <a name='2270'></font>
                                                                                 <a name='2271'>
<font color=#447700>!          flntc(iiplon) = CLRNTTOA*1.e3                                         <a name='2272'></font>
<font color=#447700>!          flnsc(iiplon) = CLRNTSRF*1.e3                                         <a name='2273'></font>
<font color=#447700>!           do 2400 k = 0, NLAYERS-1                                             <a name='2274'></font>
<font color=#447700>!              fulc(k+1) = TOTUCLFL(NLAYERS-1-k)*1.e3                            <a name='2275'></font>
<font color=#447700>!              fdlc(k+1) = TOTDCLFL(NLAYERS-1-k)*1.e3                            <a name='2276'></font>
<font color=#447700>!              ful(k+1) = TOTUFLUX(NLAYERS-1-k)*1.e3                             <a name='2277'></font>
<font color=#447700>!              fdl(k+1) = TOTDFLUX(NLAYERS-1-k)*1.e3                             <a name='2278'></font>
<font color=#447700>! 2400      continue                                                             <a name='2279'></font>
<font color=#447700>!           do 2450 k = 1, NLAYERS-1                                              <a name='2280'></font>
           do 2450 k = 1, kte         <a name='2281'>
<font color=#447700>!              qrlc(k) = HTRC(NLAYERS-1-k)/86400.                                <a name='2282'></font>
<font color=#447700>!              qrl(k) = HTR(NLAYERS-1-k)/86400.                                  <a name='2283'></font>
<font color=#447700>!              TTEN(K)=HTR(NLAYERS-1-k)/86400. <a name='2284'></font>
              TTEN(K)=HTR(kte-k)/86400. <a name='2285'>
 2450      continue                                                              <a name='2286'>
           GLW = TOTDFLUX(0)<a name='2287'>
<font color=#447700>!           OLR = TOTUFLUX(NLAYERS)<a name='2288'></font>
           OLR = TOTUFLUX(kte)<a name='2289'>
<a name='2290'>
   END SUBROUTINE RRTM<a name='2291'>
<a name='2292'>
<a name='2293'>
<font color=#447700>!***************************************************************************     <a name='2294'></font>
<A NAME='CMBGB1'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB1' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2295'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB1</font>(abscoefL, abscoefH, SELFREF,                       &amp; <A href='../../call_to/CMBGB1.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB1.html' TARGET='index'>4</A><a name='2296'>
                     FRACREFA, FRACREFB, FORREF,                        &amp;<a name='2297'>
                     SELFREFC, FORREFC, FRACREFAC, FRACREFBC            )<a name='2298'>
<font color=#447700>!***************************************************************************     <a name='2299'></font>
<font color=#447700>!                                                                                <a name='2300'></font>
<font color=#447700>!  Original version:       Michael J. Iacono; July, 1998                         <a name='2301'></font>
<font color=#447700>!  Revision for NCAR CCM:  Michael J. Iacono; September, 1998                    <a name='2302'></font>
<font color=#447700>!                                                                                <a name='2303'></font>
<font color=#447700>!  The subroutines CMBGB1-&gt;CMBGB16 input the absorption coefficient              <a name='2304'></font>
<font color=#447700>!  data for each band, which are defined for 16 g-points and 16 spectral         <a name='2305'></font>
<font color=#447700>!  bands. The data are combined with appropriate weighting following the         <a name='2306'></font>
<font color=#447700>!  g-point mapping arrays specified in RRTMINIT.  Plank fraction data            <a name='2307'></font>
<font color=#447700>!  in arrays FRACREFA and FRACREFB are combined without weighting.  All          <a name='2308'></font>
<font color=#447700>!  g-point reduced data are put into new arrays for use in RRTM.                 <a name='2309'></font>
<font color=#447700>!                                                                                <a name='2310'></font>
<font color=#447700>!  BAND 1:  10-250 cm-1 (low - H2O; high - H2O)                                  <a name='2311'></font>
<font color=#447700>!***************************************************************************     <a name='2312'></font>
                                                                                 <a name='2313'>
<font color=#447700>! Input                                                                          <a name='2314'></font>
      REAL abscoefL(5,13,MG),abscoefH(5,13:59,MG)<a name='2315'>
      REAL SELFREF(10,MG)              <a name='2316'>
      REAL FRACREFA(MG), FRACREFB(MG), FORREF(MG)<a name='2317'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='2318'></font>
<font color=#447700>! Output                                                                         <a name='2319'></font>
      REAL SELFREFC(10,NG1), FORREFC(NG1)<a name='2320'>
      REAL FRACREFAC(NG1), FRACREFBC(NG1)<a name='2321'>
                                                                                 <a name='2322'>
      DO 2000 JTJT = 1,5                                                           <a name='2323'>
         DO 2200 JPJP = 1,13                                                       <a name='2324'>
            IPRSM = 0                                                            <a name='2325'>
            DO 2400 IGC = 1,NGC(1)                                               <a name='2326'>
               SUMK = 0.                                                         <a name='2327'>
               DO 2600 IPR = 1, NGN(IGC)                                         <a name='2328'>
                  IPRSM = IPRSM + 1                                              <a name='2329'>
                  SUMK = SUMK + abscoefL(JTJT,JPJP,IPRSM)*RWGT(IPRSM)               <a name='2330'>
 2600          CONTINUE                                                          <a name='2331'>
               ABSA1(JTJT+(JPJP-1)*5,IGC) = SUMK<a name='2332'>
 2400       CONTINUE                                                             <a name='2333'>
 2200    CONTINUE                                                                <a name='2334'>
         DO 3200 JPJP = 13,59                                                      <a name='2335'>
            IPRSM = 0                                                            <a name='2336'>
            DO 3400 IGC = 1,NGC(1)                                               <a name='2337'>
               SUMK = 0.                                                         <a name='2338'>
               DO 3600 IPR = 1, NGN(IGC)                                         <a name='2339'>
                  IPRSM = IPRSM + 1                                              <a name='2340'>
                  SUMK = SUMK + abscoefH(JTJT,JPJP,IPRSM)*RWGT(IPRSM)<a name='2341'>
 3600          CONTINUE                                                          <a name='2342'>
               ABSB1(JTJT+(JPJP-13)*5,IGC) = SUMK                                             <a name='2343'>
 3400       CONTINUE                                                             <a name='2344'>
 3200    CONTINUE                                                                <a name='2345'>
 2000 CONTINUE                                                                   <a name='2346'>
                                                                                 <a name='2347'>
      DO 4000 JTJT = 1,10                                                          <a name='2348'>
         IPRSM = 0                                                               <a name='2349'>
         DO 4400 IGC = 1,NGC(1)                                                  <a name='2350'>
            SUMK = 0.                                                            <a name='2351'>
            DO 4600 IPR = 1, NGN(IGC)                                            <a name='2352'>
               IPRSM = IPRSM + 1                                                 <a name='2353'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM)<a name='2354'>
 4600       CONTINUE                                                             <a name='2355'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='2356'>
 4400    CONTINUE                                                                <a name='2357'>
 4000 CONTINUE                                                                   <a name='2358'>
                                                                                 <a name='2359'>
      IPRSM = 0                                                                  <a name='2360'>
      DO 5400 IGC = 1,NGC(1)                                                     <a name='2361'>
         SUMK = 0.                                                               <a name='2362'>
         SUMF1 = 0.                                                              <a name='2363'>
         SUMF2 = 0.                                                              <a name='2364'>
         DO 5600 IPR = 1, NGN(IGC)                                               <a name='2365'>
            IPRSM = IPRSM + 1                                                    <a name='2366'>
            SUMK = SUMK + FORREF(IPRSM)*RWGT(IPRSM)                              <a name='2367'>
            SUMF1= SUMF1+ FRACREFA(IPRSM)                                        <a name='2368'>
            SUMF2= SUMF2+ FRACREFB(IPRSM)                                        <a name='2369'>
 5600    CONTINUE                                                                <a name='2370'>
         FORREFC(IGC) = SUMK                                                     <a name='2371'>
         FRACREFAC(IGC) = SUMF1                                                  <a name='2372'>
         FRACREFBC(IGC) = SUMF2                                                  <a name='2373'>
 5400 CONTINUE                                                                   <a name='2374'>
                                                                                 <a name='2375'>
   END SUBROUTINE CMBGB1<a name='2376'>
<a name='2377'>
<font color=#447700>!***************************************************************************<a name='2378'></font>
<A NAME='CMBGB2'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB2' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2379'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB2</font>(abscoefL, abscoefH, SELFREF,                       &amp; <A href='../../call_to/CMBGB2.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB2.html' TARGET='index'>4</A><a name='2380'>
                    FRACREFA, FRACREFB, FORREF,                        &amp;<a name='2381'>
                    SELFREFC, FORREFC, FRACREFAC, FRACREFBC            )<a name='2382'>
<font color=#447700>!***************************************************************************     <a name='2383'></font>
<font color=#447700>!                                                                                <a name='2384'></font>
<font color=#447700>!     BAND 2:  250-500 cm-1 (low - H2O; high - H2O)                              <a name='2385'></font>
<font color=#447700>!***************************************************************************     <a name='2386'></font>
                                                                                 <a name='2387'>
<font color=#447700>! Input                                                                          <a name='2388'></font>
      REAL abscoefL(5,13,MG),abscoefH(5,13:59,MG)<a name='2389'>
      REAL SELFREF(10,MG)            <a name='2390'>
      REAL FRACREFA(MG,13), FRACREFB(MG), FORREF(MG)<a name='2391'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='2392'></font>
<font color=#447700>! Output                                                                         <a name='2393'></font>
      REAL SELFREFC(10,NG2), FORREFC(NG2)<a name='2394'>
      REAL FRACREFAC(NG2,13), FRACREFBC(NG2)<a name='2395'>
                                                                                 <a name='2396'>
      DO 2000 JTJT = 1,5                                                           <a name='2397'>
         DO 2200 JPJP = 1,13                                                       <a name='2398'>
            IPRSM = 0                                                            <a name='2399'>
            DO 2400 IGC = 1,NGC(2)                                               <a name='2400'>
               SUMK = 0.                                                         <a name='2401'>
               DO 2600 IPR = 1, NGN(NGS(1)+IGC)                                  <a name='2402'>
                  IPRSM = IPRSM + 1                                              <a name='2403'>
                  SUMK = SUMK + abscoefL(JTJT,JPJP,IPRSM)*RWGT(IPRSM+16)<a name='2404'>
 2600          CONTINUE                                                          <a name='2405'>
               ABSA2(JTJT+(JPJP-1)*5,IGC) = SUMK  <a name='2406'>
 2400       CONTINUE                                                             <a name='2407'>
 2200    CONTINUE                                                                <a name='2408'>
         DO 3200 JPJP = 13,59                                                      <a name='2409'>
            IPRSM = 0                                                            <a name='2410'>
            DO 3400 IGC = 1,NGC(2)                                               <a name='2411'>
               SUMK = 0.                                                         <a name='2412'>
               DO 3600 IPR = 1, NGN(NGS(1)+IGC)                                  <a name='2413'>
                  IPRSM = IPRSM + 1                                              <a name='2414'>
                  SUMK = SUMK + abscoefH(JTJT,JPJP,IPRSM)*RWGT(IPRSM+16)<a name='2415'>
 3600          CONTINUE                                                          <a name='2416'>
               ABSB2(JTJT+(JPJP-13)*5,IGC) = SUMK<a name='2417'>
 3400       CONTINUE                                                             <a name='2418'>
 3200    CONTINUE                                                                <a name='2419'>
 2000 CONTINUE                                                                   <a name='2420'>
                                                                                 <a name='2421'>
      DO 4000 JTJT = 1,10                                                          <a name='2422'>
         IPRSM = 0                                                               <a name='2423'>
         DO 4400 IGC = 1,NGC(2)                                                  <a name='2424'>
            SUMK = 0.                                                            <a name='2425'>
            DO 4600 IPR = 1, NGN(NGS(1)+IGC)                                     <a name='2426'>
               IPRSM = IPRSM + 1                                                 <a name='2427'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+16)<a name='2428'>
 4600       CONTINUE                                                             <a name='2429'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='2430'>
 4400    CONTINUE                                                                <a name='2431'>
 4000 CONTINUE                                                                   <a name='2432'>
                                                                                 <a name='2433'>
      DO 5000 JPJP = 1,13                                                          <a name='2434'>
         IPRSM = 0                                                               <a name='2435'>
         DO 5400 IGC = 1,NGC(2)                                                  <a name='2436'>
            SUMF = 0.                                                            <a name='2437'>
            DO 5600 IPR = 1, NGN(NGS(1)+IGC)                                     <a name='2438'>
               IPRSM = IPRSM + 1                                                 <a name='2439'>
               SUMF = SUMF + FRACREFA(IPRSM,JPJP)                                  <a name='2440'>
 5600       CONTINUE                                                             <a name='2441'>
            FRACREFAC(IGC,JPJP) = SUMF                                             <a name='2442'>
 5400    CONTINUE                                                                <a name='2443'>
 5000 CONTINUE                                                                   <a name='2444'>
                                                                                 <a name='2445'>
      IPRSM = 0                                                                  <a name='2446'>
      DO 6400 IGC = 1,NGC(2)                                                     <a name='2447'>
         SUMK = 0.                                                               <a name='2448'>
         SUMF = 0.                                                               <a name='2449'>
         DO 6600 IPR = 1, NGN(NGS(1)+IGC)                                        <a name='2450'>
            IPRSM = IPRSM + 1                                                    <a name='2451'>
            SUMK = SUMK + FORREF(IPRSM)*RWGT(IPRSM+16)                           <a name='2452'>
            SUMF = SUMF + FRACREFB(IPRSM)                                        <a name='2453'>
 6600    CONTINUE                                                                <a name='2454'>
         FORREFC(IGC) = SUMK                                                     <a name='2455'>
         FRACREFBC(IGC) = SUMF                                                   <a name='2456'>
 6400 CONTINUE                                                                   <a name='2457'>
                                                                                 <a name='2458'>
   END SUBROUTINE CMBGB2<a name='2459'>
<a name='2460'>
<font color=#447700>!***************************************************************************<a name='2461'></font>
<A NAME='CMBGB3'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB3' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2462'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB3</font>(abscoefL, abscoefH, SELFREF,                       &amp; <A href='../../call_to/CMBGB3.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB3.html' TARGET='index'>4</A><a name='2463'>
                     FRACREFA, FRACREFB, FORREF, ABSN2OA, ABSN2OB,      &amp;<a name='2464'>
                     SELFREFC, FORREFC,                                 &amp;<a name='2465'>
                     ABSN2OAC, ABSN2OBC, FRACREFAC, FRACREFBC           )<a name='2466'>
<font color=#447700>!***************************************************************************     <a name='2467'></font>
<font color=#447700>!                                                                                <a name='2468'></font>
<font color=#447700>!     BAND 3:  500-630 cm-1 (low - H2O,CO2; high - H2O,CO2)                      <a name='2469'></font>
<font color=#447700>!***************************************************************************     <a name='2470'></font>
                                                                                 <a name='2471'>
<font color=#447700>! Input                                                                          <a name='2472'></font>
      REAL abscoefL(10,5,13,MG),abscoefH(5,5,13:59,MG)<a name='2473'>
      REAL SELFREF(10,MG)   <a name='2474'>
      REAL FRACREFA(MG,10), FRACREFB(MG,5)<a name='2475'>
      REAL FORREF(MG), ABSN2OA(MG), ABSN2OB(MG)     <a name='2476'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='2477'></font>
<font color=#447700>! Output                                                                         <a name='2478'></font>
      REAL SELFREFC(10,NG3), FORREFC(NG3),  &amp;<a name='2479'>
           ABSN2OAC(NG3), ABSN2OBC(NG3) <a name='2480'>
      REAL FRACREFAC(NG3,10), FRACREFBC(NG3,5) <a name='2481'>
                                                                                 <a name='2482'>
      DO 2000 JN = 1,10                                                          <a name='2483'>
         DO 2000 JTJT = 1,5                                                        <a name='2484'>
            DO 2200 JPJP = 1,13                                                    <a name='2485'>
               IPRSM = 0                                                         <a name='2486'>
               DO 2400 IGC = 1,NGC(3)                                            <a name='2487'>
                 SUMK = 0.                                                       <a name='2488'>
                  DO 2600 IPR = 1, NGN(NGS(2)+IGC)                               <a name='2489'>
                     IPRSM = IPRSM + 1                                           <a name='2490'>
                     SUMK = SUMK + abscoefL(JN,JTJT,JPJP,IPRSM)* RWGT(IPRSM+32)<a name='2491'>
 2600             CONTINUE                                                       <a name='2492'>
                  ABSA3(JN+(JTJT-1)*10+(JPJP-1)*50,IGC) = SUMK  <a name='2493'>
 2400          CONTINUE                                                          <a name='2494'>
 2200       CONTINUE                                                             <a name='2495'>
 2000 CONTINUE                                                                   <a name='2496'>
      DO 3000 JN = 1,5                                                           <a name='2497'>
         DO 3000 JTJT = 1,5                                                        <a name='2498'>
            DO 3200 JPJP = 13,59                                                   <a name='2499'>
               IPRSM = 0                                                         <a name='2500'>
               DO 3400 IGC = 1,NGC(3)                                            <a name='2501'>
                  SUMK = 0.                                                      <a name='2502'>
                  DO 3600 IPR = 1, NGN(NGS(2)+IGC)                               <a name='2503'>
                     IPRSM = IPRSM + 1                                           <a name='2504'>
                     SUMK = SUMK + abscoefH(JN,JTJT,JPJP,IPRSM)* RWGT(IPRSM+32)<a name='2505'>
 3600             CONTINUE                                                       <a name='2506'>
                  ABSB3(JN+(JTJT-1)*5+(JPJP-13)*25,IGC) = SUMK<a name='2507'>
 3400          CONTINUE                                                          <a name='2508'>
 3200       CONTINUE                                                             <a name='2509'>
 3000 CONTINUE                                                                   <a name='2510'>
                                                                                 <a name='2511'>
      DO 4000 JTJT = 1,10                                                          <a name='2512'>
         IPRSM = 0                                                               <a name='2513'>
         DO 4400 IGC = 1,NGC(3)                                                  <a name='2514'>
            SUMK = 0.                                                            <a name='2515'>
            SUMF = 0.                                                            <a name='2516'>
            DO 4600 IPR = 1, NGN(NGS(2)+IGC)                                     <a name='2517'>
               IPRSM = IPRSM + 1                                                 <a name='2518'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)* RWGT(IPRSM+32)<a name='2519'>
               SUMF = SUMF + FRACREFA(IPRSM,JTJT)                                  <a name='2520'>
 4600       CONTINUE                                                             <a name='2521'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='2522'>
            FRACREFAC(IGC,JTJT) = SUMF                                             <a name='2523'>
 4400    CONTINUE                                                                <a name='2524'>
 4000 CONTINUE                                                                   <a name='2525'>
                                                                                 <a name='2526'>
      DO 5000 JPJP = 1,5                                                           <a name='2527'>
         IPRSM = 0                                                               <a name='2528'>
         DO 5400 IGC = 1,NGC(3)                                                  <a name='2529'>
            SUMF = 0.                                                            <a name='2530'>
            DO 5600 IPR = 1, NGN(NGS(2)+IGC)                                     <a name='2531'>
               IPRSM = IPRSM + 1                                                 <a name='2532'>
               SUMF = SUMF + FRACREFB(IPRSM,JPJP)                                  <a name='2533'>
 5600       CONTINUE                                                             <a name='2534'>
            FRACREFBC(IGC,JPJP) = SUMF                                             <a name='2535'>
 5400    CONTINUE                                                                <a name='2536'>
 5000 CONTINUE                                                                   <a name='2537'>
                                                                                 <a name='2538'>
      IPRSM = 0                                                                  <a name='2539'>
      DO 6400 IGC = 1,NGC(3)                                                     <a name='2540'>
         SUMK1= 0.                                                               <a name='2541'>
         SUMK2= 0.                                                               <a name='2542'>
         SUMK3= 0.                                                               <a name='2543'>
         DO 6600 IPR = 1, NGN(NGS(2)+IGC)                                        <a name='2544'>
            IPRSM = IPRSM + 1                                                    <a name='2545'>
            SUMK1= SUMK1+ FORREF(IPRSM)*RWGT(IPRSM+32)                           <a name='2546'>
            SUMK2= SUMK2+ ABSN2OA(IPRSM)*RWGT(IPRSM+32)                          <a name='2547'>
            SUMK3= SUMK3+ ABSN2OB(IPRSM)*RWGT(IPRSM+32)                          <a name='2548'>
 6600    CONTINUE                                                                <a name='2549'>
         FORREFC(IGC) = SUMK1                                                    <a name='2550'>
         ABSN2OAC(IGC) = SUMK2                                                   <a name='2551'>
         ABSN2OBC(IGC) = SUMK3                                                   <a name='2552'>
 6400 CONTINUE                                                                   <a name='2553'>
                                                                                 <a name='2554'>
   END SUBROUTINE CMBGB3<a name='2555'>
<a name='2556'>
<font color=#447700>!***************************************************************************<a name='2557'></font>
<A NAME='CMBGB4'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB4' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2558'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB4</font>(abscoefL, abscoefH, SELFREF,                       &amp; <A href='../../call_to/CMBGB4.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB4.html' TARGET='index'>4</A><a name='2559'>
                     FRACREFA, FRACREFB,                                &amp;<a name='2560'>
                     SELFREFC, FRACREFAC, FRACREFBC                     )<a name='2561'>
<font color=#447700>!***************************************************************************     <a name='2562'></font>
<font color=#447700>!                                                                                <a name='2563'></font>
<font color=#447700>!     BAND 4:  630-700 cm-1 (low - H2O,CO2; high - O3,CO2)                       <a name='2564'></font>
<font color=#447700>!***************************************************************************     <a name='2565'></font>
                                                                                 <a name='2566'>
<font color=#447700>! Input                                                                          <a name='2567'></font>
      REAL abscoefL(9,5,13,MG),abscoefH(6,5,13:59,MG)<a name='2568'>
      REAL SELFREF(10,MG)            <a name='2569'>
      REAL FRACREFA(MG,9), FRACREFB(MG,6)<a name='2570'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='2571'></font>
<font color=#447700>! Output                                                                         <a name='2572'></font>
      REAL SELFREFC(10,NG4)<a name='2573'>
      REAL FRACREFAC(NG4,9), FRACREFBC(NG4,6)<a name='2574'>
                                                                                 <a name='2575'>
      DO 2000 JN = 1,9                                                           <a name='2576'>
         DO 2000 JTJT = 1,5                                                        <a name='2577'>
            DO 2200 JPJP = 1,13                                                    <a name='2578'>
               IPRSM = 0                                                         <a name='2579'>
               DO 2400 IGC = 1,NGC(4)                                            <a name='2580'>
                 SUMK = 0.                                                       <a name='2581'>
                  DO 2600 IPR = 1, NGN(NGS(3)+IGC)                               <a name='2582'>
                     IPRSM = IPRSM + 1                                           <a name='2583'>
                     SUMK = SUMK + abscoefL(JN,JTJT,JPJP,IPRSM)*RWGT(IPRSM+48)<a name='2584'>
 2600             CONTINUE                                                       <a name='2585'>
                  ABSA4(JN+(JTJT-1)*9+(JPJP-1)*45,IGC) = SUMK                                       <a name='2586'>
 2400          CONTINUE                                                          <a name='2587'>
 2200       CONTINUE                                                             <a name='2588'>
 2000 CONTINUE                                                                   <a name='2589'>
      DO 3000 JN = 1,6                                                           <a name='2590'>
         DO 3000 JTJT = 1,5                                                        <a name='2591'>
            DO 3200 JPJP = 13,59                                                   <a name='2592'>
               IPRSM = 0                                                         <a name='2593'>
               DO 3400 IGC = 1,NGC(4)                                            <a name='2594'>
                  SUMK = 0.                                                      <a name='2595'>
                  DO 3600 IPR = 1, NGN(NGS(3)+IGC)                               <a name='2596'>
                     IPRSM = IPRSM + 1                                           <a name='2597'>
                     SUMK = SUMK + abscoefH(JN,JTJT,JPJP,IPRSM)*RWGT(IPRSM+48)<a name='2598'>
 3600             CONTINUE                                                       <a name='2599'>
                  ABSB4(JN+(JTJT-1)*6+(JPJP-13)*30,IGC) = SUMK<a name='2600'>
 3400          CONTINUE                                                          <a name='2601'>
 3200       CONTINUE                                                             <a name='2602'>
 3000 CONTINUE                                                                   <a name='2603'>
                                                                                 <a name='2604'>
      DO 4000 JTJT = 1,10                                                          <a name='2605'>
         IPRSM = 0                                                               <a name='2606'>
         DO 4400 IGC = 1,NGC(4)                                                  <a name='2607'>
            SUMK = 0.                                                            <a name='2608'>
            DO 4600 IPR = 1, NGN(NGS(3)+IGC)                                     <a name='2609'>
               IPRSM = IPRSM + 1                                                 <a name='2610'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+48)<a name='2611'>
 4600       CONTINUE                                                             <a name='2612'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='2613'>
 4400    CONTINUE                                                                <a name='2614'>
 4000 CONTINUE                                                                   <a name='2615'>
                                                                                 <a name='2616'>
      DO 5000 JPJP = 1,9                                                           <a name='2617'>
         IPRSM = 0                                                               <a name='2618'>
         DO 5400 IGC = 1,NGC(4)                                                  <a name='2619'>
            SUMF = 0.                                                            <a name='2620'>
            DO 5600 IPR = 1, NGN(NGS(3)+IGC)                                     <a name='2621'>
               IPRSM = IPRSM + 1                                                 <a name='2622'>
               SUMF = SUMF + FRACREFA(IPRSM,JPJP)                                  <a name='2623'>
 5600       CONTINUE                                                             <a name='2624'>
            FRACREFAC(IGC,JPJP) = SUMF                                             <a name='2625'>
 5400    CONTINUE                                                                <a name='2626'>
 5000 CONTINUE                                                                   <a name='2627'>
                                                                                 <a name='2628'>
      DO 6000 JPJP = 1,6                                                           <a name='2629'>
         IPRSM = 0                                                               <a name='2630'>
         DO 6400 IGC = 1,NGC(4)                                                  <a name='2631'>
            SUMF = 0.                                                            <a name='2632'>
            DO 6600 IPR = 1, NGN(NGS(3)+IGC)                                     <a name='2633'>
               IPRSM = IPRSM + 1                                                 <a name='2634'>
               SUMF = SUMF + FRACREFB(IPRSM,JPJP)                                  <a name='2635'>
 6600       CONTINUE                                                             <a name='2636'>
            FRACREFBC(IGC,JPJP) = SUMF                                             <a name='2637'>
 6400    CONTINUE                                                                <a name='2638'>
 6000 CONTINUE                                                                   <a name='2639'>
                                                                                 <a name='2640'>
   END SUBROUTINE CMBGB4<a name='2641'>
<a name='2642'>
<font color=#447700>!***************************************************************************<a name='2643'></font>
<A NAME='CMBGB5'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB5' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2644'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB5</font>(abscoefL, abscoefH, SELFREF,                      &amp; <A href='../../call_to/CMBGB5.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB5.html' TARGET='index'>4</A><a name='2645'>
                     FRACREFA, FRACREFB, CCL4,                         &amp;<a name='2646'>
                     SELFREFC, CCL4C, FRACREFAC, FRACREFBC             )<a name='2647'>
<font color=#447700>!***************************************************************************     <a name='2648'></font>
<font color=#447700>!                                                                                <a name='2649'></font>
<font color=#447700>!     BAND 5:  700-820 cm-1 (low - H2O,CO2; high - O3,CO2)                       <a name='2650'></font>
<font color=#447700>!***************************************************************************     <a name='2651'></font>
                                                                                 <a name='2652'>
<font color=#447700>! Input                                                                          <a name='2653'></font>
      REAL abscoefL(9,5,13,MG),abscoefH(5,5,13:59,MG)<a name='2654'>
      REAL SELFREF(10,MG)            <a name='2655'>
      REAL FRACREFA(MG,9), FRACREFB(MG,5), CCL4(MG)<a name='2656'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='2657'></font>
<font color=#447700>! Output                                                                         <a name='2658'></font>
      REAL SELFREFC(10,NG5), CCL4C(NG5) <a name='2659'>
      REAL FRACREFAC(NG5,9), FRACREFBC(NG5,5)               <a name='2660'>
                                                         <a name='2661'>
      DO 2000 JN = 1,9                                                           <a name='2662'>
         DO 2000 JTJT = 1,5                                                        <a name='2663'>
            DO 2200 JPJP = 1,13                                                    <a name='2664'>
               IPRSM = 0                                                         <a name='2665'>
               DO 2400 IGC = 1,NGC(5)                                            <a name='2666'>
                 SUMK = 0.                                                       <a name='2667'>
                  DO 2600 IPR = 1, NGN(NGS(4)+IGC)                               <a name='2668'>
                     IPRSM = IPRSM + 1                                           <a name='2669'>
                     SUMK = SUMK + abscoefL(JN,JTJT,JPJP,IPRSM)*RWGT(IPRSM+64)<a name='2670'>
 2600             CONTINUE                                                       <a name='2671'>
                  ABSA5(JN+(JTJT-1)*9+(JPJP-1)*45,IGC) = SUMK                                       <a name='2672'>
 2400          CONTINUE                                                          <a name='2673'>
 2200       CONTINUE                                                             <a name='2674'>
 2000 CONTINUE                                                                   <a name='2675'>
      DO 3000 JN = 1,5                                                           <a name='2676'>
         DO 3000 JTJT = 1,5                                                        <a name='2677'>
            DO 3200 JPJP = 13,59                                                   <a name='2678'>
               IPRSM = 0                                                         <a name='2679'>
               DO 3400 IGC = 1,NGC(5)                                            <a name='2680'>
                  SUMK = 0.                                                      <a name='2681'>
                  DO 3600 IPR = 1, NGN(NGS(4)+IGC)                               <a name='2682'>
                     IPRSM = IPRSM + 1                                           <a name='2683'>
                     SUMK = SUMK + abscoefH(JN,JTJT,JPJP,IPRSM)*RWGT(IPRSM+64)<a name='2684'>
 3600             CONTINUE                                                       <a name='2685'>
                  ABSB5(JN+(JTJT-1)*5+(JPJP-13)*25,IGC) = SUMK<a name='2686'>
 3400          CONTINUE                                                          <a name='2687'>
 3200       CONTINUE                                                             <a name='2688'>
 3000 CONTINUE                                                                   <a name='2689'>
                                                                                 <a name='2690'>
      DO 4000 JTJT = 1,10                                                          <a name='2691'>
         IPRSM = 0                                                               <a name='2692'>
         DO 4400 IGC = 1,NGC(5)                                                  <a name='2693'>
            SUMK = 0.                                                            <a name='2694'>
            DO 4600 IPR = 1, NGN(NGS(4)+IGC)                                     <a name='2695'>
               IPRSM = IPRSM + 1                                                 <a name='2696'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+64)<a name='2697'>
 4600       CONTINUE                                                             <a name='2698'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='2699'>
 4400    CONTINUE                                                                <a name='2700'>
 4000 CONTINUE                                                                   <a name='2701'>
                                                                                 <a name='2702'>
      DO 5000 JPJP = 1,9                                                           <a name='2703'>
         IPRSM = 0                                                               <a name='2704'>
         DO 5400 IGC = 1,NGC(5)                                                  <a name='2705'>
            SUMF = 0.                                                            <a name='2706'>
            DO 5600 IPR = 1, NGN(NGS(4)+IGC)                                     <a name='2707'>
               IPRSM = IPRSM + 1                                                 <a name='2708'>
               SUMF = SUMF + FRACREFA(IPRSM,JPJP)                                  <a name='2709'>
 5600       CONTINUE                                                             <a name='2710'>
            FRACREFAC(IGC,JPJP) = SUMF                                             <a name='2711'>
 5400    CONTINUE                                                                <a name='2712'>
 5000 CONTINUE                                                                   <a name='2713'>
                                                                                 <a name='2714'>
      DO 6000 JPJP = 1,5                                                           <a name='2715'>
         IPRSM = 0                                                               <a name='2716'>
         DO 6400 IGC = 1,NGC(5)                                                  <a name='2717'>
            SUMF = 0.                                                            <a name='2718'>
            DO 6600 IPR = 1, NGN(NGS(4)+IGC)                                     <a name='2719'>
               IPRSM = IPRSM + 1                                                 <a name='2720'>
               SUMF = SUMF + FRACREFB(IPRSM,JPJP)                                  <a name='2721'>
 6600       CONTINUE                                                             <a name='2722'>
            FRACREFBC(IGC,JPJP) = SUMF                                             <a name='2723'>
 6400    CONTINUE                                                                <a name='2724'>
 6000 CONTINUE                                                                   <a name='2725'>
                                                                                 <a name='2726'>
      IPRSM = 0                                                                  <a name='2727'>
      DO 7400 IGC = 1,NGC(5)                                                     <a name='2728'>
         SUMK = 0.                                                               <a name='2729'>
         DO 7600 IPR = 1, NGN(NGS(4)+IGC)                                        <a name='2730'>
            IPRSM = IPRSM + 1                                                    <a name='2731'>
            SUMK = SUMK + CCL4(IPRSM)*RWGT(IPRSM+64)                             <a name='2732'>
 7600    CONTINUE                                                                <a name='2733'>
         CCL4C(IGC) = SUMK                                                       <a name='2734'>
 7400 CONTINUE                                                                   <a name='2735'>
                                                                                 <a name='2736'>
   END SUBROUTINE CMBGB5<a name='2737'>
<a name='2738'>
<font color=#447700>!***************************************************************************<a name='2739'></font>
<A NAME='CMBGB6'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB6' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2740'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB6</font>(abscoefL, SELFREF,                                &amp; <A href='../../call_to/CMBGB6.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB6.html' TARGET='index'>4</A><a name='2741'>
                     FRACREFA, ABSCO2, CFC11ADJ, CFC12,                &amp;<a name='2742'>
                     SELFREFC, ABSCO2C, CFC11ADJC, CFC12C,             &amp;<a name='2743'>
                     FRACREFAC                                         )<a name='2744'>
<font color=#447700>!***************************************************************************     <a name='2745'></font>
<font color=#447700>!                                                                                <a name='2746'></font>
<font color=#447700>!     BAND 6:  820-980 cm-1 (low - H2O; high - nothing)                          <a name='2747'></font>
<font color=#447700>!***************************************************************************     <a name='2748'></font>
                                                                                 <a name='2749'>
<font color=#447700>! Input                                                                          <a name='2750'></font>
      REAL abscoefL(5,13,MG)                                                           <a name='2751'>
      REAL SELFREF(10,MG)  <a name='2752'>
      REAL FRACREFA(MG), ABSCO2(MG), CFC11ADJ(MG), CFC12(MG)<a name='2753'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='2754'></font>
<font color=#447700>! Output                                                                         <a name='2755'></font>
      REAL SELFREFC(10,NG6),  &amp;<a name='2756'>
           ABSCO2C(NG6), CFC11ADJC(NG6), CFC12C(NG6) <a name='2757'>
      REAL FRACREFAC(NG6)<a name='2758'>
                                                                                 <a name='2759'>
      DO 2000 JTJT = 1,5                                                           <a name='2760'>
         DO 2200 JPJP = 1,13                                                       <a name='2761'>
            IPRSM = 0                                                            <a name='2762'>
            DO 2400 IGC = 1,NGC(6)                                               <a name='2763'>
               SUMK = 0.                                                         <a name='2764'>
               DO 2600 IPR = 1, NGN(NGS(5)+IGC)                                  <a name='2765'>
                  IPRSM = IPRSM + 1                                              <a name='2766'>
                  SUMK = SUMK + abscoefL(JTJT,JPJP,IPRSM)*RWGT(IPRSM+80)<a name='2767'>
 2600          CONTINUE                                                          <a name='2768'>
               ABSA6(JTJT+(JPJP-1)*5,IGC) = SUMK                                             <a name='2769'>
 2400       CONTINUE                                                             <a name='2770'>
 2200    CONTINUE                                                                <a name='2771'>
 2000 CONTINUE                                                                   <a name='2772'>
                                                                                 <a name='2773'>
      DO 4000 JTJT = 1,10                                                          <a name='2774'>
         IPRSM = 0                                                               <a name='2775'>
         DO 4400 IGC = 1,NGC(6)                                                  <a name='2776'>
            SUMK = 0.                                                            <a name='2777'>
            DO 4600 IPR = 1, NGN(NGS(5)+IGC)                                     <a name='2778'>
               IPRSM = IPRSM + 1                                                 <a name='2779'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+80) <a name='2780'>
 4600       CONTINUE                                                             <a name='2781'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='2782'>
 4400    CONTINUE                                                                <a name='2783'>
 4000 CONTINUE                                                                   <a name='2784'>
                                                                                 <a name='2785'>
      IPRSM = 0                                                                  <a name='2786'>
      DO 7400 IGC = 1,NGC(6)                                                     <a name='2787'>
         SUMF = 0.                                                               <a name='2788'>
         SUMK1= 0.                                                               <a name='2789'>
         SUMK2= 0.                                                               <a name='2790'>
         SUMK3= 0.                                                               <a name='2791'>
         DO 7600 IPR = 1, NGN(NGS(5)+IGC)                                        <a name='2792'>
            IPRSM = IPRSM + 1                                                    <a name='2793'>
            SUMF = SUMF + FRACREFA(IPRSM)                                        <a name='2794'>
            SUMK1= SUMK1+ ABSCO2(IPRSM)*RWGT(IPRSM+80)                           <a name='2795'>
            SUMK2= SUMK2+ CFC11ADJ(IPRSM)*RWGT(IPRSM+80)                         <a name='2796'>
            SUMK3= SUMK3+ CFC12(IPRSM)*RWGT(IPRSM+80)                            <a name='2797'>
 7600    CONTINUE                                                                <a name='2798'>
         FRACREFAC(IGC) = SUMF                                                   <a name='2799'>
         ABSCO2C(IGC) = SUMK1                                                    <a name='2800'>
         CFC11ADJC(IGC) = SUMK2                                                  <a name='2801'>
         CFC12C(IGC) = SUMK3                                                     <a name='2802'>
 7400 CONTINUE                                                                   <a name='2803'>
                                                                                 <a name='2804'>
   END SUBROUTINE CMBGB6<a name='2805'>
<a name='2806'>
<font color=#447700>!***************************************************************************<a name='2807'></font>
<A NAME='CMBGB7'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB7' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2808'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB7</font>(abscoefL, abscoefH, SELFREF,                      &amp; <A href='../../call_to/CMBGB7.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB7.html' TARGET='index'>4</A><a name='2809'>
                     FRACREFA, FRACREFB, ABSCO2,                       &amp;<a name='2810'>
                     SELFREFC, ABSCO2C, FRACREFAC, FRACREFBC           )<a name='2811'>
<font color=#447700>!***************************************************************************     <a name='2812'></font>
<font color=#447700>!                                                                                <a name='2813'></font>
<font color=#447700>!     BAND 7:  980-1080 cm-1 (low - H2O,O3; high - O3)                           <a name='2814'></font>
<font color=#447700>!***************************************************************************     <a name='2815'></font>
                                                                                 <a name='2816'>
<font color=#447700>! Input                                                                          <a name='2817'></font>
      REAL abscoefL(9,5,13,MG),abscoefH(5,13:59,MG)<a name='2818'>
      REAL SELFREF(10,MG)          <a name='2819'>
      REAL FRACREFA(MG,9), FRACREFB(MG), ABSCO2(MG)<a name='2820'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='2821'></font>
<font color=#447700>! Output                                                                         <a name='2822'></font>
      REAL SELFREFC(10,NG7), ABSCO2C(NG7)<a name='2823'>
      REAL FRACREFAC(NG7,9), FRACREFBC(NG7)  <a name='2824'>
                                                                                 <a name='2825'>
      DO 2000 JN = 1,9                                                           <a name='2826'>
         DO 2000 JTJT = 1,5                                                        <a name='2827'>
            DO 2200 JPJP = 1,13                                                    <a name='2828'>
               IPRSM = 0                                                         <a name='2829'>
               DO 2400 IGC = 1,NGC(7)                                            <a name='2830'>
                 SUMK = 0.                                                       <a name='2831'>
                  DO 2600 IPR = 1, NGN(NGS(6)+IGC)                               <a name='2832'>
                     IPRSM = IPRSM + 1                                           <a name='2833'>
                     SUMK = SUMK + abscoefL(JN,JTJT,JPJP,IPRSM)*RWGT(IPRSM+96)<a name='2834'>
 2600             CONTINUE                                                       <a name='2835'>
                  ABSA7(JN+(JTJT-1)*9+(JPJP-1)*45,IGC) = SUMK                                       <a name='2836'>
 2400          CONTINUE                                                          <a name='2837'>
 2200       CONTINUE                                                             <a name='2838'>
 2000 CONTINUE                                                                   <a name='2839'>
      DO 3000 JTJT = 1,5                                                           <a name='2840'>
         DO 3200 JPJP = 13,59                                                      <a name='2841'>
            IPRSM = 0                                                            <a name='2842'>
            DO 3400 IGC = 1,NGC(7)                                               <a name='2843'>
               SUMK = 0.                                                         <a name='2844'>
               DO 3600 IPR = 1, NGN(NGS(6)+IGC)                                  <a name='2845'>
                  IPRSM = IPRSM + 1                                              <a name='2846'>
                  SUMK = SUMK + abscoefH(JTJT,JPJP,IPRSM)*RWGT(IPRSM+96)<a name='2847'>
 3600          CONTINUE                                                          <a name='2848'>
               ABSB7(JTJT+(JPJP-13)*5,IGC) = SUMK <a name='2849'>
 3400       CONTINUE                                                             <a name='2850'>
 3200    CONTINUE                                                                <a name='2851'>
 3000 CONTINUE                                                                   <a name='2852'>
                                                                                 <a name='2853'>
      DO 4000 JTJT = 1,10                                                          <a name='2854'>
         IPRSM = 0                                                               <a name='2855'>
         DO 4400 IGC = 1,NGC(7)                                                  <a name='2856'>
            SUMK = 0.                                                            <a name='2857'>
            DO 4600 IPR = 1, NGN(NGS(6)+IGC)                                     <a name='2858'>
               IPRSM = IPRSM + 1                                                 <a name='2859'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+96)<a name='2860'>
 4600       CONTINUE                                                             <a name='2861'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='2862'>
 4400    CONTINUE                                                                <a name='2863'>
 4000 CONTINUE                                                                   <a name='2864'>
                                                                                 <a name='2865'>
      DO 5000 JPJP = 1,9                                                           <a name='2866'>
         IPRSM = 0                                                               <a name='2867'>
         DO 5400 IGC = 1,NGC(7)                                                  <a name='2868'>
            SUMF = 0.                                                            <a name='2869'>
            DO 5600 IPR = 1, NGN(NGS(6)+IGC)                                     <a name='2870'>
               IPRSM = IPRSM + 1                                                 <a name='2871'>
               SUMF = SUMF + FRACREFA(IPRSM,JPJP)                                  <a name='2872'>
 5600       CONTINUE                                                             <a name='2873'>
            FRACREFAC(IGC,JPJP) = SUMF                                             <a name='2874'>
 5400    CONTINUE                                                                <a name='2875'>
 5000 CONTINUE                                                                   <a name='2876'>
                                                                                 <a name='2877'>
      IPRSM = 0                                                                  <a name='2878'>
      DO 7400 IGC = 1,NGC(7)                                                     <a name='2879'>
         SUMF = 0.                                                               <a name='2880'>
         SUMK = 0.                                                               <a name='2881'>
         DO 7600 IPR = 1, NGN(NGS(6)+IGC)                                        <a name='2882'>
            IPRSM = IPRSM + 1                                                    <a name='2883'>
            SUMF = SUMF + FRACREFB(IPRSM)                                        <a name='2884'>
            SUMK = SUMK + ABSCO2(IPRSM)*RWGT(IPRSM+96)                           <a name='2885'>
 7600    CONTINUE                                                                <a name='2886'>
         FRACREFBC(IGC) = SUMF                                                   <a name='2887'>
         ABSCO2C(IGC) = SUMK                                                     <a name='2888'>
 7400 CONTINUE                                                                   <a name='2889'>
                                                                                 <a name='2890'>
   END SUBROUTINE CMBGB7<a name='2891'>
<a name='2892'>
<font color=#447700>!***************************************************************************<a name='2893'></font>
<A NAME='CMBGB8'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB8' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2894'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB8</font>(abscoefL, abscoefH, SELFREF,                     &amp; <A href='../../call_to/CMBGB8.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB8.html' TARGET='index'>4</A><a name='2895'>
                     FRACREFA, FRACREFB, ABSCO2A, ABSCO2B,            &amp;<a name='2896'>
                     ABSN2OA,  ABSN2OB,  CFC12,   CFC22ADJ,           &amp;<a name='2897'>
                     SELFREFC, ABSCO2AC, ABSCO2BC,                    &amp;<a name='2898'>
                     ABSN2OAC, ABSN2OBC, CFC12C, CFC22ADJC,           &amp;<a name='2899'>
                     FRACREFAC, FRACREFBC                             )<a name='2900'>
<font color=#447700>!***************************************************************************     <a name='2901'></font>
<font color=#447700>!                                                                                <a name='2902'></font>
<font color=#447700>!     BAND 8:  1080-1180 cm-1 (low (i.e.&gt;~300mb) - H2O; high - O3)               <a name='2903'></font>
<font color=#447700>!***************************************************************************     <a name='2904'></font>
                                                                                 <a name='2905'>
<font color=#447700>! Input                                                                          <a name='2906'></font>
      REAL abscoefL(5,7,MG),abscoefH(5,7:59,MG), SELFREF(10,MG)<a name='2907'>
      REAL FRACREFA(MG), FRACREFB(MG), ABSCO2A(MG), ABSCO2B(MG)<a name='2908'>
      REAL ABSN2OA(MG), ABSN2OB(MG), CFC12(MG), CFC22ADJ(MG) <a name='2909'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='2910'></font>
<font color=#447700>! Output                                                                         <a name='2911'></font>
      REAL SELFREFC(10,NG8),               &amp;<a name='2912'>
           ABSCO2AC(NG8), ABSCO2BC(NG8),   &amp;<a name='2913'>
           ABSN2OAC(NG8), ABSN2OBC(NG8),   &amp;<a name='2914'>
           CFC12C(NG8), CFC22ADJC(NG8)<a name='2915'>
      REAL FRACREFAC(NG8), FRACREFBC(NG8)<a name='2916'>
                                                                                 <a name='2917'>
      DO 2000 JTJT = 1,5                                                           <a name='2918'>
         DO 2200 JPJP = 1,7                                                        <a name='2919'>
            IPRSM = 0                                                            <a name='2920'>
            DO 2400 IGC = 1,NGC(8)                                               <a name='2921'>
              SUMK = 0.                                                          <a name='2922'>
               DO 2600 IPR = 1, NGN(NGS(7)+IGC)                                  <a name='2923'>
                  IPRSM = IPRSM + 1                                              <a name='2924'>
                  SUMK = SUMK + abscoefL(JTJT,JPJP,IPRSM)*RWGT(IPRSM+112)<a name='2925'>
 2600          CONTINUE                                                          <a name='2926'>
               ABSA8(JTJT+(JPJP-1)*5,IGC) = SUMK                                             <a name='2927'>
 2400       CONTINUE                                                             <a name='2928'>
 2200    CONTINUE                                                                <a name='2929'>
 2000 CONTINUE                                                                   <a name='2930'>
      DO 3000 JTJT = 1,5                                                           <a name='2931'>
         DO 3200 JPJP = 7,59                                                       <a name='2932'>
            IPRSM = 0                                                            <a name='2933'>
            DO 3400 IGC = 1,NGC(8)                                               <a name='2934'>
               SUMK = 0.                                                         <a name='2935'>
               DO 3600 IPR = 1, NGN(NGS(7)+IGC)                                  <a name='2936'>
                  IPRSM = IPRSM + 1                                              <a name='2937'>
                  SUMK = SUMK + abscoefH(JTJT,JPJP,IPRSM)*RWGT(IPRSM+112)<a name='2938'>
 3600          CONTINUE                                                          <a name='2939'>
               ABSB8(JTJT+(JPJP-7)*5,IGC) = SUMK <a name='2940'>
 3400       CONTINUE                                                             <a name='2941'>
 3200    CONTINUE                                                                <a name='2942'>
 3000 CONTINUE                                                                   <a name='2943'>
                                                                                 <a name='2944'>
      DO 4000 JTJT = 1,10                                                          <a name='2945'>
         IPRSM = 0                                                               <a name='2946'>
         DO 4400 IGC = 1,NGC(8)                                                  <a name='2947'>
            SUMK = 0.                                                            <a name='2948'>
            DO 4600 IPR = 1, NGN(NGS(7)+IGC)                                     <a name='2949'>
               IPRSM = IPRSM + 1                                                 <a name='2950'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+112) <a name='2951'>
 4600       CONTINUE                                                             <a name='2952'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='2953'>
 4400    CONTINUE                                                                <a name='2954'>
 4000 CONTINUE                                                                   <a name='2955'>
                                                                                 <a name='2956'>
      IPRSM = 0                                                                  <a name='2957'>
      DO 7400 IGC = 1,NGC(8)                                                     <a name='2958'>
         SUMF1= 0.                                                               <a name='2959'>
         SUMF2= 0.                                                               <a name='2960'>
         SUMK1= 0.                                                               <a name='2961'>
         SUMK2= 0.                                                               <a name='2962'>
         SUMK3= 0.                                                               <a name='2963'>
         SUMK4= 0.                                                               <a name='2964'>
         SUMK5= 0.                                                               <a name='2965'>
         SUMK6= 0.                                                               <a name='2966'>
         DO 7600 IPR = 1, NGN(NGS(7)+IGC)                                        <a name='2967'>
            IPRSM = IPRSM + 1                                                    <a name='2968'>
            SUMF1= SUMF1+ FRACREFA(IPRSM)                                        <a name='2969'>
            SUMF2= SUMF2+ FRACREFB(IPRSM)                                        <a name='2970'>
            SUMK1= SUMK1+ ABSCO2A(IPRSM)*RWGT(IPRSM+112)                         <a name='2971'>
            SUMK2= SUMK2+ ABSCO2B(IPRSM)*RWGT(IPRSM+112)                         <a name='2972'>
            SUMK3= SUMK3+ ABSN2OA(IPRSM)*RWGT(IPRSM+112)                         <a name='2973'>
            SUMK4= SUMK4+ ABSN2OB(IPRSM)*RWGT(IPRSM+112)                         <a name='2974'>
            SUMK5= SUMK5+ CFC12(IPRSM)*RWGT(IPRSM+112)                           <a name='2975'>
            SUMK6= SUMK6+ CFC22ADJ(IPRSM)*RWGT(IPRSM+112)                        <a name='2976'>
 7600    CONTINUE                                                                <a name='2977'>
         FRACREFAC(IGC) = SUMF1                                                  <a name='2978'>
         FRACREFBC(IGC) = SUMF2                                                  <a name='2979'>
         ABSCO2AC(IGC) = SUMK1                                                   <a name='2980'>
         ABSCO2BC(IGC) = SUMK2                                                   <a name='2981'>
         ABSN2OAC(IGC) = SUMK3                                                   <a name='2982'>
         ABSN2OBC(IGC) = SUMK4                                                   <a name='2983'>
         CFC12C(IGC) = SUMK5                                                     <a name='2984'>
         CFC22ADJC(IGC) = SUMK6                                                  <a name='2985'>
 7400 CONTINUE                                                                   <a name='2986'>
                                                                                 <a name='2987'>
   END SUBROUTINE CMBGB8<a name='2988'>
<a name='2989'>
<font color=#447700>!***************************************************************************<a name='2990'></font>
<A NAME='CMBGB9'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB9' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2991'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB9</font>(abscoefL, abscoefH, SELFREF,                      &amp; <A href='../../call_to/CMBGB9.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB9.html' TARGET='index'>4</A><a name='2992'>
                     FRACREFA, FRACREFB, ABSN2O,                       &amp;<a name='2993'>
                     SELFREFC, ABSN2OC, FRACREFAC, FRACREFBC           )<a name='2994'>
<font color=#447700>!***************************************************************************     <a name='2995'></font>
<font color=#447700>!                                                                                <a name='2996'></font>
<font color=#447700>!     BAND 9:  1180-1390 cm-1 (low - H2O,CH4; high - CH4)                        <a name='2997'></font>
<font color=#447700>!***************************************************************************     <a name='2998'></font>
                                                                                 <a name='2999'>
<font color=#447700>! Input                                                                          <a name='3000'></font>
      REAL abscoefL(11,5,13,MG), abscoefH(5,13:59,MG)<a name='3001'>
      REAL SELFREF(10,MG)   <a name='3002'>
      REAL FRACREFA(MG,9), FRACREFB(MG), ABSN2O(3*MG)<a name='3003'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='3004'></font>
<font color=#447700>! Output                                                                         <a name='3005'></font>
      REAL SELFREFC(10,NG9), ABSN2OC(3*NG9)<a name='3006'>
      REAL FRACREFAC(NG9,9), FRACREFBC(NG9)<a name='3007'>
                                                                                 <a name='3008'>
      DO 2000 JN = 1,11                                                          <a name='3009'>
         DO 2000 JTJT = 1,5                                                        <a name='3010'>
            DO 2200 JPJP = 1,13                                                    <a name='3011'>
               IPRSM = 0                                                         <a name='3012'>
               DO 2400 IGC = 1,NGC(9)                                            <a name='3013'>
                  SUMK = 0.                                                      <a name='3014'>
                  DO 2600 IPR = 1, NGN(NGS(8)+IGC)                               <a name='3015'>
                     IPRSM = IPRSM + 1                                           <a name='3016'>
                     SUMK = SUMK + abscoefL(JN,JTJT,JPJP,IPRSM)*RWGT(IPRSM+128)<a name='3017'>
 2600             CONTINUE                                                       <a name='3018'>
                  ABSA9(JN+(JTJT-1)*11+(JPJP-1)*55,IGC) = SUMK                                       <a name='3019'>
 2400          CONTINUE                                                          <a name='3020'>
 2200       CONTINUE                                                             <a name='3021'>
 2000 CONTINUE                                                                   <a name='3022'>
                                                                                 <a name='3023'>
      DO 3000 JTJT = 1,5                                                           <a name='3024'>
         DO 3200 JPJP = 13,59                                                      <a name='3025'>
            IPRSM = 0                                                            <a name='3026'>
            DO 3400 IGC = 1,NGC(9)                                               <a name='3027'>
               SUMK = 0.                                                         <a name='3028'>
               DO 3600 IPR = 1, NGN(NGS(8)+IGC)                                  <a name='3029'>
                  IPRSM = IPRSM + 1                                              <a name='3030'>
                  SUMK = SUMK + abscoefH(JTJT,JPJP,IPRSM)*RWGT(IPRSM+128)<a name='3031'>
 3600          CONTINUE                                                          <a name='3032'>
               ABSB9(JTJT+(JPJP-13)*5,IGC) = SUMK<a name='3033'>
 3400       CONTINUE                                                             <a name='3034'>
 3200    CONTINUE                                                                <a name='3035'>
 3000 CONTINUE                                                                   <a name='3036'>
                                                                                 <a name='3037'>
      DO 4000 JTJT = 1,10                                                          <a name='3038'>
         IPRSM = 0                                                               <a name='3039'>
         DO 4400 IGC = 1,NGC(9)                                                  <a name='3040'>
            SUMK = 0.                                                            <a name='3041'>
            DO 4600 IPR = 1, NGN(NGS(8)+IGC)                                     <a name='3042'>
               IPRSM = IPRSM + 1                                                 <a name='3043'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+128)<a name='3044'>
 4600       CONTINUE                                                             <a name='3045'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='3046'>
 4400    CONTINUE                                                                <a name='3047'>
 4000 CONTINUE                                                                   <a name='3048'>
                                                                                 <a name='3049'>
      DO 5000 JN = 1,3                                                           <a name='3050'>
         IPRSM = 0                                                               <a name='3051'>
         DO 5400 IGC = 1,NGC(9)                                                  <a name='3052'>
            SUMK = 0.                                                            <a name='3053'>
            DO 5600 IPR = 1, NGN(NGS(8)+IGC)                                     <a name='3054'>
               IPRSM = IPRSM + 1                                                 <a name='3055'>
               JND = (JN-1)*16                                                   <a name='3056'>
               SUMK = SUMK + ABSN2O(JND+IPRSM)*RWGT(IPRSM+128)                   <a name='3057'>
 5600       CONTINUE                                                             <a name='3058'>
            JNDC = (JN-1)*NGC(9)                                                 <a name='3059'>
            ABSN2OC(JNDC+IGC) = SUMK                                             <a name='3060'>
 5400    CONTINUE                                                                <a name='3061'>
 5000 CONTINUE                                                                   <a name='3062'>
                                                                                 <a name='3063'>
      DO 6000 JPJP = 1,9                                                           <a name='3064'>
         IPRSM = 0                                                               <a name='3065'>
         DO 6400 IGC = 1,NGC(9)                                                  <a name='3066'>
            SUMF = 0.                                                            <a name='3067'>
            DO 6600 IPR = 1, NGN(NGS(8)+IGC)                                     <a name='3068'>
               IPRSM = IPRSM + 1                                                 <a name='3069'>
               SUMF = SUMF + FRACREFA(IPRSM,JPJP)                                  <a name='3070'>
 6600       CONTINUE                                                             <a name='3071'>
            FRACREFAC(IGC,JPJP) = SUMF                                             <a name='3072'>
 6400    CONTINUE                                                                <a name='3073'>
 6000 CONTINUE                                                                   <a name='3074'>
                                                                                 <a name='3075'>
      IPRSM = 0                                                                  <a name='3076'>
      DO 7400 IGC = 1,NGC(9)                                                     <a name='3077'>
         SUMF = 0.                                                               <a name='3078'>
         DO 7600 IPR = 1, NGN(NGS(8)+IGC)                                        <a name='3079'>
            IPRSM = IPRSM + 1                                                    <a name='3080'>
            SUMF = SUMF + FRACREFB(IPRSM)                                        <a name='3081'>
 7600    CONTINUE                                                                <a name='3082'>
         FRACREFBC(IGC) = SUMF                                                   <a name='3083'>
 7400 CONTINUE                                                                   <a name='3084'>
                                                                                 <a name='3085'>
   END SUBROUTINE CMBGB9<a name='3086'>
<a name='3087'>
<font color=#447700>!***************************************************************************<a name='3088'></font>
<A NAME='CMBGB10'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB10' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3089'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB10</font>(abscoefL, abscoefH,                               &amp; <A href='../../call_to/CMBGB10.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB10.html' TARGET='index'>4</A><a name='3090'>
                      FRACREFA, FRACREFB,                               &amp;<a name='3091'>
                      FRACREFAC, FRACREFBC                              )<a name='3092'>
<font color=#447700>!***************************************************************************     <a name='3093'></font>
<font color=#447700>!                                                                                <a name='3094'></font>
<font color=#447700>!     BAND 10:  1390-1480 cm-1 (low - H2O; high - H2O)                           <a name='3095'></font>
<font color=#447700>!***************************************************************************     <a name='3096'></font>
                                                                                 <a name='3097'>
<font color=#447700>! Input                                                                          <a name='3098'></font>
      REAL abscoefL(5,13,MG),abscoefH(5,13:59,MG)            <a name='3099'>
      REAL FRACREFA(MG), FRACREFB(MG)<a name='3100'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='3101'></font>
<font color=#447700>! Output                                                                         <a name='3102'></font>
      REAL FRACREFAC(NG10), FRACREFBC(NG10)<a name='3103'>
                                                                                 <a name='3104'>
      DO 2000 JTJT = 1,5                                                           <a name='3105'>
         DO 2200 JPJP = 1,13                                                       <a name='3106'>
            IPRSM = 0                                                            <a name='3107'>
            DO 2400 IGC = 1,NGC(10)                                              <a name='3108'>
               SUMK = 0.                                                         <a name='3109'>
               DO 2600 IPR = 1, NGN(NGS(9)+IGC)                                  <a name='3110'>
                  IPRSM = IPRSM + 1                                              <a name='3111'>
                  SUMK = SUMK + abscoefL(JTJT,JPJP,IPRSM)*RWGT(IPRSM+144)<a name='3112'>
 2600          CONTINUE                                                          <a name='3113'>
               ABSA10(JTJT+(JPJP-1)*5,IGC) = SUMK                                             <a name='3114'>
 2400       CONTINUE                                                             <a name='3115'>
 2200    CONTINUE                                                                <a name='3116'>
 2000 CONTINUE                                                                   <a name='3117'>
      DO 3000 JTJT = 1,5                                                           <a name='3118'>
         DO 3200 JPJP = 13,59                                                      <a name='3119'>
            IPRSM = 0                                                            <a name='3120'>
            DO 3400 IGC = 1,NGC(10)                                              <a name='3121'>
               SUMK = 0.                                                         <a name='3122'>
               DO 3600 IPR = 1, NGN(NGS(9)+IGC)                                  <a name='3123'>
                  IPRSM = IPRSM + 1                                              <a name='3124'>
                  SUMK = SUMK + abscoefH(JTJT,JPJP,IPRSM)*RWGT(IPRSM+144)<a name='3125'>
 3600          CONTINUE                                                          <a name='3126'>
               ABSB10(JTJT+(JPJP-13)*5,IGC) = SUMK<a name='3127'>
 3400       CONTINUE                                                             <a name='3128'>
 3200    CONTINUE                                                                <a name='3129'>
 3000 CONTINUE                                                                   <a name='3130'>
                                                                                 <a name='3131'>
      IPRSM = 0                                                                  <a name='3132'>
      DO 7400 IGC = 1,NGC(10)                                                    <a name='3133'>
         SUMF1= 0.                                                               <a name='3134'>
         SUMF2= 0.                                                               <a name='3135'>
         DO 7600 IPR = 1, NGN(NGS(9)+IGC)                                        <a name='3136'>
            IPRSM = IPRSM + 1                                                    <a name='3137'>
            SUMF1= SUMF1+ FRACREFA(IPRSM)                                        <a name='3138'>
            SUMF2= SUMF2+ FRACREFB(IPRSM)                                        <a name='3139'>
 7600    CONTINUE                                                                <a name='3140'>
         FRACREFAC(IGC) = SUMF1                                                  <a name='3141'>
         FRACREFBC(IGC) = SUMF2                                                  <a name='3142'>
 7400 CONTINUE                                                                   <a name='3143'>
                                                                                 <a name='3144'>
   END SUBROUTINE CMBGB10<a name='3145'>
<a name='3146'>
<font color=#447700>!***************************************************************************<a name='3147'></font>
<A NAME='CMBGB11'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB11' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3148'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB11</font>(abscoefL, abscoefH, SELFREF,                   &amp; <A href='../../call_to/CMBGB11.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB11.html' TARGET='index'>4</A><a name='3149'>
                      FRACREFA, FRACREFB,                            &amp;<a name='3150'>
                      SELFREFC,                                      &amp;<a name='3151'>
                      FRACREFAC, FRACREFBC                           )<a name='3152'>
<font color=#447700>!***************************************************************************     <a name='3153'></font>
<font color=#447700>!                                                                                <a name='3154'></font>
<font color=#447700>!     BAND 11:  1480-1800 cm-1 (low - H2O; high - H2O)                           <a name='3155'></font>
<font color=#447700>!***************************************************************************     <a name='3156'></font>
                                                                                 <a name='3157'>
<font color=#447700>! Input                                                                          <a name='3158'></font>
      REAL abscoefL(5,13,MG),abscoefH(5,13:59,MG)<a name='3159'>
      REAL SELFREF(10,MG)      <a name='3160'>
      REAL FRACREFA(MG), FRACREFB(MG)<a name='3161'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='3162'></font>
<font color=#447700>! Output                                                                         <a name='3163'></font>
      REAL SELFREFC(10,NG11)<a name='3164'>
      REAL FRACREFAC(NG11), FRACREFBC(NG11)<a name='3165'>
                                                                                 <a name='3166'>
      DO 2000 JTJT = 1,5                                                           <a name='3167'>
         DO 2200 JPJP = 1,13                                                       <a name='3168'>
            IPRSM = 0                                                            <a name='3169'>
            DO 2400 IGC = 1,NGC(11)                                              <a name='3170'>
               SUMK = 0.                                                         <a name='3171'>
               DO 2600 IPR = 1, NGN(NGS(10)+IGC)                                 <a name='3172'>
                  IPRSM = IPRSM + 1                                              <a name='3173'>
                  SUMK = SUMK + abscoefL(JTJT,JPJP,IPRSM)*RWGT(IPRSM+160)<a name='3174'>
 2600          CONTINUE                                                          <a name='3175'>
               ABSA11(JTJT+(JPJP-1)*5,IGC) = SUMK                                             <a name='3176'>
 2400       CONTINUE                                                             <a name='3177'>
 2200    CONTINUE                                                                <a name='3178'>
 2000 CONTINUE                                                                   <a name='3179'>
      DO 3000 JTJT = 1,5                                                           <a name='3180'>
         DO 3200 JPJP = 13,59                                                      <a name='3181'>
            IPRSM = 0                                                            <a name='3182'>
            DO 3400 IGC = 1,NGC(11)                                              <a name='3183'>
               SUMK = 0.                                                         <a name='3184'>
               DO 3600 IPR = 1, NGN(NGS(10)+IGC)                                 <a name='3185'>
                  IPRSM = IPRSM + 1                                              <a name='3186'>
                  SUMK = SUMK + abscoefH(JTJT,JPJP,IPRSM)*RWGT(IPRSM+160) <a name='3187'>
 3600          CONTINUE                                                          <a name='3188'>
               ABSB11(JTJT+(JPJP-13)*5,IGC) = SUMK<a name='3189'>
 3400       CONTINUE                                                             <a name='3190'>
 3200    CONTINUE                                                                <a name='3191'>
 3000 CONTINUE                                                                   <a name='3192'>
                                                                                 <a name='3193'>
      DO 4000 JTJT = 1,10                                                          <a name='3194'>
         IPRSM = 0                                                               <a name='3195'>
         DO 4400 IGC = 1,NGC(11)                                                 <a name='3196'>
            SUMK = 0.                                                            <a name='3197'>
            DO 4600 IPR = 1, NGN(NGS(10)+IGC)                                    <a name='3198'>
               IPRSM = IPRSM + 1                                                 <a name='3199'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+160) <a name='3200'>
 4600       CONTINUE                                                             <a name='3201'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='3202'>
 4400    CONTINUE                                                                <a name='3203'>
 4000 CONTINUE                                                                   <a name='3204'>
                                                                                 <a name='3205'>
      IPRSM = 0                                                                  <a name='3206'>
      DO 7400 IGC = 1,NGC(11)                                                    <a name='3207'>
         SUMF1= 0.                                                               <a name='3208'>
         SUMF2= 0.                                                               <a name='3209'>
         DO 7600 IPR = 1, NGN(NGS(10)+IGC)                                       <a name='3210'>
            IPRSM = IPRSM + 1                                                    <a name='3211'>
            SUMF1= SUMF1+ FRACREFA(IPRSM)                                        <a name='3212'>
            SUMF2= SUMF2+ FRACREFB(IPRSM)                                        <a name='3213'>
 7600    CONTINUE                                                                <a name='3214'>
         FRACREFAC(IGC) = SUMF1                                                  <a name='3215'>
         FRACREFBC(IGC) = SUMF2                                                  <a name='3216'>
 7400 CONTINUE                                                                   <a name='3217'>
                                                                                 <a name='3218'>
   END SUBROUTINE CMBGB11<a name='3219'>
<a name='3220'>
<a name='3221'>
<font color=#447700>!***************************************************************************<a name='3222'></font>
<A NAME='CMBGB12'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB12' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3223'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB12</font>(abscoefL, SELFREF,                          &amp; <A href='../../call_to/CMBGB12.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB12.html' TARGET='index'>4</A><a name='3224'>
                      FRACREFA,                                   &amp;<a name='3225'>
                      SELFREFC, FRACREFAC                         )<a name='3226'>
<font color=#447700>!***************************************************************************     <a name='3227'></font>
<font color=#447700>!                                                                                <a name='3228'></font>
<font color=#447700>!     BAND 12:  1800-2080 cm-1 (low - H2O,CO2; high - nothing)                   <a name='3229'></font>
<font color=#447700>!***************************************************************************     <a name='3230'></font>
                                                                                 <a name='3231'>
<font color=#447700>! Input                                                                          <a name='3232'></font>
      REAL abscoefL(9,5,13,MG)  <a name='3233'>
      REAL SELFREF(10,MG)              <a name='3234'>
      REAL FRACREFA(MG,9)<a name='3235'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='3236'></font>
<font color=#447700>! Output                                                                         <a name='3237'></font>
      REAL SELFREFC(10,NG12) <a name='3238'>
      REAL FRACREFAC(NG12,9)<a name='3239'>
                                                                                 <a name='3240'>
      DO 2000 JN = 1,9                                                           <a name='3241'>
         DO 2000 JTJT = 1,5                                                        <a name='3242'>
            DO 2200 JPJP = 1,13                                                    <a name='3243'>
               IPRSM = 0                                                         <a name='3244'>
               DO 2400 IGC = 1,NGC(12)                                           <a name='3245'>
                  SUMK = 0.                                                      <a name='3246'>
                  DO 2600 IPR = 1, NGN(NGS(11)+IGC)                              <a name='3247'>
                     IPRSM = IPRSM + 1                                           <a name='3248'>
                     SUMK = SUMK + abscoefL(JN,JTJT,JPJP,IPRSM)*RWGT(IPRSM+176)<a name='3249'>
 2600             CONTINUE                                                       <a name='3250'>
                  ABSA12(JN+(JTJT-1)*9+(JPJP-1)*45,IGC) = SUMK                                       <a name='3251'>
 2400          CONTINUE                                                          <a name='3252'>
 2200       CONTINUE                                                             <a name='3253'>
 2000 CONTINUE                                                                   <a name='3254'>
                                                                                 <a name='3255'>
      DO 4000 JTJT = 1,10                                                          <a name='3256'>
         IPRSM = 0                                                               <a name='3257'>
         DO 4400 IGC = 1,NGC(12)                                                 <a name='3258'>
            SUMK = 0.                                                            <a name='3259'>
            DO 4600 IPR = 1, NGN(NGS(11)+IGC)                                    <a name='3260'>
               IPRSM = IPRSM + 1                                                 <a name='3261'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+176)<a name='3262'>
 4600       CONTINUE                                                             <a name='3263'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='3264'>
 4400    CONTINUE                                                                <a name='3265'>
 4000 CONTINUE                                                                   <a name='3266'>
                                                                                 <a name='3267'>
      DO 7000 JPJP = 1,9                                                           <a name='3268'>
         IPRSM = 0                                                               <a name='3269'>
         DO 7400 IGC = 1,NGC(12)                                                 <a name='3270'>
            SUMF = 0.                                                            <a name='3271'>
            DO 7600 IPR = 1, NGN(NGS(11)+IGC)                                    <a name='3272'>
               IPRSM = IPRSM + 1                                                 <a name='3273'>
               SUMF = SUMF + FRACREFA(IPRSM,JPJP)                                  <a name='3274'>
 7600       CONTINUE                                                             <a name='3275'>
            FRACREFAC(IGC,JPJP) = SUMF                                             <a name='3276'>
 7400    CONTINUE                                                                <a name='3277'>
 7000 CONTINUE                                                                   <a name='3278'>
                                                                                 <a name='3279'>
   END SUBROUTINE CMBGB12<a name='3280'>
<a name='3281'>
<font color=#447700>!***************************************************************************<a name='3282'></font>
<A NAME='CMBGB13'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB13' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3283'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB13</font>(abscoefL, SELFREF, FRACREFA,               &amp; <A href='../../call_to/CMBGB13.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB13.html' TARGET='index'>4</A><a name='3284'>
                      SELFREFC, FRACREFAC                        )<a name='3285'>
<font color=#447700>!***************************************************************************     <a name='3286'></font>
<font color=#447700>!                                                                                <a name='3287'></font>
<font color=#447700>!     BAND 13:  2080-2250 cm-1 (low - H2O,N2O; high - nothing)                   <a name='3288'></font>
<font color=#447700>!***************************************************************************     <a name='3289'></font>
                                                                                 <a name='3290'>
<font color=#447700>! Input                                                                          <a name='3291'></font>
      REAL abscoefL(9,5,13,MG) <a name='3292'>
      REAL SELFREF(10,MG)   <a name='3293'>
      REAL FRACREFA(MG,9)<a name='3294'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='3295'></font>
<font color=#447700>! Output                                                                         <a name='3296'></font>
      REAL SELFREFC(10,NG13) <a name='3297'>
      REAL FRACREFAC(NG13,9)<a name='3298'>
                                                                                 <a name='3299'>
      DO 2000 JN = 1,9                                                           <a name='3300'>
         DO 2000 JTJT = 1,5                                                        <a name='3301'>
            DO 2200 JPJP = 1,13                                                    <a name='3302'>
               IPRSM = 0                                                         <a name='3303'>
               DO 2400 IGC = 1,NGC(13)                                           <a name='3304'>
                  SUMK = 0.                                                      <a name='3305'>
                  DO 2600 IPR = 1, NGN(NGS(12)+IGC)                              <a name='3306'>
                     IPRSM = IPRSM + 1                                           <a name='3307'>
                     SUMK = SUMK + abscoefL(JN,JTJT,JPJP,IPRSM)*RWGT(IPRSM+192)<a name='3308'>
 2600             CONTINUE                                                       <a name='3309'>
                  ABSA13(JN+(JTJT-1)*9+(JPJP-1)*45,IGC) = SUMK <a name='3310'>
 2400          CONTINUE                                                          <a name='3311'>
 2200       CONTINUE                                                             <a name='3312'>
 2000 CONTINUE                                                                   <a name='3313'>
                                                                                 <a name='3314'>
      DO 4000 JTJT = 1,10                                                          <a name='3315'>
         IPRSM = 0                                                               <a name='3316'>
         DO 4400 IGC = 1,NGC(13)                                                 <a name='3317'>
            SUMK = 0.                                                            <a name='3318'>
            DO 4600 IPR = 1, NGN(NGS(12)+IGC)                                    <a name='3319'>
               IPRSM = IPRSM + 1                                                 <a name='3320'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+192)<a name='3321'>
 4600       CONTINUE                                                             <a name='3322'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='3323'>
 4400    CONTINUE                                                                <a name='3324'>
 4000 CONTINUE                                                                   <a name='3325'>
                                                                                 <a name='3326'>
      DO 7000 JPJP = 1,9                                                           <a name='3327'>
         IPRSM = 0                                                               <a name='3328'>
         DO 7400 IGC = 1,NGC(13)                                                 <a name='3329'>
            SUMF = 0.                                                            <a name='3330'>
            DO 7600 IPR = 1, NGN(NGS(12)+IGC)                                    <a name='3331'>
               IPRSM = IPRSM + 1                                                 <a name='3332'>
               SUMF = SUMF + FRACREFA(IPRSM,JPJP)                                  <a name='3333'>
 7600       CONTINUE                                                             <a name='3334'>
            FRACREFAC(IGC,JPJP) = SUMF                                             <a name='3335'>
 7400    CONTINUE                                                                <a name='3336'>
 7000 CONTINUE                                                                   <a name='3337'>
                                                                                 <a name='3338'>
   END SUBROUTINE CMBGB13<a name='3339'>
<a name='3340'>
<font color=#447700>!***************************************************************************<a name='3341'></font>
<A NAME='CMBGB14'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB14' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3342'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB14</font>(abscoefL, abscoefH, SELFREF,                     &amp; <A href='../../call_to/CMBGB14.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB14.html' TARGET='index'>4</A><a name='3343'>
                      FRACREFA, FRACREFB,                              &amp;<a name='3344'>
                      SELFREFC, FRACREFAC, FRACREFBC                   )<a name='3345'>
<font color=#447700>!***************************************************************************     <a name='3346'></font>
<font color=#447700>!                                                                                <a name='3347'></font>
<font color=#447700>!     BAND 14:  2250-2380 cm-1 (low - CO2; high - CO2)                           <a name='3348'></font>
<font color=#447700>!***************************************************************************     <a name='3349'></font>
                                                                                 <a name='3350'>
<font color=#447700>! Input                                                                          <a name='3351'></font>
      REAL abscoefL(5,13,MG),abscoefH(5,13:59,MG)<a name='3352'>
      REAL SELFREF(10,MG)  <a name='3353'>
      REAL FRACREFA(MG), FRACREFB(MG)<a name='3354'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='3355'></font>
<font color=#447700>! Output                                                                         <a name='3356'></font>
      REAL SELFREFC(10,NG14)                              <a name='3357'>
      REAL FRACREFAC(NG14), FRACREFBC(NG14) <a name='3358'>
                                                                                 <a name='3359'>
      DO 2000 JTJT = 1,5                                                           <a name='3360'>
         DO 2200 JPJP = 1,13                                                       <a name='3361'>
            IPRSM = 0                                                            <a name='3362'>
            DO 2400 IGC = 1,NGC(14)                                              <a name='3363'>
               SUMK = 0.                                                         <a name='3364'>
               DO 2600 IPR = 1, NGN(NGS(13)+IGC)                                 <a name='3365'>
                  IPRSM = IPRSM + 1                                              <a name='3366'>
                  SUMK = SUMK + abscoefL(JTJT,JPJP,IPRSM)*RWGT(IPRSM+208)<a name='3367'>
 2600          CONTINUE                                                          <a name='3368'>
               ABSA14(JTJT+(JPJP-1)*5,IGC) = SUMK<a name='3369'>
 2400       CONTINUE                                                             <a name='3370'>
 2200    CONTINUE                                                                <a name='3371'>
 2000 CONTINUE                                                                   <a name='3372'>
                                                                                 <a name='3373'>
      DO 3000 JTJT = 1,5                                                           <a name='3374'>
         DO 3200 JPJP = 13,59                                                      <a name='3375'>
            IPRSM = 0                                                            <a name='3376'>
            DO 3400 IGC = 1,NGC(14)                                              <a name='3377'>
               SUMK = 0.                                                         <a name='3378'>
               DO 3600 IPR = 1, NGN(NGS(13)+IGC)                                 <a name='3379'>
                  IPRSM = IPRSM + 1                                              <a name='3380'>
                  SUMK = SUMK + abscoefH(JTJT,JPJP,IPRSM)*RWGT(IPRSM+208)<a name='3381'>
 3600          CONTINUE                                                          <a name='3382'>
               ABSB14(JTJT+(JPJP-13)*5,IGC) = SUMK<a name='3383'>
 3400       CONTINUE                                                             <a name='3384'>
 3200    CONTINUE                                                                <a name='3385'>
 3000 CONTINUE                                                                   <a name='3386'>
                                                                                 <a name='3387'>
      DO 4000 JTJT = 1,10                                                          <a name='3388'>
         IPRSM = 0                                                               <a name='3389'>
         DO 4400 IGC = 1,NGC(14)                                                 <a name='3390'>
            SUMK = 0.                                                            <a name='3391'>
            DO 4600 IPR = 1, NGN(NGS(13)+IGC)                                    <a name='3392'>
               IPRSM = IPRSM + 1                                                 <a name='3393'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+208)<a name='3394'>
 4600       CONTINUE                                                             <a name='3395'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='3396'>
 4400    CONTINUE                                                                <a name='3397'>
 4000 CONTINUE                                                                   <a name='3398'>
                                                                                 <a name='3399'>
      IPRSM = 0                                                                  <a name='3400'>
      DO 7400 IGC = 1,NGC(14)                                                    <a name='3401'>
         SUMF1= 0.                                                               <a name='3402'>
         SUMF2= 0.                                                               <a name='3403'>
         DO 7600 IPR = 1, NGN(NGS(13)+IGC)                                       <a name='3404'>
            IPRSM = IPRSM + 1                                                    <a name='3405'>
            SUMF1= SUMF1+ FRACREFA(IPRSM)                                        <a name='3406'>
            SUMF2= SUMF2+ FRACREFB(IPRSM)                                        <a name='3407'>
 7600    CONTINUE                                                                <a name='3408'>
         FRACREFAC(IGC) = SUMF1                                                  <a name='3409'>
         FRACREFBC(IGC) = SUMF2                                                  <a name='3410'>
 7400 CONTINUE                                                                   <a name='3411'>
                                                                                 <a name='3412'>
            <a name='3413'>
   END SUBROUTINE CMBGB14<a name='3414'>
<a name='3415'>
<font color=#447700>!***************************************************************************<a name='3416'></font>
<A NAME='CMBGB15'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB15' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3417'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB15</font>(abscoefL, SELFREF, FRACREFA,                &amp; <A href='../../call_to/CMBGB15.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB15.html' TARGET='index'>4</A><a name='3418'>
                      SELFREFC, FRACREFAC                         )<a name='3419'>
<font color=#447700>!***************************************************************************<a name='3420'></font>
<font color=#447700>!                                                                                <a name='3421'></font>
<font color=#447700>!     BAND 15:  2380-2600 cm-1 (low - N2O,CO2; high - nothing)                   <a name='3422'></font>
<font color=#447700>!***************************************************************************     <a name='3423'></font>
                                                                                 <a name='3424'>
<font color=#447700>! Input                                                                          <a name='3425'></font>
      REAL abscoefL(9,5,13,MG)                                                         <a name='3426'>
      REAL SELFREF(10,MG)  <a name='3427'>
      REAL FRACREFA(MG,9)<a name='3428'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='3429'></font>
<font color=#447700>! Output                                                                         <a name='3430'></font>
      REAL SELFREFC(10,NG15)<a name='3431'>
      REAL FRACREFAC(NG15,9) <a name='3432'>
                                                                                 <a name='3433'>
      DO 2000 JN = 1,9                                                           <a name='3434'>
         DO 2000 JTJT = 1,5                                                        <a name='3435'>
            DO 2200 JPJP = 1,13                                                    <a name='3436'>
               IPRSM = 0                                                         <a name='3437'>
               DO 2400 IGC = 1,NGC(15)                                           <a name='3438'>
                  SUMK = 0.                                                      <a name='3439'>
                  DO 2600 IPR = 1, NGN(NGS(14)+IGC)                              <a name='3440'>
                     IPRSM = IPRSM + 1                                           <a name='3441'>
                     SUMK = SUMK + abscoefL(JN,JTJT,JPJP,IPRSM)*RWGT(IPRSM+224)<a name='3442'>
 2600             CONTINUE                                                       <a name='3443'>
                  ABSA15(JN+(JTJT-1)*9+(JPJP-1)*45,IGC) = SUMK <a name='3444'>
 2400          CONTINUE                                                          <a name='3445'>
 2200       CONTINUE                                                             <a name='3446'>
 2000 CONTINUE                                                                   <a name='3447'>
                                                                                 <a name='3448'>
      DO 4000 JTJT = 1,10                                                          <a name='3449'>
         IPRSM = 0                                                               <a name='3450'>
         DO 4400 IGC = 1,NGC(15)                                                 <a name='3451'>
            SUMK = 0.                                                            <a name='3452'>
            DO 4600 IPR = 1, NGN(NGS(14)+IGC)                                    <a name='3453'>
               IPRSM = IPRSM + 1                                                 <a name='3454'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+224)<a name='3455'>
 4600       CONTINUE                                                             <a name='3456'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='3457'>
 4400    CONTINUE                                                                <a name='3458'>
 4000 CONTINUE                                                                   <a name='3459'>
                                                                                 <a name='3460'>
      DO 7000 JPJP = 1,9                                                           <a name='3461'>
         IPRSM = 0                                                               <a name='3462'>
         DO 7400 IGC = 1,NGC(15)                                                 <a name='3463'>
            SUMF = 0.                                                            <a name='3464'>
            DO 7600 IPR = 1, NGN(NGS(14)+IGC)                                    <a name='3465'>
               IPRSM = IPRSM + 1                                                 <a name='3466'>
               SUMF = SUMF + FRACREFA(IPRSM,JPJP)                                  <a name='3467'>
 7600       CONTINUE                                                             <a name='3468'>
            FRACREFAC(IGC,JPJP) = SUMF                                             <a name='3469'>
 7400    CONTINUE                                                                <a name='3470'>
 7000 CONTINUE                                                                   <a name='3471'>
                                                                                 <a name='3472'>
   END SUBROUTINE CMBGB15<a name='3473'>
<a name='3474'>
<font color=#447700>!***************************************************************************<a name='3475'></font>
<A NAME='CMBGB16'><A href='../../html_code/phys/module_ra_rrtm.F.html#CMBGB16' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3476'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>CMBGB16</font>(abscoefL, SELFREF, FRACREFA,               &amp; <A href='../../call_to/CMBGB16.html' TARGET='index'>3</A>,<A href='../../call_from/CMBGB16.html' TARGET='index'>4</A><a name='3477'>
                      SELFREFC, FRACREFAC                        )<a name='3478'>
<font color=#447700>!***************************************************************************     <a name='3479'></font>
<font color=#447700>!                                                                                <a name='3480'></font>
<font color=#447700>!     BAND 16:  2600-3000 cm-1 (low - H2O,CH4; high - nothing)                   <a name='3481'></font>
<font color=#447700>!***************************************************************************     <a name='3482'></font>
                                                                                 <a name='3483'>
<font color=#447700>! Input                                                                          <a name='3484'></font>
      REAL abscoefL(9,5,13,MG)                                                         <a name='3485'>
      REAL SELFREF(10,MG)     <a name='3486'>
      REAL FRACREFA(MG,9)<a name='3487'>
<font color=#447700>!     REAL RWGT(MG*NBANDS) <a name='3488'></font>
<font color=#447700>! Output                                                                         <a name='3489'></font>
      REAL SELFREFC(10,NG16)<a name='3490'>
      REAL FRACREFAC(NG16,9)<a name='3491'>
                                                                                 <a name='3492'>
      DO 2000 JN = 1,9                                                           <a name='3493'>
         DO 2000 JTJT = 1,5                                                        <a name='3494'>
            DO 2200 JPJP = 1,13                                                    <a name='3495'>
               IPRSM = 0                                                         <a name='3496'>
               DO 2400 IGC = 1,NGC(16)                                           <a name='3497'>
                  SUMK = 0.                                                      <a name='3498'>
                  DO 2600 IPR = 1, NGN(NGS(15)+IGC)                              <a name='3499'>
                     IPRSM = IPRSM + 1                                           <a name='3500'>
                     SUMK = SUMK + abscoefL(JN,JTJT,JPJP,IPRSM)*RWGT(IPRSM+240)<a name='3501'>
 2600             CONTINUE                                                       <a name='3502'>
                  ABSA16(JN+(JTJT-1)*9+(JPJP-1)*45,IGC) = SUMK<a name='3503'>
 2400          CONTINUE                                                          <a name='3504'>
 2200       CONTINUE                                                             <a name='3505'>
 2000 CONTINUE                                                                   <a name='3506'>
                                                                                 <a name='3507'>
      DO 4000 JTJT = 1,10                                                          <a name='3508'>
         IPRSM = 0                                                               <a name='3509'>
         DO 4400 IGC = 1,NGC(16)                                                 <a name='3510'>
            SUMK = 0.                                                            <a name='3511'>
            DO 4600 IPR = 1, NGN(NGS(15)+IGC)                                    <a name='3512'>
               IPRSM = IPRSM + 1                                                 <a name='3513'>
               SUMK = SUMK + SELFREF(JTJT,IPRSM)*RWGT(IPRSM+240)<a name='3514'>
 4600       CONTINUE                                                             <a name='3515'>
            SELFREFC(JTJT,IGC) = SUMK                                              <a name='3516'>
 4400    CONTINUE                                                                <a name='3517'>
 4000 CONTINUE                                                                   <a name='3518'>
                                                                                 <a name='3519'>
      DO 7000 JPJP = 1,9                                                           <a name='3520'>
         IPRSM = 0                                                               <a name='3521'>
         DO 7400 IGC = 1,NGC(16)                                                 <a name='3522'>
            SUMF = 0.                                                            <a name='3523'>
            DO 7600 IPR = 1, NGN(NGS(15)+IGC)                                    <a name='3524'>
               IPRSM = IPRSM + 1                                                 <a name='3525'>
               SUMF = SUMF + FRACREFA(IPRSM,JPJP)                                  <a name='3526'>
 7600       CONTINUE                                                             <a name='3527'>
            FRACREFAC(IGC,JPJP) = SUMF                                             <a name='3528'>
 7400    CONTINUE                                                                <a name='3529'>
 7000 CONTINUE                                                                   <a name='3530'>
                                                                                 <a name='3531'>
   END SUBROUTINE CMBGB16<a name='3532'>
 <a name='3533'>
<font color=#447700>!-------------------------------------------------------------------------<a name='3534'></font>
<A NAME='INIRAD'><A href='../../html_code/phys/module_ra_rrtm.F.html#INIRAD' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3535'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>INIRAD</font> (O3PROF,Pw, kts, kte) <A href='../../call_to/INIRAD.html' TARGET='index'>6</A>,<A href='../../call_from/INIRAD.html' TARGET='index'>3</A><a name='3536'>
<font color=#447700>!-------------------------------------------------------------------------<a name='3537'></font>
      IMPLICIT NONE<a name='3538'>
<font color=#447700>!-------------------------------------------------------------------------<a name='3539'></font>
   INTEGER, INTENT(IN   )                        ::    kts,kte<a name='3540'>
<a name='3541'>
   REAL, DIMENSION( kts:kte ),INTENT(INOUT)      ::    O3PROF<a name='3542'>
<a name='3543'>
   REAL, DIMENSION( kts:kte+1 ),INTENT(IN   )    ::        Pw<a name='3544'>
<a name='3545'>
<font color=#447700>! LOCAL VAR<a name='3546'></font>
  <a name='3547'>
   REAL, DIMENSION( kts:kte+1 ) :: PAVEL, TAVEL <a name='3548'>
   REAL, DIMENSION(   0:kte+1 ) :: PZ, TZ<a name='3549'>
<a name='3550'>
   INTEGER :: k<a name='3551'>
<a name='3552'>
<a name='3553'>
<font color=#447700>!                                                                                <a name='3554'></font>
<font color=#447700>!  COMPUTE OZONE MIXING RATIO DISTRIBUTION                                       <a name='3555'></font>
<font color=#447700>!                                                                                <a name='3556'></font>
   DO K=kts,kte<a name='3557'>
      O3PROF(K)=0.                                                       <a name='3558'>
   ENDDO<a name='3559'>
                                                                                 <a name='3560'>
   CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#O3DATA'>O3DATA</A><A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#INIRAD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="O3DATA_1">(O3PROF, Pw, kts, kte)<a name='3561'>
<font color=#447700>!                                                                                <a name='3562'></font>
   END SUBROUTINE INIRAD<a name='3563'>
                                                                                 <a name='3564'>
<font color=#447700>!-------------------------------------------------------------------------<a name='3565'></font>
<A NAME='O3DATA'><A href='../../html_code/phys/module_ra_rrtm.F.html#O3DATA' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3566'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>O3DATA</font> (O3PROF, Pw, kts, kte) <A href='../../call_to/O3DATA.html' TARGET='index'>3</A><a name='3567'>
<font color=#447700>!-------------------------------------------------------------------------<a name='3568'></font>
   IMPLICIT NONE<a name='3569'>
<font color=#447700>!-------------------------------------------------------------------------<a name='3570'></font>
<font color=#447700>!<a name='3571'></font>
   INTEGER, INTENT(IN   )   ::       kts, kte<a name='3572'>
<font color=#447700>!<a name='3573'></font>
   REAL, DIMENSION( kts:kte ),INTENT(INOUT)      ::    O3PROF<a name='3574'>
<a name='3575'>
   REAL, DIMENSION( kts:kte+1 ),INTENT(IN   )    ::        Pw<a name='3576'>
<a name='3577'>
<font color=#447700>! LOCAL VAR<a name='3578'></font>
   INTEGER :: K, JJ, NK<a name='3579'>
<a name='3580'>
   REAL    ::  PRLEVH(kts:kte+1),PPWRKH(32),                       &amp;<a name='3581'>
               O3WRK(31),PPWRK(31),O3SUM(31),PPSUM(31),          &amp;<a name='3582'>
               O3WIN(31),PPWIN(31),O3ANN(31),PPANN(31)                                                       <a name='3583'>
<a name='3584'>
   REAL    ::  PB1, PB2, PT1, PT2<a name='3585'>
<a name='3586'>
   DATA O3SUM  /5.297E-8,5.852E-8,6.579E-8,7.505E-8,             &amp;                    <a name='3587'>
        8.577E-8,9.895E-8,1.175E-7,1.399E-7,1.677E-7,2.003E-7,   &amp;                 <a name='3588'>
        2.571E-7,3.325E-7,4.438E-7,6.255E-7,8.168E-7,1.036E-6,   &amp;                 <a name='3589'>
        1.366E-6,1.855E-6,2.514E-6,3.240E-6,4.033E-6,4.854E-6,   &amp;                 <a name='3590'>
        5.517E-6,6.089E-6,6.689E-6,1.106E-5,1.462E-5,1.321E-5,   &amp;                 <a name='3591'>
        9.856E-6,5.960E-6,5.960E-6/                                              <a name='3592'>
<a name='3593'>
   DATA PPSUM  /955.890,850.532,754.599,667.742,589.841,         &amp;  <a name='3594'>
        519.421,455.480,398.085,347.171,301.735,261.310,225.360, &amp;               <a name='3595'>
        193.419,165.490,141.032,120.125,102.689, 87.829, 75.123, &amp;            <a name='3596'>
         64.306, 55.086, 47.209, 40.535, 34.795, 29.865, 19.122, &amp;               <a name='3597'>
          9.277,  4.660,  2.421,  1.294,  0.647/                                 <a name='3598'>
<font color=#447700>!                                                                                <a name='3599'></font>
   DATA O3WIN  /4.629E-8,4.686E-8,5.017E-8,5.613E-8,             &amp;<a name='3600'>
        6.871E-8,8.751E-8,1.138E-7,1.516E-7,2.161E-7,3.264E-7,   &amp;               <a name='3601'>
        4.968E-7,7.338E-7,1.017E-6,1.308E-6,1.625E-6,2.011E-6,   &amp;               <a name='3602'>
        2.516E-6,3.130E-6,3.840E-6,4.703E-6,5.486E-6,6.289E-6,   &amp;               <a name='3603'>
        6.993E-6,7.494E-6,8.197E-6,9.632E-6,1.113E-5,1.146E-5,   &amp;               <a name='3604'>
        9.389E-6,6.135E-6,6.135E-6/                                              <a name='3605'>
<a name='3606'>
   DATA PPWIN  /955.747,841.783,740.199,649.538,568.404,         &amp;<a name='3607'>
        495.815,431.069,373.464,322.354,277.190,237.635,203.433, &amp;               <a name='3608'>
        174.070,148.949,127.408,108.915, 93.114, 79.551, 67.940, &amp;               <a name='3609'>
         58.072, 49.593, 42.318, 36.138, 30.907, 26.362, 16.423, &amp;               <a name='3610'>
          7.583,  3.620,  1.807,  0.938,  0.469/                                 <a name='3611'>
<font color=#447700>!                                                                                <a name='3612'></font>
<a name='3613'>
   DO K=1,31                                                              <a name='3614'>
     PPANN(K)=PPSUM(K)                                                        <a name='3615'>
   ENDDO<a name='3616'>
<font color=#447700>!<a name='3617'></font>
   O3ANN(1)=0.5*(O3SUM(1)+O3WIN(1))                                           <a name='3618'>
<font color=#447700>!                                                                                <a name='3619'></font>
   DO K=2,31                                                              <a name='3620'>
      O3ANN(K)=O3WIN(K-1)+(O3WIN(K)-O3WIN(K-1))/(PPWIN(K)-PPWIN(K-1))* &amp; <a name='3621'>
               (PPSUM(K)-PPWIN(K-1))                                           <a name='3622'>
   ENDDO<a name='3623'>
<font color=#447700>!<a name='3624'></font>
   DO K=2,31                                                              <a name='3625'>
      O3ANN(K)=0.5*(O3ANN(K)+O3SUM(K))                                         <a name='3626'>
   ENDDO<a name='3627'>
<font color=#447700>!<a name='3628'></font>
   DO K=1,31                                                                <a name='3629'>
      O3WRK(K)=O3ANN(K)                                                        <a name='3630'>
      PPWRK(K)=PPANN(K)                                                        <a name='3631'>
   ENDDO<a name='3632'>
<font color=#447700>!                                                                                <a name='3633'></font>
<font color=#447700>!  CALCULATE HALF PRESSURE LEVELS FOR MODEL AND DATA LEVELS                     <a name='3634'></font>
<font color=#447700>!                                                                                <a name='3635'></font>
<a name='3636'>
<font color=#447700>! Pw is total P at w level<a name='3637'></font>
<font color=#447700>! Pw is in mb<a name='3638'></font>
<a name='3639'>
   DO K=kts,kte+1<a name='3640'>
      NK=kte+1-K+1<a name='3641'>
      PRLEVH(K)=Pw(NK)<a name='3642'>
   ENDDO<a name='3643'>
<font color=#447700>!                                                                                <a name='3644'></font>
   PPWRKH(1)=1100.                                                        <a name='3645'>
   DO K=2,31                                                           <a name='3646'>
      PPWRKH(K)=(PPWRK(K)+PPWRK(K-1))/2.                                   <a name='3647'>
   ENDDO<a name='3648'>
   PPWRKH(32)=0.                                                          <a name='3649'>
   DO K=kts,kte<a name='3650'>
      DO 25 JJ=1,31                                                        <a name='3651'>
         IF((-(PRLEVH(K)-PPWRKH(JJ))).GE.0.)THEN                            <a name='3652'>
           PB1=0.                                                           <a name='3653'>
         ELSE                                                               <a name='3654'>
           PB1=PRLEVH(K)-PPWRKH(JJ)                                         <a name='3655'>
         ENDIF                                                              <a name='3656'>
         IF((-(PRLEVH(K)-PPWRKH(JJ+1))).GE.0.)THEN                          <a name='3657'>
           PB2=0.                                                           <a name='3658'>
         ELSE                                                               <a name='3659'>
           PB2=PRLEVH(K)-PPWRKH(JJ+1)                                       <a name='3660'>
         ENDIF                                                              <a name='3661'>
         IF((-(PRLEVH(K+1)-PPWRKH(JJ))).GE.0.)THEN                          <a name='3662'>
           PT1=0.                                                           <a name='3663'>
         ELSE                                                               <a name='3664'>
           PT1=PRLEVH(K+1)-PPWRKH(JJ)                                       <a name='3665'>
         ENDIF                                                              <a name='3666'>
         IF((-(PRLEVH(K+1)-PPWRKH(JJ+1))).GE.0.)THEN                        <a name='3667'>
           PT2=0.                                                           <a name='3668'>
         ELSE                                                               <a name='3669'>
           PT2=PRLEVH(K+1)-PPWRKH(JJ+1)                                     <a name='3670'>
         ENDIF                                                              <a name='3671'>
         O3PROF(K)=O3PROF(K)+(PB2-PB1-PT2+PT1)*O3WRK(JJ)                <a name='3672'>
  25  CONTINUE                                                             <a name='3673'>
      O3PROF(K)=O3PROF(K)/(PRLEVH(K)-PRLEVH(K+1))                      <a name='3674'>
<a name='3675'>
   ENDDO<a name='3676'>
<font color=#447700>!                                                                                <a name='3677'></font>
   END SUBROUTINE O3DATA<a name='3678'>
<a name='3679'>
<font color=#447700>!---------------------------------------------------------------------------<a name='3680'></font>
<A NAME='MM5ATM'><A href='../../html_code/phys/module_ra_rrtm.F.html#MM5ATM' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3681'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>MM5ATM</font>(CLDFRA,O3PROF,T,Tw,TSFC,QV,QC,QR,QI,QS,QG,    &amp; <A href='../../call_to/MM5ATM.html' TARGET='index'>1</A>,<A href='../../call_from/MM5ATM.html' TARGET='index'>2</A><a name='3682'>
                     P,Pw,DELZ,EMISS,R,G,                          &amp;<a name='3683'>
                     PAVEL,TAVEL,PZ,TZ,CLDFRAC,TAUCLOUD,COLDRY,    &amp;<a name='3684'>
                     WKL,WX,TBOUND,SEMISS,                         &amp;<a name='3685'>
<font color=#447700>!ccc Added for time-varying trace gases.<a name='3686'></font>
                     co2vmr, n2ovmr, ch4vmr,                            &amp;<a name='3687'>
<font color=#447700>!ccc<a name='3688'></font>
                     kts,kte                                       )<a name='3689'>
<font color=#447700>!---------------------------------------------------------------------------<a name='3690'></font>
<font color=#447700>!  RRTM Longwave Radiative Transfer Model                                        <a name='3691'></font>
<font color=#447700>!  Atmospheric and Environmental Research, Inc., Cambridge, MA                   <a name='3692'></font>
<font color=#447700>!                                                                                <a name='3693'></font>
<font color=#447700>!  Revision for NCAR MM5:  J. Dudhia (converted from CCM code)                   <a name='3694'></font>
<font color=#447700>!                                                                                <a name='3695'></font>
<font color=#447700>!  Input atmospheric profile from NCAR MM5, and prepare it for use in RRTM.      <a name='3696'></font>
<font color=#447700>!  Set other RRTM input parameters.  Values are passed back through existing     <a name='3697'></font>
<font color=#447700>!  RRTM arrays and commons.                                                      <a name='3698'></font>
<font color=#447700>!---------------------------------------------------------------------------<a name='3699'></font>
<font color=#447700>! RRTM Definitions                                                               <a name='3700'></font>
<font color=#447700>!    MXLAY = kte+1                ! Maximum number of model layers               <a name='3701'></font>
<font color=#447700>!    MAXXSEC                      ! Maximum number of cross sections             <a name='3702'></font>
<font color=#447700>!    NLAYERS                      ! Number of model layers (kte+1)               <a name='3703'></font>
<font color=#447700>!    PAVEL(MXLAY)                 ! Layer pressures (mb)                         <a name='3704'></font>
<font color=#447700>!    PZ(0:MXLAY)                  ! Level (interface) pressures (mb)             <a name='3705'></font>
<font color=#447700>!    TAVEL(MXLAY)                 ! Layer temperatures (K)                       <a name='3706'></font>
<font color=#447700>!    TZ(0:MXLAY)                  ! Level (interface) temperatures(mb)           <a name='3707'></font>
<font color=#447700>!    TBOUND                       ! Surface temperature (K)                      <a name='3708'></font>
<font color=#447700>!    COLDRY(MXLAY)                ! Dry air column (molecules/cm2)               <a name='3709'></font>
<font color=#447700>!    WKL(35,MXLAY)                ! Molecular amounts (molecules/cm2)            <a name='3710'></font>
<font color=#447700>!    WBRODL(MXLAY)                ! Inactive in this version                     <a name='3711'></font>
<font color=#447700>!    WX(MAXXSEC)                  ! Cross-section amounts (molecules/cm2)        <a name='3712'></font>
<font color=#447700>!    CLDFRAC(MXLAY)               ! Layer cloud fraction                         <a name='3713'></font>
<font color=#447700>!    TAUCLOUD(MXLAY)              ! Layer cloud optical depth                    <a name='3714'></font>
<font color=#447700>!    AMD                          ! Atomic weight of dry air                     <a name='3715'></font>
<font color=#447700>!    AMW                          ! Atomic weight of water                       <a name='3716'></font>
<font color=#447700>!    AMO                          ! Atomic weight of ozone                       <a name='3717'></font>
<font color=#447700>!    AMCH4                        ! Atomic weight of methane                     <a name='3718'></font>
<font color=#447700>!    AMN2O                        ! Atomic weight of nitrous oxide               <a name='3719'></font>
<font color=#447700>!    AMC11                        ! Atomic weight of CFC-11                      <a name='3720'></font>
<font color=#447700>!    AMC12                        ! Atomic weight of CFC-12                      <a name='3721'></font>
<font color=#447700>!    NXMOL                        ! Number of cross-section molecules            <a name='3722'></font>
<font color=#447700>!    IXINDX                       ! Cross-section molecule index (see below)     <a name='3723'></font>
<font color=#447700>!    IXSECT                       ! On/off flag for cross-sections (inactive)    <a name='3724'></font>
<font color=#447700>!    IXMAX                        ! Maximum number of cross-sections (inactive)  <a name='3725'></font>
<font color=#447700>!                                                                                <a name='3726'></font>
<font color=#447700>!-----------------------------------------------------------------------------<a name='3727'></font>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='3728'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='3729'></font>
<font color=#447700>! carry constants.                                                               <a name='3730'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3731'></font>
<font color=#447700>!     Activate cross section molecules:                                             <a name='3732'></font>
<font color=#447700>!     NXMOL     - number of cross-sections input by user                         <a name='3733'></font>
<font color=#447700>!     IXINDX(I) - index of cross-section molecule corresponding to Ith           <a name='3734'></font>
<font color=#447700>!                 cross-section specified by user                                <a name='3735'></font>
<font color=#447700>!                 = 0 -- not allowed in RRTM                                     <a name='3736'></font>
<font color=#447700>!                 = 1 -- CCL4                                                    <a name='3737'></font>
<font color=#447700>!                 = 2 -- CFC11                                                   <a name='3738'></font>
<font color=#447700>!                 = 3 -- CFC12                                                   <a name='3739'></font>
<font color=#447700>!                 = 4 -- CFC22                                                   <a name='3740'></font>
<font color=#447700>!     DATA NXMOL  /2/                                                            <a name='3741'></font>
<font color=#447700>!     DATA IXINDX /0,2,3,0,31*0/                                                 <a name='3742'></font>
<font color=#447700>!                                                                                 <a name='3743'></font>
<font color=#447700>!    CLOUD EMISSIVITIES (M^2/G)                                                  <a name='3744'></font>
<font color=#447700>!    THESE ARE CONSISTENT WITH LWRAD (ABCW=0.5*(ABUP+ABDOWN))                    <a name='3745'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3746'></font>
<a name='3747'>
                                                                                 <a name='3748'>
      INTEGER, INTENT(IN ) ::  kts, kte<a name='3749'>
<font color=#447700>!<a name='3750'></font>
      REAL, DIMENSION( 35,kts:NLAYERS ),                    &amp;<a name='3751'>
            INTENT(INOUT)        ::                  WKL<a name='3752'>
<a name='3753'>
      REAL, DIMENSION( MAXXSEC,kts:NLAYERS ),               &amp;<a name='3754'>
            INTENT(INOUT)        ::                   WX<a name='3755'>
<a name='3756'>
      REAL, INTENT(INOUT)        ::               TBOUND<a name='3757'>
      REAL, DIMENSION(NBANDS), INTENT(INOUT) ::   SEMISS<a name='3758'>
<a name='3759'>
      REAL, DIMENSION( kts:kte+1 ), INTENT(IN   ) ::      &amp;<a name='3760'>
                                                      Tw, &amp;<a name='3761'>
                                                      Pw<a name='3762'>
      REAL, DIMENSION( kts:kte ), INTENT(IN   ) ::        &amp;<a name='3763'>
                                                  CLDFRA, &amp;<a name='3764'>
                                                  O3PROF, &amp;<a name='3765'>
                                                    DELZ, &amp;<a name='3766'>
                                                       T, &amp;<a name='3767'>
                                                       P<a name='3768'>
<a name='3769'>
      REAL, DIMENSION( kts:kte ), INTENT(INOUT) ::        &amp;<a name='3770'>
                                                      QV<a name='3771'>
<a name='3772'>
      REAL, DIMENSION( kts:kte ), INTENT(IN   ) ::        &amp;<a name='3773'>
                                                      QC, &amp;<a name='3774'>
                                                      QR, &amp;<a name='3775'>
                                                      QI, &amp;<a name='3776'>
                                                      QS, &amp;<a name='3777'>
                                                      QG<a name='3778'>
<a name='3779'>
      REAL, DIMENSION( kts:NLAYERS ), INTENT(INOUT) ::    &amp;<a name='3780'>
                                                   PAVEL, &amp;<a name='3781'>
                                                   TAVEL, &amp;<a name='3782'>
                                                 CLDFRAC, &amp;    <a name='3783'>
                                                TAUCLOUD, &amp;<a name='3784'>
                                                  COLDRY <a name='3785'>
<a name='3786'>
      REAL, DIMENSION(   0:NLAYERS ), INTENT(INOUT) ::    &amp;<a name='3787'>
                                                      PZ, &amp;<a name='3788'>
                                                      TZ<a name='3789'>
<a name='3790'>
      REAL, INTENT(IN   ) ::   R,G,EMISS,TSFC<a name='3791'>
<a name='3792'>
<font color=#447700>!ccc Added for time-varying trace gases mixing ratios.<a name='3793'></font>
<font color=#447700>! Trace gase variables<a name='3794'></font>
      REAL(8), INTENT(IN   ) ::                      co2vmr, n2ovmr, ch4vmr<a name='3795'>
<font color=#447700>!ccc<a name='3796'></font>
<a name='3797'>
      REAL    :: GRAVIT<a name='3798'>
 <a name='3799'>
<font color=#447700>!<a name='3800'></font>
<font color=#447700>! LOCAL<a name='3801'></font>
<a name='3802'>
      REAL, DIMENSION( kts:kte ) ::                 CLDFRC, &amp;<a name='3803'>
                                                      PINT, &amp;<a name='3804'>
                                                      TINT, &amp;<a name='3805'>
                                                        O3, &amp;<a name='3806'>
                                                       N2O, &amp;<a name='3807'>
                                                       CH4, &amp;<a name='3808'>
                                                      CLWP, &amp;<a name='3809'>
                                                      CIWP, &amp;<a name='3810'>
                                                      PLWP, &amp;<a name='3811'>
                                                      PIWP<a name='3812'>
<font color=#447700>! New declarations for RRTM buffer patch.<a name='3813'></font>
<font color=#447700>! Steven Cavallo, NCAR/MMM 01/2010<a name='3814'></font>
      <a name='3815'>
      INTEGER, PARAMETER :: nproflevs = 60 <font color=#447700>! Constant, from the table<a name='3816'></font>
      INTEGER :: L, LL, klev               <font color=#447700>! Loop indices      <a name='3817'></font>
      REAL, DIMENSION( kts:NLAYERS ) :: O3PROF2, PZR, varint<a name='3818'>
      REAL :: wght,vark,vark1       <a name='3819'>
      REAL :: PPROF(nproflevs), TPROF(nproflevs)            <a name='3820'>
      <font color=#447700>! Mean pressure and temperature profiles from midlatitude <a name='3821'></font>
      <font color=#447700>! summer (MLS),midlatitude winter (MLW), sub-Arctic <a name='3822'></font>
      <font color=#447700>! winter (SAW),and tropical (TROP) standard atmospheres.<a name='3823'></font>
      DATA PPROF   /1000.00,855.47,731.82,626.05,535.57,458.16,     &amp;<a name='3824'>
                    391.94,335.29,286.83,245.38,209.91,179.57,      &amp;<a name='3825'>
                    153.62,131.41,112.42,96.17,82.27,70.38,         &amp;<a name='3826'>
                    60.21,51.51,44.06,37.69,32.25,27.59,            &amp;<a name='3827'>
                    23.60,20.19,17.27,14.77,12.64,10.81,            &amp;<a name='3828'>
                    9.25,7.91,6.77,5.79,4.95,4.24,                  &amp;<a name='3829'>
                    3.63,3.10,2.65,2.27,1.94,1.66,                  &amp;<a name='3830'>
                    1.42,1.22,1.04,0.89,0.76,0.65,                  &amp;<a name='3831'>
                    0.56,0.48,0.41,0.35,0.30,0.26,                  &amp;<a name='3832'>
                    0.22,0.19,0.16,0.14,0.12,0.10/<a name='3833'>
      DATA TPROF   /279.94,276.16,270.73,264.14,256.71,249.28,      &amp;<a name='3834'>
                    241.97,234.91,228.78,224.02,220.52,217.31,      &amp;<a name='3835'>
                    215.21,213.48,211.63,211.45,211.73,212.71,      &amp;<a name='3836'>
                    213.81,214.95,215.96,216.73,217.42,218.11,      &amp;<a name='3837'>
                    218.89,219.92,221.31,222.84,224.39,226.04,      &amp;<a name='3838'>
                    227.78,229.73,231.88,234.22,236.82,239.50,      &amp;<a name='3839'>
                    242.30,245.21,248.13,251.08,254.04,257.02,      &amp;<a name='3840'>
                    259.84,261.88,263.38,264.67,265.42,265.34,      &amp;<a name='3841'>
                    264.45,262.76,260.85,258.78,256.49,254.02,      &amp;<a name='3842'>
                    251.07,248.23,245.46,242.77,239.87,237.53/<a name='3843'>
<a name='3844'>
<font color=#447700>! End new declarations for buffer layer edit<a name='3845'></font>
<a name='3846'>
      CHARACTER*80 errmess<a name='3847'>
                           <a name='3848'>
      real :: amd       <font color=#447700>! Effective molecular weight of dry air (g/mol)  <a name='3849'></font>
      real :: amw       <font color=#447700>! Molecular weight of water vapor (g/mol)        <a name='3850'></font>
      real :: amo       <font color=#447700>! Molecular weight of ozone (g/mol)              <a name='3851'></font>
      real :: amch4     <font color=#447700>! Molecular weight of methane (g/mol)            <a name='3852'></font>
      real :: amn2o     <font color=#447700>! Molecular weight of nitrous oxide (g/mol)      <a name='3853'></font>
      real :: amc11     <font color=#447700>! Molecular weight of CFC11 (g/mol) - CFCL3      <a name='3854'></font>
      real :: amc12     <font color=#447700>! Molecular weight of CFC12 (g/mol) - CF2CL2     <a name='3855'></font>
      real :: avgdro    <font color=#447700>! Avogadro's number (molecules/mole)             <a name='3856'></font>
                                                                                 <a name='3857'>
<font color=#447700>! Atomic weights for conversion from mass to volume mixing ratios                <a name='3858'></font>
<a name='3859'>
      data amd   /  28.9644   /                                                  <a name='3860'>
      data amw   /  18.0154   /                                                  <a name='3861'>
      data amo   /  47.9998   /                                                  <a name='3862'>
      data amch4 /  16.0430   /                                                  <a name='3863'>
      data amn2o /  44.0128   /                                                  <a name='3864'>
      data amc11 / 137.3684   /                                                  <a name='3865'>
      data amc12 / 120.9138   /                                                  <a name='3866'>
      data avgdro/ 6.022E23   /                                                  <a name='3867'>
                                                                                 <a name='3868'>
<font color=#447700>!     Set molecular weight ratios                                                    <a name='3869'></font>
<a name='3870'>
      real :: amdw,  &amp;  <font color=#447700>! Molecular weight of dry air / water vapor      <a name='3871'></font>
              amdo,  &amp;  <font color=#447700>! Molecular weight of dry air / ozone<a name='3872'></font>
              amdc,  &amp;  <font color=#447700>! Molecular weight of dry air / methane          <a name='3873'></font>
              amdn,  &amp;  <font color=#447700>! Molecular weight of dry air / nitrous oxide    <a name='3874'></font>
              amdc1, &amp;  <font color=#447700>! Molecular weight of dry air / CFC11            <a name='3875'></font>
              amdc2     <font color=#447700>! Molecular weight of dry air / CFC12            <a name='3876'></font>
<a name='3877'>
      data amdw /  1.607758 /                                                    <a name='3878'>
      data amdo /  0.603461 /                                                    <a name='3879'>
      data amdc /  1.805423 /                                                    <a name='3880'>
      data amdn /  0.658090 /                                                    <a name='3881'>
      data amdc1/  0.210852 /                                                    <a name='3882'>
      data amdc2/  0.239546 /                                                    <a name='3883'>
<a name='3884'>
<font color=#447700>!     Put in CO2 volume mixing ratio here (330 ppmv)                                <a name='3885'></font>
<font color=#447700>!     Added H2O volume mixing ratio from standard atmosphere <a name='3886'></font>
<font color=#447700>!        above 150 mb (Steven Cavallo, 01/2010).<a name='3887'></font>
<font color=#447700>!ccc<a name='3888'></font>
<font color=#447700>!ccc Modified CO2 VMR declaration for time-varying case.<a name='3889'></font>
<font color=#447700>!      real :: co2vmr, h2ovmr<a name='3890'></font>
<font color=#447700>!      data co2vmr / 330.e-6 /                                                    <a name='3891'></font>
<font color=#447700>!      data h2ovmr / 5.00e-6 /<a name='3892'></font>
      real ::  h2ovmr<a name='3893'>
      data h2ovmr / 5.00e-6 /<a name='3894'>
                                                                                 <a name='3895'>
      REAL :: ABCW,ABICE,ABRN,ABSN<a name='3896'>
<a name='3897'>
      DATA ABCW /0.144/                                                          <a name='3898'>
      DATA ABICE /0.0735/                                                        <a name='3899'>
      DATA ABRN /0.330E-3/                                                       <a name='3900'>
      DATA ABSN /2.34E-3/                                                        <a name='3901'>
<a name='3902'>
      GRAVIT = G*100.<a name='3903'>
<a name='3904'>
<font color=#447700>!                                                                                <a name='3905'></font>
<font color=#447700>!  MID-LAYER VALUES                                                              <a name='3906'></font>
      DO K=kts,kte<a name='3907'>
          RO=P(K)/(R*T(K))*100.                                                  <a name='3908'>
          DZ=DELZ(K)<a name='3909'>
          QV(K)=AMAX1(QV(K),1.E-12) <a name='3910'>
  <a name='3911'>
          CLDFRC(K)=CLDFRA(K)                                                   <a name='3912'>
                                                                                 <a name='3913'>
<font color=#447700>!  PATHS IN G/M^2                                                                <a name='3914'></font>
<a name='3915'>
<font color=#447700>! QI=0 if no ice phase<a name='3916'></font>
<font color=#447700>! QS=0 if no ice phase<a name='3917'></font>
<a name='3918'>
            CLWP(K)=RO*QC(K)*DZ*1000.                                            <a name='3919'>
            CIWP(K)=RO*QI(K)*DZ*1000.                                            <a name='3920'>
            PLWP(K)=(RO*QR(K))**0.75*DZ*1000.                                    <a name='3921'>
            PIWP(K)=(RO*QS(K))**0.75*DZ*1000.                                   <a name='3922'>
                                                                                 <a name='3923'>
          O3(K)=O3PROF(K)                                                      <a name='3924'>
          N2O(K)=0.                                                              <a name='3925'>
          CH4(K)=0.                                                              <a name='3926'>
                                                                                 <a name='3927'>
      ENDDO<a name='3928'>
<a name='3929'>
<font color=#447700>!ccc Unit conversion<a name='3930'></font>
   N2O(:) = n2ovmr / amdn<a name='3931'>
   CH4(:) = ch4vmr / amdc<a name='3932'>
<font color=#447700>!ccc                                                                      <a name='3933'></font>
<a name='3934'>
                                                                                 <a name='3935'>
<font color=#447700>!  Initialize all molecular amounts to zero here, then pass MM5 amounts          <a name='3936'></font>
<font color=#447700>!  into RRTM arrays WKL and WX below.                                            <a name='3937'></font>
                                                                                 <a name='3938'>
<font color=#447700>!      DO 1000 ILAY = kts,kte+1<a name='3939'></font>
      DO 1000 ILAY = kts,NLAYERS<a name='3940'>
         DO 1100 ISP = 1,35                                                      <a name='3941'>
 1100       WKL(ISP,ILAY) = 0.0                                                  <a name='3942'>
         DO 1200 ISP = 1,MAXXSEC                                                 <a name='3943'>
 1200       WX(ISP,ILAY) = 0.0                                                   <a name='3944'>
 1000 CONTINUE                                                                   <a name='3945'>
                                                                                 <a name='3946'>
<font color=#447700>!  Set parameters needed for RRTM execution:                                     <a name='3947'></font>
<a name='3948'>
      IXSECT = 1                                                                 <a name='3949'>
      IXMAX = 4                                                                  <a name='3950'>
                                                                                 <a name='3951'>
<font color=#447700>!  Set surface temperature.  The longwave upward surface flux is                 <a name='3952'></font>
<font color=#447700>!  computed in the Land Surface Model based on the surface                       <a name='3953'></font>
<font color=#447700>!  temperature and the emissivity of the surface type for each                   <a name='3954'></font>
<font color=#447700>!  grid point.  The bottom interface temperature, tint(kte+1), is                 <a name='3955'></font>
<font color=#447700>!  ground temperature consistent with this LW upward flux, and                   <a name='3956'></font>
<font color=#447700>!  TBOUND is set to this temperature here.                                       <a name='3957'></font>
                                                                                 <a name='3958'>
<font color=#447700>!     TBOUND = TINT(kte+1)                                                        <a name='3959'></font>
<font color=#447700>!     TBOUND = Tw(kte+1)                                                        <a name='3960'></font>
      TBOUND = TSFC<a name='3961'>
      IF(TBOUND .GT. 340.)THEN<a name='3962'>
        WRITE( errmess , '(A,F10.3)' ) 'rrtm: TBOUND exceeds table limit: reset ',TBOUND<a name='3963'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtm.F.html#MM5ATM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_855"> (errmess)<a name='3964'>
        TBOUND = 339.99<a name='3965'>
      ENDIF<a name='3966'>
                                                                                 <a name='3967'>
<font color=#447700>!  Install MM5 profiles into RRTM arrays for pressure, temperature,              <a name='3968'></font>
<font color=#447700>!  and molecular amounts.  Pressures are converted from cb                       <a name='3969'></font>
<font color=#447700>!  (CCM) to mb (RRTM).  H2O and trace gas amounts are converted from             <a name='3970'></font>
<font color=#447700>!  mass mixing ratio to volume mixing ratio.  CO2 vmr is constant at all         <a name='3971'></font>
<font color=#447700>!  levels.  The dry air column COLDRY (in molec/cm2) is calculated               <a name='3972'></font>
<font color=#447700>!  from the level pressures PZ (in mb) based on the hydrostatic equation         <a name='3973'></font>
<font color=#447700>!  and includes a correction to account for H2O in the layer.  The               <a name='3974'></font>
<font color=#447700>!  molecular weight of moist air (amm) is calculated for each layer.             <a name='3975'></font>
                                                                                 <a name='3976'>
<font color=#447700>!  RRTM is executed for additional levels (L = kte + int(p_top/4) + 1)<a name='3977'></font>
<font color=#447700>!  from the model top (p_top) to 0 mb, to estimate the downward                  <a name='3978'></font>
<font color=#447700>!  fluxes between the model top interface and the top of the atmosphere<a name='3979'></font>
<font color=#447700>!  where kte is the top WRF model level index and p_top is the pressure at <a name='3980'></font>
<font color=#447700>!  the top model level. H2O, CO2, N2O, and CH4 vmrs for these extra layers are <a name='3981'></font>
<font color=#447700>!  set to the values in the model's top layer, though the O3 value is <a name='3982'></font>
<font color=#447700>!  interpolated based on the US Std Atm. For GCMs with a model top near 0 mb, <a name='3983'></font>
<font color=#447700>!  these extra layers are not needed, and NLAYERS should be set to the number <a name='3984'></font>
<font color=#447700>!  of model layers (kte in this case).       <a name='3985'></font>
<font color=#447700>!  Note: RRTM levels count from bottom to top, while MM5 levels count            <a name='3986'></font>
<font color=#447700>!  from the top down and must be reversed here.                                  <a name='3987'></font>
                                                                                 <a name='3988'>
<font color=#447700>!     NMOL = 6                                                                   <a name='3989'></font>
<font color=#447700>!     PZ(0) = pint(kte+1)                                                         <a name='3990'></font>
<font color=#447700>!     TZ(0) = tint(kte+1)                                                         <a name='3991'></font>
<a name='3992'>
      PZ(0) = Pw(kte+1)                                                         <a name='3993'>
      TZ(0) = Tw(kte+1)                                                         <a name='3994'>
<font color=#447700>!      DO 2000 L = 1, NLAYERS-1                                                   <a name='3995'></font>
      DO 2000 L = 1, kte <a name='3996'>
         PAVEL(L) = p(kte+1-L)                                                   <a name='3997'>
         TAVEL(L) = t(kte+1-L)                                                   <a name='3998'>
<font color=#447700>!        PZ(L) = pint(kte+1-L)                                                    <a name='3999'></font>
<font color=#447700>!        TZ(L) = tint(kte+1-L)                                                    <a name='4000'></font>
         PZ(L) = Pw(kte+1-L)                                                    <a name='4001'>
         TZ(L) = Tw(kte+1-L)                                                    <a name='4002'>
         WKL(1,L) = qv(kte+1-L)*amdw<a name='4003'>
         <font color=#447700>! Set the water vapor mixing ratio constant above <a name='4004'></font>
         <font color=#447700>! the typical level where global and reanalysis data<a name='4005'></font>
         <font color=#447700>! does not provide it.  Steven Cavallo 01/2010.<a name='4006'></font>
         <font color=#447700>!IF (PAVEL(L).LE.100) THEN<a name='4007'></font>
         <font color=#447700>!   WKL(1,L) = h2ovmr<a name='4008'></font>
         <font color=#447700>!ENDIF                                            <a name='4009'></font>
         WKL(2,L) = co2vmr<a name='4010'>
         WKL(3,L) = o3(kte+1-L)                                                        <a name='4011'>
<font color=#447700>! ozone is already bottom to top array but convert mmr to vmr<a name='4012'></font>
         WKL(3,L) = o3(L)*amdo                                                  <a name='4013'>
         WKL(4,L) = n2o(kte+1-L)*amdn                                            <a name='4014'>
         WKL(6,L) = ch4(kte+1-L)*amdc                                            <a name='4015'>
         amm = (1-WKL(1,L))*amd + WKL(1,L)*amw                                   <a name='4016'>
         COLDRY(L) = (PZ(L-1)-PZ(L))*1.E3*avgdro/    &amp; <a name='4017'>
                               (gravit*amm*(1+WKL(1,L)))<a name='4018'>
 2000    CONTINUE                                                                <a name='4019'>
<a name='4020'>
<font color=#447700>!  Set cross section molecule amounts from CCM; convert to vmr                   <a name='4021'></font>
<font color=#447700>!      DO 2100 L=1, NLAYERS-1                                                     <a name='4022'></font>
      DO 2100 L=1, kte      <a name='4023'>
<font color=#447700>!        WX(2,L) = c11mmr(kte+1-L)*amdc1                                         <a name='4024'></font>
<font color=#447700>!        WX(3,L) = c12mmr(kte+1-L)*amdc2                                         <a name='4025'></font>
         WX(2,L) = 0.                                                            <a name='4026'>
         WX(3,L) = 0.                                                            <a name='4027'>
 2100 CONTINUE                                                                   <a name='4028'>
  <a name='4029'>
<font color=#447700>!  old section<a name='4030'></font>
   IF ( 1 .EQ. 0 ) THEN                                                                                 <a name='4031'>
<font color=#447700>!  *****                                                                         <a name='4032'></font>
<font color=#447700>!  Set up values for extra layer at top of the atmosphere.                       <a name='4033'></font>
<font color=#447700>!  The top layer temperature for all gridpoints is set to the top layer-1        <a name='4034'></font>
<font color=#447700>!  temperature plus a constant (0 K) that represents an isothermal layer         <a name='4035'></font>
<font color=#447700>!  above ptop.  Top layer interface temperatures are                             <a name='4036'></font>
<font color=#447700>!  linearly interpolated from the layer temperatures.                            <a name='4037'></font>
<font color=#447700>!  Note: The top layer temperature and ozone amount are based on a 0-3mb         <a name='4038'></font>
<font color=#447700>!  top layer and must be modified if the layering is changed.                    <a name='4039'></font>
<font color=#447700>!  This section should be commented if the extra layer is not needed.            <a name='4040'></font>
                                                                                 <a name='4041'>
      PAVEL(NLAYERS) = 0.5*PZ(NLAYERS-1)                                         <a name='4042'>
      TAVEL(NLAYERS) = TAVEL(NLAYERS-1) + 0.0                                    <a name='4043'>
      PZ(NLAYERS) = 0.00                                                         <a name='4044'>
      TZ(NLAYERS-1) = 0.5*(TAVEL(NLAYERS)+TAVEL(NLAYERS-1))                      <a name='4045'>
      TZ(NLAYERS) = TZ(NLAYERS-1)+0.0                                            <a name='4046'>
      WKL(1,NLAYERS) = WKL(1,NLAYERS-1)                                          <a name='4047'>
      WKL(2,NLAYERS) = co2vmr                                                    <a name='4048'>
      WKL(3,NLAYERS) = 0.6*WKL(3,NLAYERS-1)                                      <a name='4049'>
      WKL(4,NLAYERS) = WKL(4,NLAYERS-1)                                          <a name='4050'>
      WKL(6,NLAYERS) = WKL(6,NLAYERS-1)                                          <a name='4051'>
      amm = (1-WKL(1,NLAYERS-1))*amd + WKL(1,NLAYERS-1)*amw                      <a name='4052'>
<font color=#447700>!     COLDRY(NLAYERS) = (PZ(NLAYERS-1))*1.E3*avgdro/       &amp; <a name='4053'></font>
      COLDRY(NLAYERS) = ((PZ(NLAYERS-1)-PZ(NLAYERS)))*1.E3*avgdro/       &amp; <a name='4054'>
                               (gravit*amm*(1+WKL(1,NLAYERS-1)))                 <a name='4055'>
      WX(2,NLAYERS) = WX(2,NLAYERS-1)                                            <a name='4056'>
      WX(3,NLAYERS) = WX(3,NLAYERS-1)                                            <a name='4057'>
<font color=#447700>!  *****               <a name='4058'></font>
<a name='4059'>
   ENDIF<a name='4060'>
   <a name='4061'>
<font color=#447700>!  *****                                                                         <a name='4062'></font>
<font color=#447700>!  Set up values for extra layers to the top of the atmosphere.                       <a name='4063'></font>
<font color=#447700>!  Temperature is calculated based on an average temperature profile given<a name='4064'></font>
<font color=#447700>!  here in a table.  The input table data is linearly interpolated to the<a name='4065'></font>
<font color=#447700>!  column pressure.  Mixing ratios are held constant except for ozone.  <a name='4066'></font>
<font color=#447700>!  Caution should be used if model top pressure is less than 5 hPa.<a name='4067'></font>
<font color=#447700>!  Steven Cavallo, NCAR/MMM, January 2010<a name='4068'></font>
       <font color=#447700>! Calculate the column pressure buffer levels above the <a name='4069'></font>
       <font color=#447700>! model top       <a name='4070'></font>
       DO 3000 L=kte+1,NLAYERS-1,1<a name='4071'>
          PZ(L) = PZ(L-1) - deltap<a name='4072'>
          PAVEL(L) = 0.5*(PZ(L) + PZ(L-1))<a name='4073'>
 3000  CONTINUE          <a name='4074'>
       <font color=#447700>! Add zero as top level.  This gets the temperature max at the<a name='4075'></font>
       <font color=#447700>! stratopause, reducing the downward flux errors in the top <a name='4076'></font>
       <font color=#447700>! levels.  If zero happened to be the top level already,<a name='4077'></font>
       <font color=#447700>! this will add another level with zero, but will not affect<a name='4078'></font>
       <font color=#447700>! the radiative transfer calculation.<a name='4079'></font>
       PZ(NLAYERS) = 0.00<a name='4080'>
       PAVEL(NLAYERS) =  0.5*(PZ(NLAYERS) + PZ(NLAYERS-1))<a name='4081'>
<a name='4082'>
       <font color=#447700>! Interpolate the table temperatures to column pressure levels    <a name='4083'></font>
       DO 3100 L=1,NLAYERS,1<a name='4084'>
          IF ( PPROF(nproflevs) .LT. PZ(L) ) THEN<a name='4085'>
             DO 3150 LL=2,nproflevs,1       <a name='4086'>
                IF ( PPROF(LL) .LT. PZ(L) ) THEN           <a name='4087'>
                   klev = LL - 1<a name='4088'>
                   exit<a name='4089'>
                ENDIF<a name='4090'>
 3150        CONTINUE<a name='4091'>
          <a name='4092'>
          ELSE<a name='4093'>
             klev = nproflevs<a name='4094'>
          ENDIF  <a name='4095'>
  <a name='4096'>
          IF (klev .NE. nproflevs ) THEN<a name='4097'>
             vark  = TPROF(klev) <a name='4098'>
             vark1 = TPROF(klev+1)<a name='4099'>
             wght=( PZ(L)-PPROF(klev) ) / ( PPROF(klev+1)-PPROF(klev))<a name='4100'>
          ELSE<a name='4101'>
             vark  = TPROF(klev) <a name='4102'>
             vark1 = TPROF(klev)<a name='4103'>
             wght = 0.0<a name='4104'>
          ENDIF<a name='4105'>
          varint(L) = wght*(vark1-vark)+vark<a name='4106'>
<a name='4107'>
 3100 CONTINUE                   <a name='4108'>
        <a name='4109'>
       <font color=#447700>! Match the interpolated table temperature profile to WRF column                    <a name='4110'></font>
       DO 3200 L=kte+1,NLAYERS,1<a name='4111'>
          TZ(L) = varint(L) + (TZ(kte) - varint(kte))<a name='4112'>
          TAVEL(L) = 0.5*(TZ(L) + TZ(L-1))  <a name='4113'>
 3200  CONTINUE                 <a name='4114'>
       <a name='4115'>
       <font color=#447700>! Get the new ozone profile.  First need to reverse pressure<a name='4116'></font>
       <font color=#447700>! array for the ozone interpolator subroutines.     <a name='4117'></font>
       DO 3225 L=kts,NLAYERS,1<a name='4118'>
         klev=NLAYERS-L+1<a name='4119'>
         PZR(L)=PZ(klev)<a name='4120'>
 3225  CONTINUE     <a name='4121'>
       CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#INIRAD'>INIRAD</A><A href='../../html_code/phys/module_ra_rrtm.F.html#MM5ATM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INIRAD_2"> (O3PROF2(kts:NLAYERS-1),PZR,kts,NLAYERS-1)       <a name='4122'>
       <font color=#447700>! Pick the top level to be the closest to zero from the table<a name='4123'></font>
       O3PROF2(NLAYERS) = 6.135E-6      <a name='4124'>
       <a name='4125'>
       <font color=#447700>! Keep all molecular mixing ratios constant in the buffer zone,<a name='4126'></font>
       <font color=#447700>! except for ozone<a name='4127'></font>
       IF ( kte .NE. NLAYERS ) THEN <a name='4128'>
          DO 3250 L=1,NLAYERS,1<a name='4129'>
             WKL(3,L) = O3PROF2(L)*amdo<font color=#447700>! O3<a name='4130'></font>
             IF ( L .GT. kte ) THEN<a name='4131'>
<font color=#447700>!               WKL(1,L) = WKL(1,kte)  ! H2O<a name='4132'></font>
                WKL(1,L) = h2ovmr      <font color=#447700>! H2O above model top set to constant value<a name='4133'></font>
                WKL(2,L) = co2vmr      <font color=#447700>! CO2<a name='4134'></font>
                WKL(4,L) = WKL(4,kte)  <font color=#447700>! N2O<a name='4135'></font>
                WKL(6,L) = WKL(6,kte)  <font color=#447700>! CH4<a name='4136'></font>
                amm = (1-WKL(1,L))*amd + WKL(1,L)*amw<a name='4137'>
                COLDRY(L) = (PZ(L-1)-PZ(L))*1.E3*avgdro/    &amp; <a name='4138'>
                         (gravit*amm*(1+WKL(1,L)))    <a name='4139'>
                WX(2,L) = WX(2,kte)<a name='4140'>
                WX(3,L) = WX(3,kte)<a name='4141'>
             ENDIF<a name='4142'>
 3250     CONTINUE                <a name='4143'>
       ENDIF<a name='4144'>
<font color=#447700>!<a name='4145'></font>
<font color=#447700>!  End of buffer layer edit.<a name='4146'></font>
<font color=#447700>!                                                             <a name='4147'></font>
<font color=#447700>!  Here, all molecules in WKL and WX are in volume mixing ratio; convert to      <a name='4148'></font>
<font color=#447700>!  molec/cm2 based on COLDRY for use in RRTM                                     <a name='4149'></font>
                                                                                 <a name='4150'>
      DO 5000 L = 1, NLAYERS                                                     <a name='4151'>
         DO 4200 IMOL = 1, NMOL                                                  <a name='4152'>
            WKL(IMOL,L) = COLDRY(L) * WKL(IMOL,L)                                <a name='4153'>
 4200    CONTINUE                                                                <a name='4154'>
         DO 4400 IX = 1,MAXXSEC                                                  <a name='4155'>
            IF (IXINDX(IX) .NE. 0) THEN                                          <a name='4156'>
               WX(IXINDX(IX),L) = COLDRY(L) * WX(IX,L) * 1.E-20                  <a name='4157'>
            ENDIF                                                                <a name='4158'>
 4400    CONTINUE                                                                <a name='4159'>
 5000 CONTINUE                                                                   <a name='4160'>
                                                                            <a name='4161'>
 <a name='4162'>
<font color=#447700>!  Set spectral surface emissivity for each longwave band.  The default value    <a name='4163'></font>
<font color=#447700>!  is set here to emiss(i,j) based on land-use (taken to be constant across band <a name='4164'></font>
<font color=#447700>!  Comment: if land-surface uses skin temperature, emissivity must match that    <a name='4165'></font>
<font color=#447700>!   used in its calculation (e.g. 1.0)                                           <a name='4166'></font>
      DO 5500 N=1,NBANDS                                                         <a name='4167'>
         SEMISS(N) = EMISS<a name='4168'>
 5500 CONTINUE                                                                   <a name='4169'>
                                                                                 <a name='4170'>
<font color=#447700>!  Transfer cloud fraction to RRTM array; compute cloud optical depth, TAUCLOUD, <a name='4171'></font>
<font color=#447700>!  as the product of clwp and cloud mass absorption coefficient in MM5, which is <a name='4172'></font>
<font color=#447700>!  a  combination of liquid and ice absorption coefficients.                     <a name='4173'></font>
<font color=#447700>!  Note: RRTM levels count from bottom to top, while CCM levels count from the   <a name='4174'></font>
<font color=#447700>!  top down and must be reversed here.  Values for the extra RRTM levels (above   <a name='4175'></font>
<font color=#447700>!  the model top) are set to zero.                                               <a name='4176'></font>
                                                                                 <a name='4177'>
<font color=#447700>!      DO 7000 L = 1, NLAYERS-1                                                   <a name='4178'></font>
      DO 7000 L = 1, kte   <a name='4179'>
         TAUCLOUD(L) = ABCW*CLWP(kte+1-L)+ABICE*CIWP(kte+1-L) &amp; <a name='4180'>
                      +ABRN*PLWP(kte+1-L)+ABSN*PIWP(kte+1-L)                       <a name='4181'>
         IF(TAUCLOUD(L).GT.0.01)CLDFRC(kte+1-L)=1.                                <a name='4182'>
         CLDFRAC(L) = cldfrc(kte+1-L)                                             <a name='4183'>
 7000 CONTINUE                                                                   <a name='4184'>
<font color=#447700>!      CLDFRAC(NLAYERS) = 0.0                                                     <a name='4185'></font>
<font color=#447700>!      TAUCLOUD(NLAYERS) = 0.0                                                    <a name='4186'></font>
      DO 7500 L = kte+1,NLAYERS,1<a name='4187'>
         CLDFRAC(L) = 0.0   <a name='4188'>
         TAUCLOUD(L) = 0.0  <a name='4189'>
 7500 CONTINUE<a name='4190'>
        <a name='4191'>
   END SUBROUTINE MM5ATM<a name='4192'>
<a name='4193'>
<font color=#447700>!---------------------------------------------------------------------------<a name='4194'></font>
<A NAME='SETCOEF'><A href='../../html_code/phys/module_ra_rrtm.F.html#SETCOEF' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4195'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>SETCOEF</font>(kts,ktep1,                                        &amp; <A href='../../call_to/SETCOEF.html' TARGET='index'>2</A><a name='4196'>
                         PAVEL,TAVEL,COLDRY,COLH2O,COLCO2,COLO3,           &amp;<a name='4197'>
                         COLN2O,COLCH4,COLO2,CO2MULT,                      &amp;<a name='4198'>
                         FAC00,FAC01,FAC10,FAC11,                          &amp;<a name='4199'>
                         FORFAC,SELFFAC,SELFFRAC,                          &amp;<a name='4200'>
                         JP,JT,JT1,INDSELF,WKL,LAYTROP,LAYSWTCH,LAYLOW     )<a name='4201'>
<font color=#447700>!---------------------------------------------------------------------------<a name='4202'></font>
      IMPLICIT NONE<a name='4203'>
<font color=#447700>!---------------------------------------------------------------------------<a name='4204'></font>
<font color=#447700>!  RRTM Longwave Radiative Transfer Model                                        <a name='4205'></font>
<font color=#447700>!  Atmospheric and Environmental Research, Inc., Cambridge, MA                   <a name='4206'></font>
<font color=#447700>!                                                                                <a name='4207'></font>
<font color=#447700>!  Original version:       E. J. Mlawer, et al.                                  <a name='4208'></font>
<font color=#447700>!  Revision for NCAR CCM:  Michael J. Iacono; September, 1998                    <a name='4209'></font>
<font color=#447700>!                                                                                <a name='4210'></font>
<font color=#447700>!  For a given atmosphere, calculate the indices and fractions related to the    <a name='4211'></font>
<font color=#447700>!  pressure and temperature interpolations.  Also calculate the values of the    <a name='4212'></font>
<font color=#447700>!  integrated Planck functions for each band at the level and layer              <a name='4213'></font>
<font color=#447700>!  temperatures.                                                                 <a name='4214'></font>
<font color=#447700>!---------------------------------------------------------------------------<a name='4215'></font>
<a name='4216'>
      INTEGER, INTENT(IN   ) ::          kts, ktep1<a name='4217'>
<a name='4218'>
      REAL, DIMENSION( 35,kts:ktep1),                    &amp;<a name='4219'>
            INTENT(IN   )        ::                  WKL<a name='4220'>
<a name='4221'>
      INTEGER, INTENT(INOUT) ::  LAYTROP,LAYSWTCH,LAYLOW<a name='4222'>
<a name='4223'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::      &amp;<a name='4224'>
                                                   PAVEL, &amp;<a name='4225'>
                                                   TAVEL, &amp;<a name='4226'>
                                                  COLDRY<a name='4227'>
<a name='4228'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(INOUT) ::      &amp;<a name='4229'>
                                                  COLH2O, &amp;<a name='4230'>
                                                  COLCO2, &amp;<a name='4231'>
                                                   COLO3, &amp;<a name='4232'>
                                                  COLN2O, &amp;<a name='4233'>
                                                  COLCH4, &amp;<a name='4234'>
                                                   COLO2, &amp;<a name='4235'>
                                                 CO2MULT, &amp;<a name='4236'>
                                                   FAC00, &amp;<a name='4237'>
                                                   FAC01, &amp;<a name='4238'>
                                                   FAC10, &amp;<a name='4239'>
                                                   FAC11, &amp;<a name='4240'>
                                                  FORFAC, &amp;<a name='4241'>
                                                 SELFFAC, &amp;<a name='4242'>
                                                SELFFRAC<a name='4243'>
<a name='4244'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(INOUT) ::   &amp;<a name='4245'>
                                                      JP, &amp;<a name='4246'>
                                                      JT, &amp;<a name='4247'>
                                                     JT1, &amp;<a name='4248'>
                                                 INDSELF<a name='4249'>
<font color=#447700>! LOCAL <a name='4250'></font>
     <a name='4251'>
      INTEGER ::   LAY, JP1 <a name='4252'>
      REAL    ::   STPFAC, PLOG, FP, FT, FT1, WATERS, WATER, &amp;<a name='4253'>
                   CALEFAC, FACTOR, CO2REG, COMPFP, SCALEFAC <a name='4254'>
<a name='4255'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='4256'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='4257'></font>
<font color=#447700>! carry constants.                                                               <a name='4258'></font>
                                                                                 <a name='4259'>
      STPFAC = 296./1013.                                                        <a name='4260'>
      <a name='4261'>
      LAYTROP = 0                                                                <a name='4262'>
      LAYSWTCH = 0                                                               <a name='4263'>
      LAYLOW = 0                                                                 <a name='4264'>
      DO 7000 LAY = 1, NLAYERS                                                   <a name='4265'>
<font color=#447700>!        Find the two reference pressures on either side of the                  <a name='4266'></font>
<font color=#447700>!        layer pressure.  Store them in JP and JP1.  Store in FP the             <a name='4267'></font>
<font color=#447700>!        fraction of the difference (in ln(pressure)) between these              <a name='4268'></font>
<font color=#447700>!        two values that the layer pressure lies.                                <a name='4269'></font>
         PLOG = LOG(PAVEL(LAY))                                                  <a name='4270'>
         JP(LAY) = INT(36. - 5*(PLOG+0.04))                                      <a name='4271'>
         IF (JP(LAY) .LT. 1) THEN                                                <a name='4272'>
            JP(LAY) = 1                                                          <a name='4273'>
         ELSEIF (JP(LAY) .GT. 58) THEN                                           <a name='4274'>
            JP(LAY) = 58                                                         <a name='4275'>
         ENDIF                                                                   <a name='4276'>
         JP1 = JP(LAY) + 1                                                       <a name='4277'>
         FP = 5. * (PREFLOG(JP(LAY)) - PLOG)                                     <a name='4278'>
                                                                                 <a name='4279'>
<font color=#447700>!        Determine, for each reference pressure (JP and JP1), which              <a name='4280'></font>
<font color=#447700>!        reference temperature (these are different for each                     <a name='4281'></font>
<font color=#447700>!        reference pressure) is nearest the layer temperature but does           <a name='4282'></font>
<font color=#447700>!        not exceed it.  Store these indices in JT and JT1, resp.                <a name='4283'></font>
<font color=#447700>!        Store in FT (resp. FT1) the fraction of the way between JT              <a name='4284'></font>
<font color=#447700>!        (JT1) and the next highest reference temperature that the               <a name='4285'></font>
<font color=#447700>!        layer temperature falls.                                                <a name='4286'></font>
         JT(LAY) = INT(3. + (TAVEL(LAY)-TREF(JP(LAY)))/15.)                      <a name='4287'>
         IF (JT(LAY) .LT. 1) THEN                                                <a name='4288'>
            JT(LAY) = 1                                                          <a name='4289'>
         ELSEIF (JT(LAY) .GT. 4) THEN                                            <a name='4290'>
            JT(LAY) = 4                                                          <a name='4291'>
         ENDIF                                                                   <a name='4292'>
         FT = ((TAVEL(LAY)-TREF(JP(LAY)))/15.) - FLOAT(JT(LAY)-3)                <a name='4293'>
         JT1(LAY) = INT(3. + (TAVEL(LAY)-TREF(JP1))/15.)                         <a name='4294'>
         IF (JT1(LAY) .LT. 1) THEN                                               <a name='4295'>
            JT1(LAY) = 1                                                         <a name='4296'>
         ELSEIF (JT1(LAY) .GT. 4) THEN                                           <a name='4297'>
            JT1(LAY) = 4                                                         <a name='4298'>
         ENDIF                                                                   <a name='4299'>
         FT1 = ((TAVEL(LAY)-TREF(JP1))/15.) - FLOAT(JT1(LAY)-3)                  <a name='4300'>
                                                                                 <a name='4301'>
         WATER = WKL(1,LAY)/COLDRY(LAY)                                          <a name='4302'>
         SCALEFAC = PAVEL(LAY) * STPFAC / TAVEL(LAY)                             <a name='4303'>
                                                                                 <a name='4304'>
<font color=#447700>!        If the pressure is less than ~100mb, perform a different                <a name='4305'></font>
<font color=#447700>!        set of species interpolations.                                          <a name='4306'></font>
         IF (PLOG .LE. 4.56) GO TO 5300                                          <a name='4307'>
         LAYTROP =  LAYTROP + 1                                                  <a name='4308'>
<font color=#447700>!        For one band, the "switch" occurs at ~300 mb.                           <a name='4309'></font>
<font color=#447700>! JD: changed from (PLOG .GE. 5.76) to avoid out-of-range                        <a name='4310'></font>
         IF (PLOG .Gt. 5.76) LAYSWTCH = LAYSWTCH + 1                             <a name='4311'>
         IF (PLOG .GE. 6.62) LAYLOW = LAYLOW + 1                                 <a name='4312'>
<font color=#447700>!                                                                                <a name='4313'></font>
         FORFAC(LAY) = SCALEFAC / (1.+WATER)                                     <a name='4314'>
<font color=#447700>!        Set up factors needed to separately include the water vapor             <a name='4315'></font>
<font color=#447700>!        self-continuum in the calculation of absorption coefficient.            <a name='4316'></font>
         SELFFAC(LAY) = WATER * FORFAC(LAY)                                      <a name='4317'>
         FACTOR = (TAVEL(LAY)-188.0)/7.2                                         <a name='4318'>
         INDSELF(LAY) = MIN(9, MAX(1, INT(FACTOR)-7))                            <a name='4319'>
         SELFFRAC(LAY) = FACTOR - FLOAT(INDSELF(LAY) + 7)                        <a name='4320'>
                                                                                 <a name='4321'>
<font color=#447700>!        Calculate needed column amounts.                                        <a name='4322'></font>
         COLH2O(LAY) = 1.E-20 * WKL(1,LAY)                                       <a name='4323'>
         COLCO2(LAY) = 1.E-20 * WKL(2,LAY)                                       <a name='4324'>
         COLO3(LAY) = 1.E-20 * WKL(3,LAY)                                        <a name='4325'>
         COLN2O(LAY) = 1.E-20 * WKL(4,LAY)                                       <a name='4326'>
         COLCH4(LAY) = 1.E-20 * WKL(6,LAY)                                       <a name='4327'>
         COLO2(LAY) = 1.E-20 * WKL(7,LAY)                                        <a name='4328'>
         IF (COLCO2(LAY) .EQ. 0.) COLCO2(LAY) = 1.E-32 * COLDRY(LAY)             <a name='4329'>
         IF (COLN2O(LAY) .EQ. 0.) COLN2O(LAY) = 1.E-32 * COLDRY(LAY)             <a name='4330'>
         IF (COLCH4(LAY) .EQ. 0.) COLCH4(LAY) = 1.E-32 * COLDRY(LAY)             <a name='4331'>
<font color=#447700>!        Using E = 1334.2 cm-1.                                                  <a name='4332'></font>
         CO2REG = 3.55E-24 * COLDRY(LAY)                                         <a name='4333'>
         CO2MULT(LAY)= (COLCO2(LAY) - CO2REG) *    &amp; <a name='4334'>
              272.63*EXP(-1919.4/TAVEL(LAY))/(8.7604E-4*TAVEL(LAY))              <a name='4335'>
         GO TO 5400                                                              <a name='4336'>
                                                                                 <a name='4337'>
<font color=#447700>!        Above LAYTROP.                                                          <a name='4338'></font>
 5300    CONTINUE                                                                <a name='4339'>
                                                                                 <a name='4340'>
         FORFAC(LAY) = SCALEFAC / (1.+WATER)                                     <a name='4341'>
<font color=#447700>!        Calculate needed column amounts.                                        <a name='4342'></font>
         COLH2O(LAY) = 1.E-20 * WKL(1,LAY)                                       <a name='4343'>
         COLCO2(LAY) = 1.E-20 * WKL(2,LAY)                                       <a name='4344'>
         COLO3(LAY) = 1.E-20 * WKL(3,LAY)                                        <a name='4345'>
         COLN2O(LAY) = 1.E-20 * WKL(4,LAY)                                       <a name='4346'>
         COLCH4(LAY) = 1.E-20 * WKL(6,LAY)                                       <a name='4347'>
         COLO2(LAY) = 1.E-20 * WKL(7,LAY)                                        <a name='4348'>
         IF (COLCO2(LAY) .EQ. 0.) COLCO2(LAY) = 1.E-32 * COLDRY(LAY)             <a name='4349'>
         IF (COLN2O(LAY) .EQ. 0.) COLN2O(LAY) = 1.E-32 * COLDRY(LAY)             <a name='4350'>
         IF (COLCH4(LAY) .EQ. 0.) COLCH4(LAY) = 1.E-32 * COLDRY(LAY)             <a name='4351'>
         CO2REG = 3.55E-24 * COLDRY(LAY)                                         <a name='4352'>
         CO2MULT(LAY)= (COLCO2(LAY) - CO2REG) *   &amp; <a name='4353'>
              272.63*EXP(-1919.4/TAVEL(LAY))/(8.7604E-4*TAVEL(LAY))              <a name='4354'>
 5400    CONTINUE                                                                <a name='4355'>
                                                                                 <a name='4356'>
<font color=#447700>!        We have now isolated the layer ln pressure and temperature,             <a name='4357'></font>
<font color=#447700>!        between two reference pressures and two reference temperatures          <a name='4358'></font>
<font color=#447700>!        (for each reference pressure).  We multiply the pressure                <a name='4359'></font>
<font color=#447700>!        fraction FP with the appropriate temperature fractions to get           <a name='4360'></font>
<font color=#447700>!        the factors that will be needed for the interpolation that yields       <a name='4361'></font>
<font color=#447700>!        the optical depths (performed in routines TAUGBn for band n).           <a name='4362'></font>
                                                                                 <a name='4363'>
         COMPFP = 1. - FP                                                        <a name='4364'>
         FAC10(LAY) = COMPFP * FT                                                <a name='4365'>
         FAC00(LAY) = COMPFP * (1. - FT)                                         <a name='4366'>
         FAC11(LAY) = FP * FT1                                                   <a name='4367'>
         FAC01(LAY) = FP * (1. - FT1)                                            <a name='4368'>
                                                                                 <a name='4369'>
 7000 CONTINUE                                                                   <a name='4370'>
                                                                                 <a name='4371'>
<font color=#447700>!        Set LAYLOW for profiles with surface pressure less than 750mb.          <a name='4372'></font>
         IF (LAYLOW.EQ.0) LAYLOW=1                                               <a name='4373'>
<font color=#447700>!        Sometimes round-off gives wrong LAYSWTCH therefore check here (JD)<a name='4374'></font>
         IF (JP(LAYSWTCH+1).LE.6) THEN<a name='4375'>
           LAYSWTCH=LAYSWTCH+1<a name='4376'>
         ENDIF<a name='4377'>
<a name='4378'>
   END SUBROUTINE SETCOEF<a name='4379'>
<a name='4380'>
<font color=#447700>!-------------------------------------------------------------------------------<a name='4381'></font>
<font color=#447700>!*                                                                             * <a name='4382'></font>
<font color=#447700>!*                  Optical depths developed for the                           * <a name='4383'></font>
<font color=#447700>!*                                                                             * <a name='4384'></font>
<font color=#447700>!*                RAPID RADIATIVE TRANSFER MODEL (RRTM)                        * <a name='4385'></font>
<font color=#447700>!*                                                                             * <a name='4386'></font>
<font color=#447700>!*                                                                             * <a name='4387'></font>
<font color=#447700>!*            ATMOSPHERIC AND ENVIRONMENTAL RESEARCH, INC.                     * <a name='4388'></font>
<font color=#447700>!*                        840 MEMORIAL DRIVE                                   * <a name='4389'></font>
<font color=#447700>!*                        CAMBRIDGE, MA 02139                                  * <a name='4390'></font>
<font color=#447700>!*                                                                             * <a name='4391'></font>
<font color=#447700>!*                                                                             * <a name='4392'></font>
<font color=#447700>!*                           ELI J. MLAWER                                     * <a name='4393'></font>
<font color=#447700>!*                         STEVEN J. TAUBMAN                                   * <a name='4394'></font>
<font color=#447700>!*                         SHEPARD A. CLOUGH                                   * <a name='4395'></font>
<font color=#447700>!*                                                                             * <a name='4396'></font>
<font color=#447700>!*                                                                             * <a name='4397'></font>
<font color=#447700>!*                                                                             * <a name='4398'></font>
<font color=#447700>!*                                                                             * <a name='4399'></font>
<font color=#447700>!*                       email:  mlawer@aer.com                                * <a name='4400'></font>
<font color=#447700>!*                                                                             * <a name='4401'></font>
<font color=#447700>!*        The authors wish to acknowledge the contributions of the             * <a name='4402'></font>
<font color=#447700>!*        following people:  Patrick D. Brown, Michael J. Iacono,              * <a name='4403'></font>
<font color=#447700>!*        Ronald E. Farren, Luke Chen, Robert Bergstrom.                       * <a name='4404'></font>
<font color=#447700>!*                                                                             * <a name='4405'></font>
<font color=#447700>!-------------------------------------------------------------------------------<a name='4406'></font>
<font color=#447700>!*                                                                             * <a name='4407'></font>
<font color=#447700>!*  Revision for NCAR CCM:  Michael J. Iacono; September, 1998                 * <a name='4408'></font>
<font color=#447700>!*                                                                             * <a name='4409'></font>
<font color=#447700>!*     TAUMOL                                                                  * <a name='4410'></font>
<font color=#447700>!*                                                                             * <a name='4411'></font>
<font color=#447700>!*     This file contains the subroutines TAUGBn (where n goes from            * <a name='4412'></font>
<font color=#447700>!*     1 to 16).  TAUGBn calculates the optical depths and Planck fractions    * <a name='4413'></font>
<font color=#447700>!*     per g-value and layer for band n.                                       * <a name='4414'></font>
<font color=#447700>!*                                                                             * <a name='4415'></font>
<font color=#447700>!*  Output:  optical depths (unitless)                                         * <a name='4416'></font>
<font color=#447700>!*           fractions needed to compute Planck functions at every layer       * <a name='4417'></font>
<font color=#447700>!*               and g-value                                                   * <a name='4418'></font>
<font color=#447700>!*                                                                             * <a name='4419'></font>
<font color=#447700>!*     COMMON /TAUGCOM/  TAUG(MXLAY,MG)                                        * <a name='4420'></font>
<font color=#447700>!*     COMMON /PLANKG/   FRACS(MXLAY,MG)                                       * <a name='4421'></font>
<font color=#447700>!*                                                                             * <a name='4422'></font>
<font color=#447700>!*  Input                                                                      * <a name='4423'></font>
<font color=#447700>!*                                                                             * <a name='4424'></font>
<font color=#447700>!*     COMMON /FEATURES/ NG(NBANDS),NSPA(NBANDS),NSPB(NBANDS)                  * <a name='4425'></font>
<font color=#447700>!*     COMMON /PRECISE/  ONEMINUS                                              * <a name='4426'></font>
<font color=#447700>!*     COMMON /PROFILE/  NLAYERS,PAVEL(MXLAY),TAVEL(MXLAY),                    * <a name='4427'></font>
<font color=#447700>!*    &amp;                  PZ(0:MXLAY),TZ(0:MXLAY)                               * <a name='4428'></font>
<font color=#447700>!*     COMMON /PROFDATA/ LAYTROP,LAYSWTCH,LAYLOW,                              * <a name='4429'></font>
<font color=#447700>!*    &amp;                  COLH2O(MXLAY),COLCO2(MXLAY),                          * <a name='4430'></font>
<font color=#447700>!*    &amp;                  COLO3(MXLAY),COLN2O(MXLAY),COLCH4(MXLAY),             * <a name='4431'></font>
<font color=#447700>!*    &amp;                  COLO2(MXLAY),CO2MULT(MXLAY)                           * <a name='4432'></font>
<font color=#447700>!*     COMMON /INTFAC/   FAC00(MXLAY),FAC01(MXLAY),                            * <a name='4433'></font>
<font color=#447700>!*    &amp;                  FAC10(MXLAY),FAC11(MXLAY)                             * <a name='4434'></font>
<font color=#447700>!*     COMMON /INTIND/   JP(MXLAY),JT(MXLAY),JT1(MXLAY)                        * <a name='4435'></font>
<font color=#447700>!*     COMMON /SELF/     SELFFAC(MXLAY), SELFFRAC(MXLAY), INDSELF(MXLAY)       * <a name='4436'></font>
<font color=#447700>!*                                                                             * <a name='4437'></font>
<font color=#447700>!*     Description:                                                            * <a name='4438'></font>
<font color=#447700>!*     NG(IBAND) - number of g-values in band IBAND                            * <a name='4439'></font>
<font color=#447700>!*     NSPA(IBAND) - for the lower atmosphere, the number of reference         * <a name='4440'></font>
<font color=#447700>!*                   atmospheres that are stored for band IBAND per            * <a name='4441'></font>
<font color=#447700>!*                   pressure level and temperature.  Each of these            * <a name='4442'></font>
<font color=#447700>!*                   atmospheres has different relative amounts of the         * <a name='4443'></font>
<font color=#447700>!*                   key species for the band (i.e. different binary           * <a name='4444'></font>
<font color=#447700>!*                   species parameters).                                      * <a name='4445'></font>
<font color=#447700>!*     NSPB(IBAND) - same for upper atmosphere                                 * <a name='4446'></font>
<font color=#447700>!*     ONEMINUS - since problems are caused in some cases by interpolation     * <a name='4447'></font>
<font color=#447700>!*                parameters equal to or greater than 1, for these cases       * <a name='4448'></font>
<font color=#447700>!*                these parameters are set to this value, slightly &lt; 1.        * <a name='4449'></font>
<font color=#447700>!*     PAVEL - layer pressures (mb)                                            * <a name='4450'></font>
<font color=#447700>!*     TAVEL - layer temperatures (degrees K)                                  * <a name='4451'></font>
<font color=#447700>!*     PZ - level pressures (mb)                                               * <a name='4452'></font>
<font color=#447700>!*     TZ - level temperatures (degrees K)                                     * <a name='4453'></font>
<font color=#447700>!*     LAYTROP - layer at which switch is made from one combination of         * <a name='4454'></font>
<font color=#447700>!*               key species to another                                        * <a name='4455'></font>
<font color=#447700>!*     COLH2O, COLCO2, COLO3, COLN2O, COLCH4 - column amounts of water         * <a name='4456'></font>
<font color=#447700>!*               vapor,carbon dioxide, ozone, nitrous ozide, methane,          * <a name='4457'></font>
<font color=#447700>!*               respectively (molecules/cm**2)                                * <a name='4458'></font>
<font color=#447700>!*     CO2MULT - for bands in which carbon dioxide is implemented as a         * <a name='4459'></font>
<font color=#447700>!*               trace species, this is the factor used to multiply the        * <a name='4460'></font>
<font color=#447700>!*               band's average CO2 absorption coefficient to get the added    * <a name='4461'></font>
<font color=#447700>!*               contribution to the optical depth relative to 355 ppm.        * <a name='4462'></font>
<font color=#447700>!*     FACij(LAY) - for layer LAY, these are factors that are needed to        * <a name='4463'></font>
<font color=#447700>!*                  compute the interpolation factors that multiply the        * <a name='4464'></font>
<font color=#447700>!*                  appropriate reference k-values.  A value of 0 (1) for      * <a name='4465'></font>
<font color=#447700>!*                  i,j indicates that the corresponding factor multiplies     * <a name='4466'></font>
<font color=#447700>!*                  reference k-value for the lower (higher) of the two        * <a name='4467'></font>
<font color=#447700>!*                  appropriate temperatures, and altitudes, respectively.     * <a name='4468'></font>
<font color=#447700>!*     JP - the index of the lower (in altitude) of the two appropriate        * <a name='4469'></font>
<font color=#447700>!*          reference pressure levels needed for interpolation                 * <a name='4470'></font>
<font color=#447700>!*     JT, JT1 - the indices of the lower of the two appropriate reference     * <a name='4471'></font>
<font color=#447700>!*               temperatures needed for interpolation (for pressure           * <a name='4472'></font>
<font color=#447700>!*               levels JP and JP+1, respectively)                             * <a name='4473'></font>
<font color=#447700>!*     SELFFAC - scale factor needed to water vapor self-continuum, equals     * <a name='4474'></font>
<font color=#447700>!*               (water vapor density)/(atmospheric density at 296K and        * <a name='4475'></font>
<font color=#447700>!*               1013 mb)                                                      * <a name='4476'></font>
<font color=#447700>!*     SELFFRAC - factor needed for temperature interpolation of reference     * <a name='4477'></font>
<font color=#447700>!*                water vapor self-continuum data                              * <a name='4478'></font>
<font color=#447700>!*     INDSELF - index of the lower of the two appropriate reference           * <a name='4479'></font>
<font color=#447700>!*               temperatures needed for the self-continuum interpolation      * <a name='4480'></font>
<font color=#447700>!*                                                                             * <a name='4481'></font>
<font color=#447700>!*  Data input                                                                 * <a name='4482'></font>
<font color=#447700>!*     COMMON /Kn/ KA(NSPA(n),5,13,MG), KB(NSPB(n),5,13:59,MG), SELFREF(10,MG) * <a name='4483'></font>
<font color=#447700>!*        (note:  n is the band number)                                        * <a name='4484'></font>
<font color=#447700>!*                                                                             * <a name='4485'></font>
<font color=#447700>!*     Description:                                                            * <a name='4486'></font>
<font color=#447700>!*     KA - k-values for low reference atmospheres (no water vapor             * <a name='4487'></font>
<font color=#447700>!*          self-continuum) (units: cm**2/molecule)                            * <a name='4488'></font>
<font color=#447700>!*     KB - k-values for high reference atmospheres (all sources)              * <a name='4489'></font>
<font color=#447700>!*          (units: cm**2/molecule)                                            * <a name='4490'></font>
<font color=#447700>!*     SELFREF - k-values for water vapor self-continuum for reference         * <a name='4491'></font>
<font color=#447700>!*               atmospheres (used below LAYTROP)                              * <a name='4492'></font>
<font color=#447700>!*               (units: cm**2/molecule)                                       * <a name='4493'></font>
<font color=#447700>!*                                                                             * <a name='4494'></font>
<font color=#447700>!*     DIMENSION ABSA(65*NSPA(n),MG), ABSB(235*NSPB(n),MG)                     * <a name='4495'></font>
<font color=#447700>!*     EQUIVALENCE (KA,ABSA),(KB,ABSB)                                         * <a name='4496'></font>
<font color=#447700>!*                                                                             * <a name='4497'></font>
<font color=#447700>!******************************************************************************* <a name='4498'></font>
                                                                                 <a name='4499'>
<font color=#447700>!---------------------------------------------------------------------------    <a name='4500'></font>
<A NAME='TAUGB1'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB1' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4501'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB1</font>(kts,ktep1,COLH2O,FAC00,FAC01,FAC10,FAC11,          &amp; <A href='../../call_to/TAUGB1.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB1.html' TARGET='index'>2</A><a name='4502'>
                        FORFAC,SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,         &amp;<a name='4503'>
                        PFRAC,TAUG,LAYTROP                                 )<a name='4504'>
<font color=#447700>!---------------------------------------------------------------------------    <a name='4505'></font>
                                                                                 <a name='4506'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='4507'>
<a name='4508'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='4509'>
<a name='4510'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='4511'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='4512'>
                                                      TAUG<a name='4513'>
<a name='4514'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='4515'>
                                                    COLH2O, &amp;<a name='4516'>
                                                     FAC00, &amp;<a name='4517'>
                                                     FAC01, &amp;<a name='4518'>
                                                     FAC10, &amp;<a name='4519'>
                                                     FAC11, &amp;<a name='4520'>
                                                    FORFAC, &amp;<a name='4521'>
                                                   SELFFAC, &amp;<a name='4522'>
                                                  SELFFRAC <a name='4523'>
 <a name='4524'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='4525'>
                                                        JP, &amp;<a name='4526'>
                                                        JT, &amp;<a name='4527'>
                                                       JT1, &amp;<a name='4528'>
                                                   INDSELF<a name='4529'>
<a name='4530'>
<font color=#447700>!     Written by Eli J. Mlawer, Atmospheric &amp; Environmental Research.            <a name='4531'></font>
<font color=#447700>!     Revised by Michael J. Iacono, Atmospheric &amp; Environmental Research.        <a name='4532'></font>
                                                                                 <a name='4533'>
<font color=#447700>!     BAND 1:  10-250 cm-1 (low - H2O; high - H2O)                               <a name='4534'></font>
                                                                                 <a name='4535'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='4536'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='4537'></font>
<font color=#447700>! carry constants.                                                               <a name='4538'></font>
                                                                                 <a name='4539'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure) and             <a name='4540'></font>
<font color=#447700>!     temperature.  Below LAYTROP, the water vapor self-continuum                <a name='4541'></font>
<font color=#447700>!     is interpolated (in temperature) separately.                               <a name='4542'></font>
<font color=#447700>!cdir novector<a name='4543'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='4544'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(1) + 1                          <a name='4545'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(1) + 1                             <a name='4546'>
         INDS = INDSELF(LAY)                                                     <a name='4547'>
         DO 2000 IG = 1, NG1                                                     <a name='4548'>
            TAUG(IG,LAY) = COLH2O(LAY) *                       &amp; <a name='4549'>
                (FAC00(LAY) * ABSA1(IND0,IG) +                  &amp;                 <a name='4550'>
                 FAC10(LAY) * ABSA1(IND0+1,IG) +                &amp;                 <a name='4551'>
                 FAC01(LAY) * ABSA1(IND1,IG) +                  &amp;                 <a name='4552'>
                 FAC11(LAY) * ABSA1(IND1+1,IG) +                &amp;                 <a name='4553'>
                 SELFFAC(LAY) * (SELFREFC1(INDS,IG) +            &amp;                 <a name='4554'>
                 SELFFRAC(LAY) *                               &amp;                 <a name='4555'>
                 (SELFREFC1(INDS+1,IG) - SELFREFC1(INDS,IG))) +    &amp;                 <a name='4556'>
                 FORFAC(LAY) * FORREFC1(IG))                                       <a name='4557'>
            PFRAC(IG,LAY) = FRACREFAC1(IG)                                         <a name='4558'>
 2000    CONTINUE                                                                <a name='4559'>
 2500 CONTINUE                                                                   <a name='4560'>
                                                                                 <a name='4561'>
<font color=#447700>!cdir novector<a name='4562'></font>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='4563'>
         IND0 = ((JP(LAY)-13)*5+(JT(LAY)-1))*NSPB(1) + 1                         <a name='4564'>
         IND1 = ((JP(LAY)-12)*5+(JT1(LAY)-1))*NSPB(1) + 1                        <a name='4565'>
         DO 3000 IG = 1, NG1                                                     <a name='4566'>
            TAUG(IG,LAY) = COLH2O(LAY) *                      &amp;<a name='4567'>
                (FAC00(LAY) * ABSB1(IND0,IG) +                 &amp;                  <a name='4568'>
                 FAC10(LAY) * ABSB1(IND0+1,IG) +               &amp;                  <a name='4569'>
                 FAC01(LAY) * ABSB1(IND1,IG) +                 &amp;                  <a name='4570'>
                 FAC11(LAY) * ABSB1(IND1+1,IG) +               &amp;                  <a name='4571'>
                 FORFAC(LAY) * FORREFC1(IG))                                       <a name='4572'>
            PFRAC(IG,LAY) = FRACREFBC1(IG)                                         <a name='4573'>
 3000    CONTINUE                                                                <a name='4574'>
 3500 CONTINUE                                                                   <a name='4575'>
     <a name='4576'>
      END SUBROUTINE TAUGB1                        <a name='4577'>
                                                                                 <a name='4578'>
<font color=#447700>!----------------------------------------------------------------------------    <a name='4579'></font>
<A NAME='TAUGB2'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB2' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4580'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB2</font>(kts,ktep1,COLDRY,COLH2O,FAC00,FAC01,FAC10,FAC11,    &amp; <A href='../../call_to/TAUGB2.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB2.html' TARGET='index'>2</A><a name='4581'>
                        FORFAC,SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,          &amp;<a name='4582'>
                        PFRAC,TAUG,LAYTROP                                  )<a name='4583'>
<font color=#447700>!----------------------------------------------------------------------------    <a name='4584'></font>
                                                                                 <a name='4585'>
<font color=#447700>!     BAND 2:  250-500 cm-1 (low - H2O; high - H2O)                              <a name='4586'></font>
                                                                                 <a name='4587'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='4588'>
<a name='4589'>
      INTEGER, PARAMETER :: NGS1=8                                       <a name='4590'>
<a name='4591'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='4592'>
<a name='4593'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='4594'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='4595'>
                                                      TAUG<a name='4596'>
<a name='4597'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='4598'>
                                                    COLDRY, &amp;   <a name='4599'>
                                                    COLH2O, &amp;<a name='4600'>
                                                     FAC00, &amp;<a name='4601'>
                                                     FAC01, &amp;<a name='4602'>
                                                     FAC10, &amp;<a name='4603'>
                                                     FAC11, &amp;<a name='4604'>
                                                    FORFAC, &amp;<a name='4605'>
                                                   SELFFAC, &amp;<a name='4606'>
                                                  SELFFRAC <a name='4607'>
 <a name='4608'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='4609'>
                                                        JP, &amp;<a name='4610'>
                                                        JT, &amp;<a name='4611'>
                                                       JT1, &amp;<a name='4612'>
                                                   INDSELF<a name='4613'>
<a name='4614'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='4615'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='4616'></font>
<font color=#447700>! carry constants.                                                               <a name='4617'></font>
                                                                                 <a name='4618'>
      DIMENSION FC00(kts:ktep1),FC01(kts:ktep1),FC10(kts:ktep1),FC11(kts:ktep1)                  <a name='4619'>
      DIMENSION REFPARAM(13)                                                     <a name='4620'>
                                                                                 <a name='4621'>
<font color=#447700>!     These are the mixing ratios for H2O for a MLS atmosphere at the            <a name='4622'></font>
<font color=#447700>!     13 RRTM reference pressure levels:  1.8759999E-02, 1.2223309E-02,          <a name='4623'></font>
<font color=#447700>!     5.8908667E-03, 2.7675382E-03, 1.4065107E-03, 7.5969833E-04,                <a name='4624'></font>
<font color=#447700>!     3.8875898E-04, 1.6542293E-04, 3.7189537E-05, 7.4764857E-06,                <a name='4625'></font>
<font color=#447700>!     4.3081886E-06, 3.3319423E-06, 3.2039343E-06/                               <a name='4626'></font>
                                                                                 <a name='4627'>
<font color=#447700>!     The following are parameters related to the reference water vapor          <a name='4628'></font>
<font color=#447700>!     mixing ratios by REFPARAM(I) = REFH2O(I) / (.002+REFH2O(I)).               <a name='4629'></font>
<font color=#447700>!     These parameters are used for the Planck function interpolation.           <a name='4630'></font>
      DATA REFPARAM/  &amp;                                                          <a name='4631'>
        0.903661, 0.859386, 0.746542, 0.580496, 0.412889, 0.275283, &amp; <a name='4632'>
        0.162745, 7.63929E-02, 1.82553E-02, 3.72432E-03,            &amp;            <a name='4633'>
        2.14946E-03, 1.66320E-03, 1.59940E-03/                                   <a name='4634'>
                                                                                 <a name='4635'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure) and             <a name='4636'></font>
<font color=#447700>!     temperature.  Below LAYTROP, the water vapor self-continuum is             <a name='4637'></font>
<font color=#447700>!     interpolated (in temperature) separately.                                  <a name='4638'></font>
<font color=#447700>!cdir novector<a name='4639'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='4640'>
         WATER = 1.E20 * COLH2O(LAY) / COLDRY(LAY)                               <a name='4641'>
         H2OPARAM = WATER/(WATER +.002)                                          <a name='4642'>
         DO 1800 IFRAC = 2, 12                                                   <a name='4643'>
            IF (H2OPARAM .GE. REFPARAM(IFRAC)) GO TO 1900                        <a name='4644'>
 1800    CONTINUE                                                                <a name='4645'>
 1900    CONTINUE                                                                <a name='4646'>
         FRACINT = (H2OPARAM-REFPARAM(IFRAC))/    &amp; <a name='4647'>
              (REFPARAM(IFRAC-1)-REFPARAM(IFRAC))                                <a name='4648'>
                                                                                 <a name='4649'>
         FP = FAC11(LAY) + FAC01(LAY)                                            <a name='4650'>
         IFP = 2.E2*FP+0.5                                                       <a name='4651'>
         IF (IFP.LE.0) IFP = 0                                                   <a name='4652'>
         FC00(LAY) = FAC00(LAY) * CORR2(IFP)                                     <a name='4653'>
         FC10(LAY) = FAC10(LAY) * CORR2(IFP)                                     <a name='4654'>
         FC01(LAY) = FAC01(LAY) * CORR1(IFP)                                     <a name='4655'>
         FC11(LAY) = FAC11(LAY) * CORR1(IFP)                                     <a name='4656'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(2) + 1                          <a name='4657'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(2) + 1                             <a name='4658'>
         INDS = INDSELF(LAY)                                                     <a name='4659'>
         DO 2000 IG = 1, NG2                                                     <a name='4660'>
            TAUG(NGS1+IG,LAY) = COLH2O(LAY) *                   &amp;                <a name='4661'>
                (FC00(LAY) * ABSA2(IND0,IG) +                    &amp;                <a name='4662'>
                 FC10(LAY) * ABSA2(IND0+1,IG) +                  &amp;                <a name='4663'>
                 FC01(LAY) * ABSA2(IND1,IG) +                    &amp;                <a name='4664'>
                 FC11(LAY) * ABSA2(IND1+1,IG) +                  &amp;                <a name='4665'>
                 SELFFAC(LAY) * (SELFREFC2(INDS,IG) +             &amp;                <a name='4666'>
                 SELFFRAC(LAY) *                                &amp;                <a name='4667'>
                 (SELFREFC2(INDS+1,IG) - SELFREFC2(INDS,IG))) +     &amp;                <a name='4668'>
                 FORFAC(LAY) * FORREFC2(IG))                                       <a name='4669'>
            PFRAC(NGS1+IG,LAY) = FRACREFAC2(IG,IFRAC) + FRACINT * &amp;<a name='4670'>
                 (FRACREFAC2(IG,IFRAC-1)-FRACREFAC2(IG,IFRAC))                       <a name='4671'>
 2000    CONTINUE                                                                <a name='4672'>
 2500 CONTINUE                                                                   <a name='4673'>
                                                                                 <a name='4674'>
<font color=#447700>!cdir novector<a name='4675'></font>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='4676'>
         FP = FAC11(LAY) + FAC01(LAY)                                            <a name='4677'>
         IFP = 2.E2*FP+0.5                                                       <a name='4678'>
         IF (IFP.LE.0) IFP = 0                                                   <a name='4679'>
         FC00(LAY) = FAC00(LAY) * CORR2(IFP)                                     <a name='4680'>
         FC10(LAY) = FAC10(LAY) * CORR2(IFP)                                     <a name='4681'>
         FC01(LAY) = FAC01(LAY) * CORR1(IFP)                                     <a name='4682'>
         FC11(LAY) = FAC11(LAY) * CORR1(IFP)                                     <a name='4683'>
         IND0 = ((JP(LAY)-13)*5+(JT(LAY)-1))*NSPB(2) + 1                         <a name='4684'>
         IND1 = ((JP(LAY)-12)*5+(JT1(LAY)-1))*NSPB(2) + 1                        <a name='4685'>
         DO 3000 IG = 1, NG2                                                     <a name='4686'>
            TAUG(NGS1+IG,LAY) = COLH2O(LAY) *                  &amp; <a name='4687'>
                (FC00(LAY) * ABSB2(IND0,IG) +                   &amp;                  <a name='4688'>
                 FC10(LAY) * ABSB2(IND0+1,IG) +                 &amp;                  <a name='4689'>
                 FC01(LAY) * ABSB2(IND1,IG) +                   &amp;                  <a name='4690'>
                 FC11(LAY) * ABSB2(IND1+1,IG) +                 &amp;                  <a name='4691'>
                 FORFAC(LAY) * FORREFC2(IG))                                       <a name='4692'>
            PFRAC(NGS1+IG,LAY) = FRACREFBC2(IG)                                    <a name='4693'>
 3000    CONTINUE                                                                <a name='4694'>
 3500 CONTINUE                                                                   <a name='4695'>
                                                                                 <a name='4696'>
      END SUBROUTINE TAUGB2<a name='4697'>
                                                                                 <a name='4698'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='4699'></font>
<A NAME='TAUGB3'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB3' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4700'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB3</font>(kts,ktep1,COLH2O,COLCO2,COLN2O,FAC00,FAC01,FAC10,    &amp; <A href='../../call_to/TAUGB3.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB3.html' TARGET='index'>3</A><a name='4701'>
                        FAC11,FORFAC,SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,     &amp;<a name='4702'>
                        PFRAC,TAUG,LAYTROP                                   )<a name='4703'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='4704'></font>
                                                                                 <a name='4705'>
<font color=#447700>!     BAND 3:  500-630 cm-1 (low - H2O,CO2; high - H2O,CO2)                      <a name='4706'></font>
                                                                                 <a name='4707'>
      INTEGER, PARAMETER :: NGS2=22                                      <a name='4708'>
                                                                                 <a name='4709'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='4710'>
<a name='4711'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='4712'>
<a name='4713'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='4714'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='4715'>
                                                      TAUG<a name='4716'>
<a name='4717'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='4718'>
                                                    COLH2O, &amp;<a name='4719'>
                                                    COLCO2, &amp;<a name='4720'>
                                                    COLN2O, &amp;<a name='4721'>
                                                     FAC00, &amp;<a name='4722'>
                                                     FAC01, &amp;<a name='4723'>
                                                     FAC10, &amp;<a name='4724'>
                                                     FAC11, &amp;<a name='4725'>
                                                    FORFAC, &amp;<a name='4726'>
                                                   SELFFAC, &amp;<a name='4727'>
                                                  SELFFRAC <a name='4728'>
 <a name='4729'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='4730'>
                                                        JP, &amp;<a name='4731'>
                                                        JT, &amp;<a name='4732'>
                                                       JT1, &amp;<a name='4733'>
                                                   INDSELF<a name='4734'>
<a name='4735'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='4736'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='4737'></font>
<font color=#447700>! carry constants.                                                               <a name='4738'></font>
                                                                                 <a name='4739'>
      DIMENSION H2OREF(59),CO2REF(59), ETAREF(10)                                <a name='4740'>
      REAL N2OMULT,N2OREF(59)                                              <a name='4741'>
                                                                                 <a name='4742'>
      DATA ETAREF/  &amp;                                                             <a name='4743'>
           0.,0.125,0.25,0.375,0.5,0.625,0.75,0.875,0.9875,1.0/                  <a name='4744'>
      DATA H2OREF/  &amp;                                                             <a name='4745'>
           1.87599E-02,1.22233E-02,5.89086E-03,2.76753E-03,1.40651E-03, &amp;<a name='4746'>
           7.59698E-04,3.88758E-04,1.65422E-04,3.71895E-05,7.47648E-06, &amp;        <a name='4747'>
           4.30818E-06,3.33194E-06,3.20393E-06,3.16186E-06,3.25235E-06, &amp;        <a name='4748'>
           3.42258E-06,3.62884E-06,3.91482E-06,4.14875E-06,4.30810E-06, &amp;        <a name='4749'>
           4.44204E-06,4.57783E-06,4.70865E-06,4.79432E-06,4.86971E-06, &amp;        <a name='4750'>
           4.92603E-06,4.96688E-06,4.99628E-06,5.05266E-06,5.12658E-06, &amp;        <a name='4751'>
           5.25028E-06,5.35708E-06,5.45085E-06,5.48304E-06,5.50000E-06, &amp;        <a name='4752'>
           5.50000E-06,5.45359E-06,5.40468E-06,5.35576E-06,5.25327E-06, &amp;        <a name='4753'>
           5.14362E-06,5.03396E-06,4.87662E-06,4.69787E-06,4.51911E-06, &amp;        <a name='4754'>
           4.33600E-06,4.14416E-06,3.95232E-06,3.76048E-06,3.57217E-06, &amp;        <a name='4755'>
           3.38549E-06,3.19881E-06,3.01212E-06,2.82621E-06,2.64068E-06, &amp;        <a name='4756'>
           2.45515E-06,2.26962E-06,2.08659E-06,1.93029E-06/                      <a name='4757'>
      DATA N2OREF/  &amp; <a name='4758'>
           3.20000E-07,3.20000E-07,3.20000E-07,3.20000E-07,3.20000E-07, &amp;<a name='4759'>
           3.19652E-07,3.15324E-07,3.03830E-07,2.94221E-07,2.84953E-07, &amp;        <a name='4760'>
           2.76714E-07,2.64709E-07,2.42847E-07,2.09547E-07,1.71945E-07, &amp;        <a name='4761'>
           1.37491E-07,1.13319E-07,1.00354E-07,9.12812E-08,8.54633E-08, &amp;        <a name='4762'>
           8.03631E-08,7.33718E-08,6.59754E-08,5.60386E-08,4.70901E-08, &amp;        <a name='4763'>
           3.99774E-08,3.29786E-08,2.60642E-08,2.10663E-08,1.65918E-08, &amp;        <a name='4764'>
           1.30167E-08,1.00900E-08,7.62490E-09,6.11592E-09,4.66725E-09, &amp;        <a name='4765'>
           3.28574E-09,2.84838E-09,2.46198E-09,2.07557E-09,1.85507E-09, &amp;        <a name='4766'>
           1.65675E-09,1.45843E-09,1.31948E-09,1.20716E-09,1.09485E-09, &amp;        <a name='4767'>
           9.97803E-10,9.31260E-10,8.64721E-10,7.98181E-10,7.51380E-10, &amp;        <a name='4768'>
           7.13670E-10,6.75960E-10,6.38250E-10,6.09811E-10,5.85998E-10, &amp;        <a name='4769'>
           5.62185E-10,5.38371E-10,5.15183E-10,4.98660E-10/                      <a name='4770'>
      DATA CO2REF/ &amp;                                                             <a name='4771'>
           53*3.55E-04, 3.5470873E-04, 3.5427220E-04, 3.5383567E-04,    &amp;<a name='4772'>
           3.5339911E-04, 3.5282588E-04, 3.5079606E-04/                          <a name='4773'>
                        <a name='4774'>
      STRRAT = 1.19268                                                           <a name='4775'>
                                                                                 <a name='4776'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure),                <a name='4777'></font>
<font color=#447700>!     temperature, and appropriate species.  Below LAYTROP, the water            <a name='4778'></font>
<font color=#447700>!     vapor self-continuum is interpolated (in temperature) separately.          <a name='4779'></font>
<a name='4780'>
<font color=#447700>!cdir novector<a name='4781'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='4782'>
         SPECCOMB = COLH2O(LAY) + STRRAT*COLCO2(LAY)                             <a name='4783'>
         SPECPARM = COLH2O(LAY)/SPECCOMB                                         <a name='4784'>
         IF (SPECPARM .GE. ONEMINUS) SPECPARM = ONEMINUS                         <a name='4785'>
         SPECMULT = 8.*(SPECPARM)                                                <a name='4786'>
         JS = 1 + INT(SPECMULT)                                                  <a name='4787'>
         FS = MOD(SPECMULT,1.0)                                                 <a name='4788'>
         IF (JS .EQ. 8) THEN                                                     <a name='4789'>
            IF (FS .GE. 0.9) THEN                                                <a name='4790'>
               JS = 9                                                            <a name='4791'>
               FS = 10. * (FS - 0.9)                                             <a name='4792'>
            ELSE                                                                 <a name='4793'>
               FS = FS/0.9                                                       <a name='4794'>
            ENDIF                                                                <a name='4795'>
         ENDIF                                                                   <a name='4796'>
         NS = JS + INT(FS + 0.5)                                                 <a name='4797'>
         FP = FAC01(LAY) + FAC11(LAY)                                            <a name='4798'>
         FAC000 = (1. - FS) * FAC00(LAY)                                         <a name='4799'>
         FAC010 = (1. - FS) * FAC10(LAY)                                         <a name='4800'>
         FAC100 = FS * FAC00(LAY)                                                <a name='4801'>
         FAC110 = FS * FAC10(LAY)                                                <a name='4802'>
         FAC001 = (1. - FS) * FAC01(LAY)                                         <a name='4803'>
         FAC011 = (1. - FS) * FAC11(LAY)                                         <a name='4804'>
         FAC101 = FS * FAC01(LAY)                                                <a name='4805'>
         FAC111 = FS * FAC11(LAY)                                                <a name='4806'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(3) + JS                         <a name='4807'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(3) + JS                            <a name='4808'>
         INDS = INDSELF(LAY)                                                     <a name='4809'>
         COLREF1 = N2OREF(JP(LAY))                                               <a name='4810'>
         COLREF2 = N2OREF(JP(LAY)+1)                                             <a name='4811'>
         IF (NS .EQ. 10) THEN                                                    <a name='4812'>
            WCOMB1 = H2OREF(JP(LAY))                                             <a name='4813'>
            WCOMB2 = H2OREF(JP(LAY)+1)                                           <a name='4814'>
         ELSE                                                                    <a name='4815'>
            WCOMB1 = STRRAT * CO2REF(JP(LAY))/(1.-ETAREF(NS))                    <a name='4816'>
            WCOMB2 = STRRAT * CO2REF(JP(LAY)+1)/(1.-ETAREF(NS))                  <a name='4817'>
         ENDIF                                                                   <a name='4818'>
         RATIO = (COLREF1/WCOMB1)+FP*((COLREF2/WCOMB2)-(COLREF1/WCOMB1))         <a name='4819'>
         CURRN2O = SPECCOMB * RATIO                                              <a name='4820'>
         N2OMULT = COLN2O(LAY) - CURRN2O                                         <a name='4821'>
<font color=#447700>!!DIR$ VECTOR                                                                     <a name='4822'></font>
         DO 2000 IG = 1, NG3                                                     <a name='4823'>
            TAUG(NGS2+IG,LAY) = SPECCOMB *                     &amp; <a name='4824'>
                (FAC000 * ABSA3(IND0,IG) +                      &amp;                 <a name='4825'>
                 FAC100 * ABSA3(IND0+1,IG) +                    &amp;                 <a name='4826'>
                 FAC010 * ABSA3(IND0+10,IG) +                   &amp;                 <a name='4827'>
                 FAC110 * ABSA3(IND0+11,IG) +                   &amp;                 <a name='4828'>
                 FAC001 * ABSA3(IND1,IG) +                      &amp;                 <a name='4829'>
                 FAC101 * ABSA3(IND1+1,IG) +                    &amp;                 <a name='4830'>
                 FAC011 * ABSA3(IND1+10,IG) +                   &amp;                 <a name='4831'>
                 FAC111 * ABSA3(IND1+11,IG)) +                  &amp;                 <a name='4832'>
                 COLH2O(LAY) *                                 &amp;                 <a name='4833'>
                 (SELFFAC(LAY) * (SELFREFC3(INDS,IG) +           &amp;                 <a name='4834'>
                 SELFFRAC(LAY) *                               &amp;                 <a name='4835'>
                 (SELFREFC3(INDS+1,IG) - SELFREFC3(INDS,IG))) +    &amp;                 <a name='4836'>
                 FORFAC(LAY) * FORREFC3(IG))                     &amp;                 <a name='4837'>
                 + N2OMULT * ABSN2OAC3(IG)                                         <a name='4838'>
            PFRAC(NGS2+IG,LAY) = FRACREFAC3(IG,JS) + FS *        &amp; <a name='4839'>
                 (FRACREFAC3(IG,JS+1) - FRACREFAC3(IG,JS))                           <a name='4840'>
 2000    CONTINUE                                                                <a name='4841'>
 2500 CONTINUE                                                                   <a name='4842'>
                                                                                 <a name='4843'>
<font color=#447700>!!DIR$ NOVECTOR                                                                   <a name='4844'></font>
<font color=#447700>!cdir novector<a name='4845'></font>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='4846'>
         SPECCOMB = COLH2O(LAY) + STRRAT*COLCO2(LAY)                             <a name='4847'>
         SPECPARM = COLH2O(LAY)/SPECCOMB                                         <a name='4848'>
         IF (SPECPARM .GE. ONEMINUS) SPECPARM = ONEMINUS                         <a name='4849'>
         SPECMULT = 4.*(SPECPARM)                                                <a name='4850'>
         JS = 1 + INT(SPECMULT)                                                  <a name='4851'>
         FS = MOD(SPECMULT,1.0)                                                 <a name='4852'>
         NS = JS + INT(FS + 0.5)                                                 <a name='4853'>
         FP = FAC01(LAY) + FAC11(LAY)                                            <a name='4854'>
         FAC000 = (1. - FS) * FAC00(LAY)                                         <a name='4855'>
         FAC010 = (1. - FS) * FAC10(LAY)                                         <a name='4856'>
         FAC100 = FS * FAC00(LAY)                                                <a name='4857'>
         FAC110 = FS * FAC10(LAY)                                                <a name='4858'>
         FAC001 = (1. - FS) * FAC01(LAY)                                         <a name='4859'>
         FAC011 = (1. - FS) * FAC11(LAY)                                         <a name='4860'>
         FAC101 = FS * FAC01(LAY)                                                <a name='4861'>
         FAC111 = FS * FAC11(LAY)                                                <a name='4862'>
         IND0 = ((JP(LAY)-13)*5+(JT(LAY)-1))*NSPB(3) + JS                        <a name='4863'>
         IND1 = ((JP(LAY)-12)*5+(JT1(LAY)-1))*NSPB(3) + JS                       <a name='4864'>
         COLREF1 = N2OREF(JP(LAY))                                               <a name='4865'>
         COLREF2 = N2OREF(JP(LAY)+1)                                             <a name='4866'>
         IF (NS .EQ. 5) THEN                                                     <a name='4867'>
            WCOMB1 = H2OREF(JP(LAY))                                             <a name='4868'>
            WCOMB2 = H2OREF(JP(LAY)+1)                                           <a name='4869'>
         ELSE                                                                    <a name='4870'>
            WCOMB1 = STRRAT * CO2REF(JP(LAY))/(1.-ETAREF(NS))                    <a name='4871'>
            WCOMB2 = STRRAT * CO2REF(JP(LAY)+1)/(1.-ETAREF(NS))                  <a name='4872'>
         ENDIF                                                                   <a name='4873'>
         RATIO = (COLREF1/WCOMB1)+FP*((COLREF2/WCOMB2)-(COLREF1/WCOMB1))         <a name='4874'>
         CURRN2O = SPECCOMB * RATIO                                              <a name='4875'>
         N2OMULT = COLN2O(LAY) - CURRN2O                                         <a name='4876'>
<font color=#447700>!!DIR$ VECTOR                                                                     <a name='4877'></font>
         DO 3000 IG = 1, NG3                                                     <a name='4878'>
            TAUG(NGS2+IG,LAY) = SPECCOMB *                 &amp;<a name='4879'>
                (FAC000 * ABSB3(IND0,IG) +                  &amp;                     <a name='4880'>
                 FAC100 * ABSB3(IND0+1,IG) +                &amp;                     <a name='4881'>
                 FAC010 * ABSB3(IND0+5,IG) +                &amp;                     <a name='4882'>
                 FAC110 * ABSB3(IND0+6,IG) +                &amp;                     <a name='4883'>
                 FAC001 * ABSB3(IND1,IG) +                  &amp;                     <a name='4884'>
                 FAC101 * ABSB3(IND1+1,IG) +                &amp;                     <a name='4885'>
                 FAC011 * ABSB3(IND1+5,IG) +                &amp;                     <a name='4886'>
                 FAC111 * ABSB3(IND1+6,IG)) +               &amp;                     <a name='4887'>
                 COLH2O(LAY) * FORFAC(LAY) * FORREFC3(IG)    &amp;                     <a name='4888'>
                 + N2OMULT * ABSN2OBC3(IG)                                         <a name='4889'>
            PFRAC(NGS2+IG,LAY) = FRACREFBC3(IG,JS) + FS *    &amp; <a name='4890'>
                 (FRACREFBC3(IG,JS+1) - FRACREFBC3(IG,JS))                           <a name='4891'>
 3000    CONTINUE                                                                <a name='4892'>
 3500 CONTINUE                                                                   <a name='4893'>
                                                                                 <a name='4894'>
      END SUBROUTINE TAUGB3<a name='4895'>
                                                                                 <a name='4896'>
<font color=#447700>!----------------------------------------------------------------------------    <a name='4897'></font>
<A NAME='TAUGB4'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB4' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4898'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB4</font>(kts,ktep1,COLH2O,COLCO2,COLO3,FAC00,FAC01,FAC10,    &amp; <A href='../../call_to/TAUGB4.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB4.html' TARGET='index'>3</A><a name='4899'>
                        FAC11,SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,           &amp;<a name='4900'>
                        PFRAC,TAUG,LAYTROP                                  )<a name='4901'>
<font color=#447700>!----------------------------------------------------------------------------    <a name='4902'></font>
                                                                                 <a name='4903'>
<font color=#447700>!     BAND 4:  630-700 cm-1 (low - H2O,CO2; high - O3,CO2)                       <a name='4904'></font>
                                                                                 <a name='4905'>
      INTEGER, PARAMETER :: NGS3=38                                      <a name='4906'>
                                                                                 <a name='4907'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='4908'>
<a name='4909'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='4910'>
<a name='4911'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='4912'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='4913'>
                                                      TAUG<a name='4914'>
<a name='4915'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='4916'>
                                                    COLH2O, &amp;<a name='4917'>
                                                    COLCO2, &amp;<a name='4918'>
                                                     COLO3, &amp;<a name='4919'>
                                                     FAC00, &amp;<a name='4920'>
                                                     FAC01, &amp;<a name='4921'>
                                                     FAC10, &amp;<a name='4922'>
                                                     FAC11, &amp;<a name='4923'>
                                                   SELFFAC, &amp;<a name='4924'>
                                                  SELFFRAC <a name='4925'>
 <a name='4926'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='4927'>
                                                        JP, &amp;<a name='4928'>
                                                        JT, &amp;<a name='4929'>
                                                       JT1, &amp;<a name='4930'>
                                                   INDSELF<a name='4931'>
<a name='4932'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='4933'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='4934'></font>
<font color=#447700>! carry constants.                                                               <a name='4935'></font>
                                                                                 <a name='4936'>
      STRRAT1 = 850.577                                                          <a name='4937'>
      STRRAT2 = 35.7416                                                          <a name='4938'>
                                                                                 <a name='4939'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure),                <a name='4940'></font>
<font color=#447700>!     temperature, and appropriate species.  Below LAYTROP, the water            <a name='4941'></font>
<font color=#447700>!     vapor self-continuum is interpolated (in temperature) separately.          <a name='4942'></font>
<font color=#447700>!!DIR$ NOVECTOR                                                                   <a name='4943'></font>
<font color=#447700>!cdir novector<a name='4944'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='4945'>
         SPECCOMB = COLH2O(LAY) + STRRAT1*COLCO2(LAY)                            <a name='4946'>
         SPECPARM = COLH2O(LAY)/SPECCOMB                                         <a name='4947'>
         IF (SPECPARM .GE. ONEMINUS) SPECPARM = ONEMINUS                         <a name='4948'>
         SPECMULT = 8.*(SPECPARM)                                                <a name='4949'>
         JS = 1 + INT(SPECMULT)                                                  <a name='4950'>
         FS = MOD(SPECMULT,1.0)                                                 <a name='4951'>
         FAC000 = (1. - FS) * FAC00(LAY)                                         <a name='4952'>
         FAC010 = (1. - FS) * FAC10(LAY)                                         <a name='4953'>
         FAC100 = FS * FAC00(LAY)                                                <a name='4954'>
         FAC110 = FS * FAC10(LAY)                                                <a name='4955'>
         FAC001 = (1. - FS) * FAC01(LAY)                                         <a name='4956'>
         FAC011 = (1. - FS) * FAC11(LAY)                                         <a name='4957'>
         FAC101 = FS * FAC01(LAY)                                                <a name='4958'>
         FAC111 = FS * FAC11(LAY)                                                <a name='4959'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(4) + JS                         <a name='4960'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(4) + JS                            <a name='4961'>
         INDS = INDSELF(LAY)                                                     <a name='4962'>
<font color=#447700>!!DIR$ VECTOR                                                                     <a name='4963'></font>
         DO 2000 IG = 1, NG4                                                     <a name='4964'>
            TAUG(NGS3+IG,LAY) = SPECCOMB *                    &amp;<a name='4965'>
                (FAC000 * ABSA4(IND0,IG) +                     &amp;                  <a name='4966'>
                 FAC100 * ABSA4(IND0+1,IG) +                   &amp;                  <a name='4967'>
                 FAC010 * ABSA4(IND0+9,IG) +                   &amp;                  <a name='4968'>
                 FAC110 * ABSA4(IND0+10,IG) +                  &amp;                  <a name='4969'>
                 FAC001 * ABSA4(IND1,IG) +                     &amp;                  <a name='4970'>
                 FAC101 * ABSA4(IND1+1,IG) +                   &amp;                  <a name='4971'>
                 FAC011 * ABSA4(IND1+9,IG) +                   &amp;                  <a name='4972'>
                 FAC111 * ABSA4(IND1+10,IG)) +                 &amp;                  <a name='4973'>
                 COLH2O(LAY) *                                &amp;                  <a name='4974'>
                 SELFFAC(LAY) * (SELFREFC4(INDS,IG) +           &amp;                  <a name='4975'>
                 SELFFRAC(LAY) *                              &amp;                  <a name='4976'>
                 (SELFREFC4(INDS+1,IG) - SELFREFC4(INDS,IG)))                        <a name='4977'>
            PFRAC(NGS3+IG,LAY) = FRACREFAC4(IG,JS) + FS *       &amp;                  <a name='4978'>
                 (FRACREFAC4(IG,JS+1) - FRACREFAC4(IG,JS))                           <a name='4979'>
 2000    CONTINUE                                                                <a name='4980'>
 2500 CONTINUE                                                                   <a name='4981'>
                                                                                 <a name='4982'>
<font color=#447700>!!DIR$ NOVECTOR                                                                   <a name='4983'></font>
<font color=#447700>!cdir novector<a name='4984'></font>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='4985'>
         SPECCOMB = COLO3(LAY) + STRRAT2*COLCO2(LAY)                             <a name='4986'>
         SPECPARM = COLO3(LAY)/SPECCOMB                                          <a name='4987'>
         IF (SPECPARM .GE. ONEMINUS) SPECPARM = ONEMINUS                         <a name='4988'>
         SPECMULT = 4.*(SPECPARM)                                                <a name='4989'>
         JS = 1 + INT(SPECMULT)                                                  <a name='4990'>
         FS = MOD(SPECMULT,1.0)                                                 <a name='4991'>
         IF (JS .GT. 1) THEN                                                     <a name='4992'>
            JS = JS + 1                                                          <a name='4993'>
         ELSEIF (FS .GE. 0.0024) THEN                                            <a name='4994'>
            JS = 2                                                               <a name='4995'>
            FS = (FS - 0.0024)/0.9976                                            <a name='4996'>
         ELSE                                                                    <a name='4997'>
            JS = 1                                                               <a name='4998'>
            FS = FS/0.0024                                                       <a name='4999'>
         ENDIF                                                                   <a name='5000'>
         FAC000 = (1. - FS) * FAC00(LAY)                                         <a name='5001'>
         FAC010 = (1. - FS) * FAC10(LAY)                                         <a name='5002'>
         FAC100 = FS * FAC00(LAY)                                                <a name='5003'>
         FAC110 = FS * FAC10(LAY)                                                <a name='5004'>
         FAC001 = (1. - FS) * FAC01(LAY)                                         <a name='5005'>
         FAC011 = (1. - FS) * FAC11(LAY)                                         <a name='5006'>
         FAC101 = FS * FAC01(LAY)                                                <a name='5007'>
         FAC111 = FS * FAC11(LAY)                                                <a name='5008'>
         IND0 = ((JP(LAY)-13)*5+(JT(LAY)-1))*NSPB(4) + JS                        <a name='5009'>
         IND1 = ((JP(LAY)-12)*5+(JT1(LAY)-1))*NSPB(4) + JS                       <a name='5010'>
<font color=#447700>!!DIR$ VECTOR                                                                     <a name='5011'></font>
         DO 3000 IG = 1, NG4                                                     <a name='5012'>
            TAUG(NGS3+IG,LAY) = SPECCOMB *              &amp;                        <a name='5013'>
                (FAC000 * ABSB4(IND0,IG) +               &amp;                        <a name='5014'>
                 FAC100 * ABSB4(IND0+1,IG) +             &amp;                        <a name='5015'>
                 FAC010 * ABSB4(IND0+6,IG) +             &amp;                        <a name='5016'>
                 FAC110 * ABSB4(IND0+7,IG) +             &amp;                        <a name='5017'>
                 FAC001 * ABSB4(IND1,IG) +               &amp;                        <a name='5018'>
                 FAC101 * ABSB4(IND1+1,IG) +             &amp;                        <a name='5019'>
                 FAC011 * ABSB4(IND1+6,IG) +             &amp;                        <a name='5020'>
                 FAC111 * ABSB4(IND1+7,IG))                                       <a name='5021'>
            PFRAC(NGS3+IG,LAY) = FRACREFBC4(IG,JS) + FS * &amp;<a name='5022'>
                 (FRACREFBC4(IG,JS+1) - FRACREFBC4(IG,JS))                           <a name='5023'>
 3000    CONTINUE                                                                <a name='5024'>
 3500 CONTINUE                                                                   <a name='5025'>
                                                                                 <a name='5026'>
      END SUBROUTINE TAUGB4<a name='5027'>
                                                                                 <a name='5028'>
<font color=#447700>!----------------------------------------------------------------------------   <a name='5029'></font>
<A NAME='TAUGB5'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB5' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5030'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB5</font>(kts,ktep1,COLH2O,COLCO2,COLO3,FAC00,FAC01,FAC10,    &amp; <A href='../../call_to/TAUGB5.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB5.html' TARGET='index'>3</A><a name='5031'>
                        FAC11,SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,WX,        &amp;<a name='5032'>
                        PFRAC,TAUG,LAYTROP                                  )<a name='5033'>
<font color=#447700>!----------------------------------------------------------------------------   <a name='5034'></font>
                                                                                 <a name='5035'>
<font color=#447700>!     BAND 5:  700-820 cm-1 (low - H2O,CO2; high - O3,CO2)                       <a name='5036'></font>
                                                                                 <a name='5037'>
      INTEGER, PARAMETER :: NGS4=52                                      <a name='5038'>
                                                                                 <a name='5039'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='5040'>
<a name='5041'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='5042'>
<a name='5043'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='5044'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='5045'>
                                                      TAUG<a name='5046'>
<a name='5047'>
      REAL, DIMENSION( MAXXSEC,kts:ktep1 ),                 &amp;<a name='5048'>
            INTENT(IN   )        ::                     WX<a name='5049'>
<a name='5050'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='5051'>
                                                    COLH2O, &amp;<a name='5052'>
                                                    COLCO2, &amp;<a name='5053'>
                                                     COLO3, &amp;<a name='5054'>
                                                     FAC00, &amp;<a name='5055'>
                                                     FAC01, &amp;<a name='5056'>
                                                     FAC10, &amp;<a name='5057'>
                                                     FAC11, &amp;<a name='5058'>
                                                   SELFFAC, &amp;<a name='5059'>
                                                  SELFFRAC <a name='5060'>
 <a name='5061'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='5062'>
                                                        JP, &amp;<a name='5063'>
                                                        JT, &amp;<a name='5064'>
                                                       JT1, &amp;<a name='5065'>
                                                   INDSELF<a name='5066'>
<a name='5067'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='5068'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='5069'></font>
<font color=#447700>! carry constants.                                                               <a name='5070'></font>
                                                                                 <a name='5071'>
      STRRAT1 = 90.4894                                                          <a name='5072'>
      STRRAT2 = 0.900502                                                         <a name='5073'>
                                                                                 <a name='5074'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure),                <a name='5075'></font>
<font color=#447700>!     temperature, and appropriate species.  Below LAYTROP, the water            <a name='5076'></font>
<font color=#447700>!     vapor self-continuum is interpolated (in temperature) separately.          <a name='5077'></font>
<font color=#447700>!!DIR$ NOVECTOR                                                                   <a name='5078'></font>
<font color=#447700>!cdir novector<a name='5079'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='5080'>
         SPECCOMB = COLH2O(LAY) + STRRAT1*COLCO2(LAY)                            <a name='5081'>
         SPECPARM = COLH2O(LAY)/SPECCOMB                                         <a name='5082'>
         IF (SPECPARM .GE. ONEMINUS) SPECPARM = ONEMINUS                         <a name='5083'>
         SPECMULT = 8.*(SPECPARM)                                                <a name='5084'>
         JS = 1 + INT(SPECMULT)                                                  <a name='5085'>
         FS = MOD(SPECMULT,1.0)                                                 <a name='5086'>
         FAC000 = (1. - FS) * FAC00(LAY)                                         <a name='5087'>
         FAC010 = (1. - FS) * FAC10(LAY)                                         <a name='5088'>
         FAC100 = FS * FAC00(LAY)                                                <a name='5089'>
         FAC110 = FS * FAC10(LAY)                                                <a name='5090'>
         FAC001 = (1. - FS) * FAC01(LAY)                                         <a name='5091'>
         FAC011 = (1. - FS) * FAC11(LAY)                                         <a name='5092'>
         FAC101 = FS * FAC01(LAY)                                                <a name='5093'>
         FAC111 = FS * FAC11(LAY)                                                <a name='5094'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(5) + JS                         <a name='5095'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(5) + JS                            <a name='5096'>
         INDS = INDSELF(LAY)                                                     <a name='5097'>
<font color=#447700>!!DIR$ VECTOR                                                                     <a name='5098'></font>
         DO 2000 IG = 1, NG5                                                     <a name='5099'>
            TAUG(NGS4+IG,LAY) = SPECCOMB *                    &amp;<a name='5100'>
                (FAC000 * ABSA5(IND0,IG) +                     &amp;                  <a name='5101'>
                 FAC100 * ABSA5(IND0+1,IG) +                   &amp;                  <a name='5102'>
                 FAC010 * ABSA5(IND0+9,IG) +                   &amp;                  <a name='5103'>
                 FAC110 * ABSA5(IND0+10,IG) +                  &amp;                  <a name='5104'>
                 FAC001 * ABSA5(IND1,IG) +                     &amp;                  <a name='5105'>
                 FAC101 * ABSA5(IND1+1,IG) +                   &amp;                  <a name='5106'>
                 FAC011 * ABSA5(IND1+9,IG) +                   &amp;                  <a name='5107'>
                 FAC111 * ABSA5(IND1+10,IG)) +                 &amp;                  <a name='5108'>
                 COLH2O(LAY) *                                &amp;                  <a name='5109'>
                 SELFFAC(LAY) * (SELFREFC5(INDS,IG) +           &amp;                  <a name='5110'>
                 SELFFRAC(LAY) *                              &amp;                  <a name='5111'>
                 (SELFREFC5(INDS+1,IG) - SELFREFC5(INDS,IG)))     &amp;                  <a name='5112'>
                 + WX(1,LAY) * CCL4C5(IG)                                          <a name='5113'>
            PFRAC(NGS4+IG,LAY) = FRACREFAC5(IG,JS) + FS *       &amp;                  <a name='5114'>
                 (FRACREFAC5(IG,JS+1) - FRACREFAC5(IG,JS))                           <a name='5115'>
 2000    CONTINUE                                                                <a name='5116'>
 2500 CONTINUE                                                                   <a name='5117'>
                                                                                 <a name='5118'>
<font color=#447700>!!DIR$ NOVECTOR                                                                   <a name='5119'></font>
<font color=#447700>!cdir novector<a name='5120'></font>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='5121'>
         SPECCOMB = COLO3(LAY) + STRRAT2*COLCO2(LAY)                             <a name='5122'>
         SPECPARM = COLO3(LAY)/SPECCOMB                                          <a name='5123'>
         IF (SPECPARM .GE. ONEMINUS) SPECPARM = ONEMINUS                         <a name='5124'>
         SPECMULT = 4.*(SPECPARM)                                                <a name='5125'>
         JS = 1 + INT(SPECMULT)                                                  <a name='5126'>
         FS = MOD(SPECMULT,1.0)                                                 <a name='5127'>
         FAC000 = (1. - FS) * FAC00(LAY)                                         <a name='5128'>
         FAC010 = (1. - FS) * FAC10(LAY)                                         <a name='5129'>
         FAC100 = FS * FAC00(LAY)                                                <a name='5130'>
         FAC110 = FS * FAC10(LAY)                                                <a name='5131'>
         FAC001 = (1. - FS) * FAC01(LAY)                                         <a name='5132'>
         FAC011 = (1. - FS) * FAC11(LAY)                                         <a name='5133'>
         FAC101 = FS * FAC01(LAY)                                                <a name='5134'>
         FAC111 = FS * FAC11(LAY)                                                <a name='5135'>
         IND0 = ((JP(LAY)-13)*5+(JT(LAY)-1))*NSPB(5) + JS                        <a name='5136'>
         IND1 = ((JP(LAY)-12)*5+(JT1(LAY)-1))*NSPB(5) + JS                       <a name='5137'>
<font color=#447700>!!DIR$ VECTOR                                                                     <a name='5138'></font>
         DO 3000 IG = 1, NG5                                                     <a name='5139'>
            TAUG(NGS4+IG,LAY) = SPECCOMB *          &amp;<a name='5140'>
                (FAC000 * ABSB5(IND0,IG) +           &amp;                            <a name='5141'>
                 FAC100 * ABSB5(IND0+1,IG) +         &amp;                            <a name='5142'>
                 FAC010 * ABSB5(IND0+5,IG) +         &amp;                            <a name='5143'>
                 FAC110 * ABSB5(IND0+6,IG) +         &amp;                            <a name='5144'>
                 FAC001 * ABSB5(IND1,IG) +           &amp;                            <a name='5145'>
                 FAC101 * ABSB5(IND1+1,IG) +         &amp;                            <a name='5146'>
                 FAC011 * ABSB5(IND1+5,IG) +         &amp;                            <a name='5147'>
                 FAC111 * ABSB5(IND1+6,IG))          &amp;                            <a name='5148'>
                 + WX(1,LAY) * CCL4C5(IG)                                          <a name='5149'>
            PFRAC(NGS4+IG,LAY) = FRACREFBC5(IG,JS) + FS *  &amp;                       <a name='5150'>
                 (FRACREFBC5(IG,JS+1) - FRACREFBC5(IG,JS))                           <a name='5151'>
 3000    CONTINUE                                                                <a name='5152'>
 3500 CONTINUE                                                                   <a name='5153'>
                                                                                 <a name='5154'>
      END SUBROUTINE TAUGB5<a name='5155'>
                                                                                 <a name='5156'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='5157'></font>
<A NAME='TAUGB6'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB6' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5158'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB6</font>(kts,ktep1,COLH2O,CO2MULT,FAC00,FAC01,FAC10,FAC11,    &amp; <A href='../../call_to/TAUGB6.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB6.html' TARGET='index'>3</A><a name='5159'>
                        SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,WX,PFRAC,TAUG,    &amp;<a name='5160'>
                        LAYTROP                                              )<a name='5161'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='5162'></font>
                                                                                 <a name='5163'>
<font color=#447700>!     BAND 6:  820-980 cm-1 (low - H2O; high - nothing)                          <a name='5164'></font>
                                                                                 <a name='5165'>
      INTEGER, PARAMETER :: NGS5=68                                       <a name='5166'>
                                                                                 <a name='5167'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='5168'>
<a name='5169'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='5170'>
<a name='5171'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='5172'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='5173'>
                                                      TAUG<a name='5174'>
<a name='5175'>
      REAL, DIMENSION( MAXXSEC,kts:ktep1 ),                 &amp;<a name='5176'>
            INTENT(IN   )        ::                     WX<a name='5177'>
<a name='5178'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='5179'>
                                                    COLH2O, &amp;<a name='5180'>
                                                   CO2MULT, &amp;<a name='5181'>
                                                     FAC00, &amp;<a name='5182'>
                                                     FAC01, &amp;<a name='5183'>
                                                     FAC10, &amp;<a name='5184'>
                                                     FAC11, &amp;<a name='5185'>
                                                   SELFFAC, &amp;<a name='5186'>
                                                  SELFFRAC <a name='5187'>
 <a name='5188'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='5189'>
                                                        JP, &amp;<a name='5190'>
                                                        JT, &amp;<a name='5191'>
                                                       JT1, &amp;<a name='5192'>
                                                   INDSELF<a name='5193'>
<a name='5194'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='5195'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='5196'></font>
<font color=#447700>! carry constants.                                                               <a name='5197'></font>
                                                                                 <a name='5198'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure) and             <a name='5199'></font>
<font color=#447700>!     temperature. The water vapor self-continuum is interpolated                <a name='5200'></font>
<font color=#447700>!     (in temperature) separately.                                               <a name='5201'></font>
<font color=#447700>!cdir novector<a name='5202'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='5203'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(6) + 1                          <a name='5204'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(6) + 1                             <a name='5205'>
         INDS = INDSELF(LAY)                                                     <a name='5206'>
         DO 2000 IG = 1, NG6                                                     <a name='5207'>
            TAUG(NGS5+IG,LAY) = COLH2O(LAY) *              &amp; <a name='5208'>
                (FAC00(LAY) * ABSA6(IND0,IG) +              &amp;                     <a name='5209'>
                 FAC10(LAY) * ABSA6(IND0+1,IG) +            &amp;                     <a name='5210'>
                 FAC01(LAY) * ABSA6(IND1,IG) +              &amp;                     <a name='5211'>
                 FAC11(LAY) * ABSA6(IND1+1,IG) +            &amp;                     <a name='5212'>
                 SELFFAC(LAY) * (SELFREFC6(INDS,IG) +        &amp;                     <a name='5213'>
                 SELFFRAC(LAY)*                            &amp;                     <a name='5214'>
                 (SELFREFC6(INDS+1,IG)-SELFREFC6(INDS,IG))))   &amp;                     <a name='5215'>
                 + WX(2,LAY) * CFC11ADJC6(IG)                &amp;                     <a name='5216'>
                 + WX(3,LAY) * CFC12C6(IG)                   &amp;                     <a name='5217'>
                 + CO2MULT(LAY) * ABSCO2C6(IG)                                     <a name='5218'>
            PFRAC(NGS5+IG,LAY) = FRACREFAC6(IG)                                    <a name='5219'>
 2000    CONTINUE                                                                <a name='5220'>
 2500 CONTINUE                                                                   <a name='5221'>
                                                                                 <a name='5222'>
<font color=#447700>!     Nothing important goes on above LAYTROP in this band.                      <a name='5223'></font>
<font color=#447700>!cdir novector<a name='5224'></font>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='5225'>
         DO 3000 IG = 1, NG6                                                     <a name='5226'>
            TAUG(NGS5+IG,LAY) = 0.0                        &amp; <a name='5227'>
                 + WX(2,LAY) * CFC11ADJC6(IG)                &amp;                     <a name='5228'>
                 + WX(3,LAY) * CFC12C6(IG)                                         <a name='5229'>
            PFRAC(NGS5+IG,LAY) = FRACREFAC6(IG)                                    <a name='5230'>
 3000    CONTINUE                                                                <a name='5231'>
 3500 CONTINUE                                                                   <a name='5232'>
                                                                                 <a name='5233'>
      END SUBROUTINE TAUGB6<a name='5234'>
                                                                                 <a name='5235'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='5236'></font>
<A NAME='TAUGB7'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB7' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5237'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB7</font>(kts,ktep1,COLH2O,COLO3,CO2MULT,FAC00,FAC01,FAC10,    &amp;    <A href='../../call_to/TAUGB7.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB7.html' TARGET='index'>3</A><a name='5238'>
                        FAC11,SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,            &amp;<a name='5239'>
                        PFRAC,TAUG,LAYTROP                                   )<a name='5240'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='5241'></font>
                                                                                 <a name='5242'>
<font color=#447700>!     BAND 7:  980-1080 cm-1 (low - H2O,O3; high - O3)                           <a name='5243'></font>
                                                                                 <a name='5244'>
      INTEGER, PARAMETER :: NGS6=76                                      <a name='5245'>
                                                                                 <a name='5246'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='5247'>
<a name='5248'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='5249'>
<a name='5250'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='5251'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='5252'>
                                                      TAUG<a name='5253'>
<a name='5254'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='5255'>
                                                    COLH2O, &amp;<a name='5256'>
                                                     COLO3, &amp;<a name='5257'>
                                                   CO2MULT, &amp;<a name='5258'>
                                                     FAC00, &amp;<a name='5259'>
                                                     FAC01, &amp;<a name='5260'>
                                                     FAC10, &amp;<a name='5261'>
                                                     FAC11, &amp;<a name='5262'>
                                                   SELFFAC, &amp;<a name='5263'>
                                                  SELFFRAC <a name='5264'>
 <a name='5265'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='5266'>
                                                        JP, &amp;<a name='5267'>
                                                        JT, &amp;<a name='5268'>
                                                       JT1, &amp;<a name='5269'>
                                                   INDSELF<a name='5270'>
<a name='5271'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='5272'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='5273'></font>
<font color=#447700>! carry constants.                                                               <a name='5274'></font>
                                                                                 <a name='5275'>
      STRRAT1 = 8.21104E4                                                        <a name='5276'>
                                                                                 <a name='5277'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure),                <a name='5278'></font>
<font color=#447700>!     temperature, and appropriate species.  Below LAYTROP, the water            <a name='5279'></font>
<font color=#447700>!     vapor self-continuum is interpolated (in temperature) separately.          <a name='5280'></font>
<font color=#447700>!!DIR$ NOVECTOR                                                                   <a name='5281'></font>
<font color=#447700>!cdir novector<a name='5282'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='5283'>
         SPECCOMB = COLH2O(LAY) + STRRAT1*COLO3(LAY)                             <a name='5284'>
         SPECPARM = COLH2O(LAY)/SPECCOMB                                         <a name='5285'>
         IF (SPECPARM .GE. ONEMINUS) SPECPARM = ONEMINUS                         <a name='5286'>
         SPECMULT = 8.*SPECPARM                                                  <a name='5287'>
         JS = 1 + INT(SPECMULT)                                                  <a name='5288'>
         FS = MOD(SPECMULT,1.0)                                                 <a name='5289'>
         FAC000 = (1. - FS) * FAC00(LAY)                                         <a name='5290'>
         FAC010 = (1. - FS) * FAC10(LAY)                                         <a name='5291'>
         FAC100 = FS * FAC00(LAY)                                                <a name='5292'>
         FAC110 = FS * FAC10(LAY)                                                <a name='5293'>
         FAC001 = (1. - FS) * FAC01(LAY)                                         <a name='5294'>
         FAC011 = (1. - FS) * FAC11(LAY)                                         <a name='5295'>
         FAC101 = FS * FAC01(LAY)                                                <a name='5296'>
         FAC111 = FS * FAC11(LAY)                                                <a name='5297'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(7) + JS                         <a name='5298'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(7) + JS                            <a name='5299'>
         INDS = INDSELF(LAY)                                                     <a name='5300'>
<font color=#447700>!!DIR$ VECTOR                                                                     <a name='5301'></font>
         DO 2000 IG = 1, NG7                                                     <a name='5302'>
            TAUG(NGS6+IG,LAY) = SPECCOMB *                   &amp; <a name='5303'>
                (FAC000 * ABSA7(IND0,IG) +                   &amp;                    <a name='5304'>
                 FAC100 * ABSA7(IND0+1,IG) +                 &amp;                    <a name='5305'>
                 FAC010 * ABSA7(IND0+9,IG) +                 &amp;                    <a name='5306'>
                 FAC110 * ABSA7(IND0+10,IG) +                &amp;                    <a name='5307'>
                 FAC001 * ABSA7(IND1,IG) +                   &amp;                    <a name='5308'>
                 FAC101 * ABSA7(IND1+1,IG) +                 &amp;                    <a name='5309'>
                 FAC011 * ABSA7(IND1+9,IG) +                 &amp;                    <a name='5310'>
                 FAC111 * ABSA7(IND1+10,IG)) +               &amp;                    <a name='5311'>
                 COLH2O(LAY) *                               &amp;                    <a name='5312'>
                 SELFFAC(LAY) * (SELFREFC7(INDS,IG) +        &amp;                    <a name='5313'>
                 SELFFRAC(LAY) *                             &amp;                    <a name='5314'>
                 (SELFREFC7(INDS+1,IG) - SELFREFC7(INDS,IG)))&amp;<a name='5315'>
                 + CO2MULT(LAY) * ABSCO2C7(IG)                                     <a name='5316'>
         PFRAC(NGS6+IG,LAY) = FRACREFAC7(IG,JS) + FS *        &amp;                    <a name='5317'>
                 (FRACREFAC7(IG,JS+1) - FRACREFAC7(IG,JS))                           <a name='5318'>
 2000    CONTINUE                                                                <a name='5319'>
 2500 CONTINUE                                                                   <a name='5320'>
                                                                                 <a name='5321'>
<font color=#447700>!cdir novector<a name='5322'></font>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='5323'>
         IND0 = ((JP(LAY)-13)*5+(JT(LAY)-1))*NSPB(7) + 1                         <a name='5324'>
         IND1 = ((JP(LAY)-12)*5+(JT1(LAY)-1))*NSPB(7) + 1                        <a name='5325'>
         DO 3000 IG = 1, NG7                                                     <a name='5326'>
            TAUG(NGS6+IG,LAY) = COLO3(LAY) *                &amp; <a name='5327'>
                (FAC00(LAY) * ABSB7(IND0,IG) +               &amp;                    <a name='5328'>
                 FAC10(LAY) * ABSB7(IND0+1,IG) +             &amp;                    <a name='5329'>
                 FAC01(LAY) * ABSB7(IND1,IG) +               &amp;                    <a name='5330'>
                 FAC11(LAY) * ABSB7(IND1+1,IG))              &amp;                    <a name='5331'>
                 + CO2MULT(LAY) * ABSCO2C7(IG)                                     <a name='5332'>
            PFRAC(NGS6+IG,LAY) = FRACREFBC7(IG)                                    <a name='5333'>
 3000    CONTINUE                                                                <a name='5334'>
 3500 CONTINUE                                                                   <a name='5335'>
                                                                                 <a name='5336'>
      END SUBROUTINE TAUGB7<a name='5337'>
                                                                                 <a name='5338'>
<font color=#447700>!----------------------------------------------------------------------------    <a name='5339'></font>
<A NAME='TAUGB8'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB8' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5340'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB8</font>(kts,ktep1,COLH2O,COLO3,COLN2O,CO2MULT,              &amp; <A href='../../call_to/TAUGB8.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB8.html' TARGET='index'>3</A><a name='5341'>
                        FAC00,FAC01,FAC10,FAC11,SELFFAC,SELFFRAC,           &amp;<a name='5342'>
                        JP,JT,JT1,INDSELF,WX,PFRAC,TAUG,LAYSWTCH            )<a name='5343'>
<font color=#447700>!----------------------------------------------------------------------------    <a name='5344'></font>
                                                                                 <a name='5345'>
<font color=#447700>!     BAND 8:  1080-1180 cm-1 (low (i.e.&gt;~300mb) - H2O; high - O3)               <a name='5346'></font>
                                                                                 <a name='5347'>
      INTEGER, PARAMETER :: NGS7=88                                       <a name='5348'>
                                                                                 <a name='5349'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='5350'>
<a name='5351'>
      INTEGER, INTENT(IN )                      :: LAYSWTCH<a name='5352'>
<a name='5353'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='5354'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='5355'>
                                                      TAUG<a name='5356'>
<a name='5357'>
      REAL, DIMENSION( MAXXSEC,kts:ktep1 ),                 &amp;<a name='5358'>
            INTENT(IN   )        ::                     WX<a name='5359'>
<a name='5360'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='5361'>
                                                    COLH2O, &amp;<a name='5362'>
                                                     COLO3, &amp;<a name='5363'>
                                                    COLN2O, &amp;<a name='5364'>
                                                   CO2MULT, &amp;<a name='5365'>
                                                     FAC00, &amp;<a name='5366'>
                                                     FAC01, &amp;<a name='5367'>
                                                     FAC10, &amp;<a name='5368'>
                                                     FAC11, &amp;<a name='5369'>
                                                   SELFFAC, &amp;<a name='5370'>
                                                  SELFFRAC <a name='5371'>
 <a name='5372'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='5373'>
                                                        JP, &amp;<a name='5374'>
                                                        JT, &amp;<a name='5375'>
                                                       JT1, &amp;<a name='5376'>
                                                   INDSELF<a name='5377'>
<a name='5378'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='5379'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='5380'></font>
<font color=#447700>! carry constants.                                                               <a name='5381'></font>
                                                                                 <a name='5382'>
      DIMENSION H2OREF(59),O3REF(59)                                             <a name='5383'>
      REAL N2OMULT,N2OREF(59)                                              <a name='5384'>
                                                                                 <a name='5385'>
      DATA H2OREF/ &amp;                                                             <a name='5386'>
           1.87599E-02,1.22233E-02,5.89086E-03,2.76753E-03,1.40651E-03, &amp;        <a name='5387'>
           7.59698E-04,3.88758E-04,1.65422E-04,3.71895E-05,7.47648E-06, &amp;        <a name='5388'>
           4.30818E-06,3.33194E-06,3.20393E-06,3.16186E-06,3.25235E-06, &amp;        <a name='5389'>
           3.42258E-06,3.62884E-06,3.91482E-06,4.14875E-06,4.30810E-06, &amp;        <a name='5390'>
           4.44204E-06,4.57783E-06,4.70865E-06,4.79432E-06,4.86971E-06, &amp;        <a name='5391'>
           4.92603E-06,4.96688E-06,4.99628E-06,5.05266E-06,5.12658E-06, &amp;        <a name='5392'>
           5.25028E-06,5.35708E-06,5.45085E-06,5.48304E-06,5.50000E-06, &amp;        <a name='5393'>
           5.50000E-06,5.45359E-06,5.40468E-06,5.35576E-06,5.25327E-06, &amp;        <a name='5394'>
           5.14362E-06,5.03396E-06,4.87662E-06,4.69787E-06,4.51911E-06, &amp;        <a name='5395'>
           4.33600E-06,4.14416E-06,3.95232E-06,3.76048E-06,3.57217E-06, &amp;        <a name='5396'>
           3.38549E-06,3.19881E-06,3.01212E-06,2.82621E-06,2.64068E-06, &amp;        <a name='5397'>
           2.45515E-06,2.26962E-06,2.08659E-06,1.93029E-06/                      <a name='5398'>
      DATA N2OREF/ &amp;                                                             <a name='5399'>
           3.20000E-07,3.20000E-07,3.20000E-07,3.20000E-07,3.20000E-07, &amp;        <a name='5400'>
           3.19652E-07,3.15324E-07,3.03830E-07,2.94221E-07,2.84953E-07, &amp;        <a name='5401'>
           2.76714E-07,2.64709E-07,2.42847E-07,2.09547E-07,1.71945E-07, &amp;        <a name='5402'>
           1.37491E-07,1.13319E-07,1.00354E-07,9.12812E-08,8.54633E-08, &amp;        <a name='5403'>
           8.03631E-08,7.33718E-08,6.59754E-08,5.60386E-08,4.70901E-08, &amp;        <a name='5404'>
           3.99774E-08,3.29786E-08,2.60642E-08,2.10663E-08,1.65918E-08, &amp;        <a name='5405'>
           1.30167E-08,1.00900E-08,7.62490E-09,6.11592E-09,4.66725E-09, &amp;        <a name='5406'>
           3.28574E-09,2.84838E-09,2.46198E-09,2.07557E-09,1.85507E-09, &amp;        <a name='5407'>
           1.65675E-09,1.45843E-09,1.31948E-09,1.20716E-09,1.09485E-09, &amp;        <a name='5408'>
           9.97803E-10,9.31260E-10,8.64721E-10,7.98181E-10,7.51380E-10, &amp;        <a name='5409'>
           7.13670E-10,6.75960E-10,6.38250E-10,6.09811E-10,5.85998E-10, &amp;        <a name='5410'>
           5.62185E-10,5.38371E-10,5.15183E-10,4.98660E-10/                      <a name='5411'>
      DATA O3REF/  &amp;                                                             <a name='5412'>
           3.01700E-08,3.47254E-08,4.24769E-08,5.27592E-08,6.69439E-08, &amp;        <a name='5413'>
           8.71295E-08,1.13911E-07,1.56771E-07,2.17878E-07,3.24430E-07, &amp;        <a name='5414'>
           4.65942E-07,5.68057E-07,6.96065E-07,1.11863E-06,1.76175E-06, &amp;        <a name='5415'>
           2.32689E-06,2.95769E-06,3.65930E-06,4.59503E-06,5.31891E-06, &amp;        <a name='5416'>
           5.96179E-06,6.51133E-06,7.06350E-06,7.69169E-06,8.25771E-06, &amp;        <a name='5417'>
           8.70824E-06,8.83245E-06,8.71486E-06,8.09434E-06,7.33071E-06, &amp;        <a name='5418'>
           6.31014E-06,5.36717E-06,4.48289E-06,3.83913E-06,3.28270E-06, &amp;        <a name='5419'>
           2.82351E-06,2.49061E-06,2.16453E-06,1.83845E-06,1.66182E-06, &amp;        <a name='5420'>
           1.50517E-06,1.34852E-06,1.19718E-06,1.04822E-06,8.99264E-07, &amp;        <a name='5421'>
           7.63432E-07,6.53806E-07,5.44186E-07,4.34564E-07,3.64210E-07, &amp;        <a name='5422'>
           3.11938E-07,2.59667E-07,2.07395E-07,1.91456E-07,1.93639E-07, &amp;        <a name='5423'>
           1.95821E-07,1.98004E-07,2.06442E-07,2.81546E-07/                      <a name='5424'>
                                                                                 <a name='5425'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure) and             <a name='5426'></font>
<font color=#447700>!     temperature.                                                               <a name='5427'></font>
<font color=#447700>!cdir novector<a name='5428'></font>
      DO 2500 LAY = 1, LAYSWTCH                                                  <a name='5429'>
         FP = FAC01(LAY) + FAC11(LAY)                                            <a name='5430'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(8) + 1                          <a name='5431'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(8) + 1                             <a name='5432'>
         INDS = INDSELF(LAY)                                                     <a name='5433'>
         COLREF1 = N2OREF(JP(LAY))                                               <a name='5434'>
         COLREF2 = N2OREF(JP(LAY)+1)                                             <a name='5435'>
         WCOMB1 = H2OREF(JP(LAY))                                                <a name='5436'>
         WCOMB2 = H2OREF(JP(LAY)+1)                                              <a name='5437'>
         RATIO = (COLREF1/WCOMB1)+FP*((COLREF2/WCOMB2)-(COLREF1/WCOMB1))         <a name='5438'>
         CURRN2O = COLH2O(LAY) * RATIO                                           <a name='5439'>
         N2OMULT = COLN2O(LAY) - CURRN2O                                         <a name='5440'>
         DO 2000 IG = 1, NG8                                                     <a name='5441'>
            TAUG(NGS7+IG,LAY) = COLH2O(LAY) *                 &amp;<a name='5442'>
                (FAC00(LAY) * ABSA8(IND0,IG) +                &amp;                   <a name='5443'>
                 FAC10(LAY) * ABSA8(IND0+1,IG) +              &amp;                   <a name='5444'>
                 FAC01(LAY) * ABSA8(IND1,IG) +                &amp;                   <a name='5445'>
                 FAC11(LAY) * ABSA8(IND1+1,IG) +              &amp;                   <a name='5446'>
                 SELFFAC(LAY) * (SELFREFC8(INDS,IG) +         &amp;                   <a name='5447'>
                 SELFFRAC(LAY) *                              &amp;                   <a name='5448'>
                 (SELFREFC8(INDS+1,IG) - SELFREFC8(INDS,IG))))&amp;                   <a name='5449'>
                 + WX(3,LAY) * CFC12C8(IG)                    &amp;                   <a name='5450'>
                 + WX(4,LAY) * CFC22ADJC8(IG)                 &amp;                   <a name='5451'>
                 + CO2MULT(LAY) * ABSCO2AC8(IG)               &amp;                   <a name='5452'>
                 + N2OMULT * ABSN2OAC8(IG)        <a name='5453'>
            PFRAC(NGS7+IG,LAY) = FRACREFAC8(IG)                                    <a name='5454'>
 2000    CONTINUE                                                                <a name='5455'>
 2500 CONTINUE                                                                   <a name='5456'>
                                                                                 <a name='5457'>
<font color=#447700>!cdir novector<a name='5458'></font>
      DO 3500 LAY = LAYSWTCH+1, NLAYERS                                          <a name='5459'>
         FP = FAC01(LAY) + FAC11(LAY)                                            <a name='5460'>
         IND0 = ((JP(LAY)-7)*5+(JT(LAY)-1))*NSPB(8) + 1                          <a name='5461'>
         IND1 = ((JP(LAY)-6)*5+(JT1(LAY)-1))*NSPB(8) + 1                         <a name='5462'>
         COLREF1 = N2OREF(JP(LAY))                                               <a name='5463'>
         COLREF2 = N2OREF(JP(LAY)+1)                                             <a name='5464'>
         WCOMB1 = O3REF(JP(LAY))                                                 <a name='5465'>
         WCOMB2 = O3REF(JP(LAY)+1)                                               <a name='5466'>
         RATIO = (COLREF1/WCOMB1)+FP*((COLREF2/WCOMB2)-(COLREF1/WCOMB1))         <a name='5467'>
         CURRN2O = COLO3(LAY) * RATIO                                            <a name='5468'>
         N2OMULT = COLN2O(LAY) - CURRN2O                                         <a name='5469'>
         DO 3000 IG = 1, NG8                                                     <a name='5470'>
            TAUG(NGS7+IG,LAY) = COLO3(LAY) *        &amp;<a name='5471'>
                (FAC00(LAY) * ABSB8(IND0,IG) +       &amp;                            <a name='5472'>
                 FAC10(LAY) * ABSB8(IND0+1,IG) +     &amp;                            <a name='5473'>
                 FAC01(LAY) * ABSB8(IND1,IG) +       &amp;                            <a name='5474'>
                 FAC11(LAY) * ABSB8(IND1+1,IG))      &amp;                            <a name='5475'>
                 + WX(3,LAY) * CFC12C8(IG)            &amp;                            <a name='5476'>
                 + WX(4,LAY) * CFC22ADJC8(IG)         &amp;                            <a name='5477'>
                 + CO2MULT(LAY) * ABSCO2BC8(IG)       &amp;                            <a name='5478'>
                 + N2OMULT * ABSN2OBC8(IG)                                         <a name='5479'>
            PFRAC(NGS7+IG,LAY) = FRACREFBC8(IG)                                    <a name='5480'>
 3000    CONTINUE                                                                <a name='5481'>
 3500 CONTINUE                                                                   <a name='5482'>
                                                                                 <a name='5483'>
      END SUBROUTINE TAUGB8<a name='5484'>
                                                                                 <a name='5485'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='5486'></font>
<A NAME='TAUGB9'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB9' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5487'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB9</font>(kts,ktep1,COLH2O,COLN2O,COLCH4,FAC00,FAC01,FAC10,    &amp; <A href='../../call_to/TAUGB9.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB9.html' TARGET='index'>3</A><a name='5488'>
                        FAC11,SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,            &amp;<a name='5489'>
                        PFRAC,TAUG,LAYTROP,LAYSWTCH,LAYLOW                   )<a name='5490'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='5491'></font>
                                                                                 <a name='5492'>
<font color=#447700>!     BAND 9:  1180-1390 cm-1 (low - H2O,CH4; high - CH4)                        <a name='5493'></font>
                                                                                 <a name='5494'>
      INTEGER, PARAMETER :: NGS8=96                                      <a name='5495'>
                                                                                 <a name='5496'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='5497'>
<a name='5498'>
      INTEGER, INTENT(IN )   ::  LAYTROP,LAYSWTCH,LAYLOW<a name='5499'>
<a name='5500'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='5501'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='5502'>
                                                      TAUG<a name='5503'>
<a name='5504'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='5505'>
                                                    COLH2O, &amp;<a name='5506'>
                                                    COLN2O, &amp;<a name='5507'>
                                                    COLCH4, &amp;<a name='5508'>
                                                     FAC00, &amp;<a name='5509'>
                                                     FAC01, &amp;<a name='5510'>
                                                     FAC10, &amp;<a name='5511'>
                                                     FAC11, &amp;<a name='5512'>
                                                   SELFFAC, &amp;<a name='5513'>
                                                  SELFFRAC <a name='5514'>
 <a name='5515'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='5516'>
                                                        JP, &amp;<a name='5517'>
                                                        JT, &amp;<a name='5518'>
                                                       JT1, &amp;<a name='5519'>
                                                   INDSELF<a name='5520'>
<a name='5521'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='5522'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='5523'></font>
<font color=#447700>! carry constants.                                                               <a name='5524'></font>
                                                                                 <a name='5525'>
      DIMENSION H2OREF(13),CH4REF(13),ETAREF(11)                                 <a name='5526'>
      REAL N2OMULT,N2OREF(13)                                              <a name='5527'>
                                                                                 <a name='5528'>
      DATA N2OREF/  &amp;                                                            <a name='5529'>
           3.20000E-07,3.20000E-07,3.20000E-07,3.20000E-07,3.20000E-07,  &amp;<a name='5530'>
           3.19652E-07,3.15324E-07,3.03830E-07,2.94221E-07,2.84953E-07,  &amp;       <a name='5531'>
           2.76714E-07,2.64709E-07,2.42847E-07/                                  <a name='5532'>
      DATA H2OREF/  &amp;                                                            <a name='5533'>
           1.8759999E-02, 1.2223309E-02, 5.8908667E-03, 2.7675382E-03,   &amp;       <a name='5534'>
           1.4065107E-03, 7.5969833E-04, 3.8875898E-04, 1.6542293E-04,   &amp;       <a name='5535'>
           3.7189537E-05, 7.4764857E-06, 4.3081886E-06, 3.3319423E-06,   &amp;       <a name='5536'>
           3.2039343E-06/                                                        <a name='5537'>
      DATA CH4REF/  &amp;                                                            <a name='5538'>
           1.7000001E-06, 1.7000001E-06, 1.6998713E-06, 1.6904165E-06,   &amp;       <a name='5539'>
           1.6671424E-06, 1.6350652E-06, 1.6097551E-06, 1.5590465E-06,   &amp;       <a name='5540'>
           1.5119849E-06, 1.4741138E-06, 1.4384609E-06, 1.4002215E-06,   &amp;       <a name='5541'>
           1.3573376E-06/                                                        <a name='5542'>
      DATA ETAREF/  &amp;                                                            <a name='5543'>
           0.,0.125,0.25,0.375,0.5,0.625,0.75,0.875,0.96,0.99,1.0/               <a name='5544'>
                                                                                 <a name='5545'>
      STRRAT = 21.6282                                                           <a name='5546'>
      IOFF = 0                                                                   <a name='5547'>
                                                                                 <a name='5548'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure),                <a name='5549'></font>
<font color=#447700>!     temperature, and appropriate species.  Below LAYTROP, the water            <a name='5550'></font>
<font color=#447700>!     vapor self-continuum is interpolated (in temperature) separately.          <a name='5551'></font>
<font color=#447700>!cdir novector<a name='5552'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='5553'>
         SPECCOMB = COLH2O(LAY) + STRRAT*COLCH4(LAY)                             <a name='5554'>
         SPECPARM = COLH2O(LAY)/SPECCOMB                                         <a name='5555'>
         IF (SPECPARM .GE. ONEMINUS) SPECPARM = ONEMINUS                         <a name='5556'>
         SPECMULT = 8.*(SPECPARM)                                                <a name='5557'>
         JS = 1 + INT(SPECMULT)                                                  <a name='5558'>
         JFRAC = JS                                                              <a name='5559'>
         FS = MOD(SPECMULT,1.0)                                                 <a name='5560'>
         FFRAC = FS                                                              <a name='5561'>
         IF (JS .EQ. 8) THEN                                                     <a name='5562'>
            IF (FS .LE. 0.68) THEN                                               <a name='5563'>
               FS = FS/0.68                                                      <a name='5564'>
            ELSEIF (FS .LE. 0.92) THEN                                           <a name='5565'>
               JS = JS + 1                                                       <a name='5566'>
               FS = (FS-0.68)/0.24                                               <a name='5567'>
            ELSE                                                                 <a name='5568'>
               JS = JS + 2                                                       <a name='5569'>
               FS = (FS-0.92)/0.08                                               <a name='5570'>
            ENDIF                                                                <a name='5571'>
         ELSEIF (JS .EQ.9) THEN                                                  <a name='5572'>
            JS = 10                                                              <a name='5573'>
            FS = 1.                                                              <a name='5574'>
            JFRAC = 8                                                            <a name='5575'>
            FFRAC = 1.                                                           <a name='5576'>
         ENDIF                                                                   <a name='5577'>
         FP = FAC01(LAY) + FAC11(LAY)                                            <a name='5578'>
         NS = JS + INT(FS + 0.5)                                                 <a name='5579'>
         FAC000 = (1. - FS) * FAC00(LAY)                                         <a name='5580'>
         FAC010 = (1. - FS) * FAC10(LAY)                                         <a name='5581'>
         FAC100 = FS * FAC00(LAY)                                                <a name='5582'>
         FAC110 = FS * FAC10(LAY)                                                <a name='5583'>
         FAC001 = (1. - FS) * FAC01(LAY)                                         <a name='5584'>
         FAC011 = (1. - FS) * FAC11(LAY)                                         <a name='5585'>
         FAC101 = FS * FAC01(LAY)                                                <a name='5586'>
         FAC111 = FS * FAC11(LAY)                                                <a name='5587'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(9) + JS                         <a name='5588'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(9) + JS                            <a name='5589'>
         INDS = INDSELF(LAY)                                                     <a name='5590'>
         IF (LAY .EQ. LAYLOW) IOFF = NG9                                         <a name='5591'>
         IF (LAY .EQ. LAYSWTCH) IOFF = 2*NG9                                     <a name='5592'>
         COLREF1 = N2OREF(JP(LAY))                                               <a name='5593'>
         COLREF2 = N2OREF(JP(LAY)+1)                                             <a name='5594'>
         IF (NS .EQ. 11) THEN                                                    <a name='5595'>
            WCOMB1 = H2OREF(JP(LAY))                                             <a name='5596'>
            WCOMB2 = H2OREF(JP(LAY)+1)                                           <a name='5597'>
         ELSE                                                                    <a name='5598'>
            WCOMB1 = STRRAT * CH4REF(JP(LAY))/(1.-ETAREF(NS))                    <a name='5599'>
            WCOMB2 = STRRAT * CH4REF(JP(LAY)+1)/(1.-ETAREF(NS))                  <a name='5600'>
         ENDIF                                                                   <a name='5601'>
         RATIO = (COLREF1/WCOMB1)+FP*((COLREF2/WCOMB2)-(COLREF1/WCOMB1))         <a name='5602'>
         CURRN2O = SPECCOMB * RATIO                                              <a name='5603'>
         N2OMULT = COLN2O(LAY) - CURRN2O                                         <a name='5604'>
         DO 2000 IG = 1, NG9                                                     <a name='5605'>
            TAUG(NGS8+IG,LAY) = SPECCOMB *                      &amp;<a name='5606'>
                (FAC000 * ABSA9(IND0,IG) +                      &amp;                 <a name='5607'>
                 FAC100 * ABSA9(IND0+1,IG) +                    &amp;                 <a name='5608'>
                 FAC010 * ABSA9(IND0+11,IG) +                   &amp;                 <a name='5609'>
                 FAC110 * ABSA9(IND0+12,IG) +                   &amp;                 <a name='5610'>
                 FAC001 * ABSA9(IND1,IG) +                      &amp;                 <a name='5611'>
                 FAC101 * ABSA9(IND1+1,IG) +                    &amp;                 <a name='5612'>
                 FAC011 * ABSA9(IND1+11,IG) +                   &amp;                 <a name='5613'>
                 FAC111 * ABSA9(IND1+12,IG)) +                  &amp;                 <a name='5614'>
                 COLH2O(LAY) *                                  &amp;                 <a name='5615'>
                 SELFFAC(LAY) * (SELFREFC9(INDS,IG) +           &amp;                 <a name='5616'>
                 SELFFRAC(LAY) *                                &amp;                 <a name='5617'>
                 (SELFREFC9(INDS+1,IG) - SELFREFC9(INDS,IG)))   &amp; <a name='5618'>
                 + N2OMULT * ABSN2OC9(IG+IOFF)                                     <a name='5619'>
            PFRAC(NGS8+IG,LAY) = FRACREFAC9(IG,JFRAC) + FFRAC *  &amp;                 <a name='5620'>
                 (FRACREFAC9(IG,JFRAC+1) - FRACREFAC9(IG,JFRAC))                     <a name='5621'>
 2000    CONTINUE                                                                <a name='5622'>
 2500 CONTINUE                                                                   <a name='5623'>
                                                                                 <a name='5624'>
<font color=#447700>!cdir novector<a name='5625'></font>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='5626'>
         IND0 = ((JP(LAY)-13)*5+(JT(LAY)-1))*NSPB(9) + 1                         <a name='5627'>
         IND1 = ((JP(LAY)-12)*5+(JT1(LAY)-1))*NSPB(9) + 1                        <a name='5628'>
         DO 3000 IG = 1, NG9                                                     <a name='5629'>
            TAUG(NGS8+IG,LAY) = COLCH4(LAY) *                  &amp;                 <a name='5630'>
                (FAC00(LAY) * ABSB9(IND0,IG) +                  &amp;                 <a name='5631'>
                 FAC10(LAY) * ABSB9(IND0+1,IG) +                &amp;                 <a name='5632'>
                 FAC01(LAY) * ABSB9(IND1,IG) +                  &amp;                 <a name='5633'>
                 FAC11(LAY) * ABSB9(IND1+1,IG))                                   <a name='5634'>
            PFRAC(NGS8+IG,LAY) = FRACREFBC9(IG)                                    <a name='5635'>
 3000    CONTINUE                                                                <a name='5636'>
 3500 CONTINUE                                                                   <a name='5637'>
                                                                                 <a name='5638'>
      END SUBROUTINE TAUGB9<a name='5639'>
                                                                                 <a name='5640'>
<font color=#447700>!--------------------------------------------------------------------------------    <a name='5641'></font>
<A NAME='TAUGB10'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB10' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5642'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB10</font>(kts,ktep1,COLH2O,FAC00,FAC01,FAC10,FAC11,JP,JT,JT1,    &amp; <A href='../../call_to/TAUGB10.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB10.html' TARGET='index'>2</A><a name='5643'>
                         PFRAC,TAUG,LAYTROP                                     )<a name='5644'>
<font color=#447700>!--------------------------------------------------------------------------------    <a name='5645'></font>
                                                                                 <a name='5646'>
<font color=#447700>!     BAND 10:  1390-1480 cm-1 (low - H2O; high - H2O)                           <a name='5647'></font>
                                                                                 <a name='5648'>
      INTEGER, PARAMETER :: NGS9=108                                     <a name='5649'>
                                                                                 <a name='5650'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='5651'>
<a name='5652'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='5653'>
<a name='5654'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='5655'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='5656'>
                                                      TAUG<a name='5657'>
<a name='5658'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='5659'>
                                                    COLH2O, &amp;<a name='5660'>
                                                     FAC00, &amp;<a name='5661'>
                                                     FAC01, &amp;<a name='5662'>
                                                     FAC10, &amp;<a name='5663'>
                                                     FAC11<a name='5664'>
 <a name='5665'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='5666'>
                                                        JP, &amp;<a name='5667'>
                                                        JT, &amp;<a name='5668'>
                                                       JT1<a name='5669'>
<a name='5670'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='5671'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='5672'></font>
<font color=#447700>! carry constants.                                                               <a name='5673'></font>
                                                                                 <a name='5674'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure) and             <a name='5675'></font>
<font color=#447700>!     temperature.                                                               <a name='5676'></font>
<font color=#447700>!cdir novector<a name='5677'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='5678'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(10) + 1                         <a name='5679'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(10) + 1                            <a name='5680'>
         DO 2000 IG = 1, NG10                                                    <a name='5681'>
            TAUG(NGS9+IG,LAY) = COLH2O(LAY) *          &amp;<a name='5682'>
                (FAC00(LAY) * ABSA10(IND0,IG) +        &amp;                           <a name='5683'>
                 FAC10(LAY) * ABSA10(IND0+1,IG) +      &amp;                           <a name='5684'>
                 FAC01(LAY) * ABSA10(IND1,IG) +        &amp;                           <a name='5685'>
                 FAC11(LAY) * ABSA10(IND1+1,IG))                                   <a name='5686'>
            PFRAC(NGS9+IG,LAY) = FRACREFAC10(IG)                                    <a name='5687'>
 2000    CONTINUE                                                                <a name='5688'>
 2500 CONTINUE                                                                   <a name='5689'>
                                                                                 <a name='5690'>
<font color=#447700>!cdir novector<a name='5691'></font>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='5692'>
         IND0 = ((JP(LAY)-13)*5+(JT(LAY)-1))*NSPB(10) + 1                        <a name='5693'>
         IND1 = ((JP(LAY)-12)*5+(JT1(LAY)-1))*NSPB(10) + 1                       <a name='5694'>
         DO 3000 IG = 1, NG10                                                    <a name='5695'>
            TAUG(NGS9+IG,LAY) = COLH2O(LAY) *        &amp;<a name='5696'>
                (FAC00(LAY) * ABSB10(IND0,IG) +        &amp;                           <a name='5697'>
                 FAC10(LAY) * ABSB10(IND0+1,IG) +      &amp;                           <a name='5698'>
                 FAC01(LAY) * ABSB10(IND1,IG) +        &amp;                           <a name='5699'>
                 FAC11(LAY) * ABSB10(IND1+1,IG))                                   <a name='5700'>
            PFRAC(NGS9+IG,LAY) = FRACREFBC10(IG)                                    <a name='5701'>
 3000    CONTINUE                                                                <a name='5702'>
 3500 CONTINUE                                                                   <a name='5703'>
                                                                                 <a name='5704'>
      END SUBROUTINE TAUGB10<a name='5705'>
                                                                                 <a name='5706'>
<font color=#447700>!--------------------------------------------------------------------------    <a name='5707'></font>
<A NAME='TAUGB11'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB11' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5708'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB11</font>(kts,ktep1,COLH2O,FAC00,FAC01,FAC10,FAC11,        &amp; <A href='../../call_to/TAUGB11.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB11.html' TARGET='index'>2</A><a name='5709'>
                         SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,   &amp;<a name='5710'>
                         LAYTROP                                          )<a name='5711'>
<font color=#447700>!--------------------------------------------------------------------------    <a name='5712'></font>
                                                                                 <a name='5713'>
<font color=#447700>!     BAND 11:  1480-1800 cm-1 (low - H2O; high - H2O)                           <a name='5714'></font>
                                                                                 <a name='5715'>
      INTEGER, PARAMETER :: NGS10=114                                    <a name='5716'>
                                                                                 <a name='5717'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='5718'>
<a name='5719'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='5720'>
<a name='5721'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='5722'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='5723'>
                                                      TAUG<a name='5724'>
<a name='5725'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='5726'>
                                                    COLH2O, &amp;<a name='5727'>
                                                     FAC00, &amp;<a name='5728'>
                                                     FAC01, &amp;<a name='5729'>
                                                     FAC10, &amp;<a name='5730'>
                                                     FAC11, &amp;<a name='5731'>
                                                   SELFFAC, &amp;<a name='5732'>
                                                  SELFFRAC <a name='5733'>
 <a name='5734'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='5735'>
                                                        JP, &amp;<a name='5736'>
                                                        JT, &amp;<a name='5737'>
                                                       JT1, &amp;<a name='5738'>
                                                   INDSELF<a name='5739'>
<a name='5740'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='5741'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='5742'></font>
<font color=#447700>! carry constants.                                                               <a name='5743'></font>
                                                                                 <a name='5744'>
<a name='5745'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure) and             <a name='5746'></font>
<font color=#447700>!     temperature.  Below LAYTROP, the water vapor self-continuum                <a name='5747'></font>
<font color=#447700>!     is interpolated (in temperature) separately.                               <a name='5748'></font>
<font color=#447700>!cdir novector<a name='5749'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='5750'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(11) + 1                         <a name='5751'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(11) + 1                            <a name='5752'>
         INDS = INDSELF(LAY)                                                     <a name='5753'>
         DO 2000 IG = 1, NG11                                                    <a name='5754'>
            TAUG(NGS10+IG,LAY) = COLH2O(LAY) *                 &amp;                   <a name='5755'>
                (FAC00(LAY) * ABSA11(IND0,IG) +                &amp;                   <a name='5756'>
                 FAC10(LAY) * ABSA11(IND0+1,IG) +              &amp;                   <a name='5757'>
                 FAC01(LAY) * ABSA11(IND1,IG) +                &amp;                   <a name='5758'>
                 FAC11(LAY) * ABSA11(IND1+1,IG) +              &amp;                   <a name='5759'>
                 SELFFAC(LAY) * (SELFREFC11(INDS,IG) +         &amp; <a name='5760'>
                 SELFFRAC(LAY) *                               &amp;                   <a name='5761'>
                 (SELFREFC11(INDS+1,IG) - SELFREFC11(INDS,IG))))                       <a name='5762'>
            PFRAC(NGS10+IG,LAY) = FRACREFAC11(IG)                                   <a name='5763'>
 2000    CONTINUE                                                                <a name='5764'>
 2500 CONTINUE                                                                   <a name='5765'>
                                                                                 <a name='5766'>
<font color=#447700>!cdir novector<a name='5767'></font>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='5768'>
         IND0 = ((JP(LAY)-13)*5+(JT(LAY)-1))*NSPB(11) + 1                        <a name='5769'>
         IND1 = ((JP(LAY)-12)*5+(JT1(LAY)-1))*NSPB(11) + 1                       <a name='5770'>
         DO 3000 IG = 1, NG11                                                    <a name='5771'>
            TAUG(NGS10+IG,LAY) = COLH2O(LAY) *               &amp;                   <a name='5772'>
                (FAC00(LAY) * ABSB11(IND0,IG) +                &amp;                   <a name='5773'>
                 FAC10(LAY) * ABSB11(IND0+1,IG) +              &amp;                   <a name='5774'>
                 FAC01(LAY) * ABSB11(IND1,IG) +                &amp;                   <a name='5775'>
                 FAC11(LAY) * ABSB11(IND1+1,IG))                                   <a name='5776'>
            PFRAC(NGS10+IG,LAY) = FRACREFBC11(IG)                                   <a name='5777'>
 3000    CONTINUE                                                                <a name='5778'>
 3500 CONTINUE                                                                   <a name='5779'>
                                                                                 <a name='5780'>
      END SUBROUTINE TAUGB11<a name='5781'>
                                                                                 <a name='5782'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='5783'></font>
<A NAME='TAUGB12'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB12' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5784'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB12</font>(kts,ktep1,COLH2O,COLCO2,FAC00,FAC01,FAC10,FAC11,    &amp; <A href='../../call_to/TAUGB12.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB12.html' TARGET='index'>3</A><a name='5785'>
                         SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,      &amp;<a name='5786'>
                         LAYTROP                                             )<a name='5787'>
<font color=#447700>!-----------------------------------------------------------------------------   <a name='5788'></font>
                                                                                 <a name='5789'>
<font color=#447700>!     BAND 12:  1800-2080 cm-1 (low - H2O,CO2; high - nothing)                   <a name='5790'></font>
                                                                                 <a name='5791'>
      INTEGER, PARAMETER :: NGS11=122                                    <a name='5792'>
                                                                                 <a name='5793'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='5794'>
<a name='5795'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='5796'>
<a name='5797'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='5798'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='5799'>
                                                      TAUG<a name='5800'>
<a name='5801'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='5802'>
                                                    COLH2O, &amp;<a name='5803'>
                                                    COLCO2, &amp;<a name='5804'>
                                                     FAC00, &amp;<a name='5805'>
                                                     FAC01, &amp;<a name='5806'>
                                                     FAC10, &amp;<a name='5807'>
                                                     FAC11, &amp;<a name='5808'>
                                                   SELFFAC, &amp;<a name='5809'>
                                                  SELFFRAC <a name='5810'>
 <a name='5811'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='5812'>
                                                        JP, &amp;<a name='5813'>
                                                        JT, &amp;<a name='5814'>
                                                       JT1, &amp;<a name='5815'>
                                                   INDSELF<a name='5816'>
<a name='5817'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='5818'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='5819'></font>
<font color=#447700>! carry constants.                                                               <a name='5820'></font>
                                                                                 <a name='5821'>
      STRRAT1 = 0.009736757                                                      <a name='5822'>
                                                                                 <a name='5823'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure),                <a name='5824'></font>
<font color=#447700>!     temperature, and appropriate species.  Below LAYTROP, the water            <a name='5825'></font>
<font color=#447700>!     vapor self-continuum is interpolated (in temperature) separately.          <a name='5826'></font>
<font color=#447700>!!DIR$ NOVECTOR                                                                   <a name='5827'></font>
<font color=#447700>!cdir novector<a name='5828'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='5829'>
         SPECCOMB = COLH2O(LAY) + STRRAT1*COLCO2(LAY)                            <a name='5830'>
         SPECPARM = COLH2O(LAY)/SPECCOMB                                         <a name='5831'>
         IF (SPECPARM .GE. ONEMINUS) SPECPARM = ONEMINUS                         <a name='5832'>
         SPECMULT = 8.*(SPECPARM)                                                <a name='5833'>
         JS = 1 + INT(SPECMULT)                                                  <a name='5834'>
         FS = MOD(SPECMULT,1.0)                                                 <a name='5835'>
         FAC000 = (1. - FS) * FAC00(LAY)                                         <a name='5836'>
         FAC010 = (1. - FS) * FAC10(LAY)                                         <a name='5837'>
         FAC100 = FS * FAC00(LAY)                                                <a name='5838'>
         FAC110 = FS * FAC10(LAY)                                                <a name='5839'>
         FAC001 = (1. - FS) * FAC01(LAY)                                         <a name='5840'>
         FAC011 = (1. - FS) * FAC11(LAY)                                         <a name='5841'>
         FAC101 = FS * FAC01(LAY)                                                <a name='5842'>
         FAC111 = FS * FAC11(LAY)                                                <a name='5843'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(12) + JS                        <a name='5844'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(12) + JS                           <a name='5845'>
         INDS = INDSELF(LAY)                                                     <a name='5846'>
<font color=#447700>!!DIR$ VECTOR                                                                     <a name='5847'></font>
         DO 2000 IG = 1, NG12                                                    <a name='5848'>
            TAUG(NGS11+IG,LAY) = SPECCOMB *             &amp; <a name='5849'>
                (FAC000 * ABSA12(IND0,IG) +             &amp;                          <a name='5850'>
                 FAC100 * ABSA12(IND0+1,IG) +           &amp;                          <a name='5851'>
                 FAC010 * ABSA12(IND0+9,IG) +           &amp;                          <a name='5852'>
                 FAC110 * ABSA12(IND0+10,IG) +          &amp;                          <a name='5853'>
                 FAC001 * ABSA12(IND1,IG) +             &amp;                          <a name='5854'>
                 FAC101 * ABSA12(IND1+1,IG) +           &amp;                          <a name='5855'>
                 FAC011 * ABSA12(IND1+9,IG) +           &amp;                          <a name='5856'>
                 FAC111 * ABSA12(IND1+10,IG)) +         &amp;                          <a name='5857'>
                 COLH2O(LAY) *                          &amp;                          <a name='5858'>
                 SELFFAC(LAY) * (SELFREFC12(INDS,IG) +  &amp;                          <a name='5859'>
                 SELFFRAC(LAY) *                        &amp;                          <a name='5860'>
                 (SELFREFC12(INDS+1,IG) - SELFREFC12(INDS,IG)))                        <a name='5861'>
            PFRAC(NGS11+IG,LAY) = FRACREFAC12(IG,JS) + FS *  &amp; <a name='5862'>
                 (FRACREFAC12(IG,JS+1) - FRACREFAC12(IG,JS))                           <a name='5863'>
 2000    CONTINUE                                                                <a name='5864'>
 2500 CONTINUE                                                                   <a name='5865'>
                                                                                 <a name='5866'>
<font color=#447700>!cdir novector<a name='5867'></font>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='5868'>
         DO 3000 IG = 1, NG12                                                    <a name='5869'>
            TAUG(NGS11+IG,LAY) = 0.0                                             <a name='5870'>
            PFRAC(NGS11+IG,LAY) = 0.0                                            <a name='5871'>
 3000    CONTINUE                                                                <a name='5872'>
 3500 CONTINUE                                                                   <a name='5873'>
                                                                                 <a name='5874'>
      END SUBROUTINE TAUGB12<a name='5875'>
                                                                                 <a name='5876'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='5877'></font>
<A NAME='TAUGB13'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB13' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5878'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB13</font>(kts,ktep1,COLH2O,COLN2O,FAC00,FAC01,FAC10,FAC11,    &amp; <A href='../../call_to/TAUGB13.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB13.html' TARGET='index'>3</A><a name='5879'>
                         SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,      &amp;<a name='5880'>
                         LAYTROP                                             )<a name='5881'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='5882'></font>
                                                                                 <a name='5883'>
<font color=#447700>!     BAND 13:  2080-2250 cm-1 (low - H2O,N2O; high - nothing)                   <a name='5884'></font>
                                                                                 <a name='5885'>
      INTEGER, PARAMETER :: NGS12=130                                    <a name='5886'>
                                                                                 <a name='5887'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='5888'>
<a name='5889'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='5890'>
<a name='5891'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='5892'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='5893'>
                                                      TAUG<a name='5894'>
<a name='5895'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='5896'>
                                                    COLH2O, &amp;<a name='5897'>
                                                    COLN2O, &amp;<a name='5898'>
                                                     FAC00, &amp;<a name='5899'>
                                                     FAC01, &amp;<a name='5900'>
                                                     FAC10, &amp;<a name='5901'>
                                                     FAC11, &amp;<a name='5902'>
                                                   SELFFAC, &amp;<a name='5903'>
                                                  SELFFRAC <a name='5904'>
 <a name='5905'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='5906'>
                                                        JP, &amp;<a name='5907'>
                                                        JT, &amp;<a name='5908'>
                                                       JT1, &amp;<a name='5909'>
                                                   INDSELF<a name='5910'>
<a name='5911'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='5912'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='5913'></font>
<font color=#447700>! carry constants.                                                               <a name='5914'></font>
                                                                                 <a name='5915'>
      STRRAT1 = 16658.87                                                         <a name='5916'>
                                                                                 <a name='5917'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure),                <a name='5918'></font>
<font color=#447700>!     temperature, and appropriate species.  Below LAYTROP, the water            <a name='5919'></font>
<font color=#447700>!     vapor self-continuum is interpolated (in temperature) separately.          <a name='5920'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='5921'>
         SPECCOMB = COLH2O(LAY) + STRRAT1*COLN2O(LAY)                            <a name='5922'>
         SPECPARM = COLH2O(LAY)/SPECCOMB                                         <a name='5923'>
         IF (SPECPARM .GE. ONEMINUS) SPECPARM = ONEMINUS                         <a name='5924'>
         SPECMULT = 8.*(SPECPARM)                                                <a name='5925'>
         JS = 1 + INT(SPECMULT)                                                  <a name='5926'>
         FS = MOD(SPECMULT,1.0)                                                 <a name='5927'>
         FAC000 = (1. - FS) * FAC00(LAY)                                         <a name='5928'>
         FAC010 = (1. - FS) * FAC10(LAY)                                         <a name='5929'>
         FAC100 = FS * FAC00(LAY)                                                <a name='5930'>
         FAC110 = FS * FAC10(LAY)                                                <a name='5931'>
         FAC001 = (1. - FS) * FAC01(LAY)                                         <a name='5932'>
         FAC011 = (1. - FS) * FAC11(LAY)                                         <a name='5933'>
         FAC101 = FS * FAC01(LAY)                                                <a name='5934'>
         FAC111 = FS * FAC11(LAY)                                                <a name='5935'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(13) + JS                        <a name='5936'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(13) + JS                           <a name='5937'>
         INDS = INDSELF(LAY)                                                     <a name='5938'>
         DO 2000 IG = 1, NG13                                                    <a name='5939'>
            TAUG(NGS12+IG,LAY) = SPECCOMB *                &amp;                       <a name='5940'>
                (FAC000 * ABSA13(IND0,IG) +                &amp;                       <a name='5941'>
                 FAC100 * ABSA13(IND0+1,IG) +              &amp;                       <a name='5942'>
                 FAC010 * ABSA13(IND0+9,IG) +              &amp;                       <a name='5943'>
                 FAC110 * ABSA13(IND0+10,IG) +             &amp;                       <a name='5944'>
                 FAC001 * ABSA13(IND1,IG) +                &amp;                       <a name='5945'>
                 FAC101 * ABSA13(IND1+1,IG) +              &amp;                       <a name='5946'>
                 FAC011 * ABSA13(IND1+9,IG) +              &amp;                       <a name='5947'>
                 FAC111 * ABSA13(IND1+10,IG)) +            &amp;                       <a name='5948'>
                 COLH2O(LAY) *                           &amp;                       <a name='5949'>
                 SELFFAC(LAY) * (SELFREFC13(INDS,IG) +      &amp;                       <a name='5950'>
                 SELFFRAC(LAY) *                         &amp;                       <a name='5951'>
                 (SELFREFC13(INDS+1,IG) - SELFREFC13(INDS,IG)))                        <a name='5952'>
            PFRAC(NGS12+IG,LAY) = FRACREFAC13(IG,JS) + FS * &amp;                       <a name='5953'>
                 (FRACREFAC13(IG,JS+1) - FRACREFAC13(IG,JS))                           <a name='5954'>
 2000    CONTINUE                                                                <a name='5955'>
 2500 CONTINUE                                                                   <a name='5956'>
                                                                                 <a name='5957'>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='5958'>
         DO 3000 IG = 1, NG13                                                    <a name='5959'>
            TAUG(NGS12+IG,LAY) = 0.0                                             <a name='5960'>
            PFRAC(NGS12+IG,LAY) = 0.0                                            <a name='5961'>
 3000    CONTINUE                                                                <a name='5962'>
 3500 CONTINUE                                                                   <a name='5963'>
                                                                                 <a name='5964'>
<a name='5965'>
      END SUBROUTINE TAUGB13<a name='5966'>
                                                                                 <a name='5967'>
<font color=#447700>!----------------------------------------------------------------------------    <a name='5968'></font>
<A NAME='TAUGB14'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB14' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5969'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB14</font>(kts,ktep1,COLCO2,FAC00,FAC01,FAC10,FAC11,          &amp; <A href='../../call_to/TAUGB14.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB14.html' TARGET='index'>2</A><a name='5970'>
                         SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,     &amp;<a name='5971'>
                         LAYTROP                                            )<a name='5972'>
<font color=#447700>!----------------------------------------------------------------------------    <a name='5973'></font>
                                                                                 <a name='5974'>
<font color=#447700>!     BAND 14:  2250-2380 cm-1 (low - CO2; high - CO2)                           <a name='5975'></font>
                                                                                 <a name='5976'>
      INTEGER, PARAMETER :: NGS13=134                                    <a name='5977'>
                                                                                 <a name='5978'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='5979'>
<a name='5980'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='5981'>
<a name='5982'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='5983'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='5984'>
                                                      TAUG<a name='5985'>
<a name='5986'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='5987'>
                                                    COLCO2, &amp;<a name='5988'>
                                                     FAC00, &amp;<a name='5989'>
                                                     FAC01, &amp;<a name='5990'>
                                                     FAC10, &amp;<a name='5991'>
                                                     FAC11, &amp;<a name='5992'>
                                                   SELFFAC, &amp;<a name='5993'>
                                                  SELFFRAC <a name='5994'>
 <a name='5995'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='5996'>
                                                        JP, &amp;<a name='5997'>
                                                        JT, &amp;<a name='5998'>
                                                       JT1, &amp;<a name='5999'>
                                                   INDSELF<a name='6000'>
<a name='6001'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='6002'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='6003'></font>
<font color=#447700>! carry constants.                                                               <a name='6004'></font>
                                                                                 <a name='6005'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure) and             <a name='6006'></font>
<font color=#447700>!     temperature.  Below LAYTROP, the water vapor self-continuum                <a name='6007'></font>
<font color=#447700>!     is interpolated (in temperature) separately.                               <a name='6008'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='6009'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(14) + 1                         <a name='6010'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(14) + 1                            <a name='6011'>
         INDS = INDSELF(LAY)                                                     <a name='6012'>
         DO 2000 IG = 1, NG14                                                    <a name='6013'>
            TAUG(NGS13+IG,LAY) = COLCO2(LAY) *           &amp;<a name='6014'>
                (FAC00(LAY) * ABSA14(IND0,IG) +          &amp;                         <a name='6015'>
                 FAC10(LAY) * ABSA14(IND0+1,IG) +        &amp;                         <a name='6016'>
                 FAC01(LAY) * ABSA14(IND1,IG) +          &amp;                         <a name='6017'>
                 FAC11(LAY) * ABSA14(IND1+1,IG) +        &amp;                         <a name='6018'>
                 SELFFAC(LAY) * (SELFREFC14(INDS,IG) +   &amp;                         <a name='6019'>
                 SELFFRAC(LAY) *                         &amp;                         <a name='6020'>
                 (SELFREFC14(INDS+1,IG) - SELFREFC14(INDS,IG))))                       <a name='6021'>
            PFRAC(NGS13+IG,LAY) = FRACREFAC14(IG)                                   <a name='6022'>
 2000    CONTINUE                                                                <a name='6023'>
 2500 CONTINUE                                                                   <a name='6024'>
                                                                                 <a name='6025'>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='6026'>
         IND0 = ((JP(LAY)-13)*5+(JT(LAY)-1))*NSPB(14) + 1                        <a name='6027'>
         IND1 = ((JP(LAY)-12)*5+(JT1(LAY)-1))*NSPB(14) + 1                       <a name='6028'>
         DO 3000 IG = 1, NG14                                                    <a name='6029'>
            TAUG(NGS13+IG,LAY) = COLCO2(LAY) *       &amp;                           <a name='6030'>
                (FAC00(LAY) * ABSB14(IND0,IG) +        &amp;                           <a name='6031'>
                 FAC10(LAY) * ABSB14(IND0+1,IG) +      &amp;                           <a name='6032'>
                 FAC01(LAY) * ABSB14(IND1,IG) +        &amp;                           <a name='6033'>
                 FAC11(LAY) * ABSB14(IND1+1,IG))                                   <a name='6034'>
            PFRAC(NGS13+IG,LAY) = FRACREFBC14(IG)                                   <a name='6035'>
 3000    CONTINUE                                                                <a name='6036'>
 3500 CONTINUE                                                                   <a name='6037'>
                                                                                 <a name='6038'>
      END SUBROUTINE TAUGB14<a name='6039'>
                                                                                 <a name='6040'>
<font color=#447700>!------------------------------------------------------------------------------    <a name='6041'></font>
<A NAME='TAUGB15'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB15' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6042'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB15</font>(kts,ktep1,COLH2O,COLCO2,COLN2O,FAC00,FAC01,FAC10,    &amp; <A href='../../call_to/TAUGB15.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB15.html' TARGET='index'>3</A><a name='6043'>
                         FAC11,SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,            &amp;<a name='6044'>
                         PFRAC,TAUG,LAYTROP                                   )<a name='6045'>
<font color=#447700>!------------------------------------------------------------------------------    <a name='6046'></font>
                                                                                 <a name='6047'>
<font color=#447700>!     BAND 15:  2380-2600 cm-1 (low - N2O,CO2; high - nothing)                   <a name='6048'></font>
                                                                                 <a name='6049'>
      INTEGER, PARAMETER :: NGS14=136                                    <a name='6050'>
                                                                                 <a name='6051'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='6052'>
<a name='6053'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='6054'>
<a name='6055'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='6056'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='6057'>
                                                      TAUG<a name='6058'>
<a name='6059'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='6060'>
                                                    COLH2O, &amp;<a name='6061'>
                                                    COLCO2, &amp;<a name='6062'>
                                                    COLN2O, &amp;<a name='6063'>
                                                     FAC00, &amp;<a name='6064'>
                                                     FAC01, &amp;<a name='6065'>
                                                     FAC10, &amp;<a name='6066'>
                                                     FAC11, &amp;<a name='6067'>
                                                   SELFFAC, &amp;<a name='6068'>
                                                  SELFFRAC <a name='6069'>
 <a name='6070'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='6071'>
                                                        JP, &amp;<a name='6072'>
                                                        JT, &amp;<a name='6073'>
                                                       JT1, &amp;<a name='6074'>
                                                   INDSELF<a name='6075'>
<a name='6076'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='6077'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='6078'></font>
<font color=#447700>! carry constants.                                                               <a name='6079'></font>
                                                                                 <a name='6080'>
      STRRAT1 = 0.2883201                                                        <a name='6081'>
                                                                                 <a name='6082'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure),                <a name='6083'></font>
<font color=#447700>!     temperature, and appropriate species.  Below LAYTROP, the water            <a name='6084'></font>
<font color=#447700>!     vapor self-continuum is interpolated (in temperature) separately.          <a name='6085'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='6086'>
         SPECCOMB = COLN2O(LAY) + STRRAT1*COLCO2(LAY)                            <a name='6087'>
         SPECPARM = COLN2O(LAY)/SPECCOMB                                         <a name='6088'>
         IF (SPECPARM .GE. ONEMINUS) SPECPARM = ONEMINUS                         <a name='6089'>
         SPECMULT = 8.*(SPECPARM)                                                <a name='6090'>
         JS = 1 + INT(SPECMULT)                                                  <a name='6091'>
         FS = MOD(SPECMULT,1.0)                                                 <a name='6092'>
         FAC000 = (1. - FS) * FAC00(LAY)                                         <a name='6093'>
         FAC010 = (1. - FS) * FAC10(LAY)                                         <a name='6094'>
         FAC100 = FS * FAC00(LAY)                                                <a name='6095'>
         FAC110 = FS * FAC10(LAY)                                                <a name='6096'>
         FAC001 = (1. - FS) * FAC01(LAY)                                         <a name='6097'>
         FAC011 = (1. - FS) * FAC11(LAY)                                         <a name='6098'>
         FAC101 = FS * FAC01(LAY)                                                <a name='6099'>
         FAC111 = FS * FAC11(LAY)                                                <a name='6100'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(15) + JS                        <a name='6101'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(15) + JS                           <a name='6102'>
         INDS = INDSELF(LAY)                                                     <a name='6103'>
         DO 2000 IG = 1, NG15                                                    <a name='6104'>
            TAUG(NGS14+IG,LAY) = SPECCOMB *                     &amp;                  <a name='6105'>
                (FAC000 * ABSA15(IND0,IG) +                     &amp;                  <a name='6106'>
                 FAC100 * ABSA15(IND0+1,IG) +                   &amp;                  <a name='6107'>
                 FAC010 * ABSA15(IND0+9,IG) +                   &amp;                  <a name='6108'>
                 FAC110 * ABSA15(IND0+10,IG) +                  &amp;                  <a name='6109'>
                 FAC001 * ABSA15(IND1,IG) +                     &amp;                  <a name='6110'>
                 FAC101 * ABSA15(IND1+1,IG) +                   &amp;                  <a name='6111'>
                 FAC011 * ABSA15(IND1+9,IG) +                   &amp;                  <a name='6112'>
                 FAC111 * ABSA15(IND1+10,IG)) +                 &amp;                  <a name='6113'>
                 COLH2O(LAY) *                                &amp;                  <a name='6114'>
                 SELFFAC(LAY) * (SELFREFC15(INDS,IG) +           &amp;                  <a name='6115'>
                 SELFFRAC(LAY) *                              &amp;                  <a name='6116'>
                 (SELFREFC15(INDS+1,IG) - SELFREFC15(INDS,IG)))                        <a name='6117'>
            PFRAC(NGS14+IG,LAY) = FRACREFAC15(IG,JS) + FS *      &amp;                  <a name='6118'>
                 (FRACREFAC15(IG,JS+1) - FRACREFAC15(IG,JS))                           <a name='6119'>
 2000    CONTINUE                                                                <a name='6120'>
 2500 CONTINUE                                                                   <a name='6121'>
                                                                                 <a name='6122'>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='6123'>
         DO 3000 IG = 1, NG15                                                    <a name='6124'>
            TAUG(NGS14+IG,LAY) = 0.0                                             <a name='6125'>
            PFRAC(NGS14+IG,LAY) = 0.0                                            <a name='6126'>
 3000    CONTINUE                                                                <a name='6127'>
 3500 CONTINUE                                                                   <a name='6128'>
                                                                                 <a name='6129'>
      END SUBROUTINE TAUGB15<a name='6130'>
                                                                                 <a name='6131'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='6132'></font>
<A NAME='TAUGB16'><A href='../../html_code/phys/module_ra_rrtm.F.html#TAUGB16' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6133'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>TAUGB16</font>(kts,ktep1,COLH2O,COLCH4,FAC00,FAC01,FAC10,FAC11,    &amp; <A href='../../call_to/TAUGB16.html' TARGET='index'>2</A>,<A href='../../call_from/TAUGB16.html' TARGET='index'>3</A><a name='6134'>
                         SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,      &amp;<a name='6135'>
                         LAYTROP                                             )<a name='6136'>
<font color=#447700>!-----------------------------------------------------------------------------    <a name='6137'></font>
                                                                                 <a name='6138'>
<font color=#447700>!     BAND 16:  2600-3000 cm-1 (low - H2O,CH4; high - nothing)                   <a name='6139'></font>
                                                                                 <a name='6140'>
      INTEGER, PARAMETER :: NGS15=138                                    <a name='6141'>
                                                                                 <a name='6142'>
      INTEGER, INTENT(IN )                      :: kts,ktep1<a name='6143'>
<a name='6144'>
      INTEGER, INTENT(IN )                      ::  LAYTROP<a name='6145'>
<a name='6146'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                    &amp;<a name='6147'>
            INTENT(INOUT)        ::                  PFRAC, &amp;<a name='6148'>
                                                      TAUG<a name='6149'>
<a name='6150'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::        &amp;<a name='6151'>
                                                    COLH2O, &amp;<a name='6152'>
                                                    COLCH4, &amp;<a name='6153'>
                                                     FAC00, &amp;<a name='6154'>
                                                     FAC01, &amp;<a name='6155'>
                                                     FAC10, &amp;<a name='6156'>
                                                     FAC11, &amp;<a name='6157'>
                                                   SELFFAC, &amp;<a name='6158'>
                                                  SELFFRAC <a name='6159'>
 <a name='6160'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::     &amp;<a name='6161'>
                                                        JP, &amp;<a name='6162'>
                                                        JT, &amp;<a name='6163'>
                                                       JT1, &amp;<a name='6164'>
                                                   INDSELF<a name='6165'>
<a name='6166'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='6167'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='6168'></font>
<font color=#447700>! carry constants.                                                               <a name='6169'></font>
                                                                                 <a name='6170'>
      STRRAT1 = 830.411                                                          <a name='6171'>
                                                                                 <a name='6172'>
<font color=#447700>!     Compute the optical depth by interpolating in ln(pressure),                <a name='6173'></font>
<font color=#447700>!     temperature, and appropriate species.  Below LAYTROP, the water            <a name='6174'></font>
<font color=#447700>!     vapor self-continuum is interpolated (in temperature) separately.          <a name='6175'></font>
      DO 2500 LAY = 1, LAYTROP                                                   <a name='6176'>
         SPECCOMB = COLH2O(LAY) + STRRAT1*COLCH4(LAY)                            <a name='6177'>
         SPECPARM = COLH2O(LAY)/SPECCOMB                                         <a name='6178'>
         IF (SPECPARM .GE. ONEMINUS) SPECPARM = ONEMINUS                         <a name='6179'>
         SPECMULT = 8.*(SPECPARM)                                                <a name='6180'>
         JS = 1 + INT(SPECMULT)                                                  <a name='6181'>
         FS = MOD(SPECMULT,1.0)                                                 <a name='6182'>
         FAC000 = (1. - FS) * FAC00(LAY)                                         <a name='6183'>
         FAC010 = (1. - FS) * FAC10(LAY)                                         <a name='6184'>
         FAC100 = FS * FAC00(LAY)                                                <a name='6185'>
         FAC110 = FS * FAC10(LAY)                                                <a name='6186'>
         FAC001 = (1. - FS) * FAC01(LAY)                                         <a name='6187'>
         FAC011 = (1. - FS) * FAC11(LAY)                                         <a name='6188'>
         FAC101 = FS * FAC01(LAY)                                                <a name='6189'>
         FAC111 = FS * FAC11(LAY)                                                <a name='6190'>
         IND0 = ((JP(LAY)-1)*5+(JT(LAY)-1))*NSPA(16) + JS                        <a name='6191'>
         IND1 = (JP(LAY)*5+(JT1(LAY)-1))*NSPA(16) + JS                           <a name='6192'>
         INDS = INDSELF(LAY)                                                     <a name='6193'>
         DO 2000 IG = 1, NG16                                                    <a name='6194'>
            TAUG(NGS15+IG,LAY) = SPECCOMB *                 &amp;<a name='6195'>
                (FAC000 * ABSA16(IND0,IG) +                 &amp;                      <a name='6196'>
                 FAC100 * ABSA16(IND0+1,IG) +               &amp;                      <a name='6197'>
                 FAC010 * ABSA16(IND0+9,IG) +               &amp;                      <a name='6198'>
                 FAC110 * ABSA16(IND0+10,IG) +              &amp;                      <a name='6199'>
                 FAC001 * ABSA16(IND1,IG) +                 &amp;                      <a name='6200'>
                 FAC101 * ABSA16(IND1+1,IG) +               &amp;                      <a name='6201'>
                 FAC011 * ABSA16(IND1+9,IG) +               &amp;                      <a name='6202'>
                 FAC111 * ABSA16(IND1+10,IG)) +             &amp;                      <a name='6203'>
                 COLH2O(LAY) *                            &amp;                      <a name='6204'>
                 SELFFAC(LAY) * (SELFREFC16(INDS,IG) +       &amp;                      <a name='6205'>
                 SELFFRAC(LAY) *                          &amp;                      <a name='6206'>
                 (SELFREFC16(INDS+1,IG) - SELFREFC16(INDS,IG)))                        <a name='6207'>
            PFRAC(NGS15+IG,LAY) = FRACREFAC16(IG,JS) + FS *  &amp;                      <a name='6208'>
                 (FRACREFAC16(IG,JS+1) - FRACREFAC16(IG,JS))                           <a name='6209'>
 2000    CONTINUE                                                                <a name='6210'>
 2500 CONTINUE                                                                   <a name='6211'>
                                                                                 <a name='6212'>
      DO 3500 LAY = LAYTROP+1, NLAYERS                                           <a name='6213'>
         DO 3000 IG = 1, NG16                                                    <a name='6214'>
            TAUG(NGS15+IG,LAY) = 0.0                                             <a name='6215'>
            PFRAC(NGS15+IG,LAY) = 0.0                                            <a name='6216'>
 3000    CONTINUE                                                                <a name='6217'>
 3500 CONTINUE                                                                   <a name='6218'>
                                                                                 <a name='6219'>
      END SUBROUTINE TAUGB16<a name='6220'>
                                                                                 <a name='6221'>
<a name='6222'>
<font color=#447700>!-------------------------------------------------------------------------<a name='6223'></font>
<A NAME='RTRN'><A href='../../html_code/phys/module_ra_rrtm.F.html#RTRN' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6224'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>RTRN</font>(kts,ktep1,                                         &amp; <A href='../../call_to/RTRN.html' TARGET='index'>1</A><a name='6225'>
                      TAVEL, PZ, TZ, CLDFRAC, TAUCLOUD, TOTDFLUX,        &amp;<a name='6226'>
                      TOTUFLUX, HTR, ICLDLYR, ITR, PFRAC, TBOUND,SEMISS  )<a name='6227'>
<font color=#447700>!-------------------------------------------------------------------------<a name='6228'></font>
<font color=#447700>!  RRTM Longwave Radiative Transfer Model                                        <a name='6229'></font>
<font color=#447700>!  Atmospheric and Environmental Research, Inc., Cambridge, MA                   <a name='6230'></font>
<font color=#447700>!                                                                                <a name='6231'></font>
<font color=#447700>!  Original version:       E. J. Mlawer, et al.                                  <a name='6232'></font>
<font color=#447700>!  Revision for NCAR CCM:  Michael J. Iacono; September, 1998                    <a name='6233'></font>
<font color=#447700>!                                                                                <a name='6234'></font>
<font color=#447700>!  This program calculates the upward fluxes, downward fluxes, and               <a name='6235'></font>
<font color=#447700>!  heating rates for an arbitrary clear or cloudy atmosphere.  The input         <a name='6236'></font>
<font color=#447700>!  to this program is the atmospheric profile, all Planck function               <a name='6237'></font>
<font color=#447700>!  information, and the cloud fraction by layer.  The diffusivity angle          <a name='6238'></font>
<font color=#447700>!  (SECANG=1.66) is used for the angle integration for consistency with          <a name='6239'></font>
<font color=#447700>!  the NCAR CCM; the Gaussian weight appropriate to this angle (WTNUM=0.5)       <a name='6240'></font>
<font color=#447700>!  is applied here.  Note that use of the emissivity angle for the flux          <a name='6241'></font>
<font color=#447700>!  integration can cause errors of 1 to 4 W/m2 within cloudy layers.             <a name='6242'></font>
<font color=#447700>!-------------------------------------------------------------------------<a name='6243'></font>
                                                                                 <a name='6244'>
      INTEGER, INTENT(IN )    ::      kts,ktep1<a name='6245'>
 <a name='6246'>
      INTEGER, DIMENSION( NGPT,kts:ktep1 ),               &amp;<a name='6247'>
               INTENT(IN   )  ::                     ITR<a name='6248'>
<a name='6249'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                  &amp;<a name='6250'>
            INTENT(IN   )     ::                   PFRAC<a name='6251'>
<a name='6252'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::      &amp;<a name='6253'>
                                                   TAVEL<a name='6254'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::      &amp;<a name='6255'>
                                                 CLDFRAC, &amp;<a name='6256'>
                                                TAUCLOUD<a name='6257'>
<a name='6258'>
      REAL, DIMENSION(   0:ktep1 ),INTENT(INOUT)::        &amp;<a name='6259'>
                                                TOTDFLUX, &amp;<a name='6260'>
                                                TOTUFLUX<a name='6261'>
<a name='6262'>
      REAL, DIMENSION(   0:ktep1 ), INTENT(INOUT) ::        &amp;<a name='6263'>
                                                     HTR  <a name='6264'>
<a name='6265'>
      REAL, DIMENSION(   0:ktep1 ), INTENT(IN   ) ::      &amp;<a name='6266'>
                                                      PZ, &amp;<a name='6267'>
                                                      TZ<a name='6268'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::   &amp;<a name='6269'>
                                                 ICLDLYR<a name='6270'>
<a name='6271'>
      REAL, INTENT(IN   )        ::               TBOUND<a name='6272'>
      REAL, DIMENSION(NBANDS), INTENT(IN   ) ::   SEMISS<a name='6273'>
<a name='6274'>
<font color=#447700>! LOCAL VAR<a name='6275'></font>
<a name='6276'>
      REAL, DIMENSION(   0:ktep1 )              ::        &amp;<a name='6277'>
                                                TOTUCLFL, &amp;<a name='6278'>
                                                TOTDCLFL<a name='6279'>
<a name='6280'>
      REAL, DIMENSION(   0:ktep1 )              ::        &amp;<a name='6281'>
                                                    FNET, &amp;<a name='6282'>
                                                   FNETC, &amp;<a name='6283'>
                                                    HTRC<a name='6284'>
<a name='6285'>
      INTEGER :: kk<a name='6286'>
     <a name='6287'>
      REAL    :: CLRNTTOA,CLRNTSRF <a name='6288'>
<a name='6289'>
<font color=#447700>! Parameters                                                                     <a name='6290'></font>
<a name='6291'>
<font color=#447700>!     INTEGER, PARAMETER :: MXLAY=101                                                      <a name='6292'></font>
      REAL, PARAMETER :: SECANG=1.66                                                    <a name='6293'>
      REAL, PARAMETER :: WTNUM=0.5                                                      <a name='6294'>
                                                                                 <a name='6295'>
<font color=#447700>! RRTM Definitions                                                               <a name='6296'></font>
<font color=#447700>! Input                                                                          <a name='6297'></font>
<font color=#447700>!    MXLAY                        ! Maximum number of model layers               <a name='6298'></font>
<font color=#447700>!    NGPT                         ! Total number of g-point subintervals         <a name='6299'></font>
<font color=#447700>!    NBANDS                       ! Number of longwave spectral bands            <a name='6300'></font>
<font color=#447700>!    SECANG                       ! Diffusivity angle                            <a name='6301'></font>
<font color=#447700>!    WTNUM                        ! Weight for radiance to flux conversion       <a name='6302'></font>
<font color=#447700>!    NLAYERS                      ! Number of model layers (plev+1)              <a name='6303'></font>
<font color=#447700>!    PAVEL(MXLAY)                 ! Layer pressures (mb)                         <a name='6304'></font>
<font color=#447700>!    PZ(0:MXLAY)                  ! Level (interface) pressures (mb)             <a name='6305'></font>
<font color=#447700>!    TAVEL(MXLAY)                 ! Layer temperatures (K)                       <a name='6306'></font>
<font color=#447700>!    TZ(0:MXLAY)                  ! Level (interface) temperatures(mb)           <a name='6307'></font>
<font color=#447700>!    TBOUND                       ! Surface temperature (K)                      <a name='6308'></font>
<font color=#447700>!    CLDFRAC(MXLAY)               ! Layer cloud fraction                         <a name='6309'></font>
<font color=#447700>!    TAUCLOUD(MXLAY)              ! Layer cloud optical depth                    <a name='6310'></font>
<font color=#447700>!    ITR(NGPT,MXLAY)              ! Integer look-up table index                  <a name='6311'></font>
<font color=#447700>!    PFRAC(NGPT,MXLAY)               ! Planck fractions                             <a name='6312'></font>
<font color=#447700>!    ICLDLYR(MXLAY)               ! Flag for cloudy layers                       <a name='6313'></font>
<font color=#447700>!    ICLD                         ! Flag for cloudy in column                    <a name='6314'></font>
<font color=#447700>!    SEMISS(NBANDS)               ! Surface emissivities for each band           <a name='6315'></font>
<font color=#447700>!    BPADE                        ! Pade constant                                <a name='6316'></font>
<font color=#447700>!    TAU                          ! Clear sky optical depth look-up table        <a name='6317'></font>
<font color=#447700>!    TF                           ! Tau transition function look-up table        <a name='6318'></font>
<font color=#447700>!    TRANS                        ! Clear sky transmittance look-up table        <a name='6319'></font>
<font color=#447700>! Local                                                                          <a name='6320'></font>
<font color=#447700>!    ABSS(NGPT*MXLAY)             ! Gaseous absorptivity                         <a name='6321'></font>
<font color=#447700>!    ABSCLD(MXLAY)                ! Cloud absorptivity                           <a name='6322'></font>
<font color=#447700>!    ATOT(NGPT*MXLAY)             ! Combined gaseous and cloud absorptivity      <a name='6323'></font>
<font color=#447700>!    ODCLR(NGPT,MXLAY)            ! Clear sky (gaseous) optical depth            <a name='6324'></font>
<font color=#447700>!    ODCLD(MXLAY)                 ! Cloud optical depth                          <a name='6325'></font>
<font color=#447700>!    EFCLFRAC(MXLAY)              ! Effective cloud fraction                     <a name='6326'></font>
<font color=#447700>!    RADLU(NGPT)                  ! Upward radiance                              <a name='6327'></font>
<font color=#447700>!    URAD                         ! Spectrally summed upward radiance            <a name='6328'></font>
<font color=#447700>!    RADCLRU(NGPT)                ! Clear sky upward radiance                    <a name='6329'></font>
<font color=#447700>!    CLRURAD                      ! Spectrally summed clear sky upward radiance  <a name='6330'></font>
<font color=#447700>!    RADLD(NGPT)                  ! Downward radiance                            <a name='6331'></font>
<font color=#447700>!    DRAD                         ! Spectrally summed downward radiance          <a name='6332'></font>
<font color=#447700>!    RADCLRD(NGPT)                ! Clear sky downward radiance                  <a name='6333'></font>
<font color=#447700>!    CLRDRAD                      ! Spectrally summed clear sky downward radianc <a name='6334'></font>
<font color=#447700>! Output                                                                         <a name='6335'></font>
<font color=#447700>!    TOTUFLUX(0:MXLAY)            ! Upward longwave flux (W/m2)                  <a name='6336'></font>
<font color=#447700>!    TOTDFLUX(0:MXLAY)            ! Downward longwave flux (W/m2)                <a name='6337'></font>
<font color=#447700>!    FNET(0:MXLAY)                ! Net longwave flux (W/m2)                     <a name='6338'></font>
<font color=#447700>!    HTR(0:MXLAY)                 ! Longwave heating rate (K/day)                <a name='6339'></font>
<font color=#447700>!    CLRNTTOA                     ! Clear sky TOA outgoing flux (W/m2)           <a name='6340'></font>
<font color=#447700>!    CLRNTSFC                     ! Clear sky net surface flux (W/m2)            <a name='6341'></font>
<font color=#447700>!    TOTUCLFL(0:MXLAY)            ! Clear sky upward longwave flux (W/m2)        <a name='6342'></font>
<font color=#447700>!    TOTDCLFL(0:MXLAY)            ! Clear sky downward longwave flux (W/m2)      <a name='6343'></font>
<font color=#447700>!    FNETC(0:MXLAY)               ! Clear sky net longwave flux (W/m2)           <a name='6344'></font>
<font color=#447700>!    HTRC(0:MXLAY)                ! Clear sky longwave heating rate (K/day)      <a name='6345'></font>
<font color=#447700>!                                                                                <a name='6346'></font>
                                                                                 <a name='6347'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='6348'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='6349'></font>
<font color=#447700>! carry constants.                                                               <a name='6350'></font>
<a name='6351'>
      DIMENSION BBU(NGPT*(ktep1-kts+1)),BBUTOT(NGPT*(ktep1-kts)),BGLEV(NGPT)                   <a name='6352'>
      DIMENSION PLANKBND(NBANDS),PLNKEMIT(NBANDS)                                <a name='6353'>
      DIMENSION PLVL(NBANDS,0:ktep1),PLAY(NBANDS,kts:ktep1)                          <a name='6354'>
      DIMENSION INDLAY(kts:ktep1),INDLEV(0:ktep1)                                    <a name='6355'>
      DIMENSION TLAYFRAC(kts:ktep1),TLEVFRAC(0:ktep1)                                <a name='6356'>
      DIMENSION ABSS(NGPT*(ktep1-kts+1)),ABSCLD(kts:ktep1-1),ATOT(NGPT*(ktep1-kts)) <a name='6357'>
      DIMENSION ODCLR(NGPT,kts:ktep1-1),ODCLD(kts:ktep1-1),EFCLFRAC(kts:ktep1-1)<a name='6358'>
      DIMENSION RADLU(NGPT),RADLD(NGPT)                                          <a name='6359'>
      DIMENSION RADCLRU(NGPT),RADCLRD(NGPT)                                      <a name='6360'>
      DIMENSION SEMIS(NGPT),RADUEMIT(NGPT)                                       <a name='6361'>
                                                                                 <a name='6362'>
      INDBOUND = TBOUND - 159.                                                   <a name='6363'>
      TBNDFRAC = TBOUND - INT(TBOUND)                                            <a name='6364'>
                                                                                 <a name='6365'>
      DO 200 LAY = 0, NLAYERS                                                    <a name='6366'>
         TOTUFLUX(LAY) = 0.0                                                     <a name='6367'>
         TOTDFLUX(LAY) = 0.0                                                     <a name='6368'>
         TOTUCLFL(LAY) = 0.0                                                     <a name='6369'>
         TOTDCLFL(LAY) = 0.0                                                     <a name='6370'>
         INDLEV(LAY) = TZ(LAY) - 159.                                            <a name='6371'>
         TLEVFRAC(LAY) = TZ(LAY) - INT(TZ(LAY))                                  <a name='6372'>
 200  CONTINUE                                                                   <a name='6373'>
                                                                                 <a name='6374'>
      DO 220 LEV = 1, NLAYERS                                                    <a name='6375'>
                                                                                 <a name='6376'>
         IF (ICLDLYR(LEV).EQ.1) THEN                                             <a name='6377'>
            INDLAY(LEV) = TAVEL(LEV) - 159.                                      <a name='6378'>
            TLAYFRAC(LEV) = TAVEL(LEV) - INT(TAVEL(LEV))                         <a name='6379'>
<font color=#447700>!  Cloudy sky optical depth and absorptivity.                                    <a name='6380'></font>
            ODCLD(LEV) = SECANG * TAUCLOUD(LEV)                                  <a name='6381'>
            TRANSCLD = EXP(-ODCLD(LEV))                                          <a name='6382'>
            ABSCLD(LEV) = 1. - TRANSCLD                                          <a name='6383'>
            EFCLFRAC(LEV) = ABSCLD(LEV) * CLDFRAC(LEV)                           <a name='6384'>
<font color=#447700>!  Get clear sky optical depth from TAU lookup table                             <a name='6385'></font>
            DO 250 IPR = 1, NGPT                                                 <a name='6386'>
               IND = ITR(IPR,LEV)                                                <a name='6387'>
               ODCLR(IPR,LEV) = TAU(IND)                                         <a name='6388'>
 250        CONTINUE                                                             <a name='6389'>
         ELSE                                                                    <a name='6390'>
            INDLAY(LEV) = TAVEL(LEV) - 159.                                      <a name='6391'>
            TLAYFRAC(LEV) = TAVEL(LEV) - INT(TAVEL(LEV))                         <a name='6392'>
         ENDIF                                                                   <a name='6393'>
                                                                                 <a name='6394'>
 220  CONTINUE                                                                   <a name='6395'>
                                                                                 <a name='6396'>
<font color=#447700>!      SUMPL   = 0.0                                                             <a name='6397'></font>
<font color=#447700>!      SUMPLEM = 0.0                                                             <a name='6398'></font>
<font color=#447700>! *** Loop over frequency bands.                                                 <a name='6399'></font>
      DO 600 IBAND = 1, NBANDS                                                   <a name='6400'>
         DBDTLEV = TOTPLNK(INDBOUND+1,IBAND)-TOTPLNK(INDBOUND,IBAND)             <a name='6401'>
         PLANKBND(IBAND) = DELWAVE(IBAND) * (TOTPLNK(INDBOUND,IBAND) +  &amp;<a name='6402'>
              TBNDFRAC * DBDTLEV)                                                <a name='6403'>
         DBDTLEV = TOTPLNK(INDLEV(0)+1,IBAND) -                         &amp;        <a name='6404'>
              TOTPLNK(INDLEV(0),IBAND)                                           <a name='6405'>
         PLVL(IBAND,0) = DELWAVE(IBAND) * (TOTPLNK(INDLEV(0),IBAND) +   &amp;        <a name='6406'>
              TLEVFRAC(0)*DBDTLEV)                                               <a name='6407'>
                                                                                 <a name='6408'>
         PLNKEMIT(IBAND) = SEMISS(IBAND) * PLANKBND(IBAND)                       <a name='6409'>
<font color=#447700>!         SUMPLEM  = SUMPLEM + PLNKEMIT(IBAND)                                   <a name='6410'></font>
<font color=#447700>!         SUMPL    = SUMPL   + PLANKBND(IBAND)                                   <a name='6411'></font>
                                                                                 <a name='6412'>
         DO 300 LEV = 1, NLAYERS                                                 <a name='6413'>
<font color=#447700>!     Calculate the integrated Planck functions at the level and                 <a name='6414'></font>
<font color=#447700>!     layer temperatures.                                                        <a name='6415'></font>
            DBDTLEV = TOTPLNK(INDLEV(LEV)+1,IBAND) -          &amp;<a name='6416'>
                 TOTPLNK(INDLEV(LEV),IBAND)                                      <a name='6417'>
            DBDTLAY = TOTPLNK(INDLAY(LEV)+1,IBAND) -          &amp;                  <a name='6418'>
                 TOTPLNK(INDLAY(LEV),IBAND)                                      <a name='6419'>
            PLAY(IBAND,LEV) = DELWAVE(IBAND) *                &amp;                  <a name='6420'>
                 (TOTPLNK(INDLAY(LEV),IBAND) + TLAYFRAC(LEV) * DBDTLAY)          <a name='6421'>
            PLVL(IBAND,LEV) = DELWAVE(IBAND) *                &amp;                  <a name='6422'>
                 (TOTPLNK(INDLEV(LEV),IBAND) + TLEVFRAC(LEV) * DBDTLEV)          <a name='6423'>
 300     CONTINUE                                                                <a name='6424'>
 600  CONTINUE                                                                   <a name='6425'>
                                                                                 <a name='6426'>
<font color=#447700>!      SEMISLW = SUMPLEM / SUMPL                                                 <a name='6427'></font>
                                                                                 <a name='6428'>
<font color=#447700>! *** Initialize for radiative transfer.                                         <a name='6429'></font>
      DO 500 IPR = 1, NGPT                                                       <a name='6430'>
         RADCLRD(IPR) = 0.                                                       <a name='6431'>
         RADLD(IPR) = 0.                                                         <a name='6432'>
         SEMIS(IPR) = SEMISS(NGB(IPR))                                           <a name='6433'>
         RADUEMIT(IPR) = PFRAC(IPR,1) * PLNKEMIT(NGB(IPR))                          <a name='6434'>
         BGLEV(IPR) = PFRAC(IPR,NLAYERS) * PLVL(NGB(IPR),NLAYERS)                   <a name='6435'>
 500  CONTINUE                                                                   <a name='6436'>
                                                                                 <a name='6437'>
                                                                                 <a name='6438'>
<font color=#447700>! *** DOWNWARD RADIATIVE TRANSFER                                                <a name='6439'></font>
<font color=#447700>! *** DRAD holds summed radiance for total sky stream                            <a name='6440'></font>
<font color=#447700>! *** CLRDRAD holds summed radiance for clear sky stream                         <a name='6441'></font>
                                                                                 <a name='6442'>
      ICLDDN = 0                                                                 <a name='6443'>
      DO 3000 LEV = NLAYERS, 1, -1                                               <a name='6444'>
         DRAD = 0.0                                                              <a name='6445'>
         CLRDRAD = 0.0                                                           <a name='6446'>
                                                                                 <a name='6447'>
         IF (ICLDLYR(LEV).EQ.1) THEN                                             <a name='6448'>
                                                                                 <a name='6449'>
<font color=#447700>! *** Cloudy layer                                                               <a name='6450'></font>
         ICLDDN = 1                                                              <a name='6451'>
         IENT = NGPT * (LEV-1)                                                   <a name='6452'>
         DO 2000 IPR = 1, NGPT                                                   <a name='6453'>
            INDEX = IENT + IPR                                                   <a name='6454'>
<font color=#447700>!     Get lookup table index                                                     <a name='6455'></font>
            IND = ITR(IPR,LEV)                                                   <a name='6456'>
<font color=#447700>!     Add clear sky and cloud optical depths                                     <a name='6457'></font>
            ODSM = ODCLR(IPR,LEV) + ODCLD(LEV)                                   <a name='6458'>
            FACTOT = ODSM / (BPADE + ODSM)                                       <a name='6459'>
            BGLAY = PFRAC(IPR,LEV) * PLAY(NGB(IPR),LEV)                             <a name='6460'>
            DELBGUP = BGLEV(IPR) - BGLAY                                         <a name='6461'>
<font color=#447700>!     Get TF from lookup table                                                   <a name='6462'></font>
            TAUF = TF(IND)                                                       <a name='6463'>
            BBU(INDEX) = BGLAY + TAUF * DELBGUP                                  <a name='6464'>
            BBUTOT(INDEX) = BGLAY + FACTOT * DELBGUP                             <a name='6465'>
            BGLEV(IPR) = PFRAC(IPR,LEV) * PLVL(NGB(IPR),LEV-1)                      <a name='6466'>
            DELBGDN = BGLEV(IPR) - BGLAY                                         <a name='6467'>
            BBD = BGLAY + TAUF * DELBGDN                                         <a name='6468'>
            BBDLEVD = BGLAY + FACTOT * DELBGDN                                   <a name='6469'>
<font color=#447700>!     Get clear sky transmittance from lookup table                              <a name='6470'></font>
            ABSS(INDEX) = 1. - TRANS(IND)                                        <a name='6471'>
            ATOT(INDEX) = ABSS(INDEX) + ABSCLD(LEV) -      &amp;<a name='6472'>
                ABSS(INDEX) * ABSCLD(LEV)                                        <a name='6473'>
            GASSRC = BBD * ABSS(INDEX)                                           <a name='6474'>
<font color=#447700>!     Total sky radiance                                                         <a name='6475'></font>
            RADLD(IPR) = RADLD(IPR) - RADLD(IPR) * (ABSS(INDEX) +  &amp;             <a name='6476'>
               EFCLFRAC(LEV) * (1.-ABSS(INDEX))) + GASSRC +        &amp;             <a name='6477'>
               CLDFRAC(LEV) * (BBDLEVD * ATOT(INDEX) - GASSRC)                   <a name='6478'>
            DRAD = DRAD + RADLD(IPR)                                             <a name='6479'>
<font color=#447700>!     Clear sky radiance                                                         <a name='6480'></font>
            RADCLRD(IPR) = RADCLRD(IPR) + (BBD - RADCLRD(IPR))     &amp; <a name='6481'>
                         * ABSS(INDEX)                                           <a name='6482'>
            CLRDRAD = CLRDRAD + RADCLRD(IPR)                                     <a name='6483'>
 2000    CONTINUE                                                                <a name='6484'>
                                                                                 <a name='6485'>
         ELSE                                                                    <a name='6486'>
                                                                                 <a name='6487'>
<font color=#447700>! *** Clear layer                                                                <a name='6488'></font>
         IENT = NGPT * (LEV-1)                                                   <a name='6489'>
<font color=#447700>!DEC$ IVDEP<a name='6490'></font>
         DO 2100 IPR = 1, NGPT                                                   <a name='6491'>
            INDEX = IENT + IPR                                                   <a name='6492'>
            IND = ITR(IPR,LEV)                                                   <a name='6493'>
            BGLAY = PFRAC(IPR,LEV) * PLAY(NGB(IPR),LEV)                             <a name='6494'>
            DELBGUP = BGLEV(IPR) - BGLAY                                         <a name='6495'>
<font color=#447700>!     Get TF from lookup table                                                   <a name='6496'></font>
            TAUF = TF(IND)                                                       <a name='6497'>
            BBU(INDEX) = BGLAY + TAUF * DELBGUP                                  <a name='6498'>
            BGLEV(IPR) = PFRAC(IPR,LEV) * PLVL(NGB(IPR),LEV-1)                      <a name='6499'>
            DELBGDN = BGLEV(IPR) - BGLAY                                         <a name='6500'>
            BBD = BGLAY + TAUF * DELBGDN                                         <a name='6501'>
<font color=#447700>!     Get clear sky transmittance from lookup table                              <a name='6502'></font>
            ABSS(INDEX) = 1. - TRANS(IND)                                        <a name='6503'>
<font color=#447700>!     Total sky radiance                                                         <a name='6504'></font>
            RADLD(IPR) = RADLD(IPR) + (BBD - RADLD(IPR)) *     &amp; <a name='6505'>
                         ABSS(INDEX)                                             <a name='6506'>
            DRAD = DRAD + RADLD(IPR)                                             <a name='6507'>
<font color=#447700>!     Set clear sky stream to total sky stream as long as layers                 <a name='6508'></font>
<font color=#447700>!     remain clear.  Streams diverge when a cloud is reached.                    <a name='6509'></font>
            IF (ICLDDN.EQ.1) THEN                                                <a name='6510'>
               RADCLRD(IPR) = RADCLRD(IPR) + (BBD - RADCLRD(IPR)) *   &amp; <a name='6511'>
                              ABSS(INDEX)                                        <a name='6512'>
               CLRDRAD = CLRDRAD + RADCLRD(IPR)                                  <a name='6513'>
            ELSE                                                                 <a name='6514'>
               RADCLRD(IPR) = RADLD(IPR)                                         <a name='6515'>
               CLRDRAD = DRAD                                                    <a name='6516'>
            ENDIF                                                                <a name='6517'>
                                                                                 <a name='6518'>
 2100    CONTINUE                                                               <a name='6519'>
                                                                                 <a name='6520'>
         ENDIF                                                                   <a name='6521'>
                                                                                 <a name='6522'>
         TOTDFLUX(LEV-1) = DRAD * WTNUM                                          <a name='6523'>
         TOTDCLFL(LEV-1) = CLRDRAD * WTNUM                                       <a name='6524'>
                                                                                 <a name='6525'>
 3000 CONTINUE                                                                   <a name='6526'>
                                                                                 <a name='6527'>
                                                                                 <a name='6528'>
<font color=#447700>! SPECTRAL EMISSIVITY &amp; REFLECTANCE                                              <a name='6529'></font>
<font color=#447700>! Include the contribution of spectrally varying longwave emissivity and         <a name='6530'></font>
<font color=#447700>! reflection from the surface to the upward radiative transfer.                  <a name='6531'></font>
<font color=#447700>! Note: Spectral and Lambertian reflection are identical for the one angle       <a name='6532'></font>
<font color=#447700>! flux integration used here.                                                    <a name='6533'></font>
                                                                                 <a name='6534'>
      URAD = 0.0                                                                 <a name='6535'>
      CLRURAD = 0.0                                                              <a name='6536'>
      DO 3500 IPR = 1, NGPT                                                      <a name='6537'>
<font color=#447700>!     Total sky radiance                                                         <a name='6538'></font>
         RADLU(IPR) = RADUEMIT(IPR) + (1. - SEMIS(IPR)) * RADLD(IPR)             <a name='6539'>
         URAD = URAD + RADLU(IPR)                                                <a name='6540'>
<font color=#447700>!     Clear sky radiance                                                         <a name='6541'></font>
         RADCLRU(IPR) = RADUEMIT(IPR) + (1. - SEMIS(IPR))  &amp; <a name='6542'>
                        * RADCLRD(IPR)                                           <a name='6543'>
         CLRURAD = CLRURAD + RADCLRU(IPR)                                        <a name='6544'>
 3500 CONTINUE                                                                   <a name='6545'>
      TOTUFLUX(0) = URAD * WTNUM                                                 <a name='6546'>
      TOTUCLFL(0) = CLRURAD * WTNUM                                              <a name='6547'>
                                                                                 <a name='6548'>
                                                                                 <a name='6549'>
<font color=#447700>! *** UPWARD RADIATIVE TRANSFER                                                  <a name='6550'></font>
<font color=#447700>! *** URAD holds the summed radiance for total sky stream                        <a name='6551'></font>
<font color=#447700>! *** CLRURAD holds the summed radiance for clear sky stream                     <a name='6552'></font>
                                                                                 <a name='6553'>
      DO 5000 LEV = 1, NLAYERS                                                   <a name='6554'>
         URAD = 0.0                                                              <a name='6555'>
         CLRURAD = 0.0                                                           <a name='6556'>
                                                                                 <a name='6557'>
<font color=#447700>! Check flag for cloud in current layer                                          <a name='6558'></font>
                                                                                 <a name='6559'>
         IF (ICLDLYR(LEV).EQ.1) THEN                                             <a name='6560'>
                                                                                 <a name='6561'>
<font color=#447700>! *** Cloudy layers                                                              <a name='6562'></font>
         IENT = NGPT * (LEV-1)                                                   <a name='6563'>
         DO 4000 IPR = 1, NGPT                                                   <a name='6564'>
            INDEX = IENT + IPR                                                   <a name='6565'>
            GASSRC = BBU(INDEX) * ABSS(INDEX)                                    <a name='6566'>
<font color=#447700>!     Total sky radiance                                                         <a name='6567'></font>
            RADLU(IPR) = RADLU(IPR) - RADLU(IPR) * (ABSS(INDEX) +    &amp;           <a name='6568'>
               EFCLFRAC(LEV) * (1.-ABSS(INDEX))) + GASSRC +          &amp;<a name='6569'>
               CLDFRAC(LEV) * (BBUTOT(INDEX) * ATOT(INDEX) - GASSRC)             <a name='6570'>
            URAD = URAD + RADLU(IPR)                                             <a name='6571'>
<font color=#447700>!     Clear sky radiance                                                         <a name='6572'></font>
            RADCLRU(IPR) = RADCLRU(IPR) + (BBU(INDEX) - RADCLRU(IPR)) * &amp;        <a name='6573'>
                           ABSS(INDEX)                                           <a name='6574'>
            CLRURAD = CLRURAD + RADCLRU(IPR)                                     <a name='6575'>
 4000    CONTINUE                                                                <a name='6576'>
                                                                                 <a name='6577'>
         ELSE                                                                    <a name='6578'>
                                                                                 <a name='6579'>
<font color=#447700>! *** Clear layer                                                                <a name='6580'></font>
         IENT = NGPT * (LEV-1)                                                   <a name='6581'>
         DO 4100 IPR = 1, NGPT                                                   <a name='6582'>
            INDEX = IENT + IPR                                                   <a name='6583'>
<font color=#447700>!     Total sky radiance                                                         <a name='6584'></font>
            RADLU(IPR) = RADLU(IPR) + (BBU(INDEX)-RADLU(IPR)) *  &amp; <a name='6585'>
                         ABSS(INDEX)                                             <a name='6586'>
            URAD = URAD + RADLU(IPR)                                             <a name='6587'>
<font color=#447700>!     Clear sky radiance                                                         <a name='6588'></font>
<font color=#447700>!     Upward clear and total sky streams must remain separate because surface    <a name='6589'></font>
<font color=#447700>!     reflectance is different for each.                                         <a name='6590'></font>
            RADCLRU(IPR) = RADCLRU(IPR) + (BBU(INDEX) - RADCLRU(IPR))   &amp;         <a name='6591'>
                           * ABSS(INDEX)                                         <a name='6592'>
            CLRURAD = CLRURAD + RADCLRU(IPR)                                     <a name='6593'>
 4100    CONTINUE                                                                <a name='6594'>
                                                                                 <a name='6595'>
         ENDIF                                                                   <a name='6596'>
                                                                                 <a name='6597'>
         TOTUFLUX(LEV) = URAD * WTNUM                                            <a name='6598'>
         TOTUCLFL(LEV) = CLRURAD * WTNUM                                         <a name='6599'>
                                                                                 <a name='6600'>
 5000 CONTINUE                                                                   <a name='6601'>
                                                                                 <a name='6602'>
                                                                                 <a name='6603'>
<font color=#447700>! *** Convert radiances to fluxes and heating rates for total sky.  Calculates   <a name='6604'></font>
<font color=#447700>!     clear sky surface and TOA values.  To compute clear sky profiles, uncommen <a name='6605'></font>
<font color=#447700>!     relevant lines below.                                                      <a name='6606'></font>
      TOTUFLUX(0) = TOTUFLUX(0) * FLUXFAC                                        <a name='6607'>
      TOTDFLUX(0) = TOTDFLUX(0) * FLUXFAC                                        <a name='6608'>
      FNET(0) = TOTUFLUX(0) - TOTDFLUX(0)                                        <a name='6609'>
      TOTUCLFL(0) = TOTUCLFL(0) * FLUXFAC                                        <a name='6610'>
      TOTDCLFL(0) = TOTDCLFL(0) * FLUXFAC                                        <a name='6611'>
      FNETC(0) = TOTUCLFL(0) - TOTDCLFL(0)                                       <a name='6612'>
      CLRNTTOA = TOTUCLFL(NLAYERS)                                               <a name='6613'>
      CLRNTSRF = TOTUFLUX(0) - TOTDCLFL(0)                                       <a name='6614'>
                                                                                 <a name='6615'>
      DO 7000 LEV = 1, NLAYERS                                                   <a name='6616'>
         TOTUFLUX(LEV) = TOTUFLUX(LEV) * FLUXFAC                                 <a name='6617'>
         TOTDFLUX(LEV) = TOTDFLUX(LEV) * FLUXFAC                                 <a name='6618'>
         FNET(LEV) = TOTUFLUX(LEV) - TOTDFLUX(LEV)                               <a name='6619'>
         TOTUCLFL(LEV) = TOTUCLFL(LEV) * FLUXFAC                                 <a name='6620'>
         TOTDCLFL(LEV) = TOTDCLFL(LEV) * FLUXFAC                                 <a name='6621'>
         FNETC(LEV) = TOTUCLFL(LEV) - TOTDCLFL(LEV)                              <a name='6622'>
         L = LEV - 1                                                             <a name='6623'>
<font color=#447700>!     Calculate Heating Rates.                                                   <a name='6624'></font>
         HTR(L) = HEATFAC * (FNET(L) - FNET(LEV)) / (PZ(L) - PZ(LEV))            <a name='6625'>
         HTRC(L) = HEATFAC * (FNETC(L) - FNETC(LEV)) / (PZ(L) - PZ(LEV))         <a name='6626'>
 7000 CONTINUE                                                                   <a name='6627'>
      HTR(NLAYERS) = 0.0                                                         <a name='6628'>
      HTRC(NLAYERS) = 0.0                                                                                                                                  <a name='6629'>
<a name='6630'>
      END  SUBROUTINE RTRN<a name='6631'>
<a name='6632'>
<font color=#447700>!---------------------------------------------------------------------------<a name='6633'></font>
<A NAME='GASABS'><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6634'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>GASABS</font>(kts,ktep1,                                         &amp; <A href='../../call_to/GASABS.html' TARGET='index'>1</A>,<A href='../../call_from/GASABS.html' TARGET='index'>16</A><a name='6635'>
                        COLDRY,COLH2O,COLCO2,COLO3,COLN2O,COLCH4,          &amp;<a name='6636'>
                        COLO2,CO2MULT,                                     &amp;<a name='6637'>
                        FAC00,FAC01,FAC10,FAC11,                           &amp;<a name='6638'>
                        FORFAC,SELFFAC,SELFFRAC,                           &amp;<a name='6639'>
                        JP,JT,JT1,INDSELF,ITR,WX,PFRAC,TAUG,               &amp;<a name='6640'>
                        LAYTROP,LAYSWTCH,LAYLOW                            )<a name='6641'>
<font color=#447700>!---------------------------------------------------------------------------<a name='6642'></font>
<font color=#447700>!  RRTM Longwave Radiative Transfer Model                                        <a name='6643'></font>
<font color=#447700>!  Atmospheric and Environmental Research, Inc., Cambridge, MA                   <a name='6644'></font>
<font color=#447700>!                                                                                <a name='6645'></font>
<font color=#447700>!  Original version:       E. J. Mlawer, et al.                                  <a name='6646'></font>
<font color=#447700>!  Revision for NCAR CCM:  Michael J. Iacono; September, 1998                    <a name='6647'></font>
<font color=#447700>!                                                                                <a name='6648'></font>
<font color=#447700>!  This routine calculates the gaseous optical depths for all 16 longwave        <a name='6649'></font>
<font color=#447700>!  spectral bands.  The optical depths are used to define the Pade               <a name='6650'></font>
<font color=#447700>!  approximation to the function of tau transition from tranparancy to           <a name='6651'></font>
<font color=#447700>!  opacity.  This function, which varies from 0 to 1, is converted to an         <a name='6652'></font>
<font color=#447700>!  integer that will serve as an index for the lookup tables of tau              <a name='6653'></font>
<font color=#447700>!  transition function and transmittance used in the radiative transfer.         <a name='6654'></font>
<font color=#447700>!  These lookup tables are created on initialization in routine RRTMINIT.        <a name='6655'></font>
<font color=#447700>!---------------------------------------------------------------------------<a name='6656'></font>
<font color=#447700>!                                                                                <a name='6657'></font>
<font color=#447700>! Definitions                                                                    <a name='6658'></font>
<font color=#447700>!    NGPT                         ! Total number of g-point subintervals         <a name='6659'></font>
<font color=#447700>!    MXLAY                        ! Maximum number of model layers               <a name='6660'></font>
<font color=#447700>!    SECANG                       ! Diffusivity angle for flux computation       <a name='6661'></font>
<font color=#447700>!    TAU(NGPT,MXLAY)              ! Gaseous optical depths                       <a name='6662'></font>
<font color=#447700>!    NLAYERS                      ! Number of model layers used in RRTM          <a name='6663'></font>
<font color=#447700>!    PAVEL(MXLAY)                 ! Model layer pressures (mb)                   <a name='6664'></font>
<font color=#447700>!    PZ(0:MXLAY)                  ! Model level (interface) pressures (mb)       <a name='6665'></font>
<font color=#447700>!    TAVEL(MXLAY)                 ! Model layer temperatures (K)                 <a name='6666'></font>
<font color=#447700>!    TZ(0:MXLAY)                  ! Model level (interface) temperatures (K)     <a name='6667'></font>
<font color=#447700>!    TBOUND                       ! Surface temperature (K)                      <a name='6668'></font>
<font color=#447700>!    BPADE                        ! Pade approximation constant (=1./0.278)      <a name='6669'></font>
<font color=#447700>!    ITR(NGPT,MXLAY)              ! Integer lookup table index                   <a name='6670'></font>
<font color=#447700>!                                                                                <a name='6671'></font>
<font color=#447700>! Parameters                              <a name='6672'></font>
<a name='6673'>
      IMPLICIT NONE<a name='6674'>
                                       <a name='6675'>
      REAL, PARAMETER :: SECANG=1.66                                                    <a name='6676'>
<a name='6677'>
      INTEGER, INTENT(IN )   ::  kts,ktep1<a name='6678'>
      INTEGER, INTENT(IN )   ::  LAYTROP,LAYSWTCH,LAYLOW<a name='6679'>
<a name='6680'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                  &amp;<a name='6681'>
            INTENT(INOUT)        ::                PFRAC<a name='6682'>
<a name='6683'>
      REAL, DIMENSION( NGPT,kts:ktep1 ),                  &amp;<a name='6684'>
            INTENT(INOUT)        ::                 TAUG<a name='6685'>
<a name='6686'>
      REAL, DIMENSION( MAXXSEC,kts:ktep1 ),               &amp;<a name='6687'>
            INTENT(IN   )        ::                   WX<a name='6688'>
<a name='6689'>
      INTEGER, DIMENSION( NGPT,kts:ktep1 ),               &amp;<a name='6690'>
               INTENT(INOUT)  ::                     ITR<a name='6691'>
<a name='6692'>
      REAL, DIMENSION( kts:ktep1 ), INTENT(IN   ) ::      &amp;<a name='6693'>
                                                  COLDRY, &amp;  <a name='6694'>
                                                  COLH2O, &amp;<a name='6695'>
                                                  COLCO2, &amp;<a name='6696'>
                                                   COLO3, &amp;<a name='6697'>
                                                  COLN2O, &amp;<a name='6698'>
                                                  COLCH4, &amp;<a name='6699'>
                                                   COLO2, &amp;<a name='6700'>
                                                 CO2MULT, &amp;<a name='6701'>
                                                   FAC00, &amp;<a name='6702'>
                                                   FAC01, &amp;<a name='6703'>
                                                   FAC10, &amp;<a name='6704'>
                                                   FAC11, &amp;<a name='6705'>
                                                  FORFAC, &amp;<a name='6706'>
                                                 SELFFAC, &amp;<a name='6707'>
                                                SELFFRAC<a name='6708'>
 <a name='6709'>
      INTEGER, DIMENSION( kts:ktep1 ), INTENT(INOUT) ::   &amp;<a name='6710'>
                                                      JP, &amp;<a name='6711'>
                                                      JT, &amp;<a name='6712'>
                                                     JT1, &amp;<a name='6713'>
                                                 INDSELF<a name='6714'>
<a name='6715'>
      INTEGER :: lay,ipr<a name='6716'>
      REAL    :: odepth,tff<a name='6717'>
<a name='6718'>
<font color=#447700>! This compiler directive was added to insure private common block storage       <a name='6719'></font>
<font color=#447700>! in multi-tasked mode on a CRAY or SGI for all commons except those that        <a name='6720'></font>
<font color=#447700>! carry constants.                                                               <a name='6721'></font>
                                                                                 <a name='6722'>
<font color=#447700>! **************************************************************************     <a name='6723'></font>
<a name='6724'>
<font color=#447700>!  Calculate optical depth for each band                                         <a name='6725'></font>
     <a name='6726'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB1'>TAUGB1</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB1_1">(kts,ktep1,COLH2O,FAC00,FAC01,FAC10,FAC11,              &amp;<a name='6727'>
                  FORFAC,SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,  &amp;<a name='6728'>
                  LAYTROP)<a name='6729'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB2'>TAUGB2</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB2_1">(kts,ktep1,COLDRY,COLH2O,FAC00,FAC01,FAC10,FAC11,       &amp;<a name='6730'>
                  FORFAC,SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,  &amp;<a name='6731'>
                  LAYTROP)<a name='6732'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB3'>TAUGB3</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB3_1">(kts,ktep1,COLH2O,COLCO2,COLN2O,FAC00,FAC01,FAC10,FAC11,&amp;<a name='6733'>
                  FORFAC,SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,  &amp;<a name='6734'>
                  LAYTROP)<a name='6735'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB4'>TAUGB4</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB4_1">(kts,ktep1,COLH2O,COLCO2,COLO3,FAC00,FAC01,FAC10,FAC11, &amp;<a name='6736'>
                  SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,         &amp;<a name='6737'>
                  LAYTROP)<a name='6738'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB5'>TAUGB5</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB5_1">(kts,ktep1,COLH2O,COLCO2,COLO3,FAC00,FAC01,FAC10,FAC11, &amp;<a name='6739'>
                  SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,WX,PFRAC,TAUG,      &amp;<a name='6740'>
                  LAYTROP)<a name='6741'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB6'>TAUGB6</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB6_1">(kts,ktep1,COLH2O,CO2MULT,FAC00,FAC01,FAC10,FAC11,      &amp;<a name='6742'>
                  SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,WX,PFRAC,TAUG,      &amp;<a name='6743'>
                  LAYTROP)<a name='6744'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB7'>TAUGB7</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB7_1">(kts,ktep1,COLH2O,COLO3,CO2MULT,FAC00,FAC01,FAC10,FAC11,&amp;<a name='6745'>
                  SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,         &amp;<a name='6746'>
                  LAYTROP)<a name='6747'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB8'>TAUGB8</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB8_1">(kts,ktep1,COLH2O,COLO3,COLN2O,CO2MULT,FAC00,FAC01,FAC10,&amp;<a name='6748'>
                  FAC11,SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,WX,PFRAC,TAUG,&amp;<a name='6749'>
                  LAYSWTCH)<a name='6750'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB9'>TAUGB9</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB9_1">(kts,ktep1,COLH2O,COLN2O,COLCH4,FAC00,FAC01,FAC10,FAC11,&amp;<a name='6751'>
                  SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,         &amp;<a name='6752'>
                  LAYTROP,LAYSWTCH,LAYLOW)<a name='6753'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB10'>TAUGB10</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB10_1">(kts,ktep1,COLH2O,FAC00,FAC01,FAC10,FAC11,JP,JT,JT1,&amp;<a name='6754'>
                  PFRAC,TAUG,LAYTROP)<a name='6755'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB11'>TAUGB11</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB11_1">(kts,ktep1,COLH2O,FAC00,FAC01,FAC10,FAC11,             &amp;<a name='6756'>
                  SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,         &amp;<a name='6757'>
                  LAYTROP)<a name='6758'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB12'>TAUGB12</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB12_1">(kts,ktep1,COLH2O,COLCO2,FAC00,FAC01,FAC10,FAC11,      &amp;<a name='6759'>
                  SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,         &amp;<a name='6760'>
                  LAYTROP)<a name='6761'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB13'>TAUGB13</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB13_1">(kts,ktep1,COLH2O,COLN2O,FAC00,FAC01,FAC10,FAC11,      &amp;<a name='6762'>
                  SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,         &amp;<a name='6763'>
                  LAYTROP)<a name='6764'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB14'>TAUGB14</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB14_1">(kts,ktep1,COLCO2,FAC00,FAC01,FAC10,FAC11,             &amp;<a name='6765'>
                  SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,         &amp;<a name='6766'>
                  LAYTROP)<a name='6767'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB15'>TAUGB15</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB15_1">(kts,ktep1,COLH2O,COLCO2,COLN2O,FAC00,FAC01,FAC10,FAC11,&amp;<a name='6768'>
                  SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,         &amp;<a name='6769'>
                  LAYTROP)<a name='6770'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lw.F.html#TAUGB16'>TAUGB16</A><A href='../../html_code/phys/module_ra_rrtm.F.html#GASABS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUGB16_1">(kts,ktep1,COLH2O,COLCH4,FAC00,FAC01,FAC10,FAC11,      &amp;<a name='6771'>
                  SELFFAC,SELFFRAC,JP,JT,JT1,INDSELF,PFRAC,TAUG,         &amp;<a name='6772'>
                  LAYTROP)<a name='6773'>
                                                                                 <a name='6774'>
<font color=#447700>!  Compute the lookup table index from the Pade approximation of the             <a name='6775'></font>
<font color=#447700>!  tau transition function, which is derived from the optical depth.             <a name='6776'></font>
                                                                                 <a name='6777'>
      DO 6000 LAY = 1, NLAYERS                                                   <a name='6778'>
         DO 5000 IPR = 1, NGPT                                                   <a name='6779'>
            ODEPTH = SECANG * TAUG(IPR,LAY)                                       <a name='6780'>
            TFF = ODEPTH/(BPADE+ODEPTH)                                           <a name='6781'>
            IF (ODEPTH.LE.0.) TFF=0.                                              <a name='6782'>
            ITR(IPR,LAY) = INT(5.E3*TFF+0.5)<a name='6783'>
 5000    CONTINUE                                                                <a name='6784'>
 6000 CONTINUE                                                                   <a name='6785'>
      <a name='6786'>
   END SUBROUTINE GASABS<a name='6787'>
<a name='6788'>
<font color=#447700>!====================================================================<a name='6789'></font>
<A NAME='RRTMINIT'><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTMINIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6790'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>rrtminit</font>(                                             &amp; <A href='../../call_to/RRTMINIT.html' TARGET='index'>2</A>,<A href='../../call_from/RRTMINIT.html' TARGET='index'>1</A><a name='6791'>
                       p_top, allowed_to_read ,                     &amp;<a name='6792'>
                       ids, ide, jds, jde, kds, kde,                &amp;<a name='6793'>
                       ims, ime, jms, jme, kms, kme,                &amp;<a name='6794'>
                       its, ite, jts, jte, kts, kte                 )<a name='6795'>
<font color=#447700>!--------------------------------------------------------------------<a name='6796'></font>
   IMPLICIT NONE<a name='6797'>
<font color=#447700>!--------------------------------------------------------------------<a name='6798'></font>
<a name='6799'>
   LOGICAL , INTENT(IN)           :: allowed_to_read<a name='6800'>
   INTEGER , INTENT(IN)           :: ids, ide, jds, jde, kds, kde,  &amp;<a name='6801'>
                                     ims, ime, jms, jme, kms, kme,  &amp;<a name='6802'>
                                     its, ite, jts, jte, kts, kte<a name='6803'>
   REAL, INTENT(IN)               :: p_top <a name='6804'>
<font color=#447700>!  REAL, PARAMETER                :: deltap = 4  ! Pressure interval for buffer layer (hPa)<a name='6805'></font>
<a name='6806'>
   REAL :: pi<a name='6807'>
<a name='6808'>
   PI = 2.*ASIN(1.) <a name='6809'>
   FLUXFAC  = PI   * 2.D4                     <a name='6810'>
  <font color=#447700>!NLAYERS = kme<a name='6811'></font>
   NLAYERS = kme + nint(p_top*0.01/deltap)- 1 <font color=#447700>! Model levels plus new levels<a name='6812'></font>
<a name='6813'>
   IF ( allowed_to_read ) THEN<a name='6814'>
     CALL <A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE'>rrtm_lookuptable</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTMINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTM_LOOKUPTABLE_1"><a name='6815'>
   ENDIF<a name='6816'>
<a name='6817'>
   END SUBROUTINE rrtminit<a name='6818'>
<a name='6819'>
<a name='6820'>
<font color=#447700>! **************************************************************************     <a name='6821'></font>
<A NAME='RRTM_LOOKUPTABLE'><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6822'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>rrtm_lookuptable</font> <A href='../../call_to/RRTM_LOOKUPTABLE.html' TARGET='index'>1</A>,<A href='../../call_from/RRTM_LOOKUPTABLE.html' TARGET='index'>22</A><a name='6823'>
<font color=#447700>! **************************************************************************     <a name='6824'></font>
<a name='6825'>
USE <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_77"><a name='6826'>
<font color=#447700>!USE module_dm, ONLY : wrf_dm_bcast_bytes<a name='6827'></font>
IMPLICIT NONE<a name='6828'>
<a name='6829'>
<font color=#447700>!  RRTM Longwave Radiative Transfer Model                                        <a name='6830'></font>
<font color=#447700>!  Atmospheric and Environmental Research, Inc., Cambridge, MA                   <a name='6831'></font>
<font color=#447700>!                                                                                <a name='6832'></font>
<font color=#447700>!  Original version:       Michael J. Iacono; July, 1998                         <a name='6833'></font>
<font color=#447700>!  Revision for NCAR CCM:  Michael J. Iacono; September, 1998                    <a name='6834'></font>
<font color=#447700>!                                                                                <a name='6835'></font>
<font color=#447700>!  This subroutine performs calculations necessary for the initialization        <a name='6836'></font>
<font color=#447700>!  of the LW model, RRTM.  Lookup tables are computed for use in the LW          <a name='6837'></font>
<font color=#447700>!  radiative transfer, and input absorption coefficient data for each            <a name='6838'></font>
<font color=#447700>!  spectral band are reduced from 256 g-points to 140 for use in RRTM.           <a name='6839'></font>
<font color=#447700>! **************************************************************************     <a name='6840'></font>
                                                                                 <a name='6841'>
<font color=#447700>! Definitions                                                                    <a name='6842'></font>
<font color=#447700>!     Arrays for 5000-point look-up tables:                                      <a name='6843'></font>
<font color=#447700>!     TAU     Clear-sky optical depth (used in cloudy radiative transfer)        <a name='6844'></font>
<font color=#447700>!     TF      Tau transition function; i.e. the transition of the Planck         <a name='6845'></font>
<font color=#447700>!             function from that for the mean layer temperature to that for      <a name='6846'></font>
<font color=#447700>!             the layer boundary temperature as a function of optical depth.     <a name='6847'></font>
<font color=#447700>!             The "linear in tau" method is used to make the table.              <a name='6848'></font>
<font color=#447700>!     TRANS   Transmittance                                                      <a name='6849'></font>
<font color=#447700>!     BPADE   Inverse of the Pade approximation constant (= 1./0.278)            <a name='6850'></font>
<a name='6851'>
<font color=#447700>! Local                                    <a name='6852'></font>
      INTEGER :: i,itre,igcsm,ibnd,igc,ind,ig,ipr,iprsm<a name='6853'>
      REAL :: tfn,fp,rtfp,wtsum                                        <a name='6854'>
      LOGICAL                 :: opened<a name='6855'>
      LOGICAL , EXTERNAL      :: wrf_dm_on_monitor<a name='6856'>
<a name='6857'>
      REAL :: WTSM(MG)                       <a name='6858'>
      CHARACTER*80 errmess<a name='6859'>
      INTEGER rrtm_unit<a name='6860'>
<a name='6861'>
      IF ( wrf_dm_on_monitor() ) THEN<a name='6862'>
        DO i = 10,99<a name='6863'>
          INQUIRE ( i , OPENED = opened )<a name='6864'>
          IF ( .NOT. opened ) THEN<a name='6865'>
            rrtm_unit = i<a name='6866'>
            GOTO 2010<a name='6867'>
          ENDIF<a name='6868'>
        ENDDO<a name='6869'>
        rrtm_unit = -1<a name='6870'>
 2010   CONTINUE<a name='6871'>
      ENDIF<a name='6872'>
      CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_316"> ( rrtm_unit , IWORDSIZE )<a name='6873'>
      IF ( rrtm_unit &lt; 0 ) THEN<a name='6874'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1025"> ( 'module_ra_rrtm: rrtm_lookuptable: Can not '// &amp;<a name='6875'>
                               'find unused fortran unit to read in lookup table.' )<a name='6876'>
      ENDIF<a name='6877'>
<a name='6878'>
<font color=#447700>! start data 1<a name='6879'></font>
<a name='6880'>
<font color=#447700>! **************************************************************************     <a name='6881'></font>
<font color=#447700>!  RRTM Longwave Radiative Transfer Model                                        <a name='6882'></font>
<font color=#447700>!  Atmospheric and Environmental Research, Inc., Cambridge, MA                   <a name='6883'></font>
<font color=#447700>!                                                                                <a name='6884'></font>
<font color=#447700>!  Original version:       E. J. Mlawer, et al.                                  <a name='6885'></font>
<font color=#447700>!  Revision for NCAR CCM:  Michael J. Iacono; September, 1998                    <a name='6886'></font>
<font color=#447700>!                                                                                <a name='6887'></font>
<font color=#447700>!  This routine contains 16 READ statements that include the                <a name='6888'></font>
<font color=#447700>!  absorption coefficients and other data for each of the 16 longwave            <a name='6889'></font>
<font color=#447700>!  spectral bands used in RRTM.  Here, the data are defined for 16               <a name='6890'></font>
<font color=#447700>!  g-points, or sub-intervals, per band.  These data are combined and            <a name='6891'></font>
<font color=#447700>!  weighted using a mapping procedure in routine RRTMINIT to reduce              <a name='6892'></font>
<font color=#447700>!  the total number of g-points from 256 to 140 for use in the CCM.              <a name='6893'></font>
<font color=#447700>! **************************************************************************     <a name='6894'></font>
        IF ( wrf_dm_on_monitor() ) THEN<a name='6895'>
          OPEN(rrtm_unit,FILE='RRTM_DATA',                  &amp;<a name='6896'>
               FORM='UNFORMATTED',STATUS='OLD',ERR=9009)<a name='6897'>
        ENDIF<a name='6898'>
                                                                                 <a name='6899'>
<font color=#447700>!     The array abscoefL1 contains absorption coefs at the 16 chosen g-values   <a name='6900'></font>
<font color=#447700>!     for a range of pressure levels &gt; ~100mb and temperatures.  The first       <a name='6901'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to     <a name='6902'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='6903'></font>
<font color=#447700>!     data are for the corresponding TREF for this  pressure level,              <a name='6904'></font>
<font color=#447700>!     JT = 2 refers to the temperatureTREF-15, JT = 1 is for TREF-30,            <a name='6905'></font>
<font color=#447700>!     JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  The second              <a name='6906'></font>
<font color=#447700>!     index, JP, runs from 1 to 13 and refers to the corresponding               <a name='6907'></font>
<font color=#447700>!     pressure level in PREF (e.g. JP = 1 is for a pressure of 1053.63 mb).      <a name='6908'></font>
<font color=#447700>!     The third index, IG, goes from 1 to 16, and tells us which                 <a name='6909'></font>
<font color=#447700>!     g-interval the absorption coefficients are for.                            <a name='6910'></font>
<a name='6911'>
<a name='6912'>
                                                                                 <a name='6913'>
<font color=#447700>!     The array abscoefH1 contains absorption coefs at the 16 chosen g-values           <a name='6914'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first        <a name='6915'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='6916'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='6917'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure              <a name='6918'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for             <a name='6919'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.                 <a name='6920'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth            <a name='6921'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these              <a name='6922'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16, &amp;        <a name='6923'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.         <a name='6924'></font>
<a name='6925'>
                                                                                 <a name='6926'>
<font color=#447700>!     The array SELFREF1 contains the coefficient of the water vapor              <a name='6927'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='6928'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='6929'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='6930'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='6931'></font>
<a name='6932'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_317"> ( A , size ( A ) * RWORDSIZE )<a name='6933'>
<a name='6934'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL1, abscoefH1, SELFREF1<a name='6935'>
         DM_BCAST_MACRO(abscoefL1)<a name='6936'>
         DM_BCAST_MACRO(abscoefH1)<a name='6937'>
         DM_BCAST_MACRO(SELFREF1)<a name='6938'>
<a name='6939'>
<font color=#447700>! **************************************************************************     <a name='6940'></font>
<font color=#447700>!     The array abscoefL2 contains absorption coefs at the 16 chosen g-values <a name='6941'></font>
<font color=#447700>!     for a range of pressure levels &gt; ~100mb and temperatures.  The first       <a name='6942'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='6943'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='6944'></font>
<font color=#447700>!     data are for the corresponding TREF for this  pressure level, &amp;           <a name='6945'></font>
<font color=#447700>!     JT = 2 refers to the temperatureTREF-15, JT = 1 is for TREF-30, &amp;         <a name='6946'></font>
<font color=#447700>!     JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  The second              <a name='6947'></font>
<font color=#447700>!     index, JP, runs from 1 to 13 and refers to the corresponding               <a name='6948'></font>
<font color=#447700>!     pressure level in PREF (e.g. JP = 1 is for a pressure of 1053.63 mb).      <a name='6949'></font>
<font color=#447700>!     The third index, IG, goes from 1 to 16, and tells us which                 <a name='6950'></font>
<font color=#447700>!     g-interval the absorption coefficients are for.                            <a name='6951'></font>
<a name='6952'>
                                                                                 <a name='6953'>
<font color=#447700>!     The array abscoefH2 contains absorption coefs at the 16 chosen g-values           <a name='6954'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first        <a name='6955'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='6956'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='6957'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure              <a name='6958'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for             <a name='6959'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.                 <a name='6960'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth            <a name='6961'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these              <a name='6962'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16, &amp;        <a name='6963'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.         <a name='6964'></font>
<a name='6965'>
                                                                                 <a name='6966'>
<font color=#447700>!     The array SELFREF2 contains the coefficient of the water vapor              <a name='6967'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='6968'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='6969'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='6970'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='6971'></font>
<a name='6972'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL2, abscoefH2, SELFREF2<a name='6973'>
         DM_BCAST_MACRO(abscoefL2)<a name='6974'>
         DM_BCAST_MACRO(abscoefH2)<a name='6975'>
         DM_BCAST_MACRO(SELFREF2)<a name='6976'>
                                                                                 <a name='6977'>
<font color=#447700>! **************************************************************************     <a name='6978'></font>
<a name='6979'>
<font color=#447700>!     The array abscoefL3 contains absorption coefs for each of the 16 g-intervals   <a name='6980'></font>
<font color=#447700>!     for a range of pressure levels &gt; ~100mb, temperatures, and ratios          <a name='6981'></font>
<font color=#447700>!     of water vapor to CO2.  The first index in the array, JS, runs             <a name='6982'></font>
<font color=#447700>!     from 1 to 10, and corresponds to different water vapor to CO2 ratios, &amp;   <a name='6983'></font>
<font color=#447700>!     as expressed through the binary species parameter eta, defined as          <a name='6984'></font>
<font color=#447700>!     eta = h2o/(h20 + (rat) * co2), where rat is the ratio of the integrated    <a name='6985'></font>
<font color=#447700>!     line strength in the band of co2 to that of h2o.  For instance, &amp;         <a name='6986'></font>
<font color=#447700>!     JS=1 refers to dry air (eta = 0), JS = 10 corresponds to eta = 1.0.        <a name='6987'></font>
<font color=#447700>!     The 2nd index in the array, JT, which runs from 1 to 5, corresponds        <a name='6988'></font>
<font color=#447700>!     to different temperatures.  More specifically, JT = 3 means that the       <a name='6989'></font>
<font color=#447700>!     data are for the reference temperature TREF for this  pressure             <a name='6990'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature                                    <a name='6991'></font>
<font color=#447700>!     TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5          <a name='6992'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers         <a name='6993'></font>
<font color=#447700>!     to the reference pressure level (e.g. JP = 1 is for a                      <a name='6994'></font>
<font color=#447700>!     pressure of 1053.63 mb).  The fourth index, IG, goes from 1 to 16, &amp;      <a name='6995'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.         <a name='6996'></font>
<a name='6997'>
                                                                                 <a name='6998'>
<font color=#447700>!     The array abscoefH3 contains absorption coefs for each of the 16 g-intervals      <a name='6999'></font>
<font color=#447700>!     for a range of pressure levels  &lt; ~100mb, temperatures, and ratios         <a name='7000'></font>
<font color=#447700>!     of H2O to CO2.  The first index in the array, JS, runs from 1 to 5, &amp;     <a name='7001'></font>
<font color=#447700>!     and corresponds to different H2O to CO2 ratios, as expressed through       <a name='7002'></font>
<font color=#447700>!     the binary species parameter eta, defined as eta = H2O/(H2O+RAT*CO2), &amp;   <a name='7003'></font>
<font color=#447700>!     where RAT is the ratio of the integrated line strength in the band         <a name='7004'></font>
<font color=#447700>!     of CO2 to that of H2O.  For instance, JS=1 refers to no H2O, &amp;            <a name='7005'></font>
<font color=#447700>!     JS = 2 corresponds to eta = 0.25, etc.  The second index, JT, which        <a name='7006'></font>
<font color=#447700>!     runs from 1 to 5, corresponds to different temperatures.  More             <a name='7007'></font>
<font color=#447700>!     specifically, JT = 3 means that the data are for the corresponding         <a name='7008'></font>
<font color=#447700>!     reference temperature TREF for this  pressure level, JT = 2 refers         <a name='7009'></font>
<font color=#447700>!     to the TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and          <a name='7010'></font>
<font color=#447700>!     JT = 5 is for TREF+30.  The third index, JP, runs from 13 to 59 and        <a name='7011'></font>
<font color=#447700>!     refers to the corresponding pressure level in PREF (e.g. JP = 13 is        <a name='7012'></font>
<font color=#447700>!     for a pressure of 95.5835 mb).  The fourth index, IG, goes from 1 to       <a name='7013'></font>
<font color=#447700>!     16, and tells us which g-interval the absorption coefficients are for.     <a name='7014'></font>
<a name='7015'>
                                                                                 <a name='7016'>
<font color=#447700>!     The array SELFREF3 contains the coefficient of the water vapor              <a name='7017'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='7018'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='7019'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='7020'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='7021'></font>
<a name='7022'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL3, abscoefH3, SELFREF3<a name='7023'>
         DM_BCAST_MACRO(abscoefL3)<a name='7024'>
         DM_BCAST_MACRO(abscoefH3)<a name='7025'>
         DM_BCAST_MACRO(SELFREF3)<a name='7026'>
                                                                                 <a name='7027'>
<font color=#447700>! **************************************************************************     <a name='7028'></font>
                                                                                 <a name='7029'>
<font color=#447700>!     The array abscoefL4 contains absorption coefs for each of the 16 g-intervals      <a name='7030'></font>
<font color=#447700>!     for a range of pressure levels &gt; ~100mb, temperatures, and ratios          <a name='7031'></font>
<font color=#447700>!     of water vapor to CO2.  The first index in the array, JS, runs             <a name='7032'></font>
<font color=#447700>!     from 1 to 9 and corresponds to different water vapor to CO2 ratios, &amp;     <a name='7033'></font>
<font color=#447700>!     as expressed through the binary species parameter eta, defined as          <a name='7034'></font>
<font color=#447700>!     eta = h2o/(h20 + (rat) * co2), where rat is the ratio of the integrated    <a name='7035'></font>
<font color=#447700>!     line strength in the band of co2 to that of h2o.  For instance, &amp;         <a name='7036'></font>
<font color=#447700>!     JS=1 refers to dry air (eta = 0), JS = 9 corresponds to eta = 1.0.         <a name='7037'></font>
<font color=#447700>!     The 2nd index in the array, JT, which runs from 1 to 5, corresponds        <a name='7038'></font>
<font color=#447700>!     to different temperatures.  More specifically, JT = 3 means that the       <a name='7039'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure              <a name='7040'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, &amp;                        <a name='7041'></font>
<font color=#447700>!     JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5                   <a name='7042'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers         <a name='7043'></font>
<font color=#447700>!     to the reference pressure level (e.g. JP = 1 is for a                      <a name='7044'></font>
<font color=#447700>!     pressure of 1053.63 mb).  The fourth index, IG, goes from 1 to 16, &amp;      <a name='7045'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.         <a name='7046'></font>
<a name='7047'>
                                                                                 <a name='7048'>
<font color=#447700>!     The array abscoefH4 contains absorption coefs for each of the 16 g-intervals      <a name='7049'></font>
<font color=#447700>!     for a range of pressure levels  &lt; ~100mb, temperatures, and ratios         <a name='7050'></font>
<font color=#447700>!     of O3 to CO2.  The first index in the array, JS, runs from 1 to 6, &amp;      <a name='7051'></font>
<font color=#447700>!     and corresponds to different O3 to CO2 ratios, as expressed through        <a name='7052'></font>
<font color=#447700>!     the binary species parameter eta, defined as eta = O3/(O3+RAT*H2O), &amp;     <a name='7053'></font>
<font color=#447700>!     where RAT is the ratio of the integrated line strength in the band         <a name='7054'></font>
<font color=#447700>!     of CO2 to that of O3.  For instance, JS=1 refers to no O3 (eta = 0)        <a name='7055'></font>
<font color=#447700>!     and JS = 5 corresponds to eta = 1.0.  The second index, JT, which          <a name='7056'></font>
<font color=#447700>!     runs from 1 to 5, corresponds to different temperatures.  More             <a name='7057'></font>
<font color=#447700>!     specifically, JT = 3 means that the data are for the corresponding         <a name='7058'></font>
<font color=#447700>!     reference temperature TREF for this  pressure level, JT = 2 refers         <a name='7059'></font>
<font color=#447700>!     to the TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and          <a name='7060'></font>
<font color=#447700>!     JT = 5 is for TREF+30.  The third index, JP, runs from 13 to 59 and        <a name='7061'></font>
<font color=#447700>!     refers to the corresponding pressure level in PREF (e.g. JP = 13 is        <a name='7062'></font>
<font color=#447700>!     for a pressure of 95.5835 mb).  The fourth index, IG, goes from 1 to       <a name='7063'></font>
<font color=#447700>!     16, and tells us which g-interval the absorption coefficients are for.     <a name='7064'></font>
<a name='7065'>
                                                                                 <a name='7066'>
<font color=#447700>!     The array SELFREF4 contains the coefficient of the water vapor              <a name='7067'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='7068'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='7069'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='7070'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='7071'></font>
<a name='7072'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL4, abscoefH4, SELFREF4<a name='7073'>
         DM_BCAST_MACRO(abscoefL4)<a name='7074'>
         DM_BCAST_MACRO(abscoefH4)<a name='7075'>
         DM_BCAST_MACRO(SELFREF4)<a name='7076'>
                                                                                 <a name='7077'>
<font color=#447700>! **************************************************************************     <a name='7078'></font>
                                                                                 <a name='7079'>
<font color=#447700>!     The array abscoefL5 contains absorption coefs for each of the 16 g-intervals<a name='7080'></font>
<font color=#447700>!     for a range of pressure levels &gt; ~100mb, temperatures, and ratios          <a name='7081'></font>
<font color=#447700>!     of water vapor to CO2.  The first index in the array, JS, runs             <a name='7082'></font>
<font color=#447700>!     from 1 to 9 and corresponds to different water vapor to CO2 ratios, &amp;     <a name='7083'></font>
<font color=#447700>!     as expressed through the binary species parameter eta, defined as          <a name='7084'></font>
<font color=#447700>!     eta = h2o/(h20 + (rat) * co2), where rat is the ratio of the integrated    <a name='7085'></font>
<font color=#447700>!     line strength in the band of co2 to that of h2o.  For instance, &amp;         <a name='7086'></font>
<font color=#447700>!     JS=1 refers to dry air (eta = 0), JS = 9 corresponds to eta = 1.0.         <a name='7087'></font>
<font color=#447700>!     The 2nd index in the array, JT, which runs from 1 to 5, corresponds        <a name='7088'></font>
<font color=#447700>!     to different temperatures.  More specifically, JT = 3 means that the       <a name='7089'></font>
<font color=#447700>!     data are for the reference temperature TREF for this  pressure             <a name='7090'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, &amp;                        <a name='7091'></font>
<font color=#447700>!     JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5                   <a name='7092'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers         <a name='7093'></font>
<font color=#447700>!     to the reference pressure level (e.g. JP = 1 is for a                      <a name='7094'></font>
<font color=#447700>!     pressure of 1053.63 mb).  The fourth index, IG, goes from 1 to 16, &amp;      <a name='7095'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.         <a name='7096'></font>
<a name='7097'>
                                                                                 <a name='7098'>
<font color=#447700>!     The array abscoefH5 contains absorption coefs for each of the 16 g-intervals      <a name='7099'></font>
<font color=#447700>!     for a range of pressure levels  &lt; ~100mb, temperatures, and ratios         <a name='7100'></font>
<font color=#447700>!     of O3 to CO2.  The first index in the array, JS, runs from 1 to 5, &amp;      <a name='7101'></font>
<font color=#447700>!     and corresponds to different O3 to CO2 ratios, as expressed through        <a name='7102'></font>
<font color=#447700>!     the binary species parameter eta, defined as eta = O3/(O3+RAT*CO2), &amp;     <a name='7103'></font>
<font color=#447700>!     where RAT is the ratio of the integrated line strength in the band         <a name='7104'></font>
<font color=#447700>!     of co2 to that of O3.  For instance, JS=1 refers to no O3 (eta = 0)        <a name='7105'></font>
<font color=#447700>!     and JS = 5 corresponds to eta = 1.0.  The second index, JT, which          <a name='7106'></font>
<font color=#447700>!     runs from 1 to 5, corresponds to different temperatures.  More             <a name='7107'></font>
<font color=#447700>!     specifically, JT = 3 means that the data are for the corresponding         <a name='7108'></font>
<font color=#447700>!     reference temperature TREF for this  pressure level, JT = 2 refers         <a name='7109'></font>
<font color=#447700>!     to the TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and          <a name='7110'></font>
<font color=#447700>!     JT = 5 is for TREF+30.  The third index, JP, runs from 13 to 59 and        <a name='7111'></font>
<font color=#447700>!     refers to the corresponding pressure level in PREF (e.g. JP = 13 is        <a name='7112'></font>
<font color=#447700>!     for a pressure of 95.5835 mb).  The fourth index, IG, goes from 1 to       <a name='7113'></font>
<font color=#447700>!     16, and tells us which g-interval the absorption coefficients are for.     <a name='7114'></font>
<a name='7115'>
                                                                                 <a name='7116'>
<font color=#447700>!     The array SELFREF5 contains the coefficient of the water vapor              <a name='7117'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='7118'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='7119'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='7120'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='7121'></font>
<a name='7122'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL5, abscoefH5, SELFREF5<a name='7123'>
         DM_BCAST_MACRO(abscoefL5)<a name='7124'>
         DM_BCAST_MACRO(abscoefH5)<a name='7125'>
         DM_BCAST_MACRO(SELFREF5)<a name='7126'>
                                                                                 <a name='7127'>
<font color=#447700>! **************************************************************************     <a name='7128'></font>
                                                                                 <a name='7129'>
<font color=#447700>!     The array abscoefL6 contains absorption coefs at the 16 chosen g-values    <a name='7130'></font>
<font color=#447700>!     for a range of pressure levels &gt; ~100mb and temperatures.  The first       <a name='7131'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='7132'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='7133'></font>
<font color=#447700>!     data are for the corresponding TREF for this  pressure level, &amp;           <a name='7134'></font>
<font color=#447700>!     JT = 2 refers to the temperatureTREF-15, JT = 1 is for TREF-30, &amp;         <a name='7135'></font>
<font color=#447700>!     JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  The second              <a name='7136'></font>
<font color=#447700>!     index, JP, runs from 1 to 13 and refers to the corresponding               <a name='7137'></font>
<font color=#447700>!     pressure level in PREF (e.g. JP = 1 is for a pressure of 1053.63 mb).      <a name='7138'></font>
<font color=#447700>!     The third index, IG, goes from 1 to 16, and tells us which                 <a name='7139'></font>
<font color=#447700>!     g-interval the absorption coefficients are for.                            <a name='7140'></font>
<a name='7141'>
                                                                                 <a name='7142'>
<font color=#447700>!     The array SELFREF6 contains the coefficient of the water vapor              <a name='7143'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='7144'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='7145'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='7146'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='7147'></font>
<a name='7148'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL6, SELFREF6<a name='7149'>
         DM_BCAST_MACRO(abscoefL6)<a name='7150'>
         DM_BCAST_MACRO(SELFREF6)<a name='7151'>
                                                                                 <a name='7152'>
<font color=#447700>! **************************************************************************     <a name='7153'></font>
                                                                                 <a name='7154'>
<font color=#447700>!     The array abscoefL7 contains absorption coefs at the 16 chosen g-values           <a name='7155'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary           <a name='7156'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first               <a name='7157'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to               <a name='7158'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, &amp;        <a name='7159'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, &amp;   <a name='7160'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index      <a name='7161'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different         <a name='7162'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for       <a name='7163'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers     <a name='7164'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5       <a name='7165'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers         <a name='7166'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels        <a name='7167'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates            <a name='7168'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.                      <a name='7169'></font>
<a name='7170'>
                                                                                 <a name='7171'>
<font color=#447700>!     The array abscoefH7 contains absorption coefs at the 16 chosen g-values           <a name='7172'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first        <a name='7173'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='7174'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='7175'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure              <a name='7176'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for             <a name='7177'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.                 <a name='7178'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth            <a name='7179'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these              <a name='7180'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16, &amp;        <a name='7181'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.         <a name='7182'></font>
<a name='7183'>
                                                                                 <a name='7184'>
<font color=#447700>!     The array SELFREF7 contains the coefficient of the water vapor              <a name='7185'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='7186'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='7187'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='7188'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='7189'></font>
<a name='7190'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL7, abscoefH7, SELFREF7<a name='7191'>
         DM_BCAST_MACRO(abscoefL7)<a name='7192'>
         DM_BCAST_MACRO(abscoefH7)<a name='7193'>
         DM_BCAST_MACRO(SELFREF7)<a name='7194'>
                                                                                 <a name='7195'>
<font color=#447700>! **************************************************************************<a name='7196'></font>
                                                                                 <a name='7197'>
<font color=#447700>!     The array abscoefL8 contains absorption coefs at the 16 chosen g-values    <a name='7198'></font>
<font color=#447700>!     for a range of pressure levels &gt; ~100mb and temperatures.  The first       <a name='7199'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='7200'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='7201'></font>
<font color=#447700>!     data are for the corresponding TREF for this  pressure level, &amp;           <a name='7202'></font>
<font color=#447700>!     JT = 2 refers to the temperatureTREF-15, JT = 1 is for TREF-30, &amp;         <a name='7203'></font>
<font color=#447700>!     JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  The second              <a name='7204'></font>
<font color=#447700>!     index, JP, runs from 1 to 13 and refers to the corresponding               <a name='7205'></font>
<font color=#447700>!     pressure level in PREF (e.g. JP = 1 is for a pressure of 1053.63 mb).      <a name='7206'></font>
<font color=#447700>!     The third index, IG, goes from 1 to 16, and tells us which                 <a name='7207'></font>
<font color=#447700>!     g-interval the absorption coefficients are for.                            <a name='7208'></font>
<font color=#447700>!     The array abscoefL8 contains absorption coef5s at the 16 chosen g-values          <a name='7209'></font>
<font color=#447700>!     for a range of pressure levels &gt; ~100mb and temperatures.  The first       <a name='7210'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='7211'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='7212'></font>
<font color=#447700>!     data are for the cooresponding TREF for this  pressure level, &amp;           <a name='7213'></font>
<font color=#447700>!     JT = 2 refers to the temperature                                           <a name='7214'></font>
<font color=#447700>!     TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5          <a name='7215'></font>
<font color=#447700>!     is for TREF+30.  The second index, JP, runs from 1 to 13 and refers        <a name='7216'></font>
<font color=#447700>!     to the corresponding pressure level in PREF (e.g. JP = 1 is for a          <a name='7217'></font>
<font color=#447700>!     pressure of 1053.63 mb).  The third index, IG, goes from 1 to 16, &amp;       <a name='7218'></font>
<font color=#447700>!     and tells us which "g-channel" the absorption coefficients are for.        <a name='7219'></font>
<a name='7220'>
                                                                                 <a name='7221'>
<font color=#447700>!     The array abscoefH8 contains absorption coefs at the 16 chosen g-values           <a name='7222'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first        <a name='7223'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='7224'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='7225'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure              <a name='7226'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for             <a name='7227'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.                 <a name='7228'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth            <a name='7229'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these              <a name='7230'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16, &amp;        <a name='7231'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.         <a name='7232'></font>
<a name='7233'>
<font color=#447700>!                                                                                <a name='7234'></font>
<font color=#447700>!       SELFREF8 is the array for the self-continuum.                                   <a name='7235'></font>
<font color=#447700>!                                                                                <a name='7236'></font>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL8, abscoefH8, SELFREF8<a name='7237'>
         DM_BCAST_MACRO(abscoefL8)<a name='7238'>
         DM_BCAST_MACRO(abscoefH8)<a name='7239'>
         DM_BCAST_MACRO(SELFREF8)<a name='7240'>
                                                                                 <a name='7241'>
<font color=#447700>! **************************************************************************<a name='7242'></font>
                                                                                 <a name='7243'>
<font color=#447700>!     The array abscoefL9 contains absorption coefs at the 16 chosen g-values    <a name='7244'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary           <a name='7245'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first               <a name='7246'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 11, and corresponds to              <a name='7247'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, &amp;        <a name='7248'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, &amp;   <a name='7249'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index      <a name='7250'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different         <a name='7251'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for       <a name='7252'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers     <a name='7253'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5       <a name='7254'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers         <a name='7255'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels        <a name='7256'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates            <a name='7257'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.                      <a name='7258'></font>
<a name='7259'>
                                                                                 <a name='7260'>
<font color=#447700>!     The array abscoefH9 contains absorption coefs at the 16 chosen g-values           <a name='7261'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first        <a name='7262'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='7263'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='7264'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure              <a name='7265'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for             <a name='7266'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.                 <a name='7267'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth            <a name='7268'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these              <a name='7269'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16, &amp;        <a name='7270'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.         <a name='7271'></font>
<a name='7272'>
                                                                                 <a name='7273'>
<font color=#447700>!     The array SELFREF9 contains the coefficient of the water vapor              <a name='7274'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='7275'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='7276'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='7277'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='7278'></font>
<a name='7279'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL9, abscoefH9, SELFREF9<a name='7280'>
         DM_BCAST_MACRO(abscoefL9)<a name='7281'>
         DM_BCAST_MACRO(abscoefH9)<a name='7282'>
         DM_BCAST_MACRO(SELFREF9)<a name='7283'>
                                                                                 <a name='7284'>
<font color=#447700>! **************************************************************************<a name='7285'></font>
                                                                                 <a name='7286'>
<font color=#447700>!     The array abscoefL10 contains absorption coefs at the 16 chosen g-values   <a name='7287'></font>
<font color=#447700>!     for a range of pressure levels &gt; ~100mb and temperatures.  The first       <a name='7288'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='7289'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='7290'></font>
<font color=#447700>!     data are for the corresponding TREF for this  pressure level, &amp;           <a name='7291'></font>
<font color=#447700>!     JT = 2 refers to the temperatureTREF-15, JT = 1 is for TREF-30, &amp;         <a name='7292'></font>
<font color=#447700>!     JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  The second              <a name='7293'></font>
<font color=#447700>!     index, JP, runs from 1 to 13 and refers to the corresponding               <a name='7294'></font>
<font color=#447700>!     pressure level in PREF (e.g. JP = 1 is for a pressure of 1053.63 mb).      <a name='7295'></font>
<font color=#447700>!     The third index, IG, goes from 1 to 16, and tells us which                 <a name='7296'></font>
<font color=#447700>!     g-interval the absorption coefficients are for.                            <a name='7297'></font>
<a name='7298'>
                                                                                 <a name='7299'>
<font color=#447700>!     The array abscoefH10 contains absorption coefs at the 16 chosen g-values           <a name='7300'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first        <a name='7301'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='7302'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='7303'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure              <a name='7304'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for             <a name='7305'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.                 <a name='7306'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth            <a name='7307'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these              <a name='7308'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16, &amp;        <a name='7309'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.         <a name='7310'></font>
<a name='7311'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL10, abscoefH10<a name='7312'>
         DM_BCAST_MACRO(abscoefL10)<a name='7313'>
         DM_BCAST_MACRO(abscoefH10)<a name='7314'>
                                                                                 <a name='7315'>
<font color=#447700>! **************************************************************************<a name='7316'></font>
                                                                                 <a name='7317'>
<font color=#447700>!     The array abscoefL11 contains absorption coefs at the 16 chosen g-values   <a name='7318'></font>
<font color=#447700>!     for a range of pressure levels &gt; ~100mb and temperatures.  The first       <a name='7319'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='7320'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='7321'></font>
<font color=#447700>!     data are for the corresponding TREF for this  pressure level, &amp;           <a name='7322'></font>
<font color=#447700>!     JT = 2 refers to the temperatureTREF-15, JT = 1 is for TREF-30, &amp;         <a name='7323'></font>
<font color=#447700>!     JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  The second              <a name='7324'></font>
<font color=#447700>!     index, JP, runs from 1 to 13 and refers to the corresponding               <a name='7325'></font>
<font color=#447700>!     pressure level in PREF (e.g. JP = 1 is for a pressure of 1053.63 mb).      <a name='7326'></font>
<font color=#447700>!     The third index, IG, goes from 1 to 16, and tells us which                 <a name='7327'></font>
<font color=#447700>!     g-interval the absorption coefficients are for.                            <a name='7328'></font>
<a name='7329'>
                                                                                 <a name='7330'>
<font color=#447700>!     The array abscoefH11 contains absorption coefs at the 16 chosen g-values           <a name='7331'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first        <a name='7332'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='7333'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='7334'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure              <a name='7335'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for             <a name='7336'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.                 <a name='7337'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth            <a name='7338'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these              <a name='7339'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16, &amp;        <a name='7340'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.         <a name='7341'></font>
<a name='7342'>
                                                                                 <a name='7343'>
<font color=#447700>!     The array SELFREF11 contains the coefficient of the water vapor              <a name='7344'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='7345'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='7346'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='7347'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='7348'></font>
<a name='7349'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL11, abscoefH11, SELFREF11<a name='7350'>
         DM_BCAST_MACRO(abscoefL11)<a name='7351'>
         DM_BCAST_MACRO(abscoefH11)<a name='7352'>
         DM_BCAST_MACRO(SELFREF11)<a name='7353'>
                                                                                        <a name='7354'>
<font color=#447700>! **************************************************************************<a name='7355'></font>
                                                                                 <a name='7356'>
<font color=#447700>!     The array abscoefL12 contains absorption coefs at the 16 chosen g-values   <a name='7357'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary           <a name='7358'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first               <a name='7359'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to               <a name='7360'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, &amp;        <a name='7361'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, &amp;   <a name='7362'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index      <a name='7363'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different         <a name='7364'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for       <a name='7365'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers     <a name='7366'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5       <a name='7367'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers         <a name='7368'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels        <a name='7369'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates            <a name='7370'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.                      <a name='7371'></font>
<a name='7372'>
                                                                                 <a name='7373'>
<font color=#447700>!     The array SELFREF12 contains the coefficient of the water vapor              <a name='7374'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='7375'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='7376'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='7377'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='7378'></font>
<a name='7379'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL12, SELFREF12<a name='7380'>
         DM_BCAST_MACRO(abscoefL12)<a name='7381'>
         DM_BCAST_MACRO(SELFREF12)<a name='7382'>
                                                                                 <a name='7383'>
<font color=#447700>! **************************************************************************<a name='7384'></font>
                                                                                 <a name='7385'>
<font color=#447700>!     The array abscoefL13 contains absorption coefs at the 16 chosen g-values   <a name='7386'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary           <a name='7387'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first               <a name='7388'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to               <a name='7389'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, &amp;        <a name='7390'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, &amp;   <a name='7391'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index      <a name='7392'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different         <a name='7393'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for       <a name='7394'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers     <a name='7395'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5       <a name='7396'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers         <a name='7397'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels        <a name='7398'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates            <a name='7399'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.                      <a name='7400'></font>
<a name='7401'>
                                                                                 <a name='7402'>
<font color=#447700>!     The array SELFREF13 contains the coefficient of the water vapor              <a name='7403'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='7404'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='7405'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='7406'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='7407'></font>
<a name='7408'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL13, SELFREF13<a name='7409'>
         DM_BCAST_MACRO(abscoefL13)<a name='7410'>
         DM_BCAST_MACRO(SELFREF13)<a name='7411'>
                                                                                 <a name='7412'>
<font color=#447700>! **************************************************************************<a name='7413'></font>
                                                                                 <a name='7414'>
<font color=#447700>!     The array abscoefL14 contains absorption coefs at the 16 chosen g-values   <a name='7415'></font>
<font color=#447700>!     for a range of pressure levels &gt; ~100mb and temperatures.  The first       <a name='7416'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='7417'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='7418'></font>
<font color=#447700>!     data are for the corresponding TREF for this  pressure level, &amp;           <a name='7419'></font>
<font color=#447700>!     JT = 2 refers to the temperatureTREF-15, JT = 1 is for TREF-30, &amp;         <a name='7420'></font>
<font color=#447700>!     JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  The second              <a name='7421'></font>
<font color=#447700>!     index, JP, runs from 1 to 13 and refers to the corresponding               <a name='7422'></font>
<font color=#447700>!     pressure level in PREF (e.g. JP = 1 is for a pressure of 1053.63 mb).      <a name='7423'></font>
<font color=#447700>!     The third index, IG, goes from 1 to 16, and tells us which                 <a name='7424'></font>
<font color=#447700>!     g-interval the absorption coefficients are for.                            <a name='7425'></font>
<a name='7426'>
                                                                                 <a name='7427'>
<font color=#447700>!     The array abscoefH14 contains absorption coefs at the 16 chosen g-values           <a name='7428'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first        <a name='7429'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to             <a name='7430'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the          <a name='7431'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure              <a name='7432'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for             <a name='7433'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.                 <a name='7434'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth            <a name='7435'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these              <a name='7436'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16, &amp;        <a name='7437'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.         <a name='7438'></font>
<a name='7439'>
                                                                                 <a name='7440'>
<font color=#447700>!     The array SELFREF14 contains the coefficient of the water vapor              <a name='7441'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='7442'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='7443'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='7444'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='7445'></font>
<a name='7446'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL14, abscoefH14, SELFREF14<a name='7447'>
         DM_BCAST_MACRO(abscoefL14)<a name='7448'>
         DM_BCAST_MACRO(abscoefH14)<a name='7449'>
         DM_BCAST_MACRO(SELFREF14)<a name='7450'>
                                                                                        <a name='7451'>
<font color=#447700>! **************************************************************************<a name='7452'></font>
                                                                                 <a name='7453'>
<font color=#447700>!     The array abscoefL15 contains absorption coefs at the 16 chosen g-values   <a name='7454'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary           <a name='7455'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first               <a name='7456'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to               <a name='7457'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, &amp;        <a name='7458'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, &amp;   <a name='7459'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index      <a name='7460'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different         <a name='7461'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for       <a name='7462'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers     <a name='7463'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5       <a name='7464'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers         <a name='7465'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels        <a name='7466'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates            <a name='7467'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.                      <a name='7468'></font>
<a name='7469'>
                                                                                 <a name='7470'>
<font color=#447700>!     The array SELFREF15 contains the coefficient of the water vapor              <a name='7471'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='7472'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='7473'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='7474'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='7475'></font>
<a name='7476'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL15, SELFREF15<a name='7477'>
         DM_BCAST_MACRO(abscoefL15)<a name='7478'>
         DM_BCAST_MACRO(SELFREF15)<a name='7479'>
                                                                                 <a name='7480'>
<font color=#447700>! **************************************************************************<a name='7481'></font>
                                                                                 <a name='7482'>
<font color=#447700>!     The array abscoefL16 contains absorption coefs at the 16 chosen g-values  <a name='7483'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary           <a name='7484'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first               <a name='7485'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to               <a name='7486'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, &amp;        <a name='7487'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, &amp;   <a name='7488'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index      <a name='7489'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different         <a name='7490'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for       <a name='7491'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers     <a name='7492'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5       <a name='7493'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers         <a name='7494'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels        <a name='7495'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates            <a name='7496'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.                      <a name='7497'></font>
<a name='7498'>
                                                                                 <a name='7499'>
<font color=#447700>!     The array SELFREF16 contains the coefficient of the water vapor              <a name='7500'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index               <a name='7501'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance, &amp;          <a name='7502'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8, &amp;        <a name='7503'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).                  <a name='7504'></font>
<a name='7505'>
         IF ( wrf_dm_on_monitor() ) READ (rrtm_unit,ERR=9010) abscoefL16, SELFREF16<a name='7506'>
         DM_BCAST_MACRO(abscoefL16)<a name='7507'>
         DM_BCAST_MACRO(SELFREF16)<a name='7508'>
<a name='7509'>
         IF ( wrf_dm_on_monitor() ) CLOSE (rrtm_unit)<a name='7510'>
                                                                                 <a name='7511'>
<font color=#447700>!-----------------------------------------------------------------------<a name='7512'></font>
                                                            <a name='7513'>
                <a name='7514'>
                                                                           <a name='7515'>
<font color=#447700>!  Compute lookup tables for transmittance, tau transition function,             <a name='7516'></font>
<font color=#447700>!  and clear sky tau (for the cloudy sky radiative transfer).  Tau is            <a name='7517'></font>
<font color=#447700>!  computed as a function of the tau transition function, transmittance          <a name='7518'></font>
<font color=#447700>!  is calculated as a function of tau, and the tau transition function           <a name='7519'></font>
<font color=#447700>!  is calculated using the linear in tau formulation at values of tau            <a name='7520'></font>
<font color=#447700>!  above 0.01.  TF is approximated as tau/6 for tau &lt; 0.01.  All tables          <a name='7521'></font>
<font color=#447700>!  are computed at intervals of 0.001.  The inverse of the constant used         <a name='7522'></font>
<font color=#447700>!  in the Pade approximation to the tau transition function is set to b.         <a name='7523'></font>
                                                                                 <a name='7524'>
      TAU(0) = 0.0                                                               <a name='7525'>
      TAU(5000) = 1.E10                                                          <a name='7526'>
      TRANS(0) = 1.0                                                             <a name='7527'>
      TRANS(5000) = 0.0                                                          <a name='7528'>
      TF(0) = 0.0                                                                <a name='7529'>
      TF(5000) = 1.0                                                             <a name='7530'>
      BPADE=1./0.278                                                             <a name='7531'>
      DO 1000 ITRE = 1,4999                                                       <a name='7532'>
         TFN = ITRE/5.E3                                                          <a name='7533'>
         TAU(ITRE) = BPADE*TFN/(1.-TFN)                                           <a name='7534'>
         TRANS(ITRE) = EXP(-TAU(ITRE))                                             <a name='7535'>
         IF (TAU(ITRE).LT.0.1) THEN                                               <a name='7536'>
            TF(ITRE) = TAU(ITRE)/6.                                                <a name='7537'>
         ELSE                                                                    <a name='7538'>
            TF(ITRE) = 1.-2.*((1./TAU(ITRE))-(TRANS(ITRE)/(1.-TRANS(ITRE))))         <a name='7539'>
         ENDIF                                                                   <a name='7540'>
 1000 CONTINUE                                                                   <a name='7541'>
<font color=#447700>!  Calculate lookup tables for functions needed in routine TAUMOL (TAUGB2)       <a name='7542'></font>
      CORR1(0) = 1.                                                              <a name='7543'>
      CORR1(200) = 1.                                                            <a name='7544'>
      CORR2(0) = 1.                                                              <a name='7545'>
      CORR2(200) = 1.                                                            <a name='7546'>
      DO 1200 I = 1,199                                                          <a name='7547'>
         FP = 0.005*FLOAT(I)                                                     <a name='7548'>
         RTFP = SQRT(FP)                                                         <a name='7549'>
         CORR1(I) = RTFP/FP                                                      <a name='7550'>
         CORR2(I) = (1.-RTFP)/(1.-FP)                                            <a name='7551'>
 1200 CONTINUE                                                                   <a name='7552'>
                                                                                 <a name='7553'>
<font color=#447700>!  Perform g-point reduction from 16 per band (256 total points) to              <a name='7554'></font>
<font color=#447700>!  a band dependant number (140 total points) for all absorption                 <a name='7555'></font>
<font color=#447700>!  coefficient input data and Planck fraction input data.                        <a name='7556'></font>
<font color=#447700>!  Compute relative weighting for new g-point combinations.                      <a name='7557'></font>
                                                                                 <a name='7558'>
      IGCSM = 0                                                                  <a name='7559'>
      DO 500 IBND = 1,NBANDS                                                     <a name='7560'>
         IPRSM = 0                                                               <a name='7561'>
         IF (NGC(IBND).LT.16) THEN                                               <a name='7562'>
            DO 450 IGC = 1,NGC(IBND)                                             <a name='7563'>
               IGCSM = IGCSM + 1                                                 <a name='7564'>
               WTSUM = 0.                                                        <a name='7565'>
               DO 420 IPR = 1, NGN(IGCSM)                                        <a name='7566'>
                  IPRSM = IPRSM + 1                                              <a name='7567'>
                  WTSUM = WTSUM + WT(IPRSM)                                      <a name='7568'>
 420           CONTINUE                                                          <a name='7569'>
               WTSM(IGC) = WTSUM                                                 <a name='7570'>
 450        CONTINUE                                                             <a name='7571'>
            DO 400 IG = 1,NG(IBND)                                               <a name='7572'>
               IND = (IBND-1)*16 + IG                                            <a name='7573'>
               RWGT(IND) = WT(IG)/WTSM(NGM(IND))                                 <a name='7574'>
 400        CONTINUE                                                             <a name='7575'>
         ELSE                                                                    <a name='7576'>
            DO 300 IG = 1,NG(IBND)                                               <a name='7577'>
               IGCSM = IGCSM + 1                                                 <a name='7578'>
               IND = (IBND-1)*16 + IG                                            <a name='7579'>
               RWGT(IND) = 1.0                                                   <a name='7580'>
 300        CONTINUE                                                             <a name='7581'>
         ENDIF                                                                   <a name='7582'>
 500  CONTINUE                                                                   <a name='7583'>
                                                                                 <a name='7584'>
<font color=#447700>!  Reduce g-points for relevant data in each LW spectral band.                   <a name='7585'></font>
                                                                                 <a name='7586'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB1'>CMBGB1</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB1_1"> (abscoefL1,   abscoefH1,  SELFREF1,                   &amp;<a name='7587'>
                   FRACREFA1,   FRACREFB1,  FORREF1,                    &amp;<a name='7588'>
                   SELFREFC1,  FORREFC1, FRACREFAC1,                    &amp;<a name='7589'>
                   FRACREFBC1   &amp;<a name='7590'>
                  )<a name='7591'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB2'>CMBGB2</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB2_1"> (abscoefL2,   abscoefH2,  SELFREF2,                   &amp;<a name='7592'>
                   FRACREFA2,   FRACREFB2,  FORREF2,                    &amp;<a name='7593'>
                   SELFREFC2,  FORREFC2, FRACREFAC2,                    &amp;<a name='7594'>
                   FRACREFBC2   &amp;<a name='7595'>
                  )<a name='7596'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB3'>CMBGB3</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB3_1"> (abscoefL3,   abscoefH3,  SELFREF3,                   &amp;<a name='7597'>
                   FRACREFA3,   FRACREFB3,                              &amp;<a name='7598'>
                   FORREF3,     ABSN2OA3,   ABSN2OB3,                   &amp;<a name='7599'>
                   SELFREFC3,  FORREFC3,                                &amp;<a name='7600'>
                   ABSN2OAC3,   ABSN2OBC3,  FRACREFAC3, FRACREFBC3      &amp;<a name='7601'>
                  )<a name='7602'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB4'>CMBGB4</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB4_1"> (abscoefL4,   abscoefH4,  SELFREF4,                   &amp;<a name='7603'>
                   FRACREFA4,   FRACREFB4,                              &amp;<a name='7604'>
                   SELFREFC4,  FRACREFAC4, FRACREFBC4                   &amp;<a name='7605'>
                  )<a name='7606'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB5'>CMBGB5</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB5_1"> (abscoefL5,   abscoefH5,  SELFREF5,                   &amp;<a name='7607'>
                   FRACREFA5,   FRACREFB5,  CCL45,                      &amp;<a name='7608'>
                   SELFREFC5,  CCL4C5, FRACREFAC5,                      &amp;<a name='7609'>
                   FRACREFBC5   &amp;<a name='7610'>
                  )<a name='7611'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB6'>CMBGB6</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB6_1"> (abscoefL6,               SELFREF6,                   &amp;<a name='7612'>
                   FRACREFA6,   ABSCO26,    CFC11ADJ6, CFC126,          &amp;<a name='7613'>
                   SELFREFC6, ABSCO2C6, CFC11ADJC6, CFC12C6,            &amp;<a name='7614'>
                   FRACREFAC6   &amp;<a name='7615'>
                  )<a name='7616'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB7'>CMBGB7</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB7_1"> (abscoefL7,   abscoefH7,  SELFREF7,                   &amp;<a name='7617'>
                   FRACREFA7,   FRACREFB7,  ABSCO27,                    &amp;<a name='7618'>
                   SELFREFC7,  ABSCO2C7, FRACREFAC7,                    &amp;<a name='7619'>
                   FRACREFBC7   &amp;<a name='7620'>
                  )<a name='7621'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB8'>CMBGB8</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB8_1"> (abscoefL8,   abscoefH8,  SELFREF8,                   &amp;<a name='7622'>
                   FRACREFA8,   FRACREFB8,  ABSCO2A8, ABSCO2B8,         &amp;<a name='7623'>
                   ABSN2OA8,    ABSN2OB8,   CFC128,   CFC22ADJ8,        &amp;<a name='7624'>
                   SELFREFC8,  ABSCO2AC8, ABSCO2BC8,                    &amp;<a name='7625'>
                   ABSN2OAC8,   ABSN2OBC8,  CFC12C8,   CFC22ADJC8,      &amp;<a name='7626'>
                   FRACREFAC8, FRACREFBC8                               &amp;<a name='7627'>
                  )<a name='7628'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB9'>CMBGB9</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB9_1"> (abscoefL9,   abscoefH9,  SELFREF9,                   &amp;<a name='7629'>
                   FRACREFA9,   FRACREFB9,  ABSN2O9,                    &amp;<a name='7630'>
                   SELFREFC9,  ABSN2OC9, FRACREFAC9,                    &amp;<a name='7631'>
                   FRACREFBC9                                           &amp;<a name='7632'>
                  )  <a name='7633'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB10'>CMBGB10</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB10_1">(abscoefL10, abscoefH10,                              &amp;<a name='7634'>
                   FRACREFA10, FRACREFB10,                              &amp;<a name='7635'>
                   FRACREFAC10, FRACREFBC10                             &amp;<a name='7636'>
                  )<a name='7637'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB11'>CMBGB11</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB11_1">(abscoefL11, abscoefH11, SELFREF11,                   &amp;<a name='7638'>
                   FRACREFA11, FRACREFB11,                              &amp;<a name='7639'>
                   SELFREFC11,  FRACREFAC11,                            &amp;<a name='7640'>
                   FRACREFBC11  &amp;<a name='7641'>
                  )<a name='7642'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB12'>CMBGB12</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB12_1">(abscoefL12,             SELFREF12,                   &amp;<a name='7643'>
                   FRACREFA12,                                          &amp;<a name='7644'>
                   SELFREFC12, FRACREFAC12                              &amp;<a name='7645'>
                  )<a name='7646'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB13'>CMBGB13</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB13_1">(abscoefL13,             SELFREF13,                   &amp;<a name='7647'>
                   FRACREFA13,                                          &amp;<a name='7648'>
                   SELFREFC13, FRACREFAC13                              &amp;<a name='7649'>
                  )<a name='7650'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB14'>CMBGB14</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB14_1">(abscoefL14, abscoefH14, SELFREF14,                   &amp;<a name='7651'>
                   FRACREFA14, FRACREFB14,                              &amp;<a name='7652'>
                   SELFREFC14, FRACREFAC14,                             &amp;<a name='7653'>
                   FRACREFBC14 &amp;<a name='7654'>
                  )<a name='7655'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB15'>CMBGB15</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB15_1">(abscoefL15,             SELFREF15,                   &amp;<a name='7656'>
                   FRACREFA15,                                          &amp;<a name='7657'>
                   SELFREFC15, FRACREFAC15                              &amp;<a name='7658'>
                  )<a name='7659'>
      CALL <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#CMBGB16'>CMBGB16</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB16_1">(abscoefL16,             SELFREF16,                   &amp;<a name='7660'>
                   FRACREFA16,                                          &amp;<a name='7661'>
                   SELFREFC16, FRACREFAC16                              &amp;<a name='7662'>
                  )<a name='7663'>
      RETURN<a name='7664'>
9009 CONTINUE<a name='7665'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtm: error opening RRTM_DATA on unit ',rrtm_unit<a name='7666'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1026">(errmess)<a name='7667'>
     RETURN<a name='7668'>
9010 CONTINUE<a name='7669'>
     WRITE( errmess , '(A,I4)' ) 'module_ra_rrtm: error reading RRTM_DATA on unit ',rrtm_unit<a name='7670'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtm.F.html#RRTM_LOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1027">(errmess)<a name='7671'>
      END SUBROUTINE rrtm_lookuptable<a name='7672'>
<a name='7673'>
<font color=#447700>!------------------------------------------------------------------<a name='7674'></font>
<a name='7675'>
END MODULE module_ra_rrtm<a name='7676'>
</pre></body></html>