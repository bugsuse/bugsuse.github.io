<HTML> <BODY BGCOLOR=#ddddee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!!MODULE module_ra_rrtmg_swf<a name='2'></font>
#define CHNK 8<a name='3'>
<font color=#447700>!#define CHNK 1849<a name='4'></font>
<font color=#447700>!#define CHNK 43<a name='5'></font>
<font color=#447700>!#define CHNK 1<a name='6'></font>
<a name='7'>
<font color=#447700>!  --------------------------------------------------------------------------<a name='8'></font>
<font color=#447700>! |                                                                          |<a name='9'></font>
<font color=#447700>! |  Copyright 2002-2013, Atmospheric &amp; Environmental Research, Inc. (AER).  |<a name='10'></font>
<font color=#447700>! |  This software may be used, copied, or redistributed as long as it is    |<a name='11'></font>
<font color=#447700>! |  not sold and this copyright notice is reproduced on each copy made.     |<a name='12'></font>
<font color=#447700>! |  This model is provided as is without any express or implied warranties. |<a name='13'></font>
<font color=#447700>! |                       (http://www.rtweb.aer.com/)                        |<a name='14'></font>
<font color=#447700>! |                                                                          |<a name='15'></font>
<font color=#447700>!  --------------------------------------------------------------------------<a name='16'></font>
<a name='17'>
#ifndef _ACCEL<a name='18'>
<font color=#447700>! this set of macros reverses the storage order of some of the array variables<a name='19'></font>
<font color=#447700>! defined in rrtmg_sw_sub and used in various sections of the code.  Here is a <a name='20'></font>
<font color=#447700>! correspondencet table for the variables as they are known in rrtmg_sw_sub and<a name='21'></font>
<font color=#447700>! in the subroutines that rrtmg_sw_sub calls:<a name='22'></font>
<a name='23'>
<font color=#447700>!jm     rrtmg_sw_sub    <a name='24'></font>
<font color=#447700>!jm      |        mcica_sw        <a name='25'></font>
<font color=#447700>!jm      |         |            cldprmc_sw      <a name='26'></font>
<font color=#447700>!jm      |         |                |     spcvmc_sw       <a name='27'></font>
<font color=#447700>!jm      |         |                |       |       reftra_sw<a name='28'></font>
<font color=#447700>!jm     tauc      tauc              |       |         |   <a name='29'></font>
<font color=#447700>!jm     ssac      ssac              |       |         |   <a name='30'></font>
<font color=#447700>!jm     asmc      asmc              |       |         |   <a name='31'></font>
<font color=#447700>!jm     fsfc      fsfc              |       |         |   <a name='32'></font>
<font color=#447700>!jm     taucmc    tauc_stoch        |     ptaucmc     |<a name='33'></font>
<font color=#447700>!jm     taormc     |                |     ptaormc     |<a name='34'></font>
<font color=#447700>!jm     ssacmc    ssac_stoch        |     pomgcmc     |<a name='35'></font>
<font color=#447700>!jm     asmcmc    asmc_stoch        |     pasycmc     |<a name='36'></font>
<font color=#447700>!jm     fsfcmc    fsfc_stoch        |       |         |           <a name='37'></font>
<font color=#447700>!jm     cldfmcl   cld_stoch       cldmfc  pcldfmc   pcldfmc<a name='38'></font>
<font color=#447700>!jm     ciwpmcl   ciwp_stoch      ciwpmc    |     <a name='39'></font>
<font color=#447700>!jm     clwpmcl   clwp_stoch      clwpmc    |     <a name='40'></font>
<font color=#447700>!jm     cswpmcl   cswp_stoch      cswpmc    |     <a name='41'></font>
<font color=#447700>!jm     ztauc                               |<a name='42'></font>
<font color=#447700>!jm     ztaucorig                           |     <a name='43'></font>
<font color=#447700>!jm     zasyc                               |<a name='44'></font>
<font color=#447700>!jm     zomgc                               |<a name='45'></font>
<font color=#447700>!jm     taua                              ptaua   <a name='46'></font>
<font color=#447700>!jm     asya                              pasya   <a name='47'></font>
<font color=#447700>!jm     omga                              pomga   <a name='48'></font>
<a name='49'>
#define tauc(A,B,C)  TAUC(A,C,B)<a name='50'>
#define ssac(A,B,C)  SSAC(A,C,B)<a name='51'>
#define asmc(A,B,C)  ASMC(A,C,B)<a name='52'>
#define fsfc(A,B,C)  FSFC(A,C,B)<a name='53'>
#define taucmc(A,B,C)   TAUCMC(A,C,B)<a name='54'>
#define tauc_stoch(A,B,C) TAUC_STOCH(A,C,B)<a name='55'>
#define ptaucmc(A,B,C)  pTAUCMC(A,C,B)<a name='56'>
#define taormc(A,B,C)   TAORMC(A,C,B)<a name='57'>
#define ptaormc(A,B,C)  pTAORMC(A,C,B)<a name='58'>
#define ssacmc(A,B,C)   SSACMC(A,C,B)<a name='59'>
#define ssac_stoch(A,B,C)   SSAC_STOCH(A,C,B)<a name='60'>
#define pomgcmc(A,B,C)  pOMGCMC(A,C,B)<a name='61'>
#define asmcmc(A,B,C)   ASMCMC(A,C,B)<a name='62'>
#define asmc_stoch(A,B,C)   ASMC_STOCH(A,C,B)<a name='63'>
#define pasycmc(A,B,C)  pASYCMC(A,C,B)<a name='64'>
#define fsfcmc(A,B,C)   FSFCMC(A,C,B)<a name='65'>
#define fsfc_stoch(A,B,C)   FSFC_STOCH(A,C,B)<a name='66'>
<a name='67'>
#define cldfmcl(A,B,C)   CLDFMCL(A,C,B)<a name='68'>
#define cld_stoch(A,B,C) CLD_STOCH(A,C,B)<a name='69'>
#define cldfmc(A,B,C)    CLDFMC(A,C,B)<a name='70'>
#define pcldfmc(A,B,C)   pCLDFMC(A,C,B)<a name='71'>
<a name='72'>
#define ciwpmcl(A,B,C)    CIWPMCL(A,C,B)<a name='73'>
#define ciwp_stoch(A,B,C) CIWP_STOCH(A,C,B)<a name='74'>
#define ciwpmc(A,B,C)     CIWPMC(A,C,B)<a name='75'>
<a name='76'>
#define clwpmcl(A,B,C)    CLWPMCL(A,C,B)<a name='77'>
#define clwp_stoch(A,B,C) CLWP_STOCH(A,C,B)<a name='78'>
#define clwpmc(A,B,C)     CLWPMC(A,C,B)<a name='79'>
<a name='80'>
#define cswpmcl(A,B,C)    CSWPMCL(A,C,B)<a name='81'>
#define cswp_stoch(A,B,C) CSWP_STOCH(A,C,B)<a name='82'>
#define cswpmc(A,B,C)     CSWPMC(A,C,B)<a name='83'>
<a name='84'>
#define taua(A,B,C)  TAUA(A,C,B)<a name='85'>
#define asya(A,B,C)  ASYA(A,C,B)<a name='86'>
#define omga(A,B,C)  OMGA(A,C,B)<a name='87'>
#define ptaua(A,B,C) pTAUA(A,C,B)<a name='88'>
#define pasya(A,B,C) pASYA(A,C,B)<a name='89'>
#define pomga(A,B,C) pOMGA(A,C,B)<a name='90'>
<a name='91'>
#endif<a name='92'>
<a name='93'>
<font color=#447700>! Uncomment to use GPU, or comment to use CPU<a name='94'></font>
<font color=#447700>!#define _ACCEL<a name='95'></font>
<a name='96'>
#ifdef _ACCEL<a name='97'>
#define gpu_device ,device<a name='98'>
#else<a name='99'>
#define gpu_device <a name='100'>
#endif<a name='101'>
<a name='102'>
<A NAME='PARRRSW_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='103'>
      <font color=#993300>module </font><font color=#cc0000>parrrsw_f</font> <A href='../../call_to/PARRRSW_F.html' TARGET='index'>38</A><a name='104'>
<a name='105'>
<font color=#447700>!     implicit none<a name='106'></font>
      save<a name='107'>
<a name='108'>
<font color=#447700>!------------------------------------------------------------------<a name='109'></font>
<font color=#447700>! rrtmg_sw main parameters<a name='110'></font>
<font color=#447700>!<a name='111'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, jul1998<a name='112'></font>
<font color=#447700>! Revised: MJIacono, AER, jun2006<a name='113'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='114'></font>
<font color=#447700>!------------------------------------------------------------------<a name='115'></font>
<a name='116'>
<font color=#447700>!  name     type     purpose<a name='117'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='118'></font>
<font color=#447700>! mxlay  :  integer: maximum number of layers<a name='119'></font>
<font color=#447700>! mg     :  integer: number of original g-intervals per spectral band<a name='120'></font>
<font color=#447700>! nbndsw :  integer: number of spectral bands<a name='121'></font>
<font color=#447700>! naerec :  integer: number of aerosols (iaer=6, ecmwf aerosol option)<a name='122'></font>
<font color=#447700>! ngptsw :  integer: total number of reduced g-intervals for rrtmg_lw<a name='123'></font>
<font color=#447700>! ngNN   :  integer: number of reduced g-intervals per spectral band<a name='124'></font>
<font color=#447700>! ngsNN  :  integer: cumulative number of g-intervals per band<a name='125'></font>
<font color=#447700>!------------------------------------------------------------------<a name='126'></font>
<a name='127'>
      integer , parameter :: mxlay  = 203   <font color=#447700>!jplay, klev<a name='128'></font>
      integer , parameter :: mg     = 16     <font color=#447700>!jpg<a name='129'></font>
      integer , parameter :: nbndsw = 14     <font color=#447700>!jpsw, ksw<a name='130'></font>
      integer , parameter :: naerec  = 6     <font color=#447700>!jpaer<a name='131'></font>
      integer , parameter :: mxmol  = 38<a name='132'>
      integer , parameter :: nstr   = 2<a name='133'>
      integer , parameter :: nmol   = 7<a name='134'>
<font color=#447700>! Use for 112 g-point model   <a name='135'></font>
      integer , parameter :: ngptsw = 112    <font color=#447700>!jpgpt<a name='136'></font>
<font color=#447700>! Use for 224 g-point model   <a name='137'></font>
<font color=#447700>!      integer , parameter :: ngptsw = 224   !jpgpt<a name='138'></font>
<a name='139'>
<font color=#447700>! may need to rename these - from v2.6<a name='140'></font>
      integer , parameter :: jpband   = 29<a name='141'>
      integer , parameter :: jpb1     = 16   <font color=#447700>!istart<a name='142'></font>
      integer , parameter :: jpb2     = 29   <font color=#447700>!iend<a name='143'></font>
<a name='144'>
      integer , parameter :: jmcmu    = 32<a name='145'>
      integer , parameter :: jmumu    = 32<a name='146'>
      integer , parameter :: jmphi    = 3<a name='147'>
      integer , parameter :: jmxang   = 4<a name='148'>
      integer , parameter :: jmxstr   = 16<a name='149'>
<font color=#447700>! ^<a name='150'></font>
<a name='151'>
<font color=#447700>! Use for 112 g-point model   <a name='152'></font>
      integer , parameter :: ng16 = 6<a name='153'>
      integer , parameter :: ng17 = 12<a name='154'>
      integer , parameter :: ng18 = 8<a name='155'>
      integer , parameter :: ng19 = 8<a name='156'>
      integer , parameter :: ng20 = 10<a name='157'>
      integer , parameter :: ng21 = 10<a name='158'>
      integer , parameter :: ng22 = 2<a name='159'>
      integer , parameter :: ng23 = 10<a name='160'>
      integer , parameter :: ng24 = 8<a name='161'>
      integer , parameter :: ng25 = 6<a name='162'>
      integer , parameter :: ng26 = 6<a name='163'>
      integer , parameter :: ng27 = 8<a name='164'>
      integer , parameter :: ng28 = 6<a name='165'>
      integer , parameter :: ng29 = 12<a name='166'>
<a name='167'>
      integer , parameter :: ngs16 = 6<a name='168'>
      integer , parameter :: ngs17 = 18<a name='169'>
      integer , parameter :: ngs18 = 26<a name='170'>
      integer , parameter :: ngs19 = 34<a name='171'>
      integer , parameter :: ngs20 = 44<a name='172'>
      integer , parameter :: ngs21 = 54<a name='173'>
      integer , parameter :: ngs22 = 56<a name='174'>
      integer , parameter :: ngs23 = 66<a name='175'>
      integer , parameter :: ngs24 = 74<a name='176'>
      integer , parameter :: ngs25 = 80<a name='177'>
      integer , parameter :: ngs26 = 86<a name='178'>
      integer , parameter :: ngs27 = 94<a name='179'>
      integer , parameter :: ngs28 = 100<a name='180'>
      integer , parameter :: ngs29 = 112<a name='181'>
<a name='182'>
<font color=#447700>! Use for 224 g-point model   <a name='183'></font>
<font color=#447700>!      integer , parameter :: ng16 = 16<a name='184'></font>
<font color=#447700>!      integer , parameter :: ng17 = 16<a name='185'></font>
<font color=#447700>!      integer , parameter :: ng18 = 16<a name='186'></font>
<font color=#447700>!      integer , parameter :: ng19 = 16<a name='187'></font>
<font color=#447700>!      integer , parameter :: ng20 = 16<a name='188'></font>
<font color=#447700>!      integer , parameter :: ng21 = 16<a name='189'></font>
<font color=#447700>!      integer , parameter :: ng22 = 16<a name='190'></font>
<font color=#447700>!      integer , parameter :: ng23 = 16<a name='191'></font>
<font color=#447700>!      integer , parameter :: ng24 = 16<a name='192'></font>
<font color=#447700>!      integer , parameter :: ng25 = 16<a name='193'></font>
<font color=#447700>!      integer , parameter :: ng26 = 16<a name='194'></font>
<font color=#447700>!      integer , parameter :: ng27 = 16<a name='195'></font>
<font color=#447700>!      integer , parameter :: ng28 = 16<a name='196'></font>
<font color=#447700>!      integer , parameter :: ng29 = 16<a name='197'></font>
<a name='198'>
<font color=#447700>!      integer , parameter :: ngs16 = 16<a name='199'></font>
<font color=#447700>!      integer , parameter :: ngs17 = 32<a name='200'></font>
<font color=#447700>!      integer , parameter :: ngs18 = 48<a name='201'></font>
<font color=#447700>!      integer , parameter :: ngs19 = 64<a name='202'></font>
<font color=#447700>!      integer , parameter :: ngs20 = 80<a name='203'></font>
<font color=#447700>!      integer , parameter :: ngs21 = 96<a name='204'></font>
<font color=#447700>!      integer , parameter :: ngs22 = 112<a name='205'></font>
<font color=#447700>!      integer , parameter :: ngs23 = 128<a name='206'></font>
<font color=#447700>!      integer , parameter :: ngs24 = 144<a name='207'></font>
<font color=#447700>!      integer , parameter :: ngs25 = 160<a name='208'></font>
<font color=#447700>!      integer , parameter :: ngs26 = 176<a name='209'></font>
<font color=#447700>!      integer , parameter :: ngs27 = 192<a name='210'></font>
<font color=#447700>!      integer , parameter :: ngs28 = 208<a name='211'></font>
<font color=#447700>!      integer , parameter :: ngs29 = 224<a name='212'></font>
<a name='213'>
<font color=#447700>! Source function solar constant<a name='214'></font>
      real , parameter :: rrsw_scon = 1.36822e+03     <font color=#447700>! W/m2<a name='215'></font>
 <a name='216'>
      end module parrrsw_f<a name='217'>
<a name='218'>
<A NAME='RRSW_AER_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_AER_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='219'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_aer_f</font> <A href='../../call_to/RRSW_AER_F.html' TARGET='index'>3</A>,<A href='../../call_from/RRSW_AER_F.html' TARGET='index'>1</A><a name='220'>
<a name='221'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_AER_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_1">, only : nbndsw, naerec<a name='222'>
<a name='223'>
<font color=#447700>!     implicit none<a name='224'></font>
      save<a name='225'>
<a name='226'>
<font color=#447700>!------------------------------------------------------------------<a name='227'></font>
<font color=#447700>! rrtmg_sw aerosol optical properties<a name='228'></font>
<font color=#447700>!<a name='229'></font>
<font color=#447700>!  Data derived from six ECMWF aerosol types and defined for<a name='230'></font>
<font color=#447700>!  the rrtmg_sw spectral intervals<a name='231'></font>
<font color=#447700>!<a name='232'></font>
<font color=#447700>! Initial: J.-J. Morcrette, ECMWF, mar2003<a name='233'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='234'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='235'></font>
<font color=#447700>!------------------------------------------------------------------<a name='236'></font>
<font color=#447700>!<a name='237'></font>
<font color=#447700>!-- The six ECMWF aerosol types are respectively:<a name='238'></font>
<font color=#447700>!<a name='239'></font>
<font color=#447700>!  1/ continental average                 2/ maritime<a name='240'></font>
<font color=#447700>!  3/ desert                              4/ urban<a name='241'></font>
<font color=#447700>!  5/ volcanic active                     6/ stratospheric background<a name='242'></font>
<font color=#447700>!<a name='243'></font>
<font color=#447700>! computed from Hess and Koepke (con, mar, des, urb)<a name='244'></font>
<font color=#447700>!          from Bonnel et al.   (vol, str)<a name='245'></font>
<font color=#447700>!<a name='246'></font>
<font color=#447700>! rrtmg_sw 14 spectral intervals (microns):<a name='247'></font>
<font color=#447700>!  3.846 -  3.077<a name='248'></font>
<font color=#447700>!  3.077 -  2.500<a name='249'></font>
<font color=#447700>!  2.500 -  2.150<a name='250'></font>
<font color=#447700>!  2.150 -  1.942<a name='251'></font>
<font color=#447700>!  1.942 -  1.626<a name='252'></font>
<font color=#447700>!  1.626 -  1.299<a name='253'></font>
<font color=#447700>!  1.299 -  1.242<a name='254'></font>
<font color=#447700>!  1.242 -  0.7782<a name='255'></font>
<font color=#447700>!  0.7782-  0.6250<a name='256'></font>
<font color=#447700>!  0.6250-  0.4415<a name='257'></font>
<font color=#447700>!  0.4415-  0.3448<a name='258'></font>
<font color=#447700>!  0.3448-  0.2632<a name='259'></font>
<font color=#447700>!  0.2632-  0.2000<a name='260'></font>
<font color=#447700>! 12.195 -  3.846<a name='261'></font>
<font color=#447700>!<a name='262'></font>
<font color=#447700>!------------------------------------------------------------------<a name='263'></font>
<font color=#447700>!<a name='264'></font>
<font color=#447700>!  name     type     purpose<a name='265'></font>
<font color=#447700>! -----   : ----   : ----------------------------------------------<a name='266'></font>
<font color=#447700>! rsrtaua : real   : ratio of average optical thickness in <a name='267'></font>
<font color=#447700>!                    spectral band to that at 0.55 micron<a name='268'></font>
<font color=#447700>! rsrpiza : real   : average single scattering albedo (unitless)<a name='269'></font>
<font color=#447700>! rsrasya : real   : average asymmetry parameter (unitless)<a name='270'></font>
<font color=#447700>!------------------------------------------------------------------<a name='271'></font>
<a name='272'>
      real  :: rsrtaua(nbndsw,naerec)<a name='273'>
      real  :: rsrpiza(nbndsw,naerec)<a name='274'>
      real  :: rsrasya(nbndsw,naerec)<a name='275'>
<a name='276'>
      end module rrsw_aer_f<a name='277'>
<a name='278'>
<A NAME='RRSW_CLD_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_CLD_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='279'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_cld_f</font> <A href='../../call_to/RRSW_CLD_F.html' TARGET='index'>4</A><a name='280'>
<a name='281'>
<font color=#447700>!     implicit none<a name='282'></font>
      save<a name='283'>
<a name='284'>
<font color=#447700>!------------------------------------------------------------------<a name='285'></font>
<font color=#447700>! rrtmg_sw cloud property coefficients<a name='286'></font>
<font color=#447700>!<a name='287'></font>
<font color=#447700>! Initial: J.-J. Morcrette, ECMWF, oct1999<a name='288'></font>
<font color=#447700>! Revised: J. Delamere/MJIacono, AER, aug2005<a name='289'></font>
<font color=#447700>! Revised: MJIacono, AER, nov2005<a name='290'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='291'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='292'></font>
<font color=#447700>!------------------------------------------------------------------<a name='293'></font>
<font color=#447700>!<a name='294'></font>
<font color=#447700>!  name     type     purpose<a name='295'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='296'></font>
<font color=#447700>! xxxliq1 : real   : optical properties (extinction coefficient, single <a name='297'></font>
<font color=#447700>!                    scattering albedo, assymetry factor) from<a name='298'></font>
<font color=#447700>!                    Hu &amp; Stamnes, j. clim., 6, 728-742, 1993.  <a name='299'></font>
<font color=#447700>! xxxice2 : real   : optical properties (extinction coefficient, single <a name='300'></font>
<font color=#447700>!                    scattering albedo, assymetry factor) from streamer v3.0,<a name='301'></font>
<font color=#447700>!                    Key, streamer user's guide, cooperative institude <a name='302'></font>
<font color=#447700>!                    for meteorological studies, 95 pp., 2001.<a name='303'></font>
<font color=#447700>! xxxice3 : real   : optical properties (extinction coefficient, single <a name='304'></font>
<font color=#447700>!                    scattering albedo, assymetry factor) from<a name='305'></font>
<font color=#447700>!                    Fu, j. clim., 9, 1996.<a name='306'></font>
<font color=#447700>! xbari   : real   : optical property coefficients for five spectral <a name='307'></font>
<font color=#447700>!                    intervals (2857-4000, 4000-5263, 5263-7692, 7692-14285,<a name='308'></font>
<font color=#447700>!                    and 14285-40000 wavenumbers) following <a name='309'></font>
<font color=#447700>!                    Ebert and Curry, jgr, 97, 3831-3836, 1992.<a name='310'></font>
<font color=#447700>!------------------------------------------------------------------<a name='311'></font>
<a name='312'>
      real  :: extliq1(58,16:29), ssaliq1(58,16:29), asyliq1(58,16:29)<a name='313'>
      real  :: extice2(43,16:29), ssaice2(43,16:29), asyice2(43,16:29)<a name='314'>
      real  :: extice3(46,16:29), ssaice3(46,16:29), asyice3(46,16:29)<a name='315'>
      real  :: fdlice3(46,16:29)<a name='316'>
      real  :: abari(5),bbari(5),cbari(5),dbari(5),ebari(5),fbari(5)<a name='317'>
<a name='318'>
      end module rrsw_cld_f<a name='319'>
<a name='320'>
<A NAME='RRSW_CON_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_CON_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='321'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_con_f</font> <A href='../../call_to/RRSW_CON_F.html' TARGET='index'>6</A><a name='322'>
<a name='323'>
<font color=#447700>!     implicit none<a name='324'></font>
      save<a name='325'>
<a name='326'>
<font color=#447700>!------------------------------------------------------------------<a name='327'></font>
<font color=#447700>! rrtmg_sw constants<a name='328'></font>
<a name='329'>
<font color=#447700>! Initial version: MJIacono, AER, jun2006<a name='330'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='331'></font>
<font color=#447700>!------------------------------------------------------------------<a name='332'></font>
<a name='333'>
<font color=#447700>!  name     type     purpose<a name='334'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='335'></font>
<font color=#447700>! fluxfac:  real   : radiance to flux conversion factor <a name='336'></font>
<font color=#447700>! heatfac:  real   : flux to heating rate conversion factor<a name='337'></font>
<font color=#447700>!oneminus:  real   : 1.-1.e-6<a name='338'></font>
<font color=#447700>! pi     :  real   : pi<a name='339'></font>
<font color=#447700>! grav   :  real   : acceleration of gravity<a name='340'></font>
<font color=#447700>! planck :  real   : planck constant<a name='341'></font>
<font color=#447700>! boltz  :  real   : boltzmann constant<a name='342'></font>
<font color=#447700>! clight :  real   : speed of light<a name='343'></font>
<font color=#447700>! avogad :  real   : avogadro constant <a name='344'></font>
<font color=#447700>! alosmt :  real   : loschmidt constant<a name='345'></font>
<font color=#447700>! gascon :  real   : molar gas constant<a name='346'></font>
<font color=#447700>! radcn1 :  real   : first radiation constant<a name='347'></font>
<font color=#447700>! radcn2 :  real   : second radiation constant<a name='348'></font>
<font color=#447700>! sbcnst :  real   : stefan-boltzmann constant<a name='349'></font>
<font color=#447700>!  secdy :  real   : seconds per day<a name='350'></font>
<font color=#447700>!------------------------------------------------------------------<a name='351'></font>
<a name='352'>
      real  :: fluxfac, heatfac<a name='353'>
      real  :: oneminus, pi, grav<a name='354'>
      real  :: planck, boltz, clight<a name='355'>
      real  :: avogad, alosmt, gascon<a name='356'>
      real  :: radcn1, radcn2<a name='357'>
      real  :: sbcnst, secdy<a name='358'>
<a name='359'>
      end module rrsw_con_f<a name='360'>
<a name='361'>
<A NAME='RRSW_KG16_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG16_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='362'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg16_f</font> <A href='../../call_to/RRSW_KG16_F.html' TARGET='index'>5</A>,<A href='../../call_from/RRSW_KG16_F.html' TARGET='index'>1</A><a name='363'>
<a name='364'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG16_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_2">, only : ng16<a name='365'>
<a name='366'>
<font color=#447700>!     implicit none<a name='367'></font>
      save<a name='368'>
<a name='369'>
<font color=#447700>!-----------------------------------------------------------------<a name='370'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 16<a name='371'></font>
<font color=#447700>! band 16:  2600-3250 cm-1 (low - h2o,ch4; high - ch4)<a name='372'></font>
<font color=#447700>!<a name='373'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='374'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='375'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='376'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='377'></font>
<font color=#447700>!<a name='378'></font>
<font color=#447700>!  name     type     purpose<a name='379'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='380'></font>
<font color=#447700>! kao     : real     <a name='381'></font>
<font color=#447700>! kbo     : real     <a name='382'></font>
<font color=#447700>! selfrefo: real     <a name='383'></font>
<font color=#447700>! forrefo : real<a name='384'></font>
<font color=#447700>!sfluxrefo: real     <a name='385'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='386'></font>
<a name='387'>
      integer , parameter :: no16 = 16<a name='388'>
<a name='389'>
      real  :: kao(9,5,13,no16)<a name='390'>
      real  :: kbo(5,13:59,no16)<a name='391'>
      real  :: selfrefo(10,no16), forrefo(3,no16)<a name='392'>
      real  :: sfluxrefo(no16)<a name='393'>
<a name='394'>
      integer :: layreffr<a name='395'>
      real  :: rayl, strrat1<a name='396'>
<a name='397'>
<font color=#447700>!-----------------------------------------------------------------<a name='398'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 16<a name='399'></font>
<font color=#447700>! band 16:  2600-3250 cm-1 (low - h2o,ch4; high - ch4)<a name='400'></font>
<font color=#447700>!<a name='401'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='402'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='403'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='404'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='405'></font>
<font color=#447700>!<a name='406'></font>
<font color=#447700>!  name     type     purpose<a name='407'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='408'></font>
<font color=#447700>! ka      : real     <a name='409'></font>
<font color=#447700>! kb      : real     <a name='410'></font>
<font color=#447700>! absa    : real<a name='411'></font>
<font color=#447700>! absb    : real<a name='412'></font>
<font color=#447700>! selfref : real     <a name='413'></font>
<font color=#447700>! forref  : real<a name='414'></font>
<font color=#447700>! sfluxref: real     <a name='415'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='416'></font>
<a name='417'>
      real  :: ka(9,5,13,ng16) , absa(585,ng16)<a name='418'>
      real  :: kb(5,13:59,ng16), absb(235,ng16)<a name='419'>
      real  :: selfref(10,ng16), forref(3,ng16)<a name='420'>
      real  :: sfluxref(ng16)<a name='421'>
<a name='422'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='423'>
<a name='424'>
      end module rrsw_kg16_f<a name='425'>
<a name='426'>
<A NAME='RRSW_KG17_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG17_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='427'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg17_f</font> <A href='../../call_to/RRSW_KG17_F.html' TARGET='index'>5</A>,<A href='../../call_from/RRSW_KG17_F.html' TARGET='index'>1</A><a name='428'>
<a name='429'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG17_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_3">, only : ng17<a name='430'>
<a name='431'>
<font color=#447700>!     implicit none<a name='432'></font>
      save<a name='433'>
<a name='434'>
<font color=#447700>!-----------------------------------------------------------------<a name='435'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 17<a name='436'></font>
<font color=#447700>! band 17:  3250-4000 cm-1 (low - h2o,co2; high - h2o,co2)<a name='437'></font>
<font color=#447700>!<a name='438'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='439'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='440'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='441'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='442'></font>
<font color=#447700>!<a name='443'></font>
<font color=#447700>!  name     type     purpose<a name='444'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='445'></font>
<font color=#447700>! kao     : real     <a name='446'></font>
<font color=#447700>! kbo     : real     <a name='447'></font>
<font color=#447700>! selfrefo: real     <a name='448'></font>
<font color=#447700>! forrefo : real<a name='449'></font>
<font color=#447700>!sfluxrefo: real     <a name='450'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='451'></font>
<a name='452'>
      integer , parameter :: no17 = 16<a name='453'>
<a name='454'>
      real  :: kao(9,5,13,no17)<a name='455'>
      real  :: kbo(5,5,13:59,no17)<a name='456'>
      real  :: selfrefo(10,no17), forrefo(4,no17)<a name='457'>
      real  :: sfluxrefo(no17,5)<a name='458'>
<a name='459'>
      integer :: layreffr<a name='460'>
      real  :: rayl, strrat<a name='461'>
<a name='462'>
<font color=#447700>!-----------------------------------------------------------------<a name='463'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 17<a name='464'></font>
<font color=#447700>! band 17:  3250-4000 cm-1 (low - h2o,co2; high - h2o,co2)<a name='465'></font>
<font color=#447700>!<a name='466'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='467'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='468'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='469'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='470'></font>
<font color=#447700>!<a name='471'></font>
<font color=#447700>!  name     type     purpose<a name='472'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='473'></font>
<font color=#447700>! ka      : real     <a name='474'></font>
<font color=#447700>! kb      : real     <a name='475'></font>
<font color=#447700>! absa    : real<a name='476'></font>
<font color=#447700>! absb    : real<a name='477'></font>
<font color=#447700>! selfref : real     <a name='478'></font>
<font color=#447700>! forref  : real<a name='479'></font>
<font color=#447700>! sfluxref: real     <a name='480'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='481'></font>
<a name='482'>
      real  :: ka(9,5,13,ng17) , absa(585,ng17)<a name='483'>
      real  :: kb(5,5,13:59,ng17), absb(1175,ng17)<a name='484'>
      real  :: selfref(10,ng17), forref(4,ng17)<a name='485'>
      real  :: sfluxref(ng17,5)<a name='486'>
<a name='487'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,1,13,1),absb(1,1))<a name='488'>
<a name='489'>
      end module rrsw_kg17_f<a name='490'>
<a name='491'>
<A NAME='RRSW_KG18_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG18_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='492'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg18_f</font> <A href='../../call_to/RRSW_KG18_F.html' TARGET='index'>5</A>,<A href='../../call_from/RRSW_KG18_F.html' TARGET='index'>1</A><a name='493'>
<a name='494'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG18_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_4">, only : ng18<a name='495'>
<a name='496'>
<font color=#447700>!     implicit none<a name='497'></font>
      save<a name='498'>
<a name='499'>
<font color=#447700>!-----------------------------------------------------------------<a name='500'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 18<a name='501'></font>
<font color=#447700>! band 18:  4000-4650 cm-1 (low - h2o,ch4; high - ch4)<a name='502'></font>
<font color=#447700>!<a name='503'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='504'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='505'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='506'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='507'></font>
<font color=#447700>!<a name='508'></font>
<font color=#447700>!  name     type     purpose<a name='509'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='510'></font>
<font color=#447700>! kao     : real     <a name='511'></font>
<font color=#447700>! kbo     : real     <a name='512'></font>
<font color=#447700>! selfrefo: real     <a name='513'></font>
<font color=#447700>! forrefo : real<a name='514'></font>
<font color=#447700>!sfluxrefo: real     <a name='515'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='516'></font>
<a name='517'>
      integer , parameter :: no18 = 16<a name='518'>
<a name='519'>
      real  :: kao(9,5,13,no18)<a name='520'>
      real  :: kbo(5,13:59,no18)<a name='521'>
      real  :: selfrefo(10,no18), forrefo(3,no18)<a name='522'>
      real  :: sfluxrefo(no18,9)<a name='523'>
<a name='524'>
      integer :: layreffr<a name='525'>
      real  :: rayl, strrat<a name='526'>
<a name='527'>
<font color=#447700>!-----------------------------------------------------------------<a name='528'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 18<a name='529'></font>
<font color=#447700>! band 18:  4000-4650 cm-1 (low - h2o,ch4; high - ch4)<a name='530'></font>
<font color=#447700>!<a name='531'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='532'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='533'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='534'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='535'></font>
<font color=#447700>!<a name='536'></font>
<font color=#447700>!  name     type     purpose<a name='537'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='538'></font>
<font color=#447700>! ka      : real     <a name='539'></font>
<font color=#447700>! kb      : real     <a name='540'></font>
<font color=#447700>! absa    : real<a name='541'></font>
<font color=#447700>! absb    : real<a name='542'></font>
<font color=#447700>! selfref : real     <a name='543'></font>
<font color=#447700>! forref  : real<a name='544'></font>
<font color=#447700>! sfluxref: real     <a name='545'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='546'></font>
<a name='547'>
      real  :: ka(9,5,13,ng18), absa(585,ng18)<a name='548'>
      real  :: kb(5,13:59,ng18), absb(235,ng18)<a name='549'>
      real  :: selfref(10,ng18), forref(3,ng18)<a name='550'>
      real  :: sfluxref(ng18,9)<a name='551'>
<a name='552'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='553'>
<a name='554'>
      end module rrsw_kg18_f<a name='555'>
<a name='556'>
<A NAME='RRSW_KG19_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG19_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='557'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg19_f</font> <A href='../../call_to/RRSW_KG19_F.html' TARGET='index'>5</A>,<A href='../../call_from/RRSW_KG19_F.html' TARGET='index'>1</A><a name='558'>
<a name='559'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG19_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_5">, only : ng19<a name='560'>
<a name='561'>
<font color=#447700>!     implicit none<a name='562'></font>
      save<a name='563'>
<a name='564'>
<font color=#447700>!-----------------------------------------------------------------<a name='565'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 19<a name='566'></font>
<font color=#447700>! band 19:  4650-5150 cm-1 (low - h2o,co2; high - co2)<a name='567'></font>
<font color=#447700>!<a name='568'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='569'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='570'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='571'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='572'></font>
<font color=#447700>!<a name='573'></font>
<font color=#447700>!  name     type     purpose<a name='574'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='575'></font>
<font color=#447700>! kao     : real     <a name='576'></font>
<font color=#447700>! kbo     : real     <a name='577'></font>
<font color=#447700>! selfrefo: real     <a name='578'></font>
<font color=#447700>! forrefo : real<a name='579'></font>
<font color=#447700>!sfluxrefo: real     <a name='580'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='581'></font>
<a name='582'>
      integer , parameter :: no19 = 16<a name='583'>
<a name='584'>
      real  :: kao(9,5,13,no19)<a name='585'>
      real  :: kbo(5,13:59,no19)<a name='586'>
      real  :: selfrefo(10,no19), forrefo(3,no19)<a name='587'>
      real  :: sfluxrefo(no19,9)<a name='588'>
<a name='589'>
      integer :: layreffr<a name='590'>
      real  :: rayl, strrat<a name='591'>
<a name='592'>
<font color=#447700>!-----------------------------------------------------------------<a name='593'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 19<a name='594'></font>
<font color=#447700>! band 19:  4650-5150 cm-1 (low - h2o,co2; high - co2)<a name='595'></font>
<font color=#447700>!<a name='596'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='597'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='598'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='599'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='600'></font>
<font color=#447700>!<a name='601'></font>
<font color=#447700>!  name     type     purpose<a name='602'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='603'></font>
<font color=#447700>! ka      : real     <a name='604'></font>
<font color=#447700>! kb      : real     <a name='605'></font>
<font color=#447700>! absa    : real<a name='606'></font>
<font color=#447700>! absb    : real<a name='607'></font>
<font color=#447700>! selfref : real     <a name='608'></font>
<font color=#447700>! forref  : real<a name='609'></font>
<font color=#447700>! sfluxref: real     <a name='610'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='611'></font>
<a name='612'>
      real  :: ka(9,5,13,ng19), absa(585,ng19)<a name='613'>
      real  :: kb(5,13:59,ng19), absb(235,ng19)<a name='614'>
      real  :: selfref(10,ng19), forref(3,ng19)<a name='615'>
      real  :: sfluxref(ng19,9)<a name='616'>
<a name='617'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='618'>
<a name='619'>
      end module rrsw_kg19_f<a name='620'>
<a name='621'>
<A NAME='RRSW_KG20_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG20_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='622'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg20_f</font> <A href='../../call_to/RRSW_KG20_F.html' TARGET='index'>5</A>,<A href='../../call_from/RRSW_KG20_F.html' TARGET='index'>1</A><a name='623'>
<a name='624'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG20_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_6">, only : ng20<a name='625'>
<a name='626'>
<font color=#447700>!     implicit none<a name='627'></font>
      save<a name='628'>
<a name='629'>
<font color=#447700>!-----------------------------------------------------------------<a name='630'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 20<a name='631'></font>
<font color=#447700>! band 20:  5150-6150 cm-1 (low - h2o; high - h2o)<a name='632'></font>
<font color=#447700>!<a name='633'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='634'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='635'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='636'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='637'></font>
<font color=#447700>!<a name='638'></font>
<font color=#447700>!  name     type     purpose<a name='639'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='640'></font>
<font color=#447700>! kao     : real     <a name='641'></font>
<font color=#447700>! kbo     : real     <a name='642'></font>
<font color=#447700>! selfrefo: real     <a name='643'></font>
<font color=#447700>! forrefo : real<a name='644'></font>
<font color=#447700>!sfluxrefo: real     <a name='645'></font>
<font color=#447700>! absch4o : real     <a name='646'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='647'></font>
<a name='648'>
      integer , parameter :: no20 = 16<a name='649'>
<a name='650'>
      real  :: kao(5,13,no20)<a name='651'>
      real  :: kbo(5,13:59,no20)<a name='652'>
      real  :: selfrefo(10,no20), forrefo(4,no20)<a name='653'>
      real  :: sfluxrefo(no20)<a name='654'>
      real  :: absch4o(no20)<a name='655'>
<a name='656'>
      integer :: layreffr<a name='657'>
      real  :: rayl <a name='658'>
<a name='659'>
<font color=#447700>!-----------------------------------------------------------------<a name='660'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 20<a name='661'></font>
<font color=#447700>! band 20:  5150-6150 cm-1 (low - h2o; high - h2o)<a name='662'></font>
<font color=#447700>!<a name='663'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='664'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='665'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='666'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='667'></font>
<font color=#447700>!<a name='668'></font>
<font color=#447700>!  name     type     purpose<a name='669'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='670'></font>
<font color=#447700>! ka      : real     <a name='671'></font>
<font color=#447700>! kb      : real     <a name='672'></font>
<font color=#447700>! absa    : real<a name='673'></font>
<font color=#447700>! absb    : real<a name='674'></font>
<font color=#447700>! selfref : real     <a name='675'></font>
<font color=#447700>! forref  : real<a name='676'></font>
<font color=#447700>! sfluxref: real     <a name='677'></font>
<font color=#447700>! absch4  : real     <a name='678'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='679'></font>
<a name='680'>
      real  :: ka(5,13,ng20), absa(65,ng20)<a name='681'>
      real  :: kb(5,13:59,ng20), absb(235,ng20)<a name='682'>
      real  :: selfref(10,ng20), forref(4,ng20)<a name='683'>
      real  :: sfluxref(ng20)<a name='684'>
      real  :: absch4(ng20)<a name='685'>
<a name='686'>
      equivalence (ka(1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='687'>
<a name='688'>
      end module rrsw_kg20_f<a name='689'>
<a name='690'>
<A NAME='RRSW_KG21_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG21_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='691'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg21_f</font> <A href='../../call_to/RRSW_KG21_F.html' TARGET='index'>5</A>,<A href='../../call_from/RRSW_KG21_F.html' TARGET='index'>1</A><a name='692'>
<a name='693'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG21_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_7">, only : ng21<a name='694'>
<a name='695'>
<font color=#447700>!     implicit none<a name='696'></font>
      save<a name='697'>
<a name='698'>
<font color=#447700>!-----------------------------------------------------------------<a name='699'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 21<a name='700'></font>
<font color=#447700>! band 21:  6150-7700 cm-1 (low - h2o,co2; high - h2o,co2)<a name='701'></font>
<font color=#447700>!<a name='702'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='703'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='704'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='705'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='706'></font>
<font color=#447700>!<a name='707'></font>
<font color=#447700>!  name     type     purpose<a name='708'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='709'></font>
<font color=#447700>! kao     : real     <a name='710'></font>
<font color=#447700>! kbo     : real     <a name='711'></font>
<font color=#447700>! selfrefo: real     <a name='712'></font>
<font color=#447700>! forrefo : real<a name='713'></font>
<font color=#447700>!sfluxrefo: real     <a name='714'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='715'></font>
<a name='716'>
      integer , parameter :: no21 = 16<a name='717'>
<a name='718'>
      real  :: kao(9,5,13,no21)<a name='719'>
      real  :: kbo(5,5,13:59,no21)<a name='720'>
      real  :: selfrefo(10,no21), forrefo(4,no21)<a name='721'>
      real  :: sfluxrefo(no21,9)<a name='722'>
<a name='723'>
      integer :: layreffr<a name='724'>
      real  :: rayl, strrat<a name='725'>
<a name='726'>
<font color=#447700>!-----------------------------------------------------------------<a name='727'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 21<a name='728'></font>
<font color=#447700>! band 21:  6150-7700 cm-1 (low - h2o,co2; high - h2o,co2)<a name='729'></font>
<font color=#447700>!<a name='730'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='731'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='732'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='733'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='734'></font>
<font color=#447700>!<a name='735'></font>
<font color=#447700>!  name     type     purpose<a name='736'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='737'></font>
<font color=#447700>! ka      : real     <a name='738'></font>
<font color=#447700>! kb      : real     <a name='739'></font>
<font color=#447700>! absa    : real<a name='740'></font>
<font color=#447700>! absb    : real<a name='741'></font>
<font color=#447700>! selfref : real     <a name='742'></font>
<font color=#447700>! forref  : real<a name='743'></font>
<font color=#447700>! sfluxref: real     <a name='744'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='745'></font>
<a name='746'>
      real  :: ka(9,5,13,ng21), absa(585,ng21)<a name='747'>
      real  :: kb(5,5,13:59,ng21), absb(1175,ng21)<a name='748'>
      real  :: selfref(10,ng21), forref(4,ng21)<a name='749'>
      real  :: sfluxref(ng21,9)<a name='750'>
<a name='751'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,1,13,1),absb(1,1))<a name='752'>
<a name='753'>
      end module rrsw_kg21_f<a name='754'>
<a name='755'>
<A NAME='RRSW_KG22_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG22_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='756'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg22_f</font> <A href='../../call_to/RRSW_KG22_F.html' TARGET='index'>5</A>,<A href='../../call_from/RRSW_KG22_F.html' TARGET='index'>1</A><a name='757'>
<a name='758'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG22_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_8">, only : ng22<a name='759'>
<a name='760'>
<font color=#447700>!     implicit none<a name='761'></font>
      save<a name='762'>
<a name='763'>
<font color=#447700>!-----------------------------------------------------------------<a name='764'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 22<a name='765'></font>
<font color=#447700>! band 22:  7700-8050 cm-1 (low - h2o,o2; high - o2)<a name='766'></font>
<font color=#447700>!<a name='767'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='768'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='769'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='770'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='771'></font>
<font color=#447700>!<a name='772'></font>
<font color=#447700>!  name     type     purpose<a name='773'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='774'></font>
<font color=#447700>! kao     : real     <a name='775'></font>
<font color=#447700>! kbo     : real     <a name='776'></font>
<font color=#447700>! selfrefo: real     <a name='777'></font>
<font color=#447700>! forrefo : real<a name='778'></font>
<font color=#447700>!sfluxrefo: real     <a name='779'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='780'></font>
<a name='781'>
      integer , parameter :: no22 = 16<a name='782'>
<a name='783'>
      real  :: kao(9,5,13,no22)<a name='784'>
      real  :: kbo(5,13:59,no22)<a name='785'>
      real  :: selfrefo(10,no22), forrefo(3,no22)<a name='786'>
      real  :: sfluxrefo(no22,9)<a name='787'>
<a name='788'>
      integer :: layreffr<a name='789'>
      real  :: rayl, strrat<a name='790'>
<a name='791'>
<font color=#447700>!-----------------------------------------------------------------<a name='792'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 22<a name='793'></font>
<font color=#447700>! band 22:  7700-8050 cm-1 (low - h2o,o2; high - o2)<a name='794'></font>
<font color=#447700>!<a name='795'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='796'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='797'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='798'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='799'></font>
<font color=#447700>!<a name='800'></font>
<font color=#447700>!  name     type     purpose<a name='801'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='802'></font>
<font color=#447700>! ka      : real     <a name='803'></font>
<font color=#447700>! kb      : real     <a name='804'></font>
<font color=#447700>! absa    : real<a name='805'></font>
<font color=#447700>! absb    : real<a name='806'></font>
<font color=#447700>! selfref : real     <a name='807'></font>
<font color=#447700>! forref  : real<a name='808'></font>
<font color=#447700>! sfluxref: real     <a name='809'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='810'></font>
<a name='811'>
      real  :: ka(9,5,13,ng22), absa(585,ng22)<a name='812'>
      real  :: kb(5,13:59,ng22), absb(235,ng22)<a name='813'>
      real  :: selfref(10,ng22), forref(3,ng22)<a name='814'>
      real  :: sfluxref(ng22,9)<a name='815'>
<a name='816'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='817'>
<a name='818'>
      end module rrsw_kg22_f<a name='819'>
<a name='820'>
<A NAME='RRSW_KG23_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG23_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='821'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg23_f</font> <A href='../../call_to/RRSW_KG23_F.html' TARGET='index'>5</A>,<A href='../../call_from/RRSW_KG23_F.html' TARGET='index'>1</A><a name='822'>
<a name='823'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG23_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_9">, only : ng23<a name='824'>
<a name='825'>
<font color=#447700>!     implicit none<a name='826'></font>
      save<a name='827'>
<a name='828'>
<font color=#447700>!-----------------------------------------------------------------<a name='829'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 23<a name='830'></font>
<font color=#447700>! band 23:  8050-12850 cm-1 (low - h2o; high - nothing)<a name='831'></font>
<font color=#447700>!<a name='832'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='833'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='834'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='835'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='836'></font>
<font color=#447700>!<a name='837'></font>
<font color=#447700>!  name     type     purpose<a name='838'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='839'></font>
<font color=#447700>! kao     : real     <a name='840'></font>
<font color=#447700>! kbo     : real     <a name='841'></font>
<font color=#447700>! selfrefo: real     <a name='842'></font>
<font color=#447700>! forrefo : real<a name='843'></font>
<font color=#447700>!sfluxrefo: real     <a name='844'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='845'></font>
<a name='846'>
      integer , parameter :: no23 = 16<a name='847'>
<a name='848'>
      real  :: kao(5,13,no23)<a name='849'>
      real  :: selfrefo(10,no23), forrefo(3,no23)<a name='850'>
      real  :: sfluxrefo(no23)<a name='851'>
      real  :: raylo(no23)<a name='852'>
<a name='853'>
      integer :: layreffr<a name='854'>
      real :: givfac<a name='855'>
<a name='856'>
<font color=#447700>!-----------------------------------------------------------------<a name='857'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 23<a name='858'></font>
<font color=#447700>! band 23:  8050-12850 cm-1 (low - h2o; high - nothing)<a name='859'></font>
<font color=#447700>!<a name='860'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='861'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='862'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='863'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='864'></font>
<font color=#447700>!<a name='865'></font>
<font color=#447700>!  name     type     purpose<a name='866'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='867'></font>
<font color=#447700>! ka      : real     <a name='868'></font>
<font color=#447700>! kb      : real     <a name='869'></font>
<font color=#447700>! absa    : real<a name='870'></font>
<font color=#447700>! absb    : real<a name='871'></font>
<font color=#447700>! selfref : real     <a name='872'></font>
<font color=#447700>! forref  : real<a name='873'></font>
<font color=#447700>! sfluxref: real     <a name='874'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='875'></font>
<a name='876'>
      real  :: ka(5,13,ng23), absa(65,ng23)<a name='877'>
      real  :: selfref(10,ng23), forref(3,ng23)<a name='878'>
      real  :: sfluxref(ng23), rayl(ng23)<a name='879'>
<a name='880'>
      equivalence (ka(1,1,1),absa(1,1))<a name='881'>
<a name='882'>
      end module rrsw_kg23_f<a name='883'>
<a name='884'>
<A NAME='RRSW_KG24_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG24_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='885'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg24_f</font> <A href='../../call_to/RRSW_KG24_F.html' TARGET='index'>7</A>,<A href='../../call_from/RRSW_KG24_F.html' TARGET='index'>1</A><a name='886'>
<a name='887'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG24_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_10">, only : ng24<a name='888'>
<a name='889'>
<font color=#447700>!     implicit none<a name='890'></font>
      save<a name='891'>
<a name='892'>
<font color=#447700>!-----------------------------------------------------------------<a name='893'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 24<a name='894'></font>
<font color=#447700>! band 24: 12850-16000 cm-1 (low - h2o,o2; high - o2)<a name='895'></font>
<font color=#447700>!<a name='896'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='897'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='898'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='899'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='900'></font>
<font color=#447700>!<a name='901'></font>
<font color=#447700>!  name     type     purpose<a name='902'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='903'></font>
<font color=#447700>! kao     : real     <a name='904'></font>
<font color=#447700>! kbo     : real     <a name='905'></font>
<font color=#447700>! selfrefo: real     <a name='906'></font>
<font color=#447700>! forrefo : real<a name='907'></font>
<font color=#447700>!sfluxrefo: real     <a name='908'></font>
<font color=#447700>! abso3ao : real     <a name='909'></font>
<font color=#447700>! abso3bo : real     <a name='910'></font>
<font color=#447700>! raylao  : real     <a name='911'></font>
<font color=#447700>! raylbo  : real     <a name='912'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='913'></font>
<a name='914'>
      integer , parameter :: no24 = 16<a name='915'>
<a name='916'>
      real  :: kao(9,5,13,no24)<a name='917'>
      real  :: kbo(5,13:59,no24)<a name='918'>
      real  :: selfrefo(10,no24), forrefo(3,no24)<a name='919'>
      real  :: sfluxrefo(no24,9)<a name='920'>
      real  :: abso3ao(no24), abso3bo(no24)<a name='921'>
      real  :: raylao(no24,9), raylbo(no24)<a name='922'>
<a name='923'>
      integer :: layreffr<a name='924'>
      real :: strrat<a name='925'>
<a name='926'>
<font color=#447700>!-----------------------------------------------------------------<a name='927'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 24<a name='928'></font>
<font color=#447700>! band 24: 12850-16000 cm-1 (low - h2o,o2; high - o2)<a name='929'></font>
<font color=#447700>!<a name='930'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='931'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='932'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='933'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='934'></font>
<font color=#447700>!<a name='935'></font>
<font color=#447700>!  name     type     purpose<a name='936'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='937'></font>
<font color=#447700>! ka      : real     <a name='938'></font>
<font color=#447700>! kb      : real     <a name='939'></font>
<font color=#447700>! absa    : real<a name='940'></font>
<font color=#447700>! absb    : real<a name='941'></font>
<font color=#447700>! selfref : real     <a name='942'></font>
<font color=#447700>! forref  : real<a name='943'></font>
<font color=#447700>! sfluxref: real     <a name='944'></font>
<font color=#447700>! abso3a  : real     <a name='945'></font>
<font color=#447700>! abso3b  : real     <a name='946'></font>
<font color=#447700>! rayla   : real     <a name='947'></font>
<font color=#447700>! raylb   : real     <a name='948'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='949'></font>
<a name='950'>
      real  :: ka(9,5,13,ng24), absa(585,ng24)<a name='951'>
      real  :: kb(5,13:59,ng24), absb(235,ng24)<a name='952'>
      real  :: selfref(10,ng24), forref(3,ng24)<a name='953'>
      real  :: sfluxref(ng24,9)<a name='954'>
      real  :: abso3a(ng24), abso3b(ng24)<a name='955'>
      real  :: rayla(ng24,9), raylb(ng24)<a name='956'>
<a name='957'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='958'>
<a name='959'>
      end module rrsw_kg24_f<a name='960'>
<a name='961'>
<A NAME='RRSW_KG25_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG25_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='962'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg25_f</font> <A href='../../call_to/RRSW_KG25_F.html' TARGET='index'>7</A>,<A href='../../call_from/RRSW_KG25_F.html' TARGET='index'>1</A><a name='963'>
<a name='964'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG25_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_11">, only : ng25<a name='965'>
<a name='966'>
<font color=#447700>!     implicit none<a name='967'></font>
      save<a name='968'>
<a name='969'>
<font color=#447700>!-----------------------------------------------------------------<a name='970'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 25<a name='971'></font>
<font color=#447700>! band 25: 16000-22650 cm-1 (low - h2o; high - nothing)<a name='972'></font>
<font color=#447700>!<a name='973'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='974'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='975'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='976'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='977'></font>
<font color=#447700>!<a name='978'></font>
<font color=#447700>!  name     type     purpose<a name='979'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='980'></font>
<font color=#447700>! kao     : real     <a name='981'></font>
<font color=#447700>!sfluxrefo: real     <a name='982'></font>
<font color=#447700>! abso3ao : real     <a name='983'></font>
<font color=#447700>! abso3bo : real     <a name='984'></font>
<font color=#447700>! raylo   : real     <a name='985'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='986'></font>
<a name='987'>
      integer , parameter :: no25 = 16<a name='988'>
<a name='989'>
      real  :: kao(5,13,no25)<a name='990'>
      real  :: sfluxrefo(no25)<a name='991'>
      real  :: abso3ao(no25), abso3bo(no25)<a name='992'>
      real  :: raylo(no25)<a name='993'>
<a name='994'>
      integer :: layreffr<a name='995'>
<a name='996'>
<font color=#447700>!-----------------------------------------------------------------<a name='997'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 25<a name='998'></font>
<font color=#447700>! band 25: 16000-22650 cm-1 (low - h2o; high - nothing)<a name='999'></font>
<font color=#447700>!<a name='1000'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1001'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1002'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1003'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1004'></font>
<font color=#447700>!<a name='1005'></font>
<font color=#447700>!  name     type     purpose<a name='1006'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1007'></font>
<font color=#447700>! ka      : real     <a name='1008'></font>
<font color=#447700>! absa    : real<a name='1009'></font>
<font color=#447700>! sfluxref: real     <a name='1010'></font>
<font color=#447700>! abso3a  : real     <a name='1011'></font>
<font color=#447700>! abso3b  : real     <a name='1012'></font>
<font color=#447700>! rayl    : real     <a name='1013'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1014'></font>
<a name='1015'>
      real  :: ka(5,13,ng25), absa(65,ng25)<a name='1016'>
      real  :: sfluxref(ng25)<a name='1017'>
      real  :: abso3a(ng25), abso3b(ng25)<a name='1018'>
      real  :: rayl(ng25)<a name='1019'>
<a name='1020'>
      equivalence (ka(1,1,1),absa(1,1))<a name='1021'>
<a name='1022'>
      end module rrsw_kg25_f<a name='1023'>
<a name='1024'>
<A NAME='RRSW_KG26_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG26_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1025'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg26_f</font> <A href='../../call_to/RRSW_KG26_F.html' TARGET='index'>5</A>,<A href='../../call_from/RRSW_KG26_F.html' TARGET='index'>1</A><a name='1026'>
<a name='1027'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG26_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_12">, only : ng26<a name='1028'>
<a name='1029'>
<font color=#447700>!     implicit none<a name='1030'></font>
      save<a name='1031'>
<a name='1032'>
<font color=#447700>!-----------------------------------------------------------------<a name='1033'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 26<a name='1034'></font>
<font color=#447700>! band 26: 22650-29000 cm-1 (low - nothing; high - nothing)<a name='1035'></font>
<font color=#447700>!<a name='1036'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1037'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1038'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1039'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1040'></font>
<font color=#447700>!<a name='1041'></font>
<font color=#447700>!  name     type     purpose<a name='1042'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1043'></font>
<font color=#447700>!sfluxrefo: real     <a name='1044'></font>
<font color=#447700>! raylo   : real     <a name='1045'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1046'></font>
<a name='1047'>
      integer , parameter :: no26 = 16<a name='1048'>
<a name='1049'>
      real  :: sfluxrefo(no26)<a name='1050'>
      real  :: raylo(no26)<a name='1051'>
<a name='1052'>
<font color=#447700>!-----------------------------------------------------------------<a name='1053'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 26<a name='1054'></font>
<font color=#447700>! band 26: 22650-29000 cm-1 (low - nothing; high - nothing)<a name='1055'></font>
<font color=#447700>!<a name='1056'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1057'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1058'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1059'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1060'></font>
<font color=#447700>!<a name='1061'></font>
<font color=#447700>!  name     type     purpose<a name='1062'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1063'></font>
<font color=#447700>! sfluxref: real     <a name='1064'></font>
<font color=#447700>! rayl    : real     <a name='1065'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1066'></font>
<a name='1067'>
      real  :: sfluxref(ng26)<a name='1068'>
      real  :: rayl(ng26)<a name='1069'>
<a name='1070'>
      end module rrsw_kg26_f<a name='1071'>
<a name='1072'>
<A NAME='RRSW_KG27_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG27_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1073'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg27_f</font> <A href='../../call_to/RRSW_KG27_F.html' TARGET='index'>5</A>,<A href='../../call_from/RRSW_KG27_F.html' TARGET='index'>1</A><a name='1074'>
<a name='1075'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG27_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_13">, only : ng27<a name='1076'>
<a name='1077'>
<font color=#447700>!     implicit none<a name='1078'></font>
      save<a name='1079'>
<a name='1080'>
<font color=#447700>!-----------------------------------------------------------------<a name='1081'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 27<a name='1082'></font>
<font color=#447700>! band 27: 29000-38000 cm-1 (low - o3; high - o3)<a name='1083'></font>
<font color=#447700>!<a name='1084'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1085'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1086'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1087'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1088'></font>
<font color=#447700>!<a name='1089'></font>
<font color=#447700>!  name     type     purpose<a name='1090'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1091'></font>
<font color=#447700>! kao     : real     <a name='1092'></font>
<font color=#447700>! kbo     : real     <a name='1093'></font>
<font color=#447700>!sfluxrefo: real     <a name='1094'></font>
<font color=#447700>! raylo   : real     <a name='1095'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1096'></font>
<a name='1097'>
      integer , parameter :: no27 = 16<a name='1098'>
<a name='1099'>
      real  :: kao(5,13,no27)<a name='1100'>
      real  :: kbo(5,13:59,no27)<a name='1101'>
      real  :: sfluxrefo(no27)<a name='1102'>
      real  :: raylo(no27)<a name='1103'>
<a name='1104'>
      integer :: layreffr<a name='1105'>
      real :: scalekur<a name='1106'>
<a name='1107'>
<font color=#447700>!-----------------------------------------------------------------<a name='1108'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 27<a name='1109'></font>
<font color=#447700>! band 27: 29000-38000 cm-1 (low - o3; high - o3)<a name='1110'></font>
<font color=#447700>!<a name='1111'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1112'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1113'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1114'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1115'></font>
<font color=#447700>!<a name='1116'></font>
<font color=#447700>!  name     type     purpose<a name='1117'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1118'></font>
<font color=#447700>! ka      : real     <a name='1119'></font>
<font color=#447700>! kb      : real     <a name='1120'></font>
<font color=#447700>! absa    : real<a name='1121'></font>
<font color=#447700>! absb    : real<a name='1122'></font>
<font color=#447700>! sfluxref: real     <a name='1123'></font>
<font color=#447700>! rayl    : real     <a name='1124'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1125'></font>
<a name='1126'>
      real  :: ka(5,13,ng27), absa(65,ng27)<a name='1127'>
      real  :: kb(5,13:59,ng27), absb(235,ng27)<a name='1128'>
      real  :: sfluxref(ng27)<a name='1129'>
      real  :: rayl(ng27)<a name='1130'>
<a name='1131'>
      equivalence (ka(1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='1132'>
<a name='1133'>
      end module rrsw_kg27_f<a name='1134'>
<a name='1135'>
<A NAME='RRSW_KG28_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG28_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1136'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg28_f</font> <A href='../../call_to/RRSW_KG28_F.html' TARGET='index'>5</A>,<A href='../../call_from/RRSW_KG28_F.html' TARGET='index'>1</A><a name='1137'>
<a name='1138'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG28_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_14">, only : ng28<a name='1139'>
<a name='1140'>
<font color=#447700>!     implicit none<a name='1141'></font>
      save<a name='1142'>
<a name='1143'>
<font color=#447700>!-----------------------------------------------------------------<a name='1144'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 28<a name='1145'></font>
<font color=#447700>! band 28: 38000-50000 cm-1 (low - o3, o2; high - o3, o2)<a name='1146'></font>
<font color=#447700>!<a name='1147'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1148'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1149'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1150'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1151'></font>
<font color=#447700>!<a name='1152'></font>
<font color=#447700>!  name     type     purpose<a name='1153'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1154'></font>
<font color=#447700>! kao     : real     <a name='1155'></font>
<font color=#447700>! kbo     : real     <a name='1156'></font>
<font color=#447700>!sfluxrefo: real     <a name='1157'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1158'></font>
<a name='1159'>
      integer , parameter :: no28 = 16<a name='1160'>
<a name='1161'>
      real  :: kao(9,5,13,no28)<a name='1162'>
      real  :: kbo(5,5,13:59,no28)<a name='1163'>
      real  :: sfluxrefo(no28,5)<a name='1164'>
<a name='1165'>
      integer :: layreffr<a name='1166'>
      real  :: rayl, strrat<a name='1167'>
<a name='1168'>
<font color=#447700>!-----------------------------------------------------------------<a name='1169'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 28<a name='1170'></font>
<font color=#447700>! band 28: 38000-50000 cm-1 (low - o3, o2; high - o3, o2)<a name='1171'></font>
<font color=#447700>!<a name='1172'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1173'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1174'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1175'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1176'></font>
<font color=#447700>!<a name='1177'></font>
<font color=#447700>!  name     type     purpose<a name='1178'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1179'></font>
<font color=#447700>! ka      : real     <a name='1180'></font>
<font color=#447700>! kb      : real     <a name='1181'></font>
<font color=#447700>! sfluxref: real     <a name='1182'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1183'></font>
<a name='1184'>
      real  :: ka(9,5,13,ng28), absa(585,ng28)<a name='1185'>
      real  :: kb(5,5,13:59,ng28), absb(1175,ng28)<a name='1186'>
      real  :: sfluxref(ng28,5)<a name='1187'>
<a name='1188'>
      equivalence (ka(1,1,1,1),absa(1,1)), (kb(1,1,13,1),absb(1,1))<a name='1189'>
<a name='1190'>
      end module rrsw_kg28_f<a name='1191'>
<a name='1192'>
<A NAME='RRSW_KG29_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG29_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1193'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_kg29_f</font> <A href='../../call_to/RRSW_KG29_F.html' TARGET='index'>7</A>,<A href='../../call_from/RRSW_KG29_F.html' TARGET='index'>1</A><a name='1194'>
<a name='1195'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG29_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_15">, only : ng29<a name='1196'>
<a name='1197'>
<font color=#447700>!     implicit none<a name='1198'></font>
      save<a name='1199'>
<a name='1200'>
<font color=#447700>!-----------------------------------------------------------------<a name='1201'></font>
<font color=#447700>! rrtmg_sw ORIGINAL abs. coefficients for interval 29<a name='1202'></font>
<font color=#447700>! band 29:  820-2600 cm-1 (low - h2o; high - co2)<a name='1203'></font>
<font color=#447700>!<a name='1204'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1205'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1206'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1207'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1208'></font>
<font color=#447700>!<a name='1209'></font>
<font color=#447700>!  name     type     purpose<a name='1210'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1211'></font>
<font color=#447700>! kao     : real     <a name='1212'></font>
<font color=#447700>! kbo     : real     <a name='1213'></font>
<font color=#447700>! selfrefo: real     <a name='1214'></font>
<font color=#447700>! forrefo : real     <a name='1215'></font>
<font color=#447700>!sfluxrefo: real     <a name='1216'></font>
<font color=#447700>! absh2oo : real     <a name='1217'></font>
<font color=#447700>! absco2o : real     <a name='1218'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1219'></font>
<a name='1220'>
      integer , parameter :: no29 = 16<a name='1221'>
<a name='1222'>
      real  :: kao(5,13,no29)<a name='1223'>
      real  :: kbo(5,13:59,no29)<a name='1224'>
      real  :: selfrefo(10,no29), forrefo(4,no29)<a name='1225'>
      real  :: sfluxrefo(no29)<a name='1226'>
      real  :: absh2oo(no29), absco2o(no29)<a name='1227'>
<a name='1228'>
      integer :: layreffr<a name='1229'>
      real  :: rayl<a name='1230'>
<a name='1231'>
<font color=#447700>!-----------------------------------------------------------------<a name='1232'></font>
<font color=#447700>! rrtmg_sw COMBINED abs. coefficients for interval 29<a name='1233'></font>
<font color=#447700>! band 29:  820-2600 cm-1 (low - h2o; high - co2)<a name='1234'></font>
<font color=#447700>!<a name='1235'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, oct1999<a name='1236'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1237'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1238'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1239'></font>
<font color=#447700>!<a name='1240'></font>
<font color=#447700>!  name     type     purpose<a name='1241'></font>
<font color=#447700>!  ----   : ----   : ---------------------------------------------<a name='1242'></font>
<font color=#447700>! ka      : real     <a name='1243'></font>
<font color=#447700>! kb      : real     <a name='1244'></font>
<font color=#447700>! selfref : real     <a name='1245'></font>
<font color=#447700>! forref  : real     <a name='1246'></font>
<font color=#447700>! sfluxref: real     <a name='1247'></font>
<font color=#447700>! absh2o  : real     <a name='1248'></font>
<font color=#447700>! absco2  : real     <a name='1249'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='1250'></font>
<a name='1251'>
      real  :: ka(5,13,ng29), absa(65,ng29)<a name='1252'>
      real  :: kb(5,13:59,ng29), absb(235,ng29)<a name='1253'>
      real  :: selfref(10,ng29), forref(4,ng29)<a name='1254'>
      real  :: sfluxref(ng29)<a name='1255'>
      real  :: absh2o(ng29), absco2(ng29)<a name='1256'>
<a name='1257'>
      equivalence (ka(1,1,1),absa(1,1)), (kb(1,13,1),absb(1,1))<a name='1258'>
<a name='1259'>
      end module rrsw_kg29_f<a name='1260'>
<a name='1261'>
<A NAME='RRSW_REF_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_REF_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1262'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_ref_f</font> <A href='../../call_to/RRSW_REF_F.html' TARGET='index'>3</A><a name='1263'>
<a name='1264'>
<font color=#447700>!      implicit none<a name='1265'></font>
      save<a name='1266'>
<a name='1267'>
<font color=#447700>!------------------------------------------------------------------<a name='1268'></font>
<font color=#447700>! rrtmg_sw reference atmosphere <a name='1269'></font>
<font color=#447700>! Based on standard mid-latitude summer profile<a name='1270'></font>
<font color=#447700>!<a name='1271'></font>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, jul1998<a name='1272'></font>
<font color=#447700>! Revised: MJIacono, AER, jun2006<a name='1273'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1274'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1275'></font>
<a name='1276'>
<font color=#447700>!  name     type     purpose<a name='1277'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='1278'></font>
<font color=#447700>! pref   :  real   : Reference pressure levels<a name='1279'></font>
<font color=#447700>! preflog:  real   : Reference pressure levels, ln(pref)<a name='1280'></font>
<font color=#447700>! tref   :  real   : Reference temperature levels for MLS profile<a name='1281'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1282'></font>
<a name='1283'>
      real  , dimension(59) :: pref<a name='1284'>
      real  , dimension(59) :: preflog<a name='1285'>
      real  , dimension(59) :: tref<a name='1286'>
<a name='1287'>
      end module rrsw_ref_f<a name='1288'>
<a name='1289'>
<A NAME='RRSW_TBL_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_TBL_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1290'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_tbl_f</font> <A href='../../call_to/RRSW_TBL_F.html' TARGET='index'>2</A><a name='1291'>
<a name='1292'>
<font color=#447700>!     implicit none<a name='1293'></font>
      save<a name='1294'>
<a name='1295'>
<font color=#447700>!------------------------------------------------------------------<a name='1296'></font>
<font color=#447700>! rrtmg_sw lookup table arrays<a name='1297'></font>
<a name='1298'>
<font color=#447700>! Initial version: MJIacono, AER, may2007<a name='1299'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2007<a name='1300'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1301'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1302'></font>
<a name='1303'>
<font color=#447700>!  name     type     purpose<a name='1304'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='1305'></font>
<font color=#447700>! ntbl   :  integer: Lookup table dimension<a name='1306'></font>
<font color=#447700>! tblint :  real   : Lookup table conversion factor<a name='1307'></font>
<font color=#447700>! tau_tbl:  real   : Clear-sky optical depth <a name='1308'></font>
<font color=#447700>! exp_tbl:  real   : Exponential lookup table for transmittance<a name='1309'></font>
<font color=#447700>! od_lo  :  real   : Value of tau below which expansion is used<a name='1310'></font>
<font color=#447700>!                  : in place of lookup table<a name='1311'></font>
<font color=#447700>! pade   :  real   : Pade approximation constant<a name='1312'></font>
<font color=#447700>! bpade  :  real   : Inverse of Pade constant<a name='1313'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1314'></font>
<a name='1315'>
      integer , parameter :: ntbl = 10000<a name='1316'>
<a name='1317'>
      real , parameter :: tblint = 10000.0 <a name='1318'>
<a name='1319'>
      real , parameter :: od_lo = 0.06 <a name='1320'>
<a name='1321'>
      real :: tau_tbl<a name='1322'>
      real , dimension(0:ntbl) :: exp_tbl<a name='1323'>
<a name='1324'>
      real , parameter :: pade = 0.278 <a name='1325'>
      real :: bpade<a name='1326'>
<a name='1327'>
      end module rrsw_tbl_f<a name='1328'>
<a name='1329'>
<A NAME='RRSW_VSN_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_VSN_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1330'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_vsn_f</font> <A href='../../call_to/RRSW_VSN_F.html' TARGET='index'>8</A><a name='1331'>
<a name='1332'>
<font color=#447700>!     implicit none<a name='1333'></font>
      save<a name='1334'>
<a name='1335'>
<font color=#447700>!------------------------------------------------------------------<a name='1336'></font>
<font color=#447700>! rrtmg_sw version information<a name='1337'></font>
<a name='1338'>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, jul1998<a name='1339'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1340'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1341'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1342'></font>
<a name='1343'>
<font color=#447700>!  name     type     purpose<a name='1344'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='1345'></font>
<font color=#447700>!hnamrtm :character: <a name='1346'></font>
<font color=#447700>!hnamini :character: <a name='1347'></font>
<font color=#447700>!hnamcld :character: <a name='1348'></font>
<font color=#447700>!hnamclc :character: <a name='1349'></font>
<font color=#447700>!hnamrft :character: <a name='1350'></font>
<font color=#447700>!hnamspv :character: <a name='1351'></font>
<font color=#447700>!hnamspc :character: <a name='1352'></font>
<font color=#447700>!hnamset :character: <a name='1353'></font>
<font color=#447700>!hnamtau :character: <a name='1354'></font>
<font color=#447700>!hnamvqd :character: <a name='1355'></font>
<font color=#447700>!hnamatm :character: <a name='1356'></font>
<font color=#447700>!hnamutl :character: <a name='1357'></font>
<font color=#447700>!hnamext :character: <a name='1358'></font>
<font color=#447700>!hnamkg  :character: <a name='1359'></font>
<font color=#447700>!<a name='1360'></font>
<font color=#447700>! hvrrtm :character: <a name='1361'></font>
<font color=#447700>! hvrini :character: <a name='1362'></font>
<font color=#447700>! hvrcld :character: <a name='1363'></font>
<font color=#447700>! hvrclc :character: <a name='1364'></font>
<font color=#447700>! hvrrft :character: <a name='1365'></font>
<font color=#447700>! hvrspv :character: <a name='1366'></font>
<font color=#447700>! hvrspc :character: <a name='1367'></font>
<font color=#447700>! hvrset :character: <a name='1368'></font>
<font color=#447700>! hvrtau :character: <a name='1369'></font>
<font color=#447700>! hvrvqd :character: <a name='1370'></font>
<font color=#447700>! hvratm :character: <a name='1371'></font>
<font color=#447700>! hvrutl :character: <a name='1372'></font>
<font color=#447700>! hvrext :character: <a name='1373'></font>
<font color=#447700>! hvrkg  :character: <a name='1374'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1375'></font>
<a name='1376'>
      character*18 hvrrtm,hvrini,hvrcld,hvrclc,hvrrft,hvrspv, &amp;<a name='1377'>
                   hvrspc,hvrset,hvrtau,hvrvqd,hvratm,hvrutl,hvrext<a name='1378'>
      character*20 hnamrtm,hnamini,hnamcld,hnamclc,hnamrft,hnamspv, &amp;<a name='1379'>
                   hnamspc,hnamset,hnamtau,hnamvqd,hnamatm,hnamutl,hnamext<a name='1380'>
<a name='1381'>
      character*18 hvrkg<a name='1382'>
      character*20 hnamkg<a name='1383'>
<a name='1384'>
      end module rrsw_vsn_f<a name='1385'>
<a name='1386'>
<A NAME='RRSW_WVN_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_WVN_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1387'>
      <font color=#993300>module </font><font color=#cc0000>rrsw_wvn_f</font> <A href='../../call_to/RRSW_WVN_F.html' TARGET='index'>9</A>,<A href='../../call_from/RRSW_WVN_F.html' TARGET='index'>1</A><a name='1388'>
<a name='1389'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_WVN_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_16">, only : nbndsw, mg, ngptsw, jpb1, jpb2<a name='1390'>
<a name='1391'>
<font color=#447700>!     implicit none<a name='1392'></font>
      save<a name='1393'>
<a name='1394'>
<font color=#447700>!------------------------------------------------------------------<a name='1395'></font>
<font color=#447700>! rrtmg_sw spectral information<a name='1396'></font>
<a name='1397'>
<font color=#447700>! Initial version:  JJMorcrette, ECMWF, jul1998<a name='1398'></font>
<font color=#447700>! Revised: MJIacono, AER, jul2006<a name='1399'></font>
<font color=#447700>! Revised: MJIacono, AER, aug2008<a name='1400'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1401'></font>
<a name='1402'>
<font color=#447700>!  name     type     purpose<a name='1403'></font>
<font color=#447700>! -----  :  ----   : ----------------------------------------------<a name='1404'></font>
<font color=#447700>! ng     :  integer: Number of original g-intervals in each spectral band<a name='1405'></font>
<font color=#447700>! nspa   :  integer: <a name='1406'></font>
<font color=#447700>! nspb   :  integer: <a name='1407'></font>
<font color=#447700>!wavenum1:  real   : Spectral band lower boundary in wavenumbers<a name='1408'></font>
<font color=#447700>!wavenum2:  real   : Spectral band upper boundary in wavenumbers<a name='1409'></font>
<font color=#447700>! delwave:  real   : Spectral band width in wavenumbers<a name='1410'></font>
<font color=#447700>!<a name='1411'></font>
<font color=#447700>! ngc    :  integer: The number of new g-intervals in each band<a name='1412'></font>
<font color=#447700>! ngs    :  integer: The cumulative sum of new g-intervals for each band<a name='1413'></font>
<font color=#447700>! ngm    :  integer: The index of each new g-interval relative to the<a name='1414'></font>
<font color=#447700>!                    original 16 g-intervals in each band<a name='1415'></font>
<font color=#447700>! ngn    :  integer: The number of original g-intervals that are <a name='1416'></font>
<font color=#447700>!                    combined to make each new g-intervals in each band<a name='1417'></font>
<font color=#447700>! ngb    :  integer: The band index for each new g-interval<a name='1418'></font>
<font color=#447700>! wt     :  real   : RRTM weights for the original 16 g-intervals<a name='1419'></font>
<font color=#447700>! rwgt   :  real   : Weights for combining original 16 g-intervals <a name='1420'></font>
<font color=#447700>!                    (224 total) into reduced set of g-intervals <a name='1421'></font>
<font color=#447700>!                    (112 total)<a name='1422'></font>
<font color=#447700>!------------------------------------------------------------------<a name='1423'></font>
<a name='1424'>
      integer  :: ng(jpb1:jpb2)<a name='1425'>
      integer  :: nspa(jpb1:jpb2)<a name='1426'>
      integer  :: nspb(jpb1:jpb2)<a name='1427'>
<a name='1428'>
      real  :: wavenum1(jpb1:jpb2)<a name='1429'>
      real  :: wavenum2(jpb1:jpb2)<a name='1430'>
      real  :: delwave(jpb1:jpb2)<a name='1431'>
      integer :: icxa(jpb1:jpb2)<a name='1432'>
<a name='1433'>
      integer  :: ngc(nbndsw)<a name='1434'>
      integer  :: ngs(nbndsw)<a name='1435'>
      integer  :: ngn(ngptsw)<a name='1436'>
      integer  :: ngb(ngptsw)<a name='1437'>
      integer  :: ngm(nbndsw*mg)<a name='1438'>
<a name='1439'>
      real  :: wt(mg)<a name='1440'>
      real  :: rwgt(nbndsw*mg)<a name='1441'>
<a name='1442'>
      end module rrsw_wvn_f<a name='1443'>
<a name='1444'>
<a name='1445'>
<A NAME='MCICA_SUBCOL_GEN_SW_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MCICA_SUBCOL_GEN_SW_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1446'>
      <font color=#993300>module </font><font color=#cc0000>mcica_subcol_gen_sw_f</font> <A href='../../call_to/MCICA_SUBCOL_GEN_SW_F.html' TARGET='index'>1</A>,<A href='../../call_from/MCICA_SUBCOL_GEN_SW_F.html' TARGET='index'>4</A><a name='1447'>
<a name='1448'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MCICA_SUBCOL_GEN_SW_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_17">, only : nbndsw, ngptsw<a name='1449'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_CON_F'>rrsw_con_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MCICA_SUBCOL_GEN_SW_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CON_F_1">, only: grav<a name='1450'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_WVN_F'>rrsw_wvn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MCICA_SUBCOL_GEN_SW_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_F_1">, only: ngb<a name='1451'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_VSN_F'>rrsw_vsn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MCICA_SUBCOL_GEN_SW_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_F_1"><a name='1452'>
<a name='1453'>
      implicit none<a name='1454'>
<a name='1455'>
      public :: mcica_sw      <a name='1456'>
      <a name='1457'>
      contains<a name='1458'>
<font color=#447700>!-------------------------------------------------------------------------------------------------<a name='1459'></font>
<A NAME='MCICA_SW'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MCICA_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1460'>
      <font color=#993300>subroutine </font><font color=#cc0000>mcica_sw</font>(ncol, nlay, nsubcol, icld, irng, play, cld, ciwp, clwp, cswp, &amp; <A href='../../call_to/MCICA_SW.html' TARGET='index'>1</A>,<A href='../../call_from/MCICA_SW.html' TARGET='index'>3</A><a name='1461'>
                          tauc, ssac, asmc, fsfc, cld_stoch, ciwp_stoch, clwp_stoch, cswp_stoch, &amp;<a name='1462'>
                          tauc_stoch, ssac_stoch, asmc_stoch, fsfc_stoch, changeSeed )<a name='1463'>
<font color=#447700>!-------------------------------------------------------------------------------------------------<a name='1464'></font>
<a name='1465'>
  <font color=#447700>!----------------------------------------------------------------------------------------------------------------<a name='1466'></font>
  <font color=#447700>! ---------------------<a name='1467'></font>
  <font color=#447700>! Contact: Cecile Hannay (hannay@ucar.edu)<a name='1468'></font>
  <font color=#447700>! <a name='1469'></font>
  <font color=#447700>! Original code: Based on Raisanen et al., QJRMS, 2004.<a name='1470'></font>
  <font color=#447700>!<a name='1471'></font>
  <font color=#447700>! Modifications: Generalized for use with RRTMG and added Mersenne Twister as the default<a name='1472'></font>
  <font color=#447700>!   random number generator, which can be changed to the optional kissvec random number generator<a name='1473'></font>
  <font color=#447700>!   with flag 'irng'. Some extra functionality has been commented or removed.  <a name='1474'></font>
  <font color=#447700>!   Michael J. Iacono, AER, Inc., February 2007<a name='1475'></font>
  <font color=#447700>!<a name='1476'></font>
  <font color=#447700>! Given a profile of cloud fraction, cloud water and cloud ice, we produce a set of subcolumns.<a name='1477'></font>
  <font color=#447700>! Each layer within each subcolumn is homogeneous, with cloud fraction equal to zero or one <a name='1478'></font>
  <font color=#447700>! and uniform cloud liquid and cloud ice concentration.<a name='1479'></font>
  <font color=#447700>! The ensemble as a whole reproduces the probability function of cloud liquid and ice within each layer <a name='1480'></font>
  <font color=#447700>! and obeys an overlap assumption in the vertical.   <a name='1481'></font>
  <font color=#447700>! <a name='1482'></font>
  <font color=#447700>! Overlap assumption:<a name='1483'></font>
  <font color=#447700>!  The cloud are consistent with 4 overlap assumptions: random, maximum, maximum-random and exponential. <a name='1484'></font>
  <font color=#447700>!  The default option is maximum-random (option 3)<a name='1485'></font>
  <font color=#447700>!  The options are: 1=random overlap, 2=max/random, 3=maximum overlap, 4=exponential overlap<a name='1486'></font>
  <font color=#447700>!  This is set with the variable "overlap" <a name='1487'></font>
  <font color=#447700>!mji - Exponential overlap option (overlap=4) has been deactivated in this version<a name='1488'></font>
  <font color=#447700>!  The exponential overlap uses also a length scale, Zo. (real,    parameter  :: Zo = 2500. ) <a name='1489'></font>
  <font color=#447700>! <a name='1490'></font>
  <font color=#447700>! Seed:<a name='1491'></font>
  <font color=#447700>!  If the stochastic cloud generator is called several times during the same timestep, <a name='1492'></font>
  <font color=#447700>!  one should change the seed between the call to insure that the subcolumns are different.<a name='1493'></font>
  <font color=#447700>!  This is done by changing the argument 'changeSeed'<a name='1494'></font>
  <font color=#447700>!  For example, if one wants to create a set of columns for the shortwave and another set for the longwave ,<a name='1495'></font>
  <font color=#447700>!  use 'changeSeed = 1' for the first call and'changeSeed = 2' for the second call <a name='1496'></font>
  <font color=#447700>!<a name='1497'></font>
  <font color=#447700>! PDF assumption:<a name='1498'></font>
  <font color=#447700>!  We can use arbitrary complicated PDFS. <a name='1499'></font>
  <font color=#447700>!  In the present version, we produce homogeneuous clouds (the simplest case).  <a name='1500'></font>
  <font color=#447700>!  Future developments include using the PDF scheme of Ben Johnson. <a name='1501'></font>
  <font color=#447700>!<a name='1502'></font>
  <font color=#447700>! History file:<a name='1503'></font>
  <font color=#447700>!  Option to add diagnostics variables in the history file. (using FINCL in the namelist)<a name='1504'></font>
  <font color=#447700>!  nsubcol = number of subcolumns<a name='1505'></font>
  <font color=#447700>!  overlap = overlap type (1-3)<a name='1506'></font>
  <font color=#447700>!  Zo = length scale <a name='1507'></font>
  <font color=#447700>!  CLOUD_S = mean of the subcolumn cloud fraction ('_S" means Stochastic)<a name='1508'></font>
  <font color=#447700>!  CLDLIQ_S = mean of the subcolumn cloud water<a name='1509'></font>
  <font color=#447700>!  CLDICE_S = mean of the subcolumn cloud ice <a name='1510'></font>
  <font color=#447700>!<a name='1511'></font>
  <font color=#447700>! Note:<a name='1512'></font>
  <font color=#447700>!   Here: we force that the cloud condensate to be consistent with the cloud fraction <a name='1513'></font>
  <font color=#447700>!   i.e we only have cloud condensate when the cell is cloudy. <a name='1514'></font>
  <font color=#447700>!   In CAM: The cloud condensate and the cloud fraction are obtained from 2 different equations <a name='1515'></font>
  <font color=#447700>!   and the 2 quantities can be inconsistent (i.e. CAM can produce cloud fraction <a name='1516'></font>
  <font color=#447700>!   without cloud condensate or the opposite).<a name='1517'></font>
  <font color=#447700>!---------------------------------------------------------------------------------------------------------------<a name='1518'></font>
<a name='1519'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#MCICA_RANDOM_NUMBERS_F'>mcica_random_numbers_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MCICA_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MCICA_RANDOM_NUMBERS_F_1"><a name='1520'>
<font color=#447700>! The Mersenne Twister random number engine<a name='1521'></font>
      <font color=#447700>!use MersenneTwister, only: randomNumberSequence, &amp;   <a name='1522'></font>
      <font color=#447700>!                           new_RandomNumberSequence, getRandomReal<a name='1523'></font>
<a name='1524'>
      <font color=#447700>!type(randomNumberSequence) :: randomNumbers<a name='1525'></font>
<a name='1526'>
<font color=#447700>! -- Arguments<a name='1527'></font>
<a name='1528'>
      integer , intent(in) :: ncol            <font color=#447700>! number of layers<a name='1529'></font>
      integer , intent(in) :: nlay            <font color=#447700>! number of layers<a name='1530'></font>
      integer , intent(in) :: icld            <font color=#447700>! clear/cloud, cloud overlap flag<a name='1531'></font>
      integer , intent(inout) :: irng         <font color=#447700>! flag for random number generator<a name='1532'></font>
                                                      <font color=#447700>!  0 = kissvec<a name='1533'></font>
                                                      <font color=#447700>!  1 = Mersenne Twister<a name='1534'></font>
      integer , intent(in) :: nsubcol         <font color=#447700>! number of sub-columns (g-point intervals)<a name='1535'></font>
      integer , optional, intent(in) :: changeSeed     <font color=#447700>! allows permuting seed<a name='1536'></font>
<a name='1537'>
<font color=#447700>! Column state (cloud fraction, cloud water, cloud ice) + variables needed to read physics state <a name='1538'></font>
      real , intent(in) :: play(:,:)          <font color=#447700>! layer pressure (Pa)<a name='1539'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1540'></font>
      real , intent(in) :: cld(:,:)           <font color=#447700>! cloud fraction <a name='1541'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1542'></font>
      real , intent(in) :: clwp(:,:)          <font color=#447700>! in-cloud liquid water path (g/m2)<a name='1543'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1544'></font>
      real , intent(in) :: ciwp(:,:)          <font color=#447700>! in-cloud ice water path (g/m2)<a name='1545'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1546'></font>
      real , intent(in) :: cswp(:,:)          <font color=#447700>! in-cloud snow water path (g/m2)<a name='1547'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='1548'></font>
      real , intent(in) :: tauc(:,:,:)        <font color=#447700>! in-cloud optical depth (non-delta scaled)<a name='1549'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='1550'></font>
      real , intent(in) :: ssac(:,:,:)        <font color=#447700>! in-cloud single scattering albedo (non-delta scaled)<a name='1551'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='1552'></font>
      real , intent(in) :: asmc(:,:,:)        <font color=#447700>! in-cloud asymmetry parameter (non-delta scaled)<a name='1553'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='1554'></font>
      real , intent(in) :: fsfc(:,:,:)        <font color=#447700>! in-cloud forward scattering fraction (non-delta scaled)<a name='1555'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='1556'></font>
<a name='1557'>
      real , intent(out) :: cld_stoch(:,:,:)  <font color=#447700>! subcolumn cloud fraction <a name='1558'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1559'></font>
      real , intent(out) :: clwp_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud liquid water path<a name='1560'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1561'></font>
      real , intent(out) :: ciwp_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud ice water path<a name='1562'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1563'></font>
      real , intent(out) :: cswp_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud snow water path<a name='1564'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,ncol,nlay)<a name='1565'></font>
      real , intent(out) :: tauc_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud optical depth<a name='1566'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,ngptsw)<a name='1567'></font>
      real , intent(out) :: ssac_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud single scattering albedo<a name='1568'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,ngptsw)<a name='1569'></font>
      real , intent(out) :: asmc_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud asymmetry parameter<a name='1570'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,ngptsw)<a name='1571'></font>
      real , intent(out) :: fsfc_stoch(:,:,:) <font color=#447700>! subcolumn in-cloud forward scattering fraction<a name='1572'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,ngptsw)<a name='1573'></font>
      <a name='1574'>
<font color=#447700>! -- Local variables<a name='1575'></font>
<a name='1576'>
<font color=#447700>! Constants (min value for cloud fraction and cloud water and ice)<a name='1577'></font>
      real , parameter :: cldmin = 1.0e-20  <font color=#447700>! min cloud fraction<a name='1578'></font>
<a name='1579'>
#ifndef _ACCEL<a name='1580'>
# define ncol CHNK<a name='1581'>
#endif<a name='1582'>
<a name='1583'>
<font color=#447700>! Variables related to random number and seed <a name='1584'></font>
     <a name='1585'>
      real, dimension(ncol, nlay, nsubcol) gpu_device :: CDF       <a name='1586'>
#ifdef _ACCEL<a name='1587'>
      integer :: seed1, seed2, seed3, seed4  <font color=#447700>! seed to create random number<a name='1588'></font>
#else<a name='1589'>
      integer, dimension(ncol) :: seed1, seed2, seed3, seed4  <font color=#447700>! seed to create random number<a name='1590'></font>
#endif<a name='1591'>
    <a name='1592'>
      integer  :: iseed                        <font color=#447700>! seed to create random number (Mersenne Twister)<a name='1593'></font>
<font color=#447700>!      real  :: rand_num_mt                     ! random number (Mersenne Twister)<a name='1594'></font>
      real  :: kiss<a name='1595'>
<a name='1596'>
<a name='1597'>
<font color=#447700>! Indices<a name='1598'></font>
      integer  :: ilev, isubcol, i, n, ngbm, iplon   <font color=#447700>! indices<a name='1599'></font>
#ifndef _ACCEL<a name='1600'>
      integer :: m, k<a name='1601'>
<font color=#447700>! inline function<a name='1602'></font>
      m(k, n) = ieor (k, ishft (k, n) )<a name='1603'>
#endif<a name='1604'>
<font color=#447700>!------------------------------------------------------------------------------------------ <a name='1605'></font>
<a name='1606'>
<font color=#447700>! Check that irng is in bounds; if not, set to default<a name='1607'></font>
<font color=#447700>! Note: in GPU version of code, only kissvec method is used, Mersenne Twister not installed<a name='1608'></font>
<a name='1609'>
<font color=#447700>! Pass input cloud overlap setting to local variable<a name='1610'></font>
<a name='1611'>
<a name='1612'>
<font color=#447700>! ------ Apply overlap assumption --------<a name='1613'></font>
<a name='1614'>
<font color=#447700>! generate the random numbers  <a name='1615'></font>
<a name='1616'>
<font color=#447700>! Random cloud overlap<a name='1617'></font>
      if (icld==1) then<a name='1618'>
<font color=#447700>!$acc kernels <a name='1619'></font>
           <a name='1620'>
#ifdef _ACCEL<a name='1621'>
            do ilev = 1,nlay<a name='1622'>
               do i = 1, ncol<a name='1623'>
                  seed1 = (play(i,1) - int(play(i,1)))  * 100000000 - ilev<a name='1624'>
                  seed2 = (play(i,2) - int(play(i,2)))  * 100000000 + ilev<a name='1625'>
                  seed3 = (play(i,3) - int(play(i,3)))  * 100000000 + ilev * 6.2<a name='1626'>
                  seed4 = (play(i,4) - int(play(i,4)))  * 100000000           <a name='1627'>
                  do isubcol = 1,nsubcol<a name='1628'>
                     seed1 = 69069  * seed1 + 132721785 <a name='1629'>
                     seed2 = 11002  * iand (seed2, 65535 ) + ishft (seed2, - 16 )<a name='1630'>
                     seed3 = 18000  * iand (seed3, 65535 ) + ishft (seed3, - 16 )<a name='1631'>
                     seed4 = 30903  * iand (seed4, 65535 ) + ishft (seed4, - 16 )<a name='1632'>
                     kiss = seed1 + seed2 + ishft (seed3, 16 ) + seed4<a name='1633'>
                     CDF(i,ilev,isubcol) = kiss*2.328306e-10  + 0.5 <a name='1634'>
                  end do<a name='1635'>
               end do<a name='1636'>
            end do<a name='1637'>
#else<a name='1638'>
         CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MCICA_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1101">("icld == 1 not supported in module_ra_rrtmg_swf.F")<a name='1639'>
#endif<a name='1640'>
<a name='1641'>
<font color=#447700>!$acc end kernels      <a name='1642'></font>
      endif<a name='1643'>
<a name='1644'>
<font color=#447700>! Maximum-Random cloud overlap<a name='1645'></font>
      if (icld==2) then<a name='1646'>
#ifdef _ACCEL<a name='1647'>
<font color=#447700>!$acc kernels <a name='1648'></font>
           <a name='1649'>
            do ilev = 1,nlay<a name='1650'>
               do i = 1, ncol<a name='1651'>
                  seed1 = (play(i,1) - int(play(i,1)))  * 100000000 - ilev<a name='1652'>
                  seed2 = (play(i,2) - int(play(i,2)))  * 100000000 + ilev<a name='1653'>
                  seed3 = (play(i,3) - int(play(i,3)))  * 100000000 + ilev * 6.2<a name='1654'>
                  seed4 = (play(i,4) - int(play(i,4)))  * 100000000           <a name='1655'>
                  do isubcol = 1,nsubcol<a name='1656'>
                     seed1 = 69069  * seed1 + 132721785 <a name='1657'>
                     seed2 = 11002  * iand (seed2, 65535 ) + ishft (seed2, - 16 )<a name='1658'>
                     seed3 = 18000  * iand (seed3, 65535 ) + ishft (seed3, - 16 )<a name='1659'>
                     seed4 = 30903  * iand (seed4, 65535 ) + ishft (seed4, - 16 )<a name='1660'>
                     kiss = seed1 + seed2 + ishft (seed3, 16 ) + seed4<a name='1661'>
                     CDF(i,ilev,isubcol) = kiss*2.328306e-10  + 0.5 <a name='1662'>
                  end do<a name='1663'>
               end do<a name='1664'>
            end do<a name='1665'>
<a name='1666'>
            do ilev = 2,nlay<a name='1667'>
               do i = 1, ncol<a name='1668'>
                  do isubcol = 1,nsubcol<a name='1669'>
                     if (CDF(i,ilev-1,isubcol) &gt; 1.  - cld(i, ilev-1)) then <a name='1670'>
                        CDF(i,ilev,isubcol) = CDF(i,ilev-1,isubcol)<a name='1671'>
                     else<a name='1672'>
                        CDF(i,ilev,isubcol) = CDF(i,ilev,isubcol) * (1. - cld(i, ilev-1))<a name='1673'>
                     end if<a name='1674'>
                  end do<a name='1675'>
               end do<a name='1676'>
            end do<a name='1677'>
            <a name='1678'>
<font color=#447700>!$acc end kernels      <a name='1679'></font>
#else<a name='1680'>
<font color=#447700>!jm set up to match the ra_sw_physics=4 random number generator '<a name='1681'></font>
<a name='1682'>
<font color=#447700>!jm moved isubcol loop out of here and put in the ilev.eq.1 conditional for initial<a name='1683'></font>
<font color=#447700>!jm computation of seeds so we get the same results as the ra_sw_physics=4 option<a name='1684'></font>
           do isubcol = 1,nsubcol<a name='1685'>
           do ilev = 1,nlay<a name='1686'>
               do i = 1, ncol<a name='1687'>
                if (ilev.eq.1.and.isubcol.eq.1)then<a name='1688'>
                  seed1(i) = (play(i,1)*100 - int(play(i,1)*100))  * 1000000000  <font color=#447700>!jm<a name='1689'></font>
                  seed2(i) = (play(i,2)*100 - int(play(i,2)*100))  * 1000000000  <font color=#447700>!jm<a name='1690'></font>
                  seed3(i) = (play(i,3)*100 - int(play(i,3)*100))  * 1000000000  <font color=#447700>!jm<a name='1691'></font>
                  seed4(i) = (play(i,4)*100 - int(play(i,4)*100))  * 1000000000<a name='1692'>
                     seed1(i) = 69069  * seed1(i) + 1327217885<a name='1693'>
                     seed2(i) = m (m (m (seed2(i), 13), - 17), 5)<a name='1694'>
                     seed3(i) = 18000  * iand (seed3(i), 65535 ) + ishft (seed3(i), - 16 )<a name='1695'>
                     seed4(i) = 30903  * iand (seed4(i), 65535 ) + ishft (seed4(i), - 16 )<a name='1696'>
                     kiss = seed1(i) + seed2(i) + ishft (seed3(i), 16 ) + seed4(i)<a name='1697'>
                 endif<a name='1698'>
<a name='1699'>
                 seed1(i) = 69069  * seed1(i) + 1327217885<a name='1700'>
                 seed2(i) = m (m (m (seed2(i), 13), - 17), 5)<a name='1701'>
                 seed3(i) = 18000  * iand (seed3(i), 65535 ) + ishft (seed3(i), - 16 )<a name='1702'>
                 seed4(i) = 30903  * iand (seed4(i), 65535 ) + ishft (seed4(i), - 16 )<a name='1703'>
                 kiss = seed1(i) + seed2(i) + ishft (seed3(i), 16 ) + seed4(i)<a name='1704'>
<a name='1705'>
                 CDF(i,ilev,isubcol) = kiss*2.328306e-10  + 0.5<a name='1706'>
               end do<a name='1707'>
            end do<a name='1708'>
            end do<a name='1709'>
<a name='1710'>
            do ilev = 2,nlay<a name='1711'>
               do i = 1, ncol<a name='1712'>
                  do isubcol = 1,nsubcol<a name='1713'>
                     if (CDF(i,ilev-1,isubcol) &gt; 1.  - cld(i, ilev-1)) then<a name='1714'>
                        CDF(i,ilev,isubcol) = CDF(i,ilev-1,isubcol)<a name='1715'>
                     else<a name='1716'>
                        CDF(i,ilev,isubcol) = CDF(i,ilev,isubcol) * (1. - cld(i, ilev-1))<a name='1717'>
                     end if<a name='1718'>
                  end do<a name='1719'>
               end do<a name='1720'>
            end do<a name='1721'>
#endif<a name='1722'>
      endif<a name='1723'>
<a name='1724'>
<font color=#447700>! Maximum cloud overlap<a name='1725'></font>
      if (icld==3) then<a name='1726'>
<font color=#447700>!$acc kernels <a name='1727'></font>
           <a name='1728'>
#ifdef _ACCEL<a name='1729'>
            do i = 1, ncol<a name='1730'>
               seed1 = (play(i,1) - int(play(i,1)))  * 100000000 - ilev<a name='1731'>
               seed2 = (play(i,2) - int(play(i,2)))  * 100000000 + ilev<a name='1732'>
               seed3 = (play(i,3) - int(play(i,3)))  * 100000000 + ilev * 6.2<a name='1733'>
               seed4 = (play(i,4) - int(play(i,4)))  * 100000000           <a name='1734'>
               do isubcol = 1,nsubcol<a name='1735'>
                  seed1 = 69069  * seed1 + 132721785 <a name='1736'>
                  seed2 = 11002  * iand (seed2, 65535 ) + ishft (seed2, - 16 )<a name='1737'>
                  seed3 = 18000  * iand (seed3, 65535 ) + ishft (seed3, - 16 )<a name='1738'>
                  seed4 = 30903  * iand (seed4, 65535 ) + ishft (seed4, - 16 )<a name='1739'>
                  kiss = seed1 + seed2 + ishft (seed3, 16 ) + seed4<a name='1740'>
                  do ilev = 1,nlay<a name='1741'>
                     CDF(i,ilev,isubcol) = kiss*2.328306e-10  + 0.5 <a name='1742'>
                  end do<a name='1743'>
               end do<a name='1744'>
            end do<a name='1745'>
#else<a name='1746'>
         CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MCICA_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1102">("icld == 3 not supported in module_ra_rrtmg_swf.F")<a name='1747'>
#endif<a name='1748'>
<a name='1749'>
<font color=#447700>!$acc end kernels      <a name='1750'></font>
      endif<a name='1751'>
<a name='1752'>
      ngbm = ngb(1) - 1<a name='1753'>
<font color=#447700>!$acc kernels <a name='1754'></font>
      do ilev = 1,nlay<a name='1755'>
         do i = 1, ncol<a name='1756'>
            do isubcol = 1, nsubcol<a name='1757'>
<a name='1758'>
               if ( CDF(i,ilev,isubcol)&gt;=(1.0 - cld(i,ilev)) ) then<a name='1759'>
                  cld_stoch(i,ilev,isubcol) = 1.0 <a name='1760'>
                  clwp_stoch(i,ilev,isubcol) = clwp(i,ilev)<a name='1761'>
                  ciwp_stoch(i,ilev,isubcol) = ciwp(i,ilev)<a name='1762'>
                  cswp_stoch(i,ilev,isubcol) = cswp(i,ilev)<a name='1763'>
                  n = ngb(isubcol) - ngbm<a name='1764'>
                  tauc_stoch(i,ilev,isubcol) = tauc(i,ilev,n)<a name='1765'>
                  ssac_stoch(i,ilev,isubcol) = ssac(i,ilev,n)<a name='1766'>
                  asmc_stoch(i,ilev,isubcol) = asmc(i,ilev,n)<a name='1767'>
                  fsfc_stoch(i,ilev,isubcol) = fsfc(i,ilev,n)<a name='1768'>
               else<a name='1769'>
                  cld_stoch(i,ilev,isubcol) = 0. <a name='1770'>
                  clwp_stoch(i,ilev,isubcol) = 0. <a name='1771'>
                  ciwp_stoch(i,ilev,isubcol) = 0. <a name='1772'>
                  cswp_stoch(i,ilev,isubcol) = 0. <a name='1773'>
                  tauc_stoch(i,ilev,isubcol) = 0. <a name='1774'>
                  ssac_stoch(i,ilev,isubcol) = 1. <a name='1775'>
                  asmc_stoch(i,ilev,isubcol) = 0. <a name='1776'>
                  fsfc_stoch(i,ilev,isubcol) = 0. <a name='1777'>
               endif<a name='1778'>
            enddo<a name='1779'>
         enddo<a name='1780'>
      enddo<a name='1781'>
<font color=#447700>!$acc end kernels<a name='1782'></font>
#ifndef _ACCEL<a name='1783'>
# undef ncol<a name='1784'>
#endif<a name='1785'>
<a name='1786'>
      end subroutine mcica_sw<a name='1787'>
<a name='1788'>
      end module mcica_subcol_gen_sw_f<a name='1789'>
<a name='1790'>
<A NAME='RRTMG_SW_CLDPRMC_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_CLDPRMC_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='1791'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_cldprmc_f</font> <A href='../../call_to/RRTMG_SW_CLDPRMC_F.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_CLDPRMC_F.html' TARGET='index'>4</A><a name='1792'>
<a name='1793'>
<font color=#447700>! ------- Modules -------<a name='1794'></font>
<a name='1795'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_CLDPRMC_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_18">, only : ngptsw, jpband, jpb1, jpb2<a name='1796'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_CLD_F'>rrsw_cld_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_CLDPRMC_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CLD_F_1">, only : extliq1, ssaliq1, asyliq1, &amp;<a name='1797'>
                           extice2, ssaice2, asyice2, &amp;<a name='1798'>
                           extice3, ssaice3, asyice3, fdlice3, &amp;<a name='1799'>
                           abari, bbari, cbari, dbari, ebari, fbari<a name='1800'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_WVN_F'>rrsw_wvn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_CLDPRMC_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_F_2">, only : wavenum2, ngb, icxa<a name='1801'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_VSN_F'>rrsw_vsn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_CLDPRMC_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_F_2">, only : hvrclc, hnamclc<a name='1802'>
<a name='1803'>
      implicit none<a name='1804'>
<a name='1805'>
      contains<a name='1806'>
<a name='1807'>
<font color=#447700>! ----------------------------------------------------------------------------<a name='1808'></font>
<A NAME='CLDPRMC_SW'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1809'>
      <font color=#993300>subroutine </font><font color=#cc0000>cldprmc_sw</font>(ncol, nlayers, inflag, iceflag, liqflag, cldfmc, &amp; <A href='../../call_to/CLDPRMC_SW.html' TARGET='index'>2</A>,<A href='../../call_from/CLDPRMC_SW.html' TARGET='index'>11</A><a name='1810'>
                            ciwpmc, clwpmc, cswpmc, reicmc, relqmc, resnmc, &amp;<a name='1811'>
                            taormc, taucmc, ssacmc, asmcmc, fsfcmc)<a name='1812'>
<font color=#447700>! ----------------------------------------------------------------------------<a name='1813'></font>
<a name='1814'>
<font color=#447700>! Purpose: Compute the cloud optical properties for each cloudy layer<a name='1815'></font>
<font color=#447700>! and g-point interval for use by the McICA method.  <a name='1816'></font>
<font color=#447700>! Note: Only inflag = 0 and inflag=2/liqflag=1/iceflag=1,2,3 are available;<a name='1817'></font>
<font color=#447700>! (Hu &amp; Stamnes, Ebert and Curry, Key, and Fu) are implemented. <a name='1818'></font>
<a name='1819'>
<font color=#447700>! ------- Input -------<a name='1820'></font>
<a name='1821'>
      integer , intent(in) :: nlayers         <font color=#447700>! total number of layers<a name='1822'></font>
      integer , intent(in) :: inflag          <font color=#447700>! see definitions<a name='1823'></font>
      integer , intent(in) :: iceflag         <font color=#447700>! see definitions<a name='1824'></font>
      integer , intent(in) :: liqflag         <font color=#447700>! see definitions<a name='1825'></font>
      integer , intent(in) :: ncol<a name='1826'>
<a name='1827'>
      real , intent(in) :: cldfmc(:,:,:)          <font color=#447700>! cloud fraction [mcica]<a name='1828'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='1829'></font>
      real , intent(in) :: ciwpmc(:,:,:)          <font color=#447700>! cloud ice water path [mcica]<a name='1830'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='1831'></font>
      real , intent(in) :: clwpmc(:,:,:)          <font color=#447700>! cloud liquid water path [mcica]<a name='1832'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='1833'></font>
      real , intent(in) :: cswpmc(:,:,:)          <font color=#447700>! cloud snow water path [mcica]<a name='1834'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='1835'></font>
      real , intent(in) :: relqmc(:,:)           <font color=#447700>! cloud liquid particle effective radius (microns)<a name='1836'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='1837'></font>
      real , intent(in) :: resnmc(:,:)           <font color=#447700>! cloud snow particle effective radius (microns)<a name='1838'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='1839'></font>
      real , intent(in) :: reicmc(:,:)           <font color=#447700>! cloud ice particle effective radius (microns)<a name='1840'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='1841'></font>
                                                      <font color=#447700>! specific definition of reicmc depends on setting of iceflag:<a name='1842'></font>
                                                      <font color=#447700>! iceflag = 0: (inactive)<a name='1843'></font>
                                                      <font color=#447700>!              <a name='1844'></font>
                                                      <font color=#447700>! iceflag = 1: ice effective radius, r_ec, (Ebert and Curry, 1992),<a name='1845'></font>
                                                      <font color=#447700>!              r_ec range is limited to 13.0 to 130.0 microns<a name='1846'></font>
                                                      <font color=#447700>! iceflag = 2: ice effective radius, r_k, (Key, Streamer Ref. Manual, 1996)<a name='1847'></font>
                                                      <font color=#447700>!              r_k range is limited to 5.0 to 131.0 microns<a name='1848'></font>
                                                      <font color=#447700>! iceflag = 3: generalized effective size, dge, (Fu, 1996),<a name='1849'></font>
                                                      <font color=#447700>!              dge range is limited to 5.0 to 140.0 microns<a name='1850'></font>
                                                      <font color=#447700>!              [dge = 1.0315 * r_ec]<a name='1851'></font>
      real , intent(in) :: fsfcmc(:,:,:)          <font color=#447700>! cloud forward scattering fraction<a name='1852'></font>
                                                      <font color=#447700>!    Dimensions: (ngptsw,nlayers)<a name='1853'></font>
<a name='1854'>
<font color=#447700>! ------- Output -------<a name='1855'></font>
<a name='1856'>
      real , intent(inout) :: taucmc(:,:,:)       <font color=#447700>! cloud optical depth (delta scaled)<a name='1857'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlayers,ngptsw)<a name='1858'></font>
      real , intent(inout) :: ssacmc(:,:,:)       <font color=#447700>! single scattering albedo (delta scaled)<a name='1859'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlayers,ngptsw)<a name='1860'></font>
      real , intent(inout) :: asmcmc(:,:,:)       <font color=#447700>! asymmetry parameter (delta scaled)<a name='1861'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlayers,ngptsw)<a name='1862'></font>
      real , intent(out) :: taormc(:,:,:)         <font color=#447700>! cloud optical depth (non-delta scaled)<a name='1863'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlayers,ngptsw)<a name='1864'></font>
<a name='1865'>
<font color=#447700>! ------- Local -------<a name='1866'></font>
<a name='1867'>
<font color=#447700>!      integer  :: ncbands<a name='1868'></font>
      integer  :: ib, lay, istr, index, icx, ig, iplon<a name='1869'>
<a name='1870'>
      real , parameter :: eps = 1.e-06      <font color=#447700>! epsilon<a name='1871'></font>
      real , parameter :: cldmin = 1.e-20   <font color=#447700>! minimum value for cloud quantities<a name='1872'></font>
      real  :: cwp                            <font color=#447700>! total cloud water path<a name='1873'></font>
      real  :: radliq                         <font color=#447700>! cloud liquid droplet radius (microns)<a name='1874'></font>
      real  :: radice                         <font color=#447700>! cloud ice effective size (microns)<a name='1875'></font>
      real  :: radsno                         <font color=#447700>! cloud snow effective size (microns)<a name='1876'></font>
      real  :: factor<a name='1877'>
      real  :: fint<a name='1878'>
<a name='1879'>
      real  :: taucldorig_a, taucloud_a, ssacloud_a, ffp, ffp1, ffpssa<a name='1880'>
      real  :: tauiceorig, scatice, ssaice, tauice, tauliqorig, scatliq, ssaliq, tauliq<a name='1881'>
      real  :: tausnoorig, scatsno, ssasno, tausno<a name='1882'>
<a name='1883'>
      real  :: fdelta<a name='1884'>
      real  :: extcoice, gice<a name='1885'>
      real  :: ssacoice, forwice<a name='1886'>
      real  :: extcoliq, gliq<a name='1887'>
      real  :: ssacoliq, forwliq<a name='1888'>
      real  :: extcosno, gsno<a name='1889'>
      real  :: ssacosno, forwsno<a name='1890'>
<a name='1891'>
<font color=#447700>! Initialize<a name='1892'></font>
<a name='1893'>
<a name='1894'>
<font color=#447700>!$acc kernels<a name='1895'></font>
<a name='1896'>
      taormc   = taucmc<a name='1897'>
  <a name='1898'>
<font color=#447700>!$acc end kernels    <a name='1899'></font>
<a name='1900'>
#ifndef _ACCEL<a name='1901'>
#  define ncol CHNK<a name='1902'>
#endif<a name='1903'>
<a name='1904'>
<font color=#447700>! Main layer loop<a name='1905'></font>
<a name='1906'>
<font color=#447700>!$acc kernels loop present(cldfmc, ciwpmc, clwpmc, cswpmc, relqmc, reicmc, resnmc, fsfcmc,taucmc, ssacmc, asmcmc, taormc)<a name='1907'></font>
    do iplon = 1, ncol<a name='1908'>
      <font color=#447700>!$acc loop <a name='1909'></font>
      do lay = 1, nlayers<a name='1910'>
<a name='1911'>
         <font color=#447700>!$acc loop private(fdelta,extcoice,gice,ssacoice,forwice,extcoliq,gliq,ssacoliq,forwliq,gsno,forwsno,scatsno)<a name='1912'></font>
         do ig = 1, ngptsw <a name='1913'>
            cwp = ciwpmc(iplon,lay,ig) + clwpmc(iplon,lay,ig) + cswpmc(iplon,lay,ig)  <a name='1914'>
<a name='1915'>
            if (cldfmc(iplon,lay,ig)   .ge. cldmin .and. &amp;<a name='1916'>
               (cwp .ge. cldmin .or. taucmc(iplon,lay,ig)   .ge. cldmin)) then<a name='1917'>
<a name='1918'>
<font color=#447700>! (inflag=0): Cloud optical properties input directly<a name='1919'></font>
               if (inflag .eq. 0) then<a name='1920'>
<font color=#447700>! Cloud optical properties already defined in taucmc, ssacmc, asmcmc are unscaled;<a name='1921'></font>
<font color=#447700>! Apply delta-M scaling here (using Henyey-Greenstein approximation)<a name='1922'></font>
                  taucldorig_a = taucmc(iplon,lay,ig)  <a name='1923'>
                  ffp = fsfcmc(iplon,lay,ig)  <a name='1924'>
                  ffp1 = 1.0  - ffp<a name='1925'>
                  ffpssa = 1.0  - ffp * ssacmc(iplon,lay,ig)  <a name='1926'>
                  ssacloud_a = ffp1 * ssacmc(iplon,lay,ig)   / ffpssa<a name='1927'>
                  taucloud_a = ffpssa * taucldorig_a<a name='1928'>
<a name='1929'>
                  taormc(iplon,lay,ig)   = taucldorig_a<a name='1930'>
                  ssacmc(iplon,lay,ig)   = ssacloud_a<a name='1931'>
                  taucmc(iplon,lay,ig)   = taucloud_a<a name='1932'>
                  asmcmc(iplon,lay,ig)   = (asmcmc(iplon,lay,ig)   - ffp) / (ffp1)<a name='1933'>
<a name='1934'>
<font color=#447700>! (inflag=2): Separate treatement of ice clouds and water clouds.<a name='1935'></font>
               elseif (inflag .ge. 2) then       <a name='1936'>
                  radice = reicmc(iplon,lay) <a name='1937'>
<a name='1938'>
<font color=#447700>! Calculation of absorption coefficients due to ice clouds.<a name='1939'></font>
                  if (ciwpmc(iplon,lay,ig) + cswpmc(iplon,lay,ig) .eq. 0.0 ) then<a name='1940'>
                     extcoice = 0.0 <a name='1941'>
                     ssacoice = 0.0 <a name='1942'>
                     gice     = 0.0 <a name='1943'>
                     forwice  = 0.0 <a name='1944'>
<a name='1945'>
                     extcosno = 0.0<a name='1946'>
                     ssacosno = 0.0<a name='1947'>
                     gsno     = 0.0<a name='1948'>
                     forwsno  = 0.0<a name='1949'>
<a name='1950'>
<font color=#447700>! (iceflag = 1): <a name='1951'></font>
<font color=#447700>! Note: This option uses Ebert and Curry approach for all particle sizes similar to<a name='1952'></font>
<font color=#447700>! CAM3 implementation, though this is somewhat unjustified for large ice particles<a name='1953'></font>
                  elseif (iceflag .eq. 1) then<a name='1954'>
                   <a name='1955'>
                     ib = ngb(ig )<a name='1956'>
                     ib = icxa(ib)<a name='1957'>
  <a name='1958'>
                     extcoice = (abari(ib) + bbari(ib)/radice)<a name='1959'>
                     ssacoice = 1.  - cbari(ib) - dbari(ib) * radice<a name='1960'>
                     gice = ebari(ib) + fbari(ib) * radice<a name='1961'>
<font color=#447700>! Check to ensure upper limit of gice is within physical limits for large particles<a name='1962'></font>
                     if (gice.ge.1. ) gice = 1.  - eps<a name='1963'>
                     forwice = gice*gice<a name='1964'>
<font color=#447700>! Check to ensure all calculated quantities are within physical limits.<a name='1965'></font>
<font color=#447700>! mji - added checks below<a name='1966'></font>
                     if (extcoice .lt. 0.0) extcoice = 0.0<a name='1967'>
                     if (ssacoice .gt. 1.0) ssacoice = 1.0<a name='1968'>
                     if (ssacoice .lt. 0.0) ssacoice = 0.0<a name='1969'>
                     if (gice .gt. 1.0) gice = 1.0<a name='1970'>
                     if (gice .lt. 0.0) gice = 0.0<a name='1971'>
                  <a name='1972'>
<a name='1973'>
<font color=#447700>! For iceflag=2 option, ice particle effective radius is limited to 5.0 to 131.0 microns<a name='1974'></font>
<a name='1975'>
                  elseif (iceflag .eq. 2) then<a name='1976'>
                     <a name='1977'>
                     factor = (radice - 2. )/3. <a name='1978'>
                     index = int(factor)<a name='1979'>
<font color=#447700>! mji - temporary fix to prevent out of range subscripts<a name='1980'></font>
                     if (index .le. 0) index = 1<a name='1981'>
                     if (index .ge. 43) index = 42<a name='1982'>
<font color=#447700>!                     if (index .eq. 43) index = 42<a name='1983'></font>
                     fint = factor - float(index)<a name='1984'>
                     ib = ngb(ig)<a name='1985'>
                     extcoice = extice2(index,ib) + fint * &amp;<a name='1986'>
                                   (extice2(index+1,ib) -  extice2(index,ib))<a name='1987'>
                     ssacoice = ssaice2(index,ib) + fint * &amp;<a name='1988'>
                                   (ssaice2(index+1,ib) -  ssaice2(index,ib))<a name='1989'>
                     gice = asyice2(index,ib) + fint * &amp;<a name='1990'>
                                   (asyice2(index+1,ib) -  asyice2(index,ib))<a name='1991'>
                     forwice = gice*gice<a name='1992'>
<font color=#447700>! Check to ensure all calculated quantities are within physical limits.<a name='1993'></font>
<font color=#447700>! mji - added checks below<a name='1994'></font>
                     if (extcoice .lt. 0.0) extcoice = 0.0<a name='1995'>
                     if (ssacoice .gt. 1.0) ssacoice = 1.0<a name='1996'>
                     if (ssacoice .lt. 0.0) ssacoice = 0.0<a name='1997'>
                     if (gice .gt. 1.0) gice = 1.0<a name='1998'>
                     if (gice .lt. 0.0) gice = 0.0<a name='1999'>
                 <a name='2000'>
<a name='2001'>
<font color=#447700>! For iceflag=3 option, ice particle generalized effective size is limited to 5.0 to 140.0 microns<a name='2002'></font>
<a name='2003'>
                  elseif (iceflag .ge. 3) then<a name='2004'>
                    <a name='2005'>
                     factor = (radice - 2. )/3. <a name='2006'>
                     index = int(factor)<a name='2007'>
<font color=#447700>! mji - temporary fix to prevent out of range subscripts<a name='2008'></font>
                     if (index .le. 0) index = 1<a name='2009'>
                     if (index .ge. 46) index = 45<a name='2010'>
<font color=#447700>!                     if (index .eq. 46) index = 45<a name='2011'></font>
                     fint = factor - float(index)<a name='2012'>
                     ib = ngb(ig)<a name='2013'>
                     extcoice = extice3(index,ib) + fint * &amp;<a name='2014'>
                                   (extice3(index+1,ib) - extice3(index,ib))<a name='2015'>
                     ssacoice = ssaice3(index,ib) + fint * &amp;<a name='2016'>
                                   (ssaice3(index+1,ib) - ssaice3(index,ib))<a name='2017'>
                     gice = asyice3(index,ib) + fint * &amp;<a name='2018'>
                               (asyice3(index+1,ib) - asyice3(index,ib))<a name='2019'>
                     fdelta = fdlice3(index,ib) + fint * &amp;<a name='2020'>
                                 (fdlice3(index+1,ib) - fdlice3(index,ib))<a name='2021'>
                  <a name='2022'>
                     forwice = fdelta + 0.5  / ssacoice<a name='2023'>
<font color=#447700>! See Fu 1996 p. 2067 <a name='2024'></font>
                     if (forwice .gt. gice) forwice = gice<a name='2025'>
<font color=#447700>! Check to ensure all calculated quantities are within physical limits.  <a name='2026'></font>
<font color=#447700>! mji - added checks below<a name='2027'></font>
                     if (extcoice .lt. 0.0) extcoice = 0.0<a name='2028'>
                     if (ssacoice .gt. 1.0) ssacoice = 1.0<a name='2029'>
                     if (ssacoice .lt. 0.0) ssacoice = 0.0<a name='2030'>
                     if (gice .gt. 1.0) gice = 1.0<a name='2031'>
                     if (gice .lt. 0.0) gice = 0.0<a name='2032'>
                  <a name='2033'>
                  endif<a name='2034'>
<a name='2035'>
<font color=#447700>!!!!!!!!!!!!!!!!!! Mukul !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<a name='2036'></font>
<font color=#447700>!!!!  INSERT THE EQUIVALENT SNOW VARIABLE CODE HERE<a name='2037'></font>
<font color=#447700>!!!! Although far from perfect, the snow will utilize the<a name='2038'></font>
<font color=#447700>!!!! same lookup table constants as cloud ice.  Changes<a name='2039'></font>
<font color=#447700>!!!! to those constants for larger particle snow would be<a name='2040'></font>
<font color=#447700>!!!! an improvement.<a name='2041'></font>
<font color=#447700>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<a name='2042'></font>
<a name='2043'>
                  if (cswpmc(iplon,lay,ig).gt.0.0 .and. iceflag .eq. 5) then<a name='2044'>
                     radsno = resnmc(iplon,lay)<a name='2045'>
                     factor = (radsno - 2.)/3.<a name='2046'>
                     index = int(factor)<a name='2047'>
<font color=#447700>! mji - temporary fix to prevent out of range subscripts<a name='2048'></font>
                     if (index .le. 0) index = 1<a name='2049'>
                     if (index .ge. 46) index = 45<a name='2050'>
<font color=#447700>!                     if (index .eq. 46) index = 45<a name='2051'></font>
                     fint = factor - float(index)<a name='2052'>
                     ib = ngb(ig)<a name='2053'>
                     extcosno = extice3(index,ib) + fint * &amp;<a name='2054'>
                                   (extice3(index+1,ib) - extice3(index,ib))<a name='2055'>
                     ssacosno = ssaice3(index,ib) + fint * &amp;<a name='2056'>
                                   (ssaice3(index+1,ib) - ssaice3(index,ib))<a name='2057'>
                     gsno = asyice3(index,ib) + fint * &amp;<a name='2058'>
                               (asyice3(index+1,ib) - asyice3(index,ib))<a name='2059'>
                     fdelta = fdlice3(index,ib) + fint * &amp;<a name='2060'>
                                 (fdlice3(index+1,ib) - fdlice3(index,ib))<a name='2061'>
                     forwsno = fdelta + 0.5 / ssacosno<a name='2062'>
<font color=#447700>! See Fu 1996 p. 2067<a name='2063'></font>
                     if (forwsno .gt. gsno) forwsno = gsno<a name='2064'>
<font color=#447700>! Check to ensure all calculated quantities are within physical limits.  <a name='2065'></font>
<font color=#447700>! mji - added checks below<a name='2066'></font>
                     if (extcosno .lt. 0.0) extcosno = 0.0<a name='2067'>
                     if (ssacosno .gt. 1.0) ssacosno = 1.0<a name='2068'>
                     if (ssacosno .lt. 0.0) ssacosno = 0.0<a name='2069'>
                     if (gsno .gt. 1.0) gsno = 1.0<a name='2070'>
                     if (gsno .lt. 0.0) gsno = 0.0<a name='2071'>
<font color=#447700>!<a name='2072'></font>
                  else<a name='2073'>
                     extcosno = 0.0<a name='2074'>
                     ssacosno = 0.0<a name='2075'>
                     gsno     = 0.0<a name='2076'>
                     forwsno  = 0.0<a name='2077'>
                  endif<a name='2078'>
<a name='2079'>
<font color=#447700>! Calculation of absorption coefficients due to water clouds.<a name='2080'></font>
                  if (clwpmc(iplon,lay,ig)   .eq. 0.0 ) then<a name='2081'>
                     extcoliq = 0.0 <a name='2082'>
                     ssacoliq = 0.0 <a name='2083'>
                     gliq = 0.0 <a name='2084'>
                     forwliq = 0.0 <a name='2085'>
<a name='2086'>
                  elseif (liqflag .eq. 1) then<a name='2087'>
                     radliq = relqmc(iplon,lay) <a name='2088'>
                   <a name='2089'>
                     index = int(radliq - 1.5 )<a name='2090'>
<font color=#447700>! mji - temporary fix to prevent out of range subscripts<a name='2091'></font>
                     if (index .le. 0) index = 1<a name='2092'>
                     if (index .ge. 58) index = 57<a name='2093'>
<font color=#447700>!                     if (index .eq. 0) index = 1<a name='2094'></font>
<font color=#447700>!                     if (index .eq. 58) index = 57<a name='2095'></font>
                     fint = radliq - 1.5  - float(index)<a name='2096'>
                     ib = ngb(ig)<a name='2097'>
                     extcoliq = extliq1(index,ib) + fint * &amp;<a name='2098'>
                                   (extliq1(index+1,ib) - extliq1(index,ib))<a name='2099'>
                     ssacoliq = ssaliq1(index,ib) + fint * &amp;<a name='2100'>
                                   (ssaliq1(index+1,ib) - ssaliq1(index,ib))<a name='2101'>
                     if (fint .lt. 0.  .and. ssacoliq .gt. 1. ) &amp;<a name='2102'>
                                    ssacoliq = ssaliq1(index,ib)<a name='2103'>
                     gliq = asyliq1(index,ib) + fint * &amp;<a name='2104'>
                               (asyliq1(index+1,ib) - asyliq1(index,ib))<a name='2105'>
                     forwliq = gliq*gliq<a name='2106'>
<font color=#447700>! Check to ensure all calculated quantities are within physical limits.<a name='2107'></font>
<font color=#447700>! mji - added checks below<a name='2108'></font>
                     if (extcoliq .lt. 0.0) extcoliq = 0.0<a name='2109'>
                     if (ssacoliq .gt. 1.0) ssacoliq = 1.0<a name='2110'>
                     if (ssacoliq .lt. 0.0) ssacoliq = 0.0<a name='2111'>
                     if (gliq .gt. 1.0) gliq = 1.0<a name='2112'>
                     if (gliq .lt. 0.0) gliq = 0.0<a name='2113'>
<font color=#447700>!<a name='2114'></font>
                  endif<a name='2115'>
   <a name='2116'>
                  if (iceflag .lt. 5) then<a name='2117'>
                     tauliqorig = clwpmc(iplon,lay,ig)   * extcoliq<a name='2118'>
                     tauiceorig = ciwpmc(iplon,lay,ig)   * extcoice<a name='2119'>
                     taormc(iplon,lay,ig)   = tauliqorig + tauiceorig<a name='2120'>
<a name='2121'>
                     ssaliq = ssacoliq * (1.  - forwliq) / &amp;<a name='2122'>
                             (1.  - forwliq * ssacoliq)<a name='2123'>
                     tauliq = (1.  - forwliq * ssacoliq) * tauliqorig<a name='2124'>
                     ssaice = ssacoice * (1.  - forwice) / &amp;<a name='2125'>
                             (1.  - forwice * ssacoice)<a name='2126'>
                     tauice = (1.  - forwice * ssacoice) * tauiceorig<a name='2127'>
<a name='2128'>
                     scatliq = ssaliq * tauliq<a name='2129'>
                     scatice = ssaice * tauice<a name='2130'>
                     taucmc(iplon,lay,ig)   = tauliq + tauice<a name='2131'>
                  else<a name='2132'>
                     tauliqorig = clwpmc(iplon,lay,ig)   * extcoliq<a name='2133'>
                     tauiceorig = ciwpmc(iplon,lay,ig)   * extcoice<a name='2134'>
                     tausnoorig = cswpmc(iplon,lay,ig)   * extcosno<a name='2135'>
                     taormc(iplon,lay,ig)   = tauliqorig + tauiceorig + tausnoorig<a name='2136'>
<a name='2137'>
                     ssaliq = ssacoliq * (1.  - forwliq) / &amp;<a name='2138'>
                             (1.  - forwliq * ssacoliq)<a name='2139'>
                     tauliq = (1.  - forwliq * ssacoliq) * tauliqorig<a name='2140'>
                     ssaice = ssacoice * (1.  - forwice) / &amp;<a name='2141'>
                             (1.  - forwice * ssacoice)<a name='2142'>
                     tauice = (1.  - forwice * ssacoice) * tauiceorig<a name='2143'>
                     ssasno = ssacosno * (1.  - forwsno) / &amp;<a name='2144'>
                             (1.  - forwsno * ssacosno)<a name='2145'>
                     tausno = (1.  - forwsno * ssacosno) * tausnoorig<a name='2146'>
<a name='2147'>
                     scatliq = ssaliq * tauliq<a name='2148'>
                     scatice = ssaice * tauice<a name='2149'>
                     scatsno = ssasno * tausno<a name='2150'>
                     taucmc(iplon,lay,ig)   = tauliq + tauice + tausno<a name='2151'>
                  endif<a name='2152'>
<a name='2153'>
<font color=#447700>! Ensure non-zero taucmc and scatice<a name='2154'></font>
                  if(taucmc(iplon,lay,ig)  .eq.0.) taucmc(iplon,lay,ig)   = cldmin<a name='2155'>
                  if(scatice.eq.0.) scatice = cldmin<a name='2156'>
                  if(scatsno.eq.0.) scatsno = cldmin<a name='2157'>
<a name='2158'>
                  if (iceflag .lt. 5) then<a name='2159'>
                     ssacmc(iplon,lay,ig)   = (scatliq + scatice) / taucmc(iplon,lay,ig)  <a name='2160'>
                  else<a name='2161'>
                     ssacmc(iplon,lay,ig)   = (scatliq + scatice + scatsno) / taucmc(iplon,lay,ig)  <a name='2162'>
                  endif<a name='2163'>
<a name='2164'>
                  if (iceflag .eq. 3 .or. iceflag.eq.4) then<a name='2165'>
<font color=#447700>! In accordance with the 1996 Fu paper, equation A.3, <a name='2166'></font>
<font color=#447700>! the moments for ice were calculated depending on whether using spheres<a name='2167'></font>
<font color=#447700>! or hexagonal ice crystals.<a name='2168'></font>
<font color=#447700>! Set asymetry parameter to first moment (istr=1)<a name='2169'></font>
                     istr = 1<a name='2170'>
                     asmcmc(iplon,lay,ig)   = (1.0 /(scatliq+scatice))* &amp;<a name='2171'>
                        (scatliq*(gliq**istr - forwliq) / &amp;<a name='2172'>
                        (1.0  - forwliq) + scatice * ((gice-forwice)/ &amp;<a name='2173'>
                        (1.0  - forwice))**istr)<a name='2174'>
<a name='2175'>
                  elseif (iceflag .eq. 5) then<a name='2176'>
                     istr = 1<a name='2177'>
                     asmcmc(iplon,lay,ig) = (1.0 /(scatliq+scatice+scatsno)) * &amp;<a name='2178'>
                                    (scatliq*(gliq**istr - forwliq)/(1.0 - forwliq)  &amp;<a name='2179'>
                                    + scatice * ((gice-forwice)/(1.0 - forwice))        &amp;<a name='2180'>
                                    + scatsno * ((gsno-forwsno)/(1.0 - forwsno))**istr)<a name='2181'>
<a name='2182'>
                  else <a name='2183'>
<font color=#447700>! This code is the standard method for delta-m scaling. <a name='2184'></font>
<font color=#447700>! Set asymetry parameter to first moment (istr=1)<a name='2185'></font>
                     istr = 1<a name='2186'>
                     asmcmc(iplon,lay,ig)   = (scatliq *  &amp;<a name='2187'>
                        (gliq**istr - forwliq) / &amp;<a name='2188'>
                        (1.0  - forwliq) + scatice * (gice**istr - forwice) / &amp;<a name='2189'>
                        (1.0  - forwice))/(scatliq + scatice)<a name='2190'>
                  endif <a name='2191'>
<a name='2192'>
               endif<a name='2193'>
<a name='2194'>
            endif<a name='2195'>
<a name='2196'>
<font color=#447700>! End g-point interval loop<a name='2197'></font>
         enddo<a name='2198'>
<a name='2199'>
<font color=#447700>! End layer loop<a name='2200'></font>
      enddo<a name='2201'>
<font color=#447700>! End column loop<a name='2202'></font>
      enddo<a name='2203'>
<font color=#447700>!$acc end kernels<a name='2204'></font>
#ifndef _ACCEL<a name='2205'>
#  undef ncol<a name='2206'>
#endif<a name='2207'>
<a name='2208'>
      end subroutine cldprmc_sw<a name='2209'>
<a name='2210'>
      end module rrtmg_sw_cldprmc_f<a name='2211'>
<a name='2212'>
<A NAME='RRTMG_SW_SETCOEF_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SETCOEF_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='2213'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_setcoef_f</font> <A href='../../call_to/RRTMG_SW_SETCOEF_F.html' TARGET='index'>2</A>,<A href='../../call_from/RRTMG_SW_SETCOEF_F.html' TARGET='index'>3</A><a name='2214'>
<a name='2215'>
<font color=#447700>! ------- Modules -------<a name='2216'></font>
<a name='2217'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SETCOEF_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_19">, only : mxmol<a name='2218'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_REF_F'>rrsw_ref_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SETCOEF_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_REF_F_1">, only : pref, preflog, tref<a name='2219'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_VSN_F'>rrsw_vsn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SETCOEF_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_F_3">, only : hvrset, hnamset<a name='2220'>
<a name='2221'>
      implicit none<a name='2222'>
<a name='2223'>
      contains<a name='2224'>
<a name='2225'>
<font color=#447700>!----------------------------------------------------------------------------<a name='2226'></font>
<A NAME='SETCOEF_SW'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SETCOEF_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2227'>
      <font color=#993300>subroutine </font><font color=#cc0000>setcoef_sw</font>(ncol, nlayers, pavel, tavel, pz, tz, tbound, coldry, wkl, &amp; <A href='../../call_to/SETCOEF_SW.html' TARGET='index'>2</A><a name='2228'>
                            laytrop, layswtch, laylow, jp, jt, jt1, &amp;<a name='2229'>
                            co2mult, colch4, colco2, colh2o, colmol, coln2o, &amp;<a name='2230'>
                            colo2, colo3, fac00, fac01, fac10, fac11, &amp;<a name='2231'>
                            selffac, selffrac, indself, forfac, forfrac, indfor)<a name='2232'>
<font color=#447700>!----------------------------------------------------------------------------<a name='2233'></font>
<font color=#447700>!<a name='2234'></font>
<font color=#447700>! Purpose:  For a given atmosphere, calculate the indices and<a name='2235'></font>
<font color=#447700>! fractions related to the pressure and temperature interpolations.<a name='2236'></font>
<a name='2237'>
<font color=#447700>! Modifications:<a name='2238'></font>
<font color=#447700>! Original: J. Delamere, AER, Inc. (version 2.5, 02/04/01)<a name='2239'></font>
<font color=#447700>! Revised: Rewritten and adapted to ECMWF F90, JJMorcrette 030224<a name='2240'></font>
<font color=#447700>! Revised: For uniform rrtmg formatting, MJIacono, Jul 2006<a name='2241'></font>
<a name='2242'>
<font color=#447700>! ------ Declarations -------<a name='2243'></font>
<a name='2244'>
<font color=#447700>! ----- Input -----<a name='2245'></font>
      integer, intent(in) :: ncol<a name='2246'>
<a name='2247'>
      integer , intent(in) :: nlayers         <font color=#447700>! total number of layers<a name='2248'></font>
      <a name='2249'>
      real , intent(in) :: pavel(:,:)            <font color=#447700>! layer pressures (mb) <a name='2250'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2251'></font>
      real , intent(in) :: tavel(:,:)            <font color=#447700>! layer temperatures (K)<a name='2252'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2253'></font>
      real , intent(in) :: pz(:,0:)              <font color=#447700>! level (interface) pressures (hPa, mb)<a name='2254'></font>
                                                      <font color=#447700>!    Dimensions: (0:nlayers)<a name='2255'></font>
      real , intent(in) :: tz(:,0:)              <font color=#447700>! level (interface) temperatures (K)<a name='2256'></font>
                                                      <font color=#447700>!    Dimensions: (0:nlayers)<a name='2257'></font>
      real , intent(in) :: tbound(:)             <font color=#447700>! surface temperature (K)<a name='2258'></font>
      real , intent(in) :: coldry(:,:)           <font color=#447700>! dry air column density (mol/cm2)<a name='2259'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2260'></font>
      real , intent(in) :: wkl(:,:,:)            <font color=#447700>! molecular amounts (mol/cm-2)<a name='2261'></font>
                                                      <font color=#447700>!    Dimensions: (mxmol,nlayers)<a name='2262'></font>
<a name='2263'>
<font color=#447700>! ----- Output -----<a name='2264'></font>
      integer , intent(out) :: laytrop(:)        <font color=#447700>! tropopause layer index<a name='2265'></font>
      integer , intent(out) :: layswtch(:)       <font color=#447700>! <a name='2266'></font>
      integer , intent(out) :: laylow(:)         <font color=#447700>! <a name='2267'></font>
<a name='2268'>
      integer , intent(out) :: jp(:,:)           <font color=#447700>! <a name='2269'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2270'></font>
      integer , intent(out) :: jt(:,:)           <font color=#447700>!<a name='2271'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2272'></font>
      integer , intent(out) :: jt1(:,:)          <font color=#447700>!<a name='2273'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2274'></font>
<a name='2275'>
      real , intent(out) :: colh2o(:,:)          <font color=#447700>! column amount (h2o)<a name='2276'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2277'></font>
      real , intent(out) :: colco2(:,:)          <font color=#447700>! column amount (co2)<a name='2278'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2279'></font>
      real , intent(out) :: colo3(:,:)           <font color=#447700>! column amount (o3)<a name='2280'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2281'></font>
      real , intent(out) :: coln2o(:,:)          <font color=#447700>! column amount (n2o)<a name='2282'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2283'></font>
      real , intent(out) :: colch4(:,:)          <font color=#447700>! column amount (ch4)<a name='2284'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2285'></font>
      real , intent(out) :: colo2(:,:)           <font color=#447700>! column amount (o2)<a name='2286'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2287'></font>
      real , intent(out) :: colmol(:,:)          <font color=#447700>! <a name='2288'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2289'></font>
      real , intent(out) :: co2mult(:,:)         <font color=#447700>!<a name='2290'></font>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2291'></font>
<a name='2292'>
      integer , intent(out) :: indself(:,:) <a name='2293'>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2294'></font>
      integer , intent(out) :: indfor(:,:) <a name='2295'>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2296'></font>
      real , intent(out) :: selffac(:,:) <a name='2297'>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2298'></font>
      real , intent(out) :: selffrac(:,:) <a name='2299'>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2300'></font>
      real , intent(out) :: forfac(:,:) <a name='2301'>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2302'></font>
      real , intent(out) :: forfrac(:,:) <a name='2303'>
                                                      <font color=#447700>!    Dimensions: (nlayers)<a name='2304'></font>
<a name='2305'>
      real , intent(out) :: fac00(:,:) , fac01(:,:) , fac10(:,:) , fac11(:,:)  <a name='2306'>
<a name='2307'>
<font color=#447700>! ----- Local -----<a name='2308'></font>
<a name='2309'>
      integer  :: indbound<a name='2310'>
      integer  :: indlev0<a name='2311'>
      integer  :: lay<a name='2312'>
      integer  :: jp1<a name='2313'>
      integer  :: iplon<a name='2314'>
<a name='2315'>
      real  :: stpfac<a name='2316'>
      real  :: tbndfrac<a name='2317'>
      real  :: t0frac<a name='2318'>
      real  :: plog<a name='2319'>
      real  :: fp<a name='2320'>
      real  :: ft<a name='2321'>
      real  :: ft1<a name='2322'>
      real  :: water<a name='2323'>
      real  :: scalefac<a name='2324'>
      real  :: factor<a name='2325'>
      real  :: co2reg<a name='2326'>
      real  :: compfp<a name='2327'>
<a name='2328'>
#ifndef _ACCEL<a name='2329'>
#  define ncol CHNK<a name='2330'>
#endif<a name='2331'>
<a name='2332'>
<a name='2333'>
<font color=#447700>! Initializations<a name='2334'></font>
      stpfac = 296. /1013. <a name='2335'>
<a name='2336'>
<a name='2337'>
<font color=#447700>!$acc kernels present(pavel, layswtch, laytrop, laylow)<a name='2338'></font>
      layswtch = 0<a name='2339'>
      laytrop = 0<a name='2340'>
      laylow = 0<a name='2341'>
      do iplon = 1, ncol<a name='2342'>
         do lay = 1, nlayers<a name='2343'>
            plog = log(pavel(iplon,lay) )<a name='2344'>
            if (plog .ge. 4.56) laytrop(iplon) = laytrop(iplon) + 1<a name='2345'>
            if (plog .ge. 6.62) laylow(iplon) = laylow(iplon) + 1<a name='2346'>
         end do<a name='2347'>
      end do<a name='2348'>
<font color=#447700>!$acc end kernels<a name='2349'></font>
<a name='2350'>
<a name='2351'>
<font color=#447700>!$acc kernels loop present(pavel, tavel, pz, tz, tbound) &amp;<a name='2352'></font>
<font color=#447700>!$acc present(coldry, wkl, jp, jt, jt1, colh2o, colco2) &amp;<a name='2353'></font>
<font color=#447700>!$acc present(colo3, coln2o, colch4, colo2, colmol, co2mult, indself) &amp;<a name='2354'></font>
<font color=#447700>!$acc present(indfor, selffac, selffrac, forfac, forfrac, fac00, fac01, fac10, fac11)<a name='2355'></font>
<a name='2356'>
<font color=#447700>! Begin column loop<a name='2357'></font>
      do iplon = 1, ncol<a name='2358'>
<a name='2359'>
      indbound = tbound(iplon) - 159. <a name='2360'>
      tbndfrac = tbound(iplon) - int(tbound(iplon))<a name='2361'>
      <a name='2362'>
      indlev0  = tz(iplon,0)  - 159. <a name='2363'>
      t0frac   = tz(iplon,0)  - int(tz(iplon,0) )<a name='2364'>
<a name='2365'>
<font color=#447700>! Begin layer loop<a name='2366'></font>
<a name='2367'>
       do lay = 1, nlayers<a name='2368'>
<font color=#447700>! Find the two reference pressures on either side of the<a name='2369'></font>
<font color=#447700>! layer pressure.  Store them in JP and JP1.  Store in FP the<a name='2370'></font>
<font color=#447700>! fraction of the difference (in ln(pressure)) between these<a name='2371'></font>
<font color=#447700>! two values that the layer pressure lies.<a name='2372'></font>
<a name='2373'>
         plog = log(pavel(iplon,lay) )<a name='2374'>
         jp(iplon,lay)  = int(36.  - 5*(plog+0.04 ))<a name='2375'>
         if (jp(iplon,lay)  .lt. 1) then<a name='2376'>
            jp(iplon,lay)  = 1<a name='2377'>
         elseif (jp(iplon,lay)  .gt. 58) then<a name='2378'>
            jp(iplon,lay)  = 58<a name='2379'>
         endif<a name='2380'>
         jp1 = jp(iplon,lay)  + 1<a name='2381'>
         fp = 5.  * (preflog(jp(iplon,lay) ) - plog)<a name='2382'>
<a name='2383'>
<font color=#447700>! Determine, for each reference pressure (JP and JP1), which<a name='2384'></font>
<font color=#447700>! reference temperature (these are different for each  <a name='2385'></font>
<font color=#447700>! reference pressure) is nearest the layer temperature but does<a name='2386'></font>
<font color=#447700>! not exceed it.  Store these indices in JT and JT1, resp.<a name='2387'></font>
<font color=#447700>! Store in FT (resp. FT1) the fraction of the way between JT<a name='2388'></font>
<font color=#447700>! (JT1) and the next highest reference temperature that the <a name='2389'></font>
<font color=#447700>! layer temperature falls.<a name='2390'></font>
<a name='2391'>
         jt(iplon,lay)  = int(3.  + (tavel(iplon,lay) -tref(jp(iplon,lay) ))/15. )<a name='2392'>
         if (jt(iplon,lay)  .lt. 1) then<a name='2393'>
            jt(iplon,lay)  = 1<a name='2394'>
         elseif (jt(iplon,lay)  .gt. 4) then<a name='2395'>
            jt(iplon,lay)  = 4<a name='2396'>
         endif<a name='2397'>
         ft = ((tavel(iplon,lay) -tref(jp(iplon,lay) ))/15. ) - float(jt(iplon,lay) -3)<a name='2398'>
         jt1(iplon,lay)  = int(3.  + (tavel(iplon,lay) -tref(jp1))/15. )<a name='2399'>
         if (jt1(iplon,lay)  .lt. 1) then<a name='2400'>
            jt1(iplon,lay)  = 1<a name='2401'>
         elseif (jt1(iplon,lay)  .gt. 4) then<a name='2402'>
            jt1(iplon,lay)  = 4<a name='2403'>
         endif<a name='2404'>
         ft1 = ((tavel(iplon,lay) -tref(jp1))/15. ) - float(jt1(iplon,lay) -3)<a name='2405'>
<a name='2406'>
         water = wkl(iplon,1,lay) /coldry(iplon,lay) <a name='2407'>
         scalefac = pavel(iplon,lay)  * stpfac / tavel(iplon,lay) <a name='2408'>
<a name='2409'>
<font color=#447700>! If the pressure is less than ~100mb, perform a different<a name='2410'></font>
<font color=#447700>! set of species interpolations.<a name='2411'></font>
<a name='2412'>
         if (plog .le. 4.56 ) then<a name='2413'>
<a name='2414'>
         forfac(iplon,lay)  = scalefac / (1.+water)<a name='2415'>
         factor = (tavel(iplon,lay) -188.0 )/36.0 <a name='2416'>
         indfor(iplon,lay)  = 3<a name='2417'>
         forfrac(iplon,lay)  = factor - 1.0 <a name='2418'>
<a name='2419'>
<font color=#447700>! Calculate needed column amounts.<a name='2420'></font>
<a name='2421'>
         colh2o(iplon,lay)  = 1.e-20  * wkl(iplon,1,lay) <a name='2422'>
         colco2(iplon,lay)  = 1.e-20  * wkl(iplon,2,lay) <a name='2423'>
         colo3(iplon,lay)   = 1.e-20  * wkl(iplon,3,lay) <a name='2424'>
         coln2o(iplon,lay)  = 1.e-20  * wkl(iplon,4,lay) <a name='2425'>
         colch4(iplon,lay)  = 1.e-20  * wkl(iplon,6,lay) <a name='2426'>
         colo2(iplon,lay)   = 1.e-20  * wkl(iplon,7,lay) <a name='2427'>
         colmol(iplon,lay)  = 1.e-20  * coldry(iplon,lay)  + colh2o(iplon,lay) <a name='2428'>
         if (colco2(iplon,lay)  .eq. 0. ) colco2(iplon,lay)  = 1.e-32  * coldry(iplon,lay) <a name='2429'>
         if (coln2o(iplon,lay)  .eq. 0. ) coln2o(iplon,lay)  = 1.e-32  * coldry(iplon,lay) <a name='2430'>
         if (colch4(iplon,lay)  .eq. 0. ) colch4(iplon,lay)  = 1.e-32  * coldry(iplon,lay) <a name='2431'>
         if (colo2(iplon,lay)   .eq. 0. ) colo2(iplon,lay)   = 1.e-32  * coldry(iplon,lay) <a name='2432'>
         co2reg = 3.55e-24  * coldry(iplon,lay) <a name='2433'>
         co2mult(iplon,lay) = (colco2(iplon,lay)  - co2reg) * &amp;<a name='2434'>
               272.63 *exp(-1919.4 /tavel(iplon,lay) )/(8.7604e-4 *tavel(iplon,lay) )<a name='2435'>
<a name='2436'>
         selffac(iplon,lay)  = 0. <a name='2437'>
         selffrac(iplon,lay) = 0. <a name='2438'>
         indself(iplon,lay)  = 0<a name='2439'>
<a name='2440'>
<a name='2441'>
         else<a name='2442'>
<a name='2443'>
<a name='2444'>
<font color=#447700>! Set up factors needed to separately include the water vapor<a name='2445'></font>
<font color=#447700>! foreign-continuum in the calculation of absorption coefficient.<a name='2446'></font>
<a name='2447'>
         forfac(iplon,lay)  = scalefac / (1.+water)<a name='2448'>
         factor = (332.0 -tavel(iplon,lay) )/36.0 <a name='2449'>
         indfor(iplon,lay)  = min(2, max(1, int(factor)))<a name='2450'>
         forfrac(iplon,lay)  = factor - float(indfor(iplon,lay) )<a name='2451'>
<a name='2452'>
<font color=#447700>! Set up factors needed to separately include the water vapor<a name='2453'></font>
<font color=#447700>! self-continuum in the calculation of absorption coefficient.<a name='2454'></font>
<a name='2455'>
         selffac(iplon,lay)  = water * forfac(iplon,lay) <a name='2456'>
         factor = (tavel(iplon,lay) -188.0 )/7.2 <a name='2457'>
         indself(iplon,lay)  = min(9, max(1, int(factor)-7))<a name='2458'>
         selffrac(iplon,lay)  = factor - float(indself(iplon,lay)  + 7)<a name='2459'>
<a name='2460'>
<font color=#447700>! Calculate needed column amounts.<a name='2461'></font>
<a name='2462'>
         colh2o(iplon,lay)  = 1.e-20  * wkl(iplon,1,lay) <a name='2463'>
         colco2(iplon,lay)  = 1.e-20  * wkl(iplon,2,lay) <a name='2464'>
         colo3(iplon,lay)  = 1.e-20  * wkl(iplon,3,lay) <a name='2465'>
<font color=#447700>!           colo3(lay) = 0. <a name='2466'></font>
<font color=#447700>!           colo3(lay) = colo3(lay)/1.16 <a name='2467'></font>
         coln2o(iplon,lay)  = 1.e-20  * wkl(iplon,4,lay) <a name='2468'>
         colch4(iplon,lay)  = 1.e-20  * wkl(iplon,6,lay) <a name='2469'>
         colo2(iplon,lay)  = 1.e-20  * wkl(iplon,7,lay) <a name='2470'>
         colmol(iplon,lay)  = 1.e-20  * coldry(iplon,lay)  + colh2o(iplon,lay) <a name='2471'>
<font color=#447700>!           colco2(lay) = 0. <a name='2472'></font>
<font color=#447700>!           colo3(lay) = 0. <a name='2473'></font>
<font color=#447700>!           coln2o(lay) = 0. <a name='2474'></font>
<font color=#447700>!           colch4(lay) = 0. <a name='2475'></font>
<font color=#447700>!           colo2(lay) = 0. <a name='2476'></font>
<font color=#447700>!           colmol(lay) = 0. <a name='2477'></font>
         if (colco2(iplon,lay)  .eq. 0. ) colco2(iplon,lay)  = 1.e-32  * coldry(iplon,lay) <a name='2478'>
         if (coln2o(iplon,lay)  .eq. 0. ) coln2o(iplon,lay)  = 1.e-32  * coldry(iplon,lay) <a name='2479'>
         if (colch4(iplon,lay)  .eq. 0. ) colch4(iplon,lay)  = 1.e-32  * coldry(iplon,lay) <a name='2480'>
         if (colo2(iplon,lay)  .eq. 0. ) colo2(iplon,lay)  = 1.e-32  * coldry(iplon,lay) <a name='2481'>
<font color=#447700>! Using E = 1334.2 cm-1.<a name='2482'></font>
         co2reg = 3.55e-24  * coldry(iplon,lay) <a name='2483'>
         co2mult(iplon,lay) = (colco2(iplon,lay)  - co2reg) * &amp;<a name='2484'>
               272.63 *exp(-1919.4 /tavel(iplon,lay) )/(8.7604e-4 *tavel(iplon,lay) )<a name='2485'>
      <a name='2486'>
         end if<a name='2487'>
<font color=#447700>! We have now isolated the layer ln pressure and temperature,<a name='2488'></font>
<font color=#447700>! between two reference pressures and two reference temperatures <a name='2489'></font>
<font color=#447700>! (for each reference pressure).  We multiply the pressure <a name='2490'></font>
<font color=#447700>! fraction FP with the appropriate temperature fractions to get <a name='2491'></font>
<font color=#447700>! the factors that will be needed for the interpolation that yields<a name='2492'></font>
<font color=#447700>! the optical depths (performed in routines TAUGBn for band n).<a name='2493'></font>
<a name='2494'>
         compfp = 1.  - fp<a name='2495'>
         fac10(iplon,lay)  = compfp * ft<a name='2496'>
         fac00(iplon,lay)  = compfp * (1.  - ft)<a name='2497'>
         fac11(iplon,lay)  = fp * ft1<a name='2498'>
         fac01(iplon,lay)  = fp * (1.  - ft1)<a name='2499'>
<a name='2500'>
<font color=#447700>! End layer loop<a name='2501'></font>
       end do<a name='2502'>
<a name='2503'>
<font color=#447700>! End column loop<a name='2504'></font>
      end do<a name='2505'>
<font color=#447700>!$acc end kernels<a name='2506'></font>
#ifndef _ACCEL<a name='2507'>
#  undef ncol<a name='2508'>
#endif<a name='2509'>
<a name='2510'>
end subroutine setcoef_sw<a name='2511'>
<a name='2512'>
<font color=#447700>!***************************************************************************<a name='2513'></font>
<A NAME='SWATMREF'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWATMREF' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2514'>
      <font color=#993300>subroutine </font><font color=#cc0000>swatmref</font> <A href='../../call_to/SWATMREF.html' TARGET='index'>2</A><a name='2515'>
<font color=#447700>!***************************************************************************<a name='2516'></font>
<a name='2517'>
      save<a name='2518'>
 <a name='2519'>
<font color=#447700>! These pressures are chosen such that the ln of the first pressure<a name='2520'></font>
<font color=#447700>! has only a few non-zero digits (i.e. ln(PREF(1)) = 6.96000) and<a name='2521'></font>
<font color=#447700>! each subsequent ln(pressure) differs from the previous one by 0.2.<a name='2522'></font>
<a name='2523'>
      pref(:) = (/ &amp;<a name='2524'>
          1.05363e+03 ,8.62642e+02 ,7.06272e+02 ,5.78246e+02 ,4.73428e+02 , &amp;<a name='2525'>
          3.87610e+02 ,3.17348e+02 ,2.59823e+02 ,2.12725e+02 ,1.74164e+02 , &amp;<a name='2526'>
          1.42594e+02 ,1.16746e+02 ,9.55835e+01 ,7.82571e+01 ,6.40715e+01 , &amp;<a name='2527'>
          5.24573e+01 ,4.29484e+01 ,3.51632e+01 ,2.87892e+01 ,2.35706e+01 , &amp;<a name='2528'>
          1.92980e+01 ,1.57998e+01 ,1.29358e+01 ,1.05910e+01 ,8.67114e+00 , &amp;<a name='2529'>
          7.09933e+00 ,5.81244e+00 ,4.75882e+00 ,3.89619e+00 ,3.18993e+00 , &amp;<a name='2530'>
          2.61170e+00 ,2.13828e+00 ,1.75067e+00 ,1.43333e+00 ,1.17351e+00 , &amp;<a name='2531'>
          9.60789e-01 ,7.86628e-01 ,6.44036e-01 ,5.27292e-01 ,4.31710e-01 , &amp;<a name='2532'>
          3.53455e-01 ,2.89384e-01 ,2.36928e-01 ,1.93980e-01 ,1.58817e-01 , &amp;<a name='2533'>
          1.30029e-01 ,1.06458e-01 ,8.71608e-02 ,7.13612e-02 ,5.84256e-02 , &amp;<a name='2534'>
          4.78349e-02 ,3.91639e-02 ,3.20647e-02 ,2.62523e-02 ,2.14936e-02 , &amp;<a name='2535'>
          1.75975e-02 ,1.44076e-02 ,1.17959e-02 ,9.65769e-03  /)<a name='2536'>
<a name='2537'>
      preflog(:) = (/ &amp;<a name='2538'>
           6.9600e+00 , 6.7600e+00 , 6.5600e+00 , 6.3600e+00 , 6.1600e+00 , &amp;<a name='2539'>
           5.9600e+00 , 5.7600e+00 , 5.5600e+00 , 5.3600e+00 , 5.1600e+00 , &amp;<a name='2540'>
           4.9600e+00 , 4.7600e+00 , 4.5600e+00 , 4.3600e+00 , 4.1600e+00 , &amp;<a name='2541'>
           3.9600e+00 , 3.7600e+00 , 3.5600e+00 , 3.3600e+00 , 3.1600e+00 , &amp;<a name='2542'>
           2.9600e+00 , 2.7600e+00 , 2.5600e+00 , 2.3600e+00 , 2.1600e+00 , &amp;<a name='2543'>
           1.9600e+00 , 1.7600e+00 , 1.5600e+00 , 1.3600e+00 , 1.1600e+00 , &amp;<a name='2544'>
           9.6000e-01 , 7.6000e-01 , 5.6000e-01 , 3.6000e-01 , 1.6000e-01 , &amp;<a name='2545'>
          -4.0000e-02 ,-2.4000e-01 ,-4.4000e-01 ,-6.4000e-01 ,-8.4000e-01 , &amp;<a name='2546'>
          -1.0400e+00 ,-1.2400e+00 ,-1.4400e+00 ,-1.6400e+00 ,-1.8400e+00 , &amp;<a name='2547'>
          -2.0400e+00 ,-2.2400e+00 ,-2.4400e+00 ,-2.6400e+00 ,-2.8400e+00 , &amp;<a name='2548'>
          -3.0400e+00 ,-3.2400e+00 ,-3.4400e+00 ,-3.6400e+00 ,-3.8400e+00 , &amp;<a name='2549'>
          -4.0400e+00 ,-4.2400e+00 ,-4.4400e+00 ,-4.6400e+00  /)<a name='2550'>
<a name='2551'>
<font color=#447700>! These are the temperatures associated with the respective <a name='2552'></font>
<font color=#447700>! pressures for the MLS standard atmosphere. <a name='2553'></font>
<a name='2554'>
      tref(:) = (/ &amp;<a name='2555'>
           2.9420e+02 , 2.8799e+02 , 2.7894e+02 , 2.6925e+02 , 2.5983e+02 , &amp;<a name='2556'>
           2.5017e+02 , 2.4077e+02 , 2.3179e+02 , 2.2306e+02 , 2.1578e+02 , &amp;<a name='2557'>
           2.1570e+02 , 2.1570e+02 , 2.1570e+02 , 2.1706e+02 , 2.1858e+02 , &amp;<a name='2558'>
           2.2018e+02 , 2.2174e+02 , 2.2328e+02 , 2.2479e+02 , 2.2655e+02 , &amp;<a name='2559'>
           2.2834e+02 , 2.3113e+02 , 2.3401e+02 , 2.3703e+02 , 2.4022e+02 , &amp;<a name='2560'>
           2.4371e+02 , 2.4726e+02 , 2.5085e+02 , 2.5457e+02 , 2.5832e+02 , &amp;<a name='2561'>
           2.6216e+02 , 2.6606e+02 , 2.6999e+02 , 2.7340e+02 , 2.7536e+02 , &amp;<a name='2562'>
           2.7568e+02 , 2.7372e+02 , 2.7163e+02 , 2.6955e+02 , 2.6593e+02 , &amp;<a name='2563'>
           2.6211e+02 , 2.5828e+02 , 2.5360e+02 , 2.4854e+02 , 2.4348e+02 , &amp; <a name='2564'>
           2.3809e+02 , 2.3206e+02 , 2.2603e+02 , 2.2000e+02 , 2.1435e+02 , &amp;<a name='2565'>
           2.0887e+02 , 2.0340e+02 , 1.9792e+02 , 1.9290e+02 , 1.8809e+02 , &amp;<a name='2566'>
           1.8329e+02 , 1.7849e+02 , 1.7394e+02 , 1.7212e+02  /)<a name='2567'>
<a name='2568'>
      end subroutine swatmref<a name='2569'>
<a name='2570'>
      end module rrtmg_sw_setcoef_f<a name='2571'>
<a name='2572'>
<A NAME='RRTMG_SW_TAUMOL_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_TAUMOL_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='2573'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_taumol_f</font> <A href='../../call_to/RRTMG_SW_TAUMOL_F.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_TAUMOL_F.html' TARGET='index'>3</A><a name='2574'>
<a name='2575'>
<font color=#447700>! ------- Modules -------<a name='2576'></font>
<a name='2577'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_CON_F'>rrsw_con_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_TAUMOL_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CON_F_2">, only: oneminus<a name='2578'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_WVN_F'>rrsw_wvn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_TAUMOL_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_F_3">, only: nspa, nspb<a name='2579'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_VSN_F'>rrsw_vsn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_TAUMOL_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_F_4">, only: hvrtau, hnamtau<a name='2580'>
<a name='2581'>
      implicit none<a name='2582'>
<a name='2583'>
      contains<a name='2584'>
<a name='2585'>
<font color=#447700>!----------------------------------------------------------------------------<a name='2586'></font>
<A NAME='TAUMOL_SW'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2587'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol_sw</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL_SW.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL_SW.html' TARGET='index'>28</A><a name='2588'>
                           colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2589'>
                           laytrop, jp, jt, jt1, &amp;<a name='2590'>
                           fac00, fac01, fac10, fac11, &amp;<a name='2591'>
                           selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2592'>
                           sfluxzen, taug, taur)<a name='2593'>
<font color=#447700>!----------------------------------------------------------------------------<a name='2594'></font>
<a name='2595'>
      integer , intent(in) :: ncol<a name='2596'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='2597'></font>
<a name='2598'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='2599'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='2600'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='2601'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='2602'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='2603'></font>
<a name='2604'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='2605'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='2606'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='2607'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='2608'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='2609'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='2610'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='2611'></font>
<a name='2612'>
      integer , intent(in) :: indself(:,:)     <a name='2613'>
      integer , intent(in) :: indfor(:,:) <a name='2614'>
      real , intent(in) :: selffac(:,:) <a name='2615'>
      real , intent(in) :: selffrac(:,:) <a name='2616'>
      real , intent(in) :: forfac(:,:) <a name='2617'>
      real , intent(in) :: forfrac(:,:) <a name='2618'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='2619'></font>
<a name='2620'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='2621'></font>
                       fac00(:,:) , fac01(:,:) , &amp;  <a name='2622'>
                       fac10(:,:) , fac11(:,:)  <a name='2623'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='2624'></font>
<a name='2625'>
<font color=#447700>! ----- Output -----<a name='2626'></font>
      real , intent(inout) gpu_device :: sfluxzen(:,:)   <font color=#447700>! solar source function<a name='2627'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='2628'></font>
      real , intent(inout) gpu_device :: taug(:,:,:)     <font color=#447700>! gaseous optical depth <a name='2629'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='2630'></font>
      real , intent(inout) gpu_device :: taur(:,:,:)     <font color=#447700>! Rayleigh <a name='2631'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='2632'></font>
<a name='2633'>
<font color=#447700>! Calculate gaseous optical depth and planck fractions for each spectral band.<a name='2634'></font>
<a name='2635'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL16'>taumol16</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL16_2">(ncol, nlayers, &amp;<a name='2636'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2637'>
                    laytrop, jp, jt, jt1, &amp;<a name='2638'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2639'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2640'>
                    sfluxzen, taug, taur)<a name='2641'>
<a name='2642'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL17'>taumol17</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL17_2">(ncol, nlayers, &amp;<a name='2643'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2644'>
                    laytrop, jp, jt, jt1, &amp;<a name='2645'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2646'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2647'>
                    sfluxzen, taug, taur)<a name='2648'>
<a name='2649'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL18'>taumol18</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL18_2">(ncol, nlayers, &amp;<a name='2650'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2651'>
                    laytrop, jp, jt, jt1, &amp;<a name='2652'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2653'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2654'>
                    sfluxzen, taug, taur)<a name='2655'>
<a name='2656'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL19'>taumol19</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL19_2">(ncol, nlayers, &amp;<a name='2657'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2658'>
                    laytrop, jp, jt, jt1, &amp;<a name='2659'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2660'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2661'>
                    sfluxzen, taug, taur)<a name='2662'>
<a name='2663'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL20'>taumol20</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL20_2">(ncol, nlayers, &amp;<a name='2664'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2665'>
                    laytrop, jp, jt, jt1, &amp;<a name='2666'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2667'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2668'>
                    sfluxzen, taug, taur)<a name='2669'>
<a name='2670'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL21'>taumol21</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL21_2">(ncol, nlayers, &amp;<a name='2671'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2672'>
                    laytrop, jp, jt, jt1, &amp;<a name='2673'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2674'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2675'>
                    sfluxzen, taug, taur)<a name='2676'>
<a name='2677'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL22'>taumol22</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL22_2">(ncol, nlayers, &amp;<a name='2678'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2679'>
                    laytrop, jp, jt, jt1, &amp;<a name='2680'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2681'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2682'>
                    sfluxzen, taug, taur)<a name='2683'>
<a name='2684'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL23'>taumol23</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL23_2">(ncol, nlayers, &amp;<a name='2685'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2686'>
                    laytrop, jp, jt, jt1, &amp;<a name='2687'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2688'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2689'>
                    sfluxzen, taug, taur)<a name='2690'>
<a name='2691'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL24'>taumol24</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL24_2">(ncol, nlayers, &amp;<a name='2692'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2693'>
                    laytrop, jp, jt, jt1, &amp;<a name='2694'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2695'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2696'>
                    sfluxzen, taug, taur)<a name='2697'>
<a name='2698'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL25'>taumol25</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL25_2">(ncol, nlayers, &amp;<a name='2699'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2700'>
                    laytrop, jp, jt, jt1, &amp;<a name='2701'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2702'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2703'>
                    sfluxzen, taug, taur)<a name='2704'>
<a name='2705'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL26'>taumol26</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL26_2">(ncol, nlayers, &amp;<a name='2706'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2707'>
                    laytrop, jp, jt, jt1, &amp;<a name='2708'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2709'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2710'>
                    sfluxzen, taug, taur)<a name='2711'>
<a name='2712'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL27'>taumol27</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL27_2">(ncol, nlayers, &amp;<a name='2713'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2714'>
                    laytrop, jp, jt, jt1, &amp;<a name='2715'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2716'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2717'>
                    sfluxzen, taug, taur)<a name='2718'>
<a name='2719'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL28'>taumol28</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL28_2">(ncol, nlayers, &amp;<a name='2720'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2721'>
                    laytrop, jp, jt, jt1, &amp;<a name='2722'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2723'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2724'>
                    sfluxzen, taug, taur)<a name='2725'>
<a name='2726'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL29'>taumol29</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL29_2">(ncol, nlayers, &amp;<a name='2727'>
                    colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2728'>
                    laytrop, jp, jt, jt1, &amp;<a name='2729'>
                    fac00, fac01, fac10, fac11, &amp;<a name='2730'>
                    selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2731'>
                    sfluxzen, taug, taur)<a name='2732'>
<a name='2733'>
      end subroutine<a name='2734'>
<a name='2735'>
<a name='2736'>
<font color=#447700>!----------------------------------------------------------------------------<a name='2737'></font>
<A NAME='TAUMOL16'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL16' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2738'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol16</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL16.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL16.html' TARGET='index'>4</A><a name='2739'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2740'>
                          laytrop, jp, jt, jt1, &amp;<a name='2741'>
                          fac00, fac01, fac10, fac11, &amp;<a name='2742'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2743'>
                          sfluxzen, taug, taur)<a name='2744'>
<font color=#447700>!----------------------------------------------------------------------------<a name='2745'></font>
<font color=#447700>!<a name='2746'></font>
<font color=#447700>!     band 16:  2600-3250 cm-1 (low - h2o,ch4; high - ch4)<a name='2747'></font>
<font color=#447700>!<a name='2748'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='2749'></font>
<a name='2750'>
<font color=#447700>! ------- Modules -------<a name='2751'></font>
<a name='2752'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_20">, only : ng16<a name='2753'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG16_F'>rrsw_kg16_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG16_F_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='2754'>
                            sfluxref, rayl, layreffr, strrat1<a name='2755'>
<font color=#447700>!                            sfluxref, rayl<a name='2756'></font>
<a name='2757'>
<font color=#447700>! ------- Declarations -------<a name='2758'></font>
      integer , intent(in) :: ncol<a name='2759'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='2760'></font>
<a name='2761'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='2762'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='2763'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='2764'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='2765'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='2766'></font>
<a name='2767'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='2768'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='2769'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='2770'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='2771'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='2772'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='2773'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='2774'></font>
<a name='2775'>
      integer , intent(in) :: indself(:,:)     <a name='2776'>
      integer , intent(in) :: indfor(:,:) <a name='2777'>
      real , intent(in) :: selffac(:,:) <a name='2778'>
      real , intent(in) :: selffrac(:,:) <a name='2779'>
      real , intent(in) :: forfac(:,:) <a name='2780'>
      real , intent(in) :: forfrac(:,:) <a name='2781'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='2782'></font>
<a name='2783'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='2784'></font>
                       fac00(:,:) , fac01(:,:) , &amp; <a name='2785'>
                       fac10(:,:) , fac11(:,:)  <a name='2786'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='2787'></font>
<a name='2788'>
<font color=#447700>! ----- Output -----<a name='2789'></font>
      real, intent(inout) gpu_device :: sfluxzen(:,:)    <font color=#447700>! solar source function<a name='2790'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='2791'></font>
      real, intent(inout) gpu_device :: taug(:,:,:)             <font color=#447700>! gaseous optical depth <a name='2792'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='2793'></font>
      real, intent(inout) gpu_device :: taur(:,:,:)             <font color=#447700>! Rayleigh <a name='2794'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='2795'></font>
<a name='2796'>
<font color=#447700>! Local<a name='2797'></font>
#ifdef _ACCEL<a name='2798'>
# define IKLOOP1_S do iplon=1,ncol;do lay=1,nlayers<a name='2799'>
# define IKLOOP1_E enddo;enddo<a name='2800'>
# define IKLOOP2_S do iplon=1,ncol;laysolfr=nlayers;do lay=laytrop(iplon)+1,nlayers;if(jp(iplon,lay-1).lt.layreffr.and.jp(iplon,lay).ge.layreffr)laysolfr=lay<a name='2801'>
# define IKLOOP2_E<a name='2802'>
#else<a name='2803'>
# define ncol CHNK<a name='2804'>
# define IKLOOP1_S do lay = 1, nlayers ; do iplon = 1, ncol<a name='2805'>
# define IKLOOP1_E enddo;enddo<a name='2806'>
# define IKLOOP2_S do lay=2,nlayers;do iplon=1,ncol;if(lay&gt;laytrop(iplon))then;laysolfr=nlayers<a name='2807'>
# define IKLOOP2_E endif;enddo;enddo<a name='2808'>
#endif<a name='2809'>
<a name='2810'>
<a name='2811'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='2812'>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='2813'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='2814'>
                       tauray<a name='2815'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='2816'></font>
<font color=#447700>!                          layreffr<a name='2817'></font>
<font color=#447700>!      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='2818'></font>
<font color=#447700>!                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='2819'></font>
<font color=#447700>!                       tauray, strrat1<a name='2820'></font>
      integer :: iplon<a name='2821'>
<font color=#447700>!      strrat1 = 252.131 <a name='2822'></font>
<font color=#447700>!      layreffr = 18<a name='2823'></font>
<font color=#447700>!$acc kernels <a name='2824'></font>
#ifdef _ACCEL<a name='2825'>
      do iplon=1,ncol<a name='2826'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure),<a name='2827'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='2828'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.<a name='2829'></font>
<a name='2830'>
<font color=#447700>! Lower atmosphere loop<a name='2831'></font>
      do lay = 1, nlayers<a name='2832'>
#else<a name='2833'>
IKLOOP1_S<a name='2834'>
#endif<a name='2835'>
         if (lay &lt;= laytrop(iplon)) then<a name='2836'>
         speccomb = colh2o(iplon,lay)  + strrat1*colch4(iplon,lay)<a name='2837'>
         specparm = colh2o(iplon,lay) /speccomb<a name='2838'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='2839'>
         specmult = 8. *(specparm)<a name='2840'>
         js = 1 + int(specmult)<a name='2841'>
         fs = mod(specmult, 1.  )<a name='2842'>
         fac000 = (1.  - fs) * fac00(iplon,lay)<a name='2843'>
         fac010 = (1.  - fs) * fac10(iplon,lay)<a name='2844'>
         fac100 = fs * fac00(iplon,lay)<a name='2845'>
         fac110 = fs * fac10(iplon,lay)<a name='2846'>
         fac001 = (1.  - fs) * fac01(iplon,lay)<a name='2847'>
         fac011 = (1.  - fs) * fac11(iplon,lay)<a name='2848'>
         fac101 = fs * fac01(iplon,lay)<a name='2849'>
         fac111 = fs * fac11(iplon,lay)<a name='2850'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(16) + js<a name='2851'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(16) + js<a name='2852'>
         inds = indself(iplon,lay)<a name='2853'>
         indf = indfor(iplon,lay)<a name='2854'>
         tauray = colmol(iplon,lay)  * rayl<a name='2855'>
<a name='2856'>
         do ig = 1, ng16<a name='2857'>
            taug(iplon,lay,ig)  = speccomb * &amp;<a name='2858'>
                (fac000 * absa(ind0   ,ig) + &amp;<a name='2859'>
                 fac100 * absa(ind0 +1,ig) + &amp;<a name='2860'>
                 fac010 * absa(ind0 +9,ig) + &amp;<a name='2861'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='2862'>
                 fac001 * absa(ind1   ,ig) + &amp;<a name='2863'>
                 fac101 * absa(ind1 +1,ig) + &amp;<a name='2864'>
                 fac011 * absa(ind1 +9,ig) + &amp;<a name='2865'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='2866'>
                 colh2o(iplon,lay)  * &amp;<a name='2867'>
                 (selffac(iplon,lay)  * (selfref(inds,ig) + &amp;<a name='2868'>
                 selffrac(iplon,lay)  * &amp;<a name='2869'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='2870'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp;<a name='2871'>
                 forfrac(iplon,lay)  * &amp;<a name='2872'>
                 (forref(indf+1,ig) - forref(indf,ig)))) <a name='2873'>
<font color=#447700>!            ssa(lay,ig) = tauray/taug(lay,ig)<a name='2874'></font>
            taur(iplon,lay,ig)  = tauray<a name='2875'>
         enddo<a name='2876'>
         end if<a name='2877'>
#ifdef _ACCEL<a name='2878'>
      enddo<a name='2879'>
      enddo<a name='2880'>
<font color=#447700>!$acc end kernels<a name='2881'></font>
<a name='2882'>
<font color=#447700>! Upper atmosphere loop<a name='2883'></font>
<font color=#447700>!$acc kernels <a name='2884'></font>
      do iplon=1,ncol<a name='2885'>
        laysolfr = nlayers<a name='2886'>
<font color=#447700>! mji - fix for out of bounds issue on absb - added to pass bounds checking; FINAL<a name='2887'></font>
      do lay = laytrop(iplon)+1, nlayers<a name='2888'>
<font color=#447700>!        if (lay &gt; laytrop(iplon)) then<a name='2889'></font>
<font color=#447700>!          !do lay = laytrop(iplon) +1, nlayers<a name='2890'></font>
         if (jp(iplon,lay-1)  .lt. layreffr .and. jp(iplon,lay)  .ge.  layreffr) then<a name='2891'>
            laysolfr = lay<a name='2892'>
         end if<a name='2893'>
#else<a name='2894'>
IKLOOP1_E<a name='2895'>
IKLOOP2_S<a name='2896'>
#endif<a name='2897'>
<a name='2898'>
<font color=#447700>!#ifdef _ACCEL<a name='2899'></font>
<font color=#447700>!      do iplon=1,ncol<a name='2900'></font>
<font color=#447700>!        laysolfr = nlayers<a name='2901'></font>
<font color=#447700>!! mji - fix for out of bounds issue on absb - added to pass bounds checking; FINAL<a name='2902'></font>
<font color=#447700>!      do lay = laytrop(iplon)+1, nlayers<a name='2903'></font>
<font color=#447700>!!        if (lay &gt; laytrop(iplon)) then<a name='2904'></font>
<font color=#447700>!!          !do lay = laytrop(iplon) +1, nlayers<a name='2905'></font>
<font color=#447700>!         if (jp(iplon,lay-1)  .lt. layreffr .and. jp(iplon,lay)  .ge. layreffr) then<a name='2906'></font>
<font color=#447700>!            laysolfr = lay<a name='2907'></font>
<font color=#447700>!         end if<a name='2908'></font>
<font color=#447700>!#else<a name='2909'></font>
<font color=#447700>!      do lay = minval(laytrop(1:ncol)),nlayers<a name='2910'></font>
<font color=#447700>!       do iplon=1,ncol<a name='2911'></font>
<font color=#447700>!        if (lay &gt; laytrop(iplon)) then<a name='2912'></font>
<font color=#447700>!         laysolfr = nlayers<a name='2913'></font>
<font color=#447700>!<a name='2914'></font>
<font color=#447700>!#endif<a name='2915'></font>
         ind0 = ((jp(iplon,lay) -13)*5+(jt(iplon,lay) -1))*nspb(16) + 1<a name='2916'>
         ind1 = ((jp(iplon,lay) -12)*5+(jt1(iplon,lay) -1))*nspb(16) + 1<a name='2917'>
         tauray = colmol(iplon,lay)  * rayl<a name='2918'>
<a name='2919'>
         do ig = 1, ng16<a name='2920'>
            taug(iplon,lay,ig)  = colch4(iplon,lay)  * &amp;<a name='2921'>
                (fac00(iplon,lay)  * absb(ind0  ,ig) + &amp;<a name='2922'>
                 fac10(iplon,lay)  * absb(ind0+1,ig) + &amp;<a name='2923'>
                 fac01(iplon,lay)  * absb(ind1  ,ig) + &amp;<a name='2924'>
                 fac11(iplon,lay)  * absb(ind1+1,ig)) <a name='2925'>
<a name='2926'>
            if (laysolfr == lay) sfluxzen(iplon,ig)  = sfluxref(ig) <a name='2927'>
            taur(iplon,lay,ig)  = tauray  <a name='2928'>
         enddo<a name='2929'>
#ifdef _ACCEL<a name='2930'>
         enddo<a name='2931'>
         enddo<a name='2932'>
#else<a name='2933'>
IKLOOP2_E<a name='2934'>
#endif<a name='2935'>
<font color=#447700>!$acc end kernels<a name='2936'></font>
# undef ncol<a name='2937'>
 end subroutine taumol16<a name='2938'>
<a name='2939'>
<font color=#447700>!----------------------------------------------------------------------------<a name='2940'></font>
<A NAME='TAUMOL17'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL17' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2941'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol17</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL17.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL17.html' TARGET='index'>4</A><a name='2942'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='2943'>
                          laytrop, jp, jt, jt1, &amp;<a name='2944'>
                          fac00, fac01, fac10, fac11, &amp;<a name='2945'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='2946'>
                          sfluxzen, taug, taur)<a name='2947'>
<font color=#447700>!----------------------------------------------------------------------------<a name='2948'></font>
<font color=#447700>!<a name='2949'></font>
<font color=#447700>!     band 17:  3250-4000 cm-1 (low - h2o,co2; high - h2o,co2)<a name='2950'></font>
<font color=#447700>!<a name='2951'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='2952'></font>
<a name='2953'>
<font color=#447700>! ------- Modules -------<a name='2954'></font>
<a name='2955'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_21">, only : ng17, ngs16<a name='2956'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG17_F'>rrsw_kg17_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG17_F_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='2957'>
                            sfluxref, rayl, layreffr, strrat<a name='2958'>
<font color=#447700>!      use rrsw_kg17_f, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='2959'></font>
<font color=#447700>!                            sfluxref, rayl<a name='2960'></font>
<a name='2961'>
<font color=#447700>! ------- Declarations -------<a name='2962'></font>
      integer , intent(in) :: ncol<a name='2963'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='2964'></font>
<a name='2965'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='2966'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='2967'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='2968'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='2969'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='2970'></font>
<a name='2971'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='2972'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='2973'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='2974'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='2975'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='2976'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='2977'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='2978'></font>
<a name='2979'>
      integer , intent(in) :: indself(:,:)     <a name='2980'>
      integer , intent(in) :: indfor(:,:) <a name='2981'>
      real , intent(in) :: selffac(:,:) <a name='2982'>
      real , intent(in) :: selffrac(:,:) <a name='2983'>
      real , intent(in) :: forfac(:,:) <a name='2984'>
      real , intent(in) :: forfrac(:,:) <a name='2985'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='2986'></font>
<a name='2987'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='2988'></font>
                       fac00(:,:) , fac01(:,:) , &amp;<a name='2989'>
                       fac10(:,:) , fac11(:,:)  <a name='2990'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='2991'></font>
<a name='2992'>
<font color=#447700>! ----- Output -----<a name='2993'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='2994'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='2995'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='2996'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='2997'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='2998'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='2999'></font>
<a name='3000'>
<font color=#447700>! Local<a name='3001'></font>
#ifndef _ACCEL<a name='3002'>
# define ncol CHNK<a name='3003'>
#endif<a name='3004'>
<a name='3005'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3006'>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3007'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3008'>
                       tauray<a name='3009'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='3010'></font>
<font color=#447700>!                          layreffr<a name='3011'></font>
<font color=#447700>!      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3012'></font>
<font color=#447700>!                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3013'></font>
<font color=#447700>!                       tauray, strrat<a name='3014'></font>
      integer :: iplon<a name='3015'>
<a name='3016'>
<font color=#447700>!      layreffr = 30<a name='3017'></font>
<font color=#447700>!      strrat = 0.364641 <a name='3018'></font>
    <a name='3019'>
#ifdef _ACCEL<a name='3020'>
<font color=#447700>!$acc kernels loop<a name='3021'></font>
      do iplon=1,ncol<a name='3022'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='3023'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='3024'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='3025'></font>
<a name='3026'>
<font color=#447700>! Lower atmosphere loop<a name='3027'></font>
<font color=#447700>!$acc loop private(js, fs)<a name='3028'></font>
      do lay = 1, nlayers <a name='3029'>
#else<a name='3030'>
IKLOOP1_S<a name='3031'>
#endif<a name='3032'>
        if (lay &lt;= laytrop(iplon)) then<a name='3033'>
          <font color=#447700>!do lay = 1, laytrop(iplon) <a name='3034'></font>
         speccomb = colh2o(iplon,lay)  + strrat*colco2(iplon,lay) <a name='3035'>
         specparm = colh2o(iplon,lay) /speccomb <a name='3036'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3037'>
         specmult = 8. *(specparm)<a name='3038'>
         js = 1 + int(specmult)<a name='3039'>
         fs = mod(specmult, 1.  )<a name='3040'>
         fac000 = (1.  - fs) * fac00(iplon,lay) <a name='3041'>
         fac010 = (1.  - fs) * fac10(iplon,lay) <a name='3042'>
         fac100 = fs * fac00(iplon,lay) <a name='3043'>
         fac110 = fs * fac10(iplon,lay) <a name='3044'>
         fac001 = (1.  - fs) * fac01(iplon,lay) <a name='3045'>
         fac011 = (1.  - fs) * fac11(iplon,lay) <a name='3046'>
         fac101 = fs * fac01(iplon,lay) <a name='3047'>
         fac111 = fs * fac11(iplon,lay) <a name='3048'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(17) + js<a name='3049'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(17) + js<a name='3050'>
         inds = indself(iplon,lay) <a name='3051'>
         indf = indfor(iplon,lay) <a name='3052'>
         tauray = colmol(iplon,lay)  * rayl<a name='3053'>
<a name='3054'>
         do ig = 1, ng17<a name='3055'>
            taug(iplon,lay,ngs16+ig)  = speccomb * &amp;<a name='3056'>
                (fac000 * absa(ind0,ig) + &amp;<a name='3057'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='3058'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='3059'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='3060'>
                 fac001 * absa(ind1,ig) + &amp;<a name='3061'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='3062'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='3063'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='3064'>
                 colh2o(iplon,lay)  * &amp;<a name='3065'>
                 (selffac(iplon,lay)  * (selfref(inds,ig) + &amp;<a name='3066'>
                 selffrac(iplon,lay)  * &amp;<a name='3067'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='3068'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp;<a name='3069'>
                 forfrac(iplon,lay)  * &amp;<a name='3070'>
                 (forref(indf+1,ig) - forref(indf,ig)))) <a name='3071'>
            taur(iplon,lay,ngs16+ig)  = tauray<a name='3072'>
         enddo<a name='3073'>
<a name='3074'>
         else<a name='3075'>
         <a name='3076'>
        <a name='3077'>
         speccomb = colh2o(iplon,lay)  + strrat*colco2(iplon,lay) <a name='3078'>
         specparm = colh2o(iplon,lay) /speccomb <a name='3079'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3080'>
         specmult = 4. *(specparm)<a name='3081'>
         js = 1 + int(specmult)<a name='3082'>
         fs = mod(specmult, 1.  )<a name='3083'>
         fac000 = (1.  - fs) * fac00(iplon,lay) <a name='3084'>
         fac010 = (1.  - fs) * fac10(iplon,lay) <a name='3085'>
         fac100 = fs * fac00(iplon,lay) <a name='3086'>
         fac110 = fs * fac10(iplon,lay) <a name='3087'>
         fac001 = (1.  - fs) * fac01(iplon,lay) <a name='3088'>
         fac011 = (1.  - fs) * fac11(iplon,lay) <a name='3089'>
         fac101 = fs * fac01(iplon,lay) <a name='3090'>
         fac111 = fs * fac11(iplon,lay) <a name='3091'>
         ind0 = ((jp(iplon,lay) -13)*5+(jt(iplon,lay) -1))*nspb(17) + js<a name='3092'>
         ind1 = ((jp(iplon,lay) -12)*5+(jt1(iplon,lay) -1))*nspb(17) + js<a name='3093'>
         indf = indfor(iplon,lay) <a name='3094'>
         tauray = colmol(iplon,lay)  * rayl<a name='3095'>
<a name='3096'>
         do ig = 1, ng17<a name='3097'>
            taug(iplon,lay,ngs16+ig)  = speccomb * &amp;<a name='3098'>
                (fac000 * absb(ind0,ig) + &amp;<a name='3099'>
                 fac100 * absb(ind0+1,ig) + &amp;<a name='3100'>
                 fac010 * absb(ind0+5,ig) + &amp;<a name='3101'>
                 fac110 * absb(ind0+6,ig) + &amp;<a name='3102'>
                 fac001 * absb(ind1,ig) + &amp;<a name='3103'>
                 fac101 * absb(ind1+1,ig) + &amp;<a name='3104'>
                 fac011 * absb(ind1+5,ig) + &amp;<a name='3105'>
                 fac111 * absb(ind1+6,ig)) + &amp;<a name='3106'>
                 colh2o(iplon,lay)  * &amp;<a name='3107'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp;<a name='3108'>
                 forfrac(iplon,lay)  * &amp;<a name='3109'>
                 (forref(indf+1,ig) - forref(indf,ig))) <a name='3110'>
<font color=#447700>!            ssa(lay,ngs16+ig) = tauray/taug(lay,ngs16+ig)<a name='3111'></font>
           <a name='3112'>
            taur(iplon,lay,ngs16+ig)  = tauray<a name='3113'>
         enddo<a name='3114'>
        endif<a name='3115'>
      enddo<a name='3116'>
      enddo<a name='3117'>
<font color=#447700>!$acc end kernels<a name='3118'></font>
<a name='3119'>
<font color=#447700>!$acc kernels<a name='3120'></font>
#ifdef _ACCEL<a name='3121'>
      do iplon = 1, ncol<a name='3122'>
<font color=#447700>! Upper atmosphere loop<a name='3123'></font>
        laysolfr = nlayers<a name='3124'>
      do lay = 2, nlayers<a name='3125'>
        if (lay &gt; laytrop(iplon)) then<a name='3126'>
#else<a name='3127'>
IKLOOP2_S<a name='3128'>
#endif<a name='3129'>
          <a name='3130'>
        if ((jp(iplon,lay-1)  .lt. layreffr) .and. (jp(iplon,lay)  .ge. layreffr)) then<a name='3131'>
            laysolfr = lay<a name='3132'>
        end if<a name='3133'>
          <a name='3134'>
        if (lay == laysolfr) then<a name='3135'>
              <a name='3136'>
          speccomb = colh2o(iplon,lay)  + strrat*colco2(iplon,lay) <a name='3137'>
          specparm = colh2o(iplon,lay) /speccomb <a name='3138'>
          if (specparm .ge. oneminus) specparm = oneminus<a name='3139'>
          specmult = 4. *(specparm)<a name='3140'>
          js = 1 + int(specmult)<a name='3141'>
          fs = mod(specmult, 1.  )<a name='3142'>
          do ig = 1, ng17 <a name='3143'>
            sfluxzen(iplon,ngs16+ig)  = sfluxref(ig,js) &amp;<a name='3144'>
               + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='3145'>
          end do<a name='3146'>
        end if<a name='3147'>
#ifdef _ACCEL<a name='3148'>
        end if<a name='3149'>
      enddo<a name='3150'>
      enddo<a name='3151'>
#else<a name='3152'>
IKLOOP2_E<a name='3153'>
#endif<a name='3154'>
<font color=#447700>!$acc end kernels      <a name='3155'></font>
# undef ncol<a name='3156'>
      end subroutine taumol17<a name='3157'>
<a name='3158'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3159'></font>
<A NAME='TAUMOL18'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL18' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3160'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol18</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL18.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL18.html' TARGET='index'>4</A><a name='3161'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='3162'>
                          laytrop, jp, jt, jt1, &amp;<a name='3163'>
                          fac00, fac01, fac10, fac11, &amp;<a name='3164'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='3165'>
                          sfluxzen, taug, taur)<a name='3166'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3167'></font>
<font color=#447700>!<a name='3168'></font>
<font color=#447700>!     band 18:  4000-4650 cm-1 (low - h2o,ch4; high - ch4)<a name='3169'></font>
<font color=#447700>!<a name='3170'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3171'></font>
<a name='3172'>
<font color=#447700>! ------- Modules -------<a name='3173'></font>
<a name='3174'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_22">, only : ng18, ngs17<a name='3175'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG18_F'>rrsw_kg18_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG18_F_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3176'>
                            sfluxref, rayl, layreffr, strrat<a name='3177'>
<font color=#447700>!      use rrsw_kg18_f, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3178'></font>
<font color=#447700>!                            sfluxref, rayl<a name='3179'></font>
<a name='3180'>
<font color=#447700>! ------- Declarations -------<a name='3181'></font>
      integer , intent(in) :: ncol<a name='3182'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='3183'></font>
<a name='3184'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='3185'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='3186'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='3187'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='3188'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3189'></font>
<a name='3190'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='3191'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='3192'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='3193'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='3194'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='3195'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='3196'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3197'></font>
<a name='3198'>
      integer , intent(in) :: indself(:,:)     <a name='3199'>
      integer , intent(in) :: indfor(:,:) <a name='3200'>
      real , intent(in) :: selffac(:,:) <a name='3201'>
      real , intent(in) :: selffrac(:,:) <a name='3202'>
      real , intent(in) :: forfac(:,:) <a name='3203'>
      real , intent(in) :: forfrac(:,:) <a name='3204'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3205'></font>
<a name='3206'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='3207'></font>
                       fac00(:,:) , fac01(:,:) , &amp; <a name='3208'>
                       fac10(:,:) , fac11(:,:)  <a name='3209'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3210'></font>
<a name='3211'>
<font color=#447700>! ----- Output -----<a name='3212'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='3213'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='3214'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='3215'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='3216'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='3217'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='3218'></font>
<a name='3219'>
<font color=#447700>! Local<a name='3220'></font>
#ifndef _ACCEL<a name='3221'>
# define ncol CHNK<a name='3222'>
#endif<a name='3223'>
<a name='3224'>
#ifdef _ACCEL<a name='3225'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3226'>
#else<a name='3227'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr(ncol)<a name='3228'>
#endif<a name='3229'>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3230'>
                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3231'>
                       tauray<a name='3232'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='3233'></font>
<font color=#447700>!                          layreffr<a name='3234'></font>
<font color=#447700>!      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3235'></font>
<font color=#447700>!                       fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3236'></font>
<font color=#447700>!                       tauray, strrat<a name='3237'></font>
      integer :: iplon<a name='3238'>
<a name='3239'>
    <a name='3240'>
<font color=#447700>!      strrat = 38.9589 <a name='3241'></font>
<font color=#447700>!      layreffr = 6<a name='3242'></font>
<font color=#447700>!$acc kernels      <a name='3243'></font>
<a name='3244'>
#ifdef _ACCEL<a name='3245'>
      do iplon = 1, ncol<a name='3246'>
          laysolfr = laytrop(iplon)<a name='3247'>
          do lay = 1, laytrop(iplon)<a name='3248'>
#else<a name='3249'>
      laysolfr = laytrop<a name='3250'>
#define laysolfr LAYSOLFR(iplon)<a name='3251'>
      do lay = 1, nlayers<a name='3252'>
        do iplon = 1, ncol<a name='3253'>
          if (lay &lt;= laytrop(iplon)) then<a name='3254'>
#endif<a name='3255'>
              speccomb = colh2o(iplon,lay)  + strrat*colch4(iplon,lay) <a name='3256'>
              specparm = colh2o(iplon,lay) /speccomb <a name='3257'>
              if (specparm .ge. oneminus) specparm = oneminus<a name='3258'>
              specmult = 8. *(specparm)<a name='3259'>
              js = 1 + int(specmult)<a name='3260'>
              fs = mod(specmult, 1.  )<a name='3261'>
              if (jp(iplon,lay)  .lt. layreffr .and. jp(iplon,lay+1)  .ge. layreffr) &amp;<a name='3262'>
              laysolfr = min(lay+1,laytrop(iplon) )<a name='3263'>
              do ig = 1, ng18<a name='3264'>
                if (lay .eq. laysolfr) sfluxzen(iplon,ngs17+ig)  = sfluxref(ig,js) &amp;<a name='3265'>
                  + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='3266'>
              end do<a name='3267'>
#ifdef _ACCEL<a name='3268'>
#else<a name='3269'>
# undef laysolfr<a name='3270'>
         endif<a name='3271'>
#endif<a name='3272'>
          end do<a name='3273'>
      end do<a name='3274'>
<font color=#447700>!$acc end kernels<a name='3275'></font>
      <a name='3276'>
<font color=#447700>!$acc kernels <a name='3277'></font>
IKLOOP1_S<a name='3278'>
        if (lay &lt;= laytrop(iplon)) then<a name='3279'>
          <font color=#447700>!do lay = 1, laytrop(iplon) <a name='3280'></font>
       <a name='3281'>
         speccomb = colh2o(iplon,lay)  + strrat*colch4(iplon,lay) <a name='3282'>
         specparm = colh2o(iplon,lay) /speccomb <a name='3283'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3284'>
         specmult = 8. *(specparm)<a name='3285'>
         js = 1 + int(specmult)<a name='3286'>
         fs = mod(specmult, 1.  )<a name='3287'>
         fac000 = (1.  - fs) * fac00(iplon,lay) <a name='3288'>
         fac010 = (1.  - fs) * fac10(iplon,lay) <a name='3289'>
         fac100 = fs * fac00(iplon,lay) <a name='3290'>
         fac110 = fs * fac10(iplon,lay) <a name='3291'>
         fac001 = (1.  - fs) * fac01(iplon,lay) <a name='3292'>
         fac011 = (1.  - fs) * fac11(iplon,lay) <a name='3293'>
         fac101 = fs * fac01(iplon,lay) <a name='3294'>
         fac111 = fs * fac11(iplon,lay) <a name='3295'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(18) + js<a name='3296'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(18) + js<a name='3297'>
         inds = indself(iplon,lay) <a name='3298'>
         indf = indfor(iplon,lay) <a name='3299'>
         tauray = colmol(iplon,lay)  * rayl<a name='3300'>
<a name='3301'>
         do ig = 1, ng18<a name='3302'>
            taug(iplon,lay,ngs17+ig)  = speccomb * &amp;<a name='3303'>
                (fac000 * absa(ind0,ig) + &amp;<a name='3304'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='3305'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='3306'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='3307'>
                 fac001 * absa(ind1,ig) + &amp;<a name='3308'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='3309'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='3310'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='3311'>
                 colh2o(iplon,lay)  * &amp;<a name='3312'>
                 (selffac(iplon,lay)  * (selfref(inds,ig) + &amp;<a name='3313'>
                 selffrac(iplon,lay)  * &amp;<a name='3314'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='3315'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp;<a name='3316'>
                 forfrac(iplon,lay)  * &amp;<a name='3317'>
                 (forref(indf+1,ig) - forref(indf,ig)))) <a name='3318'>
<font color=#447700>!            ssa(lay,ngs17+ig) = tauray/taug(lay,ngs17+ig)<a name='3319'></font>
        <a name='3320'>
            taur(iplon,lay,ngs17+ig)  = tauray<a name='3321'>
         enddo<a name='3322'>
      <a name='3323'>
        else<a name='3324'>
<a name='3325'>
<font color=#447700>! Upper atmosphere loop<a name='3326'></font>
              <a name='3327'>
<font color=#447700>!do lay = laytrop(iplon) +1, nlayers<a name='3328'></font>
         ind0 = ((jp(iplon,lay) -13)*5+(jt(iplon,lay) -1))*nspb(18) + 1<a name='3329'>
         ind1 = ((jp(iplon,lay) -12)*5+(jt1(iplon,lay) -1))*nspb(18) + 1<a name='3330'>
         tauray = colmol(iplon,lay)  * rayl<a name='3331'>
<a name='3332'>
         do ig = 1, ng18<a name='3333'>
            taug(iplon,lay,ngs17+ig)  = colch4(iplon,lay)  * &amp;<a name='3334'>
                (fac00(iplon,lay)  * absb(ind0,ig) + &amp;<a name='3335'>
                 fac10(iplon,lay)  * absb(ind0+1,ig) + &amp;<a name='3336'>
                 fac01(iplon,lay)  * absb(ind1,ig) + &amp;	  <a name='3337'>
                 fac11(iplon,lay)  * absb(ind1+1,ig)) <a name='3338'>
<font color=#447700>!           ssa(lay,ngs17+ig) = tauray/taug(lay,ngs17+ig)<a name='3339'></font>
           taur(iplon,lay,ngs17+ig)  = tauray<a name='3340'>
         enddo<a name='3341'>
        end if<a name='3342'>
IKLOOP1_E       <a name='3343'>
<a name='3344'>
<font color=#447700>!$acc end kernels<a name='3345'></font>
# undef ncol<a name='3346'>
      end subroutine taumol18<a name='3347'>
<a name='3348'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3349'></font>
<A NAME='TAUMOL19'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL19' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3350'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol19</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL19.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL19.html' TARGET='index'>4</A><a name='3351'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='3352'>
                          laytrop, jp, jt, jt1, &amp;<a name='3353'>
                          fac00, fac01, fac10, fac11, &amp;<a name='3354'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='3355'>
                          sfluxzen, taug, taur)<a name='3356'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3357'></font>
<font color=#447700>!<a name='3358'></font>
<font color=#447700>!     band 19:  4650-5150 cm-1 (low - h2o,co2; high - co2)<a name='3359'></font>
<font color=#447700>!<a name='3360'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3361'></font>
<a name='3362'>
<font color=#447700>! ------- Modules -------<a name='3363'></font>
<a name='3364'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_23">, only : ng19, ngs18<a name='3365'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG19_F'>rrsw_kg19_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG19_F_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3366'>
                            sfluxref, rayl, layreffr, strrat<a name='3367'>
<font color=#447700>!      use rrsw_kg19_f, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3368'></font>
<font color=#447700>!                            sfluxref, rayl<a name='3369'></font>
<a name='3370'>
<font color=#447700>! ------- Declarations -------<a name='3371'></font>
      integer , intent(in) :: ncol<a name='3372'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='3373'></font>
<a name='3374'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='3375'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='3376'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='3377'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='3378'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3379'></font>
<a name='3380'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='3381'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='3382'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='3383'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='3384'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='3385'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='3386'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3387'></font>
<a name='3388'>
      integer , intent(in) :: indself(:,:)     <a name='3389'>
      integer , intent(in) :: indfor(:,:) <a name='3390'>
      real , intent(in) :: selffac(:,:) <a name='3391'>
      real , intent(in) :: selffrac(:,:) <a name='3392'>
      real , intent(in) :: forfac(:,:) <a name='3393'>
      real , intent(in) :: forfrac(:,:) <a name='3394'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3395'></font>
<a name='3396'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='3397'></font>
                       fac00(:,:) , fac01(:,:) , &amp;  <a name='3398'>
                       fac10(:,:) , fac11(:,:)  <a name='3399'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3400'></font>
<a name='3401'>
<font color=#447700>! ----- Output -----<a name='3402'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='3403'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='3404'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='3405'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='3406'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='3407'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='3408'></font>
<a name='3409'>
<font color=#447700>! Local<a name='3410'></font>
#ifdef _ACCEL<a name='3411'>
#else<a name='3412'>
# define ncol CHNK<a name='3413'>
#endif<a name='3414'>
<a name='3415'>
#ifdef _ACCEL<a name='3416'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3417'>
#else<a name='3418'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr(ncol)<a name='3419'>
#endif<a name='3420'>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3421'>
                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3422'>
                  tauray<a name='3423'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='3424'></font>
<font color=#447700>!                  layreffr<a name='3425'></font>
<font color=#447700>!      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3426'></font>
<font color=#447700>!                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3427'></font>
<font color=#447700>!                  tauray, strrat<a name='3428'></font>
      integer :: iplon<a name='3429'>
<a name='3430'>
	        <a name='3431'>
      strrat = 5.49281 <a name='3432'>
      layreffr = 3      <a name='3433'>
      <a name='3434'>
#ifdef _ACCEL<a name='3435'>
<font color=#447700>!$acc kernels <a name='3436'></font>
      do iplon=1,ncol<a name='3437'>
<a name='3438'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='3439'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='3440'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='3441'></font>
      laysolfr = laytrop(iplon) <a name='3442'>
  <a name='3443'>
<font color=#447700>! Lower atmosphere loop      <a name='3444'></font>
      do lay = 1, laytrop(iplon) <a name='3445'>
#else<a name='3446'>
      laysolfr = laytrop<a name='3447'>
# define laysolfr LAYSOLFR(iplon)<a name='3448'>
      do lay = 1, nlayers<a name='3449'>
        do iplon = 1, ncol<a name='3450'>
          if (lay &lt;= laytrop(iplon)) then<a name='3451'>
#endif<a name='3452'>
            <a name='3453'>
        if (jp(iplon,lay)  .lt. layreffr .and. jp(iplon,lay+1)  .ge. layreffr) &amp;<a name='3454'>
            laysolfr = min(lay+1,laytrop(iplon) )<a name='3455'>
     <a name='3456'>
         if (lay .eq. laysolfr) then <a name='3457'>
                 speccomb = colh2o(iplon,lay)  + strrat*colco2(iplon,lay) <a name='3458'>
         specparm = colh2o(iplon,lay) /speccomb <a name='3459'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3460'>
         specmult = 8. *(specparm)<a name='3461'>
         js = 1 + int(specmult)<a name='3462'>
         fs = mod(specmult, 1.  )<a name='3463'>
        <a name='3464'>
         do ig = 1 , ng19<a name='3465'>
            sfluxzen(iplon,ngs18+ig)  = sfluxref(ig,js) &amp;<a name='3466'>
               + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='3467'>
         end do<a name='3468'>
         endif<a name='3469'>
#ifdef _ACCEL<a name='3470'>
#else<a name='3471'>
# undef laysolfr<a name='3472'>
         endif<a name='3473'>
#endif<a name='3474'>
<a name='3475'>
      end do<a name='3476'>
      end do<a name='3477'>
<font color=#447700>!$acc end kernels<a name='3478'></font>
      <a name='3479'>
      <a name='3480'>
<font color=#447700>!$acc kernels <a name='3481'></font>
IKLOOP1_S<a name='3482'>
<a name='3483'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='3484'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='3485'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='3486'></font>
<a name='3487'>
<font color=#447700>! Lower atmosphere loop      <a name='3488'></font>
         if (lay &lt;= laytrop(iplon)) then<a name='3489'>
       <a name='3490'>
         speccomb = colh2o(iplon,lay)  + strrat*colco2(iplon,lay) <a name='3491'>
         specparm = colh2o(iplon,lay) /speccomb <a name='3492'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3493'>
         specmult = 8. *(specparm)<a name='3494'>
         js = 1 + int(specmult)<a name='3495'>
         fs = mod(specmult, 1.  )<a name='3496'>
         fac000 = (1.  - fs) * fac00(iplon,lay) <a name='3497'>
         fac010 = (1.  - fs) * fac10(iplon,lay) <a name='3498'>
         fac100 = fs * fac00(iplon,lay) <a name='3499'>
         fac110 = fs * fac10(iplon,lay) <a name='3500'>
         fac001 = (1.  - fs) * fac01(iplon,lay) <a name='3501'>
         fac011 = (1.  - fs) * fac11(iplon,lay) <a name='3502'>
         fac101 = fs * fac01(iplon,lay) <a name='3503'>
         fac111 = fs * fac11(iplon,lay) <a name='3504'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(19) + js<a name='3505'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(19) + js<a name='3506'>
         inds = indself(iplon,lay) <a name='3507'>
         indf = indfor(iplon,lay) <a name='3508'>
         tauray = colmol(iplon,lay)  * rayl<a name='3509'>
<a name='3510'>
         do ig = 1 , ng19<a name='3511'>
            taug(iplon,lay,ngs18+ig)  = speccomb * &amp;<a name='3512'>
                (fac000 * absa(ind0,ig) + &amp;<a name='3513'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='3514'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='3515'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='3516'>
                 fac001 * absa(ind1,ig) + &amp;<a name='3517'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='3518'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='3519'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='3520'>
                 colh2o(iplon,lay)  * &amp;<a name='3521'>
                 (selffac(iplon,lay)  * (selfref(inds,ig) + &amp;<a name='3522'>
                 selffrac(iplon,lay)  * &amp;<a name='3523'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp; <a name='3524'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp;<a name='3525'>
                 forfrac(iplon,lay)  * &amp;<a name='3526'>
                 (forref(indf+1,ig) - forref(indf,ig)))) <a name='3527'>
<font color=#447700>!            ssa(lay,ngs18+ig) = tauray/taug(lay,ngs18+ig)<a name='3528'></font>
            taur(iplon,lay,ngs18+ig)  = tauray   <a name='3529'>
         enddo<a name='3530'>
        else<a name='3531'>
<a name='3532'>
<font color=#447700>! Upper atmosphere loop<a name='3533'></font>
  <a name='3534'>
         ind0 = ((jp(iplon,lay) -13)*5+(jt(iplon,lay) -1))*nspb(19) + 1<a name='3535'>
         ind1 = ((jp(iplon,lay) -12)*5+(jt1(iplon,lay) -1))*nspb(19) + 1<a name='3536'>
         tauray = colmol(iplon,lay)  * rayl<a name='3537'>
<a name='3538'>
         do ig = 1 , ng19<a name='3539'>
            taug(iplon,lay,ngs18+ig)  = colco2(iplon,lay)  * &amp;<a name='3540'>
                (fac00(iplon,lay)  * absb(ind0,ig) + &amp;<a name='3541'>
                 fac10(iplon,lay)  * absb(ind0+1,ig) + &amp;<a name='3542'>
                 fac01(iplon,lay)  * absb(ind1,ig) + &amp;<a name='3543'>
                 fac11(iplon,lay)  * absb(ind1+1,ig)) <a name='3544'>
<font color=#447700>!            ssa(lay,ngs18+ig) = tauray/taug(lay,ngs18+ig) <a name='3545'></font>
            taur(iplon,lay,ngs18+ig)  = tauray   <a name='3546'>
         enddo<a name='3547'>
        end if<a name='3548'>
IKLOOP1_E       <a name='3549'>
<font color=#447700>!$acc end kernels<a name='3550'></font>
# undef ncol<a name='3551'>
      end subroutine taumol19<a name='3552'>
<a name='3553'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3554'></font>
<A NAME='TAUMOL20'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL20' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3555'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol20</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL20.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL20.html' TARGET='index'>4</A><a name='3556'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='3557'>
                          laytrop, jp, jt, jt1, &amp;<a name='3558'>
                          fac00, fac01, fac10, fac11, &amp;<a name='3559'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='3560'>
                          sfluxzen, taug, taur)<a name='3561'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3562'></font>
<font color=#447700>!<a name='3563'></font>
<font color=#447700>!     band 20:  5150-6150 cm-1 (low - h2o; high - h2o)<a name='3564'></font>
<font color=#447700>!<a name='3565'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3566'></font>
<a name='3567'>
<font color=#447700>! ------- Modules -------<a name='3568'></font>
<a name='3569'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_24">, only : ng20, ngs19<a name='3570'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG20_F'>rrsw_kg20_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG20_F_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3571'>
                            sfluxref, absch4, rayl, layreffr<a name='3572'>
<font color=#447700>!      use rrsw_kg20_f, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3573'></font>
<font color=#447700>!                            sfluxref, absch4, rayl<a name='3574'></font>
<a name='3575'>
      implicit none<a name='3576'>
<a name='3577'>
<font color=#447700>! ------- Declarations -------<a name='3578'></font>
      integer , intent(in) :: ncol<a name='3579'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='3580'></font>
<a name='3581'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='3582'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='3583'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='3584'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='3585'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3586'></font>
<a name='3587'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='3588'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='3589'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='3590'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='3591'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='3592'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='3593'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3594'></font>
<a name='3595'>
      integer , intent(in) :: indself(:,:)     <a name='3596'>
      integer , intent(in) :: indfor(:,:) <a name='3597'>
      real , intent(in) :: selffac(:,:) <a name='3598'>
      real , intent(in) :: selffrac(:,:) <a name='3599'>
      real , intent(in) :: forfac(:,:) <a name='3600'>
      real , intent(in) :: forfrac(:,:) <a name='3601'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3602'></font>
<a name='3603'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='3604'></font>
                       fac00(:,:) , fac01(:,:) , &amp;  <a name='3605'>
                       fac10(:,:) , fac11(:,:)  <a name='3606'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3607'></font>
<a name='3608'>
<font color=#447700>! ----- Output -----<a name='3609'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='3610'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='3611'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='3612'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='3613'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='3614'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='3615'></font>
<a name='3616'>
<font color=#447700>! Local<a name='3617'></font>
#ifdef _ACCEL<a name='3618'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3619'>
#else<a name='3620'>
# define ncol CHNK<a name='3621'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr(ncol)<a name='3622'>
#endif<a name='3623'>
<a name='3624'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='3625'></font>
<font color=#447700>!                  layreffr<a name='3626'></font>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3627'>
                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3628'>
                  tauray<a name='3629'>
      integer :: iplon<a name='3630'>
<a name='3631'>
<font color=#447700>!      layreffr = 3        <a name='3632'></font>
<a name='3633'>
#ifdef _ACCEL<a name='3634'>
<font color=#447700>!$acc kernels loop independent private(laysolfr)<a name='3635'></font>
      do iplon = 1, ncol<a name='3636'>
      laysolfr = laytrop(iplon)<a name='3637'>
      do lay = 1, laytrop(iplon)<a name='3638'>
#else<a name='3639'>
      laysolfr = laytrop<a name='3640'>
# define laysolfr LAYSOLFR(iplon)<a name='3641'>
      do lay = 1, nlayers<a name='3642'>
        do iplon = 1, ncol<a name='3643'>
          if (lay &lt;= laytrop(iplon)) then<a name='3644'>
#endif<a name='3645'>
<a name='3646'>
         if (jp(iplon,lay)  .lt. layreffr .and. jp(iplon,lay+1)  .ge. layreffr) &amp;<a name='3647'>
            laysolfr = min(lay+1,laytrop(iplon) )<a name='3648'>
         if (lay .eq. laysolfr) then <a name='3649'>
             do ig = 1, ng20 <a name='3650'>
                 sfluxzen(iplon,ngs19+ig)  = sfluxref(ig) <a name='3651'>
             end do<a name='3652'>
         end if<a name='3653'>
#ifdef _ACCEL<a name='3654'>
#else<a name='3655'>
# undef laysolfr<a name='3656'>
         endif<a name='3657'>
#endif<a name='3658'>
      end do<a name='3659'>
      end do<a name='3660'>
<font color=#447700>!$acc end kernels<a name='3661'></font>
       <a name='3662'>
<font color=#447700>!$acc kernels <a name='3663'></font>
IKLOOP1_S<a name='3664'>
         if (lay &lt;= laytrop(iplon)) then<a name='3665'>
         <a name='3666'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(20) + 1<a name='3667'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(20) + 1<a name='3668'>
         inds = indself(iplon,lay) <a name='3669'>
         indf = indfor(iplon,lay) <a name='3670'>
         tauray = colmol(iplon,lay)  * rayl<a name='3671'>
<a name='3672'>
         do ig = 1, ng20<a name='3673'>
            taug(iplon,lay,ngs19+ig)  = colh2o(iplon,lay)  * &amp;<a name='3674'>
               ((fac00(iplon,lay)  * absa(ind0,ig) + &amp;<a name='3675'>
                 fac10(iplon,lay)  * absa(ind0+1,ig) + &amp;<a name='3676'>
                 fac01(iplon,lay)  * absa(ind1,ig) + &amp;<a name='3677'>
                 fac11(iplon,lay)  * absa(ind1+1,ig)) + &amp;<a name='3678'>
                 selffac(iplon,lay)  * (selfref(inds,ig) + &amp; <a name='3679'>
                 selffrac(iplon,lay)  * &amp;<a name='3680'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='3681'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp;<a name='3682'>
                 forfrac(iplon,lay)  * &amp;<a name='3683'>
                 (forref(indf+1,ig) - forref(indf,ig)))) &amp;<a name='3684'>
                 + colch4(iplon,lay)  * absch4(ig)<a name='3685'>
<font color=#447700>!            ssa(lay,ngs19+ig) = tauray/taug(lay,ngs19+ig)<a name='3686'></font>
            taur(iplon,lay,ngs19+ig)  = tauray <a name='3687'>
           <a name='3688'>
         enddo<a name='3689'>
         else<a name='3690'>
<a name='3691'>
<font color=#447700>! Upper atmosphere loop<a name='3692'></font>
      <a name='3693'>
         ind0 = ((jp(iplon,lay) -13)*5+(jt(iplon,lay) -1))*nspb(20) + 1<a name='3694'>
         ind1 = ((jp(iplon,lay) -12)*5+(jt1(iplon,lay) -1))*nspb(20) + 1<a name='3695'>
         indf = indfor(iplon,lay) <a name='3696'>
         tauray = colmol(iplon,lay)  * rayl<a name='3697'>
<a name='3698'>
         do ig = 1, ng20<a name='3699'>
            taug(iplon,lay,ngs19+ig)  = colh2o(iplon,lay)  * &amp;<a name='3700'>
                (fac00(iplon,lay)  * absb(ind0,ig) + &amp;<a name='3701'>
                 fac10(iplon,lay)  * absb(ind0+1,ig) + &amp;<a name='3702'>
                 fac01(iplon,lay)  * absb(ind1,ig) + &amp;<a name='3703'>
                 fac11(iplon,lay)  * absb(ind1+1,ig) + &amp;<a name='3704'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp;<a name='3705'>
                 forfrac(iplon,lay)  * &amp;<a name='3706'>
                 (forref(indf+1,ig) - forref(indf,ig)))) + &amp;<a name='3707'>
                 colch4(iplon,lay)  * absch4(ig)<a name='3708'>
<font color=#447700>!            ssa(lay,ngs19+ig) = tauray/taug(lay,ngs19+ig)<a name='3709'></font>
            taur(iplon,lay,ngs19+ig)  = tauray <a name='3710'>
         enddo<a name='3711'>
         end if<a name='3712'>
IKLOOP1_E<a name='3713'>
<a name='3714'>
<font color=#447700>!$acc end kernels<a name='3715'></font>
# undef ncol<a name='3716'>
      end subroutine taumol20<a name='3717'>
<a name='3718'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3719'></font>
<A NAME='TAUMOL21'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL21' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3720'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol21</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL21.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL21.html' TARGET='index'>4</A><a name='3721'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='3722'>
                          laytrop, jp, jt, jt1, &amp;<a name='3723'>
                          fac00, fac01, fac10, fac11, &amp;<a name='3724'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='3725'>
                          sfluxzen, taug, taur)<a name='3726'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3727'></font>
<font color=#447700>!<a name='3728'></font>
<font color=#447700>!     band 21:  6150-7700 cm-1 (low - h2o,co2; high - h2o,co2)<a name='3729'></font>
<font color=#447700>!<a name='3730'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3731'></font>
<a name='3732'>
<font color=#447700>! ------- Modules -------<a name='3733'></font>
<a name='3734'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_25">, only : ng21, ngs20<a name='3735'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG21_F'>rrsw_kg21_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG21_F_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3736'>
                            sfluxref, rayl, layreffr, strrat<a name='3737'>
<font color=#447700>!      use rrsw_kg21_f, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3738'></font>
<font color=#447700>!                            sfluxref, rayl<a name='3739'></font>
<a name='3740'>
<font color=#447700>! ------- Declarations -------<a name='3741'></font>
      integer , intent(in) :: ncol<a name='3742'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='3743'></font>
<a name='3744'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='3745'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='3746'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='3747'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='3748'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3749'></font>
<a name='3750'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='3751'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='3752'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='3753'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='3754'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='3755'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='3756'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3757'></font>
<a name='3758'>
      integer , intent(in) :: indself(:,:)     <a name='3759'>
      integer , intent(in) :: indfor(:,:) <a name='3760'>
      real , intent(in) :: selffac(:,:) <a name='3761'>
      real , intent(in) :: selffrac(:,:) <a name='3762'>
      real , intent(in) :: forfac(:,:) <a name='3763'>
      real , intent(in) :: forfrac(:,:) <a name='3764'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3765'></font>
<a name='3766'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='3767'></font>
                       fac00(:,:) , fac01(:,:) , &amp;  <a name='3768'>
                       fac10(:,:) , fac11(:,:)  <a name='3769'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3770'></font>
<a name='3771'>
<font color=#447700>! ----- Output -----<a name='3772'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='3773'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='3774'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='3775'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='3776'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='3777'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='3778'></font>
<a name='3779'>
<font color=#447700>! Local<a name='3780'></font>
#ifdef _ACCEL<a name='3781'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3782'>
#else<a name='3783'>
# define ncol CHNK<a name='3784'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr(ncol)<a name='3785'>
#endif<a name='3786'>
<a name='3787'>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3788'>
                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3789'>
                  tauray<a name='3790'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='3791'></font>
<font color=#447700>!                  layreffr<a name='3792'></font>
<font color=#447700>!      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='3793'></font>
<font color=#447700>!                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='3794'></font>
<font color=#447700>!                  tauray, strrat<a name='3795'></font>
      integer :: iplon<a name='3796'>
        <a name='3797'>
<font color=#447700>!      strrat = 0.0045321 <a name='3798'></font>
<font color=#447700>!      layreffr = 8<a name='3799'></font>
     <a name='3800'>
#ifdef _ACCEL<a name='3801'>
<font color=#447700>!$acc kernels loop independent private(laysolfr)<a name='3802'></font>
      do iplon = 1, ncol<a name='3803'>
      laysolfr = laytrop(iplon)<a name='3804'>
      do lay = 1, laytrop(iplon)<a name='3805'>
#else<a name='3806'>
      laysolfr = laytrop<a name='3807'>
# define laysolfr LAYSOLFR(iplon)<a name='3808'>
      do lay = 1, nlayers<a name='3809'>
        do iplon = 1, ncol<a name='3810'>
          if (lay &lt;= laytrop(iplon)) then<a name='3811'>
#endif<a name='3812'>
<a name='3813'>
         if (jp(iplon,lay)  .lt. layreffr .and. jp(iplon,lay+1)  .ge. layreffr) &amp;<a name='3814'>
            laysolfr = min(lay+1,laytrop(iplon) )<a name='3815'>
         if (lay .eq. laysolfr) then <a name='3816'>
                speccomb = colh2o(iplon,lay)  + strrat*colco2(iplon,lay) <a name='3817'>
         specparm = colh2o(iplon,lay) /speccomb <a name='3818'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3819'>
         specmult = 8. *(specparm)<a name='3820'>
         js = 1 + int(specmult)<a name='3821'>
         fs = mod(specmult, 1.  )<a name='3822'>
               do ig = 1, ng21<a name='3823'>
              sfluxzen(iplon,ngs20+ig)  = sfluxref(ig,js) &amp;<a name='3824'>
               + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='3825'>
               end do<a name='3826'>
          end if<a name='3827'>
<a name='3828'>
#ifdef _ACCEL<a name='3829'>
#else<a name='3830'>
# undef laysolfr<a name='3831'>
         endif<a name='3832'>
#endif<a name='3833'>
      end do<a name='3834'>
      end do        <a name='3835'>
<font color=#447700>!$acc end kernels<a name='3836'></font>
<a name='3837'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='3838'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='3839'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='3840'></font>
      <a name='3841'>
<font color=#447700>! Lower atmosphere loop<a name='3842'></font>
        <a name='3843'>
<font color=#447700>!$acc kernels <a name='3844'></font>
IKLOOP1_S<a name='3845'>
         if (lay &lt;= laytrop(iplon)) then<a name='3846'>
         speccomb = colh2o(iplon,lay)  + strrat*colco2(iplon,lay) <a name='3847'>
         specparm = colh2o(iplon,lay) /speccomb <a name='3848'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3849'>
         specmult = 8. *(specparm)<a name='3850'>
         js = 1 + int(specmult)<a name='3851'>
         fs = mod(specmult, 1.  )<a name='3852'>
         fac000 = (1.  - fs) * fac00(iplon,lay) <a name='3853'>
         fac010 = (1.  - fs) * fac10(iplon,lay) <a name='3854'>
         fac100 = fs * fac00(iplon,lay) <a name='3855'>
         fac110 = fs * fac10(iplon,lay) <a name='3856'>
         fac001 = (1.  - fs) * fac01(iplon,lay) <a name='3857'>
         fac011 = (1.  - fs) * fac11(iplon,lay) <a name='3858'>
         fac101 = fs * fac01(iplon,lay) <a name='3859'>
         fac111 = fs * fac11(iplon,lay) <a name='3860'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(21) + js<a name='3861'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(21) + js<a name='3862'>
         inds = indself(iplon,lay) <a name='3863'>
         indf = indfor(iplon,lay) <a name='3864'>
         tauray = colmol(iplon,lay)  * rayl<a name='3865'>
<a name='3866'>
         do ig = 1, ng21<a name='3867'>
            taug(iplon,lay,ngs20+ig)  = speccomb * &amp;<a name='3868'>
                (fac000 * absa(ind0,ig) + &amp;<a name='3869'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='3870'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='3871'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='3872'>
                 fac001 * absa(ind1,ig) + &amp;<a name='3873'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='3874'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='3875'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='3876'>
                 colh2o(iplon,lay)  * &amp;<a name='3877'>
                 (selffac(iplon,lay)  * (selfref(inds,ig) + &amp;<a name='3878'>
                 selffrac(iplon,lay)  * &amp;<a name='3879'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='3880'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp;<a name='3881'>
                 forfrac(iplon,lay)  * &amp;<a name='3882'>
                 (forref(indf+1,ig) - forref(indf,ig))))<a name='3883'>
<font color=#447700>!            ssa(lay,ngs20+ig) = tauray/taug(lay,ngs20+ig)<a name='3884'></font>
          <a name='3885'>
            taur(iplon,lay,ngs20+ig)  = tauray<a name='3886'>
         enddo<a name='3887'>
        else<a name='3888'>
<a name='3889'>
<font color=#447700>! Upper atmosphere loop<a name='3890'></font>
<a name='3891'>
         speccomb = colh2o(iplon,lay)  + strrat*colco2(iplon,lay) <a name='3892'>
         specparm = colh2o(iplon,lay) /speccomb <a name='3893'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='3894'>
         specmult = 4. *(specparm)<a name='3895'>
         js = 1 + int(specmult)<a name='3896'>
         fs = mod(specmult, 1.  )<a name='3897'>
         fac000 = (1.  - fs) * fac00(iplon,lay) <a name='3898'>
         fac010 = (1.  - fs) * fac10(iplon,lay) <a name='3899'>
         fac100 = fs * fac00(iplon,lay) <a name='3900'>
         fac110 = fs * fac10(iplon,lay) <a name='3901'>
         fac001 = (1.  - fs) * fac01(iplon,lay) <a name='3902'>
         fac011 = (1.  - fs) * fac11(iplon,lay) <a name='3903'>
         fac101 = fs * fac01(iplon,lay) <a name='3904'>
         fac111 = fs * fac11(iplon,lay) <a name='3905'>
         ind0 = ((jp(iplon,lay) -13)*5+(jt(iplon,lay) -1))*nspb(21) + js<a name='3906'>
         ind1 = ((jp(iplon,lay) -12)*5+(jt1(iplon,lay) -1))*nspb(21) + js<a name='3907'>
         indf = indfor(iplon,lay) <a name='3908'>
         tauray = colmol(iplon,lay)  * rayl<a name='3909'>
<a name='3910'>
         do ig = 1, ng21<a name='3911'>
            taug(iplon,lay,ngs20+ig)  = speccomb * &amp;<a name='3912'>
                (fac000 * absb(ind0,ig) + &amp;<a name='3913'>
                 fac100 * absb(ind0+1,ig) + &amp;<a name='3914'>
                 fac010 * absb(ind0+5,ig) + &amp;<a name='3915'>
                 fac110 * absb(ind0+6,ig) + &amp;<a name='3916'>
                 fac001 * absb(ind1,ig) + &amp;<a name='3917'>
                 fac101 * absb(ind1+1,ig) + &amp;<a name='3918'>
                 fac011 * absb(ind1+5,ig) + &amp;<a name='3919'>
                 fac111 * absb(ind1+6,ig)) + &amp;<a name='3920'>
                 colh2o(iplon,lay)  * &amp;<a name='3921'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp;<a name='3922'>
                 forfrac(iplon,lay)  * &amp;<a name='3923'>
                 (forref(indf+1,ig) - forref(indf,ig)))<a name='3924'>
<font color=#447700>!            ssa(lay,ngs20+ig) = tauray/taug(lay,ngs20+ig)<a name='3925'></font>
            taur(iplon,lay,ngs20+ig)  = tauray<a name='3926'>
         enddo<a name='3927'>
        end if<a name='3928'>
IKLOOP1_E<a name='3929'>
      <a name='3930'>
<font color=#447700>!$acc end kernels<a name='3931'></font>
# undef ncol<a name='3932'>
      end subroutine taumol21<a name='3933'>
<a name='3934'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3935'></font>
<A NAME='TAUMOL22'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL22' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3936'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol22</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL22.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL22.html' TARGET='index'>4</A><a name='3937'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='3938'>
                          laytrop, jp, jt, jt1, &amp;<a name='3939'>
                          fac00, fac01, fac10, fac11, &amp;<a name='3940'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='3941'>
                          sfluxzen, taug, taur)<a name='3942'>
<font color=#447700>!----------------------------------------------------------------------------<a name='3943'></font>
<font color=#447700>!<a name='3944'></font>
<font color=#447700>!     band 22:  7700-8050 cm-1 (low - h2o,o2; high - o2)<a name='3945'></font>
<font color=#447700>!<a name='3946'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='3947'></font>
<a name='3948'>
<font color=#447700>! ------- Modules -------<a name='3949'></font>
<a name='3950'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_26">, only : ng22, ngs21<a name='3951'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG22_F'>rrsw_kg22_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG22_F_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3952'>
                            sfluxref, rayl, layreffr, strrat<a name='3953'>
<font color=#447700>!      use rrsw_kg22_f, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='3954'></font>
<font color=#447700>!                            sfluxref, rayl<a name='3955'></font>
<a name='3956'>
<font color=#447700>! ------- Declarations -------<a name='3957'></font>
      integer , intent(in) :: ncol<a name='3958'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='3959'></font>
<a name='3960'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='3961'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='3962'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='3963'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='3964'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3965'></font>
<a name='3966'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='3967'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='3968'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='3969'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='3970'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='3971'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='3972'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3973'></font>
<a name='3974'>
      integer , intent(in) :: indself(:,:)     <a name='3975'>
      integer , intent(in) :: indfor(:,:) <a name='3976'>
      real , intent(in) :: selffac(:,:) <a name='3977'>
      real , intent(in) :: selffrac(:,:) <a name='3978'>
      real , intent(in) :: forfac(:,:) <a name='3979'>
      real , intent(in) :: forfrac(:,:) <a name='3980'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3981'></font>
<a name='3982'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='3983'></font>
                       fac00(:,:) , fac01(:,:) , &amp;  <a name='3984'>
                       fac10(:,:) , fac11(:,:)  <a name='3985'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='3986'></font>
<a name='3987'>
<font color=#447700>! ----- Output -----<a name='3988'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='3989'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='3990'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='3991'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='3992'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='3993'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='3994'></font>
<a name='3995'>
<font color=#447700>! Local<a name='3996'></font>
#ifdef _ACCEL<a name='3997'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='3998'>
#else<a name='3999'>
# define ncol CHNK<a name='4000'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr(ncol)<a name='4001'>
#endif<a name='4002'>
<a name='4003'>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4004'>
                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4005'>
                  tauray, o2adj, o2cont<a name='4006'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='4007'></font>
<font color=#447700>!                  layreffr<a name='4008'></font>
<font color=#447700>!      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4009'></font>
<font color=#447700>!                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4010'></font>
<font color=#447700>!                  tauray, o2adj, o2cont, strrat<a name='4011'></font>
      integer :: iplon<a name='4012'>
<a name='4013'>
<font color=#447700>! The following factor is the ratio of total O2 band intensity (lines <a name='4014'></font>
<font color=#447700>! and Mate continuum) to O2 band intensity (line only).  It is needed<a name='4015'></font>
<font color=#447700>! to adjust the optical depths since the k's include only lines.<a name='4016'></font>
      o2adj = 1.6 <a name='4017'>
      <a name='4018'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4019'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4020'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4021'></font>
<a name='4022'>
<font color=#447700>!      strrat = 0.022708 <a name='4023'></font>
<font color=#447700>!      layreffr = 2<a name='4024'></font>
      <a name='4025'>
#ifdef _ACCEL<a name='4026'>
<font color=#447700>!$acc kernels loop independent private(laysolfr)<a name='4027'></font>
      do iplon=1,ncol<a name='4028'>
<a name='4029'>
      laysolfr = laytrop(iplon) <a name='4030'>
<a name='4031'>
<font color=#447700>! Lower atmosphere loop<a name='4032'></font>
<font color=#447700>!$acc loop seq<a name='4033'></font>
         do lay = 1, laytrop(iplon) <a name='4034'>
#else<a name='4035'>
      laysolfr = laytrop<a name='4036'>
# define laysolfr LAYSOLFR(iplon)<a name='4037'>
      do lay = 1, nlayers<a name='4038'>
        do iplon = 1, ncol<a name='4039'>
          if (lay &lt;= laytrop(iplon)) then<a name='4040'>
#endif<a name='4041'>
<a name='4042'>
            if (jp(iplon,lay)  .lt. layreffr .and. jp(iplon,lay+1)  .ge. layreffr) &amp;<a name='4043'>
            laysolfr = min(lay+1,laytrop(iplon) )<a name='4044'>
                 <a name='4045'>
            if (lay .eq. laysolfr) then <a name='4046'>
            speccomb = colh2o(iplon,lay)  + o2adj*strrat*colo2(iplon,lay) <a name='4047'>
            specparm = colh2o(iplon,lay) /speccomb <a name='4048'>
            if (specparm .ge. oneminus) specparm = oneminus<a name='4049'>
            specmult = 8. *(specparm)<a name='4050'>
    <font color=#447700>!         odadj = specparm + o2adj * (1.  - specparm)<a name='4051'></font>
            js = 1 + int(specmult)<a name='4052'>
            fs = mod(specmult, 1.  )<a name='4053'>
            do ig = 1, ng22                                 <a name='4054'>
                                 <a name='4055'>
               sfluxzen(iplon,ngs21+ig)  = sfluxref(ig,js) &amp;<a name='4056'>
                + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='4057'>
            end do<a name='4058'>
            end if<a name='4059'>
#ifdef _ACCEL<a name='4060'>
#else<a name='4061'>
# undef laysolfr<a name='4062'>
         endif<a name='4063'>
#endif<a name='4064'>
         end do<a name='4065'>
      end do<a name='4066'>
 <font color=#447700>!$acc end kernels<a name='4067'></font>
 <a name='4068'>
<font color=#447700>! Lower atmosphere loop<a name='4069'></font>
<font color=#447700>!$acc kernels <a name='4070'></font>
IKLOOP1_S<a name='4071'>
<a name='4072'>
         if (lay&lt;=laytrop(iplon)) then<a name='4073'>
  <a name='4074'>
         o2cont = 4.35e-4 *colo2(iplon,lay) /(350.0 *2.0 )<a name='4075'>
         speccomb = colh2o(iplon,lay)  + o2adj*strrat*colo2(iplon,lay) <a name='4076'>
         specparm = colh2o(iplon,lay) /speccomb <a name='4077'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='4078'>
         specmult = 8. *(specparm)<a name='4079'>
<font color=#447700>!         odadj = specparm + o2adj * (1.  - specparm)<a name='4080'></font>
         js = 1 + int(specmult)<a name='4081'>
         fs = mod(specmult, 1.  )<a name='4082'>
         fac000 = (1.  - fs) * fac00(iplon,lay) <a name='4083'>
         fac010 = (1.  - fs) * fac10(iplon,lay) <a name='4084'>
         fac100 = fs * fac00(iplon,lay) <a name='4085'>
         fac110 = fs * fac10(iplon,lay) <a name='4086'>
         fac001 = (1.  - fs) * fac01(iplon,lay) <a name='4087'>
         fac011 = (1.  - fs) * fac11(iplon,lay) <a name='4088'>
         fac101 = fs * fac01(iplon,lay) <a name='4089'>
         fac111 = fs * fac11(iplon,lay) <a name='4090'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(22) + js<a name='4091'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(22) + js<a name='4092'>
         inds = indself(iplon,lay) <a name='4093'>
         indf = indfor(iplon,lay) <a name='4094'>
         tauray = colmol(iplon,lay)  * rayl<a name='4095'>
<a name='4096'>
         do ig = 1, ng22<a name='4097'>
            taug(iplon,lay,ngs21+ig)  = speccomb * &amp;<a name='4098'>
                (fac000 * absa(ind0,ig) + &amp;<a name='4099'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='4100'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='4101'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='4102'>
                 fac001 * absa(ind1,ig) + &amp;<a name='4103'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='4104'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='4105'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='4106'>
                 colh2o(iplon,lay)  * &amp;<a name='4107'>
                 (selffac(iplon,lay)  * (selfref(inds,ig) + &amp;<a name='4108'>
                 selffrac(iplon,lay)  * &amp;<a name='4109'>
                  (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='4110'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp;<a name='4111'>
                 forfrac(iplon,lay)  * &amp;<a name='4112'>
                 (forref(indf+1,ig) - forref(indf,ig)))) &amp;<a name='4113'>
                 + o2cont<a name='4114'>
<font color=#447700>!            ssa(lay,ngs21+ig) = tauray/taug(lay,ngs21+ig)<a name='4115'></font>
<a name='4116'>
            taur(iplon,lay,ngs21+ig)  = tauray<a name='4117'>
         enddo<a name='4118'>
<a name='4119'>
         else<a name='4120'>
<a name='4121'>
<font color=#447700>! Upper atmosphere loop<a name='4122'></font>
      <a name='4123'>
         o2cont = 4.35e-4 *colo2(iplon,lay) /(350.0 *2.0 )<a name='4124'>
         ind0 = ((jp(iplon,lay) -13)*5+(jt(iplon,lay) -1))*nspb(22) + 1<a name='4125'>
         ind1 = ((jp(iplon,lay) -12)*5+(jt1(iplon,lay) -1))*nspb(22) + 1<a name='4126'>
         tauray = colmol(iplon,lay)  * rayl<a name='4127'>
<a name='4128'>
         do ig = 1, ng22<a name='4129'>
            taug(iplon,lay,ngs21+ig)  = colo2(iplon,lay)  * o2adj * &amp;<a name='4130'>
                (fac00(iplon,lay)  * absb(ind0,ig) + &amp;<a name='4131'>
                 fac10(iplon,lay)  * absb(ind0+1,ig) + &amp;<a name='4132'>
                 fac01(iplon,lay)  * absb(ind1,ig) + &amp;<a name='4133'>
                 fac11(iplon,lay)  * absb(ind1+1,ig)) + &amp;<a name='4134'>
                 o2cont<a name='4135'>
<font color=#447700>!            ssa(lay,ngs21+ig) = tauray/taug(lay,ngs21+ig)<a name='4136'></font>
            taur(iplon,lay,ngs21+ig)  = tauray<a name='4137'>
         enddo<a name='4138'>
         end if<a name='4139'>
IKLOOP1_E<a name='4140'>
      <a name='4141'>
<font color=#447700>!$acc end kernels<a name='4142'></font>
# undef ncol<a name='4143'>
      end subroutine taumol22<a name='4144'>
<a name='4145'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4146'></font>
<A NAME='TAUMOL23'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL23' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4147'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol23</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL23.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL23.html' TARGET='index'>4</A><a name='4148'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='4149'>
                          laytrop, jp, jt, jt1, &amp;<a name='4150'>
                          fac00, fac01, fac10, fac11, &amp;<a name='4151'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='4152'>
                          sfluxzen, taug, taur)<a name='4153'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4154'></font>
<font color=#447700>!<a name='4155'></font>
<font color=#447700>!     band 23:  8050-12850 cm-1 (low - h2o; high - nothing)<a name='4156'></font>
<font color=#447700>!<a name='4157'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4158'></font>
<a name='4159'>
<font color=#447700>! ------- Modules -------<a name='4160'></font>
<a name='4161'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_27">, only : ng23, ngs22<a name='4162'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG23_F'>rrsw_kg23_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG23_F_1">, only : absa, ka, forref, selfref, &amp;<a name='4163'>
                            sfluxref, rayl, layreffr, givfac<a name='4164'>
<font color=#447700>!      use rrsw_kg23_f, only : absa, ka, forref, selfref, &amp;<a name='4165'></font>
<font color=#447700>!                            sfluxref, rayl<a name='4166'></font>
<a name='4167'>
<font color=#447700>! ------- Declarations -------<a name='4168'></font>
      integer , intent(in) :: ncol<a name='4169'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='4170'></font>
<a name='4171'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='4172'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='4173'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='4174'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='4175'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4176'></font>
<a name='4177'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='4178'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='4179'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='4180'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='4181'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='4182'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='4183'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4184'></font>
<a name='4185'>
      integer , intent(in) :: indself(:,:)     <a name='4186'>
      integer , intent(in) :: indfor(:,:) <a name='4187'>
      real , intent(in) :: selffac(:,:) <a name='4188'>
      real , intent(in) :: selffrac(:,:) <a name='4189'>
      real , intent(in) :: forfac(:,:) <a name='4190'>
      real , intent(in) :: forfrac(:,:) <a name='4191'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4192'></font>
<a name='4193'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='4194'></font>
                       fac00(:,:) , fac01(:,:) , &amp;  <a name='4195'>
                       fac10(:,:) , fac11(:,:)  <a name='4196'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4197'></font>
<a name='4198'>
<font color=#447700>! ----- Output -----<a name='4199'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='4200'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='4201'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='4202'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='4203'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='4204'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='4205'></font>
<a name='4206'>
<font color=#447700>! Local<a name='4207'></font>
#ifdef _ACCEL<a name='4208'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='4209'>
#else<a name='4210'>
# define ncol CHNK<a name='4211'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr(ncol)<a name='4212'>
#endif<a name='4213'>
<a name='4214'>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4215'>
                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4216'>
                  tauray<a name='4217'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='4218'></font>
<font color=#447700>!                  layreffr<a name='4219'></font>
<font color=#447700>!      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4220'></font>
<font color=#447700>!                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4221'></font>
<font color=#447700>!                  tauray, givfac<a name='4222'></font>
      integer :: iplon<a name='4223'>
<a name='4224'>
<a name='4225'>
<font color=#447700>! Average Giver et al. correction factor for this band.<a name='4226'></font>
<font color=#447700>!      givfac = 1.029 <a name='4227'></font>
<a name='4228'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4229'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4230'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4231'></font>
<a name='4232'>
<font color=#447700>!      layreffr = 6    <a name='4233'></font>
      <a name='4234'>
#ifdef _ACCEL<a name='4235'>
<font color=#447700>!$acc kernels loop independent private(laysolfr)<a name='4236'></font>
      do iplon=1,ncol<a name='4237'>
<a name='4238'>
      laysolfr = laytrop(iplon) <a name='4239'>
<a name='4240'>
<font color=#447700>! Lower atmosphere loop<a name='4241'></font>
<font color=#447700>!$acc loop seq<a name='4242'></font>
      do lay = 1, laytrop(iplon) <a name='4243'>
#else<a name='4244'>
      laysolfr = laytrop<a name='4245'>
# define laysolfr LAYSOLFR(iplon)<a name='4246'>
      do lay = 1, nlayers<a name='4247'>
        do iplon = 1, ncol<a name='4248'>
          if (lay &lt;= laytrop(iplon)) then<a name='4249'>
#endif<a name='4250'>
<a name='4251'>
          if (jp(iplon,lay)  .lt. layreffr .and. jp(iplon,lay+1)  .ge. layreffr) &amp;<a name='4252'>
            laysolfr = min(lay+1,laytrop(iplon) )<a name='4253'>
         <a name='4254'>
          if (lay .eq. laysolfr) then <a name='4255'>
            do ig = 1, ng23<a name='4256'>
              sfluxzen(iplon,ngs22+ig)  = sfluxref(ig) <a name='4257'>
            end do<a name='4258'>
          end if<a name='4259'>
#ifdef _ACCEL<a name='4260'>
#else<a name='4261'>
# undef laysolfr<a name='4262'>
         endif<a name='4263'>
#endif<a name='4264'>
      end do<a name='4265'>
      end do      <a name='4266'>
<font color=#447700>!$acc end kernels   <a name='4267'></font>
      <a name='4268'>
<a name='4269'>
<font color=#447700>! Lower atmosphere loop<a name='4270'></font>
<font color=#447700>!$acc kernels <a name='4271'></font>
IKLOOP1_S<a name='4272'>
         if (lay &lt;= laytrop(iplon)) then<a name='4273'>
         if (jp(iplon,lay)  .lt. layreffr .and. jp(iplon,lay+1)  .ge. layreffr) &amp;<a name='4274'>
            laysolfr = min(lay+1,laytrop(iplon) )<a name='4275'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(23) + 1<a name='4276'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(23) + 1<a name='4277'>
         inds = indself(iplon,lay) <a name='4278'>
         indf = indfor(iplon,lay) <a name='4279'>
<a name='4280'>
         do ig = 1, ng23<a name='4281'>
            tauray = colmol(iplon,lay)  * rayl(ig)<a name='4282'>
            taug(iplon,lay,ngs22+ig)  = colh2o(iplon,lay)  * &amp;<a name='4283'>
                (givfac * (fac00(iplon,lay)  * absa(ind0,ig) + &amp;<a name='4284'>
                 fac10(iplon,lay)  * absa(ind0+1,ig) + &amp;<a name='4285'>
                 fac01(iplon,lay)  * absa(ind1,ig) + &amp;<a name='4286'>
                 fac11(iplon,lay)  * absa(ind1+1,ig)) + &amp;<a name='4287'>
                 selffac(iplon,lay)  * (selfref(inds,ig) + &amp;<a name='4288'>
                 selffrac(iplon,lay)  * &amp;<a name='4289'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='4290'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp;<a name='4291'>
                 forfrac(iplon,lay)  * &amp;<a name='4292'>
                 (forref(indf+1,ig) - forref(indf,ig)))) <a name='4293'>
<font color=#447700>!            ssa(lay,ngs22+ig) = tauray/taug(lay,ngs22+ig)<a name='4294'></font>
           <a name='4295'>
            taur(iplon,lay,ngs22+ig)  = tauray<a name='4296'>
         enddo<a name='4297'>
<a name='4298'>
         else<a name='4299'>
<a name='4300'>
<font color=#447700>! Upper atmosphere loop<a name='4301'></font>
      <a name='4302'>
         do ig = 1, ng23<a name='4303'>
<font color=#447700>!            taug(lay,ngs22+ig) = colmol(lay) * rayl(ig)<a name='4304'></font>
<font color=#447700>!            ssa(lay,ngs22+ig) = 1.0 <a name='4305'></font>
            taug(iplon,lay,ngs22+ig)  = 0. <a name='4306'>
            taur(iplon,lay,ngs22+ig)  = colmol(iplon,lay)  * rayl(ig) <a name='4307'>
         enddo<a name='4308'>
         end if<a name='4309'>
<a name='4310'>
IKLOOP1_E<a name='4311'>
      <a name='4312'>
<font color=#447700>!$acc end kernels<a name='4313'></font>
# undef ncol<a name='4314'>
      end subroutine taumol23<a name='4315'>
<a name='4316'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4317'></font>
<A NAME='TAUMOL24'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL24' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4318'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol24</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL24.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL24.html' TARGET='index'>4</A><a name='4319'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='4320'>
                          laytrop, jp, jt, jt1, &amp;<a name='4321'>
                          fac00, fac01, fac10, fac11, &amp;<a name='4322'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='4323'>
                          sfluxzen, taug, taur)<a name='4324'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4325'></font>
<font color=#447700>!<a name='4326'></font>
<font color=#447700>!     band 24:  12850-16000 cm-1 (low - h2o,o2; high - o2)<a name='4327'></font>
<font color=#447700>!<a name='4328'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4329'></font>
<a name='4330'>
<font color=#447700>! ------- Modules -------<a name='4331'></font>
<a name='4332'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_28">, only : ng24, ngs23<a name='4333'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG24_F'>rrsw_kg24_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG24_F_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='4334'>
                            sfluxref, abso3a, abso3b, rayla, raylb, &amp;<a name='4335'>
                            layreffr, strrat<a name='4336'>
<font color=#447700>!      use rrsw_kg24_f, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='4337'></font>
<font color=#447700>!                            sfluxref, abso3a, abso3b, rayla, raylb<a name='4338'></font>
<a name='4339'>
<font color=#447700>! ------- Declarations -------<a name='4340'></font>
      integer , intent(in) :: ncol<a name='4341'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='4342'></font>
<a name='4343'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='4344'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='4345'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='4346'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='4347'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4348'></font>
<a name='4349'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='4350'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='4351'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='4352'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='4353'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='4354'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='4355'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4356'></font>
<a name='4357'>
      integer , intent(in) :: indself(:,:)     <a name='4358'>
      integer , intent(in) :: indfor(:,:) <a name='4359'>
      real , intent(in) :: selffac(:,:) <a name='4360'>
      real , intent(in) :: selffrac(:,:) <a name='4361'>
      real , intent(in) :: forfac(:,:) <a name='4362'>
      real , intent(in) :: forfrac(:,:) <a name='4363'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4364'></font>
<a name='4365'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='4366'></font>
                       fac00(:,:) , fac01(:,:) , &amp; <a name='4367'>
                       fac10(:,:) , fac11(:,:)  <a name='4368'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4369'></font>
<a name='4370'>
<font color=#447700>! ----- Output -----<a name='4371'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='4372'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='4373'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='4374'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='4375'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='4376'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='4377'></font>
<a name='4378'>
<font color=#447700>! Local<a name='4379'></font>
#ifdef _ACCEL<a name='4380'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='4381'>
#else<a name='4382'>
# define ncol CHNK<a name='4383'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr(ncol)<a name='4384'>
#endif<a name='4385'>
<a name='4386'>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4387'>
                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4388'>
                  tauray<a name='4389'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='4390'></font>
<font color=#447700>!                  layreffr<a name='4391'></font>
<font color=#447700>!      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4392'></font>
<font color=#447700>!                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4393'></font>
<font color=#447700>!                  tauray, strrat<a name='4394'></font>
      integer :: iplon<a name='4395'>
<a name='4396'>
<font color=#447700>!      strrat = 0.124692 <a name='4397'></font>
<font color=#447700>!      layreffr = 1   <a name='4398'></font>
        <a name='4399'>
#ifdef _ACCEL<a name='4400'>
<font color=#447700>!$acc kernels loop independent private(laysolfr)<a name='4401'></font>
      do iplon=1,ncol<a name='4402'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4403'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4404'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4405'></font>
<a name='4406'>
      laysolfr = laytrop(iplon) <a name='4407'>
<a name='4408'>
<font color=#447700>! Lower atmosphere loop<a name='4409'></font>
<font color=#447700>!$acc loop independent<a name='4410'></font>
      do lay = 1, laytrop(iplon) <a name='4411'>
#else<a name='4412'>
      laysolfr = laytrop<a name='4413'>
# define laysolfr LAYSOLFR(iplon)<a name='4414'>
      do lay = 1, nlayers<a name='4415'>
        do iplon = 1, ncol<a name='4416'>
          if (lay &lt;= laytrop(iplon)) then<a name='4417'>
#endif<a name='4418'>
<a name='4419'>
          if (jp(iplon,lay)  .lt. layreffr .and. jp(iplon,lay+1)  .ge. layreffr) &amp;<a name='4420'>
            laysolfr = min(lay+1,laytrop(iplon) )<a name='4421'>
          if (lay .eq. laysolfr) then<a name='4422'>
                 speccomb = colh2o(iplon,lay)  + strrat*colo2(iplon,lay) <a name='4423'>
            specparm = colh2o(iplon,lay) /speccomb <a name='4424'>
            if (specparm .ge. oneminus) specparm = oneminus<a name='4425'>
            specmult = 8. *(specparm)<a name='4426'>
            js = 1 + int(specmult)<a name='4427'>
            fs = mod(specmult, 1.  )<a name='4428'>
          do ig = 1, ng24<a name='4429'>
           sfluxzen(iplon,ngs23+ig)  = sfluxref(ig,js) &amp;<a name='4430'>
               + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='4431'>
          end do<a name='4432'>
          end if<a name='4433'>
#ifdef _ACCEL<a name='4434'>
#else<a name='4435'>
# undef laysolfr<a name='4436'>
         endif<a name='4437'>
#endif<a name='4438'>
      end do<a name='4439'>
      end do<a name='4440'>
<font color=#447700>!$acc end kernels<a name='4441'></font>
        <a name='4442'>
<font color=#447700>!$acc kernels <a name='4443'></font>
IKLOOP1_S<a name='4444'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4445'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4446'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4447'></font>
<a name='4448'>
<font color=#447700>! Lower atmosphere loop<a name='4449'></font>
         if (lay &lt;= laytrop(iplon)) then<a name='4450'>
<a name='4451'>
         speccomb = colh2o(iplon,lay)  + strrat*colo2(iplon,lay) <a name='4452'>
         specparm = colh2o(iplon,lay) /speccomb <a name='4453'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='4454'>
         specmult = 8. *(specparm)<a name='4455'>
         js = 1 + int(specmult)<a name='4456'>
         fs = mod(specmult, 1.  )<a name='4457'>
         fac000 = (1.  - fs) * fac00(iplon,lay) <a name='4458'>
         fac010 = (1.  - fs) * fac10(iplon,lay) <a name='4459'>
         fac100 = fs * fac00(iplon,lay) <a name='4460'>
         fac110 = fs * fac10(iplon,lay) <a name='4461'>
         fac001 = (1.  - fs) * fac01(iplon,lay) <a name='4462'>
         fac011 = (1.  - fs) * fac11(iplon,lay) <a name='4463'>
         fac101 = fs * fac01(iplon,lay) <a name='4464'>
         fac111 = fs * fac11(iplon,lay) <a name='4465'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(24) + js<a name='4466'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(24) + js<a name='4467'>
         inds = indself(iplon,lay) <a name='4468'>
         indf = indfor(iplon,lay) <a name='4469'>
<a name='4470'>
         do ig = 1, ng24<a name='4471'>
            tauray = colmol(iplon,lay)  * (rayla(ig,js) + &amp;<a name='4472'>
               fs * (rayla(ig,js+1) - rayla(ig,js)))<a name='4473'>
            taug(iplon,lay,ngs23+ig)  = speccomb * &amp;<a name='4474'>
                (fac000 * absa(ind0,ig) + &amp;<a name='4475'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='4476'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='4477'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='4478'>
                 fac001 * absa(ind1,ig) + &amp;<a name='4479'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='4480'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='4481'>
                 fac111 * absa(ind1+10,ig)) + &amp;<a name='4482'>
                 colo3(iplon,lay)  * abso3a(ig) + &amp;<a name='4483'>
                 colh2o(iplon,lay)  * &amp; <a name='4484'>
                 (selffac(iplon,lay)  * (selfref(inds,ig) + &amp;<a name='4485'>
                 selffrac(iplon,lay)  * &amp;<a name='4486'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='4487'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp; <a name='4488'>
                 forfrac(iplon,lay)  * &amp;<a name='4489'>
                 (forref(indf+1,ig) - forref(indf,ig))))<a name='4490'>
<font color=#447700>!            ssa(lay,ngs23+ig) = tauray/taug(lay,ngs23+ig)<a name='4491'></font>
           <a name='4492'>
            taur(iplon,lay,ngs23+ig)  = tauray<a name='4493'>
         enddo<a name='4494'>
<a name='4495'>
         else<a name='4496'>
<a name='4497'>
<font color=#447700>! Upper atmosphere loop<a name='4498'></font>
      <a name='4499'>
         ind0 = ((jp(iplon,lay) -13)*5+(jt(iplon,lay) -1))*nspb(24) + 1<a name='4500'>
         ind1 = ((jp(iplon,lay) -12)*5+(jt1(iplon,lay) -1))*nspb(24) + 1<a name='4501'>
<a name='4502'>
         do ig = 1, ng24<a name='4503'>
            tauray = colmol(iplon,lay)  * raylb(ig)<a name='4504'>
            taug(iplon,lay,ngs23+ig)  = colo2(iplon,lay)  * &amp;<a name='4505'>
                (fac00(iplon,lay)  * absb(ind0,ig) + &amp;<a name='4506'>
                 fac10(iplon,lay)  * absb(ind0+1,ig) + &amp;<a name='4507'>
                 fac01(iplon,lay)  * absb(ind1,ig) + &amp;<a name='4508'>
                 fac11(iplon,lay)  * absb(ind1+1,ig)) + &amp;<a name='4509'>
                 colo3(iplon,lay)  * abso3b(ig)<a name='4510'>
<font color=#447700>!            ssa(lay,ngs23+ig) = tauray/taug(lay,ngs23+ig)<a name='4511'></font>
            taur(iplon,lay,ngs23+ig)  = tauray<a name='4512'>
         enddo<a name='4513'>
         endif<a name='4514'>
<a name='4515'>
IKLOOP1_E<a name='4516'>
      <a name='4517'>
<font color=#447700>!$acc end kernels<a name='4518'></font>
# undef ncol<a name='4519'>
      end subroutine taumol24<a name='4520'>
<a name='4521'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4522'></font>
<A NAME='TAUMOL25'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL25' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4523'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol25</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL25.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL25.html' TARGET='index'>4</A><a name='4524'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='4525'>
                          laytrop, jp, jt, jt1, &amp;<a name='4526'>
                          fac00, fac01, fac10, fac11, &amp;<a name='4527'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='4528'>
                          sfluxzen, taug, taur)<a name='4529'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4530'></font>
<font color=#447700>!<a name='4531'></font>
<font color=#447700>!     band 25:  16000-22650 cm-1 (low - h2o; high - nothing)<a name='4532'></font>
<font color=#447700>!<a name='4533'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4534'></font>
<a name='4535'>
<font color=#447700>! ------- Modules -------<a name='4536'></font>
<a name='4537'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_29">, only : ng25, ngs24<a name='4538'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG25_F'>rrsw_kg25_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG25_F_1">, only : absa, ka, &amp;<a name='4539'>
                            sfluxref, abso3a, abso3b, rayl, layreffr<a name='4540'>
<font color=#447700>!      use rrsw_kg25_f, only : absa, ka, &amp;<a name='4541'></font>
<font color=#447700>!                            sfluxref, abso3a, abso3b, rayl<a name='4542'></font>
<a name='4543'>
<font color=#447700>! ------- Declarations -------<a name='4544'></font>
      integer , intent(in) :: ncol<a name='4545'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='4546'></font>
<a name='4547'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='4548'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='4549'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='4550'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='4551'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4552'></font>
<a name='4553'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='4554'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='4555'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='4556'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='4557'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='4558'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='4559'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4560'></font>
<a name='4561'>
      integer , intent(in) :: indself(:,:)     <a name='4562'>
      integer , intent(in) :: indfor(:,:) <a name='4563'>
      real , intent(in) :: selffac(:,:) <a name='4564'>
      real , intent(in) :: selffrac(:,:) <a name='4565'>
      real , intent(in) :: forfac(:,:) <a name='4566'>
      real , intent(in) :: forfrac(:,:) <a name='4567'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4568'></font>
<a name='4569'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='4570'></font>
                       fac00(:,:) , fac01(:,:) , &amp;  <a name='4571'>
                       fac10(:,:) , fac11(:,:)  <a name='4572'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4573'></font>
<a name='4574'>
<font color=#447700>! ----- Output -----<a name='4575'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='4576'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='4577'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='4578'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='4579'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='4580'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='4581'></font>
<a name='4582'>
<font color=#447700>! Local<a name='4583'></font>
#ifdef _ACCEL<a name='4584'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='4585'>
#else<a name='4586'>
# define ncol CHNK<a name='4587'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr(ncol)<a name='4588'>
#endif<a name='4589'>
<a name='4590'>
<a name='4591'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='4592'></font>
<font color=#447700>!                  layreffr<a name='4593'></font>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4594'>
                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4595'>
                  tauray<a name='4596'>
      integer :: iplon<a name='4597'>
<a name='4598'>
#ifdef _ACCEL<a name='4599'>
<font color=#447700>!$acc kernels <a name='4600'></font>
      do iplon=1,ncol<a name='4601'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4602'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4603'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4604'></font>
<a name='4605'>
<font color=#447700>!      layreffr = 2<a name='4606'></font>
      laysolfr = laytrop(iplon) <a name='4607'>
<a name='4608'>
<font color=#447700>! Lower atmosphere loop<a name='4609'></font>
      do lay = 1, laytrop(iplon) <a name='4610'>
#else<a name='4611'>
      laysolfr = laytrop<a name='4612'>
# define laysolfr LAYSOLFR(iplon)<a name='4613'>
      do lay = 1, nlayers<a name='4614'>
        do iplon = 1, ncol<a name='4615'>
          if (lay &lt;= laytrop(iplon)) then<a name='4616'>
#endif<a name='4617'>
         if (jp(iplon,lay)  .lt. layreffr .and. jp(iplon,lay+1)  .ge. layreffr) &amp;<a name='4618'>
            laysolfr = min(lay+1,laytrop(iplon) )<a name='4619'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(25) + 1<a name='4620'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(25) + 1<a name='4621'>
<a name='4622'>
         do ig = 1, ng25<a name='4623'>
            tauray = colmol(iplon,lay)  * rayl(ig)<a name='4624'>
            taug(iplon,lay,ngs24+ig)  = colh2o(iplon,lay)  * &amp;<a name='4625'>
                (fac00(iplon,lay)  * absa(ind0,ig) + &amp;<a name='4626'>
                 fac10(iplon,lay)  * absa(ind0+1,ig) + &amp;<a name='4627'>
                 fac01(iplon,lay)  * absa(ind1,ig) + &amp;<a name='4628'>
                 fac11(iplon,lay)  * absa(ind1+1,ig)) + &amp;<a name='4629'>
                 colo3(iplon,lay)  * abso3a(ig) <a name='4630'>
<font color=#447700>!            ssa(lay,ngs24+ig) = tauray/taug(lay,ngs24+ig)<a name='4631'></font>
            if (lay .eq. laysolfr) sfluxzen(iplon,ngs24+ig)  = sfluxref(ig) <a name='4632'>
            taur(iplon,lay,ngs24+ig)  = tauray<a name='4633'>
         enddo<a name='4634'>
#ifdef _ACCEL<a name='4635'>
      enddo<a name='4636'>
<font color=#447700>! Upper atmosphere loop<a name='4637'></font>
      do lay = laytrop(iplon) +1, nlayers<a name='4638'>
#else<a name='4639'>
      else <a name='4640'>
#endif<a name='4641'>
<a name='4642'>
         do ig = 1, ng25<a name='4643'>
            tauray = colmol(iplon,lay)  * rayl(ig)<a name='4644'>
            taug(iplon,lay,ngs24+ig)  = colo3(iplon,lay)  * abso3b(ig) <a name='4645'>
<font color=#447700>!            ssa(lay,ngs24+ig) = tauray/taug(lay,ngs24+ig)<a name='4646'></font>
            taur(iplon,lay,ngs24+ig)  = tauray<a name='4647'>
         enddo<a name='4648'>
#ifdef _ACCEL<a name='4649'>
#else<a name='4650'>
# undef laysolfr<a name='4651'>
      endif<a name='4652'>
#endif<a name='4653'>
      enddo<a name='4654'>
      enddo<a name='4655'>
      <a name='4656'>
<font color=#447700>!$acc end kernels<a name='4657'></font>
# undef ncol<a name='4658'>
      end subroutine taumol25<a name='4659'>
<a name='4660'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4661'></font>
<A NAME='TAUMOL26'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL26' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4662'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol26</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL26.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL26.html' TARGET='index'>4</A><a name='4663'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='4664'>
                          laytrop, jp, jt, jt1, &amp;<a name='4665'>
                          fac00, fac01, fac10, fac11, &amp;<a name='4666'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='4667'>
                          sfluxzen, taug, taur)<a name='4668'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4669'></font>
<font color=#447700>!<a name='4670'></font>
<font color=#447700>!     band 26:  22650-29000 cm-1 (low - nothing; high - nothing)<a name='4671'></font>
<font color=#447700>!<a name='4672'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4673'></font>
<a name='4674'>
<font color=#447700>! ------- Modules -------<a name='4675'></font>
<a name='4676'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_30">, only : ng26, ngs25<a name='4677'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG26_F'>rrsw_kg26_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG26_F_1">, only : sfluxref, rayl<a name='4678'>
<a name='4679'>
<font color=#447700>! ------- Declarations -------<a name='4680'></font>
      integer , intent(in) :: ncol<a name='4681'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='4682'></font>
<a name='4683'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='4684'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='4685'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='4686'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='4687'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4688'></font>
<a name='4689'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='4690'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='4691'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='4692'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='4693'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='4694'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='4695'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4696'></font>
<a name='4697'>
      integer , intent(in) :: indself(:,:)     <a name='4698'>
      integer , intent(in) :: indfor(:,:) <a name='4699'>
      real , intent(in) :: selffac(:,:) <a name='4700'>
      real , intent(in) :: selffrac(:,:) <a name='4701'>
      real , intent(in) :: forfac(:,:) <a name='4702'>
      real , intent(in) :: forfrac(:,:) <a name='4703'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4704'></font>
<a name='4705'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='4706'></font>
                       fac00(:,:) , fac01(:,:) , &amp;  <a name='4707'>
                       fac10(:,:) , fac11(:,:)  <a name='4708'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4709'></font>
<a name='4710'>
<font color=#447700>! ----- Output -----<a name='4711'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='4712'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='4713'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='4714'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='4715'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='4716'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='4717'></font>
<a name='4718'>
<font color=#447700>! Local<a name='4719'></font>
#ifdef _ACCEL<a name='4720'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='4721'>
#else<a name='4722'>
# define ncol CHNK<a name='4723'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr(ncol)<a name='4724'>
#endif<a name='4725'>
<a name='4726'>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4727'>
                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4728'>
                  tauray<a name='4729'>
      integer :: iplon<a name='4730'>
<a name='4731'>
#ifdef _ACCEL<a name='4732'>
<font color=#447700>!$acc kernels <a name='4733'></font>
      do iplon=1,ncol<a name='4734'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4735'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4736'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4737'></font>
<a name='4738'>
      laysolfr = laytrop(iplon) <a name='4739'>
<a name='4740'>
<font color=#447700>! Lower atmosphere loop<a name='4741'></font>
      do lay = 1, laytrop(iplon) <a name='4742'>
#else<a name='4743'>
      laysolfr = laytrop<a name='4744'>
# define laysolfr LAYSOLFR(iplon)<a name='4745'>
      do lay = 1, nlayers<a name='4746'>
        do iplon = 1, ncol<a name='4747'>
          if (lay &lt;= laytrop(iplon)) then<a name='4748'>
#endif<a name='4749'>
         do ig = 1, ng26 <a name='4750'>
<font color=#447700>!            taug(lay,ngs25+ig) = colmol(lay) * rayl(ig)<a name='4751'></font>
<font color=#447700>!            ssa(lay,ngs25+ig) = 1.0 <a name='4752'></font>
            if (lay .eq. laysolfr) sfluxzen(iplon,ngs25+ig)  = sfluxref(ig) <a name='4753'>
            taug(iplon,lay,ngs25+ig)  = 0. <a name='4754'>
            taur(iplon,lay,ngs25+ig)  = colmol(iplon,lay)  * rayl(ig) <a name='4755'>
         enddo<a name='4756'>
#ifdef _ACCEL<a name='4757'>
      enddo<a name='4758'>
      do lay = laytrop(iplon) +1, nlayers<a name='4759'>
#else<a name='4760'>
      else<a name='4761'>
#endif<a name='4762'>
<a name='4763'>
<font color=#447700>! Upper atmosphere loop<a name='4764'></font>
         do ig = 1, ng26<a name='4765'>
<font color=#447700>!            taug(lay,ngs25+ig) = colmol(lay) * rayl(ig)<a name='4766'></font>
<font color=#447700>!            ssa(lay,ngs25+ig) = 1.0 <a name='4767'></font>
            taug(iplon,lay,ngs25+ig)  = 0. <a name='4768'>
            taur(iplon,lay,ngs25+ig)  = colmol(iplon,lay)  * rayl(ig) <a name='4769'>
         enddo<a name='4770'>
#ifdef _ACCEL<a name='4771'>
#else<a name='4772'>
# undef laysolfr<a name='4773'>
      endif<a name='4774'>
#endif<a name='4775'>
      enddo<a name='4776'>
      enddo<a name='4777'>
      <a name='4778'>
<font color=#447700>!$acc end kernels<a name='4779'></font>
# undef ncol<a name='4780'>
      end subroutine taumol26<a name='4781'>
<a name='4782'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4783'></font>
<A NAME='TAUMOL27'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL27' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4784'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol27</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL27.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL27.html' TARGET='index'>4</A><a name='4785'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='4786'>
                          laytrop, jp, jt, jt1, &amp;<a name='4787'>
                          fac00, fac01, fac10, fac11, &amp;<a name='4788'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='4789'>
                          sfluxzen, taug, taur)<a name='4790'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4791'></font>
<font color=#447700>!<a name='4792'></font>
<font color=#447700>!     band 27:  29000-38000 cm-1 (low - o3; high - o3)<a name='4793'></font>
<font color=#447700>!<a name='4794'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4795'></font>
<a name='4796'>
<font color=#447700>! ------- Modules -------<a name='4797'></font>
<a name='4798'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_31">, only : ng27, ngs26<a name='4799'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG27_F'>rrsw_kg27_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG27_F_1">, only : absa, ka, absb, kb, &amp;<a name='4800'>
                            sfluxref, rayl, layreffr, scalekur<a name='4801'>
<font color=#447700>!      use rrsw_kg27_f, only : absa, ka, absb, kb, sfluxref, rayl<a name='4802'></font>
<a name='4803'>
<font color=#447700>! ------- Declarations -------<a name='4804'></font>
      integer , intent(in) :: ncol<a name='4805'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='4806'></font>
<a name='4807'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='4808'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='4809'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='4810'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='4811'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4812'></font>
<a name='4813'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='4814'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='4815'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='4816'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='4817'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='4818'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='4819'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4820'></font>
<a name='4821'>
      integer , intent(in) :: indself(:,:)     <a name='4822'>
      integer , intent(in) :: indfor(:,:) <a name='4823'>
      real , intent(in) :: selffac(:,:) <a name='4824'>
      real , intent(in) :: selffrac(:,:) <a name='4825'>
      real , intent(in) :: forfac(:,:) <a name='4826'>
      real , intent(in) :: forfrac(:,:) <a name='4827'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4828'></font>
<a name='4829'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='4830'></font>
                       fac00(:,:) , fac01(:,:) , &amp;  <a name='4831'>
                       fac10(:,:) , fac11(:,:)  <a name='4832'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4833'></font>
<a name='4834'>
<font color=#447700>! ----- Output -----<a name='4835'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='4836'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='4837'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='4838'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='4839'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='4840'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='4841'></font>
<a name='4842'>
<font color=#447700>! Local<a name='4843'></font>
#ifdef _ACCEL<a name='4844'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='4845'>
#else<a name='4846'>
# define ncol CHNK<a name='4847'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr(ncol)<a name='4848'>
#endif<a name='4849'>
<a name='4850'>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4851'>
                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4852'>
                  tauray<a name='4853'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='4854'></font>
<font color=#447700>!                  layreffr<a name='4855'></font>
<font color=#447700>!      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='4856'></font>
<font color=#447700>!                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='4857'></font>
<font color=#447700>!                  tauray, scalekur<a name='4858'></font>
      integer :: iplon<a name='4859'>
       <a name='4860'>
#ifdef _ACCEL<a name='4861'>
<font color=#447700>!$acc kernels <a name='4862'></font>
      do iplon=1,ncol<a name='4863'>
<font color=#447700>! Kurucz solar source function<a name='4864'></font>
<font color=#447700>! The values in sfluxref were obtained using the "low resolution"<a name='4865'></font>
<font color=#447700>! version of the Kurucz solar source function.  For unknown reasons,<a name='4866'></font>
<font color=#447700>! the total irradiance in this band differs from the corresponding<a name='4867'></font>
<font color=#447700>! total in the "high-resolution" version of the Kurucz function.<a name='4868'></font>
<font color=#447700>! Therefore, these values are scaled below by the factor SCALEKUR.<a name='4869'></font>
<a name='4870'>
<font color=#447700>!      scalekur = 50.15 /48.37 <a name='4871'></font>
<a name='4872'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='4873'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='4874'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='4875'></font>
<a name='4876'>
<font color=#447700>!      layreffr = 32<a name='4877'></font>
<a name='4878'>
<font color=#447700>! Lower atmosphere loop<a name='4879'></font>
      do lay = 1, laytrop(iplon) <a name='4880'>
#else<a name='4881'>
      laysolfr = nlayers<a name='4882'>
# define laysolfr LAYSOLFR(iplon)<a name='4883'>
      do lay = 1, nlayers<a name='4884'>
        do iplon = 1, ncol<a name='4885'>
          if (lay &lt;= laytrop(iplon)) then<a name='4886'>
#endif<a name='4887'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(27) + 1<a name='4888'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(27) + 1<a name='4889'>
<a name='4890'>
         do ig = 1, ng27<a name='4891'>
            tauray = colmol(iplon,lay)  * rayl(ig)<a name='4892'>
            taug(iplon,lay,ngs26+ig)  = colo3(iplon,lay)  * &amp;<a name='4893'>
                (fac00(iplon,lay)  * absa(ind0,ig) + &amp;<a name='4894'>
                 fac10(iplon,lay)  * absa(ind0+1,ig) + &amp;<a name='4895'>
                 fac01(iplon,lay)  * absa(ind1,ig) + &amp;<a name='4896'>
                 fac11(iplon,lay)  * absa(ind1+1,ig))<a name='4897'>
<font color=#447700>!            ssa(lay,ngs26+ig) = tauray/taug(lay,ngs26+ig)<a name='4898'></font>
            taur(iplon,lay,ngs26+ig)  = tauray<a name='4899'>
         enddo<a name='4900'>
#ifdef _ACCEL<a name='4901'>
      enddo<a name='4902'>
<a name='4903'>
      laysolfr = nlayers<a name='4904'>
<a name='4905'>
<font color=#447700>! Upper atmosphere loop<a name='4906'></font>
      do lay = laytrop(iplon) +1, nlayers<a name='4907'>
#else<a name='4908'>
      else<a name='4909'>
#endif<a name='4910'>
         if (jp(iplon,lay-1)  .lt. layreffr .and. jp(iplon,lay)  .ge. layreffr) &amp;<a name='4911'>
            laysolfr = lay<a name='4912'>
         ind0 = ((jp(iplon,lay) -13)*5+(jt(iplon,lay) -1))*nspb(27) + 1<a name='4913'>
         ind1 = ((jp(iplon,lay) -12)*5+(jt1(iplon,lay) -1))*nspb(27) + 1<a name='4914'>
<a name='4915'>
         do ig = 1, ng27<a name='4916'>
            tauray = colmol(iplon,lay)  * rayl(ig)<a name='4917'>
            taug(iplon,lay,ngs26+ig)  = colo3(iplon,lay)  * &amp;<a name='4918'>
                (fac00(iplon,lay)  * absb(ind0,ig) + &amp;<a name='4919'>
                 fac10(iplon,lay)  * absb(ind0+1,ig) + &amp;<a name='4920'>
                 fac01(iplon,lay)  * absb(ind1,ig) + &amp; <a name='4921'>
                 fac11(iplon,lay)  * absb(ind1+1,ig))<a name='4922'>
<font color=#447700>!            ssa(lay,ngs26+ig) = tauray/taug(lay,ngs26+ig)<a name='4923'></font>
            if (lay.eq.laysolfr) sfluxzen(iplon,ngs26+ig)  = scalekur * sfluxref(ig) <a name='4924'>
            taur(iplon,lay,ngs26+ig)  = tauray<a name='4925'>
         enddo<a name='4926'>
#ifdef _ACCEL<a name='4927'>
#else<a name='4928'>
# undef laysolfr<a name='4929'>
      endif<a name='4930'>
#endif<a name='4931'>
      enddo<a name='4932'>
      enddo<a name='4933'>
      <a name='4934'>
<font color=#447700>!$acc end kernels<a name='4935'></font>
# undef ncol<a name='4936'>
      end subroutine taumol27<a name='4937'>
<a name='4938'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4939'></font>
<A NAME='TAUMOL28'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL28' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='4940'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol28</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL28.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL28.html' TARGET='index'>4</A><a name='4941'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='4942'>
                          laytrop, jp, jt, jt1, &amp;<a name='4943'>
                          fac00, fac01, fac10, fac11, &amp;<a name='4944'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='4945'>
                          sfluxzen, taug, taur)<a name='4946'>
<font color=#447700>!----------------------------------------------------------------------------<a name='4947'></font>
<font color=#447700>!<a name='4948'></font>
<font color=#447700>!     band 28:  38000-50000 cm-1 (low - o3,o2; high - o3,o2)<a name='4949'></font>
<font color=#447700>!<a name='4950'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='4951'></font>
<a name='4952'>
<font color=#447700>! ------- Modules -------<a name='4953'></font>
<a name='4954'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_32">, only : ng28, ngs27<a name='4955'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG28_F'>rrsw_kg28_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG28_F_1">, only : absa, ka, absb, kb, &amp;<a name='4956'>
                            sfluxref, rayl, layreffr, strrat<a name='4957'>
<font color=#447700>!      use rrsw_kg28_f, only : absa, ka, absb, kb, sfluxref, rayl<a name='4958'></font>
<a name='4959'>
<font color=#447700>! ------- Declarations -------<a name='4960'></font>
      integer , intent(in) :: ncol<a name='4961'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='4962'></font>
<a name='4963'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='4964'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='4965'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='4966'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='4967'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4968'></font>
<a name='4969'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='4970'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='4971'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='4972'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='4973'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='4974'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='4975'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4976'></font>
<a name='4977'>
      integer , intent(in) :: indself(:,:)     <a name='4978'>
      integer , intent(in) :: indfor(:,:) <a name='4979'>
      real , intent(in) :: selffac(:,:) <a name='4980'>
      real , intent(in) :: selffrac(:,:) <a name='4981'>
      real , intent(in) :: forfac(:,:) <a name='4982'>
      real , intent(in) :: forfrac(:,:) <a name='4983'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4984'></font>
<a name='4985'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='4986'></font>
                       fac00(:,:) , fac01(:,:) , &amp; <a name='4987'>
                       fac10(:,:) , fac11(:,:)  <a name='4988'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='4989'></font>
<a name='4990'>
<font color=#447700>! ----- Output -----<a name='4991'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='4992'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='4993'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='4994'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='4995'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='4996'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='4997'></font>
<a name='4998'>
<font color=#447700>! Local<a name='4999'></font>
#ifdef _ACCEL<a name='5000'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='5001'>
#else<a name='5002'>
# define ncol CHNK<a name='5003'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr(ncol)<a name='5004'>
#endif<a name='5005'>
<a name='5006'>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='5007'>
                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='5008'>
                  tauray<a name='5009'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='5010'></font>
<font color=#447700>!                  layreffr<a name='5011'></font>
<font color=#447700>!      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='5012'></font>
<font color=#447700>!                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='5013'></font>
<font color=#447700>!                  tauray, strrat<a name='5014'></font>
      integer :: iplon<a name='5015'>
<a name='5016'>
#ifdef _ACCEL<a name='5017'>
<font color=#447700>!$acc kernels <a name='5018'></font>
      do iplon=1,ncol<a name='5019'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='5020'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='5021'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='5022'></font>
<a name='5023'>
<font color=#447700>!      strrat = 6.67029e-07 <a name='5024'></font>
<font color=#447700>!      layreffr = 58<a name='5025'></font>
<a name='5026'>
<font color=#447700>! Lower atmosphere loop<a name='5027'></font>
      do lay = 1, laytrop(iplon) <a name='5028'>
#else<a name='5029'>
      laysolfr = nlayers<a name='5030'>
# define laysolfr LAYSOLFR(iplon)<a name='5031'>
      do lay = 1, nlayers<a name='5032'>
        do iplon = 1, ncol<a name='5033'>
          if (lay &lt;= laytrop(iplon)) then<a name='5034'>
#endif<a name='5035'>
         speccomb = colo3(iplon,lay)  + strrat*colo2(iplon,lay) <a name='5036'>
         specparm = colo3(iplon,lay) /speccomb <a name='5037'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='5038'>
         specmult = 8. *(specparm)<a name='5039'>
         js = 1 + int(specmult)<a name='5040'>
         fs = mod(specmult, 1.  )<a name='5041'>
         fac000 = (1.  - fs) * fac00(iplon,lay) <a name='5042'>
         fac010 = (1.  - fs) * fac10(iplon,lay) <a name='5043'>
         fac100 = fs * fac00(iplon,lay) <a name='5044'>
         fac110 = fs * fac10(iplon,lay) <a name='5045'>
         fac001 = (1.  - fs) * fac01(iplon,lay) <a name='5046'>
         fac011 = (1.  - fs) * fac11(iplon,lay) <a name='5047'>
         fac101 = fs * fac01(iplon,lay) <a name='5048'>
         fac111 = fs * fac11(iplon,lay) <a name='5049'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(28) + js<a name='5050'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(28) + js<a name='5051'>
         tauray = colmol(iplon,lay)  * rayl<a name='5052'>
<a name='5053'>
         do ig = 1, ng28<a name='5054'>
            taug(iplon,lay,ngs27+ig)  = speccomb * &amp;<a name='5055'>
                (fac000 * absa(ind0,ig) + &amp;<a name='5056'>
                 fac100 * absa(ind0+1,ig) + &amp;<a name='5057'>
                 fac010 * absa(ind0+9,ig) + &amp;<a name='5058'>
                 fac110 * absa(ind0+10,ig) + &amp;<a name='5059'>
                 fac001 * absa(ind1,ig) + &amp;<a name='5060'>
                 fac101 * absa(ind1+1,ig) + &amp;<a name='5061'>
                 fac011 * absa(ind1+9,ig) + &amp;<a name='5062'>
                 fac111 * absa(ind1+10,ig)) <a name='5063'>
<font color=#447700>!            ssa(lay,ngs27+ig) = tauray/taug(lay,ngs27+ig)<a name='5064'></font>
            taur(iplon,lay,ngs27+ig)  = tauray<a name='5065'>
         enddo<a name='5066'>
#ifdef _ACCEL<a name='5067'>
      enddo<a name='5068'>
<a name='5069'>
      laysolfr = nlayers<a name='5070'>
<a name='5071'>
<font color=#447700>! Upper atmosphere loop<a name='5072'></font>
      do lay = laytrop(iplon) +1, nlayers<a name='5073'>
#else<a name='5074'>
      else<a name='5075'>
#endif<a name='5076'>
         if (jp(iplon,lay-1)  .lt. layreffr .and. jp(iplon,lay)  .ge. layreffr) &amp;<a name='5077'>
            laysolfr = lay<a name='5078'>
         speccomb = colo3(iplon,lay)  + strrat*colo2(iplon,lay) <a name='5079'>
         specparm = colo3(iplon,lay) /speccomb <a name='5080'>
         if (specparm .ge. oneminus) specparm = oneminus<a name='5081'>
         specmult = 4. *(specparm)<a name='5082'>
         js = 1 + int(specmult)<a name='5083'>
         fs = mod(specmult, 1.  )<a name='5084'>
         fac000 = (1.  - fs) * fac00(iplon,lay) <a name='5085'>
         fac010 = (1.  - fs) * fac10(iplon,lay) <a name='5086'>
         fac100 = fs * fac00(iplon,lay) <a name='5087'>
         fac110 = fs * fac10(iplon,lay) <a name='5088'>
         fac001 = (1.  - fs) * fac01(iplon,lay) <a name='5089'>
         fac011 = (1.  - fs) * fac11(iplon,lay) <a name='5090'>
         fac101 = fs * fac01(iplon,lay) <a name='5091'>
         fac111 = fs * fac11(iplon,lay) <a name='5092'>
         ind0 = ((jp(iplon,lay) -13)*5+(jt(iplon,lay) -1))*nspb(28) + js<a name='5093'>
         ind1 = ((jp(iplon,lay) -12)*5+(jt1(iplon,lay) -1))*nspb(28) + js<a name='5094'>
         tauray = colmol(iplon,lay)  * rayl<a name='5095'>
<a name='5096'>
         do ig = 1, ng28<a name='5097'>
            taug(iplon,lay,ngs27+ig)  = speccomb * &amp;<a name='5098'>
                (fac000 * absb(ind0,ig) + &amp;<a name='5099'>
                 fac100 * absb(ind0+1,ig) + &amp;<a name='5100'>
                 fac010 * absb(ind0+5,ig) + &amp;<a name='5101'>
                 fac110 * absb(ind0+6,ig) + &amp;<a name='5102'>
                 fac001 * absb(ind1,ig) + &amp;<a name='5103'>
                 fac101 * absb(ind1+1,ig) + &amp;<a name='5104'>
                 fac011 * absb(ind1+5,ig) + &amp;<a name='5105'>
                 fac111 * absb(ind1+6,ig)) <a name='5106'>
<font color=#447700>!            ssa(lay,ngs27+ig) = tauray/taug(lay,ngs27+ig)<a name='5107'></font>
            if (lay .eq. laysolfr) sfluxzen(iplon,ngs27+ig)  = sfluxref(ig,js) &amp;<a name='5108'>
               + fs * (sfluxref(ig,js+1) - sfluxref(ig,js))<a name='5109'>
            taur(iplon,lay,ngs27+ig)  = tauray<a name='5110'>
         enddo<a name='5111'>
#ifdef _ACCEL<a name='5112'>
#else<a name='5113'>
# undef laysolfr<a name='5114'>
      endif<a name='5115'>
#endif<a name='5116'>
      enddo<a name='5117'>
      enddo<a name='5118'>
      <a name='5119'>
<font color=#447700>!$acc end kernels<a name='5120'></font>
# undef ncol<a name='5121'>
      end subroutine taumol28<a name='5122'>
<a name='5123'>
<font color=#447700>!----------------------------------------------------------------------------<a name='5124'></font>
<A NAME='TAUMOL29'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL29' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5125'>
      <font color=#993300>subroutine </font><font color=#cc0000>taumol29</font>(ncol, nlayers, &amp; <A href='../../call_to/TAUMOL29.html' TARGET='index'>2</A>,<A href='../../call_from/TAUMOL29.html' TARGET='index'>4</A><a name='5126'>
                          colh2o, colco2, colch4, colo2, colo3, colmol, &amp;<a name='5127'>
                          laytrop, jp, jt, jt1, &amp;<a name='5128'>
                          fac00, fac01, fac10, fac11, &amp;<a name='5129'>
                          selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='5130'>
                          sfluxzen, taug, taur)<a name='5131'>
<font color=#447700>!----------------------------------------------------------------------------<a name='5132'></font>
<font color=#447700>!<a name='5133'></font>
<font color=#447700>!     band 29:  820-2600 cm-1 (low - h2o; high - co2)<a name='5134'></font>
<font color=#447700>!<a name='5135'></font>
<font color=#447700>!----------------------------------------------------------------------------<a name='5136'></font>
<a name='5137'>
<font color=#447700>! ------- Modules -------<a name='5138'></font>
<a name='5139'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_33">, only : ng29, ngs28<a name='5140'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG29_F'>rrsw_kg29_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG29_F_1">, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='5141'>
                            sfluxref, absh2o, absco2, rayl, layreffr<a name='5142'>
<font color=#447700>!      use rrsw_kg29_f, only : absa, ka, absb, kb, forref, selfref, &amp;<a name='5143'></font>
<font color=#447700>!                            sfluxref, absh2o, absco2, rayl<a name='5144'></font>
<a name='5145'>
<font color=#447700>! ------- Declarations -------<a name='5146'></font>
      integer , intent(in) :: ncol<a name='5147'>
      integer , intent(in) :: nlayers               <font color=#447700>! total number of layers<a name='5148'></font>
<a name='5149'>
      integer , intent(in) :: laytrop(:)            <font color=#447700>! tropopause layer index<a name='5150'></font>
      integer , intent(in) :: jp(:,:)               <font color=#447700>! <a name='5151'></font>
      integer , intent(in) :: jt(:,:)               <font color=#447700>!<a name='5152'></font>
      integer , intent(in) :: jt1(:,:)              <font color=#447700>!<a name='5153'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='5154'></font>
<a name='5155'>
      real , intent(in) :: colh2o(:,:)              <font color=#447700>! column amount (h2o)<a name='5156'></font>
      real , intent(in) :: colco2(:,:)              <font color=#447700>! column amount (co2)<a name='5157'></font>
      real , intent(in) :: colo3(:,:)               <font color=#447700>! column amount (o3)<a name='5158'></font>
      real , intent(in) :: colch4(:,:)              <font color=#447700>! column amount (ch4)<a name='5159'></font>
      real , intent(in) :: colo2(:,:)               <font color=#447700>! column amount (o2)<a name='5160'></font>
      real , intent(in) :: colmol(:,:)              <font color=#447700>! <a name='5161'></font>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='5162'></font>
<a name='5163'>
      integer , intent(in) :: indself(:,:)     <a name='5164'>
      integer , intent(in) :: indfor(:,:) <a name='5165'>
      real , intent(in) :: selffac(:,:) <a name='5166'>
      real , intent(in) :: selffrac(:,:) <a name='5167'>
      real , intent(in) :: forfac(:,:) <a name='5168'>
      real , intent(in) :: forfrac(:,:) <a name='5169'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='5170'></font>
<a name='5171'>
      real , intent(in) :: &amp;                        <font color=#447700>!<a name='5172'></font>
                       fac00(:,:) , fac01(:,:) , &amp;  <a name='5173'>
                       fac10(:,:) , fac11(:,:)  <a name='5174'>
                                                    <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='5175'></font>
<a name='5176'>
<font color=#447700>! ----- Output -----<a name='5177'></font>
      real, intent(out) gpu_device :: sfluxzen(:,:)      <font color=#447700>! solar source function<a name='5178'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,ngptsw)<a name='5179'></font>
      real, intent(out) gpu_device :: taug(:,:,:)        <font color=#447700>! gaseous optical depth <a name='5180'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='5181'></font>
      real, intent(out) gpu_device :: taur(:,:,:)        <font color=#447700>! Rayleigh <a name='5182'></font>
                                                         <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='5183'></font>
<a name='5184'>
<font color=#447700>! Local<a name='5185'></font>
#ifdef _ACCEL<a name='5186'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr<a name='5187'>
#else<a name='5188'>
# define ncol CHNK<a name='5189'>
      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr(ncol)<a name='5190'>
#endif<a name='5191'>
<a name='5192'>
<font color=#447700>!      integer  :: ig, ind0, ind1, inds, indf, js, lay, laysolfr, &amp;<a name='5193'></font>
<font color=#447700>!                  layreffr<a name='5194'></font>
      real  :: fac000, fac001, fac010, fac011, fac100, fac101, &amp;<a name='5195'>
                  fac110, fac111, fs, speccomb, specmult, specparm, &amp;<a name='5196'>
                  tauray<a name='5197'>
      integer :: iplon<a name='5198'>
<a name='5199'>
<font color=#447700>!      layreffr = 49  <a name='5200'></font>
        <a name='5201'>
#ifdef _ACCEL<a name='5202'>
<font color=#447700>!$acc kernels loop independent private (laysolfr)<a name='5203'></font>
      do iplon=1,ncol<a name='5204'>
        <a name='5205'>
        laysolfr = nlayers<a name='5206'>
<font color=#447700>!$acc loop seq<a name='5207'></font>
        do lay = laytrop(iplon) +1, nlayers<a name='5208'>
#else<a name='5209'>
      laysolfr = nlayers<a name='5210'>
# define laysolfr LAYSOLFR(iplon)<a name='5211'>
      do lay = 1, nlayers<a name='5212'>
        do iplon = 1, ncol<a name='5213'>
          if (lay &gt; laytrop(iplon)) then<a name='5214'>
#endif<a name='5215'>
         if (jp(iplon,lay-1)  .lt. layreffr .and. jp(iplon,lay)  .ge. layreffr) &amp;<a name='5216'>
            laysolfr = lay<a name='5217'>
<a name='5218'>
            if (lay .eq. laysolfr) then <a name='5219'>
                do ig = 1, ng29<a name='5220'>
                sfluxzen(iplon,ngs28+ig)  = sfluxref(ig) <a name='5221'>
                end do<a name='5222'>
            end if<a name='5223'>
#ifdef _ACCEL<a name='5224'>
#else<a name='5225'>
# undef laysolfr<a name='5226'>
         endif<a name='5227'>
#endif<a name='5228'>
        end do<a name='5229'>
      end do<a name='5230'>
<font color=#447700>!$acc end kernels<a name='5231'></font>
       <a name='5232'>
#ifdef _ACCEL<a name='5233'>
<font color=#447700>!$acc kernels <a name='5234'></font>
      do iplon=1,ncol<a name='5235'>
<font color=#447700>! Compute the optical depth by interpolating in ln(pressure), <a name='5236'></font>
<font color=#447700>! temperature, and appropriate species.  Below LAYTROP, the water<a name='5237'></font>
<font color=#447700>! vapor self-continuum is interpolated (in temperature) separately.  <a name='5238'></font>
<a name='5239'>
<font color=#447700>! Lower atmosphere loop<a name='5240'></font>
      do lay = 1, nlayers <a name='5241'>
#else<a name='5242'>
    do lay = 1, nlayers <a name='5243'>
      do iplon=1,ncol<a name='5244'>
#endif<a name='5245'>
         if (lay &lt;= laytrop(iplon)) then<a name='5246'>
         ind0 = ((jp(iplon,lay) -1)*5+(jt(iplon,lay) -1))*nspa(29) + 1<a name='5247'>
         ind1 = (jp(iplon,lay) *5+(jt1(iplon,lay) -1))*nspa(29) + 1<a name='5248'>
         inds = indself(iplon,lay) <a name='5249'>
         indf = indfor(iplon,lay) <a name='5250'>
         tauray = colmol(iplon,lay)  * rayl<a name='5251'>
<a name='5252'>
         do ig = 1, ng29<a name='5253'>
            taug(iplon,lay,ngs28+ig)  = colh2o(iplon,lay)  * &amp;<a name='5254'>
               ((fac00(iplon,lay)  * absa(ind0,ig) + &amp;<a name='5255'>
                 fac10(iplon,lay)  * absa(ind0+1,ig) + &amp;<a name='5256'>
                 fac01(iplon,lay)  * absa(ind1,ig) + &amp;<a name='5257'>
                 fac11(iplon,lay)  * absa(ind1+1,ig)) + &amp;<a name='5258'>
                 selffac(iplon,lay)  * (selfref(inds,ig) + &amp;<a name='5259'>
                 selffrac(iplon,lay)  * &amp;<a name='5260'>
                 (selfref(inds+1,ig) - selfref(inds,ig))) + &amp;<a name='5261'>
                 forfac(iplon,lay)  * (forref(indf,ig) + &amp; <a name='5262'>
                 forfrac(iplon,lay)  * &amp;<a name='5263'>
                 (forref(indf+1,ig) - forref(indf,ig)))) &amp;<a name='5264'>
                 + colco2(iplon,lay)  * absco2(ig) <a name='5265'>
<font color=#447700>!            ssa(lay,ngs28+ig) = tauray/taug(lay,ngs28+ig)<a name='5266'></font>
            taur(iplon,lay,ngs28+ig)  = tauray<a name='5267'>
         enddo<a name='5268'>
<a name='5269'>
         else <a name='5270'>
<a name='5271'>
<font color=#447700>! Upper atmosphere loop<a name='5272'></font>
         ind0 = ((jp(iplon,lay) -13)*5+(jt(iplon,lay) -1))*nspb(29) + 1<a name='5273'>
         ind1 = ((jp(iplon,lay) -12)*5+(jt1(iplon,lay) -1))*nspb(29) + 1<a name='5274'>
         tauray = colmol(iplon,lay)  * rayl<a name='5275'>
<a name='5276'>
         do ig = 1, ng29<a name='5277'>
            taug(iplon,lay,ngs28+ig)  = colco2(iplon,lay)  * &amp;<a name='5278'>
                (fac00(iplon,lay)  * absb(ind0,ig) + &amp;<a name='5279'>
                 fac10(iplon,lay)  * absb(ind0+1,ig) + &amp;<a name='5280'>
                 fac01(iplon,lay)  * absb(ind1,ig) + &amp;<a name='5281'>
                 fac11(iplon,lay)  * absb(ind1+1,ig)) &amp;  <a name='5282'>
                 + colh2o(iplon,lay)  * absh2o(ig) <a name='5283'>
<font color=#447700>!            ssa(lay,ngs28+ig) = tauray/taug(lay,ngs28+ig)<a name='5284'></font>
        <a name='5285'>
            taur(iplon,lay,ngs28+ig)  = tauray<a name='5286'>
         enddo<a name='5287'>
         end if<a name='5288'>
<a name='5289'>
      enddo<a name='5290'>
      enddo<a name='5291'>
      <a name='5292'>
<font color=#447700>!$acc end kernels<a name='5293'></font>
# undef ncol<a name='5294'>
      end subroutine taumol29<a name='5295'>
<a name='5296'>
# undef IKLOOP1_S<a name='5297'>
# undef IKLOOP1_E<a name='5298'>
# undef IKLOOP2_S <a name='5299'>
# undef IKLOOP2_E<a name='5300'>
<a name='5301'>
      end module rrtmg_sw_taumol_f<a name='5302'>
<a name='5303'>
<A NAME='RRTMG_SW_INIT_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INIT_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='5304'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_init_f</font> <A href='../../call_to/RRTMG_SW_INIT_F.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_INIT_F.html' TARGET='index'>2</A><a name='5305'>
<a name='5306'>
<font color=#447700>! ------- Modules -------<a name='5307'></font>
<a name='5308'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_WVN_F'>rrsw_wvn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INIT_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_F_4"><a name='5309'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SETCOEF_F'>rrtmg_sw_setcoef_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INIT_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_SETCOEF_F_1">, only: swatmref<a name='5310'>
      <a name='5311'>
      implicit none<a name='5312'>
<a name='5313'>
      public rrtmg_sw_ini<a name='5314'>
      <a name='5315'>
      contains<a name='5316'>
<a name='5317'>
<font color=#447700>! **************************************************************************<a name='5318'></font>
<A NAME='RRTMG_SW_INI'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5319'>
      <font color=#993300>subroutine </font><font color=#cc0000>rrtmg_sw_ini</font>(cpdair) <A href='../../call_to/RRTMG_SW_INI.html' TARGET='index'>2</A>,<A href='../../call_from/RRTMG_SW_INI.html' TARGET='index'>44</A><a name='5320'>
<font color=#447700>! **************************************************************************<a name='5321'></font>
<font color=#447700>!<a name='5322'></font>
<font color=#447700>!  Original version:   Michael J. Iacono; February, 2004<a name='5323'></font>
<font color=#447700>!  Revision for F90 formatting:  M. J. Iacono, July, 2006<a name='5324'></font>
<font color=#447700>!<a name='5325'></font>
<font color=#447700>!  This subroutine performs calculations necessary for the initialization<a name='5326'></font>
<font color=#447700>!  of the shortwave model.  Lookup tables are computed for use in the SW<a name='5327'></font>
<font color=#447700>!  radiative transfer, and input absorption coefficient data for each<a name='5328'></font>
<font color=#447700>!  spectral band are reduced from 224 g-point intervals to 112.<a name='5329'></font>
<font color=#447700>! **************************************************************************<a name='5330'></font>
<a name='5331'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_34">, only : mg, nbndsw, ngptsw<a name='5332'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_TBL_F'>rrsw_tbl_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_TBL_F_1">, only: ntbl, tblint, pade, bpade, tau_tbl, exp_tbl<a name='5333'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_VSN_F'>rrsw_vsn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_F_5">, only: hvrini, hnamini<a name='5334'>
<a name='5335'>
      real , intent(in) :: cpdair     <font color=#447700>! Specific heat capacity of dry air<a name='5336'></font>
                                      <font color=#447700>! at constant pressure at 273 K<a name='5337'></font>
                                      <font color=#447700>! (J kg-1 K-1)<a name='5338'></font>
<a name='5339'>
<font color=#447700>! ------- Local -------<a name='5340'></font>
<a name='5341'>
      integer  :: ibnd, igc, ig, ind, ipr<a name='5342'>
      integer  :: igcsm, iprsm<a name='5343'>
      integer  :: itr<a name='5344'>
<a name='5345'>
      real  :: wtsum, wtsm(mg)<a name='5346'>
      real  :: tfn<a name='5347'>
<a name='5348'>
      real , parameter :: expeps = 1.e-20    <font color=#447700>! Smallest value for exponential table<a name='5349'></font>
<a name='5350'>
<font color=#447700>! ------- Definitions -------<a name='5351'></font>
<font color=#447700>!     Arrays for 10000-point look-up tables:<a name='5352'></font>
<font color=#447700>!     TAU_TBL  Clear-sky optical depth <a name='5353'></font>
<font color=#447700>!     EXP_TBL  Exponential lookup table for transmittance<a name='5354'></font>
<font color=#447700>!     PADE     Pade approximation constant (= 0.278)<a name='5355'></font>
<font color=#447700>!     BPADE    Inverse of the Pade approximation constant<a name='5356'></font>
<font color=#447700>!<a name='5357'></font>
<a name='5358'>
      hvrini = '$Revision: 1.5 $'<a name='5359'>
<a name='5360'>
<font color=#447700>! Initialize model data<a name='5361'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWDATINIT'>swdatinit</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SWDATINIT_2">(cpdair)<a name='5362'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWCMBDAT'>swcmbdat</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SWCMBDAT_2">              <font color=#447700>! g-point interval reduction data<a name='5363'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWAERPR'>swaerpr</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SWAERPR_2">               <font color=#447700>! aerosol optical properties<a name='5364'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWCLDPR'>swcldpr</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SWCLDPR_2">               <font color=#447700>! cloud optical properties<a name='5365'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWATMREF'>swatmref</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SWATMREF_2">              <font color=#447700>! reference MLS profile<a name='5366'></font>
<font color=#447700>! Moved to module_ra_rrtmg_swf for WRF<a name='5367'></font>
<font color=#447700>!      call sw_kgb16              ! molecular absorption coefficients<a name='5368'></font>
<font color=#447700>!      call sw_kgb17<a name='5369'></font>
<font color=#447700>!      call sw_kgb18<a name='5370'></font>
<font color=#447700>!      call sw_kgb19<a name='5371'></font>
<font color=#447700>!      call sw_kgb20<a name='5372'></font>
<font color=#447700>!      call sw_kgb21<a name='5373'></font>
<font color=#447700>!      call sw_kgb22<a name='5374'></font>
<font color=#447700>!      call sw_kgb23<a name='5375'></font>
<font color=#447700>!      call sw_kgb24<a name='5376'></font>
<font color=#447700>!      call sw_kgb25<a name='5377'></font>
<font color=#447700>!      call sw_kgb26<a name='5378'></font>
<font color=#447700>!      call sw_kgb27<a name='5379'></font>
<font color=#447700>!      call sw_kgb28<a name='5380'></font>
<font color=#447700>!      call sw_kgb29<a name='5381'></font>
<a name='5382'>
<font color=#447700>! Define exponential lookup tables for transmittance. Tau is<a name='5383'></font>
<font color=#447700>! computed as a function of the tau transition function, and transmittance <a name='5384'></font>
<font color=#447700>! is calculated as a function of tau.  All tables are computed at intervals <a name='5385'></font>
<font color=#447700>! of 0.0001.  The inverse of the constant used in the Pade approximation to <a name='5386'></font>
<font color=#447700>! the tau transition function is set to bpade.<a name='5387'></font>
<a name='5388'>
      exp_tbl(0) = 1.0 <a name='5389'>
      exp_tbl(ntbl) = expeps<a name='5390'>
      bpade = 1.0  / pade<a name='5391'>
      do itr = 1, ntbl-1<a name='5392'>
         tfn = float(itr) / float(ntbl)<a name='5393'>
         tau_tbl = bpade * tfn / (1.  - tfn)<a name='5394'>
         exp_tbl(itr) = exp(-tau_tbl)<a name='5395'>
         if (exp_tbl(itr) .le. expeps) exp_tbl(itr) = expeps<a name='5396'>
      enddo<a name='5397'>
<a name='5398'>
<font color=#447700>! Perform g-point reduction from 16 per band (224 total points) to<a name='5399'></font>
<font color=#447700>! a band dependent number (112 total points) for all absorption<a name='5400'></font>
<font color=#447700>! coefficient input data and Planck fraction input data.<a name='5401'></font>
<font color=#447700>! Compute relative weighting for new g-point combinations.<a name='5402'></font>
<a name='5403'>
      igcsm = 0<a name='5404'>
      do ibnd = 1,nbndsw<a name='5405'>
         iprsm = 0<a name='5406'>
         if (ngc(ibnd).lt.mg) then<a name='5407'>
            do igc = 1,ngc(ibnd)<a name='5408'>
               igcsm = igcsm + 1<a name='5409'>
               wtsum = 0.<a name='5410'>
               do ipr = 1, ngn(igcsm)<a name='5411'>
                  iprsm = iprsm + 1<a name='5412'>
                  wtsum = wtsum + wt(iprsm)<a name='5413'>
               enddo<a name='5414'>
               wtsm(igc) = wtsum<a name='5415'>
            enddo<a name='5416'>
            do ig = 1, ng(ibnd+15)<a name='5417'>
               ind = (ibnd-1)*mg + ig<a name='5418'>
               rwgt(ind) = wt(ig)/wtsm(ngm(ind))<a name='5419'>
            enddo<a name='5420'>
         else<a name='5421'>
            do ig = 1, ng(ibnd+15)<a name='5422'>
               igcsm = igcsm + 1<a name='5423'>
               ind = (ibnd-1)*mg + ig<a name='5424'>
               rwgt(ind) = 1.0 <a name='5425'>
            enddo<a name='5426'>
         endif<a name='5427'>
      enddo<a name='5428'>
<a name='5429'>
<font color=#447700>! Reduce g-points for absorption coefficient data in each LW spectral band.<a name='5430'></font>
<a name='5431'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB16S'>cmbgb16s</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB16S_2"><a name='5432'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB17'>cmbgb17</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB17_2"><a name='5433'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB18'>cmbgb18</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB18_2"><a name='5434'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB19'>cmbgb19</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB19_2"><a name='5435'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB20'>cmbgb20</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB20_2"><a name='5436'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB21'>cmbgb21</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB21_2"><a name='5437'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB22'>cmbgb22</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB22_2"><a name='5438'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB23'>cmbgb23</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB23_2"><a name='5439'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB24'>cmbgb24</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB24_2"><a name='5440'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB25'>cmbgb25</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB25_2"><a name='5441'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB26'>cmbgb26</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB26_2"><a name='5442'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB27'>cmbgb27</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB27_2"><a name='5443'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB28'>cmbgb28</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB28_2"><a name='5444'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB29'>cmbgb29</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CMBGB29_2"><a name='5445'>
<a name='5446'>
      end subroutine rrtmg_sw_ini<a name='5447'>
<a name='5448'>
<font color=#447700>!***************************************************************************<a name='5449'></font>
<A NAME='SWDATINIT'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWDATINIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5450'>
      <font color=#993300>subroutine </font><font color=#cc0000>swdatinit</font>(cpdair) <A href='../../call_to/SWDATINIT.html' TARGET='index'>2</A>,<A href='../../call_from/SWDATINIT.html' TARGET='index'>4</A><a name='5451'>
<font color=#447700>!***************************************************************************<a name='5452'></font>
<a name='5453'>
<font color=#447700>! --------- Modules ----------<a name='5454'></font>
<a name='5455'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_CON_F'>rrsw_con_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWDATINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CON_F_3">, only: heatfac, grav, planck, boltz, &amp;<a name='5456'>
                          clight, avogad, alosmt, gascon, radcn1, radcn2, &amp;<a name='5457'>
                          sbcnst, secdy <a name='5458'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_VSN_F'>rrsw_vsn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWDATINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_F_6"><a name='5459'>
<a name='5460'>
      save <a name='5461'>
 <a name='5462'>
      real , intent(in) :: cpdair     <font color=#447700>! Specific heat capacity of dry air<a name='5463'></font>
                                      <font color=#447700>! at constant pressure at 273 K<a name='5464'></font>
                                      <font color=#447700>! (J kg-1 K-1)<a name='5465'></font>
<a name='5466'>
<font color=#447700>! Shortwave spectral band limits (wavenumbers)<a name='5467'></font>
      wavenum1(:) = (/2600. , 3250. , 4000. , 4650. , 5150. , 6150. , 7700. , &amp;<a name='5468'>
                      8050. ,12850. ,16000. ,22650. ,29000. ,38000. ,  820. /)<a name='5469'>
      wavenum2(:) = (/3250. , 4000. , 4650. , 5150. , 6150. , 7700. , 8050. , &amp;<a name='5470'>
                     12850. ,16000. ,22650. ,29000. ,38000. ,50000. , 2600. /)<a name='5471'>
      delwave(:) =  (/ 650. ,  750. ,  650. ,  500. , 1000. , 1550. ,  350. , &amp;<a name='5472'>
                      4800. , 3150. , 6650. , 6350. , 9000. ,12000. , 1780. /)<a name='5473'>
     <a name='5474'>
<font color=#447700>! Spectral band information<a name='5475'></font>
      ng(:) = (/16,16,16,16,16,16,16,16,16,16,16,16,16,16/)<a name='5476'>
      nspa(:) = (/9,9,9,9,1,9,9,1,9,1,0,1,9,1/)<a name='5477'>
      nspb(:) = (/1,5,1,1,1,5,1,0,1,0,0,1,5,1/)<a name='5478'>
      icxa(:) = (/ 5 ,5 ,4 ,4 ,3 ,3 ,2 ,2 ,1 ,1 ,1 ,1 ,1 ,5/)<a name='5479'>
<a name='5480'>
<font color=#447700>! Fundamental physical constants from NIST 2002<a name='5481'></font>
<a name='5482'>
      grav = 9.8066                         <font color=#447700>! Acceleration of gravity<a name='5483'></font>
                                              <font color=#447700>! (m s-2)<a name='5484'></font>
      planck = 6.62606876e-27               <font color=#447700>! Planck constant<a name='5485'></font>
                                              <font color=#447700>! (ergs s; g cm2 s-1)<a name='5486'></font>
      boltz = 1.3806503e-16                 <font color=#447700>! Boltzmann constant<a name='5487'></font>
                                              <font color=#447700>! (ergs K-1; g cm2 s-2 K-1)<a name='5488'></font>
      clight = 2.99792458e+10               <font color=#447700>! Speed of light in a vacuum  <a name='5489'></font>
                                              <font color=#447700>! (cm s-1)<a name='5490'></font>
      avogad = 6.02214199e+23               <font color=#447700>! Avogadro constant<a name='5491'></font>
                                              <font color=#447700>! (mol-1)<a name='5492'></font>
      alosmt = 2.6867775e+19                <font color=#447700>! Loschmidt constant<a name='5493'></font>
                                              <font color=#447700>! (cm-3)<a name='5494'></font>
      gascon = 8.31447200e+07               <font color=#447700>! Molar gas constant<a name='5495'></font>
                                              <font color=#447700>! (ergs mol-1 K-1)<a name='5496'></font>
      radcn1 = 1.191042772e-12              <font color=#447700>! First radiation constant<a name='5497'></font>
                                              <font color=#447700>! (W cm2 sr-1)<a name='5498'></font>
      radcn2 = 1.4387752                    <font color=#447700>! Second radiation constant<a name='5499'></font>
                                              <font color=#447700>! (cm K)<a name='5500'></font>
      sbcnst = 5.670400e-04                 <font color=#447700>! Stefan-Boltzmann constant<a name='5501'></font>
                                              <font color=#447700>! (W cm-2 K-4)<a name='5502'></font>
      secdy = 8.6400e4                      <font color=#447700>! Number of seconds per day<a name='5503'></font>
                                              <font color=#447700>! (s d-1)<a name='5504'></font>
<font color=#447700>!<a name='5505'></font>
<font color=#447700>!     units are generally cgs<a name='5506'></font>
<font color=#447700>!<a name='5507'></font>
<font color=#447700>!     The first and second radiation constants are taken from NIST.<a name='5508'></font>
<font color=#447700>!     They were previously obtained from the relations:<a name='5509'></font>
<font color=#447700>!          radcn1 = 2.*planck*clight*clight*1.e-07<a name='5510'></font>
<font color=#447700>!          radcn2 = planck*clight/boltz<a name='5511'></font>
<a name='5512'>
<font color=#447700>!     Heatfac is the factor by which delta-flux / delta-pressure is<a name='5513'></font>
<font color=#447700>!     multiplied, with flux in W/m-2 and pressure in mbar, to get <a name='5514'></font>
<font color=#447700>!     the heating rate in units of degrees/day.  It is equal to:<a name='5515'></font>
<font color=#447700>!     Original value:<a name='5516'></font>
<font color=#447700>!           (g)x(#sec/day)x(1e-5)/(specific heat of air at const. p)<a name='5517'></font>
<font color=#447700>!           Here, cpdair (1.004) is in units of J g-1 K-1, and the <a name='5518'></font>
<font color=#447700>!           constant (1.e-5) converts mb to Pa and g-1 to kg-1.<a name='5519'></font>
<font color=#447700>!        =  (9.8066)(86400)(1e-5)/(1.004)<a name='5520'></font>
<font color=#447700>!      heatfac = 8.4391 <a name='5521'></font>
<font color=#447700>!<a name='5522'></font>
<font color=#447700>!     Modified value for consistency with CAM3:<a name='5523'></font>
<font color=#447700>!           (g)x(#sec/day)x(1e-5)/(specific heat of air at const. p)<a name='5524'></font>
<font color=#447700>!           Here, cpdair (1.00464) is in units of J g-1 K-1, and the<a name='5525'></font>
<font color=#447700>!           constant (1.e-5) converts mb to Pa and g-1 to kg-1.<a name='5526'></font>
<font color=#447700>!        =  (9.80616)(86400)(1e-5)/(1.00464)<a name='5527'></font>
<font color=#447700>!      heatfac = 8.43339130434 <a name='5528'></font>
<font color=#447700>!<a name='5529'></font>
<font color=#447700>!     Calculated value (from constants above and input cpdair)<a name='5530'></font>
<font color=#447700>!        (grav) x (#sec/day) / (specific heat of dry air at const. p x 1.e2)<a name='5531'></font>
<font color=#447700>!           Here, cpdair is in units of J kg-1 K-1, and the constant (1.e2) <a name='5532'></font>
<font color=#447700>!           converts mb to Pa when heatfac is multiplied by W m-2 mb-1. <a name='5533'></font>
      heatfac = grav * secdy / (cpdair * 1.e2 )<a name='5534'>
<a name='5535'>
      end subroutine swdatinit<a name='5536'>
<a name='5537'>
<font color=#447700>!***************************************************************************<a name='5538'></font>
<A NAME='SWCMBDAT'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWCMBDAT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5539'>
      <font color=#993300>subroutine </font><font color=#cc0000>swcmbdat</font> <A href='../../call_to/SWCMBDAT.html' TARGET='index'>2</A><a name='5540'>
<font color=#447700>!***************************************************************************<a name='5541'></font>
<a name='5542'>
      save<a name='5543'>
 <a name='5544'>
<font color=#447700>! ------- Definitions -------<a name='5545'></font>
<font color=#447700>!     Arrays for the g-point reduction from 224 to 112 for the 16 LW bands:<a name='5546'></font>
<font color=#447700>!     This mapping from 224 to 112 points has been carefully selected to <a name='5547'></font>
<font color=#447700>!     minimize the effect on the resulting fluxes and cooling rates, and<a name='5548'></font>
<font color=#447700>!     caution should be used if the mapping is modified.  The full 224<a name='5549'></font>
<font color=#447700>!     g-point set can be restored with ngpt=224, ngc=16*16, ngn=224*1., etc.<a name='5550'></font>
<font color=#447700>!     ngpt    The total number of new g-points<a name='5551'></font>
<font color=#447700>!     ngc     The number of new g-points in each band<a name='5552'></font>
<font color=#447700>!     ngs     The cumulative sum of new g-points for each band<a name='5553'></font>
<font color=#447700>!     ngm     The index of each new g-point relative to the original<a name='5554'></font>
<font color=#447700>!             16 g-points for each band.  <a name='5555'></font>
<font color=#447700>!     ngn     The number of original g-points that are combined to make<a name='5556'></font>
<font color=#447700>!             each new g-point in each band.<a name='5557'></font>
<font color=#447700>!     ngb     The band index for each new g-point.<a name='5558'></font>
<font color=#447700>!     wt      RRTM weights for 16 g-points.<a name='5559'></font>
<a name='5560'>
<font color=#447700>! Use this set for 112 quadrature point (g-point) model<a name='5561'></font>
<font color=#447700>! ------- Data statements -------<a name='5562'></font>
      ngc(:) = (/ 6,12, 8, 8,10,10, 2,10, 8, 6, 6, 8, 6,12 /)<a name='5563'>
      ngs(:) = (/ 6,18,26,34,44,54,56,66,74,80,86,94,100,112 /)<a name='5564'>
      ngm(:) = (/ 1,1,2,2,3,3,4,4,5,5,5,5,6,6,6,6, &amp;           <font color=#447700>! band 16<a name='5565'></font>
                  1,2,3,4,5,6,6,7,8,8,9,10,10,11,12,12, &amp;      <font color=#447700>! band 17<a name='5566'></font>
                  1,2,3,4,5,5,6,6,7,7,7,7,8,8,8,8, &amp;           <font color=#447700>! band 18<a name='5567'></font>
                  1,2,3,4,5,5,6,6,7,7,7,7,8,8,8,8, &amp;           <font color=#447700>! band 19<a name='5568'></font>
                  1,2,3,4,5,6,7,8,9,9,10,10,10,10,10,10, &amp;     <font color=#447700>! band 20<a name='5569'></font>
                  1,2,3,4,5,6,7,8,9,9,10,10,10,10,10,10, &amp;     <font color=#447700>! band 21<a name='5570'></font>
                  1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2, &amp;           <font color=#447700>! band 22<a name='5571'></font>
                  1,1,2,2,3,4,5,6,7,8,9,9,10,10,10,10, &amp;       <font color=#447700>! band 23<a name='5572'></font>
                  1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8, &amp;           <font color=#447700>! band 24<a name='5573'></font>
                  1,2,3,3,4,4,5,5,5,5,6,6,6,6,6,6, &amp;           <font color=#447700>! band 25<a name='5574'></font>
                  1,2,3,3,4,4,5,5,5,5,6,6,6,6,6,6, &amp;           <font color=#447700>! band 26<a name='5575'></font>
                  1,2,3,4,5,6,7,7,7,7,8,8,8,8,8,8, &amp;           <font color=#447700>! band 27<a name='5576'></font>
                  1,2,3,3,4,4,5,5,5,5,6,6,6,6,6,6, &amp;           <font color=#447700>! band 28<a name='5577'></font>
                  1,2,3,4,5,5,6,6,7,7,8,8,9,10,11,12 /)        <font color=#447700>! band 29<a name='5578'></font>
      ngn(:) = (/ 2,2,2,2,4,4, &amp;                               <font color=#447700>! band 16<a name='5579'></font>
                  1,1,1,1,1,2,1,2,1,2,1,2, &amp;                   <font color=#447700>! band 17<a name='5580'></font>
                  1,1,1,1,2,2,4,4, &amp;                           <font color=#447700>! band 18<a name='5581'></font>
                  1,1,1,1,2,2,4,4, &amp;                           <font color=#447700>! band 19<a name='5582'></font>
                  1,1,1,1,1,1,1,1,2,6, &amp;                       <font color=#447700>! band 20<a name='5583'></font>
                  1,1,1,1,1,1,1,1,2,6, &amp;                       <font color=#447700>! band 21<a name='5584'></font>
                  8,8, &amp;                                       <font color=#447700>! band 22<a name='5585'></font>
                  2,2,1,1,1,1,1,1,2,4, &amp;                       <font color=#447700>! band 23<a name='5586'></font>
                  2,2,2,2,2,2,2,2, &amp;                           <font color=#447700>! band 24<a name='5587'></font>
                  1,1,2,2,4,6, &amp;                               <font color=#447700>! band 25<a name='5588'></font>
                  1,1,2,2,4,6, &amp;                               <font color=#447700>! band 26<a name='5589'></font>
                  1,1,1,1,1,1,4,6, &amp;                           <font color=#447700>! band 27<a name='5590'></font>
                  1,1,2,2,4,6, &amp;                               <font color=#447700>! band 28<a name='5591'></font>
                  1,1,1,1,2,2,2,2,1,1,1,1 /)                   <font color=#447700>! band 29<a name='5592'></font>
      ngb(:) = (/ 16,16,16,16,16,16, &amp;                         <font color=#447700>! band 16<a name='5593'></font>
                  17,17,17,17,17,17,17,17,17,17,17,17, &amp;       <font color=#447700>! band 17<a name='5594'></font>
                  18,18,18,18,18,18,18,18, &amp;                   <font color=#447700>! band 18<a name='5595'></font>
                  19,19,19,19,19,19,19,19, &amp;                   <font color=#447700>! band 19<a name='5596'></font>
                  20,20,20,20,20,20,20,20,20,20, &amp;             <font color=#447700>! band 20<a name='5597'></font>
                  21,21,21,21,21,21,21,21,21,21, &amp;             <font color=#447700>! band 21<a name='5598'></font>
                  22,22, &amp;                                     <font color=#447700>! band 22<a name='5599'></font>
                  23,23,23,23,23,23,23,23,23,23, &amp;             <font color=#447700>! band 23<a name='5600'></font>
                  24,24,24,24,24,24,24,24, &amp;                   <font color=#447700>! band 24<a name='5601'></font>
                  25,25,25,25,25,25, &amp;                         <font color=#447700>! band 25<a name='5602'></font>
                  26,26,26,26,26,26, &amp;                         <font color=#447700>! band 26<a name='5603'></font>
                  27,27,27,27,27,27,27,27, &amp;                   <font color=#447700>! band 27<a name='5604'></font>
                  28,28,28,28,28,28, &amp;                         <font color=#447700>! band 28<a name='5605'></font>
                  29,29,29,29,29,29,29,29,29,29,29,29 /)       <font color=#447700>! band 29<a name='5606'></font>
<a name='5607'>
<font color=#447700>! Use this set for full 224 quadrature point (g-point) model<a name='5608'></font>
<font color=#447700>! ------- Data statements -------<a name='5609'></font>
<font color=#447700>!      ngc(:) = (/ 16,16,16,16,16,16,16,16,16,16,16,16,16,16 /)<a name='5610'></font>
<font color=#447700>!      ngs(:) = (/ 16,32,48,64,80,96,112,128,144,160,176,192,208,224 /)<a name='5611'></font>
<font color=#447700>!      ngm(:) = (/ 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 16<a name='5612'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 17<a name='5613'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 18<a name='5614'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 19<a name='5615'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 20<a name='5616'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 21<a name='5617'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 22<a name='5618'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 23<a name='5619'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 24<a name='5620'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 25<a name='5621'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 26<a name='5622'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 27<a name='5623'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16, &amp;    ! band 28<a name='5624'></font>
<font color=#447700>!                  1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16 /)    ! band 29<a name='5625'></font>
<font color=#447700>!      ngn(:) = (/ 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 16<a name='5626'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 17<a name='5627'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 18<a name='5628'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 19<a name='5629'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 20<a name='5630'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 21<a name='5631'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 22<a name='5632'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 23<a name='5633'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 24<a name='5634'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 25<a name='5635'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 26<a name='5636'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 27<a name='5637'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1, &amp;           ! band 28<a name='5638'></font>
<font color=#447700>!                  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1 /)           ! band 29<a name='5639'></font>
<font color=#447700>!      ngb(:) = (/ 16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16, &amp;   ! band 16<a name='5640'></font>
<font color=#447700>!                  17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17, &amp;   ! band 17<a name='5641'></font>
<font color=#447700>!                  18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18, &amp;   ! band 18<a name='5642'></font>
<font color=#447700>!                  19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19, &amp;   ! band 19<a name='5643'></font>
<font color=#447700>!                  20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20, &amp;   ! band 20<a name='5644'></font>
<font color=#447700>!                  21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21, &amp;   ! band 21<a name='5645'></font>
<font color=#447700>!                  22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22, &amp;   ! band 22<a name='5646'></font>
<font color=#447700>!                  23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23, &amp;   ! band 23<a name='5647'></font>
<font color=#447700>!                  24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24, &amp;   ! band 24<a name='5648'></font>
<font color=#447700>!                  25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25, &amp;   ! band 25<a name='5649'></font>
<font color=#447700>!                  26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26, &amp;   ! band 26<a name='5650'></font>
<font color=#447700>!                  27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27, &amp;   ! band 27<a name='5651'></font>
<font color=#447700>!                  28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28, &amp;   ! band 28<a name='5652'></font>
<font color=#447700>!                  29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29 /)   ! band 29<a name='5653'></font>
<a name='5654'>
<a name='5655'>
      wt(:) =  (/ 0.1527534276 , 0.1491729617 , 0.1420961469 , &amp;<a name='5656'>
                  0.1316886544 , 0.1181945205 , 0.1019300893 , &amp;<a name='5657'>
                  0.0832767040 , 0.0626720116 , 0.0424925000 , &amp;<a name='5658'>
                  0.0046269894 , 0.0038279891 , 0.0030260086 , &amp;<a name='5659'>
                  0.0022199750 , 0.0014140010 , 0.0005330000 , &amp;<a name='5660'>
                  0.0000750000  /)<a name='5661'>
<a name='5662'>
      end subroutine swcmbdat<a name='5663'>
<a name='5664'>
<font color=#447700>!***************************************************************************<a name='5665'></font>
<A NAME='SWAERPR'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWAERPR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5666'>
      <font color=#993300>subroutine </font><font color=#cc0000>swaerpr</font> <A href='../../call_to/SWAERPR.html' TARGET='index'>2</A>,<A href='../../call_from/SWAERPR.html' TARGET='index'>2</A><a name='5667'>
<font color=#447700>!***************************************************************************<a name='5668'></font>
<a name='5669'>
<font color=#447700>! Purpose: Define spectral aerosol properties for six ECMWF aerosol types<a name='5670'></font>
<font color=#447700>! as used in the ECMWF IFS model (see module rrsw_aer.F90 for details)<a name='5671'></font>
<font color=#447700>!<a name='5672'></font>
<font color=#447700>! Original: Defined for rrtmg_sw 14 spectral bands, JJMorcrette, ECMWF Feb 2003<a name='5673'></font>
<font color=#447700>! Revision: Reformatted for consistency with rrtmg_lw, MJIacono, AER, Jul 2006<a name='5674'></font>
<a name='5675'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_AER_F'>rrsw_aer_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWAERPR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_AER_F_1">, only : rsrtaua, rsrpiza, rsrasya<a name='5676'>
<a name='5677'>
      save<a name='5678'>
<a name='5679'>
      rsrtaua( 1, :) = (/ &amp;<a name='5680'>
        0.10849 , 0.66699 , 0.65255 , 0.11600 , 0.06529 , 0.04468 /)<a name='5681'>
      rsrtaua( 2, :) = (/ &amp;<a name='5682'>
        0.10849 , 0.66699 , 0.65255 , 0.11600 , 0.06529 , 0.04468 /)<a name='5683'>
      rsrtaua( 3, :) = (/ &amp;<a name='5684'>
        0.20543 , 0.84642 , 0.84958 , 0.21673 , 0.28270 , 0.10915 /)<a name='5685'>
      rsrtaua( 4, :) = (/ &amp;<a name='5686'>
        0.20543 , 0.84642 , 0.84958 , 0.21673 , 0.28270 , 0.10915 /)<a name='5687'>
      rsrtaua( 5, :) = (/ &amp;<a name='5688'>
        0.20543 , 0.84642 , 0.84958 , 0.21673 , 0.28270 , 0.10915 /)<a name='5689'>
      rsrtaua( 6, :) = (/ &amp;<a name='5690'>
        0.20543 , 0.84642 , 0.84958 , 0.21673 , 0.28270 , 0.10915 /)<a name='5691'>
      rsrtaua( 7, :) = (/ &amp;<a name='5692'>
        0.20543 , 0.84642 , 0.84958 , 0.21673 , 0.28270 , 0.10915 /)<a name='5693'>
      rsrtaua( 8, :) = (/ &amp;<a name='5694'>
        0.52838 , 0.93285 , 0.93449 , 0.53078 , 0.67148 , 0.46608 /)<a name='5695'>
      rsrtaua( 9, :) = (/ &amp;<a name='5696'>
        0.52838 , 0.93285 , 0.93449 , 0.53078 , 0.67148 , 0.46608 /)<a name='5697'>
      rsrtaua(10, :) = (/ &amp;<a name='5698'>
        1.69446 , 1.11855 , 1.09212 , 1.72145 , 1.03858 , 1.12044 /)<a name='5699'>
      rsrtaua(11, :) = (/ &amp;<a name='5700'>
        1.69446 , 1.11855 , 1.09212 , 1.72145 , 1.03858 , 1.12044 /)<a name='5701'>
      rsrtaua(12, :) = (/ &amp;<a name='5702'>
        1.69446 , 1.11855 , 1.09212 , 1.72145 , 1.03858 , 1.12044 /)<a name='5703'>
      rsrtaua(13, :) = (/ &amp;<a name='5704'>
        1.69446 , 1.11855 , 1.09212 , 1.72145 , 1.03858 , 1.12044 /)<a name='5705'>
      rsrtaua(14, :) = (/ &amp;<a name='5706'>
        0.10849 , 0.66699 , 0.65255 , 0.11600 , 0.06529 , 0.04468 /)<a name='5707'>
 <a name='5708'>
      rsrpiza( 1, :) = (/ &amp;<a name='5709'>
        .5230504 , .7868518 , .8531531 , .4048149 , .8748231 , .2355667 /)<a name='5710'>
      rsrpiza( 2, :) = (/ &amp;<a name='5711'>
        .5230504 , .7868518 , .8531531 , .4048149 , .8748231 , .2355667 /)<a name='5712'>
      rsrpiza( 3, :) = (/ &amp;<a name='5713'>
        .8287144 , .9949396 , .9279543 , .6765051 , .9467578 , .9955938 /)<a name='5714'>
      rsrpiza( 4, :) = (/ &amp;<a name='5715'>
        .8287144 , .9949396 , .9279543 , .6765051 , .9467578 , .9955938 /)<a name='5716'>
      rsrpiza( 5, :) = (/ &amp;<a name='5717'>
        .8287144 , .9949396 , .9279543 , .6765051 , .9467578 , .9955938 /)<a name='5718'>
      rsrpiza( 6, :) = (/ &amp;<a name='5719'>
        .8287144 , .9949396 , .9279543 , .6765051 , .9467578 , .9955938 /)<a name='5720'>
      rsrpiza( 7, :) = (/ &amp;<a name='5721'>
        .8287144 , .9949396 , .9279543 , .6765051 , .9467578 , .9955938 /)<a name='5722'>
      rsrpiza( 8, :) = (/ &amp;<a name='5723'>
        .8970131 , .9984940 , .9245594 , .7768385 , .9532763 , .9999999 /)<a name='5724'>
      rsrpiza( 9, :) = (/ &amp;<a name='5725'>
        .8970131 , .9984940 , .9245594 , .7768385 , .9532763 , .9999999 /)<a name='5726'>
      rsrpiza(10, :) = (/ &amp;<a name='5727'>
        .9148907 , .9956173 , .7504584 , .8131335 , .9401905 , .9999999 /)<a name='5728'>
      rsrpiza(11, :) = (/ &amp;<a name='5729'>
        .9148907 , .9956173 , .7504584 , .8131335 , .9401905 , .9999999 /)<a name='5730'>
      rsrpiza(12, :) = (/ &amp;<a name='5731'>
        .9148907 , .9956173 , .7504584 , .8131335 , .9401905 , .9999999 /)<a name='5732'>
      rsrpiza(13, :) = (/ &amp;<a name='5733'>
        .9148907 , .9956173 , .7504584 , .8131335 , .9401905 , .9999999 /)<a name='5734'>
      rsrpiza(14, :) = (/ &amp;<a name='5735'>
        .5230504 , .7868518 , .8531531 , .4048149 , .8748231 , .2355667 /)<a name='5736'>
<a name='5737'>
      rsrasya( 1, :) = (/ &amp;<a name='5738'>
        0.700610 , 0.818871 , 0.702399 , 0.689886 , .4629866 , .1907639 /)<a name='5739'>
      rsrasya( 2, :) = (/ &amp;<a name='5740'>
        0.700610 , 0.818871 , 0.702399 , 0.689886 , .4629866 , .1907639 /)<a name='5741'>
      rsrasya( 3, :) = (/ &amp;<a name='5742'>
        0.636342 , 0.802467 , 0.691305 , 0.627497 , .6105750 , .4760794 /)<a name='5743'>
      rsrasya( 4, :) = (/ &amp;<a name='5744'>
        0.636342 , 0.802467 , 0.691305 , 0.627497 , .6105750 , .4760794 /)<a name='5745'>
      rsrasya( 5, :) = (/ &amp;<a name='5746'>
        0.636342 , 0.802467 , 0.691305 , 0.627497 , .6105750 , .4760794 /)<a name='5747'>
      rsrasya( 6, :) = (/ &amp;<a name='5748'>
        0.636342 , 0.802467 , 0.691305 , 0.627497 , .6105750 , .4760794 /)<a name='5749'>
      rsrasya( 7, :) = (/ &amp;<a name='5750'>
        0.636342 , 0.802467 , 0.691305 , 0.627497 , .6105750 , .4760794 /)<a name='5751'>
      rsrasya( 8, :) = (/ &amp;<a name='5752'>
        0.668431 , 0.788530 , 0.698682 , 0.657422 , .6735182 , .6519706 /)<a name='5753'>
      rsrasya( 9, :) = (/ &amp;<a name='5754'>
        0.668431 , 0.788530 , 0.698682 , 0.657422 , .6735182 , .6519706 /)<a name='5755'>
      rsrasya(10, :) = (/ &amp;<a name='5756'>
        0.729019 , 0.803129 , 0.784592 , 0.712208 , .7008249 , .7270548 /)<a name='5757'>
      rsrasya(11, :) = (/ &amp;<a name='5758'>
        0.729019 , 0.803129 , 0.784592 , 0.712208 , .7008249 , .7270548 /)<a name='5759'>
      rsrasya(12, :) = (/ &amp;<a name='5760'>
        0.729019 , 0.803129 , 0.784592 , 0.712208 , .7008249 , .7270548 /)<a name='5761'>
      rsrasya(13, :) = (/ &amp;<a name='5762'>
        0.729019 , 0.803129 , 0.784592 , 0.712208 , .7008249 , .7270548 /)<a name='5763'>
      rsrasya(14, :) = (/ &amp;<a name='5764'>
        0.700610 , 0.818871 , 0.702399 , 0.689886 , .4629866 , .1907639 /)<a name='5765'>
<a name='5766'>
      end subroutine swaerpr<a name='5767'>
 <a name='5768'>
<font color=#447700>!***************************************************************************<a name='5769'></font>
<A NAME='CMBGB16S'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB16S' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5770'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb16s</font> <A href='../../call_to/CMBGB16S.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB16S.html' TARGET='index'>2</A><a name='5771'>
<font color=#447700>!***************************************************************************<a name='5772'></font>
<font color=#447700>!<a name='5773'></font>
<font color=#447700>!  Original version:       MJIacono; July 1998<a name='5774'></font>
<font color=#447700>!  Revision for RRTM_SW:   MJIacono; November 2002<a name='5775'></font>
<font color=#447700>!  Revision for RRTMG_SW:  MJIacono; December 2003<a name='5776'></font>
<font color=#447700>!  Revision for F90 reformatting:  MJIacono; July 2006<a name='5777'></font>
<font color=#447700>!<a name='5778'></font>
<font color=#447700>!  The subroutines CMBGB16-&gt;CMBGB29 input the absorption coefficient<a name='5779'></font>
<font color=#447700>!  data for each band, which are defined for 16 g-points and 14 spectral<a name='5780'></font>
<font color=#447700>!  bands. The data are combined with appropriate weighting following the<a name='5781'></font>
<font color=#447700>!  g-point mapping arrays specified in RRTMG_SW_INIT.  Solar source <a name='5782'></font>
<font color=#447700>!  function data in array SFLUXREF are combined without weighting.  All<a name='5783'></font>
<font color=#447700>!  g-point reduced data are put into new arrays for use in RRTMG_SW.<a name='5784'></font>
<font color=#447700>!<a name='5785'></font>
<font color=#447700>!  band 16:  2600-3250 cm-1 (low key- h2o,ch4; high key - ch4)<a name='5786'></font>
<font color=#447700>!<a name='5787'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5788'></font>
<a name='5789'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG16_F'>rrsw_kg16_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB16S' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG16_F_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='5790'>
                            absa, ka, absb, kb, selfref, forref, sfluxref<a name='5791'>
<a name='5792'>
<font color=#447700>! ------- Local -------<a name='5793'></font>
      integer  :: jn, jt, jp, igc, ipr, iprsm<a name='5794'>
      real  :: sumk, sumf<a name='5795'>
<a name='5796'>
<a name='5797'>
      do jn = 1,9<a name='5798'>
         do jt = 1,5<a name='5799'>
            do jp = 1,13<a name='5800'>
               iprsm = 0<a name='5801'>
               do igc = 1,ngc(1)<a name='5802'>
                  sumk = 0.<a name='5803'>
                  do ipr = 1, ngn(igc)<a name='5804'>
                     iprsm = iprsm + 1<a name='5805'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm)<a name='5806'>
                  enddo<a name='5807'>
                  ka(jn,jt,jp,igc) = sumk<a name='5808'>
               enddo<a name='5809'>
            enddo<a name='5810'>
         enddo<a name='5811'>
      enddo<a name='5812'>
<a name='5813'>
      do jt = 1,5<a name='5814'>
         do jp = 13,59<a name='5815'>
            iprsm = 0<a name='5816'>
            do igc = 1,ngc(1)<a name='5817'>
               sumk = 0.<a name='5818'>
               do ipr = 1, ngn(igc)<a name='5819'>
                  iprsm = iprsm + 1<a name='5820'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm)<a name='5821'>
               enddo<a name='5822'>
               kb(jt,jp,igc) = sumk<a name='5823'>
            enddo<a name='5824'>
         enddo<a name='5825'>
      enddo<a name='5826'>
<a name='5827'>
      do jt = 1,10<a name='5828'>
         iprsm = 0<a name='5829'>
         do igc = 1,ngc(1)<a name='5830'>
            sumk = 0.<a name='5831'>
            do ipr = 1, ngn(igc)<a name='5832'>
               iprsm = iprsm + 1<a name='5833'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm)<a name='5834'>
            enddo<a name='5835'>
            selfref(jt,igc) = sumk<a name='5836'>
         enddo<a name='5837'>
      enddo<a name='5838'>
<a name='5839'>
      do jt = 1,3<a name='5840'>
         iprsm = 0<a name='5841'>
         do igc = 1,ngc(1)<a name='5842'>
            sumk = 0.<a name='5843'>
            do ipr = 1, ngn(igc)<a name='5844'>
               iprsm = iprsm + 1<a name='5845'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm)<a name='5846'>
            enddo<a name='5847'>
            forref(jt,igc) = sumk<a name='5848'>
         enddo<a name='5849'>
      enddo<a name='5850'>
<a name='5851'>
      iprsm = 0<a name='5852'>
      do igc = 1,ngc(1)<a name='5853'>
         sumf = 0.<a name='5854'>
         do ipr = 1, ngn(igc)<a name='5855'>
            iprsm = iprsm + 1<a name='5856'>
            sumf = sumf + sfluxrefo(iprsm)<a name='5857'>
         enddo<a name='5858'>
         sfluxref(igc) = sumf<a name='5859'>
      enddo<a name='5860'>
<a name='5861'>
      end subroutine cmbgb16s<a name='5862'>
<a name='5863'>
<font color=#447700>!***************************************************************************<a name='5864'></font>
<A NAME='CMBGB17'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB17' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5865'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb17</font> <A href='../../call_to/CMBGB17.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB17.html' TARGET='index'>2</A><a name='5866'>
<font color=#447700>!***************************************************************************<a name='5867'></font>
<font color=#447700>!<a name='5868'></font>
<font color=#447700>!     band 17:  3250-4000 cm-1 (low - h2o,co2; high - h2o,co2)<a name='5869'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5870'></font>
<a name='5871'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG17_F'>rrsw_kg17_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG17_F_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='5872'>
                            absa, ka, absb, kb, selfref, forref, sfluxref<a name='5873'>
<a name='5874'>
<font color=#447700>! ------- Local -------<a name='5875'></font>
      integer  :: jn, jt, jp, igc, ipr, iprsm<a name='5876'>
      real  :: sumk, sumf<a name='5877'>
<a name='5878'>
<a name='5879'>
      do jn = 1,9<a name='5880'>
         do jt = 1,5<a name='5881'>
            do jp = 1,13<a name='5882'>
               iprsm = 0<a name='5883'>
               do igc = 1,ngc(2)<a name='5884'>
                  sumk = 0.<a name='5885'>
                  do ipr = 1, ngn(ngs(1)+igc)<a name='5886'>
                     iprsm = iprsm + 1<a name='5887'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+16)<a name='5888'>
                  enddo<a name='5889'>
                  ka(jn,jt,jp,igc) = sumk<a name='5890'>
               enddo<a name='5891'>
            enddo<a name='5892'>
         enddo<a name='5893'>
      enddo<a name='5894'>
<a name='5895'>
      do jn = 1,5<a name='5896'>
         do jt = 1,5<a name='5897'>
            do jp = 13,59<a name='5898'>
               iprsm = 0<a name='5899'>
               do igc = 1,ngc(2)<a name='5900'>
                  sumk = 0.<a name='5901'>
                  do ipr = 1, ngn(ngs(1)+igc)<a name='5902'>
                     iprsm = iprsm + 1<a name='5903'>
                     sumk = sumk + kbo(jn,jt,jp,iprsm)*rwgt(iprsm+16)<a name='5904'>
                  enddo<a name='5905'>
                  kb(jn,jt,jp,igc) = sumk<a name='5906'>
               enddo<a name='5907'>
            enddo<a name='5908'>
         enddo<a name='5909'>
      enddo<a name='5910'>
<a name='5911'>
      do jt = 1,10<a name='5912'>
         iprsm = 0<a name='5913'>
         do igc = 1,ngc(2)<a name='5914'>
            sumk = 0.<a name='5915'>
            do ipr = 1, ngn(ngs(1)+igc)<a name='5916'>
               iprsm = iprsm + 1<a name='5917'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+16)<a name='5918'>
            enddo<a name='5919'>
            selfref(jt,igc) = sumk<a name='5920'>
         enddo<a name='5921'>
      enddo<a name='5922'>
<a name='5923'>
      do jt = 1,4<a name='5924'>
         iprsm = 0<a name='5925'>
         do igc = 1,ngc(2)<a name='5926'>
            sumk = 0.<a name='5927'>
            do ipr = 1, ngn(ngs(1)+igc)<a name='5928'>
               iprsm = iprsm + 1<a name='5929'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+16)<a name='5930'>
            enddo<a name='5931'>
            forref(jt,igc) = sumk<a name='5932'>
         enddo<a name='5933'>
      enddo<a name='5934'>
<a name='5935'>
      do jp = 1,5<a name='5936'>
         iprsm = 0<a name='5937'>
         do igc = 1,ngc(2)<a name='5938'>
            sumf = 0.<a name='5939'>
            do ipr = 1, ngn(ngs(1)+igc)<a name='5940'>
               iprsm = iprsm + 1<a name='5941'>
               sumf = sumf + sfluxrefo(iprsm,jp)<a name='5942'>
            enddo<a name='5943'>
            sfluxref(igc,jp) = sumf<a name='5944'>
         enddo<a name='5945'>
      enddo<a name='5946'>
<a name='5947'>
      end subroutine cmbgb17<a name='5948'>
<a name='5949'>
<font color=#447700>!***************************************************************************<a name='5950'></font>
<A NAME='CMBGB18'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB18' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='5951'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb18</font> <A href='../../call_to/CMBGB18.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB18.html' TARGET='index'>2</A><a name='5952'>
<font color=#447700>!***************************************************************************<a name='5953'></font>
<font color=#447700>!<a name='5954'></font>
<font color=#447700>!     band 18:  4000-4650 cm-1 (low - h2o,ch4; high - ch4)<a name='5955'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='5956'></font>
<a name='5957'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG18_F'>rrsw_kg18_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG18_F_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='5958'>
                            absa, ka, absb, kb, selfref, forref, sfluxref<a name='5959'>
<a name='5960'>
<font color=#447700>! ------- Local -------<a name='5961'></font>
      integer  :: jn, jt, jp, igc, ipr, iprsm<a name='5962'>
      real  :: sumk, sumf<a name='5963'>
<a name='5964'>
<a name='5965'>
      do jn = 1,9<a name='5966'>
         do jt = 1,5<a name='5967'>
            do jp = 1,13<a name='5968'>
               iprsm = 0<a name='5969'>
               do igc = 1,ngc(3)<a name='5970'>
                  sumk = 0.<a name='5971'>
                  do ipr = 1, ngn(ngs(2)+igc)<a name='5972'>
                     iprsm = iprsm + 1<a name='5973'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+32)<a name='5974'>
                  enddo<a name='5975'>
                  ka(jn,jt,jp,igc) = sumk<a name='5976'>
               enddo<a name='5977'>
            enddo<a name='5978'>
         enddo<a name='5979'>
      enddo<a name='5980'>
<a name='5981'>
      do jt = 1,5<a name='5982'>
         do jp = 13,59<a name='5983'>
            iprsm = 0<a name='5984'>
            do igc = 1,ngc(3)<a name='5985'>
               sumk = 0.<a name='5986'>
               do ipr = 1, ngn(ngs(2)+igc)<a name='5987'>
                  iprsm = iprsm + 1<a name='5988'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+32)<a name='5989'>
               enddo<a name='5990'>
               kb(jt,jp,igc) = sumk<a name='5991'>
            enddo<a name='5992'>
         enddo<a name='5993'>
      enddo<a name='5994'>
<a name='5995'>
      do jt = 1,10<a name='5996'>
         iprsm = 0<a name='5997'>
         do igc = 1,ngc(3)<a name='5998'>
            sumk = 0.<a name='5999'>
            do ipr = 1, ngn(ngs(2)+igc)<a name='6000'>
               iprsm = iprsm + 1<a name='6001'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+32)<a name='6002'>
            enddo<a name='6003'>
            selfref(jt,igc) = sumk<a name='6004'>
         enddo<a name='6005'>
      enddo<a name='6006'>
<a name='6007'>
      do jt = 1,3<a name='6008'>
         iprsm = 0<a name='6009'>
         do igc = 1,ngc(3)<a name='6010'>
            sumk = 0.<a name='6011'>
            do ipr = 1, ngn(ngs(2)+igc)<a name='6012'>
               iprsm = iprsm + 1<a name='6013'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+32)<a name='6014'>
            enddo<a name='6015'>
            forref(jt,igc) = sumk<a name='6016'>
         enddo<a name='6017'>
      enddo<a name='6018'>
<a name='6019'>
      do jp = 1,9<a name='6020'>
         iprsm = 0<a name='6021'>
         do igc = 1,ngc(3)<a name='6022'>
            sumf = 0.<a name='6023'>
            do ipr = 1, ngn(ngs(2)+igc)<a name='6024'>
               iprsm = iprsm + 1<a name='6025'>
               sumf = sumf + sfluxrefo(iprsm,jp)<a name='6026'>
            enddo<a name='6027'>
            sfluxref(igc,jp) = sumf<a name='6028'>
         enddo<a name='6029'>
      enddo<a name='6030'>
<a name='6031'>
      end subroutine cmbgb18<a name='6032'>
<a name='6033'>
<font color=#447700>!***************************************************************************<a name='6034'></font>
<A NAME='CMBGB19'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB19' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6035'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb19</font> <A href='../../call_to/CMBGB19.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB19.html' TARGET='index'>2</A><a name='6036'>
<font color=#447700>!***************************************************************************<a name='6037'></font>
<font color=#447700>!<a name='6038'></font>
<font color=#447700>!     band 19:  4650-5150 cm-1 (low - h2o,co2; high - co2)<a name='6039'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='6040'></font>
<a name='6041'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG19_F'>rrsw_kg19_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG19_F_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='6042'>
                            absa, ka, absb, kb, selfref, forref, sfluxref<a name='6043'>
<a name='6044'>
<font color=#447700>! ------- Local -------<a name='6045'></font>
      integer  :: jn, jt, jp, igc, ipr, iprsm<a name='6046'>
      real  :: sumk, sumf<a name='6047'>
<a name='6048'>
<a name='6049'>
      do jn = 1,9<a name='6050'>
         do jt = 1,5<a name='6051'>
            do jp = 1,13<a name='6052'>
               iprsm = 0<a name='6053'>
               do igc = 1,ngc(4)<a name='6054'>
                  sumk = 0.<a name='6055'>
                  do ipr = 1, ngn(ngs(3)+igc)<a name='6056'>
                     iprsm = iprsm + 1<a name='6057'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+48)<a name='6058'>
                  enddo<a name='6059'>
                  ka(jn,jt,jp,igc) = sumk<a name='6060'>
               enddo<a name='6061'>
            enddo<a name='6062'>
         enddo<a name='6063'>
      enddo<a name='6064'>
<a name='6065'>
      do jt = 1,5<a name='6066'>
         do jp = 13,59<a name='6067'>
            iprsm = 0<a name='6068'>
            do igc = 1,ngc(4)<a name='6069'>
               sumk = 0.<a name='6070'>
               do ipr = 1, ngn(ngs(3)+igc)<a name='6071'>
                  iprsm = iprsm + 1<a name='6072'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+48)<a name='6073'>
               enddo<a name='6074'>
               kb(jt,jp,igc) = sumk<a name='6075'>
            enddo<a name='6076'>
         enddo<a name='6077'>
      enddo<a name='6078'>
<a name='6079'>
      do jt = 1,10<a name='6080'>
         iprsm = 0<a name='6081'>
         do igc = 1,ngc(4)<a name='6082'>
            sumk = 0.<a name='6083'>
            do ipr = 1, ngn(ngs(3)+igc)<a name='6084'>
               iprsm = iprsm + 1<a name='6085'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+48)<a name='6086'>
            enddo<a name='6087'>
            selfref(jt,igc) = sumk<a name='6088'>
         enddo<a name='6089'>
      enddo<a name='6090'>
<a name='6091'>
      do jt = 1,3<a name='6092'>
         iprsm = 0<a name='6093'>
         do igc = 1,ngc(4)<a name='6094'>
            sumk = 0.<a name='6095'>
            do ipr = 1, ngn(ngs(3)+igc)<a name='6096'>
               iprsm = iprsm + 1<a name='6097'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+48)<a name='6098'>
            enddo<a name='6099'>
            forref(jt,igc) = sumk<a name='6100'>
         enddo<a name='6101'>
      enddo<a name='6102'>
<a name='6103'>
      do jp = 1,9<a name='6104'>
         iprsm = 0<a name='6105'>
         do igc = 1,ngc(4)<a name='6106'>
            sumf = 0.<a name='6107'>
            do ipr = 1, ngn(ngs(3)+igc)<a name='6108'>
               iprsm = iprsm + 1<a name='6109'>
               sumf = sumf + sfluxrefo(iprsm,jp)<a name='6110'>
            enddo<a name='6111'>
            sfluxref(igc,jp) = sumf<a name='6112'>
         enddo<a name='6113'>
      enddo<a name='6114'>
<a name='6115'>
      end subroutine cmbgb19<a name='6116'>
<a name='6117'>
<font color=#447700>!***************************************************************************<a name='6118'></font>
<A NAME='CMBGB20'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB20' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6119'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb20</font> <A href='../../call_to/CMBGB20.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB20.html' TARGET='index'>2</A><a name='6120'>
<font color=#447700>!***************************************************************************<a name='6121'></font>
<font color=#447700>!<a name='6122'></font>
<font color=#447700>!     band 20:  5150-6150 cm-1 (low - h2o; high - h2o)<a name='6123'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='6124'></font>
<a name='6125'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG20_F'>rrsw_kg20_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG20_F_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, absch4o, &amp;<a name='6126'>
                            absa, ka, absb, kb, selfref, forref, sfluxref, absch4<a name='6127'>
<a name='6128'>
<font color=#447700>! ------- Local -------<a name='6129'></font>
      integer  :: jt, jp, igc, ipr, iprsm<a name='6130'>
      real  :: sumk, sumf1, sumf2<a name='6131'>
<a name='6132'>
<a name='6133'>
      do jt = 1,5<a name='6134'>
         do jp = 1,13<a name='6135'>
            iprsm = 0<a name='6136'>
            do igc = 1,ngc(5)<a name='6137'>
               sumk = 0.<a name='6138'>
               do ipr = 1, ngn(ngs(4)+igc)<a name='6139'>
                  iprsm = iprsm + 1<a name='6140'>
                  sumk = sumk + kao(jt,jp,iprsm)*rwgt(iprsm+64)<a name='6141'>
               enddo<a name='6142'>
               ka(jt,jp,igc) = sumk<a name='6143'>
            enddo<a name='6144'>
         enddo<a name='6145'>
         do jp = 13,59<a name='6146'>
            iprsm = 0<a name='6147'>
            do igc = 1,ngc(5)<a name='6148'>
               sumk = 0.<a name='6149'>
               do ipr = 1, ngn(ngs(4)+igc)<a name='6150'>
                  iprsm = iprsm + 1<a name='6151'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+64)<a name='6152'>
               enddo<a name='6153'>
               kb(jt,jp,igc) = sumk<a name='6154'>
            enddo<a name='6155'>
         enddo<a name='6156'>
      enddo<a name='6157'>
<a name='6158'>
      do jt = 1,10<a name='6159'>
         iprsm = 0<a name='6160'>
         do igc = 1,ngc(5)<a name='6161'>
            sumk = 0.<a name='6162'>
            do ipr = 1, ngn(ngs(4)+igc)<a name='6163'>
               iprsm = iprsm + 1<a name='6164'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+64)<a name='6165'>
            enddo<a name='6166'>
            selfref(jt,igc) = sumk<a name='6167'>
         enddo<a name='6168'>
      enddo<a name='6169'>
<a name='6170'>
      do jt = 1,4<a name='6171'>
         iprsm = 0<a name='6172'>
         do igc = 1,ngc(5)<a name='6173'>
            sumk = 0.<a name='6174'>
            do ipr = 1, ngn(ngs(4)+igc)<a name='6175'>
               iprsm = iprsm + 1<a name='6176'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+64)<a name='6177'>
            enddo<a name='6178'>
            forref(jt,igc) = sumk<a name='6179'>
         enddo<a name='6180'>
      enddo<a name='6181'>
<a name='6182'>
      iprsm = 0<a name='6183'>
      do igc = 1,ngc(5)<a name='6184'>
         sumf1 = 0.<a name='6185'>
         sumf2 = 0.<a name='6186'>
         do ipr = 1, ngn(ngs(4)+igc)<a name='6187'>
            iprsm = iprsm + 1<a name='6188'>
            sumf1 = sumf1 + sfluxrefo(iprsm)<a name='6189'>
            sumf2 = sumf2 + absch4o(iprsm)*rwgt(iprsm+64)<a name='6190'>
         enddo<a name='6191'>
         sfluxref(igc) = sumf1<a name='6192'>
         absch4(igc) = sumf2<a name='6193'>
      enddo<a name='6194'>
<a name='6195'>
      end subroutine cmbgb20<a name='6196'>
<a name='6197'>
<font color=#447700>!***************************************************************************<a name='6198'></font>
<A NAME='CMBGB21'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB21' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6199'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb21</font> <A href='../../call_to/CMBGB21.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB21.html' TARGET='index'>2</A><a name='6200'>
<font color=#447700>!***************************************************************************<a name='6201'></font>
<font color=#447700>!<a name='6202'></font>
<font color=#447700>!     band 21:  6150-7700 cm-1 (low - h2o,co2; high - h2o,co2)<a name='6203'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='6204'></font>
<a name='6205'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG21_F'>rrsw_kg21_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG21_F_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='6206'>
                            absa, ka, absb, kb, selfref, forref, sfluxref<a name='6207'>
<a name='6208'>
<font color=#447700>! ------- Local -------<a name='6209'></font>
      integer  :: jn, jt, jp, igc, ipr, iprsm<a name='6210'>
      real  :: sumk, sumf<a name='6211'>
<a name='6212'>
<a name='6213'>
      do jn = 1,9<a name='6214'>
         do jt = 1,5<a name='6215'>
            do jp = 1,13<a name='6216'>
               iprsm = 0<a name='6217'>
               do igc = 1,ngc(6)<a name='6218'>
                  sumk = 0.<a name='6219'>
                  do ipr = 1, ngn(ngs(5)+igc)<a name='6220'>
                     iprsm = iprsm + 1<a name='6221'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+80)<a name='6222'>
                  enddo<a name='6223'>
                  ka(jn,jt,jp,igc) = sumk<a name='6224'>
               enddo<a name='6225'>
            enddo<a name='6226'>
         enddo<a name='6227'>
      enddo<a name='6228'>
<a name='6229'>
      do jn = 1,5<a name='6230'>
         do jt = 1,5<a name='6231'>
            do jp = 13,59<a name='6232'>
               iprsm = 0<a name='6233'>
               do igc = 1,ngc(6)<a name='6234'>
                  sumk = 0.<a name='6235'>
                  do ipr = 1, ngn(ngs(5)+igc)<a name='6236'>
                     iprsm = iprsm + 1<a name='6237'>
                     sumk = sumk + kbo(jn,jt,jp,iprsm)*rwgt(iprsm+80)<a name='6238'>
                  enddo<a name='6239'>
                  kb(jn,jt,jp,igc) = sumk<a name='6240'>
               enddo<a name='6241'>
            enddo<a name='6242'>
         enddo<a name='6243'>
      enddo<a name='6244'>
<a name='6245'>
      do jt = 1,10<a name='6246'>
         iprsm = 0<a name='6247'>
         do igc = 1,ngc(6)<a name='6248'>
            sumk = 0.<a name='6249'>
            do ipr = 1, ngn(ngs(5)+igc)<a name='6250'>
               iprsm = iprsm + 1<a name='6251'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+80)<a name='6252'>
            enddo<a name='6253'>
            selfref(jt,igc) = sumk<a name='6254'>
         enddo<a name='6255'>
      enddo<a name='6256'>
<a name='6257'>
      do jt = 1,4<a name='6258'>
         iprsm = 0<a name='6259'>
         do igc = 1,ngc(6)<a name='6260'>
            sumk = 0.<a name='6261'>
            do ipr = 1, ngn(ngs(5)+igc)<a name='6262'>
               iprsm = iprsm + 1<a name='6263'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+80)<a name='6264'>
            enddo<a name='6265'>
            forref(jt,igc) = sumk<a name='6266'>
         enddo<a name='6267'>
      enddo<a name='6268'>
<a name='6269'>
      do jp = 1,9<a name='6270'>
         iprsm = 0<a name='6271'>
         do igc = 1,ngc(6)<a name='6272'>
            sumf = 0.<a name='6273'>
            do ipr = 1, ngn(ngs(5)+igc)<a name='6274'>
               iprsm = iprsm + 1<a name='6275'>
               sumf = sumf + sfluxrefo(iprsm,jp)<a name='6276'>
            enddo<a name='6277'>
            sfluxref(igc,jp) = sumf<a name='6278'>
         enddo<a name='6279'>
      enddo<a name='6280'>
<a name='6281'>
      end subroutine cmbgb21<a name='6282'>
<a name='6283'>
<font color=#447700>!***************************************************************************<a name='6284'></font>
<A NAME='CMBGB22'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB22' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6285'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb22</font> <A href='../../call_to/CMBGB22.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB22.html' TARGET='index'>2</A><a name='6286'>
<font color=#447700>!***************************************************************************<a name='6287'></font>
<font color=#447700>!<a name='6288'></font>
<font color=#447700>!     band 22:  7700-8050 cm-1 (low - h2o,o2; high - o2)<a name='6289'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='6290'></font>
<a name='6291'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG22_F'>rrsw_kg22_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG22_F_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='6292'>
                            absa, ka, absb, kb, selfref, forref, sfluxref<a name='6293'>
<a name='6294'>
<font color=#447700>! ------- Local -------<a name='6295'></font>
      integer  :: jn, jt, jp, igc, ipr, iprsm<a name='6296'>
      real  :: sumk, sumf<a name='6297'>
<a name='6298'>
<a name='6299'>
      do jn = 1,9<a name='6300'>
         do jt = 1,5<a name='6301'>
            do jp = 1,13<a name='6302'>
               iprsm = 0<a name='6303'>
               do igc = 1,ngc(7)<a name='6304'>
                  sumk = 0.<a name='6305'>
                  do ipr = 1, ngn(ngs(6)+igc)<a name='6306'>
                     iprsm = iprsm + 1<a name='6307'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+96)<a name='6308'>
                  enddo<a name='6309'>
                  ka(jn,jt,jp,igc) = sumk<a name='6310'>
               enddo<a name='6311'>
            enddo<a name='6312'>
         enddo<a name='6313'>
      enddo<a name='6314'>
<a name='6315'>
      do jt = 1,5<a name='6316'>
         do jp = 13,59<a name='6317'>
            iprsm = 0<a name='6318'>
            do igc = 1,ngc(7)<a name='6319'>
               sumk = 0.<a name='6320'>
               do ipr = 1, ngn(ngs(6)+igc)<a name='6321'>
                  iprsm = iprsm + 1<a name='6322'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+96)<a name='6323'>
               enddo<a name='6324'>
               kb(jt,jp,igc) = sumk<a name='6325'>
            enddo<a name='6326'>
         enddo<a name='6327'>
      enddo<a name='6328'>
<a name='6329'>
      do jt = 1,10<a name='6330'>
         iprsm = 0<a name='6331'>
         do igc = 1,ngc(7)<a name='6332'>
            sumk = 0.<a name='6333'>
            do ipr = 1, ngn(ngs(6)+igc)<a name='6334'>
               iprsm = iprsm + 1<a name='6335'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+96)<a name='6336'>
            enddo<a name='6337'>
            selfref(jt,igc) = sumk<a name='6338'>
         enddo<a name='6339'>
      enddo<a name='6340'>
<a name='6341'>
      do jt = 1,3<a name='6342'>
         iprsm = 0<a name='6343'>
         do igc = 1,ngc(7)<a name='6344'>
            sumk = 0.<a name='6345'>
            do ipr = 1, ngn(ngs(6)+igc)<a name='6346'>
               iprsm = iprsm + 1<a name='6347'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+96)<a name='6348'>
            enddo<a name='6349'>
            forref(jt,igc) = sumk<a name='6350'>
         enddo<a name='6351'>
      enddo<a name='6352'>
<a name='6353'>
      do jp = 1,9<a name='6354'>
         iprsm = 0<a name='6355'>
         do igc = 1,ngc(7)<a name='6356'>
            sumf = 0.<a name='6357'>
            do ipr = 1, ngn(ngs(6)+igc)<a name='6358'>
               iprsm = iprsm + 1<a name='6359'>
               sumf = sumf + sfluxrefo(iprsm,jp)<a name='6360'>
            enddo<a name='6361'>
            sfluxref(igc,jp) = sumf<a name='6362'>
         enddo<a name='6363'>
      enddo<a name='6364'>
<a name='6365'>
      end subroutine cmbgb22<a name='6366'>
<a name='6367'>
<font color=#447700>!***************************************************************************<a name='6368'></font>
<A NAME='CMBGB23'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB23' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6369'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb23</font> <A href='../../call_to/CMBGB23.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB23.html' TARGET='index'>2</A><a name='6370'>
<font color=#447700>!***************************************************************************<a name='6371'></font>
<font color=#447700>!<a name='6372'></font>
<font color=#447700>!     band 23:  8050-12850 cm-1 (low - h2o; high - nothing)<a name='6373'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='6374'></font>
<a name='6375'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG23_F'>rrsw_kg23_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG23_F_2">, only : kao, selfrefo, forrefo, sfluxrefo, raylo, &amp;<a name='6376'>
                            absa, ka, selfref, forref, sfluxref, rayl<a name='6377'>
<a name='6378'>
<font color=#447700>! ------- Local -------<a name='6379'></font>
      integer  :: jt, jp, igc, ipr, iprsm<a name='6380'>
      real  :: sumk, sumf1, sumf2<a name='6381'>
<a name='6382'>
<a name='6383'>
      do jt = 1,5<a name='6384'>
         do jp = 1,13<a name='6385'>
            iprsm = 0<a name='6386'>
            do igc = 1,ngc(8)<a name='6387'>
               sumk = 0.<a name='6388'>
               do ipr = 1, ngn(ngs(7)+igc)<a name='6389'>
                  iprsm = iprsm + 1<a name='6390'>
                  sumk = sumk + kao(jt,jp,iprsm)*rwgt(iprsm+112)<a name='6391'>
               enddo<a name='6392'>
               ka(jt,jp,igc) = sumk<a name='6393'>
            enddo<a name='6394'>
         enddo<a name='6395'>
      enddo<a name='6396'>
<a name='6397'>
      do jt = 1,10<a name='6398'>
         iprsm = 0<a name='6399'>
         do igc = 1,ngc(8)<a name='6400'>
            sumk = 0.<a name='6401'>
            do ipr = 1, ngn(ngs(7)+igc)<a name='6402'>
               iprsm = iprsm + 1<a name='6403'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+112)<a name='6404'>
            enddo<a name='6405'>
            selfref(jt,igc) = sumk<a name='6406'>
         enddo<a name='6407'>
      enddo<a name='6408'>
<a name='6409'>
      do jt = 1,3<a name='6410'>
         iprsm = 0<a name='6411'>
         do igc = 1,ngc(8)<a name='6412'>
            sumk = 0.<a name='6413'>
            do ipr = 1, ngn(ngs(7)+igc)<a name='6414'>
               iprsm = iprsm + 1<a name='6415'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+112)<a name='6416'>
            enddo<a name='6417'>
            forref(jt,igc) = sumk<a name='6418'>
         enddo<a name='6419'>
      enddo<a name='6420'>
<a name='6421'>
      iprsm = 0<a name='6422'>
      do igc = 1,ngc(8)<a name='6423'>
         sumf1 = 0.<a name='6424'>
         sumf2 = 0.<a name='6425'>
         do ipr = 1, ngn(ngs(7)+igc)<a name='6426'>
            iprsm = iprsm + 1<a name='6427'>
            sumf1 = sumf1 + sfluxrefo(iprsm)<a name='6428'>
            sumf2 = sumf2 + raylo(iprsm)*rwgt(iprsm+112)<a name='6429'>
         enddo<a name='6430'>
         sfluxref(igc) = sumf1<a name='6431'>
         rayl(igc) = sumf2<a name='6432'>
      enddo<a name='6433'>
<a name='6434'>
      end subroutine cmbgb23<a name='6435'>
<a name='6436'>
<font color=#447700>!***************************************************************************<a name='6437'></font>
<A NAME='CMBGB24'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB24' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6438'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb24</font> <A href='../../call_to/CMBGB24.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB24.html' TARGET='index'>2</A><a name='6439'>
<font color=#447700>!***************************************************************************<a name='6440'></font>
<font color=#447700>!<a name='6441'></font>
<font color=#447700>!     band 24:  12850-16000 cm-1 (low - h2o,o2; high - o2)<a name='6442'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='6443'></font>
<a name='6444'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG24_F'>rrsw_kg24_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG24_F_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='6445'>
                            abso3ao, abso3bo, raylao, raylbo, &amp;<a name='6446'>
                            absa, ka, absb, kb, selfref, forref, sfluxref, &amp;<a name='6447'>
                            abso3a, abso3b, rayla, raylb<a name='6448'>
<a name='6449'>
<font color=#447700>! ------- Local -------<a name='6450'></font>
      integer  :: jn, jt, jp, igc, ipr, iprsm<a name='6451'>
      real  :: sumk, sumf1, sumf2, sumf3<a name='6452'>
<a name='6453'>
<a name='6454'>
      do jn = 1,9<a name='6455'>
         do jt = 1,5<a name='6456'>
            do jp = 1,13<a name='6457'>
               iprsm = 0<a name='6458'>
               do igc = 1,ngc(9)<a name='6459'>
                  sumk = 0.<a name='6460'>
                  do ipr = 1, ngn(ngs(8)+igc)<a name='6461'>
                     iprsm = iprsm + 1<a name='6462'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+128)<a name='6463'>
                  enddo<a name='6464'>
                  ka(jn,jt,jp,igc) = sumk<a name='6465'>
               enddo<a name='6466'>
            enddo<a name='6467'>
         enddo<a name='6468'>
      enddo<a name='6469'>
<a name='6470'>
      do jt = 1,5<a name='6471'>
         do jp = 13,59<a name='6472'>
            iprsm = 0<a name='6473'>
            do igc = 1,ngc(9)<a name='6474'>
               sumk = 0.<a name='6475'>
               do ipr = 1, ngn(ngs(8)+igc)<a name='6476'>
                  iprsm = iprsm + 1<a name='6477'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+128)<a name='6478'>
               enddo<a name='6479'>
               kb(jt,jp,igc) = sumk<a name='6480'>
            enddo<a name='6481'>
         enddo<a name='6482'>
      enddo<a name='6483'>
<a name='6484'>
      do jt = 1,10<a name='6485'>
         iprsm = 0<a name='6486'>
         do igc = 1,ngc(9)<a name='6487'>
            sumk = 0.<a name='6488'>
            do ipr = 1, ngn(ngs(8)+igc)<a name='6489'>
               iprsm = iprsm + 1<a name='6490'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+128)<a name='6491'>
            enddo<a name='6492'>
            selfref(jt,igc) = sumk<a name='6493'>
         enddo<a name='6494'>
      enddo<a name='6495'>
<a name='6496'>
      do jt = 1,3<a name='6497'>
         iprsm = 0<a name='6498'>
         do igc = 1,ngc(9)<a name='6499'>
            sumk = 0.<a name='6500'>
            do ipr = 1, ngn(ngs(8)+igc)<a name='6501'>
               iprsm = iprsm + 1<a name='6502'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+128)<a name='6503'>
            enddo<a name='6504'>
            forref(jt,igc) = sumk<a name='6505'>
         enddo<a name='6506'>
      enddo<a name='6507'>
<a name='6508'>
      iprsm = 0<a name='6509'>
      do igc = 1,ngc(9)<a name='6510'>
         sumf1 = 0.<a name='6511'>
         sumf2 = 0.<a name='6512'>
         sumf3 = 0.<a name='6513'>
         do ipr = 1, ngn(ngs(8)+igc)<a name='6514'>
            iprsm = iprsm + 1<a name='6515'>
            sumf1 = sumf1 + raylbo(iprsm)*rwgt(iprsm+128)<a name='6516'>
            sumf2 = sumf2 + abso3ao(iprsm)*rwgt(iprsm+128)<a name='6517'>
            sumf3 = sumf3 + abso3bo(iprsm)*rwgt(iprsm+128)<a name='6518'>
         enddo<a name='6519'>
         raylb(igc) = sumf1<a name='6520'>
         abso3a(igc) = sumf2<a name='6521'>
         abso3b(igc) = sumf3<a name='6522'>
      enddo<a name='6523'>
<a name='6524'>
      do jp = 1,9<a name='6525'>
         iprsm = 0<a name='6526'>
         do igc = 1,ngc(9)<a name='6527'>
            sumf1 = 0.<a name='6528'>
            sumf2 = 0.<a name='6529'>
            do ipr = 1, ngn(ngs(8)+igc)<a name='6530'>
               iprsm = iprsm + 1<a name='6531'>
               sumf1 = sumf1 + sfluxrefo(iprsm,jp)<a name='6532'>
               sumf2 = sumf2 + raylao(iprsm,jp)*rwgt(iprsm+128)<a name='6533'>
            enddo<a name='6534'>
            sfluxref(igc,jp) = sumf1<a name='6535'>
            rayla(igc,jp) = sumf2<a name='6536'>
         enddo<a name='6537'>
      enddo<a name='6538'>
<a name='6539'>
      end subroutine cmbgb24<a name='6540'>
<a name='6541'>
<font color=#447700>!***************************************************************************<a name='6542'></font>
<A NAME='CMBGB25'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB25' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6543'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb25</font> <A href='../../call_to/CMBGB25.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB25.html' TARGET='index'>2</A><a name='6544'>
<font color=#447700>!***************************************************************************<a name='6545'></font>
<font color=#447700>!<a name='6546'></font>
<font color=#447700>!     band 25:  16000-22650 cm-1 (low - h2o; high - nothing)<a name='6547'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='6548'></font>
<a name='6549'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG25_F'>rrsw_kg25_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG25_F_2">, only : kao, sfluxrefo, &amp;<a name='6550'>
                            abso3ao, abso3bo, raylo, &amp;<a name='6551'>
                            absa, ka, sfluxref, &amp;<a name='6552'>
                            abso3a, abso3b, rayl<a name='6553'>
<a name='6554'>
<font color=#447700>! ------- Local -------<a name='6555'></font>
      integer  :: jt, jp, igc, ipr, iprsm<a name='6556'>
      real  :: sumk, sumf1, sumf2, sumf3, sumf4<a name='6557'>
<a name='6558'>
<a name='6559'>
      do jt = 1,5<a name='6560'>
         do jp = 1,13<a name='6561'>
            iprsm = 0<a name='6562'>
            do igc = 1,ngc(10)<a name='6563'>
               sumk = 0.<a name='6564'>
               do ipr = 1, ngn(ngs(9)+igc)<a name='6565'>
                  iprsm = iprsm + 1<a name='6566'>
                  sumk = sumk + kao(jt,jp,iprsm)*rwgt(iprsm+144)<a name='6567'>
               enddo<a name='6568'>
               ka(jt,jp,igc) = sumk<a name='6569'>
            enddo<a name='6570'>
         enddo<a name='6571'>
      enddo<a name='6572'>
<a name='6573'>
      iprsm = 0<a name='6574'>
      do igc = 1,ngc(10)<a name='6575'>
         sumf1 = 0.<a name='6576'>
         sumf2 = 0.<a name='6577'>
         sumf3 = 0.<a name='6578'>
         sumf4 = 0.<a name='6579'>
         do ipr = 1, ngn(ngs(9)+igc)<a name='6580'>
            iprsm = iprsm + 1<a name='6581'>
            sumf1 = sumf1 + sfluxrefo(iprsm)<a name='6582'>
            sumf2 = sumf2 + abso3ao(iprsm)*rwgt(iprsm+144)<a name='6583'>
            sumf3 = sumf3 + abso3bo(iprsm)*rwgt(iprsm+144)<a name='6584'>
            sumf4 = sumf4 + raylo(iprsm)*rwgt(iprsm+144)<a name='6585'>
         enddo<a name='6586'>
         sfluxref(igc) = sumf1<a name='6587'>
         abso3a(igc) = sumf2<a name='6588'>
         abso3b(igc) = sumf3<a name='6589'>
         rayl(igc) = sumf4<a name='6590'>
      enddo<a name='6591'>
<a name='6592'>
      end subroutine cmbgb25<a name='6593'>
<a name='6594'>
<font color=#447700>!***************************************************************************<a name='6595'></font>
<A NAME='CMBGB26'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB26' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6596'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb26</font> <A href='../../call_to/CMBGB26.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB26.html' TARGET='index'>2</A><a name='6597'>
<font color=#447700>!***************************************************************************<a name='6598'></font>
<font color=#447700>!<a name='6599'></font>
<font color=#447700>!     band 26:  22650-29000 cm-1 (low - nothing; high - nothing)<a name='6600'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='6601'></font>
<a name='6602'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG26_F'>rrsw_kg26_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG26_F_2">, only : sfluxrefo, raylo, &amp;<a name='6603'>
                            sfluxref, rayl<a name='6604'>
<a name='6605'>
<font color=#447700>! ------- Local -------<a name='6606'></font>
      integer  :: igc, ipr, iprsm<a name='6607'>
      real  :: sumf1, sumf2<a name='6608'>
<a name='6609'>
<a name='6610'>
      iprsm = 0<a name='6611'>
      do igc = 1,ngc(11)<a name='6612'>
         sumf1 = 0.<a name='6613'>
         sumf2 = 0.<a name='6614'>
         do ipr = 1, ngn(ngs(10)+igc)<a name='6615'>
            iprsm = iprsm + 1<a name='6616'>
            sumf1 = sumf1 + raylo(iprsm)*rwgt(iprsm+160)<a name='6617'>
            sumf2 = sumf2 + sfluxrefo(iprsm)<a name='6618'>
         enddo<a name='6619'>
         rayl(igc) = sumf1<a name='6620'>
         sfluxref(igc) = sumf2<a name='6621'>
      enddo<a name='6622'>
<a name='6623'>
      end subroutine cmbgb26<a name='6624'>
<a name='6625'>
<font color=#447700>!***************************************************************************<a name='6626'></font>
<A NAME='CMBGB27'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB27' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6627'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb27</font> <A href='../../call_to/CMBGB27.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB27.html' TARGET='index'>2</A><a name='6628'>
<font color=#447700>!***************************************************************************<a name='6629'></font>
<font color=#447700>!<a name='6630'></font>
<font color=#447700>!     band 27:  29000-38000 cm-1 (low - o3; high - o3)<a name='6631'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='6632'></font>
<a name='6633'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG27_F'>rrsw_kg27_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG27_F_2">, only : kao, kbo, sfluxrefo, raylo, &amp;<a name='6634'>
                            absa, ka, absb, kb, sfluxref, rayl<a name='6635'>
<a name='6636'>
<font color=#447700>! ------- Local -------<a name='6637'></font>
      integer  :: jt, jp, igc, ipr, iprsm<a name='6638'>
      real  :: sumk, sumf1, sumf2<a name='6639'>
<a name='6640'>
<a name='6641'>
      do jt = 1,5<a name='6642'>
         do jp = 1,13<a name='6643'>
            iprsm = 0<a name='6644'>
            do igc = 1,ngc(12)<a name='6645'>
               sumk = 0.<a name='6646'>
               do ipr = 1, ngn(ngs(11)+igc)<a name='6647'>
                  iprsm = iprsm + 1<a name='6648'>
                  sumk = sumk + kao(jt,jp,iprsm)*rwgt(iprsm+176)<a name='6649'>
               enddo<a name='6650'>
               ka(jt,jp,igc) = sumk<a name='6651'>
            enddo<a name='6652'>
         enddo<a name='6653'>
         do jp = 13,59<a name='6654'>
            iprsm = 0<a name='6655'>
            do igc = 1,ngc(12)<a name='6656'>
               sumk = 0.<a name='6657'>
               do ipr = 1, ngn(ngs(11)+igc)<a name='6658'>
                  iprsm = iprsm + 1<a name='6659'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+176)<a name='6660'>
               enddo<a name='6661'>
               kb(jt,jp,igc) = sumk<a name='6662'>
            enddo<a name='6663'>
         enddo<a name='6664'>
      enddo<a name='6665'>
<a name='6666'>
      iprsm = 0<a name='6667'>
      do igc = 1,ngc(12)<a name='6668'>
         sumf1 = 0.<a name='6669'>
         sumf2 = 0.<a name='6670'>
         do ipr = 1, ngn(ngs(11)+igc)<a name='6671'>
            iprsm = iprsm + 1<a name='6672'>
            sumf1 = sumf1 + sfluxrefo(iprsm)<a name='6673'>
            sumf2 = sumf2 + raylo(iprsm)*rwgt(iprsm+176)<a name='6674'>
         enddo<a name='6675'>
         sfluxref(igc) = sumf1<a name='6676'>
         rayl(igc) = sumf2<a name='6677'>
      enddo<a name='6678'>
<a name='6679'>
      end subroutine cmbgb27<a name='6680'>
<a name='6681'>
<font color=#447700>!***************************************************************************<a name='6682'></font>
<A NAME='CMBGB28'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB28' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6683'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb28</font> <A href='../../call_to/CMBGB28.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB28.html' TARGET='index'>2</A><a name='6684'>
<font color=#447700>!***************************************************************************<a name='6685'></font>
<font color=#447700>!<a name='6686'></font>
<font color=#447700>!     band 28:  38000-50000 cm-1 (low - o3,o2; high - o3,o2)<a name='6687'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='6688'></font>
<a name='6689'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG28_F'>rrsw_kg28_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG28_F_2">, only : kao, kbo, sfluxrefo, &amp;<a name='6690'>
                            absa, ka, absb, kb, sfluxref<a name='6691'>
<a name='6692'>
<font color=#447700>! ------- Local -------<a name='6693'></font>
      integer  :: jn, jt, jp, igc, ipr, iprsm<a name='6694'>
      real  :: sumk, sumf<a name='6695'>
<a name='6696'>
<a name='6697'>
      do jn = 1,9<a name='6698'>
         do jt = 1,5<a name='6699'>
            do jp = 1,13<a name='6700'>
               iprsm = 0<a name='6701'>
               do igc = 1,ngc(13)<a name='6702'>
                  sumk = 0.<a name='6703'>
                  do ipr = 1, ngn(ngs(12)+igc)<a name='6704'>
                     iprsm = iprsm + 1<a name='6705'>
                     sumk = sumk + kao(jn,jt,jp,iprsm)*rwgt(iprsm+192)<a name='6706'>
                  enddo<a name='6707'>
                  ka(jn,jt,jp,igc) = sumk<a name='6708'>
               enddo<a name='6709'>
            enddo<a name='6710'>
         enddo<a name='6711'>
      enddo<a name='6712'>
<a name='6713'>
      do jn = 1,5<a name='6714'>
         do jt = 1,5<a name='6715'>
            do jp = 13,59<a name='6716'>
               iprsm = 0<a name='6717'>
               do igc = 1,ngc(13)<a name='6718'>
                  sumk = 0.<a name='6719'>
                  do ipr = 1, ngn(ngs(12)+igc)<a name='6720'>
                     iprsm = iprsm + 1<a name='6721'>
                     sumk = sumk + kbo(jn,jt,jp,iprsm)*rwgt(iprsm+192)<a name='6722'>
                  enddo<a name='6723'>
                  kb(jn,jt,jp,igc) = sumk<a name='6724'>
               enddo<a name='6725'>
            enddo<a name='6726'>
         enddo<a name='6727'>
      enddo<a name='6728'>
<a name='6729'>
      do jp = 1,5<a name='6730'>
         iprsm = 0<a name='6731'>
         do igc = 1,ngc(13)<a name='6732'>
            sumf = 0.<a name='6733'>
            do ipr = 1, ngn(ngs(12)+igc)<a name='6734'>
               iprsm = iprsm + 1<a name='6735'>
               sumf = sumf + sfluxrefo(iprsm,jp)<a name='6736'>
            enddo<a name='6737'>
            sfluxref(igc,jp) = sumf<a name='6738'>
         enddo<a name='6739'>
      enddo<a name='6740'>
<a name='6741'>
      end subroutine cmbgb28<a name='6742'>
<a name='6743'>
<font color=#447700>!***************************************************************************<a name='6744'></font>
<A NAME='CMBGB29'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB29' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6745'>
      <font color=#993300>subroutine </font><font color=#cc0000>cmbgb29</font> <A href='../../call_to/CMBGB29.html' TARGET='index'>2</A>,<A href='../../call_from/CMBGB29.html' TARGET='index'>2</A><a name='6746'>
<font color=#447700>!***************************************************************************<a name='6747'></font>
<font color=#447700>!<a name='6748'></font>
<font color=#447700>!     band 29:  820-2600 cm-1 (low - h2o; high - co2)<a name='6749'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='6750'></font>
<a name='6751'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG29_F'>rrsw_kg29_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CMBGB29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG29_F_2">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='6752'>
                            absh2oo, absco2o, &amp;<a name='6753'>
                            absa, ka, absb, kb, selfref, forref, sfluxref, &amp;<a name='6754'>
                            absh2o, absco2<a name='6755'>
<a name='6756'>
<font color=#447700>! ------- Local -------<a name='6757'></font>
      integer  :: jt, jp, igc, ipr, iprsm<a name='6758'>
      real  :: sumk, sumf1, sumf2, sumf3<a name='6759'>
<a name='6760'>
<a name='6761'>
      do jt = 1,5<a name='6762'>
         do jp = 1,13<a name='6763'>
            iprsm = 0<a name='6764'>
            do igc = 1,ngc(14)<a name='6765'>
               sumk = 0.<a name='6766'>
               do ipr = 1, ngn(ngs(13)+igc)<a name='6767'>
                  iprsm = iprsm + 1<a name='6768'>
                  sumk = sumk + kao(jt,jp,iprsm)*rwgt(iprsm+208)<a name='6769'>
               enddo<a name='6770'>
               ka(jt,jp,igc) = sumk<a name='6771'>
            enddo<a name='6772'>
         enddo<a name='6773'>
         do jp = 13,59<a name='6774'>
            iprsm = 0<a name='6775'>
            do igc = 1,ngc(14)<a name='6776'>
               sumk = 0.<a name='6777'>
               do ipr = 1, ngn(ngs(13)+igc)<a name='6778'>
                  iprsm = iprsm + 1<a name='6779'>
                  sumk = sumk + kbo(jt,jp,iprsm)*rwgt(iprsm+208)<a name='6780'>
               enddo<a name='6781'>
               kb(jt,jp,igc) = sumk<a name='6782'>
            enddo<a name='6783'>
         enddo<a name='6784'>
      enddo<a name='6785'>
<a name='6786'>
      do jt = 1,10<a name='6787'>
         iprsm = 0<a name='6788'>
         do igc = 1,ngc(14)<a name='6789'>
            sumk = 0.<a name='6790'>
            do ipr = 1, ngn(ngs(13)+igc)<a name='6791'>
               iprsm = iprsm + 1<a name='6792'>
               sumk = sumk + selfrefo(jt,iprsm)*rwgt(iprsm+208)<a name='6793'>
            enddo<a name='6794'>
            selfref(jt,igc) = sumk<a name='6795'>
         enddo<a name='6796'>
      enddo<a name='6797'>
<a name='6798'>
      do jt = 1,4<a name='6799'>
         iprsm = 0<a name='6800'>
         do igc = 1,ngc(14)<a name='6801'>
            sumk = 0.<a name='6802'>
            do ipr = 1, ngn(ngs(13)+igc)<a name='6803'>
               iprsm = iprsm + 1<a name='6804'>
               sumk = sumk + forrefo(jt,iprsm)*rwgt(iprsm+208)<a name='6805'>
            enddo<a name='6806'>
            forref(jt,igc) = sumk<a name='6807'>
         enddo<a name='6808'>
      enddo<a name='6809'>
<a name='6810'>
      iprsm = 0<a name='6811'>
      do igc = 1,ngc(14)<a name='6812'>
         sumf1 = 0.<a name='6813'>
         sumf2 = 0.<a name='6814'>
         sumf3 = 0.<a name='6815'>
         do ipr = 1, ngn(ngs(13)+igc)<a name='6816'>
            iprsm = iprsm + 1<a name='6817'>
            sumf1 = sumf1 + sfluxrefo(iprsm)<a name='6818'>
            sumf2 = sumf2 + absco2o(iprsm)*rwgt(iprsm+208)<a name='6819'>
            sumf3 = sumf3 + absh2oo(iprsm)*rwgt(iprsm+208)<a name='6820'>
         enddo<a name='6821'>
         sfluxref(igc) = sumf1<a name='6822'>
         absco2(igc) = sumf2<a name='6823'>
         absh2o(igc) = sumf3<a name='6824'>
      enddo<a name='6825'>
<a name='6826'>
      end subroutine cmbgb29<a name='6827'>
<a name='6828'>
<font color=#447700>!***********************************************************************<a name='6829'></font>
<A NAME='SWCLDPR'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWCLDPR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6830'>
      <font color=#993300>subroutine </font><font color=#cc0000>swcldpr</font> <A href='../../call_to/SWCLDPR.html' TARGET='index'>2</A>,<A href='../../call_from/SWCLDPR.html' TARGET='index'>2</A><a name='6831'>
<font color=#447700>!***********************************************************************<a name='6832'></font>
<a name='6833'>
<font color=#447700>! Purpose: Define cloud extinction coefficient, single scattering albedo<a name='6834'></font>
<font color=#447700>!          and asymmetry parameter data.<a name='6835'></font>
<font color=#447700>!<a name='6836'></font>
<a name='6837'>
<font color=#447700>! ------- Modules -------<a name='6838'></font>
<a name='6839'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_CLD_F'>rrsw_cld_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SWCLDPR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CLD_F_2">, only : extliq1, ssaliq1, asyliq1, &amp;<a name='6840'>
                           extice2, ssaice2, asyice2, &amp;<a name='6841'>
                           extice3, ssaice3, asyice3, fdlice3, &amp;<a name='6842'>
                           abari, bbari, cbari, dbari, ebari, fbari<a name='6843'>
<a name='6844'>
      save<a name='6845'>
<a name='6846'>
<font color=#447700>!-----------------------------------------------------------------------<a name='6847'></font>
<font color=#447700>!<a name='6848'></font>
<font color=#447700>! Explanation of the method for each value of INFLAG.  A value of<a name='6849'></font>
<font color=#447700>!  0 for INFLAG do not distingish being liquid and ice clouds.<a name='6850'></font>
<font color=#447700>!  INFLAG = 2 does distinguish between liquid and ice clouds, and<a name='6851'></font>
<font color=#447700>!    requires further user input to specify the method to be used to <a name='6852'></font>
<font color=#447700>!    compute the aborption due to each.<a name='6853'></font>
<font color=#447700>!  INFLAG = 0:  For each cloudy layer, the cloud fraction, the cloud optical<a name='6854'></font>
<font color=#447700>!    depth, the cloud single-scattering albedo, and the<a name='6855'></font>
<font color=#447700>!    moments of the phase function (0:NSTREAM).  Note<a name='6856'></font>
<font color=#447700>!    that these values are delta-m scaled within this<a name='6857'></font>
<font color=#447700>!    subroutine.<a name='6858'></font>
<a name='6859'>
<font color=#447700>!  INFLAG = 2:  For each cloudy layer, the cloud fraction, cloud <a name='6860'></font>
<font color=#447700>!    water path (g/m2), and cloud ice fraction are input.<a name='6861'></font>
<font color=#447700>!  ICEFLAG = 2:  The ice effective radius (microns) is input and the<a name='6862'></font>
<font color=#447700>!    optical properties due to ice clouds are computed from<a name='6863'></font>
<font color=#447700>!    the optical properties stored in the RT code, STREAMER v3.0 <a name='6864'></font>
<font color=#447700>!    (Reference: Key. J., Streamer User's Guide, Cooperative <a name='6865'></font>
<font color=#447700>!    Institute for Meteorological Satellite Studies, 2001, 96 pp.).<a name='6866'></font>
<font color=#447700>!    Valid range of values for re are between 5.0 and<a name='6867'></font>
<font color=#447700>!    131.0 micron.<a name='6868'></font>
<font color=#447700>!    This version uses Ebert and Curry, JGR, (1992) method for <a name='6869'></font>
<font color=#447700>!    ice particles larger than 131.0 microns. <a name='6870'></font>
<font color=#447700>!  ICEFLAG = 3:  The ice generalized effective size (dge) is input<a name='6871'></font>
<font color=#447700>!    and the optical depths, single-scattering albedo,<a name='6872'></font>
<font color=#447700>!    and phase function moments are calculated as in<a name='6873'></font>
<font color=#447700>!    Q. Fu, J. Climate, (1996). Q. Fu provided high resolution<a name='6874'></font>
<font color=#447700>!    tables which were appropriately averaged for the<a name='6875'></font>
<font color=#447700>!    bands in RRTM_SW.  Linear interpolation is used to<a name='6876'></font>
<font color=#447700>!    get the coefficients from the stored tables.<a name='6877'></font>
<font color=#447700>!    Valid range of values for dge are between 5.0 and<a name='6878'></font>
<font color=#447700>!    140.0 micron. <a name='6879'></font>
<font color=#447700>!    This version uses Ebert and Curry, JGR, (1992) method for <a name='6880'></font>
<font color=#447700>!    ice particles larger than 140.0 microns. <a name='6881'></font>
<font color=#447700>!  LIQFLAG = 1:  The water droplet effective radius (microns) is input <a name='6882'></font>
<font color=#447700>!    and the optical depths due to water clouds are computed <a name='6883'></font>
<font color=#447700>!    as in Hu and Stamnes, J., Clim., 6, 728-742, (1993) with<a name='6884'></font>
<font color=#447700>!    modified coefficients derived from Mie scattering calculations. <a name='6885'></font>
<font color=#447700>!    The values for absorption coefficients appropriate for<a name='6886'></font>
<font color=#447700>!    the spectral bands in RRTM/RRTMG have been obtained for a <a name='6887'></font>
<font color=#447700>!    range of effective radii by an averaging procedure <a name='6888'></font>
<font color=#447700>!    based on the work of J. Pinto (private communication).<a name='6889'></font>
<font color=#447700>!    Linear interpolation is used to get the absorption <a name='6890'></font>
<font color=#447700>!    coefficients for the input effective radius.<a name='6891'></font>
<font color=#447700>!    ..Updated tables suggested by Peter Blossey (Univ. Washington) <a name='6892'></font>
<font color=#447700>!    and came from RRTMG_SW_v3.9 from AER, Inc.<a name='6893'></font>
<font color=#447700>!<a name='6894'></font>
<font color=#447700>!     ------------------------------------------------------------------<a name='6895'></font>
<a name='6896'>
<font color=#447700>! Everything below is for INFLAG = 2.<a name='6897'></font>
<a name='6898'>
<font color=#447700>! Coefficients for Ebert and Curry method<a name='6899'></font>
      abari(:) = (/ &amp;<a name='6900'>
        &amp; 3.448e-03 ,3.448e-03 ,3.448e-03 ,3.448e-03 ,3.448e-03  /)<a name='6901'>
      bbari(:) = (/ &amp;<a name='6902'>
        &amp; 2.431e+00 ,2.431e+00 ,2.431e+00 ,2.431e+00 ,2.431e+00  /)<a name='6903'>
      cbari(:) = (/ &amp;<a name='6904'>
        &amp; 1.000e-05 ,1.100e-04 ,1.240e-02 ,3.779e-02 ,4.666e-01  /)<a name='6905'>
      dbari(:) = (/ &amp;<a name='6906'>
        &amp; 0.000e+00 ,1.405e-05 ,6.867e-04 ,1.284e-03 ,2.050e-05  /)<a name='6907'>
      ebari(:) = (/ &amp;<a name='6908'>
        &amp; 7.661e-01 ,7.730e-01 ,7.865e-01 ,8.172e-01 ,9.595e-01  /)<a name='6909'>
      fbari(:) = (/ &amp;<a name='6910'>
        &amp; 5.851e-04 ,5.665e-04 ,7.204e-04 ,7.463e-04 ,1.076e-04  /)<a name='6911'>
<a name='6912'>
<font color=#447700>! LIQFLAG==1 extinction coefficients, single scattering albedos, and asymmetry parameters<a name='6913'></font>
<font color=#447700>!   Derived from on Mie scattering computations; based on Hu &amp; Stamnes coefficients<a name='6914'></font>
<a name='6915'>
<font color=#447700>! Extinction coefficient<a name='6916'></font>
<font color=#447700>!     BAND  16<a name='6917'></font>
      extliq1(:, 16) = (/ &amp;<a name='6918'>
        &amp; 9.004493E-01,6.366723E-01,4.542354E-01,3.468253E-01,2.816431E-01,&amp;<a name='6919'>
        &amp; 2.383415E-01,2.070854E-01,1.831854E-01,1.642115E-01,1.487539E-01,&amp;<a name='6920'>
        &amp; 1.359169E-01,1.250900E-01,1.158354E-01,1.078400E-01,1.008646E-01,&amp;<a name='6921'>
        &amp; 9.472307E-02,8.928000E-02,8.442308E-02,8.005924E-02,7.612231E-02,&amp;<a name='6922'>
        &amp; 7.255153E-02,6.929539E-02,6.631769E-02,6.358153E-02,6.106231E-02,&amp;<a name='6923'>
        &amp; 5.873077E-02,5.656924E-02,5.455769E-02,5.267846E-02,5.091923E-02,&amp;<a name='6924'>
        &amp; 4.926692E-02,4.771154E-02,4.623923E-02,4.484385E-02,4.351539E-02,&amp;<a name='6925'>
        &amp; 4.224615E-02,4.103385E-02,3.986538E-02,3.874077E-02,3.765462E-02,&amp;<a name='6926'>
        &amp; 3.660077E-02,3.557384E-02,3.457615E-02,3.360308E-02,3.265000E-02,&amp;<a name='6927'>
        &amp; 3.171770E-02,3.080538E-02,2.990846E-02,2.903000E-02,2.816461E-02,&amp;<a name='6928'>
        &amp; 2.731539E-02,2.648231E-02,2.566308E-02,2.485923E-02,2.407000E-02,&amp;<a name='6929'>
        &amp; 2.329615E-02,2.253769E-02,2.179615E-02 /)<a name='6930'>
<font color=#447700>!     BAND  17<a name='6931'></font>
      extliq1(:, 17) = (/ &amp;<a name='6932'>
       &amp; 6.741200e-01,5.390739e-01,4.198767e-01,3.332553e-01,2.735633e-01,&amp;<a name='6933'>
       &amp; 2.317727e-01,2.012760e-01,1.780400e-01,1.596927e-01,1.447980e-01,&amp;<a name='6934'>
       &amp; 1.324480e-01,1.220347e-01,1.131327e-01,1.054313e-01,9.870534e-02,&amp;<a name='6935'>
       &amp; 9.278200e-02,8.752599e-02,8.282933e-02,7.860600e-02,7.479133e-02,&amp;<a name='6936'>
       &amp; 7.132800e-02,6.816733e-02,6.527401e-02,6.261266e-02,6.015934e-02,&amp;<a name='6937'>
       &amp; 5.788867e-02,5.578134e-02,5.381667e-02,5.198133e-02,5.026067e-02,&amp;<a name='6938'>
       &amp; 4.864466e-02,4.712267e-02,4.568066e-02,4.431200e-02,4.300867e-02,&amp;<a name='6939'>
       &amp; 4.176600e-02,4.057400e-02,3.942534e-02,3.832066e-02,3.725068e-02,&amp;<a name='6940'>
       &amp; 3.621400e-02,3.520533e-02,3.422333e-02,3.326400e-02,3.232467e-02,&amp;<a name='6941'>
       &amp; 3.140535e-02,3.050400e-02,2.962000e-02,2.875267e-02,2.789800e-02,&amp;<a name='6942'>
       &amp; 2.705934e-02,2.623667e-02,2.542667e-02,2.463200e-02,2.385267e-02,&amp;<a name='6943'>
       &amp; 2.308667e-02,2.233667e-02,2.160067e-02 /)<a name='6944'>
<font color=#447700>!     BAND  18<a name='6945'></font>
      extliq1(:, 18) = (/ &amp;<a name='6946'>
       &amp; 9.250861e-01,6.245692e-01,4.347038e-01,3.320208e-01,2.714869e-01,&amp;<a name='6947'>
       &amp; 2.309516e-01,2.012592e-01,1.783315e-01,1.600369e-01,1.451000e-01,&amp;<a name='6948'>
       &amp; 1.326838e-01,1.222069e-01,1.132554e-01,1.055146e-01,9.876000e-02,&amp;<a name='6949'>
       &amp; 9.281386e-02,8.754000e-02,8.283078e-02,7.860077e-02,7.477769e-02,&amp;<a name='6950'>
       &amp; 7.130847e-02,6.814461e-02,6.524615e-02,6.258462e-02,6.012847e-02,&amp;<a name='6951'>
       &amp; 5.785462e-02,5.574231e-02,5.378000e-02,5.194461e-02,5.022462e-02,&amp;<a name='6952'>
       &amp; 4.860846e-02,4.708462e-02,4.564154e-02,4.427462e-02,4.297231e-02,&amp;<a name='6953'>
       &amp; 4.172769e-02,4.053693e-02,3.939000e-02,3.828462e-02,3.721692e-02,&amp;<a name='6954'>
       &amp; 3.618000e-02,3.517077e-02,3.418923e-02,3.323077e-02,3.229154e-02,&amp;<a name='6955'>
       &amp; 3.137154e-02,3.047154e-02,2.959077e-02,2.872308e-02,2.786846e-02,&amp;<a name='6956'>
       &amp; 2.703077e-02,2.620923e-02,2.540077e-02,2.460615e-02,2.382693e-02,&amp;<a name='6957'>
       &amp; 2.306231e-02,2.231231e-02,2.157923e-02 /)<a name='6958'>
<font color=#447700>!     BAND  19<a name='6959'></font>
      extliq1(:, 19) = (/ &amp;<a name='6960'>
       &amp; 9.298960e-01,5.776460e-01,4.083450e-01,3.211160e-01,2.666390e-01,&amp;<a name='6961'>
       &amp; 2.281990e-01,1.993250e-01,1.768080e-01,1.587810e-01,1.440390e-01,&amp;<a name='6962'>
       &amp; 1.317720e-01,1.214150e-01,1.125540e-01,1.048890e-01,9.819600e-02,&amp;<a name='6963'>
       &amp; 9.230201e-02,8.706900e-02,8.239698e-02,7.819500e-02,7.439899e-02,&amp;<a name='6964'>
       &amp; 7.095300e-02,6.780700e-02,6.492900e-02,6.228600e-02,5.984600e-02,&amp;<a name='6965'>
       &amp; 5.758599e-02,5.549099e-02,5.353801e-02,5.171400e-02,5.000500e-02,&amp;<a name='6966'>
       &amp; 4.840000e-02,4.688500e-02,4.545100e-02,4.409300e-02,4.279700e-02,&amp;<a name='6967'>
       &amp; 4.156100e-02,4.037700e-02,3.923800e-02,3.813800e-02,3.707600e-02,&amp;<a name='6968'>
       &amp; 3.604500e-02,3.504300e-02,3.406500e-02,3.310800e-02,3.217700e-02,&amp;<a name='6969'>
       &amp; 3.126600e-02,3.036800e-02,2.948900e-02,2.862400e-02,2.777500e-02,&amp;<a name='6970'>
       &amp; 2.694200e-02,2.612300e-02,2.531700e-02,2.452800e-02,2.375100e-02,&amp;<a name='6971'>
       &amp; 2.299100e-02,2.224300e-02,2.151201e-02 /)<a name='6972'>
<font color=#447700>!     BAND  20<a name='6973'></font>
      extliq1(:, 20) = (/ &amp;<a name='6974'>
       &amp; 8.780964e-01,5.407031e-01,3.961100e-01,3.166645e-01,2.640455e-01,&amp;<a name='6975'>
       &amp; 2.261070e-01,1.974820e-01,1.751775e-01,1.573415e-01,1.427725e-01,&amp;<a name='6976'>
       &amp; 1.306535e-01,1.204195e-01,1.116650e-01,1.040915e-01,9.747550e-02,&amp;<a name='6977'>
       &amp; 9.164800e-02,8.647649e-02,8.185501e-02,7.770200e-02,7.394749e-02,&amp;<a name='6978'>
       &amp; 7.053800e-02,6.742700e-02,6.457999e-02,6.196149e-02,5.954450e-02,&amp;<a name='6979'>
       &amp; 5.730650e-02,5.522949e-02,5.329450e-02,5.148500e-02,4.979000e-02,&amp;<a name='6980'>
       &amp; 4.819600e-02,4.669301e-02,4.527050e-02,4.391899e-02,4.263500e-02,&amp;<a name='6981'>
       &amp; 4.140500e-02,4.022850e-02,3.909500e-02,3.800199e-02,3.694600e-02,&amp;<a name='6982'>
       &amp; 3.592000e-02,3.492250e-02,3.395050e-02,3.300150e-02,3.207250e-02,&amp;<a name='6983'>
       &amp; 3.116250e-02,3.027100e-02,2.939500e-02,2.853500e-02,2.768900e-02,&amp;<a name='6984'>
       &amp; 2.686000e-02,2.604350e-02,2.524150e-02,2.445350e-02,2.368049e-02,&amp;<a name='6985'>
       &amp; 2.292150e-02,2.217800e-02,2.144800e-02 /)<a name='6986'>
<font color=#447700>!     BAND  21<a name='6987'></font>
      extliq1(:, 21) = (/ &amp;<a name='6988'>
       &amp; 7.937480e-01,5.123036e-01,3.858181e-01,3.099622e-01,2.586829e-01,&amp;<a name='6989'>
       &amp; 2.217587e-01,1.939755e-01,1.723397e-01,1.550258e-01,1.408600e-01,&amp;<a name='6990'>
       &amp; 1.290545e-01,1.190661e-01,1.105039e-01,1.030848e-01,9.659387e-02,&amp;<a name='6991'>
       &amp; 9.086775e-02,8.577807e-02,8.122452e-02,7.712711e-02,7.342193e-02,&amp;<a name='6992'>
       &amp; 7.005387e-02,6.697840e-02,6.416000e-02,6.156903e-02,5.917484e-02,&amp;<a name='6993'>
       &amp; 5.695807e-02,5.489968e-02,5.298097e-02,5.118806e-02,4.950645e-02,&amp;<a name='6994'>
       &amp; 4.792710e-02,4.643581e-02,4.502484e-02,4.368547e-02,4.241001e-02,&amp;<a name='6995'>
       &amp; 4.118936e-02,4.002193e-02,3.889711e-02,3.781322e-02,3.676387e-02,&amp;<a name='6996'>
       &amp; 3.574549e-02,3.475548e-02,3.379033e-02,3.284678e-02,3.192420e-02,&amp;<a name='6997'>
       &amp; 3.102032e-02,3.013484e-02,2.926258e-02,2.840839e-02,2.756742e-02,&amp;<a name='6998'>
       &amp; 2.674258e-02,2.593064e-02,2.513258e-02,2.435000e-02,2.358064e-02,&amp;<a name='6999'>
       &amp; 2.282581e-02,2.208548e-02,2.135936e-02 /)<a name='7000'>
<font color=#447700>!     BAND  22<a name='7001'></font>
      extliq1(:, 22) = (/ &amp;<a name='7002'>
       &amp; 7.533129e-01,5.033129e-01,3.811271e-01,3.062757e-01,2.558729e-01,&amp;<a name='7003'>
       &amp; 2.196828e-01,1.924372e-01,1.711714e-01,1.541086e-01,1.401114e-01,&amp;<a name='7004'>
       &amp; 1.284257e-01,1.185200e-01,1.100243e-01,1.026529e-01,9.620142e-02,&amp;<a name='7005'>
       &amp; 9.050714e-02,8.544428e-02,8.091714e-02,7.684000e-02,7.315429e-02,&amp;<a name='7006'>
       &amp; 6.980143e-02,6.673999e-02,6.394000e-02,6.136000e-02,5.897715e-02,&amp;<a name='7007'>
       &amp; 5.677000e-02,5.472285e-02,5.281286e-02,5.102858e-02,4.935429e-02,&amp;<a name='7008'>
       &amp; 4.778000e-02,4.629714e-02,4.489142e-02,4.355857e-02,4.228715e-02,&amp;<a name='7009'>
       &amp; 4.107285e-02,3.990857e-02,3.879000e-02,3.770999e-02,3.666429e-02,&amp;<a name='7010'>
       &amp; 3.565000e-02,3.466286e-02,3.370143e-02,3.276143e-02,3.184143e-02,&amp;<a name='7011'>
       &amp; 3.094000e-02,3.005714e-02,2.919000e-02,2.833714e-02,2.750000e-02,&amp;<a name='7012'>
       &amp; 2.667714e-02,2.586714e-02,2.507143e-02,2.429143e-02,2.352428e-02,&amp;<a name='7013'>
       &amp; 2.277143e-02,2.203429e-02,2.130857e-02 /)<a name='7014'>
<font color=#447700>!     BAND  23<a name='7015'></font>
      extliq1(:, 23) = (/ &amp;<a name='7016'>
       &amp; 7.079894e-01,4.878198e-01,3.719852e-01,3.001873e-01,2.514795e-01,&amp;<a name='7017'>
       &amp; 2.163013e-01,1.897100e-01,1.689033e-01,1.521793e-01,1.384449e-01,&amp;<a name='7018'>
       &amp; 1.269666e-01,1.172326e-01,1.088745e-01,1.016224e-01,9.527085e-02,&amp;<a name='7019'>
       &amp; 8.966240e-02,8.467543e-02,8.021144e-02,7.619344e-02,7.255676e-02,&amp;<a name='7020'>
       &amp; 6.924996e-02,6.623030e-02,6.346261e-02,6.091499e-02,5.856325e-02,&amp;<a name='7021'>
       &amp; 5.638385e-02,5.435930e-02,5.247156e-02,5.070699e-02,4.905230e-02,&amp;<a name='7022'>
       &amp; 4.749499e-02,4.602611e-02,4.463581e-02,4.331543e-02,4.205647e-02,&amp;<a name='7023'>
       &amp; 4.085241e-02,3.969978e-02,3.859033e-02,3.751877e-02,3.648168e-02,&amp;<a name='7024'>
       &amp; 3.547468e-02,3.449553e-02,3.354072e-02,3.260732e-02,3.169438e-02,&amp;<a name='7025'>
       &amp; 3.079969e-02,2.992146e-02,2.905875e-02,2.821201e-02,2.737873e-02,&amp;<a name='7026'>
       &amp; 2.656052e-02,2.575586e-02,2.496511e-02,2.418783e-02,2.342500e-02,&amp;<a name='7027'>
       &amp; 2.267646e-02,2.194177e-02,2.122146e-02 /)<a name='7028'>
<font color=#447700>!     BAND  24<a name='7029'></font>
      extliq1(:, 24) = (/ &amp;<a name='7030'>
       &amp; 6.850164e-01,4.762468e-01,3.642001e-01,2.946012e-01,2.472001e-01,&amp;<a name='7031'>
       &amp; 2.128588e-01,1.868537e-01,1.664893e-01,1.501142e-01,1.366620e-01,&amp;<a name='7032'>
       &amp; 1.254147e-01,1.158721e-01,1.076732e-01,1.005530e-01,9.431306e-02,&amp;<a name='7033'>
       &amp; 8.879891e-02,8.389232e-02,7.949714e-02,7.553857e-02,7.195474e-02,&amp;<a name='7034'>
       &amp; 6.869413e-02,6.571444e-02,6.298286e-02,6.046779e-02,5.814474e-02,&amp;<a name='7035'>
       &amp; 5.599141e-02,5.399114e-02,5.212443e-02,5.037870e-02,4.874321e-02,&amp;<a name='7036'>
       &amp; 4.720219e-02,4.574813e-02,4.437160e-02,4.306460e-02,4.181810e-02,&amp;<a name='7037'>
       &amp; 4.062603e-02,3.948252e-02,3.838256e-02,3.732049e-02,3.629192e-02,&amp;<a name='7038'>
       &amp; 3.529301e-02,3.432190e-02,3.337412e-02,3.244842e-02,3.154175e-02,&amp;<a name='7039'>
       &amp; 3.065253e-02,2.978063e-02,2.892367e-02,2.808221e-02,2.725478e-02,&amp;<a name='7040'>
       &amp; 2.644174e-02,2.564175e-02,2.485508e-02,2.408303e-02,2.332365e-02,&amp;<a name='7041'>
       &amp; 2.257890e-02,2.184824e-02,2.113224e-02 /)<a name='7042'>
<font color=#447700>!     BAND  25<a name='7043'></font>
      extliq1(:, 25) = (/ &amp;<a name='7044'>
       &amp; 6.673017e-01,4.664520e-01,3.579398e-01,2.902234e-01,2.439904e-01,&amp;<a name='7045'>
       &amp; 2.104149e-01,1.849277e-01,1.649234e-01,1.488087e-01,1.355515e-01,&amp;<a name='7046'>
       &amp; 1.244562e-01,1.150329e-01,1.069321e-01,9.989310e-02,9.372070e-02,&amp;<a name='7047'>
       &amp; 8.826450e-02,8.340622e-02,7.905378e-02,7.513109e-02,7.157859e-02,&amp;<a name='7048'>
       &amp; 6.834588e-02,6.539114e-02,6.268150e-02,6.018621e-02,5.788098e-02,&amp;<a name='7049'>
       &amp; 5.574351e-02,5.375699e-02,5.190412e-02,5.017099e-02,4.854497e-02,&amp;<a name='7050'>
       &amp; 4.701490e-02,4.557030e-02,4.420249e-02,4.290304e-02,4.166427e-02,&amp;<a name='7051'>
       &amp; 4.047820e-02,3.934232e-02,3.824778e-02,3.719236e-02,3.616931e-02,&amp;<a name='7052'>
       &amp; 3.517597e-02,3.420856e-02,3.326566e-02,3.234346e-02,3.144122e-02,&amp;<a name='7053'>
       &amp; 3.055684e-02,2.968798e-02,2.883519e-02,2.799635e-02,2.717228e-02,&amp;<a name='7054'>
       &amp; 2.636182e-02,2.556424e-02,2.478114e-02,2.401086e-02,2.325657e-02,&amp;<a name='7055'>
       &amp; 2.251506e-02,2.178594e-02,2.107301e-02 /)<a name='7056'>
<font color=#447700>!     BAND  26<a name='7057'></font>
      extliq1(:, 26) = (/ &amp;<a name='7058'>
       &amp; 6.552414e-01,4.599454e-01,3.538626e-01,2.873547e-01,2.418033e-01,&amp;<a name='7059'>
       &amp; 2.086660e-01,1.834885e-01,1.637142e-01,1.477767e-01,1.346583e-01,&amp;<a name='7060'>
       &amp; 1.236734e-01,1.143412e-01,1.063148e-01,9.933905e-02,9.322026e-02,&amp;<a name='7061'>
       &amp; 8.780979e-02,8.299230e-02,7.867554e-02,7.478450e-02,7.126053e-02,&amp;<a name='7062'>
       &amp; 6.805276e-02,6.512143e-02,6.243211e-02,5.995541e-02,5.766712e-02,&amp;<a name='7063'>
       &amp; 5.554484e-02,5.357246e-02,5.173222e-02,5.001069e-02,4.839505e-02,&amp;<a name='7064'>
       &amp; 4.687471e-02,4.543861e-02,4.407857e-02,4.278577e-02,4.155331e-02,&amp;<a name='7065'>
       &amp; 4.037322e-02,3.924302e-02,3.815376e-02,3.710172e-02,3.608296e-02,&amp;<a name='7066'>
       &amp; 3.509330e-02,3.412980e-02,3.319009e-02,3.227106e-02,3.137157e-02,&amp;<a name='7067'>
       &amp; 3.048950e-02,2.962365e-02,2.877297e-02,2.793726e-02,2.711500e-02,&amp;<a name='7068'>
       &amp; 2.630666e-02,2.551206e-02,2.473052e-02,2.396287e-02,2.320861e-02,&amp;<a name='7069'>
       &amp; 2.246810e-02,2.174162e-02,2.102927e-02 /)<a name='7070'>
<font color=#447700>!     BAND  27<a name='7071'></font>
      extliq1(:, 27) = (/ &amp;<a name='7072'>
       &amp; 6.430901e-01,4.532134e-01,3.496132e-01,2.844655e-01,2.397347e-01,&amp;<a name='7073'>
       &amp; 2.071236e-01,1.822976e-01,1.627640e-01,1.469961e-01,1.340006e-01,&amp;<a name='7074'>
       &amp; 1.231069e-01,1.138441e-01,1.058706e-01,9.893678e-02,9.285166e-02,&amp;<a name='7075'>
       &amp; 8.746871e-02,8.267411e-02,7.837656e-02,7.450257e-02,7.099318e-02,&amp;<a name='7076'>
       &amp; 6.779929e-02,6.487987e-02,6.220168e-02,5.973530e-02,5.745636e-02,&amp;<a name='7077'>
       &amp; 5.534344e-02,5.337986e-02,5.154797e-02,4.983404e-02,4.822582e-02,&amp;<a name='7078'>
       &amp; 4.671228e-02,4.528321e-02,4.392997e-02,4.264325e-02,4.141647e-02,&amp;<a name='7079'>
       &amp; 4.024259e-02,3.911767e-02,3.803309e-02,3.698782e-02,3.597140e-02,&amp;<a name='7080'>
       &amp; 3.498774e-02,3.402852e-02,3.309340e-02,3.217818e-02,3.128292e-02,&amp;<a name='7081'>
       &amp; 3.040486e-02,2.954230e-02,2.869545e-02,2.786261e-02,2.704372e-02,&amp;<a name='7082'>
       &amp; 2.623813e-02,2.544668e-02,2.466788e-02,2.390313e-02,2.315136e-02,&amp;<a name='7083'>
       &amp; 2.241391e-02,2.168921e-02,2.097903e-02 /)<a name='7084'>
<font color=#447700>!     BAND  28<a name='7085'></font>
      extliq1(:, 28) = (/ &amp;<a name='7086'>
       &amp; 6.367074e-01,4.495768e-01,3.471263e-01,2.826149e-01,2.382868e-01,&amp;<a name='7087'>
       &amp; 2.059640e-01,1.813562e-01,1.619881e-01,1.463436e-01,1.334402e-01,&amp;<a name='7088'>
       &amp; 1.226166e-01,1.134096e-01,1.054829e-01,9.858838e-02,9.253790e-02,&amp;<a name='7089'>
       &amp; 8.718582e-02,8.241830e-02,7.814482e-02,7.429212e-02,7.080165e-02,&amp;<a name='7090'>
       &amp; 6.762385e-02,6.471838e-02,6.205388e-02,5.959726e-02,5.732871e-02,&amp;<a name='7091'>
       &amp; 5.522402e-02,5.326793e-02,5.144230e-02,4.973440e-02,4.813188e-02,&amp;<a name='7092'>
       &amp; 4.662283e-02,4.519798e-02,4.384833e-02,4.256541e-02,4.134253e-02,&amp;<a name='7093'>
       &amp; 4.017136e-02,3.904911e-02,3.796779e-02,3.692364e-02,3.591182e-02,&amp;<a name='7094'>
       &amp; 3.492930e-02,3.397230e-02,3.303920e-02,3.212572e-02,3.123278e-02,&amp;<a name='7095'>
       &amp; 3.035519e-02,2.949493e-02,2.864985e-02,2.781840e-02,2.700197e-02,&amp;<a name='7096'>
       &amp; 2.619682e-02,2.540674e-02,2.462966e-02,2.386613e-02,2.311602e-02,&amp;<a name='7097'>
       &amp; 2.237846e-02,2.165660e-02,2.094756e-02 /)<a name='7098'>
<font color=#447700>!     BAND  29<a name='7099'></font>
      extliq1(:, 29) = (/ &amp;<a name='7100'>
       &amp; 4.298416e-01,4.391639e-01,3.975030e-01,3.443028e-01,2.957345e-01,&amp;<a name='7101'>
       &amp; 2.556461e-01,2.234755e-01,1.976636e-01,1.767428e-01,1.595611e-01,&amp;<a name='7102'>
       &amp; 1.452636e-01,1.332156e-01,1.229481e-01,1.141059e-01,1.064208e-01,&amp;<a name='7103'>
       &amp; 9.968527e-02,9.373833e-02,8.845221e-02,8.372112e-02,7.946667e-02,&amp;<a name='7104'>
       &amp; 7.561807e-02,7.212029e-02,6.893166e-02,6.600944e-02,6.332277e-02,&amp;<a name='7105'>
       &amp; 6.084277e-02,5.854721e-02,5.641361e-02,5.442639e-02,5.256750e-02,&amp;<a name='7106'>
       &amp; 5.082499e-02,4.918556e-02,4.763694e-02,4.617222e-02,4.477861e-02,&amp;<a name='7107'>
       &amp; 4.344861e-02,4.217999e-02,4.096111e-02,3.978638e-02,3.865361e-02,&amp;<a name='7108'>
       &amp; 3.755473e-02,3.649028e-02,3.545361e-02,3.444361e-02,3.345666e-02,&amp;<a name='7109'>
       &amp; 3.249167e-02,3.154722e-02,3.062083e-02,2.971250e-02,2.882083e-02,&amp;<a name='7110'>
       &amp; 2.794611e-02,2.708778e-02,2.624500e-02,2.541750e-02,2.460528e-02,&amp;<a name='7111'>
       &amp; 2.381194e-02,2.303250e-02,2.226833e-02 /)<a name='7112'>
<a name='7113'>
<font color=#447700>! Single scattering albedo     <a name='7114'></font>
<font color=#447700>!     BAND  16<a name='7115'></font>
      ssaliq1(:, 16) = (/ &amp;<a name='7116'>
       &amp; 8.362119e-01,8.098460e-01,7.762291e-01,7.486042e-01,7.294172e-01,&amp;<a name='7117'>
       &amp; 7.161000e-01,7.060656e-01,6.978387e-01,6.907193e-01,6.843551e-01,&amp;<a name='7118'>
       &amp; 6.785668e-01,6.732450e-01,6.683191e-01,6.637264e-01,6.594307e-01,&amp;<a name='7119'>
       &amp; 6.554033e-01,6.516115e-01,6.480295e-01,6.446429e-01,6.414306e-01,&amp;<a name='7120'>
       &amp; 6.383783e-01,6.354750e-01,6.327068e-01,6.300665e-01,6.275376e-01,&amp;<a name='7121'>
       &amp; 6.251245e-01,6.228136e-01,6.205944e-01,6.184720e-01,6.164330e-01,&amp;<a name='7122'>
       &amp; 6.144742e-01,6.125962e-01,6.108004e-01,6.090740e-01,6.074200e-01,&amp;<a name='7123'>
       &amp; 6.058381e-01,6.043209e-01,6.028681e-01,6.014836e-01,6.001626e-01,&amp;<a name='7124'>
       &amp; 5.988957e-01,5.976864e-01,5.965390e-01,5.954379e-01,5.943972e-01,&amp;<a name='7125'>
       &amp; 5.934019e-01,5.924624e-01,5.915579e-01,5.907025e-01,5.898913e-01,&amp;<a name='7126'>
       &amp; 5.891213e-01,5.883815e-01,5.876851e-01,5.870158e-01,5.863868e-01,&amp;<a name='7127'>
       &amp; 5.857821e-01,5.852111e-01,5.846579e-01 /)<a name='7128'>
<font color=#447700>!     BAND  17<a name='7129'></font>
      ssaliq1(:, 17) = (/ &amp;<a name='7130'>
       &amp; 6.995459e-01,7.158012e-01,7.076001e-01,6.927244e-01,6.786434e-01,&amp;<a name='7131'>
       &amp; 6.673545e-01,6.585859e-01,6.516314e-01,6.459010e-01,6.410225e-01,&amp;<a name='7132'>
       &amp; 6.367574e-01,6.329554e-01,6.295119e-01,6.263595e-01,6.234462e-01,&amp;<a name='7133'>
       &amp; 6.207274e-01,6.181755e-01,6.157678e-01,6.134880e-01,6.113173e-01,&amp;<a name='7134'>
       &amp; 6.092495e-01,6.072689e-01,6.053717e-01,6.035507e-01,6.018001e-01,&amp;<a name='7135'>
       &amp; 6.001134e-01,5.984951e-01,5.969294e-01,5.954256e-01,5.939698e-01,&amp;<a name='7136'>
       &amp; 5.925716e-01,5.912265e-01,5.899270e-01,5.886771e-01,5.874746e-01,&amp;<a name='7137'>
       &amp; 5.863185e-01,5.852077e-01,5.841460e-01,5.831249e-01,5.821474e-01,&amp;<a name='7138'>
       &amp; 5.812078e-01,5.803173e-01,5.794616e-01,5.786443e-01,5.778617e-01,&amp;<a name='7139'>
       &amp; 5.771236e-01,5.764191e-01,5.757400e-01,5.750971e-01,5.744842e-01,&amp;<a name='7140'>
       &amp; 5.739012e-01,5.733482e-01,5.728175e-01,5.723214e-01,5.718383e-01,&amp;<a name='7141'>
       &amp; 5.713827e-01,5.709471e-01,5.705330e-01 /)<a name='7142'>
<font color=#447700>!     BAND  18<a name='7143'></font>
      ssaliq1(:, 18) = (/ &amp;<a name='7144'>
       &amp; 9.929711e-01,9.896942e-01,9.852408e-01,9.806820e-01,9.764512e-01,&amp;<a name='7145'>
       &amp; 9.725375e-01,9.688677e-01,9.653832e-01,9.620552e-01,9.588522e-01,&amp;<a name='7146'>
       &amp; 9.557475e-01,9.527265e-01,9.497731e-01,9.468756e-01,9.440270e-01,&amp;<a name='7147'>
       &amp; 9.412230e-01,9.384592e-01,9.357287e-01,9.330369e-01,9.303778e-01,&amp;<a name='7148'>
       &amp; 9.277502e-01,9.251546e-01,9.225907e-01,9.200553e-01,9.175521e-01,&amp;<a name='7149'>
       &amp; 9.150773e-01,9.126352e-01,9.102260e-01,9.078485e-01,9.055057e-01,&amp;<a name='7150'>
       &amp; 9.031978e-01,9.009306e-01,8.987010e-01,8.965177e-01,8.943774e-01,&amp;<a name='7151'>
       &amp; 8.922869e-01,8.902430e-01,8.882551e-01,8.863182e-01,8.844373e-01,&amp;<a name='7152'>
       &amp; 8.826143e-01,8.808499e-01,8.791413e-01,8.774940e-01,8.759019e-01,&amp;<a name='7153'>
       &amp; 8.743650e-01,8.728941e-01,8.714712e-01,8.701065e-01,8.688008e-01,&amp;<a name='7154'>
       &amp; 8.675409e-01,8.663295e-01,8.651714e-01,8.640637e-01,8.629943e-01,&amp;<a name='7155'>
       &amp; 8.619762e-01,8.609995e-01,8.600581e-01 /)<a name='7156'>
<font color=#447700>!     BAND  19<a name='7157'></font>
      ssaliq1(:, 19) = (/ &amp;<a name='7158'>
       &amp; 9.910612e-01,9.854226e-01,9.795008e-01,9.742920e-01,9.695996e-01,&amp;<a name='7159'>
       &amp; 9.652274e-01,9.610648e-01,9.570521e-01,9.531397e-01,9.493086e-01,&amp;<a name='7160'>
       &amp; 9.455413e-01,9.418362e-01,9.381902e-01,9.346016e-01,9.310718e-01,&amp;<a name='7161'>
       &amp; 9.275957e-01,9.241757e-01,9.208038e-01,9.174802e-01,9.142058e-01,&amp;<a name='7162'>
       &amp; 9.109753e-01,9.077895e-01,9.046433e-01,9.015409e-01,8.984784e-01,&amp;<a name='7163'>
       &amp; 8.954572e-01,8.924748e-01,8.895367e-01,8.866395e-01,8.837864e-01,&amp;<a name='7164'>
       &amp; 8.809819e-01,8.782267e-01,8.755231e-01,8.728712e-01,8.702802e-01,&amp;<a name='7165'>
       &amp; 8.677443e-01,8.652733e-01,8.628678e-01,8.605300e-01,8.582593e-01,&amp;<a name='7166'>
       &amp; 8.560596e-01,8.539352e-01,8.518782e-01,8.498915e-01,8.479790e-01,&amp;<a name='7167'>
       &amp; 8.461384e-01,8.443645e-01,8.426613e-01,8.410229e-01,8.394495e-01,&amp;<a name='7168'>
       &amp; 8.379428e-01,8.364967e-01,8.351117e-01,8.337820e-01,8.325091e-01,&amp;<a name='7169'>
       &amp; 8.312874e-01,8.301169e-01,8.289985e-01 /)<a name='7170'>
<font color=#447700>!     BAND  20<a name='7171'></font>
      ssaliq1(:, 20) = (/ &amp;<a name='7172'>
       &amp; 9.969802e-01,9.950445e-01,9.931448e-01,9.914272e-01,9.898652e-01,&amp;<a name='7173'>
       &amp; 9.884250e-01,9.870637e-01,9.857482e-01,9.844558e-01,9.831755e-01,&amp;<a name='7174'>
       &amp; 9.819068e-01,9.806477e-01,9.794000e-01,9.781666e-01,9.769461e-01,&amp;<a name='7175'>
       &amp; 9.757386e-01,9.745459e-01,9.733650e-01,9.721953e-01,9.710398e-01,&amp;<a name='7176'>
       &amp; 9.698936e-01,9.687583e-01,9.676334e-01,9.665192e-01,9.654132e-01,&amp;<a name='7177'>
       &amp; 9.643208e-01,9.632374e-01,9.621625e-01,9.611003e-01,9.600518e-01,&amp;<a name='7178'>
       &amp; 9.590144e-01,9.579922e-01,9.569864e-01,9.559948e-01,9.550239e-01,&amp;<a name='7179'>
       &amp; 9.540698e-01,9.531382e-01,9.522280e-01,9.513409e-01,9.504772e-01,&amp;<a name='7180'>
       &amp; 9.496360e-01,9.488220e-01,9.480327e-01,9.472693e-01,9.465333e-01,&amp;<a name='7181'>
       &amp; 9.458211e-01,9.451344e-01,9.444732e-01,9.438372e-01,9.432268e-01,&amp;<a name='7182'>
       &amp; 9.426391e-01,9.420757e-01,9.415308e-01,9.410102e-01,9.405115e-01,&amp;<a name='7183'>
       &amp; 9.400326e-01,9.395716e-01,9.391313e-01 /)<a name='7184'>
<font color=#447700>!     BAND  21<a name='7185'></font>
      ssaliq1(:, 21) = (/ &amp;<a name='7186'>
       &amp; 9.980034e-01,9.968572e-01,9.958696e-01,9.949747e-01,9.941241e-01,&amp;<a name='7187'>
       &amp; 9.933043e-01,9.924971e-01,9.916978e-01,9.909023e-01,9.901046e-01,&amp;<a name='7188'>
       &amp; 9.893087e-01,9.885146e-01,9.877195e-01,9.869283e-01,9.861379e-01,&amp;<a name='7189'>
       &amp; 9.853523e-01,9.845715e-01,9.837945e-01,9.830217e-01,9.822567e-01,&amp;<a name='7190'>
       &amp; 9.814935e-01,9.807356e-01,9.799815e-01,9.792332e-01,9.784845e-01,&amp;<a name='7191'>
       &amp; 9.777424e-01,9.770042e-01,9.762695e-01,9.755416e-01,9.748152e-01,&amp;<a name='7192'>
       &amp; 9.740974e-01,9.733873e-01,9.726813e-01,9.719861e-01,9.713010e-01,&amp;<a name='7193'>
       &amp; 9.706262e-01,9.699647e-01,9.693144e-01,9.686794e-01,9.680596e-01,&amp;<a name='7194'>
       &amp; 9.674540e-01,9.668657e-01,9.662926e-01,9.657390e-01,9.652019e-01,&amp;<a name='7195'>
       &amp; 9.646820e-01,9.641784e-01,9.636945e-01,9.632260e-01,9.627743e-01,&amp;<a name='7196'>
       &amp; 9.623418e-01,9.619227e-01,9.615194e-01,9.611341e-01,9.607629e-01,&amp;<a name='7197'>
       &amp; 9.604057e-01,9.600622e-01,9.597322e-01 /)<a name='7198'>
<font color=#447700>!     BAND  22<a name='7199'></font>
      ssaliq1(:, 22) = (/ &amp;<a name='7200'>
       &amp; 9.988219e-01,9.981767e-01,9.976168e-01,9.971066e-01,9.966195e-01,&amp;<a name='7201'>
       &amp; 9.961566e-01,9.956995e-01,9.952481e-01,9.947982e-01,9.943495e-01,&amp;<a name='7202'>
       &amp; 9.938955e-01,9.934368e-01,9.929825e-01,9.925239e-01,9.920653e-01,&amp;<a name='7203'>
       &amp; 9.916096e-01,9.911552e-01,9.907067e-01,9.902594e-01,9.898178e-01,&amp;<a name='7204'>
       &amp; 9.893791e-01,9.889453e-01,9.885122e-01,9.880837e-01,9.876567e-01,&amp;<a name='7205'>
       &amp; 9.872331e-01,9.868121e-01,9.863938e-01,9.859790e-01,9.855650e-01,&amp;<a name='7206'>
       &amp; 9.851548e-01,9.847491e-01,9.843496e-01,9.839521e-01,9.835606e-01,&amp;<a name='7207'>
       &amp; 9.831771e-01,9.827975e-01,9.824292e-01,9.820653e-01,9.817124e-01,&amp;<a name='7208'>
       &amp; 9.813644e-01,9.810291e-01,9.807020e-01,9.803864e-01,9.800782e-01,&amp;<a name='7209'>
       &amp; 9.797821e-01,9.794958e-01,9.792179e-01,9.789509e-01,9.786940e-01,&amp;<a name='7210'>
       &amp; 9.784460e-01,9.782090e-01,9.779789e-01,9.777553e-01,9.775425e-01,&amp;<a name='7211'>
       &amp; 9.773387e-01,9.771420e-01,9.769529e-01 /)<a name='7212'>
<font color=#447700>!     BAND  23<a name='7213'></font>
      ssaliq1(:, 23) = (/ &amp;<a name='7214'>
       &amp; 9.998902e-01,9.998395e-01,9.997915e-01,9.997442e-01,9.997016e-01,&amp;<a name='7215'>
       &amp; 9.996600e-01,9.996200e-01,9.995806e-01,9.995411e-01,9.995005e-01,&amp;<a name='7216'>
       &amp; 9.994589e-01,9.994178e-01,9.993766e-01,9.993359e-01,9.992948e-01,&amp;<a name='7217'>
       &amp; 9.992533e-01,9.992120e-01,9.991723e-01,9.991313e-01,9.990906e-01,&amp;<a name='7218'>
       &amp; 9.990510e-01,9.990113e-01,9.989716e-01,9.989323e-01,9.988923e-01,&amp;<a name='7219'>
       &amp; 9.988532e-01,9.988140e-01,9.987761e-01,9.987373e-01,9.986989e-01,&amp;<a name='7220'>
       &amp; 9.986597e-01,9.986239e-01,9.985861e-01,9.985485e-01,9.985123e-01,&amp;<a name='7221'>
       &amp; 9.984762e-01,9.984415e-01,9.984065e-01,9.983722e-01,9.983398e-01,&amp;<a name='7222'>
       &amp; 9.983078e-01,9.982758e-01,9.982461e-01,9.982157e-01,9.981872e-01,&amp;<a name='7223'>
       &amp; 9.981595e-01,9.981324e-01,9.981068e-01,9.980811e-01,9.980580e-01,&amp;<a name='7224'>
       &amp; 9.980344e-01,9.980111e-01,9.979908e-01,9.979690e-01,9.979492e-01,&amp;<a name='7225'>
       &amp; 9.979316e-01,9.979116e-01,9.978948e-01 /)<a name='7226'>
<font color=#447700>!     BAND  24<a name='7227'></font>
      ssaliq1(:, 24) = (/ &amp;<a name='7228'>
       &amp; 9.999978e-01,9.999948e-01,9.999915e-01,9.999905e-01,9.999896e-01,&amp;<a name='7229'>
       &amp; 9.999887e-01,9.999888e-01,9.999888e-01,9.999870e-01,9.999854e-01,&amp;<a name='7230'>
       &amp; 9.999855e-01,9.999856e-01,9.999839e-01,9.999834e-01,9.999829e-01,&amp;<a name='7231'>
       &amp; 9.999809e-01,9.999816e-01,9.999793e-01,9.999782e-01,9.999779e-01,&amp;<a name='7232'>
       &amp; 9.999772e-01,9.999764e-01,9.999756e-01,9.999744e-01,9.999744e-01,&amp;<a name='7233'>
       &amp; 9.999736e-01,9.999729e-01,9.999716e-01,9.999706e-01,9.999692e-01,&amp;<a name='7234'>
       &amp; 9.999690e-01,9.999675e-01,9.999673e-01,9.999660e-01,9.999654e-01,&amp;<a name='7235'>
       &amp; 9.999647e-01,9.999647e-01,9.999625e-01,9.999620e-01,9.999614e-01,&amp;<a name='7236'>
       &amp; 9.999613e-01,9.999607e-01,9.999604e-01,9.999594e-01,9.999589e-01,&amp;<a name='7237'>
       &amp; 9.999586e-01,9.999567e-01,9.999550e-01,9.999557e-01,9.999542e-01,&amp;<a name='7238'>
       &amp; 9.999546e-01,9.999539e-01,9.999536e-01,9.999526e-01,9.999523e-01,&amp;<a name='7239'>
       &amp; 9.999508e-01,9.999534e-01,9.999507e-01 /)<a name='7240'>
<font color=#447700>!     BAND  25<a name='7241'></font>
      ssaliq1(:, 25) = (/ &amp;<a name='7242'>
       &amp; 1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,&amp;<a name='7243'>
       &amp; 1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,&amp;<a name='7244'>
       &amp; 1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,&amp;<a name='7245'>
       &amp; 1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,9.999995e-01,&amp;<a name='7246'>
       &amp; 9.999995e-01,9.999990e-01,9.999991e-01,9.999991e-01,9.999990e-01,&amp;<a name='7247'>
       &amp; 9.999989e-01,9.999988e-01,9.999988e-01,9.999986e-01,9.999988e-01,&amp;<a name='7248'>
       &amp; 9.999986e-01,9.999987e-01,9.999986e-01,9.999985e-01,9.999985e-01,&amp;<a name='7249'>
       &amp; 9.999985e-01,9.999985e-01,9.999983e-01,9.999983e-01,9.999981e-01,&amp;<a name='7250'>
       &amp; 9.999981e-01,9.999986e-01,9.999985e-01,9.999983e-01,9.999984e-01,&amp;<a name='7251'>
       &amp; 9.999982e-01,9.999983e-01,9.999982e-01,9.999980e-01,9.999981e-01,&amp;<a name='7252'>
       &amp; 9.999978e-01,9.999979e-01,9.999985e-01,9.999985e-01,9.999983e-01,&amp;<a name='7253'>
       &amp; 9.999983e-01,9.999983e-01,9.999983e-01 /)<a name='7254'>
<font color=#447700>!     BAND  26<a name='7255'></font>
      ssaliq1(:, 26) = (/ &amp;<a name='7256'>
       &amp; 1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,&amp;<a name='7257'>
       &amp; 1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,&amp;<a name='7258'>
       &amp; 1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,&amp;<a name='7259'>
       &amp; 1.000000e+00,1.000000e+00,1.000000e+00,1.000000e+00,9.999991e-01,&amp;<a name='7260'>
       &amp; 9.999990e-01,9.999992e-01,9.999995e-01,9.999986e-01,9.999994e-01,&amp;<a name='7261'>
       &amp; 9.999985e-01,9.999980e-01,9.999984e-01,9.999983e-01,9.999979e-01,&amp;<a name='7262'>
       &amp; 9.999969e-01,9.999977e-01,9.999971e-01,9.999969e-01,9.999969e-01,&amp;<a name='7263'>
       &amp; 9.999965e-01,9.999970e-01,9.999985e-01,9.999973e-01,9.999961e-01,&amp;<a name='7264'>
       &amp; 9.999968e-01,9.999952e-01,9.999970e-01,9.999974e-01,9.999965e-01,&amp;<a name='7265'>
       &amp; 9.999969e-01,9.999970e-01,9.999970e-01,9.999960e-01,9.999923e-01,&amp;<a name='7266'>
       &amp; 9.999958e-01,9.999937e-01,9.999960e-01,9.999953e-01,9.999946e-01,&amp;<a name='7267'>
       &amp; 9.999946e-01,9.999957e-01,9.999951e-01 /)<a name='7268'>
<font color=#447700>!     BAND  27<a name='7269'></font>
      ssaliq1(:, 27) = (/ &amp;<a name='7270'>
       &amp; 1.000000e+00,1.000000e+00,9.999983e-01,9.999979e-01,9.999965e-01,&amp;<a name='7271'>
       &amp; 9.999949e-01,9.999948e-01,9.999918e-01,9.999917e-01,9.999923e-01,&amp;<a name='7272'>
       &amp; 9.999908e-01,9.999889e-01,9.999902e-01,9.999895e-01,9.999881e-01,&amp;<a name='7273'>
       &amp; 9.999882e-01,9.999876e-01,9.999866e-01,9.999866e-01,9.999858e-01,&amp;<a name='7274'>
       &amp; 9.999860e-01,9.999852e-01,9.999836e-01,9.999831e-01,9.999818e-01,&amp;<a name='7275'>
       &amp; 9.999808e-01,9.999816e-01,9.999800e-01,9.999783e-01,9.999780e-01,&amp;<a name='7276'>
       &amp; 9.999763e-01,9.999746e-01,9.999731e-01,9.999713e-01,9.999762e-01,&amp;<a name='7277'>
       &amp; 9.999740e-01,9.999670e-01,9.999703e-01,9.999687e-01,9.999666e-01,&amp;<a name='7278'>
       &amp; 9.999683e-01,9.999667e-01,9.999611e-01,9.999635e-01,9.999600e-01,&amp;<a name='7279'>
       &amp; 9.999635e-01,9.999594e-01,9.999601e-01,9.999586e-01,9.999559e-01,&amp;<a name='7280'>
       &amp; 9.999569e-01,9.999558e-01,9.999523e-01,9.999535e-01,9.999529e-01,&amp;<a name='7281'>
       &amp; 9.999553e-01,9.999495e-01,9.999490e-01 /)<a name='7282'>
<font color=#447700>!     BAND  28<a name='7283'></font>
      ssaliq1(:, 28) = (/ &amp;<a name='7284'>
       &amp; 9.999920e-01,9.999873e-01,9.999855e-01,9.999832e-01,9.999807e-01,&amp;<a name='7285'>
       &amp; 9.999778e-01,9.999754e-01,9.999721e-01,9.999692e-01,9.999651e-01,&amp;<a name='7286'>
       &amp; 9.999621e-01,9.999607e-01,9.999567e-01,9.999546e-01,9.999521e-01,&amp;<a name='7287'>
       &amp; 9.999491e-01,9.999457e-01,9.999439e-01,9.999403e-01,9.999374e-01,&amp;<a name='7288'>
       &amp; 9.999353e-01,9.999315e-01,9.999282e-01,9.999244e-01,9.999234e-01,&amp;<a name='7289'>
       &amp; 9.999189e-01,9.999130e-01,9.999117e-01,9.999073e-01,9.999020e-01,&amp;<a name='7290'>
       &amp; 9.998993e-01,9.998987e-01,9.998922e-01,9.998893e-01,9.998869e-01,&amp;<a name='7291'>
       &amp; 9.998805e-01,9.998778e-01,9.998751e-01,9.998708e-01,9.998676e-01,&amp;<a name='7292'>
       &amp; 9.998624e-01,9.998642e-01,9.998582e-01,9.998547e-01,9.998546e-01,&amp;<a name='7293'>
       &amp; 9.998477e-01,9.998487e-01,9.998466e-01,9.998403e-01,9.998412e-01,&amp;<a name='7294'>
       &amp; 9.998406e-01,9.998342e-01,9.998326e-01,9.998333e-01,9.998328e-01,&amp;<a name='7295'>
       &amp; 9.998290e-01,9.998276e-01,9.998249e-01 /)<a name='7296'>
<font color=#447700>!     BAND  29<a name='7297'></font>
      ssaliq1(:, 29) = (/ &amp;<a name='7298'>
       &amp; 8.383753e-01,8.461471e-01,8.373325e-01,8.212889e-01,8.023834e-01,&amp;<a name='7299'>
       &amp; 7.829501e-01,7.641777e-01,7.466000e-01,7.304023e-01,7.155998e-01,&amp;<a name='7300'>
       &amp; 7.021259e-01,6.898840e-01,6.787615e-01,6.686479e-01,6.594414e-01,&amp;<a name='7301'>
       &amp; 6.510417e-01,6.433668e-01,6.363335e-01,6.298788e-01,6.239398e-01,&amp;<a name='7302'>
       &amp; 6.184633e-01,6.134055e-01,6.087228e-01,6.043786e-01,6.003439e-01,&amp;<a name='7303'>
       &amp; 5.965910e-01,5.930917e-01,5.898280e-01,5.867798e-01,5.839264e-01,&amp;<a name='7304'>
       &amp; 5.812576e-01,5.787592e-01,5.764163e-01,5.742189e-01,5.721598e-01,&amp;<a name='7305'>
       &amp; 5.702286e-01,5.684182e-01,5.667176e-01,5.651237e-01,5.636253e-01,&amp;<a name='7306'>
       &amp; 5.622228e-01,5.609074e-01,5.596713e-01,5.585089e-01,5.574223e-01,&amp;<a name='7307'>
       &amp; 5.564002e-01,5.554411e-01,5.545397e-01,5.536914e-01,5.528967e-01,&amp;<a name='7308'>
       &amp; 5.521495e-01,5.514457e-01,5.507818e-01,5.501623e-01,5.495750e-01,&amp;<a name='7309'>
       &amp; 5.490192e-01,5.484980e-01,5.480046e-01 /)<a name='7310'>
<a name='7311'>
<font color=#447700>! Asymmetry parameter<a name='7312'></font>
<font color=#447700>!     BAND  16<a name='7313'></font>
      asyliq1(:, 16) = (/ &amp;<a name='7314'>
       &amp; 8.038165e-01,8.014154e-01,7.942381e-01,7.970521e-01,8.086621e-01,&amp;<a name='7315'>
       &amp; 8.233392e-01,8.374127e-01,8.495742e-01,8.596945e-01,8.680497e-01,&amp;<a name='7316'>
       &amp; 8.750005e-01,8.808589e-01,8.858749e-01,8.902403e-01,8.940939e-01,&amp;<a name='7317'>
       &amp; 8.975379e-01,9.006450e-01,9.034741e-01,9.060659e-01,9.084561e-01,&amp;<a name='7318'>
       &amp; 9.106675e-01,9.127198e-01,9.146332e-01,9.164194e-01,9.180970e-01,&amp;<a name='7319'>
       &amp; 9.196658e-01,9.211421e-01,9.225352e-01,9.238443e-01,9.250841e-01,&amp;<a name='7320'>
       &amp; 9.262541e-01,9.273620e-01,9.284081e-01,9.294002e-01,9.303395e-01,&amp;<a name='7321'>
       &amp; 9.312285e-01,9.320715e-01,9.328716e-01,9.336271e-01,9.343427e-01,&amp;<a name='7322'>
       &amp; 9.350219e-01,9.356647e-01,9.362728e-01,9.368495e-01,9.373956e-01,&amp;<a name='7323'>
       &amp; 9.379113e-01,9.383987e-01,9.388608e-01,9.392986e-01,9.397132e-01,&amp;<a name='7324'>
       &amp; 9.401063e-01,9.404776e-01,9.408299e-01,9.411641e-01,9.414800e-01,&amp;<a name='7325'>
       &amp; 9.417787e-01,9.420633e-01,9.423364e-01 /)<a name='7326'>
<font color=#447700>!     BAND  17<a name='7327'></font>
      asyliq1(:, 17) = (/ &amp;<a name='7328'>
       &amp; 8.941000e-01,9.054049e-01,9.049510e-01,9.027216e-01,9.021636e-01,&amp;<a name='7329'>
       &amp; 9.037878e-01,9.069852e-01,9.109817e-01,9.152013e-01,9.193040e-01,&amp;<a name='7330'>
       &amp; 9.231177e-01,9.265712e-01,9.296606e-01,9.324048e-01,9.348419e-01,&amp;<a name='7331'>
       &amp; 9.370131e-01,9.389529e-01,9.406954e-01,9.422727e-01,9.437088e-01,&amp;<a name='7332'>
       &amp; 9.450221e-01,9.462308e-01,9.473488e-01,9.483830e-01,9.493492e-01,&amp;<a name='7333'>
       &amp; 9.502541e-01,9.510999e-01,9.518971e-01,9.526455e-01,9.533554e-01,&amp;<a name='7334'>
       &amp; 9.540249e-01,9.546571e-01,9.552551e-01,9.558258e-01,9.563603e-01,&amp;<a name='7335'>
       &amp; 9.568713e-01,9.573569e-01,9.578141e-01,9.582485e-01,9.586604e-01,&amp;<a name='7336'>
       &amp; 9.590525e-01,9.594218e-01,9.597710e-01,9.601052e-01,9.604181e-01,&amp;<a name='7337'>
       &amp; 9.607159e-01,9.609979e-01,9.612655e-01,9.615184e-01,9.617564e-01,&amp;<a name='7338'>
       &amp; 9.619860e-01,9.622009e-01,9.624031e-01,9.625957e-01,9.627792e-01,&amp;<a name='7339'>
       &amp; 9.629530e-01,9.631171e-01,9.632746e-01 /)<a name='7340'>
<font color=#447700>!     BAND  18<a name='7341'></font>
      asyliq1(:, 18) = (/ &amp;<a name='7342'>
       &amp; 8.574638e-01,8.351383e-01,8.142977e-01,8.083068e-01,8.129284e-01,&amp;<a name='7343'>
       &amp; 8.215827e-01,8.307238e-01,8.389963e-01,8.460481e-01,8.519273e-01,&amp;<a name='7344'>
       &amp; 8.568153e-01,8.609116e-01,8.643892e-01,8.673941e-01,8.700248e-01,&amp;<a name='7345'>
       &amp; 8.723707e-01,8.744902e-01,8.764240e-01,8.782057e-01,8.798593e-01,&amp;<a name='7346'>
       &amp; 8.814063e-01,8.828573e-01,8.842261e-01,8.855196e-01,8.867497e-01,&amp;<a name='7347'>
       &amp; 8.879164e-01,8.890316e-01,8.900941e-01,8.911118e-01,8.920832e-01,&amp;<a name='7348'>
       &amp; 8.930156e-01,8.939091e-01,8.947663e-01,8.955888e-01,8.963786e-01,&amp;<a name='7349'>
       &amp; 8.971350e-01,8.978617e-01,8.985590e-01,8.992243e-01,8.998631e-01,&amp;<a name='7350'>
       &amp; 9.004753e-01,9.010602e-01,9.016192e-01,9.021542e-01,9.026644e-01,&amp;<a name='7351'>
       &amp; 9.031535e-01,9.036194e-01,9.040656e-01,9.044894e-01,9.048933e-01,&amp;<a name='7352'>
       &amp; 9.052789e-01,9.056481e-01,9.060004e-01,9.063343e-01,9.066544e-01,&amp;<a name='7353'>
       &amp; 9.069604e-01,9.072512e-01,9.075290e-01 /)<a name='7354'>
<font color=#447700>!     BAND  19<a name='7355'></font>
      asyliq1(:, 19) = (/ &amp;<a name='7356'>
       &amp; 8.349569e-01,8.034579e-01,7.932136e-01,8.010156e-01,8.137083e-01,&amp;<a name='7357'>
       &amp; 8.255339e-01,8.351938e-01,8.428286e-01,8.488944e-01,8.538187e-01,&amp;<a name='7358'>
       &amp; 8.579255e-01,8.614473e-01,8.645338e-01,8.672908e-01,8.697947e-01,&amp;<a name='7359'>
       &amp; 8.720843e-01,8.742015e-01,8.761718e-01,8.780160e-01,8.797479e-01,&amp;<a name='7360'>
       &amp; 8.813810e-01,8.829250e-01,8.843907e-01,8.857822e-01,8.871059e-01,&amp;<a name='7361'>
       &amp; 8.883724e-01,8.895810e-01,8.907384e-01,8.918456e-01,8.929083e-01,&amp;<a name='7362'>
       &amp; 8.939284e-01,8.949060e-01,8.958463e-01,8.967486e-01,8.976129e-01,&amp;<a name='7363'>
       &amp; 8.984463e-01,8.992439e-01,9.000094e-01,9.007438e-01,9.014496e-01,&amp;<a name='7364'>
       &amp; 9.021235e-01,9.027699e-01,9.033859e-01,9.039772e-01,9.045419e-01,&amp;<a name='7365'>
       &amp; 9.050819e-01,9.055975e-01,9.060907e-01,9.065607e-01,9.070093e-01,&amp;<a name='7366'>
       &amp; 9.074389e-01,9.078475e-01,9.082388e-01,9.086117e-01,9.089678e-01,&amp;<a name='7367'>
       &amp; 9.093081e-01,9.096307e-01,9.099410e-01 /)<a name='7368'>
<font color=#447700>!     BAND  20<a name='7369'></font>
      asyliq1(:, 20) = (/ &amp;<a name='7370'>
       &amp; 8.109692e-01,7.846657e-01,7.881928e-01,8.009509e-01,8.131208e-01,&amp;<a name='7371'>
       &amp; 8.230400e-01,8.309448e-01,8.372920e-01,8.424837e-01,8.468166e-01,&amp;<a name='7372'>
       &amp; 8.504947e-01,8.536642e-01,8.564256e-01,8.588513e-01,8.610011e-01,&amp;<a name='7373'>
       &amp; 8.629122e-01,8.646262e-01,8.661720e-01,8.675752e-01,8.688582e-01,&amp;<a name='7374'>
       &amp; 8.700379e-01,8.711300e-01,8.721485e-01,8.731027e-01,8.740010e-01,&amp;<a name='7375'>
       &amp; 8.748499e-01,8.756564e-01,8.764239e-01,8.771542e-01,8.778523e-01,&amp;<a name='7376'>
       &amp; 8.785211e-01,8.791601e-01,8.797725e-01,8.803589e-01,8.809173e-01,&amp;<a name='7377'>
       &amp; 8.814552e-01,8.819705e-01,8.824611e-01,8.829311e-01,8.833791e-01,&amp;<a name='7378'>
       &amp; 8.838078e-01,8.842148e-01,8.846044e-01,8.849756e-01,8.853291e-01,&amp;<a name='7379'>
       &amp; 8.856645e-01,8.859841e-01,8.862904e-01,8.865801e-01,8.868551e-01,&amp;<a name='7380'>
       &amp; 8.871182e-01,8.873673e-01,8.876059e-01,8.878307e-01,8.880462e-01,&amp;<a name='7381'>
       &amp; 8.882501e-01,8.884453e-01,8.886339e-01 /)<a name='7382'>
<font color=#447700>!     BAND  21<a name='7383'></font>
      asyliq1(:, 21) = (/ &amp;<a name='7384'>
       &amp; 7.838510e-01,7.803151e-01,7.980477e-01,8.144160e-01,8.261784e-01,&amp;<a name='7385'>
       &amp; 8.344240e-01,8.404278e-01,8.450391e-01,8.487593e-01,8.518741e-01,&amp;<a name='7386'>
       &amp; 8.545484e-01,8.568890e-01,8.589560e-01,8.607983e-01,8.624504e-01,&amp;<a name='7387'>
       &amp; 8.639408e-01,8.652945e-01,8.665301e-01,8.676634e-01,8.687121e-01,&amp;<a name='7388'>
       &amp; 8.696855e-01,8.705933e-01,8.714448e-01,8.722454e-01,8.730014e-01,&amp;<a name='7389'>
       &amp; 8.737180e-01,8.743982e-01,8.750436e-01,8.756598e-01,8.762481e-01,&amp;<a name='7390'>
       &amp; 8.768089e-01,8.773427e-01,8.778532e-01,8.783434e-01,8.788089e-01,&amp;<a name='7391'>
       &amp; 8.792530e-01,8.796784e-01,8.800845e-01,8.804716e-01,8.808411e-01,&amp;<a name='7392'>
       &amp; 8.811923e-01,8.815276e-01,8.818472e-01,8.821504e-01,8.824408e-01,&amp;<a name='7393'>
       &amp; 8.827155e-01,8.829777e-01,8.832269e-01,8.834631e-01,8.836892e-01,&amp;<a name='7394'>
       &amp; 8.839034e-01,8.841075e-01,8.843021e-01,8.844866e-01,8.846631e-01,&amp;<a name='7395'>
       &amp; 8.848304e-01,8.849910e-01,8.851425e-01 /)<a name='7396'>
<font color=#447700>!     BAND  22<a name='7397'></font>
      asyliq1(:, 22) = (/ &amp;<a name='7398'>
       &amp; 7.760783e-01,7.890215e-01,8.090192e-01,8.230252e-01,8.321369e-01,&amp;<a name='7399'>
       &amp; 8.384258e-01,8.431529e-01,8.469558e-01,8.501499e-01,8.528899e-01,&amp;<a name='7400'>
       &amp; 8.552899e-01,8.573956e-01,8.592570e-01,8.609098e-01,8.623897e-01,&amp;<a name='7401'>
       &amp; 8.637169e-01,8.649184e-01,8.660097e-01,8.670096e-01,8.679338e-01,&amp;<a name='7402'>
       &amp; 8.687896e-01,8.695880e-01,8.703365e-01,8.710422e-01,8.717092e-01,&amp;<a name='7403'>
       &amp; 8.723378e-01,8.729363e-01,8.735063e-01,8.740475e-01,8.745661e-01,&amp;<a name='7404'>
       &amp; 8.750560e-01,8.755275e-01,8.759731e-01,8.764000e-01,8.768071e-01,&amp;<a name='7405'>
       &amp; 8.771942e-01,8.775628e-01,8.779126e-01,8.782483e-01,8.785626e-01,&amp;<a name='7406'>
       &amp; 8.788610e-01,8.791482e-01,8.794180e-01,8.796765e-01,8.799207e-01,&amp;<a name='7407'>
       &amp; 8.801522e-01,8.803707e-01,8.805777e-01,8.807749e-01,8.809605e-01,&amp;<a name='7408'>
       &amp; 8.811362e-01,8.813047e-01,8.814647e-01,8.816131e-01,8.817588e-01,&amp;<a name='7409'>
       &amp; 8.818930e-01,8.820230e-01,8.821445e-01 /)<a name='7410'>
<font color=#447700>!     BAND  23<a name='7411'></font>
      asyliq1(:, 23) = (/ &amp;<a name='7412'>
       &amp; 7.847907e-01,8.099917e-01,8.257428e-01,8.350423e-01,8.411971e-01,&amp;<a name='7413'>
       &amp; 8.457241e-01,8.493010e-01,8.522565e-01,8.547660e-01,8.569311e-01,&amp;<a name='7414'>
       &amp; 8.588181e-01,8.604729e-01,8.619296e-01,8.632208e-01,8.643725e-01,&amp;<a name='7415'>
       &amp; 8.654050e-01,8.663363e-01,8.671835e-01,8.679590e-01,8.686707e-01,&amp;<a name='7416'>
       &amp; 8.693308e-01,8.699433e-01,8.705147e-01,8.710490e-01,8.715497e-01,&amp;<a name='7417'>
       &amp; 8.720219e-01,8.724669e-01,8.728849e-01,8.732806e-01,8.736550e-01,&amp;<a name='7418'>
       &amp; 8.740099e-01,8.743435e-01,8.746601e-01,8.749610e-01,8.752449e-01,&amp;<a name='7419'>
       &amp; 8.755143e-01,8.757688e-01,8.760095e-01,8.762375e-01,8.764532e-01,&amp;<a name='7420'>
       &amp; 8.766579e-01,8.768506e-01,8.770323e-01,8.772049e-01,8.773690e-01,&amp;<a name='7421'>
       &amp; 8.775226e-01,8.776679e-01,8.778062e-01,8.779360e-01,8.780587e-01,&amp;<a name='7422'>
       &amp; 8.781747e-01,8.782852e-01,8.783892e-01,8.784891e-01,8.785824e-01,&amp;<a name='7423'>
       &amp; 8.786705e-01,8.787546e-01,8.788336e-01 /)<a name='7424'>
<font color=#447700>!     BAND  24<a name='7425'></font>
      asyliq1(:, 24) = (/ &amp;<a name='7426'>
       &amp; 8.054324e-01,8.266282e-01,8.378075e-01,8.449848e-01,8.502166e-01,&amp;<a name='7427'>
       &amp; 8.542268e-01,8.573477e-01,8.598022e-01,8.617689e-01,8.633859e-01,&amp;<a name='7428'>
       &amp; 8.647536e-01,8.659354e-01,8.669807e-01,8.679143e-01,8.687577e-01,&amp;<a name='7429'>
       &amp; 8.695222e-01,8.702207e-01,8.708591e-01,8.714446e-01,8.719836e-01,&amp;<a name='7430'>
       &amp; 8.724812e-01,8.729426e-01,8.733689e-01,8.737665e-01,8.741373e-01,&amp;<a name='7431'>
       &amp; 8.744834e-01,8.748070e-01,8.751131e-01,8.754011e-01,8.756676e-01,&amp;<a name='7432'>
       &amp; 8.759219e-01,8.761599e-01,8.763857e-01,8.765984e-01,8.767999e-01,&amp;<a name='7433'>
       &amp; 8.769889e-01,8.771669e-01,8.773373e-01,8.774969e-01,8.776469e-01,&amp;<a name='7434'>
       &amp; 8.777894e-01,8.779237e-01,8.780505e-01,8.781703e-01,8.782820e-01,&amp;<a name='7435'>
       &amp; 8.783886e-01,8.784894e-01,8.785844e-01,8.786736e-01,8.787584e-01,&amp;<a name='7436'>
       &amp; 8.788379e-01,8.789130e-01,8.789849e-01,8.790506e-01,8.791141e-01,&amp;<a name='7437'>
       &amp; 8.791750e-01,8.792324e-01,8.792867e-01 /)<a name='7438'>
<font color=#447700>!     BAND  25<a name='7439'></font>
      asyliq1(:, 25) = (/ &amp;<a name='7440'>
       &amp; 8.249534e-01,8.391988e-01,8.474107e-01,8.526860e-01,8.563983e-01,&amp;<a name='7441'>
       &amp; 8.592389e-01,8.615144e-01,8.633790e-01,8.649325e-01,8.662504e-01,&amp;<a name='7442'>
       &amp; 8.673841e-01,8.683741e-01,8.692495e-01,8.700309e-01,8.707328e-01,&amp;<a name='7443'>
       &amp; 8.713650e-01,8.719432e-01,8.724676e-01,8.729498e-01,8.733922e-01,&amp;<a name='7444'>
       &amp; 8.737981e-01,8.741745e-01,8.745225e-01,8.748467e-01,8.751512e-01,&amp;<a name='7445'>
       &amp; 8.754315e-01,8.756962e-01,8.759450e-01,8.761774e-01,8.763945e-01,&amp;<a name='7446'>
       &amp; 8.766021e-01,8.767970e-01,8.769803e-01,8.771511e-01,8.773151e-01,&amp;<a name='7447'>
       &amp; 8.774689e-01,8.776147e-01,8.777533e-01,8.778831e-01,8.780050e-01,&amp;<a name='7448'>
       &amp; 8.781197e-01,8.782301e-01,8.783323e-01,8.784312e-01,8.785222e-01,&amp;<a name='7449'>
       &amp; 8.786096e-01,8.786916e-01,8.787688e-01,8.788411e-01,8.789122e-01,&amp;<a name='7450'>
       &amp; 8.789762e-01,8.790373e-01,8.790954e-01,8.791514e-01,8.792018e-01,&amp;<a name='7451'>
       &amp; 8.792517e-01,8.792990e-01,8.793429e-01 /)<a name='7452'>
<font color=#447700>!     BAND  26<a name='7453'></font>
      asyliq1(:, 26) = (/ &amp;<a name='7454'>
       &amp; 8.323091e-01,8.429776e-01,8.498123e-01,8.546929e-01,8.584295e-01,&amp;<a name='7455'>
       &amp; 8.613489e-01,8.636324e-01,8.654303e-01,8.668675e-01,8.680404e-01,&amp;<a name='7456'>
       &amp; 8.690174e-01,8.698495e-01,8.705666e-01,8.711961e-01,8.717556e-01,&amp;<a name='7457'>
       &amp; 8.722546e-01,8.727063e-01,8.731170e-01,8.734933e-01,8.738382e-01,&amp;<a name='7458'>
       &amp; 8.741590e-01,8.744525e-01,8.747295e-01,8.749843e-01,8.752210e-01,&amp;<a name='7459'>
       &amp; 8.754437e-01,8.756524e-01,8.758472e-01,8.760288e-01,8.762030e-01,&amp;<a name='7460'>
       &amp; 8.763603e-01,8.765122e-01,8.766539e-01,8.767894e-01,8.769130e-01,&amp;<a name='7461'>
       &amp; 8.770310e-01,8.771422e-01,8.772437e-01,8.773419e-01,8.774355e-01,&amp;<a name='7462'>
       &amp; 8.775221e-01,8.776047e-01,8.776802e-01,8.777539e-01,8.778216e-01,&amp;<a name='7463'>
       &amp; 8.778859e-01,8.779473e-01,8.780031e-01,8.780562e-01,8.781097e-01,&amp;<a name='7464'>
       &amp; 8.781570e-01,8.782021e-01,8.782463e-01,8.782845e-01,8.783235e-01,&amp;<a name='7465'>
       &amp; 8.783610e-01,8.783953e-01,8.784273e-01 /)<a name='7466'>
<font color=#447700>!     BAND  27<a name='7467'></font>
      asyliq1(:, 27) = (/ &amp;<a name='7468'>
       &amp; 8.396448e-01,8.480172e-01,8.535934e-01,8.574145e-01,8.600835e-01,&amp;<a name='7469'>
       &amp; 8.620347e-01,8.635500e-01,8.648003e-01,8.658758e-01,8.668248e-01,&amp;<a name='7470'>
       &amp; 8.676697e-01,8.684220e-01,8.690893e-01,8.696807e-01,8.702046e-01,&amp;<a name='7471'>
       &amp; 8.706676e-01,8.710798e-01,8.714478e-01,8.717778e-01,8.720747e-01,&amp;<a name='7472'>
       &amp; 8.723431e-01,8.725889e-01,8.728144e-01,8.730201e-01,8.732129e-01,&amp;<a name='7473'>
       &amp; 8.733907e-01,8.735541e-01,8.737100e-01,8.738533e-01,8.739882e-01,&amp;<a name='7474'>
       &amp; 8.741164e-01,8.742362e-01,8.743485e-01,8.744530e-01,8.745512e-01,&amp;<a name='7475'>
       &amp; 8.746471e-01,8.747373e-01,8.748186e-01,8.748973e-01,8.749732e-01,&amp;<a name='7476'>
       &amp; 8.750443e-01,8.751105e-01,8.751747e-01,8.752344e-01,8.752902e-01,&amp;<a name='7477'>
       &amp; 8.753412e-01,8.753917e-01,8.754393e-01,8.754843e-01,8.755282e-01,&amp;<a name='7478'>
       &amp; 8.755662e-01,8.756039e-01,8.756408e-01,8.756722e-01,8.757072e-01,&amp;<a name='7479'>
       &amp; 8.757352e-01,8.757653e-01,8.757932e-01 /)<a name='7480'>
<font color=#447700>!     BAND  28<a name='7481'></font>
      asyliq1(:, 28) = (/ &amp;<a name='7482'>
       &amp; 8.374590e-01,8.465669e-01,8.518701e-01,8.547627e-01,8.565745e-01,&amp;<a name='7483'>
       &amp; 8.579065e-01,8.589717e-01,8.598632e-01,8.606363e-01,8.613268e-01,&amp;<a name='7484'>
       &amp; 8.619560e-01,8.625340e-01,8.630689e-01,8.635601e-01,8.640084e-01,&amp;<a name='7485'>
       &amp; 8.644180e-01,8.647885e-01,8.651220e-01,8.654218e-01,8.656908e-01,&amp;<a name='7486'>
       &amp; 8.659294e-01,8.661422e-01,8.663334e-01,8.665037e-01,8.666543e-01,&amp;<a name='7487'>
       &amp; 8.667913e-01,8.669156e-01,8.670242e-01,8.671249e-01,8.672161e-01,&amp;<a name='7488'>
       &amp; 8.672993e-01,8.673733e-01,8.674457e-01,8.675103e-01,8.675713e-01,&amp;<a name='7489'>
       &amp; 8.676267e-01,8.676798e-01,8.677286e-01,8.677745e-01,8.678178e-01,&amp;<a name='7490'>
       &amp; 8.678601e-01,8.678986e-01,8.679351e-01,8.679693e-01,8.680013e-01,&amp;<a name='7491'>
       &amp; 8.680334e-01,8.680624e-01,8.680915e-01,8.681178e-01,8.681428e-01,&amp;<a name='7492'>
       &amp; 8.681654e-01,8.681899e-01,8.682103e-01,8.682317e-01,8.682498e-01,&amp;<a name='7493'>
       &amp; 8.682677e-01,8.682861e-01,8.683041e-01 /)<a name='7494'>
<font color=#447700>!     BAND  29<a name='7495'></font>
      asyliq1(:, 29) = (/ &amp;<a name='7496'>
       &amp; 7.877069e-01,8.244281e-01,8.367971e-01,8.409074e-01,8.429859e-01,&amp;<a name='7497'>
       &amp; 8.454386e-01,8.489350e-01,8.534141e-01,8.585814e-01,8.641267e-01,&amp;<a name='7498'>
       &amp; 8.697999e-01,8.754223e-01,8.808785e-01,8.860944e-01,8.910354e-01,&amp;<a name='7499'>
       &amp; 8.956837e-01,9.000392e-01,9.041091e-01,9.079071e-01,9.114479e-01,&amp;<a name='7500'>
       &amp; 9.147462e-01,9.178234e-01,9.206903e-01,9.233663e-01,9.258668e-01,&amp;<a name='7501'>
       &amp; 9.282006e-01,9.303847e-01,9.324288e-01,9.343418e-01,9.361356e-01,&amp;<a name='7502'>
       &amp; 9.378176e-01,9.393939e-01,9.408736e-01,9.422622e-01,9.435670e-01,&amp;<a name='7503'>
       &amp; 9.447900e-01,9.459395e-01,9.470199e-01,9.480335e-01,9.489852e-01,&amp;<a name='7504'>
       &amp; 9.498782e-01,9.507168e-01,9.515044e-01,9.522470e-01,9.529409e-01,&amp;<a name='7505'>
       &amp; 9.535946e-01,9.542071e-01,9.547838e-01,9.553256e-01,9.558351e-01,&amp;<a name='7506'>
       &amp; 9.563139e-01,9.567660e-01,9.571915e-01,9.575901e-01,9.579685e-01,&amp;<a name='7507'>
       &amp; 9.583239e-01,9.586602e-01,9.589766e-01 /)<a name='7508'>
<a name='7509'>
<a name='7510'>
<font color=#447700>! Spherical Ice Particle Parameterization<a name='7511'></font>
<font color=#447700>! extinction units (ext coef/iwc): [(m^-1)/(g m^-3)]<a name='7512'></font>
      extice2(:, 16) = (/ &amp;<a name='7513'>
<font color=#447700>! band 16<a name='7514'></font>
        &amp; 4.101824e-01 ,2.435514e-01 ,1.713697e-01 ,1.314865e-01 ,1.063406e-01 ,&amp;<a name='7515'>
        &amp; 8.910701e-02 ,7.659480e-02 ,6.711784e-02 ,5.970353e-02 ,5.375249e-02 ,&amp;<a name='7516'>
        &amp; 4.887577e-02 ,4.481025e-02 ,4.137171e-02 ,3.842744e-02 ,3.587948e-02 ,&amp;<a name='7517'>
        &amp; 3.365396e-02 ,3.169419e-02 ,2.995593e-02 ,2.840419e-02 ,2.701091e-02 ,&amp;<a name='7518'>
        &amp; 2.575336e-02 ,2.461293e-02 ,2.357423e-02 ,2.262443e-02 ,2.175276e-02 ,&amp;<a name='7519'>
        &amp; 2.095012e-02 ,2.020875e-02 ,1.952199e-02 ,1.888412e-02 ,1.829018e-02 ,&amp;<a name='7520'>
        &amp; 1.773586e-02 ,1.721738e-02 ,1.673144e-02 ,1.627510e-02 ,1.584579e-02 ,&amp;<a name='7521'>
        &amp; 1.544122e-02 ,1.505934e-02 ,1.469833e-02 ,1.435654e-02 ,1.403251e-02 ,&amp;<a name='7522'>
        &amp; 1.372492e-02 ,1.343255e-02 ,1.315433e-02  /)<a name='7523'>
      extice2(:, 17) = (/ &amp;<a name='7524'>
<font color=#447700>! band 17<a name='7525'></font>
        &amp; 3.836650e-01 ,2.304055e-01 ,1.637265e-01 ,1.266681e-01 ,1.031602e-01 ,&amp;<a name='7526'>
        &amp; 8.695191e-02 ,7.511544e-02 ,6.610009e-02 ,5.900909e-02 ,5.328833e-02 ,&amp;<a name='7527'>
        &amp; 4.857728e-02 ,4.463133e-02 ,4.127880e-02 ,3.839567e-02 ,3.589013e-02 ,&amp;<a name='7528'>
        &amp; 3.369280e-02 ,3.175027e-02 ,3.002079e-02 ,2.847121e-02 ,2.707493e-02 ,&amp;<a name='7529'>
        &amp; 2.581031e-02 ,2.465962e-02 ,2.360815e-02 ,2.264363e-02 ,2.175571e-02 ,&amp;<a name='7530'>
        &amp; 2.093563e-02 ,2.017592e-02 ,1.947015e-02 ,1.881278e-02 ,1.819901e-02 ,&amp;<a name='7531'>
        &amp; 1.762463e-02 ,1.708598e-02 ,1.657982e-02 ,1.610330e-02 ,1.565390e-02 ,&amp;<a name='7532'>
        &amp; 1.522937e-02 ,1.482768e-02 ,1.444706e-02 ,1.408588e-02 ,1.374270e-02 ,&amp;<a name='7533'>
        &amp; 1.341619e-02 ,1.310517e-02 ,1.280857e-02  /)<a name='7534'>
      extice2(:, 18) = (/ &amp;<a name='7535'>
<font color=#447700>! band 18<a name='7536'></font>
        &amp; 4.152673e-01 ,2.436816e-01 ,1.702243e-01 ,1.299704e-01 ,1.047528e-01 ,&amp;<a name='7537'>
        &amp; 8.756039e-02 ,7.513327e-02 ,6.575690e-02 ,5.844616e-02 ,5.259609e-02 ,&amp;<a name='7538'>
        &amp; 4.781531e-02 ,4.383980e-02 ,4.048517e-02 ,3.761891e-02 ,3.514342e-02 ,&amp;<a name='7539'>
        &amp; 3.298525e-02 ,3.108814e-02 ,2.940825e-02 ,2.791096e-02 ,2.656858e-02 ,&amp;<a name='7540'>
        &amp; 2.535869e-02 ,2.426297e-02 ,2.326627e-02 ,2.235602e-02 ,2.152164e-02 ,&amp;<a name='7541'>
        &amp; 2.075420e-02 ,2.004613e-02 ,1.939091e-02 ,1.878296e-02 ,1.821744e-02 ,&amp;<a name='7542'>
        &amp; 1.769015e-02 ,1.719741e-02 ,1.673600e-02 ,1.630308e-02 ,1.589615e-02 ,&amp;<a name='7543'>
        &amp; 1.551298e-02 ,1.515159e-02 ,1.481021e-02 ,1.448726e-02 ,1.418131e-02 ,&amp;<a name='7544'>
        &amp; 1.389109e-02 ,1.361544e-02 ,1.335330e-02  /)<a name='7545'>
      extice2(:, 19) = (/ &amp;<a name='7546'>
<font color=#447700>! band 19<a name='7547'></font>
        &amp; 3.873250e-01 ,2.331609e-01 ,1.655002e-01 ,1.277753e-01 ,1.038247e-01 ,&amp;<a name='7548'>
        &amp; 8.731780e-02 ,7.527638e-02 ,6.611873e-02 ,5.892850e-02 ,5.313885e-02 ,&amp;<a name='7549'>
        &amp; 4.838068e-02 ,4.440356e-02 ,4.103167e-02 ,3.813804e-02 ,3.562870e-02 ,&amp;<a name='7550'>
        &amp; 3.343269e-02 ,3.149539e-02 ,2.977414e-02 ,2.823510e-02 ,2.685112e-02 ,&amp;<a name='7551'>
        &amp; 2.560015e-02 ,2.446411e-02 ,2.342805e-02 ,2.247948e-02 ,2.160789e-02 ,&amp;<a name='7552'>
        &amp; 2.080438e-02 ,2.006139e-02 ,1.937238e-02 ,1.873177e-02 ,1.813469e-02 ,&amp;<a name='7553'>
        &amp; 1.757689e-02 ,1.705468e-02 ,1.656479e-02 ,1.610435e-02 ,1.567081e-02 ,&amp;<a name='7554'>
        &amp; 1.526192e-02 ,1.487565e-02 ,1.451020e-02 ,1.416396e-02 ,1.383546e-02 ,&amp;<a name='7555'>
        &amp; 1.352339e-02 ,1.322657e-02 ,1.294392e-02  /)<a name='7556'>
      extice2(:, 20) = (/ &amp;<a name='7557'>
<font color=#447700>! band 20<a name='7558'></font>
        &amp; 3.784280e-01 ,2.291396e-01 ,1.632551e-01 ,1.263775e-01 ,1.028944e-01 ,&amp;<a name='7559'>
        &amp; 8.666975e-02 ,7.480952e-02 ,6.577335e-02 ,5.866714e-02 ,5.293694e-02 ,&amp;<a name='7560'>
        &amp; 4.822153e-02 ,4.427547e-02 ,4.092626e-02 ,3.804918e-02 ,3.555184e-02 ,&amp;<a name='7561'>
        &amp; 3.336440e-02 ,3.143307e-02 ,2.971577e-02 ,2.817912e-02 ,2.679632e-02 ,&amp;<a name='7562'>
        &amp; 2.554558e-02 ,2.440903e-02 ,2.337187e-02 ,2.242173e-02 ,2.154821e-02 ,&amp;<a name='7563'>
        &amp; 2.074249e-02 ,1.999706e-02 ,1.930546e-02 ,1.866212e-02 ,1.806221e-02 ,&amp;<a name='7564'>
        &amp; 1.750152e-02 ,1.697637e-02 ,1.648352e-02 ,1.602010e-02 ,1.558358e-02 ,&amp;<a name='7565'>
        &amp; 1.517172e-02 ,1.478250e-02 ,1.441413e-02 ,1.406498e-02 ,1.373362e-02 ,&amp;<a name='7566'>
        &amp; 1.341872e-02 ,1.311911e-02 ,1.283371e-02  /)<a name='7567'>
      extice2(:, 21) = (/ &amp;<a name='7568'>
<font color=#447700>! band 21<a name='7569'></font>
        &amp; 3.719909e-01 ,2.259490e-01 ,1.613144e-01 ,1.250648e-01 ,1.019462e-01 ,&amp;<a name='7570'>
        &amp; 8.595358e-02 ,7.425064e-02 ,6.532618e-02 ,5.830218e-02 ,5.263421e-02 ,&amp;<a name='7571'>
        &amp; 4.796697e-02 ,4.405891e-02 ,4.074013e-02 ,3.788776e-02 ,3.541071e-02 ,&amp;<a name='7572'>
        &amp; 3.324008e-02 ,3.132280e-02 ,2.961733e-02 ,2.809071e-02 ,2.671645e-02 ,&amp;<a name='7573'>
        &amp; 2.547302e-02 ,2.434276e-02 ,2.331102e-02 ,2.236558e-02 ,2.149614e-02 ,&amp;<a name='7574'>
        &amp; 2.069397e-02 ,1.995163e-02 ,1.926272e-02 ,1.862174e-02 ,1.802389e-02 ,&amp;<a name='7575'>
        &amp; 1.746500e-02 ,1.694142e-02 ,1.644994e-02 ,1.598772e-02 ,1.555225e-02 ,&amp;<a name='7576'>
        &amp; 1.514129e-02 ,1.475286e-02 ,1.438515e-02 ,1.403659e-02 ,1.370572e-02 ,&amp;<a name='7577'>
        &amp; 1.339124e-02 ,1.309197e-02 ,1.280685e-02  /)<a name='7578'>
      extice2(:, 22) = (/ &amp;<a name='7579'>
<font color=#447700>! band 22<a name='7580'></font>
        &amp; 3.713158e-01 ,2.253816e-01 ,1.608461e-01 ,1.246718e-01 ,1.016109e-01 ,&amp;<a name='7581'>
        &amp; 8.566332e-02 ,7.399666e-02 ,6.510199e-02 ,5.810290e-02 ,5.245608e-02 ,&amp;<a name='7582'>
        &amp; 4.780702e-02 ,4.391478e-02 ,4.060989e-02 ,3.776982e-02 ,3.530374e-02 ,&amp;<a name='7583'>
        &amp; 3.314296e-02 ,3.123458e-02 ,2.953719e-02 ,2.801794e-02 ,2.665043e-02 ,&amp;<a name='7584'>
        &amp; 2.541321e-02 ,2.428868e-02 ,2.326224e-02 ,2.232173e-02 ,2.145688e-02 ,&amp;<a name='7585'>
        &amp; 2.065899e-02 ,1.992067e-02 ,1.923552e-02 ,1.859808e-02 ,1.800356e-02 ,&amp;<a name='7586'>
        &amp; 1.744782e-02 ,1.692721e-02 ,1.643855e-02 ,1.597900e-02 ,1.554606e-02 ,&amp;<a name='7587'>
        &amp; 1.513751e-02 ,1.475137e-02 ,1.438586e-02 ,1.403938e-02 ,1.371050e-02 ,&amp;<a name='7588'>
        &amp; 1.339793e-02 ,1.310050e-02 ,1.281713e-02  /)<a name='7589'>
      extice2(:, 23) = (/ &amp;<a name='7590'>
<font color=#447700>! band 23<a name='7591'></font>
        &amp; 3.605883e-01 ,2.204388e-01 ,1.580431e-01 ,1.229033e-01 ,1.004203e-01 ,&amp;<a name='7592'>
        &amp; 8.482616e-02 ,7.338941e-02 ,6.465105e-02 ,5.776176e-02 ,5.219398e-02 ,&amp;<a name='7593'>
        &amp; 4.760288e-02 ,4.375369e-02 ,4.048111e-02 ,3.766539e-02 ,3.521771e-02 ,&amp;<a name='7594'>
        &amp; 3.307079e-02 ,3.117277e-02 ,2.948303e-02 ,2.796929e-02 ,2.660560e-02 ,&amp;<a name='7595'>
        &amp; 2.537086e-02 ,2.424772e-02 ,2.322182e-02 ,2.228114e-02 ,2.141556e-02 ,&amp;<a name='7596'>
        &amp; 2.061649e-02 ,1.987661e-02 ,1.918962e-02 ,1.855009e-02 ,1.795330e-02 ,&amp;<a name='7597'>
        &amp; 1.739514e-02 ,1.687199e-02 ,1.638069e-02 ,1.591845e-02 ,1.548276e-02 ,&amp;<a name='7598'>
        &amp; 1.507143e-02 ,1.468249e-02 ,1.431416e-02 ,1.396486e-02 ,1.363318e-02 ,&amp;<a name='7599'>
        &amp; 1.331781e-02 ,1.301759e-02 ,1.273147e-02  /)<a name='7600'>
      extice2(:, 24) = (/ &amp;<a name='7601'>
<font color=#447700>! band 24<a name='7602'></font>
        &amp; 3.527890e-01 ,2.168469e-01 ,1.560090e-01 ,1.216216e-01 ,9.955787e-02 ,&amp;<a name='7603'>
        &amp; 8.421942e-02 ,7.294827e-02 ,6.432192e-02 ,5.751081e-02 ,5.199888e-02 ,&amp;<a name='7604'>
        &amp; 4.744835e-02 ,4.362899e-02 ,4.037847e-02 ,3.757910e-02 ,3.514351e-02 ,&amp;<a name='7605'>
        &amp; 3.300546e-02 ,3.111382e-02 ,2.942853e-02 ,2.791775e-02 ,2.655584e-02 ,&amp;<a name='7606'>
        &amp; 2.532195e-02 ,2.419892e-02 ,2.317255e-02 ,2.223092e-02 ,2.136402e-02 ,&amp;<a name='7607'>
        &amp; 2.056334e-02 ,1.982160e-02 ,1.913258e-02 ,1.849087e-02 ,1.789178e-02 ,&amp;<a name='7608'>
        &amp; 1.733124e-02 ,1.680565e-02 ,1.631187e-02 ,1.584711e-02 ,1.540889e-02 ,&amp;<a name='7609'>
        &amp; 1.499502e-02 ,1.460354e-02 ,1.423269e-02 ,1.388088e-02 ,1.354670e-02 ,&amp;<a name='7610'>
        &amp; 1.322887e-02 ,1.292620e-02 ,1.263767e-02  /)<a name='7611'>
      extice2(:, 25) = (/ &amp;<a name='7612'>
<font color=#447700>! band 25<a name='7613'></font>
        &amp; 3.477874e-01 ,2.143515e-01 ,1.544887e-01 ,1.205942e-01 ,9.881779e-02 ,&amp;<a name='7614'>
        &amp; 8.366261e-02 ,7.251586e-02 ,6.397790e-02 ,5.723183e-02 ,5.176908e-02 ,&amp;<a name='7615'>
        &amp; 4.725658e-02 ,4.346715e-02 ,4.024055e-02 ,3.746055e-02 ,3.504080e-02 ,&amp;<a name='7616'>
        &amp; 3.291583e-02 ,3.103507e-02 ,2.935891e-02 ,2.785582e-02 ,2.650042e-02 ,&amp;<a name='7617'>
        &amp; 2.527206e-02 ,2.415376e-02 ,2.313142e-02 ,2.219326e-02 ,2.132934e-02 ,&amp;<a name='7618'>
        &amp; 2.053122e-02 ,1.979169e-02 ,1.910456e-02 ,1.846448e-02 ,1.786680e-02 ,&amp;<a name='7619'>
        &amp; 1.730745e-02 ,1.678289e-02 ,1.628998e-02 ,1.582595e-02 ,1.538835e-02 ,&amp;<a name='7620'>
        &amp; 1.497499e-02 ,1.458393e-02 ,1.421341e-02 ,1.386187e-02 ,1.352788e-02 ,&amp;<a name='7621'>
        &amp; 1.321019e-02 ,1.290762e-02 ,1.261913e-02  /)<a name='7622'>
      extice2(:, 26) = (/ &amp;<a name='7623'>
<font color=#447700>! band 26<a name='7624'></font>
        &amp; 3.453721e-01 ,2.130744e-01 ,1.536698e-01 ,1.200140e-01 ,9.838078e-02 ,&amp;<a name='7625'>
        &amp; 8.331940e-02 ,7.223803e-02 ,6.374775e-02 ,5.703770e-02 ,5.160290e-02 ,&amp;<a name='7626'>
        &amp; 4.711259e-02 ,4.334110e-02 ,4.012923e-02 ,3.736150e-02 ,3.495208e-02 ,&amp;<a name='7627'>
        &amp; 3.283589e-02 ,3.096267e-02 ,2.929302e-02 ,2.779560e-02 ,2.644517e-02 ,&amp;<a name='7628'>
        &amp; 2.522119e-02 ,2.410677e-02 ,2.308788e-02 ,2.215281e-02 ,2.129165e-02 ,&amp;<a name='7629'>
        &amp; 2.049602e-02 ,1.975874e-02 ,1.907365e-02 ,1.843542e-02 ,1.783943e-02 ,&amp;<a name='7630'>
        &amp; 1.728162e-02 ,1.675847e-02 ,1.626685e-02 ,1.580401e-02 ,1.536750e-02 ,&amp;<a name='7631'>
        &amp; 1.495515e-02 ,1.456502e-02 ,1.419537e-02 ,1.384463e-02 ,1.351139e-02 ,&amp;<a name='7632'>
        &amp; 1.319438e-02 ,1.289246e-02 ,1.260456e-02  /)<a name='7633'>
      extice2(:, 27) = (/ &amp;<a name='7634'>
<font color=#447700>! band 27<a name='7635'></font>
        &amp; 3.417883e-01 ,2.113379e-01 ,1.526395e-01 ,1.193347e-01 ,9.790253e-02 ,&amp;<a name='7636'>
        &amp; 8.296715e-02 ,7.196979e-02 ,6.353806e-02 ,5.687024e-02 ,5.146670e-02 ,&amp;<a name='7637'>
        &amp; 4.700001e-02 ,4.324667e-02 ,4.004894e-02 ,3.729233e-02 ,3.489172e-02 ,&amp;<a name='7638'>
        &amp; 3.278257e-02 ,3.091499e-02 ,2.924987e-02 ,2.775609e-02 ,2.640859e-02 ,&amp;<a name='7639'>
        &amp; 2.518695e-02 ,2.407439e-02 ,2.305697e-02 ,2.212303e-02 ,2.126273e-02 ,&amp;<a name='7640'>
        &amp; 2.046774e-02 ,1.973090e-02 ,1.904610e-02 ,1.840801e-02 ,1.781204e-02 ,&amp;<a name='7641'>
        &amp; 1.725417e-02 ,1.673086e-02 ,1.623902e-02 ,1.577590e-02 ,1.533906e-02 ,&amp;<a name='7642'>
        &amp; 1.492634e-02 ,1.453580e-02 ,1.416571e-02 ,1.381450e-02 ,1.348078e-02 ,&amp;<a name='7643'>
        &amp; 1.316327e-02 ,1.286082e-02 ,1.257240e-02  /)<a name='7644'>
      extice2(:, 28) = (/ &amp;<a name='7645'>
<font color=#447700>! band 28<a name='7646'></font>
        &amp; 3.416111e-01 ,2.114124e-01 ,1.527734e-01 ,1.194809e-01 ,9.804612e-02 ,&amp;<a name='7647'>
        &amp; 8.310287e-02 ,7.209595e-02 ,6.365442e-02 ,5.697710e-02 ,5.156460e-02 ,&amp;<a name='7648'>
        &amp; 4.708957e-02 ,4.332850e-02 ,4.012361e-02 ,3.736037e-02 ,3.495364e-02 ,&amp;<a name='7649'>
        &amp; 3.283879e-02 ,3.096593e-02 ,2.929589e-02 ,2.779751e-02 ,2.644571e-02 ,&amp;<a name='7650'>
        &amp; 2.522004e-02 ,2.410369e-02 ,2.308271e-02 ,2.214542e-02 ,2.128195e-02 ,&amp;<a name='7651'>
        &amp; 2.048396e-02 ,1.974429e-02 ,1.905679e-02 ,1.841614e-02 ,1.781774e-02 ,&amp;<a name='7652'>
        &amp; 1.725754e-02 ,1.673203e-02 ,1.623807e-02 ,1.577293e-02 ,1.533416e-02 ,&amp;<a name='7653'>
        &amp; 1.491958e-02 ,1.452727e-02 ,1.415547e-02 ,1.380262e-02 ,1.346732e-02 ,&amp;<a name='7654'>
        &amp; 1.314830e-02 ,1.284439e-02 ,1.255456e-02  /)<a name='7655'>
      extice2(:, 29) = (/ &amp;<a name='7656'>
<font color=#447700>! band 29<a name='7657'></font>
        &amp; 4.196611e-01 ,2.493642e-01 ,1.761261e-01 ,1.357197e-01 ,1.102161e-01 ,&amp;<a name='7658'>
        &amp; 9.269376e-02 ,7.992985e-02 ,7.022538e-02 ,6.260168e-02 ,5.645603e-02 ,&amp;<a name='7659'>
        &amp; 5.139732e-02 ,4.716088e-02 ,4.356133e-02 ,4.046498e-02 ,3.777303e-02 ,&amp;<a name='7660'>
        &amp; 3.541094e-02 ,3.332137e-02 ,3.145954e-02 ,2.978998e-02 ,2.828419e-02 ,&amp;<a name='7661'>
        &amp; 2.691905e-02 ,2.567559e-02 ,2.453811e-02 ,2.349350e-02 ,2.253072e-02 ,&amp;<a name='7662'>
        &amp; 2.164042e-02 ,2.081464e-02 ,2.004652e-02 ,1.933015e-02 ,1.866041e-02 ,&amp;<a name='7663'>
        &amp; 1.803283e-02 ,1.744348e-02 ,1.688894e-02 ,1.636616e-02 ,1.587244e-02 ,&amp;<a name='7664'>
        &amp; 1.540539e-02 ,1.496287e-02 ,1.454295e-02 ,1.414392e-02 ,1.376423e-02 ,&amp;<a name='7665'>
        &amp; 1.340247e-02 ,1.305739e-02 ,1.272784e-02  /)<a name='7666'>
<a name='7667'>
<font color=#447700>! single-scattering albedo: unitless<a name='7668'></font>
      ssaice2(:, 16) = (/ &amp;<a name='7669'>
<font color=#447700>! band 16<a name='7670'></font>
        &amp; 6.630615e-01 ,6.451169e-01 ,6.333696e-01 ,6.246927e-01 ,6.178420e-01 ,&amp;<a name='7671'>
        &amp; 6.121976e-01 ,6.074069e-01 ,6.032505e-01 ,5.995830e-01 ,5.963030e-01 ,&amp;<a name='7672'>
        &amp; 5.933372e-01 ,5.906311e-01 ,5.881427e-01 ,5.858395e-01 ,5.836955e-01 ,&amp;<a name='7673'>
        &amp; 5.816896e-01 ,5.798046e-01 ,5.780264e-01 ,5.763429e-01 ,5.747441e-01 ,&amp;<a name='7674'>
        &amp; 5.732213e-01 ,5.717672e-01 ,5.703754e-01 ,5.690403e-01 ,5.677571e-01 ,&amp;<a name='7675'>
        &amp; 5.665215e-01 ,5.653297e-01 ,5.641782e-01 ,5.630643e-01 ,5.619850e-01 ,&amp;<a name='7676'>
        &amp; 5.609381e-01 ,5.599214e-01 ,5.589328e-01 ,5.579707e-01 ,5.570333e-01 ,&amp;<a name='7677'>
        &amp; 5.561193e-01 ,5.552272e-01 ,5.543558e-01 ,5.535041e-01 ,5.526708e-01 ,&amp;<a name='7678'>
        &amp; 5.518551e-01 ,5.510561e-01 ,5.502729e-01  /)<a name='7679'>
      ssaice2(:, 17) = (/ &amp;<a name='7680'>
<font color=#447700>! band 17<a name='7681'></font>
        &amp; 7.689749e-01 ,7.398171e-01 ,7.205819e-01 ,7.065690e-01 ,6.956928e-01 ,&amp;<a name='7682'>
        &amp; 6.868989e-01 ,6.795813e-01 ,6.733606e-01 ,6.679838e-01 ,6.632742e-01 ,&amp;<a name='7683'>
        &amp; 6.591036e-01 ,6.553766e-01 ,6.520197e-01 ,6.489757e-01 ,6.461991e-01 ,&amp;<a name='7684'>
        &amp; 6.436531e-01 ,6.413075e-01 ,6.391375e-01 ,6.371221e-01 ,6.352438e-01 ,&amp;<a name='7685'>
        &amp; 6.334876e-01 ,6.318406e-01 ,6.302918e-01 ,6.288315e-01 ,6.274512e-01 ,&amp;<a name='7686'>
        &amp; 6.261436e-01 ,6.249022e-01 ,6.237211e-01 ,6.225953e-01 ,6.215201e-01 ,&amp;<a name='7687'>
        &amp; 6.204914e-01 ,6.195055e-01 ,6.185592e-01 ,6.176492e-01 ,6.167730e-01 ,&amp;<a name='7688'>
        &amp; 6.159280e-01 ,6.151120e-01 ,6.143228e-01 ,6.135587e-01 ,6.128177e-01 ,&amp;<a name='7689'>
        &amp; 6.120984e-01 ,6.113993e-01 ,6.107189e-01  /)<a name='7690'>
      ssaice2(:, 18) = (/ &amp;<a name='7691'>
<font color=#447700>! band 18<a name='7692'></font>
        &amp; 9.956167e-01 ,9.814770e-01 ,9.716104e-01 ,9.639746e-01 ,9.577179e-01 ,&amp;<a name='7693'>
        &amp; 9.524010e-01 ,9.477672e-01 ,9.436527e-01 ,9.399467e-01 ,9.365708e-01 ,&amp;<a name='7694'>
        &amp; 9.334672e-01 ,9.305921e-01 ,9.279118e-01 ,9.253993e-01 ,9.230330e-01 ,&amp;<a name='7695'>
        &amp; 9.207954e-01 ,9.186719e-01 ,9.166501e-01 ,9.147199e-01 ,9.128722e-01 ,&amp;<a name='7696'>
        &amp; 9.110997e-01 ,9.093956e-01 ,9.077544e-01 ,9.061708e-01 ,9.046406e-01 ,&amp;<a name='7697'>
        &amp; 9.031598e-01 ,9.017248e-01 ,9.003326e-01 ,8.989804e-01 ,8.976655e-01 ,&amp;<a name='7698'>
        &amp; 8.963857e-01 ,8.951389e-01 ,8.939233e-01 ,8.927370e-01 ,8.915785e-01 ,&amp;<a name='7699'>
        &amp; 8.904464e-01 ,8.893392e-01 ,8.882559e-01 ,8.871951e-01 ,8.861559e-01 ,&amp;<a name='7700'>
        &amp; 8.851373e-01 ,8.841383e-01 ,8.831581e-01  /)<a name='7701'>
      ssaice2(:, 19) = (/ &amp;<a name='7702'>
<font color=#447700>! band 19<a name='7703'></font>
        &amp; 9.723177e-01 ,9.452119e-01 ,9.267592e-01 ,9.127393e-01 ,9.014238e-01 ,&amp;<a name='7704'>
        &amp; 8.919334e-01 ,8.837584e-01 ,8.765773e-01 ,8.701736e-01 ,8.643950e-01 ,&amp;<a name='7705'>
        &amp; 8.591299e-01 ,8.542942e-01 ,8.498230e-01 ,8.456651e-01 ,8.417794e-01 ,&amp;<a name='7706'>
        &amp; 8.381324e-01 ,8.346964e-01 ,8.314484e-01 ,8.283687e-01 ,8.254408e-01 ,&amp;<a name='7707'>
        &amp; 8.226505e-01 ,8.199854e-01 ,8.174348e-01 ,8.149891e-01 ,8.126403e-01 ,&amp;<a name='7708'>
        &amp; 8.103808e-01 ,8.082041e-01 ,8.061044e-01 ,8.040765e-01 ,8.021156e-01 ,&amp;<a name='7709'>
        &amp; 8.002174e-01 ,7.983781e-01 ,7.965941e-01 ,7.948622e-01 ,7.931795e-01 ,&amp;<a name='7710'>
        &amp; 7.915432e-01 ,7.899508e-01 ,7.884002e-01 ,7.868891e-01 ,7.854156e-01 ,&amp;<a name='7711'>
        &amp; 7.839779e-01 ,7.825742e-01 ,7.812031e-01  /)<a name='7712'>
      ssaice2(:, 20) = (/ &amp;<a name='7713'>
<font color=#447700>! band 20<a name='7714'></font>
        &amp; 9.933294e-01 ,9.860917e-01 ,9.811564e-01 ,9.774008e-01 ,9.743652e-01 ,&amp;<a name='7715'>
        &amp; 9.718155e-01 ,9.696159e-01 ,9.676810e-01 ,9.659531e-01 ,9.643915e-01 ,&amp;<a name='7716'>
        &amp; 9.629667e-01 ,9.616561e-01 ,9.604426e-01 ,9.593125e-01 ,9.582548e-01 ,&amp;<a name='7717'>
        &amp; 9.572607e-01 ,9.563227e-01 ,9.554347e-01 ,9.545915e-01 ,9.537888e-01 ,&amp;<a name='7718'>
        &amp; 9.530226e-01 ,9.522898e-01 ,9.515874e-01 ,9.509130e-01 ,9.502643e-01 ,&amp;<a name='7719'>
        &amp; 9.496394e-01 ,9.490366e-01 ,9.484542e-01 ,9.478910e-01 ,9.473456e-01 ,&amp;<a name='7720'>
        &amp; 9.468169e-01 ,9.463039e-01 ,9.458056e-01 ,9.453212e-01 ,9.448499e-01 ,&amp;<a name='7721'>
        &amp; 9.443910e-01 ,9.439438e-01 ,9.435077e-01 ,9.430821e-01 ,9.426666e-01 ,&amp;<a name='7722'>
        &amp; 9.422607e-01 ,9.418638e-01 ,9.414756e-01  /)<a name='7723'>
      ssaice2(:, 21) = (/ &amp;<a name='7724'>
<font color=#447700>! band 21<a name='7725'></font>
        &amp; 9.900787e-01 ,9.828880e-01 ,9.779258e-01 ,9.741173e-01 ,9.710184e-01 ,&amp;<a name='7726'>
        &amp; 9.684012e-01 ,9.661332e-01 ,9.641301e-01 ,9.623352e-01 ,9.607083e-01 ,&amp;<a name='7727'>
        &amp; 9.592198e-01 ,9.578474e-01 ,9.565739e-01 ,9.553856e-01 ,9.542715e-01 ,&amp;<a name='7728'>
        &amp; 9.532226e-01 ,9.522314e-01 ,9.512919e-01 ,9.503986e-01 ,9.495472e-01 ,&amp;<a name='7729'>
        &amp; 9.487337e-01 ,9.479549e-01 ,9.472077e-01 ,9.464897e-01 ,9.457985e-01 ,&amp;<a name='7730'>
        &amp; 9.451322e-01 ,9.444890e-01 ,9.438673e-01 ,9.432656e-01 ,9.426826e-01 ,&amp;<a name='7731'>
        &amp; 9.421173e-01 ,9.415684e-01 ,9.410351e-01 ,9.405164e-01 ,9.400115e-01 ,&amp;<a name='7732'>
        &amp; 9.395198e-01 ,9.390404e-01 ,9.385728e-01 ,9.381164e-01 ,9.376707e-01 ,&amp;<a name='7733'>
        &amp; 9.372350e-01 ,9.368091e-01 ,9.363923e-01  /)<a name='7734'>
      ssaice2(:, 22) = (/ &amp;<a name='7735'>
<font color=#447700>! band 22<a name='7736'></font>
        &amp; 9.986793e-01 ,9.985239e-01 ,9.983911e-01 ,9.982715e-01 ,9.981606e-01 ,&amp;<a name='7737'>
        &amp; 9.980562e-01 ,9.979567e-01 ,9.978613e-01 ,9.977691e-01 ,9.976798e-01 ,&amp;<a name='7738'>
        &amp; 9.975929e-01 ,9.975081e-01 ,9.974251e-01 ,9.973438e-01 ,9.972640e-01 ,&amp;<a name='7739'>
        &amp; 9.971855e-01 ,9.971083e-01 ,9.970322e-01 ,9.969571e-01 ,9.968830e-01 ,&amp;<a name='7740'>
        &amp; 9.968099e-01 ,9.967375e-01 ,9.966660e-01 ,9.965951e-01 ,9.965250e-01 ,&amp;<a name='7741'>
        &amp; 9.964555e-01 ,9.963867e-01 ,9.963185e-01 ,9.962508e-01 ,9.961836e-01 ,&amp;<a name='7742'>
        &amp; 9.961170e-01 ,9.960508e-01 ,9.959851e-01 ,9.959198e-01 ,9.958550e-01 ,&amp;<a name='7743'>
        &amp; 9.957906e-01 ,9.957266e-01 ,9.956629e-01 ,9.955997e-01 ,9.955367e-01 ,&amp;<a name='7744'>
        &amp; 9.954742e-01 ,9.954119e-01 ,9.953500e-01  /)<a name='7745'>
      ssaice2(:, 23) = (/ &amp;<a name='7746'>
<font color=#447700>! band 23<a name='7747'></font>
        &amp; 9.997944e-01 ,9.997791e-01 ,9.997664e-01 ,9.997547e-01 ,9.997436e-01 ,&amp;<a name='7748'>
        &amp; 9.997327e-01 ,9.997219e-01 ,9.997110e-01 ,9.996999e-01 ,9.996886e-01 ,&amp;<a name='7749'>
        &amp; 9.996771e-01 ,9.996653e-01 ,9.996533e-01 ,9.996409e-01 ,9.996282e-01 ,&amp;<a name='7750'>
        &amp; 9.996152e-01 ,9.996019e-01 ,9.995883e-01 ,9.995743e-01 ,9.995599e-01 ,&amp;<a name='7751'>
        &amp; 9.995453e-01 ,9.995302e-01 ,9.995149e-01 ,9.994992e-01 ,9.994831e-01 ,&amp;<a name='7752'>
        &amp; 9.994667e-01 ,9.994500e-01 ,9.994329e-01 ,9.994154e-01 ,9.993976e-01 ,&amp;<a name='7753'>
        &amp; 9.993795e-01 ,9.993610e-01 ,9.993422e-01 ,9.993230e-01 ,9.993035e-01 ,&amp;<a name='7754'>
        &amp; 9.992837e-01 ,9.992635e-01 ,9.992429e-01 ,9.992221e-01 ,9.992008e-01 ,&amp;<a name='7755'>
        &amp; 9.991793e-01 ,9.991574e-01 ,9.991352e-01  /)<a name='7756'>
      ssaice2(:, 24) = (/ &amp;<a name='7757'>
<font color=#447700>! band 24<a name='7758'></font>
        &amp; 9.999949e-01 ,9.999947e-01 ,9.999943e-01 ,9.999939e-01 ,9.999934e-01 ,&amp;<a name='7759'>
        &amp; 9.999927e-01 ,9.999920e-01 ,9.999913e-01 ,9.999904e-01 ,9.999895e-01 ,&amp;<a name='7760'>
        &amp; 9.999885e-01 ,9.999874e-01 ,9.999863e-01 ,9.999851e-01 ,9.999838e-01 ,&amp;<a name='7761'>
        &amp; 9.999824e-01 ,9.999810e-01 ,9.999795e-01 ,9.999780e-01 ,9.999764e-01 ,&amp;<a name='7762'>
        &amp; 9.999747e-01 ,9.999729e-01 ,9.999711e-01 ,9.999692e-01 ,9.999673e-01 ,&amp;<a name='7763'>
        &amp; 9.999653e-01 ,9.999632e-01 ,9.999611e-01 ,9.999589e-01 ,9.999566e-01 ,&amp;<a name='7764'>
        &amp; 9.999543e-01 ,9.999519e-01 ,9.999495e-01 ,9.999470e-01 ,9.999444e-01 ,&amp;<a name='7765'>
        &amp; 9.999418e-01 ,9.999392e-01 ,9.999364e-01 ,9.999336e-01 ,9.999308e-01 ,&amp;<a name='7766'>
        &amp; 9.999279e-01 ,9.999249e-01 ,9.999219e-01  /)<a name='7767'>
      ssaice2(:, 25) = (/ &amp;<a name='7768'>
<font color=#447700>! band 25<a name='7769'></font>
        &amp; 9.999997e-01 ,9.999997e-01 ,9.999997e-01 ,9.999996e-01 ,9.999996e-01 ,&amp;<a name='7770'>
        &amp; 9.999995e-01 ,9.999994e-01 ,9.999993e-01 ,9.999993e-01 ,9.999992e-01 ,&amp;<a name='7771'>
        &amp; 9.999991e-01 ,9.999989e-01 ,9.999988e-01 ,9.999987e-01 ,9.999986e-01 ,&amp;<a name='7772'>
        &amp; 9.999984e-01 ,9.999983e-01 ,9.999981e-01 ,9.999980e-01 ,9.999978e-01 ,&amp;<a name='7773'>
        &amp; 9.999976e-01 ,9.999974e-01 ,9.999972e-01 ,9.999971e-01 ,9.999969e-01 ,&amp;<a name='7774'>
        &amp; 9.999966e-01 ,9.999964e-01 ,9.999962e-01 ,9.999960e-01 ,9.999957e-01 ,&amp;<a name='7775'>
        &amp; 9.999955e-01 ,9.999953e-01 ,9.999950e-01 ,9.999947e-01 ,9.999945e-01 ,&amp;<a name='7776'>
        &amp; 9.999942e-01 ,9.999939e-01 ,9.999936e-01 ,9.999934e-01 ,9.999931e-01 ,&amp;<a name='7777'>
        &amp; 9.999928e-01 ,9.999925e-01 ,9.999921e-01  /)<a name='7778'>
      ssaice2(:, 26) = (/ &amp;<a name='7779'>
<font color=#447700>! band 26<a name='7780'></font>
        &amp; 9.999997e-01 ,9.999996e-01 ,9.999996e-01 ,9.999995e-01 ,9.999994e-01 ,&amp;<a name='7781'>
        &amp; 9.999993e-01 ,9.999992e-01 ,9.999991e-01 ,9.999990e-01 ,9.999989e-01 ,&amp;<a name='7782'>
        &amp; 9.999987e-01 ,9.999986e-01 ,9.999984e-01 ,9.999982e-01 ,9.999980e-01 ,&amp;<a name='7783'>
        &amp; 9.999978e-01 ,9.999976e-01 ,9.999974e-01 ,9.999972e-01 ,9.999970e-01 ,&amp;<a name='7784'>
        &amp; 9.999967e-01 ,9.999965e-01 ,9.999962e-01 ,9.999959e-01 ,9.999956e-01 ,&amp;<a name='7785'>
        &amp; 9.999954e-01 ,9.999951e-01 ,9.999947e-01 ,9.999944e-01 ,9.999941e-01 ,&amp;<a name='7786'>
        &amp; 9.999938e-01 ,9.999934e-01 ,9.999931e-01 ,9.999927e-01 ,9.999923e-01 ,&amp;<a name='7787'>
        &amp; 9.999920e-01 ,9.999916e-01 ,9.999912e-01 ,9.999908e-01 ,9.999904e-01 ,&amp;<a name='7788'>
        &amp; 9.999899e-01 ,9.999895e-01 ,9.999891e-01  /)<a name='7789'>
      ssaice2(:, 27) = (/ &amp;<a name='7790'>
<font color=#447700>! band 27<a name='7791'></font>
        &amp; 9.999987e-01 ,9.999987e-01 ,9.999985e-01 ,9.999984e-01 ,9.999982e-01 ,&amp;<a name='7792'>
        &amp; 9.999980e-01 ,9.999978e-01 ,9.999976e-01 ,9.999973e-01 ,9.999970e-01 ,&amp;<a name='7793'>
        &amp; 9.999967e-01 ,9.999964e-01 ,9.999960e-01 ,9.999956e-01 ,9.999952e-01 ,&amp;<a name='7794'>
        &amp; 9.999948e-01 ,9.999944e-01 ,9.999939e-01 ,9.999934e-01 ,9.999929e-01 ,&amp;<a name='7795'>
        &amp; 9.999924e-01 ,9.999918e-01 ,9.999913e-01 ,9.999907e-01 ,9.999901e-01 ,&amp;<a name='7796'>
        &amp; 9.999894e-01 ,9.999888e-01 ,9.999881e-01 ,9.999874e-01 ,9.999867e-01 ,&amp;<a name='7797'>
        &amp; 9.999860e-01 ,9.999853e-01 ,9.999845e-01 ,9.999837e-01 ,9.999829e-01 ,&amp;<a name='7798'>
        &amp; 9.999821e-01 ,9.999813e-01 ,9.999804e-01 ,9.999796e-01 ,9.999787e-01 ,&amp;<a name='7799'>
        &amp; 9.999778e-01 ,9.999768e-01 ,9.999759e-01  /)<a name='7800'>
      ssaice2(:, 28) = (/ &amp;<a name='7801'>
<font color=#447700>! band 28<a name='7802'></font>
        &amp; 9.999989e-01 ,9.999989e-01 ,9.999987e-01 ,9.999986e-01 ,9.999984e-01 ,&amp;<a name='7803'>
        &amp; 9.999982e-01 ,9.999980e-01 ,9.999978e-01 ,9.999975e-01 ,9.999972e-01 ,&amp;<a name='7804'>
        &amp; 9.999969e-01 ,9.999966e-01 ,9.999962e-01 ,9.999958e-01 ,9.999954e-01 ,&amp;<a name='7805'>
        &amp; 9.999950e-01 ,9.999945e-01 ,9.999941e-01 ,9.999936e-01 ,9.999931e-01 ,&amp;<a name='7806'>
        &amp; 9.999925e-01 ,9.999920e-01 ,9.999914e-01 ,9.999908e-01 ,9.999902e-01 ,&amp;<a name='7807'>
        &amp; 9.999896e-01 ,9.999889e-01 ,9.999883e-01 ,9.999876e-01 ,9.999869e-01 ,&amp;<a name='7808'>
        &amp; 9.999861e-01 ,9.999854e-01 ,9.999846e-01 ,9.999838e-01 ,9.999830e-01 ,&amp;<a name='7809'>
        &amp; 9.999822e-01 ,9.999814e-01 ,9.999805e-01 ,9.999796e-01 ,9.999787e-01 ,&amp;<a name='7810'>
        &amp; 9.999778e-01 ,9.999769e-01 ,9.999759e-01  /)<a name='7811'>
      ssaice2(:, 29) = (/ &amp;<a name='7812'>
<font color=#447700>! band 29<a name='7813'></font>
        &amp; 7.042143e-01 ,6.691161e-01 ,6.463240e-01 ,6.296590e-01 ,6.166381e-01 ,&amp;<a name='7814'>
        &amp; 6.060183e-01 ,5.970908e-01 ,5.894144e-01 ,5.826968e-01 ,5.767343e-01 ,&amp;<a name='7815'>
        &amp; 5.713804e-01 ,5.665256e-01 ,5.620867e-01 ,5.579987e-01 ,5.542101e-01 ,&amp;<a name='7816'>
        &amp; 5.506794e-01 ,5.473727e-01 ,5.442620e-01 ,5.413239e-01 ,5.385389e-01 ,&amp;<a name='7817'>
        &amp; 5.358901e-01 ,5.333633e-01 ,5.309460e-01 ,5.286277e-01 ,5.263988e-01 ,&amp;<a name='7818'>
        &amp; 5.242512e-01 ,5.221777e-01 ,5.201719e-01 ,5.182280e-01 ,5.163410e-01 ,&amp;<a name='7819'>
        &amp; 5.145062e-01 ,5.127197e-01 ,5.109776e-01 ,5.092766e-01 ,5.076137e-01 ,&amp;<a name='7820'>
        &amp; 5.059860e-01 ,5.043911e-01 ,5.028266e-01 ,5.012904e-01 ,4.997805e-01 ,&amp;<a name='7821'>
        &amp; 4.982951e-01 ,4.968326e-01 ,4.953913e-01  /)<a name='7822'>
<a name='7823'>
<font color=#447700>! asymmetry factor: unitless<a name='7824'></font>
      asyice2(:, 16) = (/ &amp;<a name='7825'>
<font color=#447700>! band 16<a name='7826'></font>
        &amp; 7.946655e-01 ,8.547685e-01 ,8.806016e-01 ,8.949880e-01 ,9.041676e-01 ,&amp;<a name='7827'>
        &amp; 9.105399e-01 ,9.152249e-01 ,9.188160e-01 ,9.216573e-01 ,9.239620e-01 ,&amp;<a name='7828'>
        &amp; 9.258695e-01 ,9.274745e-01 ,9.288441e-01 ,9.300267e-01 ,9.310584e-01 ,&amp;<a name='7829'>
        &amp; 9.319665e-01 ,9.327721e-01 ,9.334918e-01 ,9.341387e-01 ,9.347236e-01 ,&amp;<a name='7830'>
        &amp; 9.352551e-01 ,9.357402e-01 ,9.361850e-01 ,9.365942e-01 ,9.369722e-01 ,&amp;<a name='7831'>
        &amp; 9.373225e-01 ,9.376481e-01 ,9.379516e-01 ,9.382352e-01 ,9.385010e-01 ,&amp;<a name='7832'>
        &amp; 9.387505e-01 ,9.389854e-01 ,9.392070e-01 ,9.394163e-01 ,9.396145e-01 ,&amp;<a name='7833'>
        &amp; 9.398024e-01 ,9.399809e-01 ,9.401508e-01 ,9.403126e-01 ,9.404670e-01 ,&amp;<a name='7834'>
        &amp; 9.406144e-01 ,9.407555e-01 ,9.408906e-01  /)<a name='7835'>
      asyice2(:, 17) = (/ &amp;<a name='7836'>
<font color=#447700>! band 17<a name='7837'></font>
        &amp; 9.078091e-01 ,9.195850e-01 ,9.267250e-01 ,9.317083e-01 ,9.354632e-01 ,&amp;<a name='7838'>
        &amp; 9.384323e-01 ,9.408597e-01 ,9.428935e-01 ,9.446301e-01 ,9.461351e-01 ,&amp;<a name='7839'>
        &amp; 9.474555e-01 ,9.486259e-01 ,9.496722e-01 ,9.506146e-01 ,9.514688e-01 ,&amp;<a name='7840'>
        &amp; 9.522476e-01 ,9.529612e-01 ,9.536181e-01 ,9.542251e-01 ,9.547883e-01 ,&amp;<a name='7841'>
        &amp; 9.553124e-01 ,9.558019e-01 ,9.562601e-01 ,9.566904e-01 ,9.570953e-01 ,&amp;<a name='7842'>
        &amp; 9.574773e-01 ,9.578385e-01 ,9.581806e-01 ,9.585054e-01 ,9.588142e-01 ,&amp;<a name='7843'>
        &amp; 9.591083e-01 ,9.593888e-01 ,9.596569e-01 ,9.599135e-01 ,9.601593e-01 ,&amp;<a name='7844'>
        &amp; 9.603952e-01 ,9.606219e-01 ,9.608399e-01 ,9.610499e-01 ,9.612523e-01 ,&amp;<a name='7845'>
        &amp; 9.614477e-01 ,9.616365e-01 ,9.618192e-01  /)<a name='7846'>
      asyice2(:, 18) = (/ &amp;<a name='7847'>
<font color=#447700>! band 18<a name='7848'></font>
        &amp; 8.322045e-01 ,8.528693e-01 ,8.648167e-01 ,8.729163e-01 ,8.789054e-01 ,&amp;<a name='7849'>
        &amp; 8.835845e-01 ,8.873819e-01 ,8.905511e-01 ,8.932532e-01 ,8.955965e-01 ,&amp;<a name='7850'>
        &amp; 8.976567e-01 ,8.994887e-01 ,9.011334e-01 ,9.026221e-01 ,9.039791e-01 ,&amp;<a name='7851'>
        &amp; 9.052237e-01 ,9.063715e-01 ,9.074349e-01 ,9.084245e-01 ,9.093489e-01 ,&amp;<a name='7852'>
        &amp; 9.102154e-01 ,9.110303e-01 ,9.117987e-01 ,9.125253e-01 ,9.132140e-01 ,&amp;<a name='7853'>
        &amp; 9.138682e-01 ,9.144910e-01 ,9.150850e-01 ,9.156524e-01 ,9.161955e-01 ,&amp;<a name='7854'>
        &amp; 9.167160e-01 ,9.172157e-01 ,9.176959e-01 ,9.181581e-01 ,9.186034e-01 ,&amp;<a name='7855'>
        &amp; 9.190330e-01 ,9.194478e-01 ,9.198488e-01 ,9.202368e-01 ,9.206126e-01 ,&amp;<a name='7856'>
        &amp; 9.209768e-01 ,9.213301e-01 ,9.216731e-01  /)<a name='7857'>
      asyice2(:, 19) = (/ &amp;<a name='7858'>
<font color=#447700>! band 19<a name='7859'></font>
        &amp; 8.116560e-01 ,8.488278e-01 ,8.674331e-01 ,8.788148e-01 ,8.865810e-01 ,&amp;<a name='7860'>
        &amp; 8.922595e-01 ,8.966149e-01 ,9.000747e-01 ,9.028980e-01 ,9.052513e-01 ,&amp;<a name='7861'>
        &amp; 9.072468e-01 ,9.089632e-01 ,9.104574e-01 ,9.117713e-01 ,9.129371e-01 ,&amp;<a name='7862'>
        &amp; 9.139793e-01 ,9.149174e-01 ,9.157668e-01 ,9.165400e-01 ,9.172473e-01 ,&amp;<a name='7863'>
        &amp; 9.178970e-01 ,9.184962e-01 ,9.190508e-01 ,9.195658e-01 ,9.200455e-01 ,&amp;<a name='7864'>
        &amp; 9.204935e-01 ,9.209130e-01 ,9.213067e-01 ,9.216771e-01 ,9.220262e-01 ,&amp;<a name='7865'>
        &amp; 9.223560e-01 ,9.226680e-01 ,9.229636e-01 ,9.232443e-01 ,9.235112e-01 ,&amp;<a name='7866'>
        &amp; 9.237652e-01 ,9.240074e-01 ,9.242385e-01 ,9.244594e-01 ,9.246708e-01 ,&amp;<a name='7867'>
        &amp; 9.248733e-01 ,9.250674e-01 ,9.252536e-01  /)<a name='7868'>
      asyice2(:, 20) = (/ &amp;<a name='7869'>
<font color=#447700>! band 20<a name='7870'></font>
        &amp; 8.047113e-01 ,8.402864e-01 ,8.570332e-01 ,8.668455e-01 ,8.733206e-01 ,&amp;<a name='7871'>
        &amp; 8.779272e-01 ,8.813796e-01 ,8.840676e-01 ,8.862225e-01 ,8.879904e-01 ,&amp;<a name='7872'>
        &amp; 8.894682e-01 ,8.907228e-01 ,8.918019e-01 ,8.927404e-01 ,8.935645e-01 ,&amp;<a name='7873'>
        &amp; 8.942943e-01 ,8.949452e-01 ,8.955296e-01 ,8.960574e-01 ,8.965366e-01 ,&amp;<a name='7874'>
        &amp; 8.969736e-01 ,8.973740e-01 ,8.977422e-01 ,8.980820e-01 ,8.983966e-01 ,&amp;<a name='7875'>
        &amp; 8.986889e-01 ,8.989611e-01 ,8.992153e-01 ,8.994533e-01 ,8.996766e-01 ,&amp;<a name='7876'>
        &amp; 8.998865e-01 ,9.000843e-01 ,9.002709e-01 ,9.004474e-01 ,9.006146e-01 ,&amp;<a name='7877'>
        &amp; 9.007731e-01 ,9.009237e-01 ,9.010670e-01 ,9.012034e-01 ,9.013336e-01 ,&amp;<a name='7878'>
        &amp; 9.014579e-01 ,9.015767e-01 ,9.016904e-01  /)<a name='7879'>
      asyice2(:, 21) = (/ &amp;<a name='7880'>
<font color=#447700>! band 21<a name='7881'></font>
        &amp; 8.179122e-01 ,8.480726e-01 ,8.621945e-01 ,8.704354e-01 ,8.758555e-01 ,&amp;<a name='7882'>
        &amp; 8.797007e-01 ,8.825750e-01 ,8.848078e-01 ,8.865939e-01 ,8.880564e-01 ,&amp;<a name='7883'>
        &amp; 8.892765e-01 ,8.903105e-01 ,8.911982e-01 ,8.919689e-01 ,8.926446e-01 ,&amp;<a name='7884'>
        &amp; 8.932419e-01 ,8.937738e-01 ,8.942506e-01 ,8.946806e-01 ,8.950702e-01 ,&amp;<a name='7885'>
        &amp; 8.954251e-01 ,8.957497e-01 ,8.960477e-01 ,8.963223e-01 ,8.965762e-01 ,&amp;<a name='7886'>
        &amp; 8.968116e-01 ,8.970306e-01 ,8.972347e-01 ,8.974255e-01 ,8.976042e-01 ,&amp;<a name='7887'>
        &amp; 8.977720e-01 ,8.979298e-01 ,8.980784e-01 ,8.982188e-01 ,8.983515e-01 ,&amp;<a name='7888'>
        &amp; 8.984771e-01 ,8.985963e-01 ,8.987095e-01 ,8.988171e-01 ,8.989195e-01 ,&amp;<a name='7889'>
        &amp; 8.990172e-01 ,8.991104e-01 ,8.991994e-01  /)<a name='7890'>
      asyice2(:, 22) = (/ &amp;<a name='7891'>
<font color=#447700>! band 22<a name='7892'></font>
        &amp; 8.169789e-01 ,8.455024e-01 ,8.586925e-01 ,8.663283e-01 ,8.713217e-01 ,&amp;<a name='7893'>
        &amp; 8.748488e-01 ,8.774765e-01 ,8.795122e-01 ,8.811370e-01 ,8.824649e-01 ,&amp;<a name='7894'>
        &amp; 8.835711e-01 ,8.845073e-01 ,8.853103e-01 ,8.860068e-01 ,8.866170e-01 ,&amp;<a name='7895'>
        &amp; 8.871560e-01 ,8.876358e-01 ,8.880658e-01 ,8.884533e-01 ,8.888044e-01 ,&amp;<a name='7896'>
        &amp; 8.891242e-01 ,8.894166e-01 ,8.896851e-01 ,8.899324e-01 ,8.901612e-01 ,&amp;<a name='7897'>
        &amp; 8.903733e-01 ,8.905706e-01 ,8.907545e-01 ,8.909265e-01 ,8.910876e-01 ,&amp;<a name='7898'>
        &amp; 8.912388e-01 ,8.913812e-01 ,8.915153e-01 ,8.916419e-01 ,8.917617e-01 ,&amp;<a name='7899'>
        &amp; 8.918752e-01 ,8.919829e-01 ,8.920851e-01 ,8.921824e-01 ,8.922751e-01 ,&amp;<a name='7900'>
        &amp; 8.923635e-01 ,8.924478e-01 ,8.925284e-01  /)<a name='7901'>
      asyice2(:, 23) = (/ &amp;<a name='7902'>
<font color=#447700>! band 23<a name='7903'></font>
        &amp; 8.387642e-01 ,8.569979e-01 ,8.658630e-01 ,8.711825e-01 ,8.747605e-01 ,&amp;<a name='7904'>
        &amp; 8.773472e-01 ,8.793129e-01 ,8.808621e-01 ,8.821179e-01 ,8.831583e-01 ,&amp;<a name='7905'>
        &amp; 8.840361e-01 ,8.847875e-01 ,8.854388e-01 ,8.860094e-01 ,8.865138e-01 ,&amp;<a name='7906'>
        &amp; 8.869634e-01 ,8.873668e-01 ,8.877310e-01 ,8.880617e-01 ,8.883635e-01 ,&amp;<a name='7907'>
        &amp; 8.886401e-01 ,8.888947e-01 ,8.891298e-01 ,8.893477e-01 ,8.895504e-01 ,&amp;<a name='7908'>
        &amp; 8.897393e-01 ,8.899159e-01 ,8.900815e-01 ,8.902370e-01 ,8.903833e-01 ,&amp;<a name='7909'>
        &amp; 8.905214e-01 ,8.906518e-01 ,8.907753e-01 ,8.908924e-01 ,8.910036e-01 ,&amp;<a name='7910'>
        &amp; 8.911094e-01 ,8.912101e-01 ,8.913062e-01 ,8.913979e-01 ,8.914856e-01 ,&amp;<a name='7911'>
        &amp; 8.915695e-01 ,8.916498e-01 ,8.917269e-01  /)<a name='7912'>
      asyice2(:, 24) = (/ &amp;<a name='7913'>
<font color=#447700>! band 24<a name='7914'></font>
        &amp; 8.522208e-01 ,8.648132e-01 ,8.711224e-01 ,8.749901e-01 ,8.776354e-01 ,&amp;<a name='7915'>
        &amp; 8.795743e-01 ,8.810649e-01 ,8.822518e-01 ,8.832225e-01 ,8.840333e-01 ,&amp;<a name='7916'>
        &amp; 8.847224e-01 ,8.853162e-01 ,8.858342e-01 ,8.862906e-01 ,8.866962e-01 ,&amp;<a name='7917'>
        &amp; 8.870595e-01 ,8.873871e-01 ,8.876842e-01 ,8.879551e-01 ,8.882032e-01 ,&amp;<a name='7918'>
        &amp; 8.884316e-01 ,8.886425e-01 ,8.888380e-01 ,8.890199e-01 ,8.891895e-01 ,&amp;<a name='7919'>
        &amp; 8.893481e-01 ,8.894968e-01 ,8.896366e-01 ,8.897683e-01 ,8.898926e-01 ,&amp;<a name='7920'>
        &amp; 8.900102e-01 ,8.901215e-01 ,8.902272e-01 ,8.903276e-01 ,8.904232e-01 ,&amp;<a name='7921'>
        &amp; 8.905144e-01 ,8.906014e-01 ,8.906845e-01 ,8.907640e-01 ,8.908402e-01 ,&amp;<a name='7922'>
        &amp; 8.909132e-01 ,8.909834e-01 ,8.910507e-01  /)<a name='7923'>
      asyice2(:, 25) = (/ &amp;<a name='7924'>
<font color=#447700>! band 25<a name='7925'></font>
        &amp; 8.578202e-01 ,8.683033e-01 ,8.735431e-01 ,8.767488e-01 ,8.789378e-01 ,&amp;<a name='7926'>
        &amp; 8.805399e-01 ,8.817701e-01 ,8.827485e-01 ,8.835480e-01 ,8.842152e-01 ,&amp;<a name='7927'>
        &amp; 8.847817e-01 ,8.852696e-01 ,8.856949e-01 ,8.860694e-01 ,8.864020e-01 ,&amp;<a name='7928'>
        &amp; 8.866997e-01 ,8.869681e-01 ,8.872113e-01 ,8.874330e-01 ,8.876360e-01 ,&amp;<a name='7929'>
        &amp; 8.878227e-01 ,8.879951e-01 ,8.881548e-01 ,8.883033e-01 ,8.884418e-01 ,&amp;<a name='7930'>
        &amp; 8.885712e-01 ,8.886926e-01 ,8.888066e-01 ,8.889139e-01 ,8.890152e-01 ,&amp;<a name='7931'>
        &amp; 8.891110e-01 ,8.892017e-01 ,8.892877e-01 ,8.893695e-01 ,8.894473e-01 ,&amp;<a name='7932'>
        &amp; 8.895214e-01 ,8.895921e-01 ,8.896597e-01 ,8.897243e-01 ,8.897862e-01 ,&amp;<a name='7933'>
        &amp; 8.898456e-01 ,8.899025e-01 ,8.899572e-01  /)<a name='7934'>
      asyice2(:, 26) = (/ &amp;<a name='7935'>
<font color=#447700>! band 26<a name='7936'></font>
        &amp; 8.625615e-01 ,8.713831e-01 ,8.755799e-01 ,8.780560e-01 ,8.796983e-01 ,&amp;<a name='7937'>
        &amp; 8.808714e-01 ,8.817534e-01 ,8.824420e-01 ,8.829953e-01 ,8.834501e-01 ,&amp;<a name='7938'>
        &amp; 8.838310e-01 ,8.841549e-01 ,8.844338e-01 ,8.846767e-01 ,8.848902e-01 ,&amp;<a name='7939'>
        &amp; 8.850795e-01 ,8.852484e-01 ,8.854002e-01 ,8.855374e-01 ,8.856620e-01 ,&amp;<a name='7940'>
        &amp; 8.857758e-01 ,8.858800e-01 ,8.859759e-01 ,8.860644e-01 ,8.861464e-01 ,&amp;<a name='7941'>
        &amp; 8.862225e-01 ,8.862935e-01 ,8.863598e-01 ,8.864218e-01 ,8.864800e-01 ,&amp;<a name='7942'>
        &amp; 8.865347e-01 ,8.865863e-01 ,8.866349e-01 ,8.866809e-01 ,8.867245e-01 ,&amp;<a name='7943'>
        &amp; 8.867658e-01 ,8.868050e-01 ,8.868423e-01 ,8.868778e-01 ,8.869117e-01 ,&amp;<a name='7944'>
        &amp; 8.869440e-01 ,8.869749e-01 ,8.870044e-01  /)<a name='7945'>
      asyice2(:, 27) = (/ &amp;<a name='7946'>
<font color=#447700>! band 27<a name='7947'></font>
        &amp; 8.587495e-01 ,8.684764e-01 ,8.728189e-01 ,8.752872e-01 ,8.768846e-01 ,&amp;<a name='7948'>
        &amp; 8.780060e-01 ,8.788386e-01 ,8.794824e-01 ,8.799960e-01 ,8.804159e-01 ,&amp;<a name='7949'>
        &amp; 8.807660e-01 ,8.810626e-01 ,8.813175e-01 ,8.815390e-01 ,8.817335e-01 ,&amp;<a name='7950'>
        &amp; 8.819057e-01 ,8.820593e-01 ,8.821973e-01 ,8.823220e-01 ,8.824353e-01 ,&amp;<a name='7951'>
        &amp; 8.825387e-01 ,8.826336e-01 ,8.827209e-01 ,8.828016e-01 ,8.828764e-01 ,&amp;<a name='7952'>
        &amp; 8.829459e-01 ,8.830108e-01 ,8.830715e-01 ,8.831283e-01 ,8.831817e-01 ,&amp;<a name='7953'>
        &amp; 8.832320e-01 ,8.832795e-01 ,8.833244e-01 ,8.833668e-01 ,8.834071e-01 ,&amp;<a name='7954'>
        &amp; 8.834454e-01 ,8.834817e-01 ,8.835164e-01 ,8.835495e-01 ,8.835811e-01 ,&amp;<a name='7955'>
        &amp; 8.836113e-01 ,8.836402e-01 ,8.836679e-01  /)<a name='7956'>
      asyice2(:, 28) = (/ &amp;<a name='7957'>
<font color=#447700>! band 28<a name='7958'></font>
        &amp; 8.561110e-01 ,8.678583e-01 ,8.727554e-01 ,8.753892e-01 ,8.770154e-01 ,&amp;<a name='7959'>
        &amp; 8.781109e-01 ,8.788949e-01 ,8.794812e-01 ,8.799348e-01 ,8.802952e-01 ,&amp;<a name='7960'>
        &amp; 8.805880e-01 ,8.808300e-01 ,8.810331e-01 ,8.812058e-01 ,8.813543e-01 ,&amp;<a name='7961'>
        &amp; 8.814832e-01 ,8.815960e-01 ,8.816956e-01 ,8.817839e-01 ,8.818629e-01 ,&amp;<a name='7962'>
        &amp; 8.819339e-01 ,8.819979e-01 ,8.820560e-01 ,8.821089e-01 ,8.821573e-01 ,&amp;<a name='7963'>
        &amp; 8.822016e-01 ,8.822425e-01 ,8.822801e-01 ,8.823150e-01 ,8.823474e-01 ,&amp;<a name='7964'>
        &amp; 8.823775e-01 ,8.824056e-01 ,8.824318e-01 ,8.824564e-01 ,8.824795e-01 ,&amp;<a name='7965'>
        &amp; 8.825011e-01 ,8.825215e-01 ,8.825408e-01 ,8.825589e-01 ,8.825761e-01 ,&amp;<a name='7966'>
        &amp; 8.825924e-01 ,8.826078e-01 ,8.826224e-01  /)<a name='7967'>
      asyice2(:, 29) = (/ &amp;<a name='7968'>
<font color=#447700>! band 29<a name='7969'></font>
        &amp; 8.311124e-01 ,8.688197e-01 ,8.900274e-01 ,9.040696e-01 ,9.142334e-01 ,&amp;<a name='7970'>
        &amp; 9.220181e-01 ,9.282195e-01 ,9.333048e-01 ,9.375689e-01 ,9.412085e-01 ,&amp;<a name='7971'>
        &amp; 9.443604e-01 ,9.471230e-01 ,9.495694e-01 ,9.517549e-01 ,9.537224e-01 ,&amp;<a name='7972'>
        &amp; 9.555057e-01 ,9.571316e-01 ,9.586222e-01 ,9.599952e-01 ,9.612656e-01 ,&amp;<a name='7973'>
        &amp; 9.624458e-01 ,9.635461e-01 ,9.645756e-01 ,9.655418e-01 ,9.664513e-01 ,&amp;<a name='7974'>
        &amp; 9.673098e-01 ,9.681222e-01 ,9.688928e-01 ,9.696256e-01 ,9.703237e-01 ,&amp;<a name='7975'>
        &amp; 9.709903e-01 ,9.716280e-01 ,9.722391e-01 ,9.728258e-01 ,9.733901e-01 ,&amp;<a name='7976'>
        &amp; 9.739336e-01 ,9.744579e-01 ,9.749645e-01 ,9.754546e-01 ,9.759294e-01 ,&amp;<a name='7977'>
        &amp; 9.763901e-01 ,9.768376e-01 ,9.772727e-01  /)<a name='7978'>
<a name='7979'>
<font color=#447700>! Hexagonal Ice Particle Parameterization<a name='7980'></font>
<font color=#447700>! extinction units (ext coef/iwc): [(m^-1)/(g m^-3)]<a name='7981'></font>
      extice3(:, 16) = (/ &amp;<a name='7982'>
<font color=#447700>! band 16<a name='7983'></font>
        &amp; 5.194013e-01 ,3.215089e-01 ,2.327917e-01 ,1.824424e-01 ,1.499977e-01 ,&amp;<a name='7984'>
        &amp; 1.273492e-01 ,1.106421e-01 ,9.780982e-02 ,8.764435e-02 ,7.939266e-02 ,&amp;<a name='7985'>
        &amp; 7.256081e-02 ,6.681137e-02 ,6.190600e-02 ,5.767154e-02 ,5.397915e-02 ,&amp;<a name='7986'>
        &amp; 5.073102e-02 ,4.785151e-02 ,4.528125e-02 ,4.297296e-02 ,4.088853e-02 ,&amp;<a name='7987'>
        &amp; 3.899690e-02 ,3.727251e-02 ,3.569411e-02 ,3.424393e-02 ,3.290694e-02 ,&amp;<a name='7988'>
        &amp; 3.167040e-02 ,3.052340e-02 ,2.945654e-02 ,2.846172e-02 ,2.753188e-02 ,&amp;<a name='7989'>
        &amp; 2.666085e-02 ,2.584322e-02 ,2.507423e-02 ,2.434967e-02 ,2.366579e-02 ,&amp;<a name='7990'>
        &amp; 2.301926e-02 ,2.240711e-02 ,2.182666e-02 ,2.127551e-02 ,2.075150e-02 ,&amp;<a name='7991'>
        &amp; 2.025267e-02 ,1.977725e-02 ,1.932364e-02 ,1.889035e-02 ,1.847607e-02 ,&amp;<a name='7992'>
        &amp; 1.807956e-02  /)<a name='7993'>
      extice3(:, 17) = (/ &amp;<a name='7994'>
<font color=#447700>! band 17<a name='7995'></font>
        &amp; 4.901155e-01 ,3.065286e-01 ,2.230800e-01 ,1.753951e-01 ,1.445402e-01 ,&amp;<a name='7996'>
        &amp; 1.229417e-01 ,1.069777e-01 ,9.469760e-02 ,8.495824e-02 ,7.704501e-02 ,&amp;<a name='7997'>
        &amp; 7.048834e-02 ,6.496693e-02 ,6.025353e-02 ,5.618286e-02 ,5.263186e-02 ,&amp;<a name='7998'>
        &amp; 4.950698e-02 ,4.673585e-02 ,4.426164e-02 ,4.203904e-02 ,4.003153e-02 ,&amp;<a name='7999'>
        &amp; 3.820932e-02 ,3.654790e-02 ,3.502688e-02 ,3.362919e-02 ,3.234041e-02 ,&amp;<a name='8000'>
        &amp; 3.114829e-02 ,3.004234e-02 ,2.901356e-02 ,2.805413e-02 ,2.715727e-02 ,&amp;<a name='8001'>
        &amp; 2.631705e-02 ,2.552828e-02 ,2.478637e-02 ,2.408725e-02 ,2.342734e-02 ,&amp;<a name='8002'>
        &amp; 2.280343e-02 ,2.221264e-02 ,2.165242e-02 ,2.112043e-02 ,2.061461e-02 ,&amp;<a name='8003'>
        &amp; 2.013308e-02 ,1.967411e-02 ,1.923616e-02 ,1.881783e-02 ,1.841781e-02 ,&amp;<a name='8004'>
        &amp; 1.803494e-02  /)<a name='8005'>
      extice3(:, 18) = (/ &amp;<a name='8006'>
<font color=#447700>! band 18<a name='8007'></font>
        &amp; 5.056264e-01 ,3.160261e-01 ,2.298442e-01 ,1.805973e-01 ,1.487318e-01 ,&amp;<a name='8008'>
        &amp; 1.264258e-01 ,1.099389e-01 ,9.725656e-02 ,8.719819e-02 ,7.902576e-02 ,&amp;<a name='8009'>
        &amp; 7.225433e-02 ,6.655206e-02 ,6.168427e-02 ,5.748028e-02 ,5.381296e-02 ,&amp;<a name='8010'>
        &amp; 5.058572e-02 ,4.772383e-02 ,4.516857e-02 ,4.287317e-02 ,4.079990e-02 ,&amp;<a name='8011'>
        &amp; 3.891801e-02 ,3.720217e-02 ,3.563133e-02 ,3.418786e-02 ,3.285686e-02 ,&amp;<a name='8012'>
        &amp; 3.162569e-02 ,3.048352e-02 ,2.942104e-02 ,2.843018e-02 ,2.750395e-02 ,&amp;<a name='8013'>
        &amp; 2.663621e-02 ,2.582160e-02 ,2.505539e-02 ,2.433337e-02 ,2.365185e-02 ,&amp;<a name='8014'>
        &amp; 2.300750e-02 ,2.239736e-02 ,2.181878e-02 ,2.126937e-02 ,2.074699e-02 ,&amp;<a name='8015'>
        &amp; 2.024968e-02 ,1.977567e-02 ,1.932338e-02 ,1.889134e-02 ,1.847823e-02 ,&amp;<a name='8016'>
        &amp; 1.808281e-02  /)<a name='8017'>
      extice3(:, 19) = (/ &amp;<a name='8018'>
<font color=#447700>! band 19<a name='8019'></font>
        &amp; 4.881605e-01 ,3.055237e-01 ,2.225070e-01 ,1.750688e-01 ,1.443736e-01 ,&amp;<a name='8020'>
        &amp; 1.228869e-01 ,1.070054e-01 ,9.478893e-02 ,8.509997e-02 ,7.722769e-02 ,&amp;<a name='8021'>
        &amp; 7.070495e-02 ,6.521211e-02 ,6.052311e-02 ,5.647351e-02 ,5.294088e-02 ,&amp;<a name='8022'>
        &amp; 4.983217e-02 ,4.707539e-02 ,4.461398e-02 ,4.240288e-02 ,4.040575e-02 ,&amp;<a name='8023'>
        &amp; 3.859298e-02 ,3.694016e-02 ,3.542701e-02 ,3.403655e-02 ,3.275444e-02 ,&amp;<a name='8024'>
        &amp; 3.156849e-02 ,3.046827e-02 ,2.944481e-02 ,2.849034e-02 ,2.759812e-02 ,&amp;<a name='8025'>
        &amp; 2.676226e-02 ,2.597757e-02 ,2.523949e-02 ,2.454400e-02 ,2.388750e-02 ,&amp;<a name='8026'>
        &amp; 2.326682e-02 ,2.267909e-02 ,2.212176e-02 ,2.159253e-02 ,2.108933e-02 ,&amp;<a name='8027'>
        &amp; 2.061028e-02 ,2.015369e-02 ,1.971801e-02 ,1.930184e-02 ,1.890389e-02 ,&amp;<a name='8028'>
        &amp; 1.852300e-02  /)<a name='8029'>
      extice3(:, 20) = (/ &amp;<a name='8030'>
<font color=#447700>! band 20<a name='8031'></font>
        &amp; 5.103703e-01 ,3.188144e-01 ,2.317435e-01 ,1.819887e-01 ,1.497944e-01 ,&amp;<a name='8032'>
        &amp; 1.272584e-01 ,1.106013e-01 ,9.778822e-02 ,8.762610e-02 ,7.936938e-02 ,&amp;<a name='8033'>
        &amp; 7.252809e-02 ,6.676701e-02 ,6.184901e-02 ,5.760165e-02 ,5.389651e-02 ,&amp;<a name='8034'>
        &amp; 5.063598e-02 ,4.774457e-02 ,4.516295e-02 ,4.284387e-02 ,4.074922e-02 ,&amp;<a name='8035'>
        &amp; 3.884792e-02 ,3.711438e-02 ,3.552734e-02 ,3.406898e-02 ,3.272425e-02 ,&amp;<a name='8036'>
        &amp; 3.148038e-02 ,3.032643e-02 ,2.925299e-02 ,2.825191e-02 ,2.731612e-02 ,&amp;<a name='8037'>
        &amp; 2.643943e-02 ,2.561642e-02 ,2.484230e-02 ,2.411284e-02 ,2.342429e-02 ,&amp;<a name='8038'>
        &amp; 2.277329e-02 ,2.215686e-02 ,2.157231e-02 ,2.101724e-02 ,2.048946e-02 ,&amp;<a name='8039'>
        &amp; 1.998702e-02 ,1.950813e-02 ,1.905118e-02 ,1.861468e-02 ,1.819730e-02 ,&amp;<a name='8040'>
        &amp; 1.779781e-02  /)<a name='8041'>
      extice3(:, 21) = (/ &amp;<a name='8042'>
<font color=#447700>! band 21<a name='8043'></font>
        &amp; 5.031161e-01 ,3.144511e-01 ,2.286942e-01 ,1.796903e-01 ,1.479819e-01 ,&amp;<a name='8044'>
        &amp; 1.257860e-01 ,1.093803e-01 ,9.676059e-02 ,8.675183e-02 ,7.861971e-02 ,&amp;<a name='8045'>
        &amp; 7.188168e-02 ,6.620754e-02 ,6.136376e-02 ,5.718050e-02 ,5.353127e-02 ,&amp;<a name='8046'>
        &amp; 5.031995e-02 ,4.747218e-02 ,4.492952e-02 ,4.264544e-02 ,4.058240e-02 ,&amp;<a name='8047'>
        &amp; 3.870979e-02 ,3.700242e-02 ,3.543933e-02 ,3.400297e-02 ,3.267854e-02 ,&amp;<a name='8048'>
        &amp; 3.145345e-02 ,3.031691e-02 ,2.925967e-02 ,2.827370e-02 ,2.735203e-02 ,&amp;<a name='8049'>
        &amp; 2.648858e-02 ,2.567798e-02 ,2.491555e-02 ,2.419710e-02 ,2.351893e-02 ,&amp;<a name='8050'>
        &amp; 2.287776e-02 ,2.227063e-02 ,2.169491e-02 ,2.114821e-02 ,2.062840e-02 ,&amp;<a name='8051'>
        &amp; 2.013354e-02 ,1.966188e-02 ,1.921182e-02 ,1.878191e-02 ,1.837083e-02 ,&amp;<a name='8052'>
        &amp; 1.797737e-02  /)<a name='8053'>
      extice3(:, 22) = (/ &amp;<a name='8054'>
<font color=#447700>! band 22<a name='8055'></font>
        &amp; 4.949453e-01 ,3.095918e-01 ,2.253402e-01 ,1.771964e-01 ,1.460446e-01 ,&amp;<a name='8056'>
        &amp; 1.242383e-01 ,1.081206e-01 ,9.572235e-02 ,8.588928e-02 ,7.789990e-02 ,&amp;<a name='8057'>
        &amp; 7.128013e-02 ,6.570559e-02 ,6.094684e-02 ,5.683701e-02 ,5.325183e-02 ,&amp;<a name='8058'>
        &amp; 5.009688e-02 ,4.729909e-02 ,4.480106e-02 ,4.255708e-02 ,4.053025e-02 ,&amp;<a name='8059'>
        &amp; 3.869051e-02 ,3.701310e-02 ,3.547745e-02 ,3.406631e-02 ,3.276512e-02 ,&amp;<a name='8060'>
        &amp; 3.156153e-02 ,3.044494e-02 ,2.940626e-02 ,2.843759e-02 ,2.753211e-02 ,&amp;<a name='8061'>
        &amp; 2.668381e-02 ,2.588744e-02 ,2.513839e-02 ,2.443255e-02 ,2.376629e-02 ,&amp;<a name='8062'>
        &amp; 2.313637e-02 ,2.253990e-02 ,2.197428e-02 ,2.143718e-02 ,2.092649e-02 ,&amp;<a name='8063'>
        &amp; 2.044032e-02 ,1.997694e-02 ,1.953478e-02 ,1.911241e-02 ,1.870855e-02 ,&amp;<a name='8064'>
        &amp; 1.832199e-02  /)<a name='8065'>
      extice3(:, 23) = (/ &amp;<a name='8066'>
<font color=#447700>! band 23<a name='8067'></font>
        &amp; 5.052816e-01 ,3.157665e-01 ,2.296233e-01 ,1.803986e-01 ,1.485473e-01 ,&amp;<a name='8068'>
        &amp; 1.262514e-01 ,1.097718e-01 ,9.709524e-02 ,8.704139e-02 ,7.887264e-02 ,&amp;<a name='8069'>
        &amp; 7.210424e-02 ,6.640454e-02 ,6.153894e-02 ,5.733683e-02 ,5.367116e-02 ,&amp;<a name='8070'>
        &amp; 5.044537e-02 ,4.758477e-02 ,4.503066e-02 ,4.273629e-02 ,4.066395e-02 ,&amp;<a name='8071'>
        &amp; 3.878291e-02 ,3.706784e-02 ,3.549771e-02 ,3.405488e-02 ,3.272448e-02 ,&amp;<a name='8072'>
        &amp; 3.149387e-02 ,3.035221e-02 ,2.929020e-02 ,2.829979e-02 ,2.737397e-02 ,&amp;<a name='8073'>
        &amp; 2.650663e-02 ,2.569238e-02 ,2.492651e-02 ,2.420482e-02 ,2.352361e-02 ,&amp;<a name='8074'>
        &amp; 2.287954e-02 ,2.226968e-02 ,2.169136e-02 ,2.114220e-02 ,2.062005e-02 ,&amp;<a name='8075'>
        &amp; 2.012296e-02 ,1.964917e-02 ,1.919709e-02 ,1.876524e-02 ,1.835231e-02 ,&amp;<a name='8076'>
        &amp; 1.795707e-02  /)<a name='8077'>
      extice3(:, 24) = (/ &amp;<a name='8078'>
<font color=#447700>! band 24<a name='8079'></font>
        &amp; 5.042067e-01 ,3.151195e-01 ,2.291708e-01 ,1.800573e-01 ,1.482779e-01 ,&amp;<a name='8080'>
        &amp; 1.260324e-01 ,1.095900e-01 ,9.694202e-02 ,8.691087e-02 ,7.876056e-02 ,&amp;<a name='8081'>
        &amp; 7.200745e-02 ,6.632062e-02 ,6.146600e-02 ,5.727338e-02 ,5.361599e-02 ,&amp;<a name='8082'>
        &amp; 5.039749e-02 ,4.754334e-02 ,4.499500e-02 ,4.270580e-02 ,4.063815e-02 ,&amp;<a name='8083'>
        &amp; 3.876135e-02 ,3.705016e-02 ,3.548357e-02 ,3.404400e-02 ,3.271661e-02 ,&amp;<a name='8084'>
        &amp; 3.148877e-02 ,3.034969e-02 ,2.929008e-02 ,2.830191e-02 ,2.737818e-02 ,&amp;<a name='8085'>
        &amp; 2.651279e-02 ,2.570039e-02 ,2.493624e-02 ,2.421618e-02 ,2.353650e-02 ,&amp;<a name='8086'>
        &amp; 2.289390e-02 ,2.228541e-02 ,2.170840e-02 ,2.116048e-02 ,2.063950e-02 ,&amp;<a name='8087'>
        &amp; 2.014354e-02 ,1.967082e-02 ,1.921975e-02 ,1.878888e-02 ,1.837688e-02 ,&amp;<a name='8088'>
        &amp; 1.798254e-02  /)<a name='8089'>
      extice3(:, 25) = (/ &amp;<a name='8090'>
<font color=#447700>! band 25<a name='8091'></font>
        &amp; 5.022507e-01 ,3.139246e-01 ,2.283218e-01 ,1.794059e-01 ,1.477544e-01 ,&amp;<a name='8092'>
        &amp; 1.255984e-01 ,1.092222e-01 ,9.662516e-02 ,8.663439e-02 ,7.851688e-02 ,&amp;<a name='8093'>
        &amp; 7.179095e-02 ,6.612700e-02 ,6.129193e-02 ,5.711618e-02 ,5.347351e-02 ,&amp;<a name='8094'>
        &amp; 5.026796e-02 ,4.742530e-02 ,4.488721e-02 ,4.260724e-02 ,4.054790e-02 ,&amp;<a name='8095'>
        &amp; 3.867866e-02 ,3.697435e-02 ,3.541407e-02 ,3.398029e-02 ,3.265824e-02 ,&amp;<a name='8096'>
        &amp; 3.143535e-02 ,3.030085e-02 ,2.924551e-02 ,2.826131e-02 ,2.734130e-02 ,&amp;<a name='8097'>
        &amp; 2.647939e-02 ,2.567026e-02 ,2.490919e-02 ,2.419203e-02 ,2.351509e-02 ,&amp;<a name='8098'>
        &amp; 2.287507e-02 ,2.226903e-02 ,2.169434e-02 ,2.114862e-02 ,2.062975e-02 ,&amp;<a name='8099'>
        &amp; 2.013578e-02 ,1.966496e-02 ,1.921571e-02 ,1.878658e-02 ,1.837623e-02 ,&amp;<a name='8100'>
        &amp; 1.798348e-02  /)<a name='8101'>
      extice3(:, 26) = (/ &amp;<a name='8102'>
<font color=#447700>! band 26<a name='8103'></font>
        &amp; 5.068316e-01 ,3.166869e-01 ,2.302576e-01 ,1.808693e-01 ,1.489122e-01 ,&amp;<a name='8104'>
        &amp; 1.265423e-01 ,1.100080e-01 ,9.728926e-02 ,8.720201e-02 ,7.900612e-02 ,&amp;<a name='8105'>
        &amp; 7.221524e-02 ,6.649660e-02 ,6.161484e-02 ,5.739877e-02 ,5.372093e-02 ,&amp;<a name='8106'>
        &amp; 5.048442e-02 ,4.761431e-02 ,4.505172e-02 ,4.274972e-02 ,4.067050e-02 ,&amp;<a name='8107'>
        &amp; 3.878321e-02 ,3.706244e-02 ,3.548710e-02 ,3.403948e-02 ,3.270466e-02 ,&amp;<a name='8108'>
        &amp; 3.146995e-02 ,3.032450e-02 ,2.925897e-02 ,2.826527e-02 ,2.733638e-02 ,&amp;<a name='8109'>
        &amp; 2.646615e-02 ,2.564920e-02 ,2.488078e-02 ,2.415670e-02 ,2.347322e-02 ,&amp;<a name='8110'>
        &amp; 2.282702e-02 ,2.221513e-02 ,2.163489e-02 ,2.108390e-02 ,2.056002e-02 ,&amp;<a name='8111'>
        &amp; 2.006128e-02 ,1.958591e-02 ,1.913232e-02 ,1.869904e-02 ,1.828474e-02 ,&amp;<a name='8112'>
        &amp; 1.788819e-02  /)<a name='8113'>
      extice3(:, 27) = (/ &amp;<a name='8114'>
<font color=#447700>! band 27<a name='8115'></font>
        &amp; 5.077707e-01 ,3.172636e-01 ,2.306695e-01 ,1.811871e-01 ,1.491691e-01 ,&amp;<a name='8116'>
        &amp; 1.267565e-01 ,1.101907e-01 ,9.744773e-02 ,8.734125e-02 ,7.912973e-02 ,&amp;<a name='8117'>
        &amp; 7.232591e-02 ,6.659637e-02 ,6.170530e-02 ,5.748120e-02 ,5.379634e-02 ,&amp;<a name='8118'>
        &amp; 5.055367e-02 ,4.767809e-02 ,4.511061e-02 ,4.280423e-02 ,4.072104e-02 ,&amp;<a name='8119'>
        &amp; 3.883015e-02 ,3.710611e-02 ,3.552776e-02 ,3.407738e-02 ,3.274002e-02 ,&amp;<a name='8120'>
        &amp; 3.150296e-02 ,3.035532e-02 ,2.928776e-02 ,2.829216e-02 ,2.736150e-02 ,&amp;<a name='8121'>
        &amp; 2.648961e-02 ,2.567111e-02 ,2.490123e-02 ,2.417576e-02 ,2.349098e-02 ,&amp;<a name='8122'>
        &amp; 2.284354e-02 ,2.223049e-02 ,2.164914e-02 ,2.109711e-02 ,2.057222e-02 ,&amp;<a name='8123'>
        &amp; 2.007253e-02 ,1.959626e-02 ,1.914181e-02 ,1.870770e-02 ,1.829261e-02 ,&amp;<a name='8124'>
        &amp; 1.789531e-02  /)<a name='8125'>
      extice3(:, 28) = (/ &amp;<a name='8126'>
<font color=#447700>! band 28<a name='8127'></font>
        &amp; 5.062281e-01 ,3.163402e-01 ,2.300275e-01 ,1.807060e-01 ,1.487921e-01 ,&amp;<a name='8128'>
        &amp; 1.264523e-01 ,1.099403e-01 ,9.723879e-02 ,8.716516e-02 ,7.898034e-02 ,&amp;<a name='8129'>
        &amp; 7.219863e-02 ,6.648771e-02 ,6.161254e-02 ,5.740217e-02 ,5.372929e-02 ,&amp;<a name='8130'>
        &amp; 5.049716e-02 ,4.763092e-02 ,4.507179e-02 ,4.277290e-02 ,4.069649e-02 ,&amp;<a name='8131'>
        &amp; 3.881175e-02 ,3.709331e-02 ,3.552008e-02 ,3.407442e-02 ,3.274141e-02 ,&amp;<a name='8132'>
        &amp; 3.150837e-02 ,3.036447e-02 ,2.930037e-02 ,2.830801e-02 ,2.738037e-02 ,&amp;<a name='8133'>
        &amp; 2.651132e-02 ,2.569547e-02 ,2.492810e-02 ,2.420499e-02 ,2.352243e-02 ,&amp;<a name='8134'>
        &amp; 2.287710e-02 ,2.226604e-02 ,2.168658e-02 ,2.113634e-02 ,2.061316e-02 ,&amp;<a name='8135'>
        &amp; 2.011510e-02 ,1.964038e-02 ,1.918740e-02 ,1.875471e-02 ,1.834096e-02 ,&amp;<a name='8136'>
        &amp; 1.794495e-02  /)<a name='8137'>
      extice3(:, 29) = (/ &amp;<a name='8138'>
<font color=#447700>! band 29<a name='8139'></font>
        &amp; 1.338834e-01 ,1.924912e-01 ,1.755523e-01 ,1.534793e-01 ,1.343937e-01 ,&amp;<a name='8140'>
        &amp; 1.187883e-01 ,1.060654e-01 ,9.559106e-02 ,8.685880e-02 ,7.948698e-02 ,&amp;<a name='8141'>
        &amp; 7.319086e-02 ,6.775669e-02 ,6.302215e-02 ,5.886236e-02 ,5.517996e-02 ,&amp;<a name='8142'>
        &amp; 5.189810e-02 ,4.895539e-02 ,4.630225e-02 ,4.389823e-02 ,4.171002e-02 ,&amp;<a name='8143'>
        &amp; 3.970998e-02 ,3.787493e-02 ,3.618537e-02 ,3.462471e-02 ,3.317880e-02 ,&amp;<a name='8144'>
        &amp; 3.183547e-02 ,3.058421e-02 ,2.941590e-02 ,2.832256e-02 ,2.729724e-02 ,&amp;<a name='8145'>
        &amp; 2.633377e-02 ,2.542675e-02 ,2.457136e-02 ,2.376332e-02 ,2.299882e-02 ,&amp;<a name='8146'>
        &amp; 2.227443e-02 ,2.158707e-02 ,2.093400e-02 ,2.031270e-02 ,1.972091e-02 ,&amp;<a name='8147'>
        &amp; 1.915659e-02 ,1.861787e-02 ,1.810304e-02 ,1.761055e-02 ,1.713899e-02 ,&amp;<a name='8148'>
        &amp; 1.668704e-02  /)<a name='8149'>
<a name='8150'>
<font color=#447700>! single-scattering albedo: unitless<a name='8151'></font>
      ssaice3(:, 16) = (/ &amp;<a name='8152'>
<font color=#447700>! band 16<a name='8153'></font>
        &amp; 6.749442e-01 ,6.649947e-01 ,6.565828e-01 ,6.489928e-01 ,6.420046e-01 ,&amp;<a name='8154'>
        &amp; 6.355231e-01 ,6.294964e-01 ,6.238901e-01 ,6.186783e-01 ,6.138395e-01 ,&amp;<a name='8155'>
        &amp; 6.093543e-01 ,6.052049e-01 ,6.013742e-01 ,5.978457e-01 ,5.946030e-01 ,&amp;<a name='8156'>
        &amp; 5.916302e-01 ,5.889115e-01 ,5.864310e-01 ,5.841731e-01 ,5.821221e-01 ,&amp;<a name='8157'>
        &amp; 5.802624e-01 ,5.785785e-01 ,5.770549e-01 ,5.756759e-01 ,5.744262e-01 ,&amp;<a name='8158'>
        &amp; 5.732901e-01 ,5.722524e-01 ,5.712974e-01 ,5.704097e-01 ,5.695739e-01 ,&amp;<a name='8159'>
        &amp; 5.687747e-01 ,5.679964e-01 ,5.672238e-01 ,5.664415e-01 ,5.656340e-01 ,&amp;<a name='8160'>
        &amp; 5.647860e-01 ,5.638821e-01 ,5.629070e-01 ,5.618452e-01 ,5.606815e-01 ,&amp;<a name='8161'>
        &amp; 5.594006e-01 ,5.579870e-01 ,5.564255e-01 ,5.547008e-01 ,5.527976e-01 ,&amp;<a name='8162'>
        &amp; 5.507005e-01  /)<a name='8163'>
      ssaice3(:, 17) = (/ &amp;<a name='8164'>
<font color=#447700>! band 17<a name='8165'></font>
        &amp; 7.628550e-01 ,7.567297e-01 ,7.508463e-01 ,7.451972e-01 ,7.397745e-01 ,&amp;<a name='8166'>
        &amp; 7.345705e-01 ,7.295775e-01 ,7.247881e-01 ,7.201945e-01 ,7.157894e-01 ,&amp;<a name='8167'>
        &amp; 7.115652e-01 ,7.075145e-01 ,7.036300e-01 ,6.999044e-01 ,6.963304e-01 ,&amp;<a name='8168'>
        &amp; 6.929007e-01 ,6.896083e-01 ,6.864460e-01 ,6.834067e-01 ,6.804833e-01 ,&amp;<a name='8169'>
        &amp; 6.776690e-01 ,6.749567e-01 ,6.723397e-01 ,6.698109e-01 ,6.673637e-01 ,&amp;<a name='8170'>
        &amp; 6.649913e-01 ,6.626870e-01 ,6.604441e-01 ,6.582561e-01 ,6.561163e-01 ,&amp;<a name='8171'>
        &amp; 6.540182e-01 ,6.519554e-01 ,6.499215e-01 ,6.479099e-01 ,6.459145e-01 ,&amp;<a name='8172'>
        &amp; 6.439289e-01 ,6.419468e-01 ,6.399621e-01 ,6.379686e-01 ,6.359601e-01 ,&amp;<a name='8173'>
        &amp; 6.339306e-01 ,6.318740e-01 ,6.297845e-01 ,6.276559e-01 ,6.254825e-01 ,&amp;<a name='8174'>
        &amp; 6.232583e-01  /)<a name='8175'>
      ssaice3(:, 18) = (/ &amp;<a name='8176'>
<font color=#447700>! band 18<a name='8177'></font>
        &amp; 9.924147e-01 ,9.882792e-01 ,9.842257e-01 ,9.802522e-01 ,9.763566e-01 ,&amp;<a name='8178'>
        &amp; 9.725367e-01 ,9.687905e-01 ,9.651157e-01 ,9.615104e-01 ,9.579725e-01 ,&amp;<a name='8179'>
        &amp; 9.544997e-01 ,9.510901e-01 ,9.477416e-01 ,9.444520e-01 ,9.412194e-01 ,&amp;<a name='8180'>
        &amp; 9.380415e-01 ,9.349165e-01 ,9.318421e-01 ,9.288164e-01 ,9.258373e-01 ,&amp;<a name='8181'>
        &amp; 9.229027e-01 ,9.200106e-01 ,9.171589e-01 ,9.143457e-01 ,9.115688e-01 ,&amp;<a name='8182'>
        &amp; 9.088263e-01 ,9.061161e-01 ,9.034362e-01 ,9.007846e-01 ,8.981592e-01 ,&amp;<a name='8183'>
        &amp; 8.955581e-01 ,8.929792e-01 ,8.904206e-01 ,8.878803e-01 ,8.853562e-01 ,&amp;<a name='8184'>
        &amp; 8.828464e-01 ,8.803488e-01 ,8.778616e-01 ,8.753827e-01 ,8.729102e-01 ,&amp;<a name='8185'>
        &amp; 8.704421e-01 ,8.679764e-01 ,8.655112e-01 ,8.630445e-01 ,8.605744e-01 ,&amp;<a name='8186'>
        &amp; 8.580989e-01  /)<a name='8187'>
      ssaice3(:, 19) = (/ &amp;<a name='8188'>
<font color=#447700>! band 19<a name='8189'></font>
        &amp; 9.629413e-01 ,9.517182e-01 ,9.409209e-01 ,9.305366e-01 ,9.205529e-01 ,&amp;<a name='8190'>
        &amp; 9.109569e-01 ,9.017362e-01 ,8.928780e-01 ,8.843699e-01 ,8.761992e-01 ,&amp;<a name='8191'>
        &amp; 8.683536e-01 ,8.608204e-01 ,8.535873e-01 ,8.466417e-01 ,8.399712e-01 ,&amp;<a name='8192'>
        &amp; 8.335635e-01 ,8.274062e-01 ,8.214868e-01 ,8.157932e-01 ,8.103129e-01 ,&amp;<a name='8193'>
        &amp; 8.050336e-01 ,7.999432e-01 ,7.950294e-01 ,7.902798e-01 ,7.856825e-01 ,&amp;<a name='8194'>
        &amp; 7.812250e-01 ,7.768954e-01 ,7.726815e-01 ,7.685711e-01 ,7.645522e-01 ,&amp;<a name='8195'>
        &amp; 7.606126e-01 ,7.567404e-01 ,7.529234e-01 ,7.491498e-01 ,7.454074e-01 ,&amp;<a name='8196'>
        &amp; 7.416844e-01 ,7.379688e-01 ,7.342485e-01 ,7.305118e-01 ,7.267468e-01 ,&amp;<a name='8197'>
        &amp; 7.229415e-01 ,7.190841e-01 ,7.151628e-01 ,7.111657e-01 ,7.070811e-01 ,&amp;<a name='8198'>
        &amp; 7.028972e-01  /)<a name='8199'>
      ssaice3(:, 20) = (/ &amp;<a name='8200'>
<font color=#447700>! band 20<a name='8201'></font>
        &amp; 9.942270e-01 ,9.909206e-01 ,9.876775e-01 ,9.844960e-01 ,9.813746e-01 ,&amp;<a name='8202'>
        &amp; 9.783114e-01 ,9.753049e-01 ,9.723535e-01 ,9.694553e-01 ,9.666088e-01 ,&amp;<a name='8203'>
        &amp; 9.638123e-01 ,9.610641e-01 ,9.583626e-01 ,9.557060e-01 ,9.530928e-01 ,&amp;<a name='8204'>
        &amp; 9.505211e-01 ,9.479895e-01 ,9.454961e-01 ,9.430393e-01 ,9.406174e-01 ,&amp;<a name='8205'>
        &amp; 9.382288e-01 ,9.358717e-01 ,9.335446e-01 ,9.312456e-01 ,9.289731e-01 ,&amp;<a name='8206'>
        &amp; 9.267255e-01 ,9.245010e-01 ,9.222980e-01 ,9.201147e-01 ,9.179496e-01 ,&amp;<a name='8207'>
        &amp; 9.158008e-01 ,9.136667e-01 ,9.115457e-01 ,9.094359e-01 ,9.073358e-01 ,&amp;<a name='8208'>
        &amp; 9.052436e-01 ,9.031577e-01 ,9.010763e-01 ,8.989977e-01 ,8.969203e-01 ,&amp;<a name='8209'>
        &amp; 8.948423e-01 ,8.927620e-01 ,8.906778e-01 ,8.885879e-01 ,8.864907e-01 ,&amp;<a name='8210'>
        &amp; 8.843843e-01  /)<a name='8211'>
      ssaice3(:, 21) = (/ &amp;<a name='8212'>
<font color=#447700>! band 21<a name='8213'></font>
        &amp; 9.934014e-01 ,9.899331e-01 ,9.865537e-01 ,9.832610e-01 ,9.800523e-01 ,&amp;<a name='8214'>
        &amp; 9.769254e-01 ,9.738777e-01 ,9.709069e-01 ,9.680106e-01 ,9.651862e-01 ,&amp;<a name='8215'>
        &amp; 9.624315e-01 ,9.597439e-01 ,9.571212e-01 ,9.545608e-01 ,9.520605e-01 ,&amp;<a name='8216'>
        &amp; 9.496177e-01 ,9.472301e-01 ,9.448954e-01 ,9.426111e-01 ,9.403749e-01 ,&amp;<a name='8217'>
        &amp; 9.381843e-01 ,9.360370e-01 ,9.339307e-01 ,9.318629e-01 ,9.298313e-01 ,&amp;<a name='8218'>
        &amp; 9.278336e-01 ,9.258673e-01 ,9.239302e-01 ,9.220198e-01 ,9.201338e-01 ,&amp;<a name='8219'>
        &amp; 9.182700e-01 ,9.164258e-01 ,9.145991e-01 ,9.127874e-01 ,9.109884e-01 ,&amp;<a name='8220'>
        &amp; 9.091999e-01 ,9.074194e-01 ,9.056447e-01 ,9.038735e-01 ,9.021033e-01 ,&amp;<a name='8221'>
        &amp; 9.003320e-01 ,8.985572e-01 ,8.967766e-01 ,8.949879e-01 ,8.931888e-01 ,&amp;<a name='8222'>
        &amp; 8.913770e-01  /)<a name='8223'>
      ssaice3(:, 22) = (/ &amp;<a name='8224'>
<font color=#447700>! band 22<a name='8225'></font>
        &amp; 9.994833e-01 ,9.992055e-01 ,9.989278e-01 ,9.986500e-01 ,9.983724e-01 ,&amp;<a name='8226'>
        &amp; 9.980947e-01 ,9.978172e-01 ,9.975397e-01 ,9.972623e-01 ,9.969849e-01 ,&amp;<a name='8227'>
        &amp; 9.967077e-01 ,9.964305e-01 ,9.961535e-01 ,9.958765e-01 ,9.955997e-01 ,&amp;<a name='8228'>
        &amp; 9.953230e-01 ,9.950464e-01 ,9.947699e-01 ,9.944936e-01 ,9.942174e-01 ,&amp;<a name='8229'>
        &amp; 9.939414e-01 ,9.936656e-01 ,9.933899e-01 ,9.931144e-01 ,9.928390e-01 ,&amp;<a name='8230'>
        &amp; 9.925639e-01 ,9.922889e-01 ,9.920141e-01 ,9.917396e-01 ,9.914652e-01 ,&amp;<a name='8231'>
        &amp; 9.911911e-01 ,9.909171e-01 ,9.906434e-01 ,9.903700e-01 ,9.900967e-01 ,&amp;<a name='8232'>
        &amp; 9.898237e-01 ,9.895510e-01 ,9.892784e-01 ,9.890062e-01 ,9.887342e-01 ,&amp;<a name='8233'>
        &amp; 9.884625e-01 ,9.881911e-01 ,9.879199e-01 ,9.876490e-01 ,9.873784e-01 ,&amp;<a name='8234'>
        &amp; 9.871081e-01  /)<a name='8235'>
      ssaice3(:, 23) = (/ &amp;<a name='8236'>
<font color=#447700>! band 23<a name='8237'></font>
        &amp; 9.999343e-01 ,9.998917e-01 ,9.998492e-01 ,9.998067e-01 ,9.997642e-01 ,&amp;<a name='8238'>
        &amp; 9.997218e-01 ,9.996795e-01 ,9.996372e-01 ,9.995949e-01 ,9.995528e-01 ,&amp;<a name='8239'>
        &amp; 9.995106e-01 ,9.994686e-01 ,9.994265e-01 ,9.993845e-01 ,9.993426e-01 ,&amp;<a name='8240'>
        &amp; 9.993007e-01 ,9.992589e-01 ,9.992171e-01 ,9.991754e-01 ,9.991337e-01 ,&amp;<a name='8241'>
        &amp; 9.990921e-01 ,9.990505e-01 ,9.990089e-01 ,9.989674e-01 ,9.989260e-01 ,&amp;<a name='8242'>
        &amp; 9.988846e-01 ,9.988432e-01 ,9.988019e-01 ,9.987606e-01 ,9.987194e-01 ,&amp;<a name='8243'>
        &amp; 9.986782e-01 ,9.986370e-01 ,9.985959e-01 ,9.985549e-01 ,9.985139e-01 ,&amp;<a name='8244'>
        &amp; 9.984729e-01 ,9.984319e-01 ,9.983910e-01 ,9.983502e-01 ,9.983094e-01 ,&amp;<a name='8245'>
        &amp; 9.982686e-01 ,9.982279e-01 ,9.981872e-01 ,9.981465e-01 ,9.981059e-01 ,&amp;<a name='8246'>
        &amp; 9.980653e-01  /)<a name='8247'>
      ssaice3(:, 24) = (/ &amp;<a name='8248'>
<font color=#447700>! band 24<a name='8249'></font>
        &amp; 9.999978e-01 ,9.999965e-01 ,9.999952e-01 ,9.999939e-01 ,9.999926e-01 ,&amp;<a name='8250'>
        &amp; 9.999913e-01 ,9.999900e-01 ,9.999887e-01 ,9.999873e-01 ,9.999860e-01 ,&amp;<a name='8251'>
        &amp; 9.999847e-01 ,9.999834e-01 ,9.999821e-01 ,9.999808e-01 ,9.999795e-01 ,&amp;<a name='8252'>
        &amp; 9.999782e-01 ,9.999769e-01 ,9.999756e-01 ,9.999743e-01 ,9.999730e-01 ,&amp;<a name='8253'>
        &amp; 9.999717e-01 ,9.999704e-01 ,9.999691e-01 ,9.999678e-01 ,9.999665e-01 ,&amp;<a name='8254'>
        &amp; 9.999652e-01 ,9.999639e-01 ,9.999626e-01 ,9.999613e-01 ,9.999600e-01 ,&amp;<a name='8255'>
        &amp; 9.999587e-01 ,9.999574e-01 ,9.999561e-01 ,9.999548e-01 ,9.999535e-01 ,&amp;<a name='8256'>
        &amp; 9.999522e-01 ,9.999509e-01 ,9.999496e-01 ,9.999483e-01 ,9.999470e-01 ,&amp;<a name='8257'>
        &amp; 9.999457e-01 ,9.999444e-01 ,9.999431e-01 ,9.999418e-01 ,9.999405e-01 ,&amp;<a name='8258'>
        &amp; 9.999392e-01  /)<a name='8259'>
      ssaice3(:, 25) = (/ &amp;<a name='8260'>
<font color=#447700>! band 25<a name='8261'></font>
        &amp; 9.999994e-01 ,9.999993e-01 ,9.999991e-01 ,9.999990e-01 ,9.999989e-01 ,&amp;<a name='8262'>
        &amp; 9.999987e-01 ,9.999986e-01 ,9.999984e-01 ,9.999983e-01 ,9.999982e-01 ,&amp;<a name='8263'>
        &amp; 9.999980e-01 ,9.999979e-01 ,9.999977e-01 ,9.999976e-01 ,9.999975e-01 ,&amp;<a name='8264'>
        &amp; 9.999973e-01 ,9.999972e-01 ,9.999970e-01 ,9.999969e-01 ,9.999967e-01 ,&amp;<a name='8265'>
        &amp; 9.999966e-01 ,9.999965e-01 ,9.999963e-01 ,9.999962e-01 ,9.999960e-01 ,&amp;<a name='8266'>
        &amp; 9.999959e-01 ,9.999957e-01 ,9.999956e-01 ,9.999954e-01 ,9.999953e-01 ,&amp;<a name='8267'>
        &amp; 9.999952e-01 ,9.999950e-01 ,9.999949e-01 ,9.999947e-01 ,9.999946e-01 ,&amp;<a name='8268'>
        &amp; 9.999944e-01 ,9.999943e-01 ,9.999941e-01 ,9.999940e-01 ,9.999939e-01 ,&amp;<a name='8269'>
        &amp; 9.999937e-01 ,9.999936e-01 ,9.999934e-01 ,9.999933e-01 ,9.999931e-01 ,&amp;<a name='8270'>
        &amp; 9.999930e-01  /)<a name='8271'>
      ssaice3(:, 26) = (/ &amp;<a name='8272'>
<font color=#447700>! band 26<a name='8273'></font>
        &amp; 9.999997e-01 ,9.999995e-01 ,9.999992e-01 ,9.999990e-01 ,9.999987e-01 ,&amp;<a name='8274'>
        &amp; 9.999985e-01 ,9.999983e-01 ,9.999980e-01 ,9.999978e-01 ,9.999976e-01 ,&amp;<a name='8275'>
        &amp; 9.999973e-01 ,9.999971e-01 ,9.999969e-01 ,9.999967e-01 ,9.999965e-01 ,&amp;<a name='8276'>
        &amp; 9.999963e-01 ,9.999960e-01 ,9.999958e-01 ,9.999956e-01 ,9.999954e-01 ,&amp;<a name='8277'>
        &amp; 9.999952e-01 ,9.999950e-01 ,9.999948e-01 ,9.999946e-01 ,9.999944e-01 ,&amp;<a name='8278'>
        &amp; 9.999942e-01 ,9.999939e-01 ,9.999937e-01 ,9.999935e-01 ,9.999933e-01 ,&amp;<a name='8279'>
        &amp; 9.999931e-01 ,9.999929e-01 ,9.999927e-01 ,9.999925e-01 ,9.999923e-01 ,&amp;<a name='8280'>
        &amp; 9.999920e-01 ,9.999918e-01 ,9.999916e-01 ,9.999914e-01 ,9.999911e-01 ,&amp;<a name='8281'>
        &amp; 9.999909e-01 ,9.999907e-01 ,9.999905e-01 ,9.999902e-01 ,9.999900e-01 ,&amp;<a name='8282'>
        &amp; 9.999897e-01  /)<a name='8283'>
      ssaice3(:, 27) = (/ &amp;<a name='8284'>
<font color=#447700>! band 27<a name='8285'></font>
        &amp; 9.999991e-01 ,9.999985e-01 ,9.999980e-01 ,9.999974e-01 ,9.999968e-01 ,&amp;<a name='8286'>
        &amp; 9.999963e-01 ,9.999957e-01 ,9.999951e-01 ,9.999946e-01 ,9.999940e-01 ,&amp;<a name='8287'>
        &amp; 9.999934e-01 ,9.999929e-01 ,9.999923e-01 ,9.999918e-01 ,9.999912e-01 ,&amp;<a name='8288'>
        &amp; 9.999907e-01 ,9.999901e-01 ,9.999896e-01 ,9.999891e-01 ,9.999885e-01 ,&amp;<a name='8289'>
        &amp; 9.999880e-01 ,9.999874e-01 ,9.999869e-01 ,9.999863e-01 ,9.999858e-01 ,&amp;<a name='8290'>
        &amp; 9.999853e-01 ,9.999847e-01 ,9.999842e-01 ,9.999836e-01 ,9.999831e-01 ,&amp;<a name='8291'>
        &amp; 9.999826e-01 ,9.999820e-01 ,9.999815e-01 ,9.999809e-01 ,9.999804e-01 ,&amp;<a name='8292'>
        &amp; 9.999798e-01 ,9.999793e-01 ,9.999787e-01 ,9.999782e-01 ,9.999776e-01 ,&amp;<a name='8293'>
        &amp; 9.999770e-01 ,9.999765e-01 ,9.999759e-01 ,9.999754e-01 ,9.999748e-01 ,&amp;<a name='8294'>
        &amp; 9.999742e-01  /)<a name='8295'>
      ssaice3(:, 28) = (/ &amp;<a name='8296'>
<font color=#447700>! band 28<a name='8297'></font>
        &amp; 9.999975e-01 ,9.999961e-01 ,9.999946e-01 ,9.999931e-01 ,9.999917e-01 ,&amp;<a name='8298'>
        &amp; 9.999903e-01 ,9.999888e-01 ,9.999874e-01 ,9.999859e-01 ,9.999845e-01 ,&amp;<a name='8299'>
        &amp; 9.999831e-01 ,9.999816e-01 ,9.999802e-01 ,9.999788e-01 ,9.999774e-01 ,&amp;<a name='8300'>
        &amp; 9.999759e-01 ,9.999745e-01 ,9.999731e-01 ,9.999717e-01 ,9.999702e-01 ,&amp;<a name='8301'>
        &amp; 9.999688e-01 ,9.999674e-01 ,9.999660e-01 ,9.999646e-01 ,9.999631e-01 ,&amp;<a name='8302'>
        &amp; 9.999617e-01 ,9.999603e-01 ,9.999589e-01 ,9.999574e-01 ,9.999560e-01 ,&amp;<a name='8303'>
        &amp; 9.999546e-01 ,9.999532e-01 ,9.999517e-01 ,9.999503e-01 ,9.999489e-01 ,&amp;<a name='8304'>
        &amp; 9.999474e-01 ,9.999460e-01 ,9.999446e-01 ,9.999431e-01 ,9.999417e-01 ,&amp;<a name='8305'>
        &amp; 9.999403e-01 ,9.999388e-01 ,9.999374e-01 ,9.999359e-01 ,9.999345e-01 ,&amp;<a name='8306'>
        &amp; 9.999330e-01  /)<a name='8307'>
      ssaice3(:, 29) = (/ &amp;<a name='8308'>
<font color=#447700>! band 29<a name='8309'></font>
        &amp; 4.526500e-01 ,5.287890e-01 ,5.410487e-01 ,5.459865e-01 ,5.485149e-01 ,&amp;<a name='8310'>
        &amp; 5.498914e-01 ,5.505895e-01 ,5.508310e-01 ,5.507364e-01 ,5.503793e-01 ,&amp;<a name='8311'>
        &amp; 5.498090e-01 ,5.490612e-01 ,5.481637e-01 ,5.471395e-01 ,5.460083e-01 ,&amp;<a name='8312'>
        &amp; 5.447878e-01 ,5.434946e-01 ,5.421442e-01 ,5.407514e-01 ,5.393309e-01 ,&amp;<a name='8313'>
        &amp; 5.378970e-01 ,5.364641e-01 ,5.350464e-01 ,5.336582e-01 ,5.323140e-01 ,&amp;<a name='8314'>
        &amp; 5.310283e-01 ,5.298158e-01 ,5.286914e-01 ,5.276704e-01 ,5.267680e-01 ,&amp;<a name='8315'>
        &amp; 5.260000e-01 ,5.253823e-01 ,5.249311e-01 ,5.246629e-01 ,5.245946e-01 ,&amp;<a name='8316'>
        &amp; 5.247434e-01 ,5.251268e-01 ,5.257626e-01 ,5.266693e-01 ,5.278653e-01 ,&amp;<a name='8317'>
        &amp; 5.293698e-01 ,5.312022e-01 ,5.333823e-01 ,5.359305e-01 ,5.388676e-01 ,&amp;<a name='8318'>
        &amp; 5.422146e-01  /)<a name='8319'>
<a name='8320'>
<font color=#447700>! asymmetry factor: unitless<a name='8321'></font>
      asyice3(:, 16) = (/ &amp;<a name='8322'>
<font color=#447700>! band 16<a name='8323'></font>
        &amp; 8.340752e-01 ,8.435170e-01 ,8.517487e-01 ,8.592064e-01 ,8.660387e-01 ,&amp;<a name='8324'>
        &amp; 8.723204e-01 ,8.780997e-01 ,8.834137e-01 ,8.882934e-01 ,8.927662e-01 ,&amp;<a name='8325'>
        &amp; 8.968577e-01 ,9.005914e-01 ,9.039899e-01 ,9.070745e-01 ,9.098659e-01 ,&amp;<a name='8326'>
        &amp; 9.123836e-01 ,9.146466e-01 ,9.166734e-01 ,9.184817e-01 ,9.200886e-01 ,&amp;<a name='8327'>
        &amp; 9.215109e-01 ,9.227648e-01 ,9.238661e-01 ,9.248304e-01 ,9.256727e-01 ,&amp;<a name='8328'>
        &amp; 9.264078e-01 ,9.270505e-01 ,9.276150e-01 ,9.281156e-01 ,9.285662e-01 ,&amp;<a name='8329'>
        &amp; 9.289806e-01 ,9.293726e-01 ,9.297557e-01 ,9.301435e-01 ,9.305491e-01 ,&amp;<a name='8330'>
        &amp; 9.309859e-01 ,9.314671e-01 ,9.320055e-01 ,9.326140e-01 ,9.333053e-01 ,&amp;<a name='8331'>
        &amp; 9.340919e-01 ,9.349861e-01 ,9.360000e-01 ,9.371451e-01 ,9.384329e-01 ,&amp;<a name='8332'>
        &amp; 9.398744e-01  /)<a name='8333'>
      asyice3(:, 17) = (/ &amp;<a name='8334'>
<font color=#447700>! band 17<a name='8335'></font>
        &amp; 8.728160e-01 ,8.777333e-01 ,8.823754e-01 ,8.867535e-01 ,8.908785e-01 ,&amp;<a name='8336'>
        &amp; 8.947611e-01 ,8.984118e-01 ,9.018408e-01 ,9.050582e-01 ,9.080739e-01 ,&amp;<a name='8337'>
        &amp; 9.108976e-01 ,9.135388e-01 ,9.160068e-01 ,9.183106e-01 ,9.204595e-01 ,&amp;<a name='8338'>
        &amp; 9.224620e-01 ,9.243271e-01 ,9.260632e-01 ,9.276788e-01 ,9.291822e-01 ,&amp;<a name='8339'>
        &amp; 9.305817e-01 ,9.318853e-01 ,9.331012e-01 ,9.342372e-01 ,9.353013e-01 ,&amp;<a name='8340'>
        &amp; 9.363013e-01 ,9.372450e-01 ,9.381400e-01 ,9.389939e-01 ,9.398145e-01 ,&amp;<a name='8341'>
        &amp; 9.406092e-01 ,9.413856e-01 ,9.421511e-01 ,9.429131e-01 ,9.436790e-01 ,&amp;<a name='8342'>
        &amp; 9.444561e-01 ,9.452517e-01 ,9.460729e-01 ,9.469270e-01 ,9.478209e-01 ,&amp;<a name='8343'>
        &amp; 9.487617e-01 ,9.497562e-01 ,9.508112e-01 ,9.519335e-01 ,9.531294e-01 ,&amp;<a name='8344'>
        &amp; 9.544055e-01  /)<a name='8345'>
      asyice3(:, 18) = (/ &amp;<a name='8346'>
<font color=#447700>! band 18<a name='8347'></font>
        &amp; 7.897566e-01 ,7.948704e-01 ,7.998041e-01 ,8.045623e-01 ,8.091495e-01 ,&amp;<a name='8348'>
        &amp; 8.135702e-01 ,8.178290e-01 ,8.219305e-01 ,8.258790e-01 ,8.296792e-01 ,&amp;<a name='8349'>
        &amp; 8.333355e-01 ,8.368524e-01 ,8.402343e-01 ,8.434856e-01 ,8.466108e-01 ,&amp;<a name='8350'>
        &amp; 8.496143e-01 ,8.525004e-01 ,8.552737e-01 ,8.579384e-01 ,8.604990e-01 ,&amp;<a name='8351'>
        &amp; 8.629597e-01 ,8.653250e-01 ,8.675992e-01 ,8.697867e-01 ,8.718916e-01 ,&amp;<a name='8352'>
        &amp; 8.739185e-01 ,8.758715e-01 ,8.777551e-01 ,8.795734e-01 ,8.813308e-01 ,&amp;<a name='8353'>
        &amp; 8.830315e-01 ,8.846799e-01 ,8.862802e-01 ,8.878366e-01 ,8.893534e-01 ,&amp;<a name='8354'>
        &amp; 8.908350e-01 ,8.922854e-01 ,8.937090e-01 ,8.951099e-01 ,8.964925e-01 ,&amp;<a name='8355'>
        &amp; 8.978609e-01 ,8.992192e-01 ,9.005718e-01 ,9.019229e-01 ,9.032765e-01 ,&amp;<a name='8356'>
        &amp; 9.046369e-01  /)<a name='8357'>
      asyice3(:, 19) = (/ &amp;<a name='8358'>
<font color=#447700>! band 19<a name='8359'></font>
        &amp; 7.812615e-01 ,7.887764e-01 ,7.959664e-01 ,8.028413e-01 ,8.094109e-01 ,&amp;<a name='8360'>
        &amp; 8.156849e-01 ,8.216730e-01 ,8.273846e-01 ,8.328294e-01 ,8.380166e-01 ,&amp;<a name='8361'>
        &amp; 8.429556e-01 ,8.476556e-01 ,8.521258e-01 ,8.563753e-01 ,8.604131e-01 ,&amp;<a name='8362'>
        &amp; 8.642481e-01 ,8.678893e-01 ,8.713455e-01 ,8.746254e-01 ,8.777378e-01 ,&amp;<a name='8363'>
        &amp; 8.806914e-01 ,8.834948e-01 ,8.861566e-01 ,8.886854e-01 ,8.910897e-01 ,&amp;<a name='8364'>
        &amp; 8.933779e-01 ,8.955586e-01 ,8.976402e-01 ,8.996311e-01 ,9.015398e-01 ,&amp;<a name='8365'>
        &amp; 9.033745e-01 ,9.051436e-01 ,9.068555e-01 ,9.085185e-01 ,9.101410e-01 ,&amp;<a name='8366'>
        &amp; 9.117311e-01 ,9.132972e-01 ,9.148476e-01 ,9.163905e-01 ,9.179340e-01 ,&amp;<a name='8367'>
        &amp; 9.194864e-01 ,9.210559e-01 ,9.226505e-01 ,9.242784e-01 ,9.259476e-01 ,&amp;<a name='8368'>
        &amp; 9.276661e-01  /)<a name='8369'>
      asyice3(:, 20) = (/ &amp;<a name='8370'>
<font color=#447700>! band 20<a name='8371'></font>
        &amp; 7.640720e-01 ,7.691119e-01 ,7.739941e-01 ,7.787222e-01 ,7.832998e-01 ,&amp;<a name='8372'>
        &amp; 7.877304e-01 ,7.920177e-01 ,7.961652e-01 ,8.001765e-01 ,8.040551e-01 ,&amp;<a name='8373'>
        &amp; 8.078044e-01 ,8.114280e-01 ,8.149294e-01 ,8.183119e-01 ,8.215791e-01 ,&amp;<a name='8374'>
        &amp; 8.247344e-01 ,8.277812e-01 ,8.307229e-01 ,8.335629e-01 ,8.363046e-01 ,&amp;<a name='8375'>
        &amp; 8.389514e-01 ,8.415067e-01 ,8.439738e-01 ,8.463560e-01 ,8.486568e-01 ,&amp;<a name='8376'>
        &amp; 8.508795e-01 ,8.530274e-01 ,8.551039e-01 ,8.571122e-01 ,8.590558e-01 ,&amp;<a name='8377'>
        &amp; 8.609378e-01 ,8.627618e-01 ,8.645309e-01 ,8.662485e-01 ,8.679178e-01 ,&amp;<a name='8378'>
        &amp; 8.695423e-01 ,8.711251e-01 ,8.726697e-01 ,8.741792e-01 ,8.756571e-01 ,&amp;<a name='8379'>
        &amp; 8.771065e-01 ,8.785307e-01 ,8.799331e-01 ,8.813169e-01 ,8.826854e-01 ,&amp;<a name='8380'>
        &amp; 8.840419e-01  /)<a name='8381'>
      asyice3(:, 21) = (/ &amp;<a name='8382'>
<font color=#447700>! band 21<a name='8383'></font>
        &amp; 7.602598e-01 ,7.651572e-01 ,7.699014e-01 ,7.744962e-01 ,7.789452e-01 ,&amp;<a name='8384'>
        &amp; 7.832522e-01 ,7.874205e-01 ,7.914538e-01 ,7.953555e-01 ,7.991290e-01 ,&amp;<a name='8385'>
        &amp; 8.027777e-01 ,8.063049e-01 ,8.097140e-01 ,8.130081e-01 ,8.161906e-01 ,&amp;<a name='8386'>
        &amp; 8.192645e-01 ,8.222331e-01 ,8.250993e-01 ,8.278664e-01 ,8.305374e-01 ,&amp;<a name='8387'>
        &amp; 8.331153e-01 ,8.356030e-01 ,8.380037e-01 ,8.403201e-01 ,8.425553e-01 ,&amp;<a name='8388'>
        &amp; 8.447121e-01 ,8.467935e-01 ,8.488022e-01 ,8.507412e-01 ,8.526132e-01 ,&amp;<a name='8389'>
        &amp; 8.544210e-01 ,8.561675e-01 ,8.578554e-01 ,8.594875e-01 ,8.610665e-01 ,&amp;<a name='8390'>
        &amp; 8.625951e-01 ,8.640760e-01 ,8.655119e-01 ,8.669055e-01 ,8.682594e-01 ,&amp;<a name='8391'>
        &amp; 8.695763e-01 ,8.708587e-01 ,8.721094e-01 ,8.733308e-01 ,8.745255e-01 ,&amp;<a name='8392'>
        &amp; 8.756961e-01  /)<a name='8393'>
      asyice3(:, 22) = (/ &amp;<a name='8394'>
<font color=#447700>! band 22<a name='8395'></font>
        &amp; 7.568957e-01 ,7.606995e-01 ,7.644072e-01 ,7.680204e-01 ,7.715402e-01 ,&amp;<a name='8396'>
        &amp; 7.749682e-01 ,7.783057e-01 ,7.815541e-01 ,7.847148e-01 ,7.877892e-01 ,&amp;<a name='8397'>
        &amp; 7.907786e-01 ,7.936846e-01 ,7.965084e-01 ,7.992515e-01 ,8.019153e-01 ,&amp;<a name='8398'>
        &amp; 8.045011e-01 ,8.070103e-01 ,8.094444e-01 ,8.118048e-01 ,8.140927e-01 ,&amp;<a name='8399'>
        &amp; 8.163097e-01 ,8.184571e-01 ,8.205364e-01 ,8.225488e-01 ,8.244958e-01 ,&amp;<a name='8400'>
        &amp; 8.263789e-01 ,8.281993e-01 ,8.299586e-01 ,8.316580e-01 ,8.332991e-01 ,&amp;<a name='8401'>
        &amp; 8.348831e-01 ,8.364115e-01 ,8.378857e-01 ,8.393071e-01 ,8.406770e-01 ,&amp;<a name='8402'>
        &amp; 8.419969e-01 ,8.432682e-01 ,8.444923e-01 ,8.456706e-01 ,8.468044e-01 ,&amp;<a name='8403'>
        &amp; 8.478952e-01 ,8.489444e-01 ,8.499533e-01 ,8.509234e-01 ,8.518561e-01 ,&amp;<a name='8404'>
        &amp; 8.527528e-01  /)<a name='8405'>
      asyice3(:, 23) = (/ &amp;<a name='8406'>
<font color=#447700>! band 23<a name='8407'></font>
        &amp; 7.575066e-01 ,7.606912e-01 ,7.638236e-01 ,7.669035e-01 ,7.699306e-01 ,&amp;<a name='8408'>
        &amp; 7.729046e-01 ,7.758254e-01 ,7.786926e-01 ,7.815060e-01 ,7.842654e-01 ,&amp;<a name='8409'>
        &amp; 7.869705e-01 ,7.896211e-01 ,7.922168e-01 ,7.947574e-01 ,7.972428e-01 ,&amp;<a name='8410'>
        &amp; 7.996726e-01 ,8.020466e-01 ,8.043646e-01 ,8.066262e-01 ,8.088313e-01 ,&amp;<a name='8411'>
        &amp; 8.109796e-01 ,8.130709e-01 ,8.151049e-01 ,8.170814e-01 ,8.190001e-01 ,&amp;<a name='8412'>
        &amp; 8.208608e-01 ,8.226632e-01 ,8.244071e-01 ,8.260924e-01 ,8.277186e-01 ,&amp;<a name='8413'>
        &amp; 8.292856e-01 ,8.307932e-01 ,8.322411e-01 ,8.336291e-01 ,8.349570e-01 ,&amp;<a name='8414'>
        &amp; 8.362244e-01 ,8.374312e-01 ,8.385772e-01 ,8.396621e-01 ,8.406856e-01 ,&amp;<a name='8415'>
        &amp; 8.416476e-01 ,8.425479e-01 ,8.433861e-01 ,8.441620e-01 ,8.448755e-01 ,&amp;<a name='8416'>
        &amp; 8.455263e-01  /)<a name='8417'>
      asyice3(:, 24) = (/ &amp;<a name='8418'>
<font color=#447700>! band 24<a name='8419'></font>
        &amp; 7.568829e-01 ,7.597947e-01 ,7.626745e-01 ,7.655212e-01 ,7.683337e-01 ,&amp;<a name='8420'>
        &amp; 7.711111e-01 ,7.738523e-01 ,7.765565e-01 ,7.792225e-01 ,7.818494e-01 ,&amp;<a name='8421'>
        &amp; 7.844362e-01 ,7.869819e-01 ,7.894854e-01 ,7.919459e-01 ,7.943623e-01 ,&amp;<a name='8422'>
        &amp; 7.967337e-01 ,7.990590e-01 ,8.013373e-01 ,8.035676e-01 ,8.057488e-01 ,&amp;<a name='8423'>
        &amp; 8.078802e-01 ,8.099605e-01 ,8.119890e-01 ,8.139645e-01 ,8.158862e-01 ,&amp;<a name='8424'>
        &amp; 8.177530e-01 ,8.195641e-01 ,8.213183e-01 ,8.230149e-01 ,8.246527e-01 ,&amp;<a name='8425'>
        &amp; 8.262308e-01 ,8.277483e-01 ,8.292042e-01 ,8.305976e-01 ,8.319275e-01 ,&amp;<a name='8426'>
        &amp; 8.331929e-01 ,8.343929e-01 ,8.355265e-01 ,8.365928e-01 ,8.375909e-01 ,&amp;<a name='8427'>
        &amp; 8.385197e-01 ,8.393784e-01 ,8.401659e-01 ,8.408815e-01 ,8.415240e-01 ,&amp;<a name='8428'>
        &amp; 8.420926e-01  /)<a name='8429'>
      asyice3(:, 25) = (/ &amp;<a name='8430'>
<font color=#447700>! band 25<a name='8431'></font>
        &amp; 7.548616e-01 ,7.575454e-01 ,7.602153e-01 ,7.628696e-01 ,7.655067e-01 ,&amp;<a name='8432'>
        &amp; 7.681249e-01 ,7.707225e-01 ,7.732978e-01 ,7.758492e-01 ,7.783750e-01 ,&amp;<a name='8433'>
        &amp; 7.808735e-01 ,7.833430e-01 ,7.857819e-01 ,7.881886e-01 ,7.905612e-01 ,&amp;<a name='8434'>
        &amp; 7.928983e-01 ,7.951980e-01 ,7.974588e-01 ,7.996789e-01 ,8.018567e-01 ,&amp;<a name='8435'>
        &amp; 8.039905e-01 ,8.060787e-01 ,8.081196e-01 ,8.101115e-01 ,8.120527e-01 ,&amp;<a name='8436'>
        &amp; 8.139416e-01 ,8.157764e-01 ,8.175557e-01 ,8.192776e-01 ,8.209405e-01 ,&amp;<a name='8437'>
        &amp; 8.225427e-01 ,8.240826e-01 ,8.255585e-01 ,8.269688e-01 ,8.283117e-01 ,&amp;<a name='8438'>
        &amp; 8.295856e-01 ,8.307889e-01 ,8.319198e-01 ,8.329767e-01 ,8.339579e-01 ,&amp;<a name='8439'>
        &amp; 8.348619e-01 ,8.356868e-01 ,8.364311e-01 ,8.370930e-01 ,8.376710e-01 ,&amp;<a name='8440'>
        &amp; 8.381633e-01  /)<a name='8441'>
      asyice3(:, 26) = (/ &amp;<a name='8442'>
<font color=#447700>! band 26<a name='8443'></font>
        &amp; 7.491854e-01 ,7.518523e-01 ,7.545089e-01 ,7.571534e-01 ,7.597839e-01 ,&amp;<a name='8444'>
        &amp; 7.623987e-01 ,7.649959e-01 ,7.675737e-01 ,7.701303e-01 ,7.726639e-01 ,&amp;<a name='8445'>
        &amp; 7.751727e-01 ,7.776548e-01 ,7.801084e-01 ,7.825318e-01 ,7.849230e-01 ,&amp;<a name='8446'>
        &amp; 7.872804e-01 ,7.896020e-01 ,7.918862e-01 ,7.941309e-01 ,7.963345e-01 ,&amp;<a name='8447'>
        &amp; 7.984951e-01 ,8.006109e-01 ,8.026802e-01 ,8.047009e-01 ,8.066715e-01 ,&amp;<a name='8448'>
        &amp; 8.085900e-01 ,8.104546e-01 ,8.122636e-01 ,8.140150e-01 ,8.157072e-01 ,&amp;<a name='8449'>
        &amp; 8.173382e-01 ,8.189063e-01 ,8.204096e-01 ,8.218464e-01 ,8.232148e-01 ,&amp;<a name='8450'>
        &amp; 8.245130e-01 ,8.257391e-01 ,8.268915e-01 ,8.279682e-01 ,8.289675e-01 ,&amp;<a name='8451'>
        &amp; 8.298875e-01 ,8.307264e-01 ,8.314824e-01 ,8.321537e-01 ,8.327385e-01 ,&amp;<a name='8452'>
        &amp; 8.332350e-01  /)<a name='8453'>
      asyice3(:, 27) = (/ &amp;<a name='8454'>
<font color=#447700>! band 27<a name='8455'></font>
        &amp; 7.397086e-01 ,7.424069e-01 ,7.450955e-01 ,7.477725e-01 ,7.504362e-01 ,&amp;<a name='8456'>
        &amp; 7.530846e-01 ,7.557159e-01 ,7.583283e-01 ,7.609199e-01 ,7.634888e-01 ,&amp;<a name='8457'>
        &amp; 7.660332e-01 ,7.685512e-01 ,7.710411e-01 ,7.735009e-01 ,7.759288e-01 ,&amp;<a name='8458'>
        &amp; 7.783229e-01 ,7.806814e-01 ,7.830024e-01 ,7.852841e-01 ,7.875246e-01 ,&amp;<a name='8459'>
        &amp; 7.897221e-01 ,7.918748e-01 ,7.939807e-01 ,7.960380e-01 ,7.980449e-01 ,&amp;<a name='8460'>
        &amp; 7.999995e-01 ,8.019000e-01 ,8.037445e-01 ,8.055311e-01 ,8.072581e-01 ,&amp;<a name='8461'>
        &amp; 8.089235e-01 ,8.105255e-01 ,8.120623e-01 ,8.135319e-01 ,8.149326e-01 ,&amp;<a name='8462'>
        &amp; 8.162626e-01 ,8.175198e-01 ,8.187025e-01 ,8.198089e-01 ,8.208371e-01 ,&amp;<a name='8463'>
        &amp; 8.217852e-01 ,8.226514e-01 ,8.234338e-01 ,8.241306e-01 ,8.247399e-01 ,&amp;<a name='8464'>
        &amp; 8.252599e-01  /)<a name='8465'>
      asyice3(:, 28) = (/ &amp;<a name='8466'>
<font color=#447700>! band 28<a name='8467'></font>
        &amp; 7.224533e-01 ,7.251681e-01 ,7.278728e-01 ,7.305654e-01 ,7.332444e-01 ,&amp;<a name='8468'>
        &amp; 7.359078e-01 ,7.385539e-01 ,7.411808e-01 ,7.437869e-01 ,7.463702e-01 ,&amp;<a name='8469'>
        &amp; 7.489291e-01 ,7.514616e-01 ,7.539661e-01 ,7.564408e-01 ,7.588837e-01 ,&amp;<a name='8470'>
        &amp; 7.612933e-01 ,7.636676e-01 ,7.660049e-01 ,7.683034e-01 ,7.705612e-01 ,&amp;<a name='8471'>
        &amp; 7.727767e-01 ,7.749480e-01 ,7.770733e-01 ,7.791509e-01 ,7.811789e-01 ,&amp;<a name='8472'>
        &amp; 7.831556e-01 ,7.850791e-01 ,7.869478e-01 ,7.887597e-01 ,7.905131e-01 ,&amp;<a name='8473'>
        &amp; 7.922062e-01 ,7.938372e-01 ,7.954044e-01 ,7.969059e-01 ,7.983399e-01 ,&amp;<a name='8474'>
        &amp; 7.997047e-01 ,8.009985e-01 ,8.022195e-01 ,8.033658e-01 ,8.044357e-01 ,&amp;<a name='8475'>
        &amp; 8.054275e-01 ,8.063392e-01 ,8.071692e-01 ,8.079157e-01 ,8.085768e-01 ,&amp;<a name='8476'>
        &amp; 8.091507e-01  /)<a name='8477'>
      asyice3(:, 29) = (/ &amp;<a name='8478'>
<font color=#447700>! band 29<a name='8479'></font>
        &amp; 8.850026e-01 ,9.005489e-01 ,9.069242e-01 ,9.121799e-01 ,9.168987e-01 ,&amp;<a name='8480'>
        &amp; 9.212259e-01 ,9.252176e-01 ,9.289028e-01 ,9.323000e-01 ,9.354235e-01 ,&amp;<a name='8481'>
        &amp; 9.382858e-01 ,9.408985e-01 ,9.432734e-01 ,9.454218e-01 ,9.473557e-01 ,&amp;<a name='8482'>
        &amp; 9.490871e-01 ,9.506282e-01 ,9.519917e-01 ,9.531904e-01 ,9.542374e-01 ,&amp;<a name='8483'>
        &amp; 9.551461e-01 ,9.559298e-01 ,9.566023e-01 ,9.571775e-01 ,9.576692e-01 ,&amp;<a name='8484'>
        &amp; 9.580916e-01 ,9.584589e-01 ,9.587853e-01 ,9.590851e-01 ,9.593729e-01 ,&amp;<a name='8485'>
        &amp; 9.596632e-01 ,9.599705e-01 ,9.603096e-01 ,9.606954e-01 ,9.611427e-01 ,&amp;<a name='8486'>
        &amp; 9.616667e-01 ,9.622826e-01 ,9.630060e-01 ,9.638524e-01 ,9.648379e-01 ,&amp;<a name='8487'>
        &amp; 9.659788e-01 ,9.672916e-01 ,9.687933e-01 ,9.705014e-01 ,9.724337e-01 ,&amp;<a name='8488'>
        &amp; 9.746084e-01  /)<a name='8489'>
<a name='8490'>
<font color=#447700>! fdelta: unitless<a name='8491'></font>
      fdlice3(:, 16) = (/ &amp;<a name='8492'>
<font color=#447700>! band 16<a name='8493'></font>
        &amp; 4.959277e-02 ,4.685292e-02 ,4.426104e-02 ,4.181231e-02 ,3.950191e-02 ,&amp;<a name='8494'>
        &amp; 3.732500e-02 ,3.527675e-02 ,3.335235e-02 ,3.154697e-02 ,2.985578e-02 ,&amp;<a name='8495'>
        &amp; 2.827395e-02 ,2.679666e-02 ,2.541909e-02 ,2.413640e-02 ,2.294378e-02 ,&amp;<a name='8496'>
        &amp; 2.183639e-02 ,2.080940e-02 ,1.985801e-02 ,1.897736e-02 ,1.816265e-02 ,&amp;<a name='8497'>
        &amp; 1.740905e-02 ,1.671172e-02 ,1.606585e-02 ,1.546661e-02 ,1.490917e-02 ,&amp;<a name='8498'>
        &amp; 1.438870e-02 ,1.390038e-02 ,1.343939e-02 ,1.300089e-02 ,1.258006e-02 ,&amp;<a name='8499'>
        &amp; 1.217208e-02 ,1.177212e-02 ,1.137536e-02 ,1.097696e-02 ,1.057210e-02 ,&amp;<a name='8500'>
        &amp; 1.015596e-02 ,9.723704e-03 ,9.270516e-03 ,8.791565e-03 ,8.282026e-03 ,&amp;<a name='8501'>
        &amp; 7.737072e-03 ,7.151879e-03 ,6.521619e-03 ,5.841467e-03 ,5.106597e-03 ,&amp;<a name='8502'>
        &amp; 4.312183e-03  /)<a name='8503'>
      fdlice3(:, 17) = (/ &amp;<a name='8504'>
<font color=#447700>! band 17<a name='8505'></font>
        &amp; 5.071224e-02 ,5.000217e-02 ,4.933872e-02 ,4.871992e-02 ,4.814380e-02 ,&amp;<a name='8506'>
        &amp; 4.760839e-02 ,4.711170e-02 ,4.665177e-02 ,4.622662e-02 ,4.583426e-02 ,&amp;<a name='8507'>
        &amp; 4.547274e-02 ,4.514007e-02 ,4.483428e-02 ,4.455340e-02 ,4.429544e-02 ,&amp;<a name='8508'>
        &amp; 4.405844e-02 ,4.384041e-02 ,4.363939e-02 ,4.345340e-02 ,4.328047e-02 ,&amp;<a name='8509'>
        &amp; 4.311861e-02 ,4.296586e-02 ,4.282024e-02 ,4.267977e-02 ,4.254248e-02 ,&amp;<a name='8510'>
        &amp; 4.240640e-02 ,4.226955e-02 ,4.212995e-02 ,4.198564e-02 ,4.183462e-02 ,&amp;<a name='8511'>
        &amp; 4.167494e-02 ,4.150462e-02 ,4.132167e-02 ,4.112413e-02 ,4.091003e-02 ,&amp;<a name='8512'>
        &amp; 4.067737e-02 ,4.042420e-02 ,4.014854e-02 ,3.984840e-02 ,3.952183e-02 ,&amp;<a name='8513'>
        &amp; 3.916683e-02 ,3.878144e-02 ,3.836368e-02 ,3.791158e-02 ,3.742316e-02 ,&amp;<a name='8514'>
        &amp; 3.689645e-02  /)<a name='8515'>
      fdlice3(:, 18) = (/ &amp;<a name='8516'>
<font color=#447700>! band 18<a name='8517'></font>
        &amp; 1.062938e-01 ,1.065234e-01 ,1.067822e-01 ,1.070682e-01 ,1.073793e-01 ,&amp;<a name='8518'>
        &amp; 1.077137e-01 ,1.080693e-01 ,1.084442e-01 ,1.088364e-01 ,1.092439e-01 ,&amp;<a name='8519'>
        &amp; 1.096647e-01 ,1.100970e-01 ,1.105387e-01 ,1.109878e-01 ,1.114423e-01 ,&amp;<a name='8520'>
        &amp; 1.119004e-01 ,1.123599e-01 ,1.128190e-01 ,1.132757e-01 ,1.137279e-01 ,&amp;<a name='8521'>
        &amp; 1.141738e-01 ,1.146113e-01 ,1.150385e-01 ,1.154534e-01 ,1.158540e-01 ,&amp;<a name='8522'>
        &amp; 1.162383e-01 ,1.166045e-01 ,1.169504e-01 ,1.172741e-01 ,1.175738e-01 ,&amp;<a name='8523'>
        &amp; 1.178472e-01 ,1.180926e-01 ,1.183080e-01 ,1.184913e-01 ,1.186405e-01 ,&amp;<a name='8524'>
        &amp; 1.187538e-01 ,1.188291e-01 ,1.188645e-01 ,1.188580e-01 ,1.188076e-01 ,&amp;<a name='8525'>
        &amp; 1.187113e-01 ,1.185672e-01 ,1.183733e-01 ,1.181277e-01 ,1.178282e-01 ,&amp;<a name='8526'>
        &amp; 1.174731e-01  /)<a name='8527'>
      fdlice3(:, 19) = (/ &amp;<a name='8528'>
<font color=#447700>! band 19<a name='8529'></font>
        &amp; 1.076195e-01 ,1.065195e-01 ,1.054696e-01 ,1.044673e-01 ,1.035099e-01 ,&amp;<a name='8530'>
        &amp; 1.025951e-01 ,1.017203e-01 ,1.008831e-01 ,1.000808e-01 ,9.931116e-02 ,&amp;<a name='8531'>
        &amp; 9.857151e-02 ,9.785939e-02 ,9.717230e-02 ,9.650774e-02 ,9.586322e-02 ,&amp;<a name='8532'>
        &amp; 9.523623e-02 ,9.462427e-02 ,9.402484e-02 ,9.343544e-02 ,9.285358e-02 ,&amp;<a name='8533'>
        &amp; 9.227675e-02 ,9.170245e-02 ,9.112818e-02 ,9.055144e-02 ,8.996974e-02 ,&amp;<a name='8534'>
        &amp; 8.938056e-02 ,8.878142e-02 ,8.816981e-02 ,8.754323e-02 ,8.689919e-02 ,&amp;<a name='8535'>
        &amp; 8.623517e-02 ,8.554869e-02 ,8.483724e-02 ,8.409832e-02 ,8.332943e-02 ,&amp;<a name='8536'>
        &amp; 8.252807e-02 ,8.169175e-02 ,8.081795e-02 ,7.990419e-02 ,7.894796e-02 ,&amp;<a name='8537'>
        &amp; 7.794676e-02 ,7.689809e-02 ,7.579945e-02 ,7.464834e-02 ,7.344227e-02 ,&amp;<a name='8538'>
        &amp; 7.217872e-02  /)<a name='8539'>
      fdlice3(:, 20) = (/ &amp;<a name='8540'>
<font color=#447700>! band 20<a name='8541'></font>
        &amp; 1.119014e-01 ,1.122706e-01 ,1.126690e-01 ,1.130947e-01 ,1.135456e-01 ,&amp;<a name='8542'>
        &amp; 1.140199e-01 ,1.145154e-01 ,1.150302e-01 ,1.155623e-01 ,1.161096e-01 ,&amp;<a name='8543'>
        &amp; 1.166703e-01 ,1.172422e-01 ,1.178233e-01 ,1.184118e-01 ,1.190055e-01 ,&amp;<a name='8544'>
        &amp; 1.196025e-01 ,1.202008e-01 ,1.207983e-01 ,1.213931e-01 ,1.219832e-01 ,&amp;<a name='8545'>
        &amp; 1.225665e-01 ,1.231411e-01 ,1.237050e-01 ,1.242561e-01 ,1.247926e-01 ,&amp;<a name='8546'>
        &amp; 1.253122e-01 ,1.258132e-01 ,1.262934e-01 ,1.267509e-01 ,1.271836e-01 ,&amp;<a name='8547'>
        &amp; 1.275896e-01 ,1.279669e-01 ,1.283134e-01 ,1.286272e-01 ,1.289063e-01 ,&amp;<a name='8548'>
        &amp; 1.291486e-01 ,1.293522e-01 ,1.295150e-01 ,1.296351e-01 ,1.297104e-01 ,&amp;<a name='8549'>
        &amp; 1.297390e-01 ,1.297189e-01 ,1.296480e-01 ,1.295244e-01 ,1.293460e-01 ,&amp;<a name='8550'>
        &amp; 1.291109e-01  /)<a name='8551'>
      fdlice3(:, 21) = (/ &amp;<a name='8552'>
<font color=#447700>! band 21<a name='8553'></font>
        &amp; 1.133298e-01 ,1.136777e-01 ,1.140556e-01 ,1.144615e-01 ,1.148934e-01 ,&amp;<a name='8554'>
        &amp; 1.153492e-01 ,1.158269e-01 ,1.163243e-01 ,1.168396e-01 ,1.173706e-01 ,&amp;<a name='8555'>
        &amp; 1.179152e-01 ,1.184715e-01 ,1.190374e-01 ,1.196108e-01 ,1.201897e-01 ,&amp;<a name='8556'>
        &amp; 1.207720e-01 ,1.213558e-01 ,1.219389e-01 ,1.225194e-01 ,1.230951e-01 ,&amp;<a name='8557'>
        &amp; 1.236640e-01 ,1.242241e-01 ,1.247733e-01 ,1.253096e-01 ,1.258309e-01 ,&amp;<a name='8558'>
        &amp; 1.263352e-01 ,1.268205e-01 ,1.272847e-01 ,1.277257e-01 ,1.281415e-01 ,&amp;<a name='8559'>
        &amp; 1.285300e-01 ,1.288893e-01 ,1.292173e-01 ,1.295118e-01 ,1.297710e-01 ,&amp;<a name='8560'>
        &amp; 1.299927e-01 ,1.301748e-01 ,1.303154e-01 ,1.304124e-01 ,1.304637e-01 ,&amp;<a name='8561'>
        &amp; 1.304673e-01 ,1.304212e-01 ,1.303233e-01 ,1.301715e-01 ,1.299638e-01 ,&amp;<a name='8562'>
        &amp; 1.296983e-01  /)<a name='8563'>
      fdlice3(:, 22) = (/ &amp;<a name='8564'>
<font color=#447700>! band 22<a name='8565'></font>
        &amp; 1.145360e-01 ,1.153256e-01 ,1.161453e-01 ,1.169929e-01 ,1.178666e-01 ,&amp;<a name='8566'>
        &amp; 1.187641e-01 ,1.196835e-01 ,1.206227e-01 ,1.215796e-01 ,1.225522e-01 ,&amp;<a name='8567'>
        &amp; 1.235383e-01 ,1.245361e-01 ,1.255433e-01 ,1.265579e-01 ,1.275779e-01 ,&amp;<a name='8568'>
        &amp; 1.286011e-01 ,1.296257e-01 ,1.306494e-01 ,1.316703e-01 ,1.326862e-01 ,&amp;<a name='8569'>
        &amp; 1.336951e-01 ,1.346950e-01 ,1.356838e-01 ,1.366594e-01 ,1.376198e-01 ,&amp;<a name='8570'>
        &amp; 1.385629e-01 ,1.394866e-01 ,1.403889e-01 ,1.412678e-01 ,1.421212e-01 ,&amp;<a name='8571'>
        &amp; 1.429469e-01 ,1.437430e-01 ,1.445074e-01 ,1.452381e-01 ,1.459329e-01 ,&amp;<a name='8572'>
        &amp; 1.465899e-01 ,1.472069e-01 ,1.477819e-01 ,1.483128e-01 ,1.487976e-01 ,&amp;<a name='8573'>
        &amp; 1.492343e-01 ,1.496207e-01 ,1.499548e-01 ,1.502346e-01 ,1.504579e-01 ,&amp;<a name='8574'>
        &amp; 1.506227e-01  /)<a name='8575'>
      fdlice3(:, 23) = (/ &amp;<a name='8576'>
<font color=#447700>! band 23<a name='8577'></font>
        &amp; 1.153263e-01 ,1.161445e-01 ,1.169932e-01 ,1.178703e-01 ,1.187738e-01 ,&amp;<a name='8578'>
        &amp; 1.197016e-01 ,1.206516e-01 ,1.216217e-01 ,1.226099e-01 ,1.236141e-01 ,&amp;<a name='8579'>
        &amp; 1.246322e-01 ,1.256621e-01 ,1.267017e-01 ,1.277491e-01 ,1.288020e-01 ,&amp;<a name='8580'>
        &amp; 1.298584e-01 ,1.309163e-01 ,1.319736e-01 ,1.330281e-01 ,1.340778e-01 ,&amp;<a name='8581'>
        &amp; 1.351207e-01 ,1.361546e-01 ,1.371775e-01 ,1.381873e-01 ,1.391820e-01 ,&amp;<a name='8582'>
        &amp; 1.401593e-01 ,1.411174e-01 ,1.420540e-01 ,1.429671e-01 ,1.438547e-01 ,&amp;<a name='8583'>
        &amp; 1.447146e-01 ,1.455449e-01 ,1.463433e-01 ,1.471078e-01 ,1.478364e-01 ,&amp;<a name='8584'>
        &amp; 1.485270e-01 ,1.491774e-01 ,1.497857e-01 ,1.503497e-01 ,1.508674e-01 ,&amp;<a name='8585'>
        &amp; 1.513367e-01 ,1.517554e-01 ,1.521216e-01 ,1.524332e-01 ,1.526880e-01 ,&amp;<a name='8586'>
        &amp; 1.528840e-01  /)<a name='8587'>
      fdlice3(:, 24) = (/ &amp;<a name='8588'>
<font color=#447700>! band 24<a name='8589'></font>
        &amp; 1.160842e-01 ,1.169118e-01 ,1.177697e-01 ,1.186556e-01 ,1.195676e-01 ,&amp;<a name='8590'>
        &amp; 1.205036e-01 ,1.214616e-01 ,1.224394e-01 ,1.234349e-01 ,1.244463e-01 ,&amp;<a name='8591'>
        &amp; 1.254712e-01 ,1.265078e-01 ,1.275539e-01 ,1.286075e-01 ,1.296664e-01 ,&amp;<a name='8592'>
        &amp; 1.307287e-01 ,1.317923e-01 ,1.328550e-01 ,1.339149e-01 ,1.349699e-01 ,&amp;<a name='8593'>
        &amp; 1.360179e-01 ,1.370567e-01 ,1.380845e-01 ,1.390991e-01 ,1.400984e-01 ,&amp;<a name='8594'>
        &amp; 1.410803e-01 ,1.420429e-01 ,1.429840e-01 ,1.439016e-01 ,1.447936e-01 ,&amp;<a name='8595'>
        &amp; 1.456579e-01 ,1.464925e-01 ,1.472953e-01 ,1.480642e-01 ,1.487972e-01 ,&amp;<a name='8596'>
        &amp; 1.494923e-01 ,1.501472e-01 ,1.507601e-01 ,1.513287e-01 ,1.518511e-01 ,&amp;<a name='8597'>
        &amp; 1.523252e-01 ,1.527489e-01 ,1.531201e-01 ,1.534368e-01 ,1.536969e-01 ,&amp;<a name='8598'>
        &amp; 1.538984e-01  /)<a name='8599'>
      fdlice3(:, 25) = (/ &amp;<a name='8600'>
<font color=#447700>! band 25<a name='8601'></font>
        &amp; 1.168725e-01 ,1.177088e-01 ,1.185747e-01 ,1.194680e-01 ,1.203867e-01 ,&amp;<a name='8602'>
        &amp; 1.213288e-01 ,1.222923e-01 ,1.232750e-01 ,1.242750e-01 ,1.252903e-01 ,&amp;<a name='8603'>
        &amp; 1.263187e-01 ,1.273583e-01 ,1.284069e-01 ,1.294626e-01 ,1.305233e-01 ,&amp;<a name='8604'>
        &amp; 1.315870e-01 ,1.326517e-01 ,1.337152e-01 ,1.347756e-01 ,1.358308e-01 ,&amp;<a name='8605'>
        &amp; 1.368788e-01 ,1.379175e-01 ,1.389449e-01 ,1.399590e-01 ,1.409577e-01 ,&amp;<a name='8606'>
        &amp; 1.419389e-01 ,1.429007e-01 ,1.438410e-01 ,1.447577e-01 ,1.456488e-01 ,&amp;<a name='8607'>
        &amp; 1.465123e-01 ,1.473461e-01 ,1.481483e-01 ,1.489166e-01 ,1.496492e-01 ,&amp;<a name='8608'>
        &amp; 1.503439e-01 ,1.509988e-01 ,1.516118e-01 ,1.521808e-01 ,1.527038e-01 ,&amp;<a name='8609'>
        &amp; 1.531788e-01 ,1.536037e-01 ,1.539764e-01 ,1.542951e-01 ,1.545575e-01 ,&amp;<a name='8610'>
        &amp; 1.547617e-01  /)<a name='8611'>
      fdlice3(:, 26) = (/ &amp;<a name='8612'>
<font color=#447700>!band 26<a name='8613'></font>
        &amp; 1.180509e-01 ,1.189025e-01 ,1.197820e-01 ,1.206875e-01 ,1.216171e-01 ,&amp;<a name='8614'>
        &amp; 1.225687e-01 ,1.235404e-01 ,1.245303e-01 ,1.255363e-01 ,1.265564e-01 ,&amp;<a name='8615'>
        &amp; 1.275888e-01 ,1.286313e-01 ,1.296821e-01 ,1.307392e-01 ,1.318006e-01 ,&amp;<a name='8616'>
        &amp; 1.328643e-01 ,1.339284e-01 ,1.349908e-01 ,1.360497e-01 ,1.371029e-01 ,&amp;<a name='8617'>
        &amp; 1.381486e-01 ,1.391848e-01 ,1.402095e-01 ,1.412208e-01 ,1.422165e-01 ,&amp;<a name='8618'>
        &amp; 1.431949e-01 ,1.441539e-01 ,1.450915e-01 ,1.460058e-01 ,1.468947e-01 ,&amp;<a name='8619'>
        &amp; 1.477564e-01 ,1.485888e-01 ,1.493900e-01 ,1.501580e-01 ,1.508907e-01 ,&amp;<a name='8620'>
        &amp; 1.515864e-01 ,1.522428e-01 ,1.528582e-01 ,1.534305e-01 ,1.539578e-01 ,&amp;<a name='8621'>
        &amp; 1.544380e-01 ,1.548692e-01 ,1.552494e-01 ,1.555767e-01 ,1.558490e-01 ,&amp;<a name='8622'>
        &amp; 1.560645e-01  /)<a name='8623'>
      fdlice3(:, 27) = (/ &amp;<a name='8624'>
<font color=#447700>! band 27<a name='8625'></font>
        &amp; 1.200480e-01 ,1.209267e-01 ,1.218304e-01 ,1.227575e-01 ,1.237059e-01 ,&amp;<a name='8626'>
        &amp; 1.246739e-01 ,1.256595e-01 ,1.266610e-01 ,1.276765e-01 ,1.287041e-01 ,&amp;<a name='8627'>
        &amp; 1.297420e-01 ,1.307883e-01 ,1.318412e-01 ,1.328988e-01 ,1.339593e-01 ,&amp;<a name='8628'>
        &amp; 1.350207e-01 ,1.360813e-01 ,1.371393e-01 ,1.381926e-01 ,1.392396e-01 ,&amp;<a name='8629'>
        &amp; 1.402783e-01 ,1.413069e-01 ,1.423235e-01 ,1.433263e-01 ,1.443134e-01 ,&amp;<a name='8630'>
        &amp; 1.452830e-01 ,1.462332e-01 ,1.471622e-01 ,1.480681e-01 ,1.489490e-01 ,&amp;<a name='8631'>
        &amp; 1.498032e-01 ,1.506286e-01 ,1.514236e-01 ,1.521863e-01 ,1.529147e-01 ,&amp;<a name='8632'>
        &amp; 1.536070e-01 ,1.542614e-01 ,1.548761e-01 ,1.554491e-01 ,1.559787e-01 ,&amp;<a name='8633'>
        &amp; 1.564629e-01 ,1.568999e-01 ,1.572879e-01 ,1.576249e-01 ,1.579093e-01 ,&amp;<a name='8634'>
        &amp; 1.581390e-01  /)<a name='8635'>
      fdlice3(:, 28) = (/ &amp;<a name='8636'>
<font color=#447700>! band 28<a name='8637'></font>
        &amp; 1.247813e-01 ,1.256496e-01 ,1.265417e-01 ,1.274560e-01 ,1.283905e-01 ,&amp;<a name='8638'>
        &amp; 1.293436e-01 ,1.303135e-01 ,1.312983e-01 ,1.322964e-01 ,1.333060e-01 ,&amp;<a name='8639'>
        &amp; 1.343252e-01 ,1.353523e-01 ,1.363855e-01 ,1.374231e-01 ,1.384632e-01 ,&amp;<a name='8640'>
        &amp; 1.395042e-01 ,1.405441e-01 ,1.415813e-01 ,1.426140e-01 ,1.436404e-01 ,&amp;<a name='8641'>
        &amp; 1.446587e-01 ,1.456672e-01 ,1.466640e-01 ,1.476475e-01 ,1.486157e-01 ,&amp;<a name='8642'>
        &amp; 1.495671e-01 ,1.504997e-01 ,1.514117e-01 ,1.523016e-01 ,1.531673e-01 ,&amp;<a name='8643'>
        &amp; 1.540073e-01 ,1.548197e-01 ,1.556026e-01 ,1.563545e-01 ,1.570734e-01 ,&amp;<a name='8644'>
        &amp; 1.577576e-01 ,1.584054e-01 ,1.590149e-01 ,1.595843e-01 ,1.601120e-01 ,&amp;<a name='8645'>
        &amp; 1.605962e-01 ,1.610349e-01 ,1.614266e-01 ,1.617693e-01 ,1.620614e-01 ,&amp;<a name='8646'>
        &amp; 1.623011e-01  /)<a name='8647'>
      fdlice3(:, 29) = (/ &amp;<a name='8648'>
<font color=#447700>! band 29<a name='8649'></font>
        &amp; 1.006055e-01 ,9.549582e-02 ,9.063960e-02 ,8.602900e-02 ,8.165612e-02 ,&amp;<a name='8650'>
        &amp; 7.751308e-02 ,7.359199e-02 ,6.988496e-02 ,6.638412e-02 ,6.308156e-02 ,&amp;<a name='8651'>
        &amp; 5.996942e-02 ,5.703979e-02 ,5.428481e-02 ,5.169657e-02 ,4.926719e-02 ,&amp;<a name='8652'>
        &amp; 4.698880e-02 ,4.485349e-02 ,4.285339e-02 ,4.098061e-02 ,3.922727e-02 ,&amp;<a name='8653'>
        &amp; 3.758547e-02 ,3.604733e-02 ,3.460497e-02 ,3.325051e-02 ,3.197604e-02 ,&amp;<a name='8654'>
        &amp; 3.077369e-02 ,2.963558e-02 ,2.855381e-02 ,2.752050e-02 ,2.652776e-02 ,&amp;<a name='8655'>
        &amp; 2.556772e-02 ,2.463247e-02 ,2.371415e-02 ,2.280485e-02 ,2.189670e-02 ,&amp;<a name='8656'>
        &amp; 2.098180e-02 ,2.005228e-02 ,1.910024e-02 ,1.811781e-02 ,1.709709e-02 ,&amp;<a name='8657'>
        &amp; 1.603020e-02 ,1.490925e-02 ,1.372635e-02 ,1.247363e-02 ,1.114319e-02 ,&amp;<a name='8658'>
        &amp; 9.727157e-03  /)<a name='8659'>
<a name='8660'>
      end subroutine swcldpr<a name='8661'>
<a name='8662'>
      end module rrtmg_sw_init_f<a name='8663'>
<a name='8664'>
<A NAME='RRTMG_SW_SPCVMC_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SPCVMC_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='8665'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_spcvmc_f</font> <A href='../../call_to/RRTMG_SW_SPCVMC_F.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_SPCVMC_F.html' TARGET='index'>5</A><a name='8666'>
<a name='8667'>
<font color=#447700>! ------- Modules -------<a name='8668'></font>
<a name='8669'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SPCVMC_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_35">, only : nbndsw, ngptsw, mxmol, jpband, mxlay<a name='8670'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_TBL_F'>rrsw_tbl_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SPCVMC_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_TBL_F_2">, only : tblint, bpade, od_lo, exp_tbl<a name='8671'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_VSN_F'>rrsw_vsn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SPCVMC_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_F_7">, only : hvrspc, hnamspc<a name='8672'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_WVN_F'>rrsw_wvn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SPCVMC_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_F_5">, only : ngc, ngs, ngb<a name='8673'>
      <a name='8674'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_TAUMOL_F'>rrtmg_sw_taumol_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SPCVMC_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_TAUMOL_F_1">, only: taumol_sw<a name='8675'>
     <a name='8676'>
      implicit none<a name='8677'>
<a name='8678'>
      contains<a name='8679'>
<a name='8680'>
<font color=#447700>! ---------------------------------------------------------------------------<a name='8681'></font>
<A NAME='SPCVMC_SW'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='8682'>
      <font color=#993300>subroutine </font><font color=#cc0000>spcvmc_sw</font> &amp; <A href='../../call_to/SPCVMC_SW.html' TARGET='index'>2</A>,<A href='../../call_from/SPCVMC_SW.html' TARGET='index'>10</A><a name='8683'>
            (cc,tncol, ncol, nlayers, istart, iend, icpr, idelm, iout, &amp;<a name='8684'>
             pavel, tavel, pz, tz, tbound, palbd, palbp, &amp;<a name='8685'>
             pcldfmc, ptaucmc, pasycmc, pomgcmc, ptaormc, &amp;<a name='8686'>
             ptaua, pasya, pomga, prmu0, coldry,  adjflux, &amp;<a name='8687'>
             laytrop, layswtch, laylow, jp, jt, jt1, &amp;<a name='8688'>
             co2mult, colch4, colco2, colh2o, colmol, coln2o, colo2, colo3, &amp;<a name='8689'>
             fac00, fac01, fac10, fac11, &amp;<a name='8690'>
             selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='8691'>
             pbbfd, pbbfu, pbbcd, pbbcu, puvfd, puvcd, pnifd, pnicd, &amp;<a name='8692'>
             pbbfddir, pbbcddir, puvfddir, puvcddir, pnifddir, pnicddir, &amp;<a name='8693'>
             zgco,zomco,zrdnd,zref,zrefo,zrefd,zrefdo,ztauo,zdbt,ztdbt, &amp;<a name='8694'>
             ztra,ztrao,ztrad,ztrado,zfd,zfu,ztaug, ztaur, zsflxzen)<a name='8695'>
<font color=#447700>! ---------------------------------------------------------------------------<a name='8696'></font>
<font color=#447700>!<a name='8697'></font>
<font color=#447700>! Purpose: Contains spectral loop to compute the shortwave radiative fluxes, <a name='8698'></font>
<font color=#447700>!          using the two-stream method of H. Barker and McICA, the Monte-Carlo<a name='8699'></font>
<font color=#447700>!          Independent Column Approximation, for the representation of <a name='8700'></font>
<font color=#447700>!          sub-grid cloud variability (i.e. cloud overlap).<a name='8701'></font>
<font color=#447700>!<a name='8702'></font>
<font color=#447700>! Interface:  *spcvmc_sw* is called from *rrtmg_sw.F90* or rrtmg_sw.1col.F90*<a name='8703'></font>
<font color=#447700>!<a name='8704'></font>
<font color=#447700>! Method:<a name='8705'></font>
<font color=#447700>!    Adapted from two-stream model of H. Barker;<a name='8706'></font>
<font color=#447700>!    Two-stream model options (selected with kmodts in rrtmg_sw_reftra.F90):<a name='8707'></font>
<font color=#447700>!        1: Eddington, 2: PIFM, Zdunkowski et al., 3: discret ordinates<a name='8708'></font>
<font color=#447700>!<a name='8709'></font>
<font color=#447700>! Modifications:<a name='8710'></font>
<font color=#447700>!<a name='8711'></font>
<font color=#447700>! Original: H. Barker<a name='8712'></font>
<font color=#447700>! Revision: Merge with RRTMG_SW: J.-J.Morcrette, ECMWF, Feb 2003<a name='8713'></font>
<font color=#447700>! Revision: Add adjustment for Earth/Sun distance : MJIacono, AER, Oct 2003<a name='8714'></font>
<font color=#447700>! Revision: Bug fix for use of PALBP and PALBD: MJIacono, AER, Nov 2003<a name='8715'></font>
<font color=#447700>! Revision: Bug fix to apply delta scaling to clear sky: AER, Dec 2004<a name='8716'></font>
<font color=#447700>! Revision: Code modified so that delta scaling is not done in cloudy profiles<a name='8717'></font>
<font color=#447700>!           if routine cldprop is used; delta scaling can be applied by swithcing<a name='8718'></font>
<font color=#447700>!           code below if cldprop is not used to get cloud properties. <a name='8719'></font>
<font color=#447700>!           AER, Jan 2005<a name='8720'></font>
<font color=#447700>! Revision: Modified to use McICA: MJIacono, AER, Nov 2005<a name='8721'></font>
<font color=#447700>! Revision: Uniform formatting for RRTMG: MJIacono, AER, Jul 2006 <a name='8722'></font>
<font color=#447700>! Revision: Use exponential lookup table for transmittance: MJIacono, AER, <a name='8723'></font>
<font color=#447700>!           Aug 2007 <a name='8724'></font>
<font color=#447700>!<a name='8725'></font>
<font color=#447700>! ------------------------------------------------------------------<a name='8726'></font>
<a name='8727'>
<font color=#447700>! ------- Declarations ------<a name='8728'></font>
<a name='8729'>
<font color=#447700>! ------- Input -------<a name='8730'></font>
<a name='8731'>
      integer , intent(in) :: tncol, ncol,cc<a name='8732'>
      integer , intent(in) :: nlayers<a name='8733'>
      integer , intent(in) :: istart<a name='8734'>
      integer , intent(in) :: iend<a name='8735'>
      integer , intent(in) :: icpr<a name='8736'>
      integer , intent(in) :: idelm   <font color=#447700>! delta-m scaling flag<a name='8737'></font>
                                              <font color=#447700>! [0 = direct and diffuse fluxes are unscaled]<a name='8738'></font>
                                              <font color=#447700>! [1 = direct and diffuse fluxes are scaled]<a name='8739'></font>
      integer , intent(in) :: iout<a name='8740'>
      integer , intent(in) :: laytrop(:)<a name='8741'>
      integer , intent(in) :: layswtch(:)<a name='8742'>
      integer , intent(in) :: laylow(:)<a name='8743'>
<a name='8744'>
      integer , intent(in) :: indfor(:,:) <a name='8745'>
      integer , intent(in) :: indself(:,:) <a name='8746'>
      integer , intent(in) :: jp(:,:) <a name='8747'>
      integer , intent(in) :: jt(:,:) <a name='8748'>
      integer , intent(in) :: jt1(:,:) <a name='8749'>
                                                          <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='8750'></font>
<a name='8751'>
      real , intent(in) :: pavel(:,:)                     <font color=#447700>! layer pressure (hPa, mb) <a name='8752'></font>
                                                          <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='8753'></font>
      real , intent(in) :: tavel(:,:)                     <font color=#447700>! layer temperature (K)<a name='8754'></font>
                                                          <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='8755'></font>
      real , intent(in) :: pz(:,0:)                       <font color=#447700>! level (interface) pressure (hPa, mb)<a name='8756'></font>
                                                          <font color=#447700>!   Dimensions: (ncol,0:nlayers)<a name='8757'></font>
      real , intent(in) :: tz(:,0:)                       <font color=#447700>! level temperatures (hPa, mb)<a name='8758'></font>
                                                          <font color=#447700>!   Dimensions: (ncol,0:nlayers)<a name='8759'></font>
      real , intent(in) :: tbound(:)                      <font color=#447700>! surface temperature (K)<a name='8760'></font>
                                                          <font color=#447700>!   Dimensions: (ncol)<a name='8761'></font>
      real , intent(in) :: coldry(:,:)                    <font color=#447700>! dry air column density (mol/cm2)<a name='8762'></font>
                                                          <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='8763'></font>
      real , intent(in) :: colmol(:,:) <a name='8764'>
                                                          <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='8765'></font>
      real , intent(in) :: adjflux(:)                     <font color=#447700>! Earth/Sun distance adjustment<a name='8766'></font>
                                                          <font color=#447700>!   Dimensions: (jpband)<a name='8767'></font>
<a name='8768'>
      real , intent(in) :: palbd(:,:)                     <font color=#447700>! surface albedo (diffuse)<a name='8769'></font>
                                                          <font color=#447700>!   Dimensions: (ncol,nbndsw)<a name='8770'></font>
      real , intent(in) :: palbp(:,:)                     <font color=#447700>! surface albedo (direct)<a name='8771'></font>
                                                          <font color=#447700>!   Dimensions: (ncol,nbndsw)<a name='8772'></font>
      real , intent(in) :: prmu0(:)                       <font color=#447700>! cosine of solar zenith angle<a name='8773'></font>
                                                          <font color=#447700>!   Dimensions: (ncol)<a name='8774'></font>
<a name='8775'>
      real , intent(in) :: pcldfmc(:,:,:)                 <font color=#447700>! cloud fraction [mcica]<a name='8776'></font>
      real , intent(in) :: ptaucmc(:,:,:)                 <font color=#447700>! cloud optical depth [mcica]<a name='8777'></font>
      real , intent(in) :: pasycmc(:,:,:)                 <font color=#447700>! cloud asymmetry parameter [mcica]<a name='8778'></font>
      real , intent(in) :: pomgcmc(:,:,:)                 <font color=#447700>! cloud single scattering albedo [mcica]<a name='8779'></font>
      real , intent(in) :: ptaormc(:,:,:)                 <font color=#447700>! cloud optical depth, non-delta scaled [mcica]<a name='8780'></font>
                                                          <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='8781'></font>
   <a name='8782'>
      real , intent(in) :: ptaua(:,:,:)                   <font color=#447700>! aerosol optical depth<a name='8783'></font>
      real , intent(in) :: pasya(:,:,:)                   <font color=#447700>! aerosol asymmetry parameter<a name='8784'></font>
      real , intent(in) :: pomga(:,:,:)                   <font color=#447700>! aerosol single scattering albedo<a name='8785'></font>
                                                          <font color=#447700>!   Dimensions: (ncol,nlayers,nbndsw)<a name='8786'></font>
                                                               <a name='8787'>
      real , intent(in) :: colh2o(:,:) <a name='8788'>
      real , intent(in) :: colco2(:,:) <a name='8789'>
      real , intent(in) :: colch4(:,:) <a name='8790'>
      real , intent(in) :: co2mult(:,:) <a name='8791'>
      real , intent(in) :: colo3(:,:) <a name='8792'>
      real , intent(in) :: colo2(:,:) <a name='8793'>
      real , intent(in) :: coln2o(:,:) <a name='8794'>
                                                          <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='8795'></font>
<a name='8796'>
      real , intent(in) :: forfac(:,:) <a name='8797'>
      real , intent(in) :: forfrac(:,:) <a name='8798'>
      real , intent(in) :: selffac(:,:) <a name='8799'>
      real , intent(in) :: selffrac(:,:) <a name='8800'>
      real , intent(in) :: fac00(:,:) <a name='8801'>
      real , intent(in) :: fac01(:,:) <a name='8802'>
      real , intent(in) :: fac10(:,:) <a name='8803'>
      real , intent(in) :: fac11(:,:) <a name='8804'>
                                                          <font color=#447700>!   Dimensions: (ncol,nlayers)<a name='8805'></font>
                                                               <a name='8806'>
      real, intent(inout) gpu_device  :: zgco(tncol,ngptsw,nlayers+1), zomco(tncol,ngptsw,nlayers+1)  <a name='8807'>
      real, intent(inout) gpu_device  :: zrdnd(tncol,ngptsw,nlayers+1) <a name='8808'>
      real, intent(inout) gpu_device  :: zref(tncol,ngptsw,nlayers+1)  , zrefo(tncol,ngptsw,nlayers+1)  <a name='8809'>
      real, intent(inout) gpu_device  :: zrefd(tncol,ngptsw,nlayers+1)  , zrefdo(tncol,ngptsw,nlayers+1)  <a name='8810'>
      real, intent(inout) gpu_device  :: ztauo(tncol,ngptsw,nlayers)  <a name='8811'>
      real, intent(inout) gpu_device  :: zdbt(tncol,ngptsw,nlayers+1)  ,ztdbt(tncol,ngptsw,nlayers+1)   <a name='8812'>
      real, intent(inout) gpu_device  :: ztra(tncol,ngptsw,nlayers+1)  , ztrao(tncol,ngptsw,nlayers+1)  <a name='8813'>
      real, intent(inout) gpu_device  :: ztrad(tncol,ngptsw,nlayers+1)  , ztrado(tncol,ngptsw,nlayers+1)  <a name='8814'>
      real, intent(inout) gpu_device  :: zfd(tncol,ngptsw,nlayers+1)  , zfu(tncol,ngptsw,nlayers+1)   <a name='8815'>
real gpu_device  :: zcd(tncol,ngptsw,nlayers+1)  , zcu(tncol,ngptsw,nlayers+1)   <a name='8816'>
      real, intent(inout) gpu_device :: ztaur(tncol,nlayers,ngptsw), ztaug(tncol,nlayers,ngptsw) <a name='8817'>
      real, intent(inout) gpu_device :: zsflxzen(tncol,ngptsw)<a name='8818'>
   <a name='8819'>
<a name='8820'>
<font color=#447700>! ------- Output -------<a name='8821'></font>
                                                               <font color=#447700>!   All Dimensions: (ncol,nlayers+1)<a name='8822'></font>
      real , intent(out) :: pbbcd(:,:) <a name='8823'>
      real , intent(out) :: pbbcu(:,:) <a name='8824'>
      real , intent(out) :: pbbfd(:,:) <a name='8825'>
      real , intent(out) :: pbbfu(:,:) <a name='8826'>
      real , intent(out) :: pbbfddir(:,:) <a name='8827'>
      real , intent(out) :: pbbcddir(:,:) <a name='8828'>
<a name='8829'>
      real , intent(out) :: puvcd(:,:) <a name='8830'>
      real , intent(out) :: puvfd(:,:) <a name='8831'>
      real , intent(out) :: puvcddir(:,:) <a name='8832'>
      real , intent(out) :: puvfddir(:,:) <a name='8833'>
<a name='8834'>
      real , intent(out) :: pnicd(:,:) <a name='8835'>
      real , intent(out) :: pnifd(:,:) <a name='8836'>
      real , intent(out) :: pnicddir(:,:) <a name='8837'>
      real , intent(out) :: pnifddir(:,:) <a name='8838'>
      <a name='8839'>
<font color=#447700>! ------- Local -------<a name='8840'></font>
  <a name='8841'>
      integer   :: klev<a name='8842'>
      integer  :: ibm, ikl, ikp, ikx<a name='8843'>
      integer  :: iw, jb, jg, jl, jk<a name='8844'>
<a name='8845'>
      integer  :: itind<a name='8846'>
<a name='8847'>
      real  :: tblind, ze1<a name='8848'>
      real  :: zclear, zcloud<a name='8849'>
        <a name='8850'>
      real  :: zincflx, ze2<a name='8851'>
<a name='8852'>
      real  :: zdbtmc, zdbtmo, zf, zgw, zreflect<a name='8853'>
      real  :: zwf, tauorig, repclc<a name='8854'>
<a name='8855'>
      real :: zdbt_nodel(tncol,ngptsw,nlayers+1)<a name='8856'>
      real :: zdbtc_nodel(tncol,ngptsw,nlayers+1)<a name='8857'>
      real :: ztdbt_nodel(tncol,ngptsw,nlayers+1)<a name='8858'>
      real :: ztdbtc_nodel(tncol,ngptsw,nlayers+1)<a name='8859'>
<a name='8860'>
<a name='8861'>
<font color=#447700>! Arrays from rrtmg_sw_vrtqdr routine<a name='8862'></font>
  <a name='8863'>
      integer :: iplon<a name='8864'>
<a name='8865'>
<font color=#447700>! ------------------------------------------------------------------<a name='8866'></font>
<a name='8867'>
<font color=#447700>!$acc update host(pomga, ptaua)<a name='8868'></font>
  <a name='8869'>
<font color=#447700>!print *, "aerosol values"<a name='8870'></font>
<font color=#447700>!print *, pomga(1, :, :)<a name='8871'></font>
<font color=#447700>!print *, ptaua(1, :, :)<a name='8872'></font>
<a name='8873'>
<font color=#447700>!$acc kernels     <a name='8874'></font>
         pbbcd =0. <a name='8875'>
         pbbcu =0. <a name='8876'>
         pbbfd =0. <a name='8877'>
         pbbfu =0. <a name='8878'>
         pbbcddir =0. <a name='8879'>
         pbbfddir =0. <a name='8880'>
         puvcd =0. <a name='8881'>
         puvfd =0. <a name='8882'>
         puvcddir =0. <a name='8883'>
         puvfddir =0. <a name='8884'>
         pnicd =0. <a name='8885'>
         pnifd =0. <a name='8886'>
         pnicddir =0. <a name='8887'>
         pnifddir =0.<a name='8888'>
         zsflxzen = 0.<a name='8889'>
<font color=#447700>!         znirr=0.<a name='8890'></font>
<font color=#447700>!         znirf=0.<a name='8891'></font>
<font color=#447700>!         zparr=0.<a name='8892'></font>
<font color=#447700>!         zparf=0.<a name='8893'></font>
<font color=#447700>!         zuvrr=0.<a name='8894'></font>
<font color=#447700>!         zuvrf=0.<a name='8895'></font>
         klev = nlayers<a name='8896'>
<font color=#447700>!$acc end kernels      <a name='8897'></font>
<a name='8898'>
#ifndef _ACCEL<a name='8899'>
#  define ncol CHNK<a name='8900'>
#endif<a name='8901'>
<a name='8902'>
         <a name='8903'>
<font color=#447700>! Calculate the optical depths for gaseous absorption and Rayleigh scattering     <a name='8904'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#TAUMOL_SW'>taumol_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TAUMOL_SW_2">(ncol,nlayers, &amp;<a name='8905'>
                     colh2o , colco2 , colch4 , colo2 , &amp;<a name='8906'>
                     colo3 , colmol , &amp;<a name='8907'>
                     laytrop , jp , jt , jt1 , &amp;<a name='8908'>
                     fac00 , fac01 , fac10 , fac11 , &amp;<a name='8909'>
                     selffac , selffrac , indself , forfac , forfrac ,&amp;<a name='8910'>
                     indfor , &amp;<a name='8911'>
                     zsflxzen , ztaug, ztaur)<a name='8912'>
<a name='8913'>
      <a name='8914'>
      repclc = 1.e-12 <a name='8915'>
<a name='8916'>
#ifdef _ACCEL<a name='8917'>
# define ILOOP_S_CPU<a name='8918'>
# define ILOOP_E_CPU<a name='8919'>
# define ILOOP_S_GPU do iplon = 1, ncol<a name='8920'>
# define ILOOP_E_GPU enddo<a name='8921'>
# define WLOOP_S_CPU<a name='8922'>
# define WLOOP_E_CPU<a name='8923'>
# define WLOOP_S_GPU do iw = 1, 112<a name='8924'>
# define WLOOP_E_GPU enddo<a name='8925'>
#else<a name='8926'>
# define ILOOP_S_GPU<a name='8927'>
# define ILOOP_E_GPU<a name='8928'>
# define ILOOP_S_CPU do iplon = 1, ncol<a name='8929'>
# define ILOOP_E_CPU enddo<a name='8930'>
# define WLOOP_S_GPU<a name='8931'>
# define WLOOP_E_GPU<a name='8932'>
# define WLOOP_S_CPU do iw = 1, 112<a name='8933'>
# define WLOOP_E_CPU enddo<a name='8934'>
#endif<a name='8935'>
<a name='8936'>
   <a name='8937'>
<font color=#447700>!$acc kernels <a name='8938'></font>
<a name='8939'>
      ILOOP_S_GPU<a name='8940'>
      WLOOP_S_CPU<a name='8941'>
<a name='8942'>
        WLOOP_S_GPU<a name='8943'>
        ILOOP_S_CPU<a name='8944'>
<a name='8945'>
<font color=#447700>! Top of shortwave spectral band loop, jb = 16 -&gt; 29; ibm = 1 -&gt; 14<a name='8946'></font>
<a name='8947'>
          jb = ngb(iw)<a name='8948'>
          ibm = jb-15<a name='8949'>
          <a name='8950'>
<font color=#447700>! Clear-sky    <a name='8951'></font>
<font color=#447700>!   TOA direct beam    <a name='8952'></font>
           <a name='8953'>
          ztdbtc_nodel(iplon,iw,1)=1.0  <font color=#447700>!jm<a name='8954'></font>
           <a name='8955'>
<font color=#447700>! Cloudy-sky    <a name='8956'></font>
<font color=#447700>!   Surface values<a name='8957'></font>
          ztrao(iplon,iw,klev+1)   =0.0 <a name='8958'>
          ztrado(iplon,iw,klev+1)  =0.0 <a name='8959'>
          zrefo(iplon,iw,klev+1)   =palbp(iplon,ibm) <a name='8960'>
          zrefdo(iplon,iw,klev+1)  =palbd(iplon,ibm) <a name='8961'>
           <a name='8962'>
<font color=#447700>! Total sky    <a name='8963'></font>
<font color=#447700>!   TOA direct beam    <a name='8964'></font>
          ztdbt(iplon,iw,1)  =1.0 <a name='8965'>
          ztdbt_nodel(iplon,iw,1)=1.0<a name='8966'>
<a name='8967'>
    <a name='8968'>
<font color=#447700>!   Surface values<a name='8969'></font>
          zdbt(iplon,iw,klev+1)   =0.0 <a name='8970'>
          ztra(iplon,iw,klev+1)   =0.0 <a name='8971'>
          ztrad(iplon,iw,klev+1)  =0.0 <a name='8972'>
          zref(iplon,iw,klev+1)   =palbp(iplon,ibm) <a name='8973'>
          zrefd(iplon,iw,klev+1)  =palbd(iplon,ibm) <a name='8974'>
    <a name='8975'>
        enddo<a name='8976'>
      enddo<a name='8977'>
<a name='8978'>
<font color=#447700>!$acc end kernels     <a name='8979'></font>
<a name='8980'>
<a name='8981'>
<font color=#447700>!$acc kernels loop <a name='8982'></font>
<a name='8983'>
       ILOOP_S_GPU<a name='8984'>
<font color=#447700>!$acc loop private(zf, zwf, ibm, ikl, jb)<a name='8985'></font>
         WLOOP_S_GPU<a name='8986'>
            <font color=#447700>!$acc loop seq<a name='8987'></font>
            do jk=1,klev<a name='8988'>
<a name='8989'>
               ikl=klev+1-jk<a name='8990'>
       WLOOP_S_CPU<a name='8991'>
               jb = ngb(iw)<a name='8992'>
               ibm = jb-15<a name='8993'>
         ILOOP_S_CPU<a name='8994'>
               <font color=#447700>! Clear-sky optical parameters including aerosols<a name='8995'></font>
               ztauo(iplon,iw,jk)   = ztaur(iplon,ikl,iw)  + ztaug(iplon,ikl,iw) + ptaua(iplon,ikl,ibm)      <a name='8996'>
<a name='8997'>
#ifndef _ACCEL<a name='8998'>
<font color=#447700>! Use exponential lookup table for transmittance, or expansion of<a name='8999'></font>
<font color=#447700>! exponential for low tau<a name='9000'></font>
               zclear = 1.0  - pcldfmc(iplon,ikl,iw)<a name='9001'>
               zcloud =  pcldfmc(iplon,ikl,iw)<a name='9002'>
<a name='9003'>
               ze1 = ztauo(iplon,iw,jk) / prmu0(iplon)  <font color=#447700>! ztauo corresponds to ztauc at this point in _sw.F version<a name='9004'></font>
               if (ze1 .le. od_lo) then<a name='9005'>
                  zdbtmc = 1. - ze1 + 0.5 * ze1 * ze1<a name='9006'>
               else<a name='9007'>
                  tblind = ze1 / (bpade + ze1)<a name='9008'>
                  itind = tblint * tblind + 0.5<a name='9009'>
                  zdbtmc = exp_tbl(itind)<a name='9010'>
               endif<a name='9011'>
<a name='9012'>
               zdbtc_nodel(iplon,iw,jk) = zdbtmc<a name='9013'>
               ztdbtc_nodel(iplon,iw,jk+1) = zdbtc_nodel(iplon,iw,jk) * ztdbtc_nodel(iplon,iw,jk)<a name='9014'>
<a name='9015'>
               tauorig = ztauo(iplon,iw,jk) + ptaormc(iplon,ikl,iw)    <font color=#447700>! ztauo corresponds to ztauc at this point in _sw.F version<a name='9016'></font>
               ze1 = tauorig / prmu0(iplon)<a name='9017'>
               if (ze1 .le. od_lo) then<a name='9018'>
                  zdbtmo = 1. - ze1 + 0.5 * ze1 * ze1<a name='9019'>
               else<a name='9020'>
                  tblind = ze1 / (bpade + ze1)<a name='9021'>
                  itind = tblint * tblind + 0.5<a name='9022'>
                  zdbtmo = exp_tbl(itind)<a name='9023'>
               endif<a name='9024'>
<a name='9025'>
               zdbt_nodel(iplon,iw,jk) = zclear*zdbtmc + zcloud*zdbtmo<a name='9026'>
               ztdbt_nodel(iplon,iw,jk+1) = zdbt_nodel(iplon,iw,jk) * ztdbt_nodel(iplon,iw,jk)<a name='9027'>
<a name='9028'>
#endif<a name='9029'>
<a name='9030'>
               zomco(iplon,iw,jk)   = ztaur(iplon,ikl,iw) + ptaua(iplon,ikl,ibm) * pomga(iplon,ikl,ibm)<a name='9031'>
               zgco(iplon,iw,jk) = pasya(iplon,ikl,ibm) * pomga(iplon,ikl,ibm) * ptaua(iplon,ikl,ibm) / zomco(iplon,iw,jk)   <a name='9032'>
               zomco(iplon,iw,jk)   = zomco(iplon,iw,jk) / ztauo(iplon,iw,jk)<a name='9033'>
               <a name='9034'>
               zf = zgco(iplon, iw, jk)<a name='9035'>
               zf = zf * zf<a name='9036'>
               zwf = zomco(iplon, iw, jk) * zf<a name='9037'>
<a name='9038'>
               ztauo(iplon, iw, jk) = (1.0 - zwf) * ztauo(iplon, iw, jk)<a name='9039'>
               zomco(iplon, iw, jk) = (zomco(iplon, iw, jk) - zwf) / (1.0 - zwf)<a name='9040'>
               zgco(iplon, iw, jk) = (zgco(iplon, iw, jk) - zf) / (1.0 - zf)<a name='9041'>
               <a name='9042'>
           end do    <a name='9043'>
        end do<a name='9044'>
      end do<a name='9045'>
<font color=#447700>!$acc end kernels               <a name='9046'></font>
<a name='9047'>
<a name='9048'>
<font color=#447700>! Clear sky reflectivities<a name='9049'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#REFTRA_SW'>reftra_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="REFTRA_SW_3"> (ncol, nlayers, &amp;<a name='9050'>
                      pcldfmc, zgco, prmu0, ztauo, zomco, &amp;<a name='9051'>
                      zrefo, zrefdo, ztrao, ztrado, 1)<a name='9052'>
                        <a name='9053'>
<a name='9054'>
<font color=#447700>!$acc kernels loop    <a name='9055'></font>
       ILOOP_S_GPU<a name='9056'>
<a name='9057'>
<font color=#447700>! Combine clear and cloudy reflectivies and optical depths     <a name='9058'></font>
<a name='9059'>
<font color=#447700>!$acc loop<a name='9060'></font>
       WLOOP_S_GPU<a name='9061'>
            <a name='9062'>
<font color=#447700>!$acc loop seq<a name='9063'></font>
            do jk=1,klev<a name='9064'>
<a name='9065'>
       WLOOP_S_CPU<a name='9066'>
       ILOOP_S_CPU<a name='9067'>
<font color=#447700>! Combine clear and cloudy contributions for total sky<a name='9068'></font>
               <font color=#447700>!ikl = klev+1-jk <a name='9069'></font>
<a name='9070'>
<font color=#447700>! Direct beam transmittance        <a name='9071'></font>
<a name='9072'>
               ze1 = (ztauo(iplon,iw,jk))  / prmu0(iplon)      <a name='9073'>
#ifdef _ACCEL<a name='9074'>
               zdbtmc = exp(-ze1)<a name='9075'>
#else<a name='9076'>
               ze1 = ztauo(iplon,iw,jk) / prmu0(iplon)<a name='9077'>
               if (ze1 .le. od_lo) then<a name='9078'>
                  zdbtmc = 1. - ze1 + 0.5 * ze1 * ze1<a name='9079'>
               else<a name='9080'>
                  tblind = ze1 / (bpade + ze1)<a name='9081'>
                  itind = tblint * tblind + 0.5<a name='9082'>
                  zdbtmc = exp_tbl(itind)<a name='9083'>
               endif<a name='9084'>
#endif<a name='9085'>
               zdbt(iplon,iw,jk)   = zdbtmc<a name='9086'>
               ztdbt(iplon,iw,jk+1)   = zdbt(iplon,iw,jk)  *ztdbt(iplon,iw,jk)  <a name='9087'>
<a name='9088'>
           end do          <a name='9089'>
        end do<a name='9090'>
      end do<a name='9091'>
<font color=#447700>!$acc end kernels<a name='9092'></font>
<a name='9093'>
<font color=#447700>! compute the fluxes from the optical depths and reflectivities<a name='9094'></font>
<a name='9095'>
                 <a name='9096'>
<font color=#447700>! Vertical quadrature for clear-sky fluxes<a name='9097'></font>
<a name='9098'>
<font color=#447700>!$acc kernels <a name='9099'></font>
       ILOOP_S_GPU<a name='9100'>
        WLOOP_S_GPU<a name='9101'>
       WLOOP_S_CPU<a name='9102'>
          jb = ngb(iw)<a name='9103'>
          ibm = jb-15<a name='9104'>
        ILOOP_S_CPU<a name='9105'>
<a name='9106'>
<font color=#447700>! Top of shortwave spectral band loop, jb = 16 -&gt; 29; ibm = 1 -&gt; 14<a name='9107'></font>
<a name='9108'>
<a name='9109'>
          zgco(iplon,iw,klev+1)   =palbp(iplon,ibm) <a name='9110'>
          zomco(iplon,iw,klev+1)  =palbd(iplon,ibm) <a name='9111'>
    <a name='9112'>
        end do<a name='9113'>
      end do<a name='9114'>
<font color=#447700>!$acc end kernels  <a name='9115'></font>
<a name='9116'>
<a name='9117'>
            call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#VRTQDR_SW'>vrtqdr_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="VRTQDR_SW_3">(ncol, klev, &amp;<a name='9118'>
                           zrefo  , zrefdo  , ztrao  , ztrado  , &amp;<a name='9119'>
                           zdbt , zrdnd  , zgco, zomco, ztdbt  , &amp;<a name='9120'>
                           zcd , zcu  , ztra)<a name='9121'>
            <a name='9122'>
<font color=#447700>! perform band integration for clear cases      <a name='9123'></font>
<font color=#447700>!$acc kernels loop<a name='9124'></font>
       ILOOP_S_GPU<a name='9125'>
    <a name='9126'>
<font color=#447700>!$acc loop    <a name='9127'></font>
        do ikl=1,klev+1<a name='9128'>
            <a name='9129'>
      <font color=#447700>!$acc loop seq<a name='9130'></font>
          do iw = 1, 112<a name='9131'>
             jb = ngb(iw)<a name='9132'>
      <a name='9133'>
             jk=klev+2-ikl<a name='9134'>
             ibm = jb-15<a name='9135'>
<font color=#447700>!DIR$ SIMD<a name='9136'></font>
          ILOOP_S_CPU<a name='9137'>
             zincflx = adjflux(jb)  * zsflxzen(iplon,iw)   * prmu0(iplon)           <a name='9138'>
<a name='9139'>
<font color=#447700>! Accumulate spectral fluxes over whole spectrum  <a name='9140'></font>
              <a name='9141'>
             pbbcu(iplon,ikl)  = pbbcu(iplon,ikl)  + zincflx*zcu(iplon,iw,jk)  <a name='9142'>
             pbbcd(iplon,ikl)  = pbbcd(iplon,ikl)  + zincflx*zcd(iplon,iw,jk)  <a name='9143'>
             pbbcddir(iplon,ikl)  = pbbcddir(iplon,ikl)  + zincflx*ztdbtc_nodel(iplon,iw,jk)  <a name='9144'>
              <a name='9145'>
<a name='9146'>
<font color=#447700>! Accumulate direct fluxes for UV/visible bands<a name='9147'></font>
             if (ibm &gt;= 10 .and. ibm &lt;= 13) then<a name='9148'>
                puvcd(iplon,ikl)  = puvcd(iplon,ikl)  + zincflx*zcd(iplon,iw,jk)  <a name='9149'>
                puvcddir(iplon,ikl)  = puvcddir(iplon,ikl)  + zincflx*ztdbtc_nodel(iplon,iw,jk)  <a name='9150'>
                 <a name='9151'>
<font color=#447700>! Accumulate direct fluxes for near-IR bands<a name='9152'></font>
             else if (ibm == 14 .or. ibm &lt;= 9) then  <a name='9153'>
                pnicd(iplon,ikl)  = pnicd(iplon,ikl)  + zincflx*zcd(iplon,iw,jk)  <a name='9154'>
                pnicddir(iplon,ikl)  = pnicddir(iplon,ikl)  + zincflx*ztdbtc_nodel(iplon,iw,jk)  <a name='9155'>
                 <a name='9156'>
             endif<a name='9157'>
<a name='9158'>
          enddo          <a name='9159'>
<a name='9160'>
<font color=#447700>! End loop on jb, spectral band<a name='9161'></font>
        enddo<a name='9162'>
<a name='9163'>
<font color=#447700>! End of longitude loop    <a name='9164'></font>
      enddo               <a name='9165'>
<font color=#447700>!$acc end kernels<a name='9166'></font>
<a name='9167'>
<a name='9168'>
<a name='9169'>
      if (cc==2) then<a name='9170'>
<a name='9171'>
<font color=#447700>!$acc kernels <a name='9172'></font>
        ILOOP_S_GPU<a name='9173'>
          WLOOP_S_GPU<a name='9174'>
            do jk=1,klev<a name='9175'>
<a name='9176'>
               ikl=klev+1-jk<a name='9177'>
          WLOOP_S_CPU<a name='9178'>
               jb = ngb(iw)<a name='9179'>
               ibm = jb-15<a name='9180'>
<font color=#447700>!DIR$ SIMD<a name='9181'></font>
           ILOOP_S_CPU<a name='9182'>
               <font color=#447700>! since the cloudy cases are now computed in a separate partition from the clear cases, we must<a name='9183'></font>
               <font color=#447700>! recompute the needed clear sky prerequisites.<a name='9184'></font>
               ze1 = ztaur(iplon,ikl,iw) + ptaua(iplon,ikl,ibm) * pomga(iplon, ikl, ibm) <a name='9185'>
               ze2 = pasya(iplon, ikl, ibm) * pomga(iplon, ikl, ibm) * ptaua(iplon, ikl, ibm) / ze1<a name='9186'>
               ze1 = ze1/ (ztaur(iplon,ikl,iw)  + ztaug(iplon,ikl,iw) + ptaua(iplon,ikl,ibm)  )<a name='9187'>
               <a name='9188'>
               <font color=#447700>! compute delta scaled coefficients<a name='9189'></font>
               zf = ze2*ze2<a name='9190'>
               zwf = ze1*zf<a name='9191'>
               ze1 = (ze1 - zwf) / (1.0 - zwf)<a name='9192'>
               ze2 = (ze2 - zf) / (1.0 - zf)<a name='9193'>
<a name='9194'>
               <font color=#447700>! direct calculation of delta scaled values<a name='9195'></font>
               zomco(iplon,iw,jk)   = (ztauo(iplon,iw,jk) * ze1  + ptaucmc(iplon,ikl,iw)  * pomgcmc(iplon,ikl,iw))<a name='9196'>
               <a name='9197'>
               zgco(iplon, iw, jk) =  (ptaucmc(iplon,ikl,iw)  * pomgcmc(iplon,ikl,iw)  * pasycmc(iplon,ikl,iw) ) + &amp;<a name='9198'>
                                      (ztauo(iplon, iw, jk) * ze1 * ze2)<a name='9199'>
               <a name='9200'>
               ztauo(iplon,iw,jk)   = ztauo(iplon,iw,jk) + ptaucmc(iplon,ikl,iw) <a name='9201'>
<a name='9202'>
               zgco(iplon,iw,jk)   = zgco(iplon, iw, jk) / zomco(iplon, iw, jk)<a name='9203'>
               zomco(iplon,iw,jk)  = zomco(iplon,iw,jk) / ztauo(iplon,iw,jk)<a name='9204'>
             <a name='9205'>
            end do    <a name='9206'>
          end do<a name='9207'>
        end do<a name='9208'>
<font color=#447700>!$acc end kernels<a name='9209'></font>
<a name='9210'>
<a name='9211'>
<font color=#447700>! Total sky reflectivities      <a name='9212'></font>
        call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#REFTRA_SW'>reftra_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="REFTRA_SW_4"> (ncol, nlayers, &amp;<a name='9213'>
                        pcldfmc, zgco, prmu0, ztauo, zomco, &amp;<a name='9214'>
                        zref, zrefd, ztra, ztrad, 0)<a name='9215'>
            <a name='9216'>
<a name='9217'>
        klev = nlayers<a name='9218'>
<a name='9219'>
<a name='9220'>
<font color=#447700>!$acc kernels loop    <a name='9221'></font>
        ILOOP_S_GPU<a name='9222'>
<a name='9223'>
<font color=#447700>!$acc loop<a name='9224'></font>
          WLOOP_S_GPU<a name='9225'>
            <a name='9226'>
<font color=#447700>!$acc loop seq<a name='9227'></font>
            do jk=1,klev<a name='9228'>
<a name='9229'>
<font color=#447700>! Combine clear and cloudy contributions for total sky<a name='9230'></font>
               ikl = klev+1-jk <a name='9231'>
          WLOOP_S_CPU<a name='9232'>
            ILOOP_S_CPU<a name='9233'>
               zclear = 1.0  - pcldfmc(iplon,ikl,iw) <a name='9234'>
               zcloud = pcldfmc(iplon,ikl,iw) <a name='9235'>
<a name='9236'>
               zref(iplon,iw,jk)   = zclear*zrefo(iplon,iw,jk)   + zcloud*zref(iplon,iw,jk)  <a name='9237'>
               zrefd(iplon,iw,jk)  = zclear*zrefdo(iplon,iw,jk)   + zcloud*zrefd(iplon,iw,jk)  <a name='9238'>
               ztra(iplon,iw,jk)   = zclear*ztrao(iplon,iw,jk)   + zcloud*ztra(iplon,iw,jk)  <a name='9239'>
               ztrad(iplon,iw,jk)  = zclear*ztrado(iplon,iw,jk)   + zcloud*ztrad(iplon,iw,jk)  <a name='9240'>
<a name='9241'>
<font color=#447700>! Clear + Cloud<a name='9242'></font>
<a name='9243'>
               ze1 = ztauo(iplon,iw,jk )   / prmu0(iplon)   <a name='9244'>
#ifdef _ACCEL<a name='9245'>
               zdbtmo = exp(-ze1)            <a name='9246'>
#else<a name='9247'>
              if (ze1 .le. od_lo) then<a name='9248'>
                  zdbtmo = 1. - ze1 + 0.5 * ze1 * ze1<a name='9249'>
               else<a name='9250'>
                  tblind = ze1 / (bpade + ze1)<a name='9251'>
                  itind = tblint * tblind + 0.5<a name='9252'>
                  zdbtmo = exp_tbl(itind)<a name='9253'>
               endif<a name='9254'>
#endif<a name='9255'>
               ze1 = (ztauo(iplon,iw,jk) - ptaucmc(iplon,ikl,iw))  / prmu0(iplon)           <a name='9256'>
#ifdef _ACCEL<a name='9257'>
               zdbtmc = exp(-ze1)<a name='9258'>
#else<a name='9259'>
               if (ze1 .le. od_lo) then<a name='9260'>
                  zdbtmc = 1. - ze1 + 0.5 * ze1 * ze1<a name='9261'>
               else<a name='9262'>
                  tblind = ze1 / (bpade + ze1)<a name='9263'>
                  itind = tblint * tblind + 0.5<a name='9264'>
                  zdbtmc = exp_tbl(itind)<a name='9265'>
               endif<a name='9266'>
#endif<a name='9267'>
            <a name='9268'>
               zdbt(iplon,iw,jk)   = zclear*zdbtmc + zcloud*zdbtmo<a name='9269'>
               ztdbt(iplon,iw,jk+1)   = zdbt(iplon,iw,jk)  *ztdbt(iplon,iw,jk)  <a name='9270'>
<a name='9271'>
            enddo          <a name='9272'>
          end do<a name='9273'>
        end do<a name='9274'>
<font color=#447700>!$acc end kernels<a name='9275'></font>
<a name='9276'>
<font color=#447700>!$acc kernels<a name='9277'></font>
        zrdnd = 0.0<a name='9278'>
        zgco = 0.0<a name='9279'>
        zomco = 0.0<a name='9280'>
        zfd = 0.0<a name='9281'>
        zfu = 0.0<a name='9282'>
<font color=#447700>!$acc end kernels<a name='9283'></font>
<a name='9284'>
<a name='9285'>
<font color=#447700>!$acc kernels <a name='9286'></font>
        ILOOP_S_GPU<a name='9287'>
          WLOOP_S_GPU<a name='9288'>
<a name='9289'>
<font color=#447700>! Top of shortwave spectral band loop, jb = 16 -&gt; 29; ibm = 1 -&gt; 14<a name='9290'></font>
<a name='9291'>
        WLOOP_S_CPU<a name='9292'>
            jb = ngb(iw)<a name='9293'>
            ibm = jb-15<a name='9294'>
          ILOOP_S_CPU<a name='9295'>
<a name='9296'>
            zgco(iplon,iw,klev+1)   =palbp(iplon,ibm) <a name='9297'>
            zomco(iplon,iw,klev+1)  =palbd(iplon,ibm) <a name='9298'>
    <a name='9299'>
          end do<a name='9300'>
        end do<a name='9301'>
<font color=#447700>!$acc end kernels  <a name='9302'></font>
<a name='9303'>
<a name='9304'>
<font color=#447700>! Vertical quadrature for cloudy fluxes<a name='9305'></font>
<a name='9306'>
<a name='9307'>
        call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#VRTQDR_SW'>vrtqdr_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="VRTQDR_SW_4">(ncol, klev, &amp;<a name='9308'>
                       zref  , zrefd  , ztra  , ztrad , &amp;<a name='9309'>
                       zdbt , zrdnd  , zgco, zomco , ztdbt  , &amp;<a name='9310'>
                       zfd , zfu  ,  ztrao)<a name='9311'>
<a name='9312'>
<font color=#447700>! Upwelling and downwelling fluxes at levels<a name='9313'></font>
<font color=#447700>!   Two-stream calculations go from top to bottom; <a name='9314'></font>
<font color=#447700>!   layer indexing is reversed to go bottom to top for output arrays<a name='9315'></font>
<a name='9316'>
        klev = nlayers<a name='9317'>
        repclc = 1.e-12 <a name='9318'>
<a name='9319'>
<font color=#447700>!$acc kernels loop<a name='9320'></font>
        ILOOP_S_GPU<a name='9321'>
    <a name='9322'>
<font color=#447700>!$acc loop    <a name='9323'></font>
          do ikl=1,klev+1<a name='9324'>
<font color=#447700>!$acc loop seq<a name='9325'></font>
          WLOOP_S_GPU<a name='9326'>
          WLOOP_S_CPU<a name='9327'>
               jb = ngb(iw)<a name='9328'>
               jk=klev+2-ikl<a name='9329'>
               ibm = jb-15<a name='9330'>
            ILOOP_S_CPU<a name='9331'>
               zincflx = adjflux(jb)  * zsflxzen(iplon,iw)   * prmu0(iplon)           <a name='9332'>
<a name='9333'>
<font color=#447700>! Accumulate spectral fluxes over whole spectrum  <a name='9334'></font>
               pbbfu(iplon,ikl)  = pbbfu(iplon,ikl)  + zincflx*zfu(iplon,iw,jk)  <a name='9335'>
               pbbfd(iplon,ikl)  = pbbfd(iplon,ikl)  + zincflx*zfd(iplon,iw,jk)              <a name='9336'>
               pbbfddir(iplon,ikl)  = pbbfddir(iplon,ikl)  + zincflx*ztdbt_nodel(iplon,iw,jk)  <a name='9337'>
<a name='9338'>
<font color=#447700>! Accumulate direct fluxes for UV/visible bands<a name='9339'></font>
               if (ibm &gt;= 10 .and. ibm &lt;= 13) then<a name='9340'>
                 <a name='9341'>
                  puvfd(iplon,ikl)  = puvfd(iplon,ikl)  + zincflx*zfd(iplon,iw,jk)  <a name='9342'>
                  puvfddir(iplon,ikl)  = puvfddir(iplon,ikl)  + zincflx*ztdbt_nodel(iplon,iw,jk)  <a name='9343'>
                 <a name='9344'>
                 <a name='9345'>
<font color=#447700>! Accumulate direct fluxes for near-IR bands<a name='9346'></font>
               else if (ibm == 14 .or. ibm &lt;= 9) then  <a name='9347'>
                <a name='9348'>
                  pnifd(iplon,ikl)  = pnifd(iplon,ikl)  + zincflx*zfd(iplon,iw,jk)  <a name='9349'>
                  pnifddir(iplon,ikl)  = pnifddir(iplon,ikl)  + zincflx*ztdbt_nodel(iplon,iw,jk)  <a name='9350'>
                   <a name='9351'>
                 <a name='9352'>
               endif<a name='9353'>
<a name='9354'>
            enddo          <a name='9355'>
<a name='9356'>
<font color=#447700>! End loop on jb, spectral band<a name='9357'></font>
          enddo<a name='9358'>
<a name='9359'>
<font color=#447700>! End of longitude loop    <a name='9360'></font>
        enddo               <a name='9361'>
<font color=#447700>!$acc end kernels<a name='9362'></font>
<a name='9363'>
<a name='9364'>
      else      <font color=#447700>! cc = 1<a name='9365'></font>
<font color=#447700>!$acc kernels<a name='9366'></font>
         pbbfd = pbbcd<a name='9367'>
         pbbfu = pbbcu<a name='9368'>
         puvfd = puvcd<a name='9369'>
         puvfddir = puvcddir<a name='9370'>
         pnifd = pnicd<a name='9371'>
         pnifddir = pnicddir<a name='9372'>
<font color=#447700>!$acc end kernels    <a name='9373'></font>
      end if    <font color=#447700>! if cc=2, else, endif<a name='9374'></font>
<a name='9375'>
<a name='9376'>
<font color=#447700>!$acc kernels<a name='9377'></font>
      ILOOP_S_GPU<a name='9378'>
         WLOOP_S_GPU<a name='9379'>
      WLOOP_S_CPU<a name='9380'>
            jb = ngb(iw)<a name='9381'>
            ibm = jb - 15<a name='9382'>
         ILOOP_S_CPU<a name='9383'>
            zincflx = adjflux(jb)  * zsflxzen(iplon,iw)   * prmu0(iplon)    <a name='9384'>
            <a name='9385'>
         end do<a name='9386'>
      end do<a name='9387'>
<font color=#447700>!$acc end kernels<a name='9388'></font>
<a name='9389'>
<font color=#447700>!!$acc end data<a name='9390'></font>
# undef ILOOP_S_GPU<a name='9391'>
# undef ILOOP_E_GPU<a name='9392'>
# undef ILOOP_S_CPU<a name='9393'>
# undef ILOOP_E_CPU<a name='9394'>
# undef WLOOP_S_GPU<a name='9395'>
# undef WLOOP_E_GPU<a name='9396'>
# undef WLOOP_S_CPU<a name='9397'>
# undef WLOOP_E_CPU<a name='9398'>
#ifndef _ACCEL<a name='9399'>
#  undef ncol<a name='9400'>
#endif<a name='9401'>
         <a name='9402'>
<font color=#447700>! !!!!!!!!!!!!!!!!!!!!!<a name='9403'></font>
<font color=#447700>!  END CLEAR  !!!!!!!!!<a name='9404'></font>
<font color=#447700>! !!!!!!!!!!!!!!!!!!!!!<a name='9405'></font>
<a name='9406'>
      end subroutine spcvmc_sw<a name='9407'>
             <a name='9408'>
<font color=#447700>! --------------------------------------------------------------------<a name='9409'></font>
<A NAME='REFTRA_SW'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#REFTRA_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='9410'>
      <font color=#993300>subroutine </font><font color=#cc0000>reftra_sw</font>(ncol, nlayers, pcldfmc, pgg, prmuzl, ptau, pw, &amp; <A href='../../call_to/REFTRA_SW.html' TARGET='index'>4</A><a name='9411'>
                           pref, prefd, ptra, ptrad, ac)<a name='9412'>
<font color=#447700>! --------------------------------------------------------------------<a name='9413'></font>
  <a name='9414'>
<font color=#447700>! Purpose: computes the reflectivity and transmissivity of a clear or <a name='9415'></font>
<font color=#447700>!   cloudy layer using a choice of various approximations.<a name='9416'></font>
<font color=#447700>!<a name='9417'></font>
<font color=#447700>! Interface:  *rrtmg_sw_reftra* is called by *rrtmg_sw_spcvrt*<a name='9418'></font>
<font color=#447700>!<a name='9419'></font>
<font color=#447700>! Description:<a name='9420'></font>
<font color=#447700>! explicit arguments :<a name='9421'></font>
<font color=#447700>! --------------------<a name='9422'></font>
<font color=#447700>! inputs<a name='9423'></font>
<font color=#447700>! ------ <a name='9424'></font>
<font color=#447700>!      lrtchk  = .t. for all layers in clear profile<a name='9425'></font>
<font color=#447700>!      lrtchk  = .t. for cloudy layers in cloud profile <a name='9426'></font>
<font color=#447700>!              = .f. for clear layers in cloud profile<a name='9427'></font>
<font color=#447700>!      pgg     = assymetry factor<a name='9428'></font>
<font color=#447700>!      prmuz   = cosine solar zenith angle<a name='9429'></font>
<font color=#447700>!      ptau    = optical thickness<a name='9430'></font>
<font color=#447700>!      pw      = single scattering albedo<a name='9431'></font>
<font color=#447700>!<a name='9432'></font>
<font color=#447700>! outputs<a name='9433'></font>
<font color=#447700>! -------<a name='9434'></font>
<font color=#447700>!      pref    : collimated beam reflectivity<a name='9435'></font>
<font color=#447700>!      prefd   : diffuse beam reflectivity <a name='9436'></font>
<font color=#447700>!      ptra    : collimated beam transmissivity<a name='9437'></font>
<font color=#447700>!      ptrad   : diffuse beam transmissivity<a name='9438'></font>
<font color=#447700>!<a name='9439'></font>
<font color=#447700>!<a name='9440'></font>
<font color=#447700>! Method:<a name='9441'></font>
<font color=#447700>! -------<a name='9442'></font>
<font color=#447700>!      standard delta-eddington, p.i.f.m., or d.o.m. layer calculations.<a name='9443'></font>
<font color=#447700>!      kmodts  = 1 eddington (joseph et al., 1976)<a name='9444'></font>
<font color=#447700>!              = 2 pifm (zdunkowski et al., 1980)<a name='9445'></font>
<font color=#447700>!              = 3 discrete ordinates (liou, 1973)<a name='9446'></font>
<font color=#447700>!<a name='9447'></font>
<font color=#447700>! ac = 1 -- clear<a name='9448'></font>
<font color=#447700>! ac = 0 -- total (clear and cloudy)<a name='9449'></font>
<font color=#447700>!<a name='9450'></font>
<font color=#447700>! Modifications:<a name='9451'></font>
<font color=#447700>! --------------<a name='9452'></font>
<font color=#447700>! Original: J-JMorcrette, ECMWF, Feb 2003<a name='9453'></font>
<font color=#447700>! Revised for F90 reformatting: MJIacono, AER, Jul 2006<a name='9454'></font>
<font color=#447700>! Revised to add exponential lookup table: MJIacono, AER, Aug 2007<a name='9455'></font>
<font color=#447700>!<a name='9456'></font>
<font color=#447700>! ------------------------------------------------------------------<a name='9457'></font>
<a name='9458'>
<font color=#447700>! ------- Declarations ------<a name='9459'></font>
<a name='9460'>
<font color=#447700>! ------- Input -------<a name='9461'></font>
<a name='9462'>
      integer , intent(in) :: nlayers<a name='9463'>
      integer , intent(in) :: ncol<a name='9464'>
<a name='9465'>
      real,  intent(in) :: pcldfmc(:,:,:)                      <font color=#447700>! Logical flag for reflectivity and<a name='9466'></font>
                                                               <font color=#447700>! and transmissivity calculation; <a name='9467'></font>
                                                               <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='9468'></font>
<a name='9469'>
      real , intent(in) gpu_device :: pgg(:,:,:)               <font color=#447700>! asymmetry parameter<a name='9470'></font>
      real , intent(in) gpu_device :: ptau(:,:,:)              <font color=#447700>! optical depth<a name='9471'></font>
      real , intent(in) gpu_device :: pw(:,:,:)                <font color=#447700>! single scattering albedo <a name='9472'></font>
                                                               <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='9473'></font>
<a name='9474'>
      real ,  intent(in) :: prmuzl(:)                          <font color=#447700>! cosine of solar zenith angle<a name='9475'></font>
                                                               <font color=#447700>!   Dimensions: (ncol)<a name='9476'></font>
      integer, intent(in) :: ac<a name='9477'>
<a name='9478'>
<font color=#447700>! ------- Output -------<a name='9479'></font>
<a name='9480'>
      real , intent(out) gpu_device :: pref(:,:,:)             <font color=#447700>! direct beam reflectivity<a name='9481'></font>
      real , intent(out) gpu_device :: prefd(:,:,:)            <font color=#447700>! diffuse beam reflectivity<a name='9482'></font>
      real , intent(out) gpu_device :: ptra(:,:,:)             <font color=#447700>! direct beam transmissivity<a name='9483'></font>
      real , intent(out) gpu_device :: ptrad(:,:,:)            <font color=#447700>! diffuse beam transmissivity<a name='9484'></font>
                                                               <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='9485'></font>
<a name='9486'>
<font color=#447700>! ------- Local -------<a name='9487'></font>
<a name='9488'>
      integer  :: jk, jl, kmodts<a name='9489'>
      integer  :: itind, iplon, iw<a name='9490'>
<a name='9491'>
      real  :: tblind<a name='9492'>
      real  :: za, za1, za2<a name='9493'>
      real  :: zbeta, zdend, zdenr, zdent<a name='9494'>
      real  :: ze1, ze2, zem1, zem2, zemm, zep1, zep2<a name='9495'>
      real  :: zg, zg3, zgamma1, zgamma2, zgamma3, zgamma4, zgt<a name='9496'>
      real  :: zr1, zr2, zr3, zr4, zr5<a name='9497'>
      real  :: zrk, zrk2, zrkg, zrm1, zrp, zrp1, zrpp<a name='9498'>
      real  :: zsr3, zt1, zt2, zt3, zt4, zt5, zto1<a name='9499'>
      real  :: zw, zwcrit, zwo, prmuz<a name='9500'>
<a name='9501'>
      real , parameter :: eps = 1.e-08 <a name='9502'>
<a name='9503'>
<font color=#447700>!     ------------------------------------------------------------------<a name='9504'></font>
<a name='9505'>
<font color=#447700>! Initialize<a name='9506'></font>
<a name='9507'>
      zsr3=sqrt(3. )<a name='9508'>
      zwcrit=0.9999995 <a name='9509'>
      kmodts=2<a name='9510'>
      <a name='9511'>
<font color=#447700>!$acc kernels loop<a name='9512'></font>
      do iplon=1,ncol<a name='9513'>
<font color=#447700>!$acc loop<a name='9514'></font>
        do iw=1,112<a name='9515'>
<font color=#447700>!$acc loop private(zgamma1, zgamma2, zgamma3, zgamma4)<a name='9516'></font>
          do jk=1, nlayers<a name='9517'>
             prmuz = prmuzl(iplon)<a name='9518'>
             if ((.not.(pcldfmc(iplon,nlayers+1-jk,iw))  &gt; 1.e-12) .and. ac==0  ) then<a name='9519'>
               pref(iplon,iw,jk)   =0. <a name='9520'>
               ptra(iplon,iw,jk)   =1. <a name='9521'>
               prefd(iplon,iw,jk)  =0. <a name='9522'>
               ptrad(iplon,iw,jk)  =1. <a name='9523'>
             else<a name='9524'>
               zto1=ptau(iplon,iw,jk)  <a name='9525'>
               zw  =pw(iplon,iw,jk)  <a name='9526'>
               zg  =pgg(iplon,iw,jk)    <a name='9527'>
<a name='9528'>
<font color=#447700>! General two-stream expressions<a name='9529'></font>
<a name='9530'>
               zg3= 3.  * zg<a name='9531'>
           <a name='9532'>
               zgamma1= (8.  - zw * (5.  + zg3)) * 0.25 <a name='9533'>
               zgamma2=  3.  *(zw * (1.  - zg )) * 0.25 <a name='9534'>
               zgamma3= (2.  - zg3 * prmuz ) * 0.25 <a name='9535'>
       <a name='9536'>
               zgamma4= 1.  - zgamma3<a name='9537'>
    <a name='9538'>
<font color=#447700>! Recompute original s.s.a. to test for conservative solution<a name='9539'></font>
<a name='9540'>
               zwo= zw / (1.  - (1.  - zw) * (zg / (1.  - zg))**2)<a name='9541'>
    <a name='9542'>
               if (zwo &gt;= zwcrit) then<a name='9543'>
<font color=#447700>! Conservative scattering<a name='9544'></font>
<a name='9545'>
                  za  = zgamma1 * prmuz <a name='9546'>
                  za1 = za - zgamma3<a name='9547'>
                  zgt = zgamma1 * zto1<a name='9548'>
        <a name='9549'>
<font color=#447700>! Homogeneous reflectance and transmittance,<a name='9550'></font>
<font color=#447700>! collimated beam<a name='9551'></font>
<a name='9552'>
                  ze1 = min ( zto1 / prmuz , 500. )<a name='9553'>
<a name='9554'>
<a name='9555'>
                  ze2 = exp(-ze1)<a name='9556'>
                  pref(iplon,iw,jk)   = (zgt - za1 * (1.  - ze2)) / (1.  + zgt)<a name='9557'>
                  ptra(iplon,iw,jk)   = 1.  - pref(iplon,iw,jk)  <a name='9558'>
<a name='9559'>
<font color=#447700>! isotropic incidence<a name='9560'></font>
<a name='9561'>
                  prefd(iplon,iw,jk)   = zgt / (1.  + zgt)<a name='9562'>
                  ptrad(iplon,iw,jk)   = 1.  - prefd(iplon,iw,jk)          <a name='9563'>
<a name='9564'>
<font color=#447700>! This is applied for consistency between total (delta-scaled) and direct (unscaled) <a name='9565'></font>
<font color=#447700>! calculations at very low optical depths (tau &lt; 1.e-4) when the exponential lookup<a name='9566'></font>
<font color=#447700>! table returns a transmittance of 1.0.<a name='9567'></font>
                  if (ze2 .eq. 1.0 ) then <a name='9568'>
                     pref(iplon,iw,jk)   = 0.0 <a name='9569'>
                     ptra(iplon,iw,jk)   = 1.0 <a name='9570'>
                     prefd(iplon,iw,jk)   = 0.0 <a name='9571'>
                     ptrad(iplon,iw,jk)   = 1.0 <a name='9572'>
                  endif<a name='9573'>
<a name='9574'>
               else<a name='9575'>
<font color=#447700>! Non-conservative scattering<a name='9576'></font>
<a name='9577'>
                  za1 = zgamma1 * zgamma4 + zgamma2 * zgamma3<a name='9578'>
                  za2 = zgamma1 * zgamma3 + zgamma2 * zgamma4<a name='9579'>
                  zrk = sqrt ( zgamma1**2 - zgamma2**2)<a name='9580'>
                  zrp = zrk * prmuz               <a name='9581'>
                  zrp1 = 1.  + zrp<a name='9582'>
                  zrm1 = 1.  - zrp<a name='9583'>
                  zrk2 = 2.  * zrk<a name='9584'>
                  zrpp = 1.  - zrp*zrp<a name='9585'>
                  zrkg = zrk + zgamma1<a name='9586'>
                  zr1  = zrm1 * (za2 + zrk * zgamma3)<a name='9587'>
                  zr2  = zrp1 * (za2 - zrk * zgamma3)<a name='9588'>
                  zr3  = zrk2 * (zgamma3 - za2 * prmuz )<a name='9589'>
                  zr4  = zrpp * zrkg<a name='9590'>
                  zr5  = zrpp * (zrk - zgamma1)<a name='9591'>
                  zt1  = zrp1 * (za1 + zrk * zgamma4)<a name='9592'>
                  zt2  = zrm1 * (za1 - zrk * zgamma4)<a name='9593'>
                  zt3  = zrk2 * (zgamma4 + za1 * prmuz )<a name='9594'>
                  zt4  = zr4<a name='9595'>
                  zt5  = zr5<a name='9596'>
<a name='9597'>
<font color=#447700>! mji - reformulated code to avoid potential floating point exceptions<a name='9598'></font>
<font color=#447700>!               zbeta = - zr5 / zr4<a name='9599'></font>
                  zbeta = (zgamma1 - zrk) / zrkg<a name='9600'>
<font color=#447700>!!<a name='9601'></font>
        <a name='9602'>
<font color=#447700>! Homogeneous reflectance and transmittance<a name='9603'></font>
<a name='9604'>
                  ze1 = min ( zrk * zto1, 5. )<a name='9605'>
                  ze2 = min ( zto1 / prmuz , 5. )<a name='9606'>
           <a name='9607'>
<font color=#447700>! Use exponential lookup table for transmittance, or expansion of <a name='9608'></font>
<font color=#447700>! exponential for low tau<a name='9609'></font>
                  if (ze1 .le. od_lo) then <a name='9610'>
                     zem1 = 1.  - ze1 + 0.5  * ze1 * ze1<a name='9611'>
                     zep1 = 1.  / zem1<a name='9612'>
                  else<a name='9613'>
                     zem1 = exp(-ze1)<a name='9614'>
                     zep1 = 1.  / zem1<a name='9615'>
                  endif<a name='9616'>
                  if (ze2 .le. od_lo) then <a name='9617'>
                     zem2 = 1.  - ze2 + 0.5  * ze2 * ze2<a name='9618'>
                     zep2 = 1.  / zem2<a name='9619'>
                  else<a name='9620'>
                     zem2 = exp(-ze2)<a name='9621'>
                     zep2 = 1.  / zem2<a name='9622'>
                  endif<a name='9623'>
<a name='9624'>
                  zdenr = zr4*zep1 + zr5*zem1<a name='9625'>
                  zdent = zt4*zep1 + zt5*zem1<a name='9626'>
                  if (zdenr .ge. -eps .and. zdenr .le. eps) then<a name='9627'>
                     pref(iplon,iw,jk)   = eps<a name='9628'>
                     ptra(iplon,iw,jk)   = zem2<a name='9629'>
                  else <a name='9630'>
                     pref(iplon,iw,jk)   = zw * (zr1*zep1 - zr2*zem1 - zr3*zem2) / zdenr<a name='9631'>
                     ptra(iplon,iw,jk)   = zem2 - zem2 * zw * (zt1*zep1 - zt2*zem1 - zt3*zep2) / zdent<a name='9632'>
                  endif<a name='9633'>
<a name='9634'>
<font color=#447700>! diffuse beam<a name='9635'></font>
<a name='9636'>
                  zemm = zem1*zem1<a name='9637'>
                  zdend = 1.  / ( (1.  - zbeta*zemm ) * zrkg)<a name='9638'>
                  prefd(iplon,iw,jk)   =  zgamma2 * (1.  - zemm) * zdend<a name='9639'>
                  ptrad(iplon,iw,jk)   =  zrk2*zem1*zdend<a name='9640'>
<a name='9641'>
               endif<a name='9642'>
<a name='9643'>
            endif         <a name='9644'>
<a name='9645'>
          end do  <a name='9646'>
        end do<a name='9647'>
      end do<a name='9648'>
<font color=#447700>!$acc end kernels<a name='9649'></font>
<a name='9650'>
      end subroutine reftra_sw<a name='9651'>
                           <a name='9652'>
<font color=#447700>! --------------------------------------------------------------------------<a name='9653'></font>
<A NAME='VRTQDR_SW'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#VRTQDR_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='9654'>
      <font color=#993300>subroutine </font><font color=#cc0000>vrtqdr_sw</font>(ncol, klev, &amp; <A href='../../call_to/VRTQDR_SW.html' TARGET='index'>4</A><a name='9655'>
                           pref, prefd, ptra, ptrad, &amp;<a name='9656'>
                           pdbt, prdnd, prup, prupd, ptdbt, &amp;<a name='9657'>
                           pfd, pfu, ztdn)<a name='9658'>
<font color=#447700>! --------------------------------------------------------------------------<a name='9659'></font>
 <a name='9660'>
<font color=#447700>! Purpose: This routine performs the vertical quadrature integration<a name='9661'></font>
<font color=#447700>!<a name='9662'></font>
<font color=#447700>! Interface:  *vrtqdr_sw* is called from *spcvrt_sw* and *spcvmc_sw*<a name='9663'></font>
<font color=#447700>!<a name='9664'></font>
<font color=#447700>! Modifications.<a name='9665'></font>
<font color=#447700>! <a name='9666'></font>
<font color=#447700>! Original: H. Barker<a name='9667'></font>
<font color=#447700>! Revision: Integrated with rrtmg_sw, J.-J. Morcrette, ECMWF, Oct 2002<a name='9668'></font>
<font color=#447700>! Revision: Reformatted for consistency with rrtmg_lw: MJIacono, AER, Jul 2006<a name='9669'></font>
<font color=#447700>!<a name='9670'></font>
<font color=#447700>!-----------------------------------------------------------------------<a name='9671'></font>
<a name='9672'>
<font color=#447700>! ------- Declarations -------<a name='9673'></font>
<a name='9674'>
<font color=#447700>! Input<a name='9675'></font>
<a name='9676'>
      integer , intent (in) :: klev                           <font color=#447700>! number of model layers<a name='9677'></font>
      integer , intent (in) :: ncol<a name='9678'>
    <a name='9679'>
<a name='9680'>
#ifdef _ACCEL<a name='9681'>
      real , intent(in) gpu_device :: pref(:,:,:)             <font color=#447700>! direct beam reflectivity<a name='9682'></font>
      real , intent(in) gpu_device :: prefd(:,:,:)            <font color=#447700>! diffuse beam reflectivity<a name='9683'></font>
      real , intent(in) gpu_device :: ptra(:,:,:)             <font color=#447700>! direct beam transmissivity<a name='9684'></font>
      real , intent(in) gpu_device :: ptrad(:,:,:)            <font color=#447700>! diffuse beam transmissivity<a name='9685'></font>
      real , intent(in) gpu_device :: pdbt(:,:,:)  <a name='9686'>
      real , intent(in) gpu_device :: ptdbt(:,:,:)  <a name='9687'>
      real , intent(out) gpu_device :: prdnd(:,:,:)  <a name='9688'>
      real , intent(inout) gpu_device :: prup(:,:,:)  <a name='9689'>
      real , intent(inout) gpu_device  :: prupd(:,:,:)  <a name='9690'>
      real, intent(inout) gpu_device :: ztdn(:,:,:)<a name='9691'>
                                                              <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='9692'></font>
                                                              <a name='9693'>
<font color=#447700>! Output<a name='9694'></font>
      real , intent(out) gpu_device  :: pfd(:,:,:)            <font color=#447700>! downwelling flux (W/m2)<a name='9695'></font>
                                                              <font color=#447700>! unadjusted for earth/sun distance or zenith angle<a name='9696'></font>
      real , intent(inout) gpu_device  :: pfu(:,:,:)          <font color=#447700>! upwelling flux (W/m2)<a name='9697'></font>
                                                              <font color=#447700>! unadjusted for earth/sun distance or zenith angle<a name='9698'></font>
                                                              <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='9699'></font>
#else<a name='9700'>
      real , intent(in) :: pref(CHNK,112,klev+1)             <font color=#447700>! direct beam reflectivity<a name='9701'></font>
      real , intent(in) :: prefd(CHNK,112,klev+1)            <font color=#447700>! diffuse beam reflectivity<a name='9702'></font>
      real , intent(in) :: ptra(CHNK,112,klev+1)             <font color=#447700>! direct beam transmissivity<a name='9703'></font>
      real , intent(in) :: ptrad(CHNK,112,klev+1)            <font color=#447700>! diffuse beam transmissivity<a name='9704'></font>
      real , intent(in) :: pdbt(CHNK,112,klev+1)<a name='9705'>
      real , intent(in) :: ptdbt(CHNK,112,klev+1)<a name='9706'>
      real , intent(out) :: prdnd(CHNK,112,klev+1)<a name='9707'>
      real , intent(inout) :: prup(CHNK,112,klev+1)<a name='9708'>
      real , intent(inout)  :: prupd(CHNK,112,klev+1)<a name='9709'>
      real, intent(inout) :: ztdn(CHNK,112,klev+1)<a name='9710'>
                                                              <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='9711'></font>
<a name='9712'>
<font color=#447700>! Output<a name='9713'></font>
      real , intent(out) gpu_device  :: pfd(CHNK,112,klev+1)            <font color=#447700>! downwelling flux (W/m2)<a name='9714'></font>
                                                              <font color=#447700>! unadjusted for earth/sun distance or zenith angle<a name='9715'></font>
      real , intent(inout) gpu_device  :: pfu(CHNK,112,klev+1)          <font color=#447700>! upwelling flux (W/m2)<a name='9716'></font>
                                                              <font color=#447700>! unadjusted for earth/sun distance or zenith angle<a name='9717'></font>
                                                              <font color=#447700>!   Dimensions: (ncol,nlayers,ngptsw)<a name='9718'></font>
#endif<a name='9719'>
<a name='9720'>
<font color=#447700>! Local<a name='9721'></font>
<a name='9722'>
      integer  :: ikp, ikx, jk, iplon, iw<a name='9723'>
<a name='9724'>
#ifdef _ACCEL<a name='9725'>
<a name='9726'>
      real  :: zreflect, zreflectj<a name='9727'>
<a name='9728'>
# define ILOOP_S_CPU <a name='9729'>
# define ILOOP_E_CPU<a name='9730'>
# define ILOOP_S_GPU do iplon = 1, ncol<a name='9731'>
# define ILOOP_E_GPU enddo<a name='9732'>
# define WLOOP_S_CPU <a name='9733'>
# define WLOOP_E_CPU <a name='9734'>
# define WLOOP_S_GPU do iw = 1, 112<a name='9735'>
# define WLOOP_E_GPU enddo<a name='9736'>
<a name='9737'>
#else<a name='9738'>
<a name='9739'>
<font color=#447700>!      real, dimension(CHNK)  :: zreflect, zreflectj<a name='9740'></font>
      real  :: zreflect, zreflectj<a name='9741'>
<a name='9742'>
# define ncol CHNK<a name='9743'>
<a name='9744'>
# define ILOOP_S_GPU <a name='9745'>
# define ILOOP_E_GPU <a name='9746'>
# define ILOOP_S_CPU do iplon = 1, ncol<a name='9747'>
# define ILOOP_E_CPU enddo<a name='9748'>
# define WLOOP_S_GPU <a name='9749'>
# define WLOOP_E_GPU <a name='9750'>
# define WLOOP_S_CPU do iw = 1, 112<a name='9751'>
# define WLOOP_E_CPU enddo<a name='9752'>
<a name='9753'>
<font color=#447700>!# define zreflect ZREFLECT(iplon)<a name='9754'></font>
<font color=#447700>!# define zreflectj ZREFLECTJ(iplon)<a name='9755'></font>
<a name='9756'>
#endif<a name='9757'>
     <a name='9758'>
<font color=#447700>! Definitions<a name='9759'></font>
<font color=#447700>!<a name='9760'></font>
<font color=#447700>! pref(jk)   direct reflectance<a name='9761'></font>
<font color=#447700>! prefd(jk)  diffuse reflectance<a name='9762'></font>
<font color=#447700>! ptra(jk)   direct transmittance<a name='9763'></font>
<font color=#447700>! ptrad(jk)  diffuse transmittance<a name='9764'></font>
<font color=#447700>!<a name='9765'></font>
<font color=#447700>! pdbt(jk)   layer mean direct beam transmittance<a name='9766'></font>
<font color=#447700>! ptdbt(jk)  total direct beam transmittance at levels<a name='9767'></font>
<font color=#447700>!<a name='9768'></font>
<font color=#447700>!-----------------------------------------------------------------------------<a name='9769'></font>
                   <a name='9770'>
<font color=#447700>! Link lowest layer with surface<a name='9771'></font>
<font color=#447700>! this kernel has a lot of dependencies<a name='9772'></font>
<a name='9773'>
<font color=#447700>!               CHNK       hardcode      klev+1<a name='9774'></font>
<font color=#447700>! pref            8         112          52<a name='9775'></font>
<font color=#447700>! prefd            8         112          52<a name='9776'></font>
<font color=#447700>! ptra            8         112          52<a name='9777'></font>
<font color=#447700>! ptrad            8         112          52<a name='9778'></font>
<font color=#447700>! pdbt            8         112          52<a name='9779'></font>
<font color=#447700>! ptdbt            8         112          52<a name='9780'></font>
<font color=#447700>! prdnd            8         112          52<a name='9781'></font>
<font color=#447700>! prup            8         112          52<a name='9782'></font>
<font color=#447700>! prupd            8         112          52<a name='9783'></font>
<font color=#447700>! ztdn            8         112          52<a name='9784'></font>
<font color=#447700>! pfd            8         112          52<a name='9785'></font>
<font color=#447700>! pfu            8         112          52<a name='9786'></font>
<font color=#447700>!DIR$ ASSUME_ALIGNED pref:64,prefd:64,ptra:64,ptrad:64<a name='9787'></font>
<font color=#447700>!DIR$ ASSUME_ALIGNED pdbt:64,ptdbt:64,prdnd:64,prup:64,prupd:64,ztdn:64,pfd:64,pfu:64<a name='9788'></font>
<a name='9789'>
#if 0<a name='9790'>
write(0,*)'pref ',shape( pref)             <font color=#447700>! direct beam reflectivity<a name='9791'></font>
write(0,*)'prefd ',shape( prefd)            <font color=#447700>! diffuse beam reflectivity<a name='9792'></font>
write(0,*)'ptra ',shape( ptra)             <font color=#447700>! direct beam transmissivity<a name='9793'></font>
write(0,*)'ptrad ',shape( ptrad)            <font color=#447700>! diffuse beam transmissivity<a name='9794'></font>
write(0,*)'pdbt ',shape( pdbt)<a name='9795'>
write(0,*)'ptdbt ',shape( ptdbt)<a name='9796'>
write(0,*)'prdnd ',shape( prdnd)<a name='9797'>
write(0,*)'prup ',shape( prup)<a name='9798'>
write(0,*)'prupd ',shape( prupd)<a name='9799'>
write(0,*)'ztdn ',shape( ztdn)<a name='9800'>
write(0,*)'pfd ',shape( pfd)            <font color=#447700>! downwelling flux (W/m2)<a name='9801'></font>
write(0,*)'pfu ',shape( pfu)          <font color=#447700>! upwelling flux (W/m2)<a name='9802'></font>
#endif<a name='9803'>
<a name='9804'>
<a name='9805'>
<a name='9806'>
<font color=#447700>!$acc kernels loop<a name='9807'></font>
      ILOOP_S_GPU<a name='9808'>
<a name='9809'>
<font color=#447700>!$acc loop private(zreflect)<a name='9810'></font>
        WLOOP_S_GPU<a name='9811'>
         WLOOP_S_CPU<a name='9812'>
<font color=#447700>!DIR$ VECTOR ALIGNED<a name='9813'></font>
           ILOOP_S_CPU<a name='9814'>
            zreflect = 1.  / (1.  - prefd(iplon,iw,klev+1)   * prefd(iplon,iw,klev)  )<a name='9815'>
            prup(iplon,iw,klev)   = pref(iplon,iw,klev)   + (ptrad(iplon,iw,klev)   * &amp;<a name='9816'>
                 ((ptra(iplon,iw,klev)   - pdbt(iplon,iw,klev)  ) * prefd(iplon,iw,klev+1)   + &amp;<a name='9817'>
                   pdbt(iplon,iw,klev)   * pref(iplon,iw,klev+1)  )) * zreflect<a name='9818'>
            prupd(iplon,iw,klev)   = prefd(iplon,iw,klev)   + ptrad(iplon,iw,klev)   * ptrad(iplon,iw,klev)   * &amp;<a name='9819'>
                    prefd(iplon,iw,klev+1)   * zreflect<a name='9820'>
           ILOOP_E_CPU<a name='9821'>
         WLOOP_E_GPU<a name='9822'>
        WLOOP_E_CPU<a name='9823'>
      ILOOP_E_GPU<a name='9824'>
<font color=#447700>!$acc end kernels<a name='9825'></font>
      <a name='9826'>
<font color=#447700>! Pass from bottom to top <a name='9827'></font>
<font color=#447700>!$acc kernels loop<a name='9828'></font>
      ILOOP_S_GPU<a name='9829'>
<a name='9830'>
<font color=#447700>!$acc loop    <a name='9831'></font>
       WLOOP_S_GPU<a name='9832'>
<a name='9833'>
<font color=#447700>!$acc loop seq <a name='9834'></font>
            do jk = 1,klev-1<a name='9835'>
               ikp = klev+1-jk                       <a name='9836'>
               ikx = ikp-1<a name='9837'>
         WLOOP_S_CPU<a name='9838'>
<font color=#447700>!DIR$ VECTOR ALIGNED<a name='9839'></font>
           ILOOP_S_CPU<a name='9840'>
               zreflectj = 1.  / (1.  -prupd(iplon,iw,ikp)   * prefd(iplon,iw,ikx)  )<a name='9841'>
               prup(iplon,iw,ikx)   = pref(iplon,iw,ikx)   + (ptrad(iplon,iw,ikx)   * &amp;<a name='9842'>
                   ((ptra(iplon,iw,ikx)   - pdbt(iplon,iw,ikx)  ) * prupd(iplon,iw,ikp)   + &amp;<a name='9843'>
                     pdbt(iplon,iw,ikx)   * prup(iplon,iw,ikp)  )) * zreflectj<a name='9844'>
               prupd(iplon,iw,ikx)   = prefd(iplon,iw,ikx)   + ptrad(iplon,iw,ikx)   * ptrad(iplon,iw,ikx)   * &amp;<a name='9845'>
                      prupd(iplon,iw,ikp)   * zreflectj<a name='9846'>
           ILOOP_E_CPU<a name='9847'>
         WLOOP_E_CPU<a name='9848'>
            end do<a name='9849'>
       WLOOP_E_GPU<a name='9850'>
      ILOOP_E_GPU<a name='9851'>
<font color=#447700>!$acc end kernels<a name='9852'></font>
<a name='9853'>
<font color=#447700>!$acc kernels loop<a name='9854'></font>
      ILOOP_S_GPU<a name='9855'>
<font color=#447700>!$acc loop<a name='9856'></font>
        WLOOP_S_GPU<a name='9857'>
         WLOOP_S_CPU<a name='9858'>
<a name='9859'>
<font color=#447700>! Upper boundary conditions<a name='9860'></font>
<font color=#447700>!DIR$ VECTOR ALIGNED<a name='9861'></font>
           ILOOP_S_CPU<a name='9862'>
            ztdn(iplon, iw, 1) = 1. <a name='9863'>
            prdnd(iplon,iw,1)   = 0. <a name='9864'>
            ztdn(iplon, iw, 2) = ptra(iplon,iw,1)  <a name='9865'>
            prdnd(iplon,iw,2)   = prefd(iplon,iw,1)  <a name='9866'>
           ILOOP_E_CPU<a name='9867'>
         WLOOP_E_GPU<a name='9868'>
        WLOOP_E_CPU<a name='9869'>
      ILOOP_E_GPU<a name='9870'>
<font color=#447700>!$acc end kernels      <a name='9871'></font>
      <a name='9872'>
<font color=#447700>!$acc kernels loop<a name='9873'></font>
      ILOOP_S_GPU<a name='9874'>
<font color=#447700>!$acc loop<a name='9875'></font>
       WLOOP_S_GPU<a name='9876'>
<a name='9877'>
<font color=#447700>! Pass from top to bottom<a name='9878'></font>
<font color=#447700>!$acc loop seq<a name='9879'></font>
            do jk = 2,klev<a name='9880'>
               ikp = jk+1<a name='9881'>
         WLOOP_S_CPU<a name='9882'>
<font color=#447700>!DIR$ VECTOR ALIGNED<a name='9883'></font>
           ILOOP_S_CPU<a name='9884'>
               zreflect = 1.  / (1.  - prefd(iplon,iw,jk)   * prdnd(iplon,iw,jk)  )<a name='9885'>
               ztdn(iplon, iw, ikp) = ptdbt(iplon,iw,jk)   * ptra(iplon,iw,jk)   + &amp;<a name='9886'>
                    (ptrad(iplon,iw,jk)   * ((ztdn(iplon, iw, jk) - ptdbt(iplon,iw,jk)  ) + &amp;<a name='9887'>
                     ptdbt(iplon,iw,jk)   * pref(iplon,iw,jk)   * prdnd(iplon,iw,jk)  )) * zreflect<a name='9888'>
               prdnd(iplon,iw,ikp)   = prefd(iplon,iw,jk)   + ptrad(iplon,iw,jk)   * ptrad(iplon,iw,jk)   * &amp;<a name='9889'>
                      prdnd(iplon,iw,jk)   * zreflect<a name='9890'>
           ILOOP_E_CPU<a name='9891'>
         WLOOP_E_CPU<a name='9892'>
            end do<a name='9893'>
       WLOOP_E_GPU<a name='9894'>
      ILOOP_E_GPU<a name='9895'>
<font color=#447700>!$acc end kernels<a name='9896'></font>
    <a name='9897'>
<font color=#447700>! Up and down-welling fluxes at levels<a name='9898'></font>
<a name='9899'>
<font color=#447700>!$acc kernels loop<a name='9900'></font>
      ILOOP_S_GPU<a name='9901'>
<font color=#447700>!$acc loop<a name='9902'></font>
       WLOOP_S_GPU<a name='9903'>
<font color=#447700>!$acc loop <a name='9904'></font>
            do jk = 1,klev+1<a name='9905'>
         WLOOP_S_CPU<a name='9906'>
<font color=#447700>!DIR$ VECTOR ALIGNED<a name='9907'></font>
           ILOOP_S_CPU<a name='9908'>
               zreflect = 1.  / (1.  - prdnd(iplon,iw,jk)   * prupd(iplon,iw,jk)  )<a name='9909'>
               pfu(iplon,iw,jk)   = (ptdbt(iplon,iw,jk)   * prup(iplon,iw,jk)   + &amp;<a name='9910'>
                      (ztdn(iplon, iw, jk) - ptdbt(iplon,iw,jk)  ) * prupd(iplon,iw,jk)  ) * zreflect<a name='9911'>
               pfd(iplon,iw,jk)   = ptdbt(iplon,iw,jk)   + (ztdn(iplon, iw, jk) - ptdbt(iplon,iw,jk)  + &amp;<a name='9912'>
                      ptdbt(iplon,iw,jk)   * prup(iplon,iw,jk)   * prdnd(iplon,iw,jk)  ) * zreflect<a name='9913'>
           ILOOP_E_CPU<a name='9914'>
         WLOOP_E_CPU<a name='9915'>
            end do<a name='9916'>
       WLOOP_E_GPU<a name='9917'>
      ILOOP_E_GPU<a name='9918'>
<font color=#447700>!$acc end kernels<a name='9919'></font>
      <a name='9920'>
      end subroutine vrtqdr_sw<a name='9921'>
<a name='9922'>
      end module rrtmg_sw_spcvmc_f<a name='9923'>
# undef ILOOP_S_GPU <a name='9924'>
# undef ILOOP_E_GPU <a name='9925'>
# undef ILOOP_S_CPU<a name='9926'>
# undef ILOOP_E_CPU<a name='9927'>
# undef WLOOP_S_GPU <a name='9928'>
# undef WLOOP_E_GPU <a name='9929'>
# undef WLOOP_S_CPU<a name='9930'>
# undef WLOOP_E_CPU<a name='9931'>
# undef zreflect<a name='9932'>
# undef zreflectj<a name='9933'>
# undef ncol<a name='9934'>
<a name='9935'>
<A NAME='RRTMG_SW_RAD_F'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_RAD_F' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='9936'>
      <font color=#993300>module </font><font color=#cc0000>rrtmg_sw_rad_f</font> <A href='../../call_to/RRTMG_SW_RAD_F.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_RAD_F.html' TARGET='index'>5</A><a name='9937'>
<font color=#447700>!<a name='9938'></font>
<font color=#447700>! ****************************************************************************<a name='9939'></font>
<font color=#447700>! *                                                                          *<a name='9940'></font>
<font color=#447700>! *                             RRTMG_SW                                     *<a name='9941'></font>
<font color=#447700>! *                                                                          *<a name='9942'></font>
<font color=#447700>! *                                                                          *<a name='9943'></font>
<font color=#447700>! *                                                                          *<a name='9944'></font>
<font color=#447700>! *                 a rapid radiative transfer model                         *<a name='9945'></font>
<font color=#447700>! *                  for the solar spectral region                           *<a name='9946'></font>
<font color=#447700>! *           for application to general circulation models                  *<a name='9947'></font>
<font color=#447700>! *                                                                          *<a name='9948'></font>
<font color=#447700>! *                                                                          *<a name='9949'></font>
<font color=#447700>! *           Atmospheric and Environmental Research, Inc.                   *<a name='9950'></font>
<font color=#447700>! *                       131 Hartwell Avenue                                *<a name='9951'></font>
<font color=#447700>! *                       Lexington, MA 02421                                *<a name='9952'></font>
<font color=#447700>! *                                                                          *<a name='9953'></font>
<font color=#447700>! *                                                                          *<a name='9954'></font>
<font color=#447700>! *                          Eli J. Mlawer                                   *<a name='9955'></font>
<font color=#447700>! *                       Jennifer S. Delamere                               *<a name='9956'></font>
<font color=#447700>! *                        Michael J. Iacono                                 *<a name='9957'></font>
<font color=#447700>! *                        Shepard A. Clough                                 *<a name='9958'></font>
<font color=#447700>! *                       David M. Berthiaume                                *<a name='9959'></font>
<font color=#447700>! *                                                                          *<a name='9960'></font>
<font color=#447700>! *                                                                          *<a name='9961'></font>
<font color=#447700>! *                                                                          *<a name='9962'></font>
<font color=#447700>! *                                                                          *<a name='9963'></font>
<font color=#447700>! *                                                                          *<a name='9964'></font>
<font color=#447700>! *                      email:  miacono@aer.com                             *<a name='9965'></font>
<font color=#447700>! *                      email:  emlawer@aer.com                             *<a name='9966'></font>
<font color=#447700>! *                      email:  jdelamer@aer.com                            *<a name='9967'></font>
<font color=#447700>! *                                                                          *<a name='9968'></font>
<font color=#447700>! *       The authors wish to acknowledge the contributions of the           *<a name='9969'></font>
<font color=#447700>! *       following people:  Steven J. Taubman, Patrick D. Brown,            *<a name='9970'></font>
<font color=#447700>! *       Ronald E. Farren, Luke Chen, Robert Bergstrom.                     *<a name='9971'></font>
<font color=#447700>! *                                                                          *<a name='9972'></font>
<font color=#447700>! ****************************************************************************<a name='9973'></font>
    <a name='9974'>
<font color=#447700>! --------- Modules ---------<a name='9975'></font>
<a name='9976'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_VSN_F'>rrsw_vsn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_RAD_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_VSN_F_8"><a name='9977'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MCICA_SUBCOL_GEN_SW_F'>mcica_subcol_gen_sw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_RAD_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MCICA_SUBCOL_GEN_SW_F_1">, only: mcica_sw<a name='9978'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_CLDPRMC_F'>rrtmg_sw_cldprmc_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_RAD_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_CLDPRMC_F_1">, only: cldprmc_sw<a name='9979'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SETCOEF_F'>rrtmg_sw_setcoef_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_RAD_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_SETCOEF_F_2">, only: setcoef_sw<a name='9980'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SPCVMC_F'>rrtmg_sw_spcvmc_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_RAD_F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_SPCVMC_F_1">, only: spcvmc_sw<a name='9981'>
<a name='9982'>
      implicit none<a name='9983'>
<a name='9984'>
      public :: rrtmg_sw,  earth_sun<a name='9985'>
<a name='9986'>
      INTEGER, PARAMETER :: debug_level_swf=100<a name='9987'>
<a name='9988'>
      contains<a name='9989'>
    <a name='9990'>
<A NAME='RRTMG_SW'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='9991'>
      <font color=#993300>subroutine </font><font color=#cc0000>rrtmg_sw</font> &amp; <A href='../../call_to/RRTMG_SW.html' TARGET='index'>2</A>,<A href='../../call_from/RRTMG_SW.html' TARGET='index'>22</A><a name='9992'>
            (rpart   ,ncol    ,nlay    ,icld    ,iaer   , &amp;<a name='9993'>
             play    ,plev    ,tlay    ,tlev    ,tsfc   , &amp;<a name='9994'>
             h2ovmr  ,o3vmr   ,co2vmr  ,ch4vmr  ,n2ovmr ,o2vmr , &amp;<a name='9995'>
             asdir   ,asdif   ,aldir   ,aldif   , &amp;<a name='9996'>
             coszen  ,adjes   ,dyofyr  ,scon    , &amp;<a name='9997'>
             inflgsw ,iceflgsw,liqflgsw,cld     , &amp;<a name='9998'>
             tauc    ,ssac    ,asmc    ,fsfc    , &amp;<a name='9999'>
             ciwp    ,clwp    ,cswp    ,rei     ,rel    ,res   , &amp;<a name='10000'>
             tauaer  ,ssaaer  ,asmaer  ,ecaer   , &amp;<a name='10001'>
             swuflx  ,swdflx  ,swhr    ,swuflxc ,swdflxc,swhrc , &amp;<a name='10002'>
<font color=#447700>! --------- Add the following four compenants for ssib shortwave down radiation ---!<a name='10003'></font>
<font color=#447700>! -------------------      by Zhenxin 2011-06-20      --------------------------------!<a name='10004'></font>
             sibvisdir, sibvisdif, sibnirdir, sibnirdif,         &amp;<a name='10005'>
<font color=#447700>! ----------------------  End,  Zhenxin 2011-06-20    --------------------------------!<a name='10006'></font>
             swdkdir,   swdkdif                                  &amp; <font color=#447700>! jararias, 2013/08/10<a name='10007'></font>
                                )<a name='10008'>
<a name='10009'>
<a name='10010'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_36">, only : nbndsw, ngptsw, naerec, nstr, nmol, mxmol, &amp;<a name='10011'>
                          jpband, jpb1, jpb2, rrsw_scon<a name='10012'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_AER_F'>rrsw_aer_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_AER_F_2">, only : rsrtaua, rsrpiza, rsrasya<a name='10013'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_CON_F'>rrsw_con_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CON_F_4">, only : heatfac, oneminus, pi,  grav, avogad<a name='10014'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_WVN_F'>rrsw_wvn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_F_6">, only : wavenum1, wavenum2<a name='10015'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_CLD_F'>rrsw_cld_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CLD_F_3">, only : extliq1, ssaliq1, asyliq1, &amp;<a name='10016'>
                           extice2, ssaice2, asyice2, &amp;<a name='10017'>
                           extice3, ssaice3, asyice3, fdlice3, &amp;<a name='10018'>
                           abari, bbari, cbari, dbari, ebari, fbari<a name='10019'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_WVN_F'>rrsw_wvn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_F_7">, only : wavenum2, ngb<a name='10020'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_REF_F'>rrsw_ref_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_REF_F_2">, only : preflog, tref<a name='10021'>
<a name='10022'>
#ifdef _ACCEL<a name='10023'>
      use cudafor<a name='10024'>
#endif <a name='10025'>
<a name='10026'>
<a name='10027'>
<font color=#447700>! ------- Declarations<a name='10028'></font>
<a name='10029'>
      integer , intent(in) :: rpart           <font color=#447700>! The number of columns in each partition<a name='10030'></font>
      integer , intent(in) :: ncol            <font color=#447700>! Number of horizontal columns     <a name='10031'></font>
      integer , intent(in) :: nlay            <font color=#447700>! Number of model layers<a name='10032'></font>
      integer , intent(inout) :: icld         <font color=#447700>! Cloud overlap method<a name='10033'></font>
                                              <font color=#447700>!    0: Clear only<a name='10034'></font>
                                              <font color=#447700>!    1: Random<a name='10035'></font>
                                              <font color=#447700>!    2: Maximum/random<a name='10036'></font>
                                              <font color=#447700>!    3: Maximum<a name='10037'></font>
      integer , intent(in) :: iaer            <font color=#447700>! Aerosol option flag<a name='10038'></font>
      real , intent(in) :: play(:,:)          <font color=#447700>! Layer pressures (hPa, mb)<a name='10039'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10040'></font>
      real , intent(in) :: plev(:,:)          <font color=#447700>! Interface pressures (hPa, mb)<a name='10041'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10042'></font>
      real , intent(in) :: tlay(:,:)          <font color=#447700>! Layer temperatures (K)<a name='10043'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10044'></font>
      real , intent(in) :: tlev(:,:)          <font color=#447700>! Interface temperatures (K)<a name='10045'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10046'></font>
      real , intent(in) :: tsfc(:)            <font color=#447700>! Surface temperature (K)<a name='10047'></font>
                                              <font color=#447700>!    Dimensions: (ncol)<a name='10048'></font>
      real , intent(in) :: h2ovmr(:,:)        <font color=#447700>! H2O volume mixing ratio<a name='10049'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10050'></font>
      real , intent(in) :: o3vmr(:,:)         <font color=#447700>! O3 volume mixing ratio<a name='10051'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10052'></font>
      real , intent(in) :: co2vmr(:,:)        <font color=#447700>! CO2 volume mixing ratio<a name='10053'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10054'></font>
      real , intent(in) :: ch4vmr(:,:)        <font color=#447700>! Methane volume mixing ratio<a name='10055'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10056'></font>
      real , intent(in) :: n2ovmr(:,:)        <font color=#447700>! Nitrous oxide volume mixing ratio<a name='10057'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10058'></font>
      real , intent(in) :: o2vmr(:,:)         <font color=#447700>! Oxygen volume mixing ratio<a name='10059'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10060'></font>
      real , intent(in) :: asdir(:)           <font color=#447700>! UV/vis surface albedo direct rad<a name='10061'></font>
                                              <font color=#447700>!    Dimensions: (ncol)<a name='10062'></font>
      real , intent(in) :: aldir(:)           <font color=#447700>! Near-IR surface albedo direct rad<a name='10063'></font>
                                              <font color=#447700>!    Dimensions: (ncol)<a name='10064'></font>
      real , intent(in) :: asdif(:)           <font color=#447700>! UV/vis surface albedo: diffuse rad<a name='10065'></font>
                                              <font color=#447700>!    Dimensions: (ncol)<a name='10066'></font>
      real , intent(in) :: aldif(:)           <font color=#447700>! Near-IR surface albedo: diffuse rad<a name='10067'></font>
                                              <font color=#447700>!    Dimensions: (ncol)<a name='10068'></font>
<a name='10069'>
      integer , intent(in) :: dyofyr          <font color=#447700>! Day of the year (used to get Earth/Sun<a name='10070'></font>
                                              <font color=#447700>!  distance if adjflx not provided)<a name='10071'></font>
      real , intent(in) :: adjes              <font color=#447700>! Flux adjustment for Earth/Sun distance<a name='10072'></font>
      real , intent(in) :: coszen(:)          <font color=#447700>! Cosine of solar zenith angle<a name='10073'></font>
                                              <font color=#447700>!    Dimensions: (ncol)<a name='10074'></font>
      real , intent(in) :: scon               <font color=#447700>! Solar constant (W/m2)<a name='10075'></font>
<a name='10076'>
      integer , intent(in) :: inflgsw         <font color=#447700>! Flag for cloud optical properties<a name='10077'></font>
      integer , intent(in) :: iceflgsw        <font color=#447700>! Flag for ice particle specification<a name='10078'></font>
      integer , intent(in) :: liqflgsw        <font color=#447700>! Flag for liquid droplet specification<a name='10079'></font>
<a name='10080'>
      real , intent(in) :: cld(:,:)           <font color=#447700>! Cloud fraction<a name='10081'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10082'></font>
      real , intent(in) :: tauc(:,:,:)        <font color=#447700>! In-cloud optical depth<a name='10083'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay,nbndlw)<a name='10084'></font>
      real , intent(in) :: ssac(:,:,:)        <font color=#447700>! In-cloud single scattering albedo<a name='10085'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay,nbndlw)<a name='10086'></font>
      real , intent(in) :: asmc(:,:,:)        <font color=#447700>! In-cloud asymmetry parameter<a name='10087'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay,nbndlw)<a name='10088'></font>
      real , intent(in) :: fsfc(:,:,:)        <font color=#447700>! In-cloud forward scattering fraction<a name='10089'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay,nbndlw)<a name='10090'></font>
      real , intent(in) :: ciwp(:,:)          <font color=#447700>! In-cloud ice water path (g/m2)<a name='10091'></font>
                                              <font color=#447700>!    Dimensions: (ncol, nlay)<a name='10092'></font>
      real , intent(in) :: clwp(:,:)          <font color=#447700>! In-cloud liquid water path (g/m2)<a name='10093'></font>
                                              <font color=#447700>!    Dimensions: (ncol, nlay)<a name='10094'></font>
      real , intent(in) :: cswp(:,:)          <font color=#447700>! In-cloud snow water path (g/m2)<a name='10095'></font>
                                              <font color=#447700>!    Dimensions: (ncol, nlay)<a name='10096'></font>
      real , intent(in) :: rei(:,:)           <font color=#447700>! Cloud ice effective radius (microns)<a name='10097'></font>
                                              <font color=#447700>!    Dimensions: (ncol, nlay)<a name='10098'></font>
                                              <font color=#447700>! specific definition of rei depends on setting of iceflglw:<a name='10099'></font>
                                              <font color=#447700>! iceflglw = 0: ice effective radius, r_ec, (Ebert and Curry, 1992),<a name='10100'></font>
                                              <font color=#447700>!               r_ec must be &gt;= 10.0 microns<a name='10101'></font>
                                              <font color=#447700>! iceflglw = 1: ice effective radius, r_ec, (Ebert and Curry, 1992),<a name='10102'></font>
                                              <font color=#447700>!               r_ec range is limited to 13.0 to 130.0 microns<a name='10103'></font>
                                              <font color=#447700>! iceflglw = 2: ice effective radius, r_k, (Key, Streamer Ref. Manual, 1996)<a name='10104'></font>
                                              <font color=#447700>!               r_k range is limited to 5.0 to 131.0 microns<a name='10105'></font>
                                              <font color=#447700>! iceflglw = 3: generalized effective size, dge, (Fu, 1996),<a name='10106'></font>
                                              <font color=#447700>!               dge range is limited to 5.0 to 140.0 microns<a name='10107'></font>
                                              <font color=#447700>!               [dge = 1.0315 * r_ec]<a name='10108'></font>
      real , intent(in) :: rel(:,:)           <font color=#447700>! Cloud water drop effective radius (microns)<a name='10109'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10110'></font>
      real , intent(in) :: res(:,:)           <font color=#447700>! Cloud snow effective radius (microns)<a name='10111'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10112'></font>
      real , intent(in) :: tauaer(:,:,:)      <font color=#447700>! Aerosol optical depth (iaer=10 only)<a name='10113'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='10114'></font>
                                              <font color=#447700>! (non-delta scaled)      <a name='10115'></font>
      real , intent(in) :: ssaaer(:,:,:)      <font color=#447700>! Aerosol single scattering albedo (iaer=10 only)<a name='10116'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='10117'></font>
                                              <font color=#447700>! (non-delta scaled)      <a name='10118'></font>
      real , intent(in) :: asmaer(:,:,:)      <font color=#447700>! Aerosol asymmetry parameter (iaer=10 only)<a name='10119'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='10120'></font>
                                              <font color=#447700>! (non-delta scaled)      <a name='10121'></font>
      real , intent(in) :: ecaer(:,:,:)       <font color=#447700>! Aerosol optical depth at 0.55 micron (iaer=6 only)<a name='10122'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay,naerec)<a name='10123'></font>
                                              <font color=#447700>! (non-delta scaled)      <a name='10124'></font>
                                              <a name='10125'>
<font color=#447700>! ----- Output -----<a name='10126'></font>
<a name='10127'>
      real , intent(out) :: swuflx(:,:)       <font color=#447700>! Total sky shortwave upward flux (W/m2)<a name='10128'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10129'></font>
      real , intent(out) :: swdflx(:,:)       <font color=#447700>! Total sky shortwave downward flux (W/m2)<a name='10130'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10131'></font>
      real , intent(out) :: swhr(:,:)         <font color=#447700>! Total sky shortwave radiative heating rate (K/d)<a name='10132'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10133'></font>
      real , intent(out) :: swuflxc(:,:)      <font color=#447700>! Clear sky shortwave upward flux (W/m2)<a name='10134'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10135'></font>
      real , intent(out) :: swdflxc(:,:)      <font color=#447700>! Clear sky shortwave downward flux (W/m2)<a name='10136'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10137'></font>
      real , intent(out) :: swhrc(:,:)        <font color=#447700>! Clear sky shortwave radiative heating rate (K/d)<a name='10138'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10139'></font>
<a name='10140'>
      real, intent(out) :: sibvisdir(:,:)      <font color=#447700>! visible direct downward flux  (W/m2)<a name='10141'></font>
                                               <font color=#447700>!    Dimensions: (ncol,nlay+1) Zhenxin (2011/06/20)<a name='10142'></font>
      real, intent(out) :: sibvisdif(:,:)      <font color=#447700>! visible diffusion downward flux  (W/m2)<a name='10143'></font>
                                               <font color=#447700>!    Dimensions: (ncol,nlay+1) Zhenxin (2011/06/20)<a name='10144'></font>
      real, intent(out) :: sibnirdir(:,:)      <font color=#447700>! Near IR direct downward flux  (W/m2)<a name='10145'></font>
                                               <font color=#447700>!    Dimensions: (ncol,nlay+1)  Zhenxin (2011/06/20)<a name='10146'></font>
      real, intent(out) :: sibnirdif(:,:)      <font color=#447700>! Near IR diffusion downward flux  (W/m2)<a name='10147'></font>
                                               <font color=#447700>!    Dimensions: (ncol,nlay+1) Zhenxin (2011/06/20)<a name='10148'></font>
      real, intent(out) :: swdkdir(:,:)        <font color=#447700>! Total shortwave downward direct flux (W/m2)<a name='10149'></font>
                                               <font color=#447700>!    Dimensions: (ncol,nlay+1) jararias, 2013/08/10<a name='10150'></font>
      real, intent(out) :: swdkdif(:,:)        <font color=#447700>! Total shortwave downward diffuse flux (W/m2)<a name='10151'></font>
                                               <font color=#447700>!    Dimensions: (ncol,nlay+1) jararias, 2013/08/10<a name='10152'></font>
<a name='10153'>
      integer :: npart, pncol, ns<a name='10154'>
      CHARACTER(LEN=256) :: message<a name='10155'>
<a name='10156'>
<font color=#447700>! mji - time<a name='10157'></font>
      real :: t1, t2<a name='10158'>
      <a name='10159'>
#ifdef _ACCEL<a name='10160'>
      type(cudadeviceprop) :: prop<a name='10161'>
      real :: gmem<a name='10162'>
      integer :: err<a name='10163'>
      integer :: munits<a name='10164'>
#endif<a name='10165'>
<a name='10166'>
      if (rpart &gt; 0) then<a name='10167'>
         pncol = rpart<a name='10168'>
      else<a name='10169'>
<a name='10170'>
#ifdef _ACCEL<a name='10171'>
 <a name='10172'>
      err = cudaGetDeviceProperties( prop, 0)<a name='10173'>
      gmem = prop%totalGlobalMem / (1024.0 * 1024.0)<a name='10174'>
<font color=#447700>!      print *, "Total GPU global memory is ", gmem , "MB"<a name='10175'></font>
      <a name='10176'>
      <font color=#447700>! dmb 2013<a name='10177'></font>
      <font color=#447700>! Here <a name='10178'></font>
      <font color=#447700>! The optimal partition size is determined by the following conditions<a name='10179'></font>
      <font color=#447700>! 1. Powers of 2 are the most efficient.<a name='10180'></font>
      <font color=#447700>! 2. The second to largest power of 2 that can fit on <a name='10181'></font>
      <font color=#447700>!    the GPU is most efficient.<a name='10182'></font>
      <font color=#447700>! 3. Having a small remainder for the final partiion is inefficient.<a name='10183'></font>
      <a name='10184'>
      if (gmem &gt; 5000) then<a name='10185'>
         pncol = 4096<a name='10186'>
      else if (gmem &gt; 3000) then<a name='10187'>
         pncol = 2048<a name='10188'>
      else if (gmem &gt; 1000) then<a name='10189'>
          pncol = 1024<a name='10190'>
      else <a name='10191'>
          pncol = 512<a name='10192'>
      end if  <a name='10193'>
         <a name='10194'>
      <font color=#447700>! the smallest allowed partition size is 32<a name='10195'></font>
      do err = 1, 6<a name='10196'>
          if (pncol &gt; ncol .and. pncol&gt;32) then <a name='10197'>
              pncol = pncol/2<a name='10198'>
          end if<a name='10199'>
      end do<a name='10200'>
      <a name='10201'>
      <font color=#447700>! if we have a very large number of columns, account for the <a name='10202'></font>
      <font color=#447700>! static ncol memory requirement <a name='10203'></font>
      if (ncol&gt;29000 .and. pncol&gt;4000) then<a name='10204'>
          pncol = pncol/2<a name='10205'>
      end if<a name='10206'>
<a name='10207'>
#else<a name='10208'>
      pncol = 2<a name='10209'>
      pncol = 4<a name='10210'>
<font color=#447700>!jm      pncol = CHNK  redundant, since this is passed in<a name='10211'></font>
      <a name='10212'>
#endif    <a name='10213'>
          <a name='10214'>
      end if<a name='10215'>
<a name='10216'>
      WRITE(message,*)'RRTMG_SWF: Number of columns is               ',ncol<a name='10217'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_789">( debug_level_swf, message)<a name='10218'>
      WRITE(message,*)'RRTMG_SWF: Number of columns per partition is ',pncol<a name='10219'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_790">( debug_level_swf, message)<a name='10220'>
      ns = ceiling( real(ncol) / real(pncol) )<a name='10221'>
      WRITE(message,*)'RRTMG_SWF: Number of partitions is            ',ns<a name='10222'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_791">( debug_level_swf, message)<a name='10223'>
<a name='10224'>
      call cpu_time(t1)<a name='10225'>
                                                      <a name='10226'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB'>rrtmg_sw_sub</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_SUB_1"> &amp;<a name='10227'>
            (pncol   ,ncol    ,nlay    ,icld    ,iaer   , &amp;<a name='10228'>
             play    ,plev    ,tlay    ,tlev    ,tsfc   , &amp;<a name='10229'>
             h2ovmr  ,o3vmr   ,co2vmr  ,ch4vmr  ,n2ovmr ,o2vmr , &amp;<a name='10230'>
             asdir   ,asdif   ,aldir   ,aldif   , &amp;<a name='10231'>
             coszen  ,adjes   ,dyofyr  ,scon    , &amp;<a name='10232'>
             inflgsw ,iceflgsw,liqflgsw,cld     , &amp;<a name='10233'>
             tauc    ,ssac    ,asmc    ,fsfc    , &amp;<a name='10234'>
             ciwp    ,clwp    ,cswp    ,rei     ,rel    ,res   , &amp;<a name='10235'>
             tauaer  ,ssaaer  ,asmaer  ,ecaer   , &amp;<a name='10236'>
             swuflx  ,swdflx  ,swhr    ,swuflxc ,swdflxc ,swhrc, &amp;<a name='10237'>
             sibvisdir, sibvisdif, sibnirdir, sibnirdif,         &amp;<a name='10238'>
             swdkdir  , swdkdif                                  &amp; <font color=#447700>! jararias, 2013/08/10<a name='10239'></font>
                                )<a name='10240'>
      call cpu_time(t2)<a name='10241'>
      WRITE(message,*)'------------------------------------------------'<a name='10242'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_792">( debug_level_swf, message)<a name='10243'>
      WRITE(message,*)'TOTAL RRTMG_SWF RUN TIME IS   ', t2-t1<a name='10244'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_793">( debug_level_swf, message)<a name='10245'>
      WRITE(message,*)'------------------------------------------------'<a name='10246'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_794">( debug_level_swf, message)<a name='10247'>
                                                      <a name='10248'>
      end subroutine rrtmg_sw                                                     <a name='10249'>
<a name='10250'>
<a name='10251'>
<A NAME='RRTMG_SW_SUB'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='10252'>
      <font color=#993300>subroutine </font><font color=#cc0000>rrtmg_sw_sub</font> &amp; <A href='../../call_to/RRTMG_SW_SUB.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SW_SUB.html' TARGET='index'>46</A><a name='10253'>
            (ncol    ,gncol   ,nlay    ,icld    ,iaer    , &amp;<a name='10254'>
             gplay   ,gplev   ,gtlay   ,gtlev   ,gtsfc   , &amp;<a name='10255'>
             gh2ovmr ,go3vmr  ,gco2vmr ,gch4vmr ,gn2ovmr ,go2vmr , &amp;<a name='10256'>
             gasdir  ,gasdif  ,galdir  ,galdif  , &amp;<a name='10257'>
             gcoszen ,adjes   ,dyofyr  ,scon    , &amp;<a name='10258'>
             inflgsw ,iceflgsw,liqflgsw,gcld    , &amp;<a name='10259'>
             gtauc   ,gssac   ,gasmc   ,gfsfc   , &amp;<a name='10260'>
             gciwp   ,gclwp   ,gcswp   ,grei    ,grel    ,gres   , &amp;<a name='10261'>
             gtauaer ,gssaaer ,gasmaer ,gecaer  , &amp;<a name='10262'>
             swuflx  ,swdflx  ,swhr    ,swuflxc ,swdflxc ,swhrc, &amp;<a name='10263'>
             sibvisdir, sibvisdif, sibnirdir, sibnirdif,         &amp;<a name='10264'>
             swdkdir  , swdkdif                                  &amp; <font color=#447700>! jararias, 2013/08/10<a name='10265'></font>
                                )<a name='10266'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_37">, only : nbndsw, ngptsw, naerec, nstr, nmol, mxmol, &amp;<a name='10267'>
                          jpband, jpb1, jpb2, rrsw_scon<a name='10268'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_AER_F'>rrsw_aer_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_AER_F_3">, only : rsrtaua, rsrpiza, rsrasya<a name='10269'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_CON_F'>rrsw_con_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CON_F_5">, only : heatfac, oneminus, pi,  grav, avogad<a name='10270'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_WVN_F'>rrsw_wvn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_F_8">, only : wavenum1, wavenum2<a name='10271'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_CLD_F'>rrsw_cld_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CLD_F_4">, only : extliq1, ssaliq1, asyliq1, &amp;<a name='10272'>
                           extice2, ssaice2, asyice2, &amp;<a name='10273'>
                           extice3, ssaice3, asyice3, fdlice3, &amp;<a name='10274'>
                           abari, bbari, cbari, dbari, ebari, fbari<a name='10275'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_WVN_F'>rrsw_wvn_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_WVN_F_9">, only : wavenum2, ngb, icxa, nspa, nspb<a name='10276'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_REF_F'>rrsw_ref_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_REF_F_3">, only : preflog, tref<a name='10277'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG16_F'>rrsw_kg16_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG16_F_3">, kao16 =&gt; kao, kbo16 =&gt; kbo, selfrefo16 =&gt; selfrefo, forrefo16 =&gt; forrefo, sfluxrefo16 =&gt; sfluxrefo<a name='10278'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG16_F'>rrsw_kg16_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG16_F_4">, ka16 =&gt; ka, kb16 =&gt; kb, selfref16 =&gt; selfref, forref16 =&gt; forref, sfluxref16 =&gt; sfluxref<a name='10279'>
<a name='10280'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG17_F'>rrsw_kg17_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG17_F_3">, kao17 =&gt; kao, kbo17 =&gt; kbo, selfrefo17 =&gt; selfrefo, forrefo17 =&gt; forrefo, sfluxrefo17 =&gt; sfluxrefo<a name='10281'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG17_F'>rrsw_kg17_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG17_F_4">, ka17 =&gt; ka, kb17 =&gt; kb, selfref17 =&gt; selfref, forref17 =&gt; forref, sfluxref17 =&gt; sfluxref<a name='10282'>
<a name='10283'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG18_F'>rrsw_kg18_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG18_F_3">, kao18 =&gt; kao, kbo18 =&gt; kbo, selfrefo18 =&gt; selfrefo, forrefo18 =&gt; forrefo, sfluxrefo18 =&gt; sfluxrefo<a name='10284'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG18_F'>rrsw_kg18_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG18_F_4">, ka18 =&gt; ka, kb18 =&gt; kb, selfref18 =&gt; selfref, forref18 =&gt; forref, sfluxref18 =&gt; sfluxref<a name='10285'>
<a name='10286'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG19_F'>rrsw_kg19_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG19_F_3">, kao19 =&gt; kao, kbo19 =&gt; kbo, selfrefo19 =&gt; selfrefo, forrefo19 =&gt; forrefo, sfluxrefo19 =&gt; sfluxrefo<a name='10287'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG19_F'>rrsw_kg19_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG19_F_4">, ka19 =&gt; ka, kb19 =&gt; kb, selfref19 =&gt; selfref, forref19 =&gt; forref, sfluxref19 =&gt; sfluxref<a name='10288'>
<a name='10289'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG20_F'>rrsw_kg20_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG20_F_3">, kao20 =&gt; kao, kbo20 =&gt; kbo, selfrefo20 =&gt; selfrefo, forrefo20 =&gt; forrefo, &amp;<a name='10290'>
          sfluxrefo20 =&gt; sfluxrefo, absch4o20 =&gt; absch4o<a name='10291'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG20_F'>rrsw_kg20_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG20_F_4">, ka20 =&gt; ka, kb20 =&gt; kb, selfref20 =&gt; selfref, forref20 =&gt; forref, &amp;<a name='10292'>
          sfluxref20 =&gt; sfluxref, absch420 =&gt; absch4<a name='10293'>
<a name='10294'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG21_F'>rrsw_kg21_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG21_F_3">, kao21 =&gt; kao, kbo21 =&gt; kbo, selfrefo21 =&gt; selfrefo, forrefo21 =&gt; forrefo, sfluxrefo21 =&gt; sfluxrefo<a name='10295'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG21_F'>rrsw_kg21_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG21_F_4">, ka21 =&gt; ka, kb21 =&gt; kb, selfref21 =&gt; selfref, forref21 =&gt; forref, sfluxref21 =&gt; sfluxref<a name='10296'>
<a name='10297'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG22_F'>rrsw_kg22_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG22_F_3">, kao22 =&gt; kao, kbo22 =&gt; kbo, selfrefo22 =&gt; selfrefo, forrefo22 =&gt; forrefo, sfluxrefo22 =&gt; sfluxrefo<a name='10298'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG22_F'>rrsw_kg22_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG22_F_4">, ka22 =&gt; ka, kb22 =&gt; kb, selfref22 =&gt; selfref, forref22 =&gt; forref, sfluxref22 =&gt; sfluxref<a name='10299'>
<a name='10300'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG23_F'>rrsw_kg23_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG23_F_3">, kao23 =&gt; kao, selfrefo23 =&gt; selfrefo, forrefo23 =&gt; forrefo, sfluxrefo23 =&gt; sfluxrefo, raylo23 =&gt; raylo<a name='10301'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG23_F'>rrsw_kg23_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG23_F_4">, ka23 =&gt; ka, selfref23 =&gt; selfref, forref23 =&gt; forref, sfluxref23 =&gt; sfluxref, rayl23 =&gt; rayl<a name='10302'>
<a name='10303'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG24_F'>rrsw_kg24_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG24_F_3">, kao24 =&gt; kao, kbo24 =&gt; kbo, selfrefo24 =&gt; selfrefo, forrefo24 =&gt; forrefo, sfluxrefo24 =&gt; sfluxrefo<a name='10304'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG24_F'>rrsw_kg24_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG24_F_4">, abso3ao24 =&gt; abso3ao, abso3bo24 =&gt; abso3bo, raylao24 =&gt; raylao, raylbo24 =&gt; raylbo<a name='10305'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG24_F'>rrsw_kg24_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG24_F_5">, ka24 =&gt; ka, kb24 =&gt; kb, selfref24 =&gt; selfref, forref24 =&gt; forref, sfluxref24 =&gt; sfluxref<a name='10306'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG24_F'>rrsw_kg24_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG24_F_6">, abso3a24 =&gt; abso3a, abso3b24 =&gt; abso3b, rayla24 =&gt; rayla, raylb24 =&gt; raylb<a name='10307'>
<a name='10308'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG25_F'>rrsw_kg25_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG25_F_3">, kao25 =&gt; kao, sfluxrefo25=&gt;sfluxrefo<a name='10309'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG25_F'>rrsw_kg25_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG25_F_4">, abso3ao25 =&gt; abso3ao, abso3bo25 =&gt; abso3bo, raylo25 =&gt; raylo<a name='10310'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG25_F'>rrsw_kg25_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG25_F_5">, ka25 =&gt; ka, sfluxref25=&gt;sfluxref<a name='10311'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG25_F'>rrsw_kg25_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG25_F_6">, abso3a25 =&gt; abso3a, abso3b25 =&gt; abso3b, rayl25 =&gt; rayl<a name='10312'>
     <a name='10313'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG26_F'>rrsw_kg26_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG26_F_3">, sfluxrefo26 =&gt; sfluxrefo<a name='10314'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG26_F'>rrsw_kg26_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG26_F_4">, sfluxref26 =&gt; sfluxref<a name='10315'>
<a name='10316'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG27_F'>rrsw_kg27_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG27_F_3">, kao27 =&gt; kao, kbo27 =&gt; kbo, sfluxrefo27 =&gt; sfluxrefo, rayl27=&gt;rayl<a name='10317'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG27_F'>rrsw_kg27_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG27_F_4">, ka27 =&gt; ka, kb27 =&gt; kb, sfluxref27 =&gt; sfluxref, raylo27=&gt;raylo<a name='10318'>
<a name='10319'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG28_F'>rrsw_kg28_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG28_F_3">, kao28 =&gt; kao, kbo28 =&gt; kbo, sfluxrefo28 =&gt; sfluxrefo<a name='10320'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG28_F'>rrsw_kg28_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG28_F_4">, ka28 =&gt; ka, kb28 =&gt; kb, sfluxref28 =&gt; sfluxref<a name='10321'>
<a name='10322'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG29_F'>rrsw_kg29_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG29_F_3">, kao29 =&gt; kao, kbo29 =&gt; kbo, selfrefo29 =&gt; selfrefo, forrefo29 =&gt; forrefo, sfluxrefo29 =&gt; sfluxrefo<a name='10323'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG29_F'>rrsw_kg29_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG29_F_4">, absh2oo29 =&gt; absh2oo, absco2o29 =&gt; absco2o<a name='10324'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG29_F'>rrsw_kg29_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG29_F_5">, ka29 =&gt; ka, kb29 =&gt; kb, selfref29 =&gt; selfref, forref29 =&gt; forref, sfluxref29 =&gt; sfluxref<a name='10325'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG29_F'>rrsw_kg29_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG29_F_6">, absh2o29 =&gt; absh2o, absco229 =&gt; absco2<a name='10326'>
<a name='10327'>
<font color=#447700>! ------- Declarations<a name='10328'></font>
<a name='10329'>
      integer , intent(in) :: ncol<a name='10330'>
      integer , intent(in) :: gncol                   <font color=#447700>! Number of horizontal columns     <a name='10331'></font>
      integer , intent(in) :: nlay                    <font color=#447700>! Number of model layers<a name='10332'></font>
      integer , intent(inout) :: icld                 <font color=#447700>! Cloud overlap method<a name='10333'></font>
                                                      <font color=#447700>!    0: Clear only<a name='10334'></font>
                                                      <font color=#447700>!    1: Random<a name='10335'></font>
                                                      <font color=#447700>!    2: Maximum/random<a name='10336'></font>
                                                      <font color=#447700>!    3: Maximum<a name='10337'></font>
      integer , intent(in) :: iaer<a name='10338'>
      integer , intent(in) :: dyofyr                  <font color=#447700>! Day of the year (used to get Earth/Sun<a name='10339'></font>
                                                      <font color=#447700>!  distance if adjflx not provided)                                                      <a name='10340'></font>
      real , intent(in) :: adjes                      <font color=#447700>! Flux adjustment for Earth/Sun distance<a name='10341'></font>
      real , intent(in) :: scon                       <font color=#447700>! Solar constant (W/m2)<a name='10342'></font>
<a name='10343'>
      integer , intent(in) :: inflgsw                 <font color=#447700>! Flag for cloud optical properties<a name='10344'></font>
      integer , intent(in) :: iceflgsw                <font color=#447700>! Flag for ice particle specification<a name='10345'></font>
      integer , intent(in) :: liqflgsw                <font color=#447700>! Flag for liquid droplet specification<a name='10346'></font>
      <a name='10347'>
      real , intent(in) :: gcld(gncol, nlay)          <font color=#447700>! Cloud fraction<a name='10348'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10349'></font>
      real , intent(in) :: gtauc(gncol,nlay,nbndsw)   <font color=#447700>! In-cloud optical depth<a name='10350'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='10351'></font>
      real , intent(in) :: gssac(gncol,nlay,nbndsw)   <font color=#447700>! In-cloud single scattering albedo<a name='10352'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='10353'></font>
      real , intent(in) :: gasmc(gncol,nlay,nbndsw)   <font color=#447700>! In-cloud asymmetry parameter<a name='10354'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='10355'></font>
      real , intent(in) :: gfsfc(gncol,nlay,nbndsw)   <font color=#447700>! In-cloud forward scattering fraction<a name='10356'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='10357'></font>
      real , intent(in) :: gciwp(gncol, nlay)         <font color=#447700>! In-cloud ice water path (g/m2)<a name='10358'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10359'></font>
      real , intent(in) :: gclwp(gncol, nlay)         <font color=#447700>! In-cloud liquid water path (g/m2)<a name='10360'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10361'></font>
      real , intent(in) :: gcswp(gncol, nlay)         <font color=#447700>! In-cloud snow water path (g/m2)<a name='10362'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10363'></font>
                                                      <a name='10364'>
      real , intent(in) :: grei(gncol, nlay)          <font color=#447700>! Cloud ice effective radius (microns)<a name='10365'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10366'></font>
      real , intent(in) :: grel(gncol, nlay)          <font color=#447700>! Cloud water drop effective radius (microns)<a name='10367'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10368'></font>
      real , intent(in) :: gres(gncol, nlay)          <font color=#447700>! Cloud snow drop effective radius (microns)<a name='10369'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10370'></font>
                                                      <a name='10371'>
      <a name='10372'>
      real , intent(in) :: gplay(gncol,nlay)          <font color=#447700>! Layer pressures (hPa, mb)<a name='10373'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10374'></font>
      real , intent(in) :: gplev(gncol,nlay+1)        <font color=#447700>! Interface pressures (hPa, mb)<a name='10375'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10376'></font>
      real , intent(in) :: gtlay(gncol,nlay)          <font color=#447700>! Layer temperatures (K)<a name='10377'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10378'></font>
      real , intent(in) :: gtlev(gncol,nlay+1)        <font color=#447700>! Interface temperatures (K)<a name='10379'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10380'></font>
      real , intent(in) :: gtsfc(gncol)               <font color=#447700>! Surface temperature (K)<a name='10381'></font>
                                                      <font color=#447700>!    Dimensions: (ncol)<a name='10382'></font>
      real , intent(in) :: gh2ovmr(gncol,nlay)        <font color=#447700>! H2O volume mixing ratio<a name='10383'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10384'></font>
      real , intent(in) :: go3vmr(gncol,nlay)         <font color=#447700>! O3 volume mixing ratio<a name='10385'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10386'></font>
      real , intent(in) :: gco2vmr(gncol,nlay)        <font color=#447700>! CO2 volume mixing ratio<a name='10387'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10388'></font>
      real , intent(in) :: gch4vmr(gncol,nlay)        <font color=#447700>! Methane volume mixing ratio<a name='10389'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10390'></font>
      real , intent(in) :: gn2ovmr(gncol,nlay)        <font color=#447700>! Nitrous oxide volume mixing ratio<a name='10391'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10392'></font>
      real , intent(in) :: go2vmr(gncol,nlay)         <font color=#447700>! Oxygen volume mixing ratio<a name='10393'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10394'></font>
      real , intent(in) :: gasdir(gncol)              <font color=#447700>! UV/vis surface albedo direct rad<a name='10395'></font>
                                                      <font color=#447700>!    Dimensions: (ncol)<a name='10396'></font>
      real , intent(in) :: galdir(gncol)              <font color=#447700>! Near-IR surface albedo direct rad<a name='10397'></font>
                                                      <font color=#447700>!    Dimensions: (ncol)<a name='10398'></font>
      real , intent(in) :: gasdif(gncol)              <font color=#447700>! UV/vis surface albedo: diffuse rad<a name='10399'></font>
                                                      <font color=#447700>!    Dimensions: (ncol)<a name='10400'></font>
      real , intent(in) :: galdif(gncol)              <font color=#447700>! Near-IR surface albedo: diffuse rad<a name='10401'></font>
                                                      <font color=#447700>!    Dimensions: (ncol)<a name='10402'></font>
<a name='10403'>
      <a name='10404'>
      real , intent(in) :: gcoszen(gncol)             <font color=#447700>! Cosine of solar zenith angle<a name='10405'></font>
                                                      <font color=#447700>!    Dimensions: (ncol)<a name='10406'></font>
    <a name='10407'>
      real , intent(in) :: gtauaer(gncol,nlay,nbndsw) <font color=#447700>! Aerosol optical depth (iaer=10 only)<a name='10408'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='10409'></font>
                                                      <font color=#447700>! (non-delta scaled)      <a name='10410'></font>
      real , intent(in) :: gssaaer(gncol,nlay,nbndsw) <font color=#447700>! Aerosol single scattering albedo (iaer=10 only)<a name='10411'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='10412'></font>
                                                      <font color=#447700>! (non-delta scaled)      <a name='10413'></font>
      real , intent(in) :: gasmaer(gncol,nlay,nbndsw) <font color=#447700>! Aerosol asymmetry parameter (iaer=10 only)<a name='10414'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,nbndsw)<a name='10415'></font>
                                                      <font color=#447700>! (non-delta scaled)      <a name='10416'></font>
      real , intent(in) :: gecaer(:,:,:)              <font color=#447700>! Aerosol optical depth at 0.55 micron (iaer=6 only)<a name='10417'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay,naerec)<a name='10418'></font>
                                                      <font color=#447700>! (non-delta scaled)      <a name='10419'></font>
<font color=#447700>!      integer , intent(in) :: normFlx                 ! Normalize fluxes flag<a name='10420'></font>
                                                       <font color=#447700>! 0 = no normalization<a name='10421'></font>
                                                       <font color=#447700>! 1 = normalize fluxes ( / (scon * coszen) )<a name='10422'></font>
<a name='10423'>
<font color=#447700>! ----- Output -----<a name='10424'></font>
<a name='10425'>
      real , intent(out) :: swuflx(:,:)               <font color=#447700>! Total sky shortwave upward flux (W/m2)<a name='10426'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10427'></font>
      real , intent(out) :: swdflx(:,:)               <font color=#447700>! Total sky shortwave downward flux (W/m2)<a name='10428'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10429'></font>
      real , intent(out) :: swhr(:,:)                 <font color=#447700>! Total sky shortwave radiative heating rate (K/d)<a name='10430'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10431'></font>
      real , intent(out) :: swuflxc(:,:)              <font color=#447700>! Clear sky shortwave upward flux (W/m2)<a name='10432'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10433'></font>
      real , intent(out) :: swdflxc(:,:)              <font color=#447700>! Clear sky shortwave downward flux (W/m2)<a name='10434'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10435'></font>
      real , intent(out) :: swhrc(:,:)                <font color=#447700>! Clear sky shortwave radiative heating rate (K/d)<a name='10436'></font>
                                                      <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10437'></font>
<a name='10438'>
      real, intent(out) :: sibvisdir(:,:)              <font color=#447700>! visible direct downward flux  (W/m2)<a name='10439'></font>
                                                       <font color=#447700>!    Dimensions: (ncol,nlay+1) Zhenxin (2011/06/20)<a name='10440'></font>
      real, intent(out) :: sibvisdif(:,:)              <font color=#447700>! visible diffusion downward flux  (W/m2)<a name='10441'></font>
                                                       <font color=#447700>!    Dimensions: (ncol,nlay+1) Zhenxin (2011/06/20)<a name='10442'></font>
      real, intent(out) :: sibnirdir(:,:)              <font color=#447700>! Near IR direct downward flux  (W/m2)<a name='10443'></font>
                                                       <font color=#447700>!    Dimensions: (ncol,nlay+1)  Zhenxin (2011/06/20)<a name='10444'></font>
      real, intent(out) :: sibnirdif(:,:)              <font color=#447700>! Near IR diffusion downward flux  (W/m2)<a name='10445'></font>
                                                       <font color=#447700>!    Dimensions: (ncol,nlay+1) Zhenxin (2011/06/20)<a name='10446'></font>
      real, intent(out) :: swdkdir(:,:)                <font color=#447700>! Total shortwave downward direct flux (W/m2)<a name='10447'></font>
                                                       <font color=#447700>!    Dimensions: (ncol,nlay+1) jararias, 2013/08/10<a name='10448'></font>
      real, intent(out) :: swdkdif(:,:)                <font color=#447700>! Total shortwave downward diffuse flux (W/m2)<a name='10449'></font>
                                                       <font color=#447700>!    Dimensions: (ncol,nlay+1) jararias, 2013/08/10<a name='10450'></font>
<a name='10451'>
<font color=#447700>! ----- Local -----<a name='10452'></font>
<a name='10453'>
<font color=#447700>! Control<a name='10454'></font>
     <a name='10455'>
      integer  :: istart                      <font color=#447700>! beginning band of calculation<a name='10456'></font>
      integer  :: iend                        <font color=#447700>! ending band of calculation<a name='10457'></font>
      integer  :: icpr                        <font color=#447700>! cldprop/cldprmc use flag<a name='10458'></font>
      integer  :: iout                        <font color=#447700>! output option flag<a name='10459'></font>
  <a name='10460'>
      integer  :: idelm                       <font color=#447700>! delta-m scaling flag<a name='10461'></font>
                                              <font color=#447700>! [0 = direct and diffuse fluxes are unscaled]<a name='10462'></font>
                                              <font color=#447700>! [1 = direct and diffuse fluxes are scaled]<a name='10463'></font>
                                              <font color=#447700>! (total downward fluxes are always delta scaled)<a name='10464'></font>
      integer  :: isccos                      <font color=#447700>! instrumental cosine response flag (inactive)<a name='10465'></font>
      integer  :: iplon                       <font color=#447700>! column loop index<a name='10466'></font>
      integer  :: i                           <font color=#447700>! layer loop index                       ! jk<a name='10467'></font>
      integer  :: ib                          <font color=#447700>! band loop index                        ! jsw<a name='10468'></font>
      integer  :: ia, ig                      <font color=#447700>! indices<a name='10469'></font>
      integer  :: k                           <font color=#447700>! layer loop index<a name='10470'></font>
      integer  :: ims                         <font color=#447700>! value for changing mcica permute seed<a name='10471'></font>
      integer  :: imca                        <font color=#447700>! flag for mcica [0=off, 1=on]<a name='10472'></font>
<a name='10473'>
      real  :: zepsec, zepzen                 <font color=#447700>! epsilon<a name='10474'></font>
      real  :: zdpgcp                         <font color=#447700>! flux to heating conversion ratio<a name='10475'></font>
<a name='10476'>
#ifndef _ACCEL<a name='10477'>
# define ncol CHNK<a name='10478'>
#endif<a name='10479'>
<a name='10480'>
<font color=#447700>! Atmosphere<a name='10481'></font>
<a name='10482'>
      real  :: coldry(ncol,nlay+1)            <font color=#447700>! dry air column amount<a name='10483'></font>
      real  :: wkl(ncol,mxmol,nlay)           <font color=#447700>! molecular amounts (mol/cm-2)<a name='10484'></font>
<a name='10485'>
      real  :: cossza(ncol)                   <font color=#447700>! Cosine of solar zenith angle<a name='10486'></font>
      real  :: adjflux(jpband)                <font color=#447700>! adjustment for current Earth/Sun distance<a name='10487'></font>
      <a name='10488'>
                                              <font color=#447700>!  default value of 1368.22 Wm-2 at 1 AU<a name='10489'></font>
      real  :: albdir(ncol,nbndsw)            <font color=#447700>! surface albedo, direct          ! zalbp<a name='10490'></font>
      real  :: albdif(ncol,nbndsw)            <font color=#447700>! surface albedo, diffuse         ! zalbd<a name='10491'></font>
      <a name='10492'>
<font color=#447700>!      real  :: rdl(ncol), adl(ncol)<a name='10493'></font>
<a name='10494'>
<font color=#447700>! Atmosphere - setcoef<a name='10495'></font>
      integer  :: laytrop(ncol)               <font color=#447700>! tropopause layer index<a name='10496'></font>
      integer  :: layswtch(ncol)              <font color=#447700>! tropopause layer index<a name='10497'></font>
      integer  :: laylow(ncol)                <font color=#447700>! tropopause layer index<a name='10498'></font>
      integer  :: jp(ncol,nlay+1)             <font color=#447700>! <a name='10499'></font>
      integer  :: jt(ncol,nlay+1)             <font color=#447700>!<a name='10500'></font>
      integer  :: jt1(ncol,nlay+1)            <font color=#447700>!<a name='10501'></font>
<a name='10502'>
      real  :: colh2o(ncol,nlay+1)            <font color=#447700>! column amount (h2o)<a name='10503'></font>
      real  :: colco2(ncol,nlay+1)            <font color=#447700>! column amount (co2)<a name='10504'></font>
      real  :: colo3(ncol,nlay+1)             <font color=#447700>! column amount (o3)<a name='10505'></font>
      real  :: coln2o(ncol,nlay+1)            <font color=#447700>! column amount (n2o)<a name='10506'></font>
      real  :: colch4(ncol,nlay+1)            <font color=#447700>! column amount (ch4)<a name='10507'></font>
      real  :: colo2(ncol,nlay+1)             <font color=#447700>! column amount (o2)<a name='10508'></font>
      real  :: colmol(ncol,nlay+1)            <font color=#447700>! column amount<a name='10509'></font>
      real  :: co2mult(ncol,nlay+1)           <font color=#447700>! column amount <a name='10510'></font>
<a name='10511'>
      integer  :: indself(ncol,nlay+1) <a name='10512'>
      integer  :: indfor(ncol,nlay+1) <a name='10513'>
      real  :: selffac(ncol,nlay+1) <a name='10514'>
      real  :: selffrac(ncol,nlay+1) <a name='10515'>
      real  :: forfac(ncol,nlay+1) <a name='10516'>
      real  :: forfrac(ncol,nlay+1) <a name='10517'>
<a name='10518'>
      real  :: &amp;                              <font color=#447700>!<a name='10519'></font>
                         fac00(ncol,nlay+1) , fac01(ncol,nlay+1) , &amp;<a name='10520'>
                         fac10(ncol,nlay+1) , fac11(ncol,nlay+1)  <a name='10521'>
      <a name='10522'>
      real :: play(ncol,nlay)                 <font color=#447700>! Layer pressures (hPa, mb)<a name='10523'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10524'></font>
      real :: plev(ncol,nlay+1)               <font color=#447700>! Interface pressures (hPa, mb)<a name='10525'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10526'></font>
      real :: tlay(ncol,nlay)                 <font color=#447700>! Layer temperatures (K)<a name='10527'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay)<a name='10528'></font>
      real :: tlev(ncol,nlay+1)               <font color=#447700>! Interface temperatures (K)<a name='10529'></font>
                                              <font color=#447700>!    Dimensions: (ncol,nlay+1)<a name='10530'></font>
      real :: tsfc(ncol)                      <font color=#447700>! Surface temperature (K)<a name='10531'></font>
                                              <font color=#447700>!    Dimensions: (ncol)<a name='10532'></font>
      real :: coszen(ncol)   <a name='10533'>
<a name='10534'>
<font color=#447700>! Atmosphere/clouds - cldprop<a name='10535'></font>
      integer  :: ncbands                     <font color=#447700>! number of cloud spectral bands<a name='10536'></font>
<a name='10537'>
      real   :: cld(ncol,nlay)                <font color=#447700>! Cloud fraction<a name='10538'></font>
      real   :: tauc(ncol,nlay,nbndsw)        <font color=#447700>! In-cloud optical depth<a name='10539'></font>
      real   :: ssac(ncol,nlay,nbndsw)        <font color=#447700>! In-cloud single scattering <a name='10540'></font>
      real   :: asmc(ncol,nlay,nbndsw)        <font color=#447700>! In-cloud asymmetry parameter<a name='10541'></font>
      real   :: fsfc(ncol,nlay,nbndsw)        <font color=#447700>! In-cloud forward scattering fraction<a name='10542'></font>
      real   :: ciwp(ncol,nlay)               <font color=#447700>! In-cloud ice water path (g/m2)<a name='10543'></font>
      real   :: clwp(ncol,nlay)               <font color=#447700>! In-cloud liquid water path (g/m2)<a name='10544'></font>
      real   :: cswp(ncol,nlay)               <font color=#447700>! In-cloud snow water path (g/m2)<a name='10545'></font>
      real   :: rei(ncol,nlay)                <font color=#447700>! Cloud ice effective radius (microns)<a name='10546'></font>
      real   :: rel(ncol,nlay)                <font color=#447700>! Cloud water drop effective radius (microns)<a name='10547'></font>
      real   :: res(ncol,nlay)                <font color=#447700>! Cloud snow effective radius (microns)<a name='10548'></font>
      <a name='10549'>
      real  :: taucmc(ncol,nlay+1,ngptsw)     <font color=#447700>! in-cloud optical depth [mcica]<a name='10550'></font>
      real  :: taormc(ncol,nlay+1,ngptsw)     <font color=#447700>! unscaled in-cloud optical depth [mcica]<a name='10551'></font>
      real  :: ssacmc(ncol,nlay+1,ngptsw)     <font color=#447700>! in-cloud single scattering albedo [mcica]<a name='10552'></font>
      real  :: asmcmc(ncol,nlay+1,ngptsw)     <font color=#447700>! in-cloud asymmetry parameter [mcica]<a name='10553'></font>
      real  :: fsfcmc(ncol,nlay+1,ngptsw)     <font color=#447700>! in-cloud forward scattering fraction [mcica]<a name='10554'></font>
      <a name='10555'>
      real :: cldfmcl(ncol,nlay+1,ngptsw)     <font color=#447700>! cloud fraction [mcica]<a name='10556'></font>
      real :: ciwpmcl(ncol,nlay+1,ngptsw)     <font color=#447700>! in-cloud ice water path [mcica]<a name='10557'></font>
      real :: clwpmcl(ncol,nlay+1,ngptsw)     <font color=#447700>! in-cloud liquid water path [mcica]<a name='10558'></font>
      real :: cswpmcl(ncol,nlay+1,ngptsw)     <font color=#447700>! in-cloud liquid water path [mcica]<a name='10559'></font>
                                                     <a name='10560'>
<font color=#447700>! Atmosphere/clouds/aerosol - spcvrt,spcvmc<a name='10561'></font>
      real  :: ztauc(ncol,nlay+1,nbndsw)      <font color=#447700>! cloud optical depth<a name='10562'></font>
      real  :: ztaucorig(ncol,nlay+1,nbndsw)  <font color=#447700>! unscaled cloud optical depth<a name='10563'></font>
      real  :: zasyc(ncol,nlay+1,nbndsw)      <font color=#447700>! cloud asymmetry parameter <a name='10564'></font>
                                              <font color=#447700>!  (first moment of phase function)<a name='10565'></font>
      real  :: zomgc(ncol,nlay+1,nbndsw)      <font color=#447700>! cloud single scattering albedo<a name='10566'></font>
   <a name='10567'>
      real  :: taua(ncol, nlay+1, nbndsw)<a name='10568'>
      real  :: asya(ncol, nlay+1, nbndsw)<a name='10569'>
      real  :: omga(ncol, nlay+1, nbndsw)<a name='10570'>
   <a name='10571'>
      real  :: zbbfu(ncol,nlay+2)             <font color=#447700>! temporary upward shortwave flux (w/m2)<a name='10572'></font>
      real  :: zbbfd(ncol,nlay+2)             <font color=#447700>! temporary downward shortwave flux (w/m2)<a name='10573'></font>
      real  :: zbbcu(ncol,nlay+2)             <font color=#447700>! temporary clear sky upward shortwave flux (w/m2)<a name='10574'></font>
      real  :: zbbcd(ncol,nlay+2)             <font color=#447700>! temporary clear sky downward shortwave flux (w/m2)<a name='10575'></font>
      real  :: zbbfddir(ncol,nlay+2)          <font color=#447700>! temporary downward direct shortwave flux (w/m2)<a name='10576'></font>
      real  :: zbbcddir(ncol,nlay+2)          <font color=#447700>! temporary clear sky downward direct shortwave flux (w/m2)<a name='10577'></font>
      real  :: zuvfd(ncol,nlay+2)             <font color=#447700>! temporary UV downward shortwave flux (w/m2)<a name='10578'></font>
      real  :: zuvcd(ncol,nlay+2)             <font color=#447700>! temporary clear sky UV downward shortwave flux (w/m2)<a name='10579'></font>
      real  :: zuvfddir(ncol,nlay+2)          <font color=#447700>! temporary UV downward direct shortwave flux (w/m2)<a name='10580'></font>
      real  :: zuvcddir(ncol,nlay+2)          <font color=#447700>! temporary clear sky UV downward direct shortwave flux (w/m2)<a name='10581'></font>
      real  :: znifd(ncol,nlay+2)             <font color=#447700>! temporary near-IR downward shortwave flux (w/m2)<a name='10582'></font>
      real  :: znicd(ncol,nlay+2)             <font color=#447700>! temporary clear sky near-IR downward shortwave flux (w/m2)<a name='10583'></font>
      real  :: znifddir(ncol,nlay+2)          <font color=#447700>! temporary near-IR downward direct shortwave flux (w/m2)<a name='10584'></font>
      real  :: znicddir(ncol,nlay+2)          <font color=#447700>! temporary clear sky near-IR downward direct shortwave flux (w/m2)<a name='10585'></font>
<a name='10586'>
<font color=#447700>! Optional output fields <a name='10587'></font>
      real  :: swnflx(ncol,nlay+2)            <font color=#447700>! Total sky shortwave net flux (W/m2)<a name='10588'></font>
      real  :: swnflxc(ncol,nlay+2)           <font color=#447700>! Clear sky shortwave net flux (W/m2)<a name='10589'></font>
      real  :: dirdflux(ncol,nlay+2)          <font color=#447700>! Direct downward shortwave surface flux<a name='10590'></font>
      real  :: difdflux(ncol,nlay+2)          <font color=#447700>! Diffuse downward shortwave surface flux<a name='10591'></font>
      real  :: uvdflx(ncol,nlay+2)            <font color=#447700>! Total sky downward shortwave flux, UV/vis  <a name='10592'></font>
      real  :: nidflx(ncol,nlay+2)            <font color=#447700>! Total sky downward shortwave flux, near-IR <a name='10593'></font>
      real  :: dirdnuv(ncol,nlay+2)           <font color=#447700>! Direct downward shortwave flux, UV/vis<a name='10594'></font>
      real  :: difdnuv(ncol,nlay+2)           <font color=#447700>! Diffuse downward shortwave flux, UV/vis<a name='10595'></font>
      real  :: dirdnir(ncol,nlay+2)           <font color=#447700>! Direct downward shortwave flux, near-IR<a name='10596'></font>
      real  :: difdnir(ncol,nlay+2)           <font color=#447700>! Diffuse downward shortwave flux, near-IR<a name='10597'></font>
      <a name='10598'>
      real gpu_device :: zgco(ncol,ngptsw,nlay+1)  , zomco(ncol,ngptsw,nlay+1)  <a name='10599'>
      real gpu_device :: zrdnd(ncol,ngptsw,nlay+1) <a name='10600'>
      real gpu_device :: zref(ncol,ngptsw,nlay+1)  , zrefo(ncol,ngptsw,nlay+1)  <a name='10601'>
      real gpu_device :: zrefd(ncol,ngptsw,nlay+1) , zrefdo(ncol,ngptsw,nlay+1)  <a name='10602'>
      real gpu_device :: ztauo(ncol,ngptsw,nlay)  <a name='10603'>
      real gpu_device :: zdbt(ncol,ngptsw,nlay+1)  , ztdbt(ncol,ngptsw,nlay+1)   <a name='10604'>
      real gpu_device :: ztra(ncol,ngptsw,nlay+1)  , ztrao(ncol,ngptsw,nlay+1)  <a name='10605'>
      real gpu_device :: ztrad(ncol,ngptsw,nlay+1) , ztrado(ncol,ngptsw,nlay+1)  <a name='10606'>
      real gpu_device :: zfd(ncol,ngptsw,nlay+1)   , zfu(ncol,ngptsw,nlay+1)  <a name='10607'>
      real gpu_device :: zsflxzen(ncol,ngptsw)<a name='10608'>
      real gpu_device :: ztaur(ncol,nlay,ngptsw)   , ztaug(ncol,nlay,ngptsw) <a name='10609'>
#ifndef _ACCEL<a name='10610'>
# undef ncol<a name='10611'>
#endif<a name='10612'>
<a name='10613'>
      integer :: npartc, npart, npartb, cldflag(gncol), profic(gncol), profi(gncol)<a name='10614'>
<a name='10615'>
      real , parameter :: amd = 28.9660       <font color=#447700>! Effective molecular weight of dry air (g/mol)<a name='10616'></font>
      real , parameter :: amw = 18.0160       <font color=#447700>! Molecular weight of water vapor (g/mol)<a name='10617'></font>
<a name='10618'>
<font color=#447700>! Set molecular weight ratios (for converting mmr to vmr)<a name='10619'></font>
<font color=#447700>!  e.g. h2ovmr = h2ommr * amdw)<a name='10620'></font>
      real , parameter :: amdw = 1.607793   <font color=#447700>! Molecular weight of dry air / water vapor<a name='10621'></font>
      real , parameter :: amdc = 0.658114   <font color=#447700>! Molecular weight of dry air / carbon dioxide<a name='10622'></font>
      real , parameter :: amdo = 0.603428   <font color=#447700>! Molecular weight of dry air / ozone<a name='10623'></font>
      real , parameter :: amdm = 1.805423   <font color=#447700>! Molecular weight of dry air / methane<a name='10624'></font>
      real , parameter :: amdn = 0.658090   <font color=#447700>! Molecular weight of dry air / nitrous oxide<a name='10625'></font>
      real , parameter :: amdo2 = 0.905140  <font color=#447700>! Molecular weight of dry air / oxygen<a name='10626'></font>
<a name='10627'>
      real , parameter :: sbc = 5.67e-08    <font color=#447700>! Stefan-Boltzmann constant (W/m2K4)<a name='10628'></font>
      integer ii,jj,kk,iw<a name='10629'>
      integer  :: isp, l, ix, n, imol  <font color=#447700>! Loop indices<a name='10630'></font>
      real  :: amm, summol                      <font color=#447700>! <a name='10631'></font>
      real  :: adjflx                           <font color=#447700>! flux adjustment for Earth/Sun distance<a name='10632'></font>
      integer :: prt<a name='10633'>
      integer :: piplon<a name='10634'>
      <a name='10635'>
      integer :: ipart, cols, cole, colr, ncolc, ncolb<a name='10636'>
      integer :: irng, cc, ncolst<a name='10637'>
<a name='10638'>
<font color=#447700>! Initializations<a name='10639'></font>
      <a name='10640'>
      zepsec = 1.e-06 <a name='10641'>
      zepzen = 1.e-10 <a name='10642'>
      oneminus = 1.0  - zepsec<a name='10643'>
      pi = 2.  * asin(1. )<a name='10644'>
      irng = 0<a name='10645'>
<a name='10646'>
      istart = jpb1<a name='10647'>
      iend = jpb2<a name='10648'>
      iout = 0<a name='10649'>
      icpr = 1<a name='10650'>
      ims = 2<a name='10651'>
      <a name='10652'>
      adjflx = adjes<a name='10653'>
      if (dyofyr .gt. 0) then<a name='10654'>
         adjflx = <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#EARTH_SUN'>earth_sun</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EARTH_SUN_2">(dyofyr)<a name='10655'>
      endif<a name='10656'>
  <a name='10657'>
      do ib = jpb1, jpb2<a name='10658'>
         adjflux(ib) = adjflx * scon / rrsw_scon<a name='10659'>
      end do<a name='10660'>
<a name='10661'>
      if (icld.lt.0.or.icld.gt.3) icld = 2<a name='10662'>
    <a name='10663'>
      <a name='10664'>
<font color=#447700>! determine cloud profile<a name='10665'></font>
      cldflag=0<a name='10666'>
      do iplon = 1, gncol<a name='10667'>
        if (any(gcld(iplon,:) &gt; 0)) cldflag(iplon)=1<a name='10668'>
      end do<a name='10669'>
<a name='10670'>
<a name='10671'>
<font color=#447700>! build profile separation<a name='10672'></font>
      cols = 0<a name='10673'>
      cole = 0<a name='10674'>
<a name='10675'>
      do iplon = 1, gncol<a name='10676'>
        if (cldflag(iplon)==1) then<a name='10677'>
            cole=cole+1<a name='10678'>
            profi(cole) = iplon<a name='10679'>
        else<a name='10680'>
            cols=cols+1<a name='10681'>
            profic(cols) = iplon<a name='10682'>
        end if<a name='10683'>
      end do<a name='10684'>
        <a name='10685'>
<a name='10686'>
<font color=#447700>!$acc data copyout(swuflxc, swdflxc, swuflx, swdflx, swnflxc, swnflx, swhrc, swhr) &amp;<a name='10687'></font>
<font color=#447700>!$acc create(laytrop, layswtch, laylow, jp, jt, jt1, &amp;<a name='10688'></font>
<font color=#447700>!$acc co2mult, colch4, colco2, colh2o, colmol, coln2o, &amp;<a name='10689'></font>
<font color=#447700>!$acc colo2, colo3, fac00, fac01, fac10, fac11, &amp;<a name='10690'></font>
<font color=#447700>!$acc selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='10691'></font>
<font color=#447700>!$acc zbbfu, zbbfd, zbbcu, zbbcd,zbbfddir, zbbcddir, zuvfd, zuvcd, zuvfddir, &amp;<a name='10692'></font>
<font color=#447700>!$acc zuvcddir, znifd, znicd, znifddir,znicddir, &amp;<a name='10693'></font>
<font color=#447700>!$acc cldfmcl, ciwpmcl, clwpmcl, cswpmcl, &amp;<a name='10694'></font>
<font color=#447700>!$acc taormc, taucmc, ssacmc, asmcmc, fsfcmc) &amp;<a name='10695'></font>
<font color=#447700>!$acc deviceptr(zref,zrefo,zrefd,zrefdo,&amp;<a name='10696'></font>
<font color=#447700>!$acc ztauo,ztdbt,&amp;<a name='10697'></font>
<font color=#447700>!$acc ztra,ztrao,ztrad,ztrado,&amp;<a name='10698'></font>
<font color=#447700>!$acc zfd,zfu,zdbt,zgco,&amp;<a name='10699'></font>
<font color=#447700>!$acc zomco,zrdnd,ztaug, ztaur,zsflxzen)&amp;<a name='10700'></font>
<font color=#447700>!$acc create(ciwp, clwp, cswp, cld, tauc, ssac, asmc, fsfc, rei, rel, res) &amp;<a name='10701'></font>
<font color=#447700>!$acc create(play, tlay, plev, tlev, tsfc, cldflag, coszen) &amp;<a name='10702'></font>
<font color=#447700>!$acc create(coldry, wkl) &amp;<a name='10703'></font>
<font color=#447700>!$acc create(extliq1, ssaliq1, asyliq1, extice2, ssaice2, asyice2) &amp;<a name='10704'></font>
<font color=#447700>!$acc create(extice3, ssaice3, asyice3, fdlice3, abari, bbari, cbari, dbari, ebari, fbari) &amp;<a name='10705'></font>
<font color=#447700>!$acc create(taua, asya, omga,gtauaer,gssaaer,gasmaer) &amp;<a name='10706'></font>
<font color=#447700>!$acc copyin(wavenum2, ngb) &amp;<a name='10707'></font>
<font color=#447700>!$acc copyin(tref, preflog, albdif, albdir, cossza)&amp;<a name='10708'></font>
<font color=#447700>!$acc copyin(icxa, adjflux, nspa, nspb)&amp;<a name='10709'></font>
<font color=#447700>!$acc copyin(kao16,kbo16,selfrefo16,forrefo16,sfluxrefo16)&amp;<a name='10710'></font>
<font color=#447700>!$acc copyin(ka16,kb16,selfref16,forref16,sfluxref16)&amp;<a name='10711'></font>
<font color=#447700>!$acc copyin(kao17,kbo17,selfrefo17,forrefo17,sfluxrefo17)&amp;<a name='10712'></font>
<font color=#447700>!$acc copyin(ka17,kb17,selfref17,forref17,sfluxref17)&amp;<a name='10713'></font>
<font color=#447700>!$acc copyin(kao18,kbo18,selfrefo18,forrefo18,sfluxrefo18)&amp;<a name='10714'></font>
<font color=#447700>!$acc copyin(ka18,kb18,selfref18,forref18,sfluxref18)&amp;<a name='10715'></font>
<font color=#447700>!$acc copyin(kao19,kbo19,selfrefo19,forrefo19,sfluxrefo19)&amp;<a name='10716'></font>
<font color=#447700>!$acc copyin(ka19,kb19,selfref19,forref19,sfluxref19)&amp;<a name='10717'></font>
<font color=#447700>!$acc copyin(kao20,kbo20,selfrefo20,forrefo20,sfluxrefo20,absch4o20)&amp;<a name='10718'></font>
<font color=#447700>!$acc copyin(ka20,kb20,selfref20,forref20,sfluxref20,absch420)&amp;<a name='10719'></font>
<font color=#447700>!$acc copyin(kao21,kbo21,selfrefo21,forrefo21,sfluxrefo21)&amp;<a name='10720'></font>
<font color=#447700>!$acc copyin(ka21,kb21,selfref21,forref21,sfluxref21)&amp;<a name='10721'></font>
<font color=#447700>!$acc copyin(kao22,kbo22,selfrefo22,forrefo22,sfluxrefo22)&amp;<a name='10722'></font>
<font color=#447700>!$acc copyin(ka22,kb22,selfref22,forref22,sfluxref22)&amp;<a name='10723'></font>
<font color=#447700>!$acc copyin(kao23,selfrefo23,forrefo23,sfluxrefo23,raylo23)&amp;<a name='10724'></font>
<font color=#447700>!$acc copyin(ka23,selfref23,forref23,sfluxref23,rayl23)&amp;<a name='10725'></font>
<font color=#447700>!$acc copyin(kao24,kbo24,selfrefo24,forrefo24,sfluxrefo24,abso3ao24,abso3bo24,raylao24,raylbo24)&amp;<a name='10726'></font>
<font color=#447700>!$acc copyin(ka24,kb24,selfref24,forref24,sfluxref24,abso3a24,abso3b24,rayla24,raylb24)&amp;<a name='10727'></font>
<font color=#447700>!$acc copyin(kao25,sfluxrefo25,abso3ao25,abso3bo25,raylo25)&amp;<a name='10728'></font>
<font color=#447700>!$acc copyin(ka25,sfluxref25,abso3a25,abso3b25,rayl25)&amp;<a name='10729'></font>
<font color=#447700>!$acc copyin(sfluxrefo26)&amp;<a name='10730'></font>
<font color=#447700>!$acc copyin(sfluxref26)&amp;<a name='10731'></font>
<font color=#447700>!$acc copyin(kao27,kbo27,sfluxrefo27, raylo27)&amp;<a name='10732'></font>
<font color=#447700>!$acc copyin(ka27,kb27,sfluxref27, rayl27)&amp;<a name='10733'></font>
<font color=#447700>!$acc copyin(kao28,kbo28,sfluxrefo28)&amp;<a name='10734'></font>
<font color=#447700>!$acc copyin(ka28,kb28,sfluxref28,gtauc, gssac, gasmc, gfsfc)&amp;<a name='10735'></font>
<font color=#447700>!$acc copyin(kao29,kbo29,selfrefo29,forrefo29,sfluxrefo29,absh2oo29,absco2o29)&amp;<a name='10736'></font>
<font color=#447700>!$acc copyin(ka29,kb29,selfref29,forref29,sfluxref29,absh2o29,absco229)&amp;<a name='10737'></font>
<font color=#447700>!$acc copyin(gh2ovmr, gco2vmr, go3vmr, gn2ovmr, gch4vmr, go2vmr)&amp;<a name='10738'></font>
<font color=#447700>!$acc copyin(gcld, gciwp, gclwp, gcswp, grei, grel, gres, gplay, gplev, gtlay, gtlev, gtsfc)&amp;<a name='10739'></font>
<font color=#447700>!$acc copyin(gasdir, galdir, gasdif, galdif,profi,profic,gcoszen)&amp;<a name='10740'></font>
<font color=#447700>!$acc copyout(sibvisdir,sibvisdif,sibnirdir,sibnirdif,swdkdir,swdkdif)<a name='10741'></font>
<a name='10742'>
<font color=#447700>!$acc update device(extliq1, ssaliq1, asyliq1, extice2, ssaice2, asyice2) &amp;<a name='10743'></font>
<font color=#447700>!$acc device(extice3, ssaice3, asyice3, fdlice3, abari, bbari, cbari, dbari, ebari, fbari) &amp;<a name='10744'></font>
<font color=#447700>!$acc device(preflog)<a name='10745'></font>
<a name='10746'>
<a name='10747'>
      ncolc = cols<a name='10748'>
      ncolb = cole<a name='10749'>
<a name='10750'>
      npartc = ceiling( real(ncolc) / real(ncol) )<a name='10751'>
      npartb = ceiling( real(ncolb) / real(ncol) )<a name='10752'>
<a name='10753'>
<a name='10754'>
<font color=#447700>!$acc kernels    <a name='10755'></font>
      cldfmcl = 0.0<a name='10756'>
      ciwpmcl = 0.0<a name='10757'>
      clwpmcl = 0.0     <a name='10758'>
      cswpmcl = 0.0     <a name='10759'>
<font color=#447700>!$acc end kernels<a name='10760'></font>
  <a name='10761'>
      idelm = 1<a name='10762'>
      <a name='10763'>
<font color=#447700>!$acc kernels<a name='10764'></font>
      taua = 0.0<a name='10765'>
      asya = 0.0<a name='10766'>
      omga = 1.0<a name='10767'>
<font color=#447700>!$acc end kernels<a name='10768'></font>
<a name='10769'>
      if (iaer==10) then<a name='10770'>
<a name='10771'>
<font color=#447700>!$acc update device(gtauaer,gssaaer,gasmaer)<a name='10772'></font>
<a name='10773'>
      end if<a name='10774'>
<a name='10775'>
<a name='10776'>
<a name='10777'>
<a name='10778'>
<font color=#447700>! PARTITION LOOP ----------------------------------------------------------------------------<a name='10779'></font>
      do cc = 1, 2<a name='10780'>
<a name='10781'>
        if (cc==1) then <a name='10782'>
         <a name='10783'>
          npart = npartc<a name='10784'>
          ncolst = ncolc<a name='10785'>
<a name='10786'>
        else<a name='10787'>
        <a name='10788'>
          npart = npartb<a name='10789'>
          ncolst = ncolb<a name='10790'>
         <a name='10791'>
        end if<a name='10792'>
     <a name='10793'>
        do ipart = 0,npart-1<a name='10794'>
<font color=#447700>!jm call unsetdebug<a name='10795'></font>
<font color=#447700>!jm if (ipart.eq.IDEBUG-1) then<a name='10796'></font>
<font color=#447700>!jm write(0,*)'setting setdebug ipart = ',ipart+1,' npart ',npart<a name='10797'></font>
<font color=#447700>!jm call setdebug<a name='10798'></font>
<font color=#447700>!jm endif<a name='10799'></font>
          cols = ipart * ncol + 1<a name='10800'>
          cole = (ipart + 1) * ncol<a name='10801'>
          if (cole&gt;ncolst) cole=ncolst<a name='10802'>
          colr = cole - cols + 1<a name='10803'>
<a name='10804'>
<font color=#447700>!$acc kernels            <a name='10805'></font>
          taormc = 0.0 <a name='10806'>
          taucmc = 0.0<a name='10807'>
          ssacmc = 1.0<a name='10808'>
          asmcmc = 0.0<a name='10809'>
          fsfcmc = 0.0<a name='10810'>
<font color=#447700>!$acc end kernels            <a name='10811'></font>
 <a name='10812'>
<font color=#447700>! Clear cases<a name='10813'></font>
          if (cc==1) then    <a name='10814'>
<font color=#447700>!$acc kernels loop private(piplon)<a name='10815'></font>
             do iplon = 1, colr<a name='10816'>
               piplon = profic(iplon + cols - 1)<a name='10817'>
     <a name='10818'>
               do ib=1,8<a name='10819'>
                 albdir(iplon,ib)  = galdir(piplon)<a name='10820'>
                 albdif(iplon,ib)  = galdif(piplon)<a name='10821'>
               enddo<a name='10822'>
               albdir(iplon,nbndsw)  = galdir(piplon)<a name='10823'>
               albdif(iplon,nbndsw)  = galdif(piplon)<a name='10824'>
<font color=#447700>!  UV/visible bands 25-28 (10-13), 16000-50000 cm-1, 0.200-0.625 micron<a name='10825'></font>
     <a name='10826'>
               do ib=10,13<a name='10827'>
                 albdir(iplon,ib)  = gasdir(piplon)<a name='10828'>
                 albdif(iplon,ib)  = gasdif(piplon)<a name='10829'>
               enddo<a name='10830'>
<a name='10831'>
<font color=#447700>!  Transition band 9, 12850-16000 cm-1, 0.625-0.778 micron, Take average<a name='10832'></font>
               albdir(iplon, 9) = (gasdir(piplon)+galdir(piplon))/2.<a name='10833'>
               albdif(iplon, 9) = (gasdif(piplon)+galdif(piplon))/2.<a name='10834'>
             end do<a name='10835'>
<font color=#447700>!$acc end kernels      <a name='10836'></font>
<a name='10837'>
<font color=#447700>!$acc kernels <a name='10838'></font>
             do iplon = 1, colr<a name='10839'>
               piplon = profic(iplon + cols - 1)<a name='10840'>
               play(iplon,:) = gplay(piplon, 1:nlay)<a name='10841'>
               plev(iplon,:) = gplev(piplon, 1:nlay+1)<a name='10842'>
               tlay(iplon,:) = gtlay(piplon, 1:nlay)<a name='10843'>
               tlev(iplon,:) = gtlev(piplon, 1:nlay+1)<a name='10844'>
               tsfc(iplon)   = gtsfc(piplon)<a name='10845'>
             end do<a name='10846'>
<font color=#447700>!$acc end kernels<a name='10847'></font>
<a name='10848'>
             if (iaer==10) then<a name='10849'>
<font color=#447700>!$acc kernels<a name='10850'></font>
               do iw=1,nbndsw<a name='10851'>
               do kk=1,nlay<a name='10852'>
               do iplon = 1, colr<a name='10853'>
                 piplon = profic(iplon + cols - 1)<a name='10854'>
                 taua(iplon, kk, iw) = gtauaer(piplon, kk, iw)<a name='10855'>
                 asya(iplon, kk, iw) = gasmaer(piplon, kk, iw)<a name='10856'>
                 omga(iplon, kk, iw) = gssaaer(piplon, kk, iw)<a name='10857'>
               end do<a name='10858'>
               end do<a name='10859'>
               end do<a name='10860'>
<font color=#447700>!$acc end kernels<a name='10861'></font>
             end if<a name='10862'>
<a name='10863'>
<font color=#447700>!$acc kernels<a name='10864'></font>
             do iplon = 1, colr<a name='10865'>
               piplon = profic(iplon + cols - 1)<a name='10866'>
               wkl(iplon,1,:) = gh2ovmr(piplon,1:nlay)<a name='10867'>
               wkl(iplon,2,:) = gco2vmr(piplon,1:nlay)<a name='10868'>
               wkl(iplon,3,:) = go3vmr(piplon,1:nlay)<a name='10869'>
               wkl(iplon,4,:) = gn2ovmr(piplon,1:nlay)<a name='10870'>
               wkl(iplon,5,:) = 0.0<a name='10871'>
               wkl(iplon,6,:) = gch4vmr(piplon,1:nlay)<a name='10872'>
               wkl(iplon,7,:) = go2vmr(piplon,1:nlay)   <a name='10873'>
               coszen(iplon)  = gcoszen(piplon)<a name='10874'>
             end do<a name='10875'>
<font color=#447700>!$acc end kernels<a name='10876'></font>
<a name='10877'>
<font color=#447700>!************** cloudy cases ***************<a name='10878'></font>
          else   <a name='10879'>
          <a name='10880'>
<font color=#447700>!$acc kernels loop private(piplon)<a name='10881'></font>
            do iplon = 1, colr<a name='10882'>
              piplon = profi(iplon + cols - 1)<a name='10883'>
<a name='10884'>
              do ib=1,8<a name='10885'>
                albdir(iplon,ib)  = galdir(piplon)<a name='10886'>
                albdif(iplon,ib)  = galdif(piplon)<a name='10887'>
              enddo<a name='10888'>
              albdir(iplon,nbndsw)  = galdir(piplon)<a name='10889'>
              albdif(iplon,nbndsw)  = galdif(piplon)<a name='10890'>
<a name='10891'>
<font color=#447700>!  UV/visible bands 25-28 (10-13), 16000-50000 cm-1, 0.200-0.625 micron<a name='10892'></font>
              do ib=10,13<a name='10893'>
                 albdir(iplon,ib)  = gasdir(piplon)<a name='10894'>
                 albdif(iplon,ib)  = gasdif(piplon)<a name='10895'>
              enddo<a name='10896'>
<a name='10897'>
<font color=#447700>!  Transition band 9, 12850-16000 cm-1, 0.625-0.778 micron, Take average<a name='10898'></font>
              albdir(iplon, 9) = (gasdir(piplon)+galdir(piplon))/2.<a name='10899'>
              albdif(iplon, 9) = (gasdif(piplon)+galdif(piplon))/2.<a name='10900'>
            end do<a name='10901'>
<font color=#447700>!$acc end kernels               <a name='10902'></font>
          <a name='10903'>
<font color=#447700>!$acc kernels <a name='10904'></font>
            do iplon = 1, colr<a name='10905'>
              piplon = profi(iplon + cols - 1)<a name='10906'>
              play(iplon,:) = gplay(piplon, 1:nlay)<a name='10907'>
              plev(iplon,:) = gplev(piplon, 1:nlay+1)<a name='10908'>
              tlay(iplon,:) = gtlay(piplon, 1:nlay)<a name='10909'>
              tlev(iplon,:) = gtlev(piplon, 1:nlay+1)<a name='10910'>
              tsfc(iplon) = gtsfc(piplon)<a name='10911'>
              cld(iplon,:) = gcld(piplon, 1:nlay)<a name='10912'>
              ciwp(iplon,:) = gciwp(piplon, 1:nlay)<a name='10913'>
              clwp(iplon,:) = gclwp(piplon, 1:nlay)<a name='10914'>
              cswp(iplon,:) = gcswp(piplon, 1:nlay)<a name='10915'>
              rei(iplon,:) = grei(piplon, 1:nlay) <a name='10916'>
              rel(iplon,:) = grel(piplon, 1:nlay)<a name='10917'>
              res(iplon,:) = gres(piplon, 1:nlay)<a name='10918'>
            end do<a name='10919'>
<a name='10920'>
<font color=#447700>!$acc end kernels<a name='10921'></font>
            if (iaer==10) then<a name='10922'>
<a name='10923'>
<font color=#447700>!$acc kernels    <a name='10924'></font>
              do iw=1,nbndsw<a name='10925'>
              do kk=1,nlay<a name='10926'>
              do iplon = 1, colr<a name='10927'>
                piplon = profi(iplon + cols - 1)<a name='10928'>
                taua(iplon, kk, iw) = gtauaer(piplon, kk, iw)<a name='10929'>
                asya(iplon, kk, iw) = gasmaer(piplon, kk, iw)<a name='10930'>
                omga(iplon, kk, iw) = gssaaer(piplon, kk, iw)<a name='10931'>
              end do<a name='10932'>
              end do<a name='10933'>
              end do<a name='10934'>
<font color=#447700>!$acc end kernels<a name='10935'></font>
            end if<a name='10936'>
<a name='10937'>
<a name='10938'>
<font color=#447700>! Copy the direct cloud optical properties over to the temp arrays<a name='10939'></font>
<font color=#447700>! and then onto the GPU<a name='10940'></font>
<font color=#447700>! We are on the CPU here<a name='10941'></font>
<a name='10942'>
<font color=#447700>!$acc kernels <a name='10943'></font>
            do iw=1,nbndsw<a name='10944'>
            do kk=1,nlay<a name='10945'>
            do iplon = 1, colr<a name='10946'>
              piplon = profi(iplon + cols - 1)<a name='10947'>
              tauc(iplon, kk, iw) = gtauc(piplon, kk, iw)<a name='10948'>
              ssac(iplon, kk, iw) = gssac(piplon, kk, iw)<a name='10949'>
              asmc(iplon, kk, iw) = gasmc(piplon, kk, iw)<a name='10950'>
              fsfc(iplon, kk, iw) = gfsfc(piplon, kk, iw)<a name='10951'>
            end do<a name='10952'>
            end do<a name='10953'>
            end do<a name='10954'>
<font color=#447700>!$acc end kernels<a name='10955'></font>
<a name='10956'>
<font color=#447700>!$acc kernels<a name='10957'></font>
            do iplon = 1, colr<a name='10958'>
              piplon = profi(iplon + cols - 1)<a name='10959'>
              wkl(iplon,1,:) = gh2ovmr(piplon,1:nlay)<a name='10960'>
              wkl(iplon,2,:) = gco2vmr(piplon,1:nlay)<a name='10961'>
              wkl(iplon,3,:) = go3vmr(piplon,1:nlay)<a name='10962'>
              wkl(iplon,4,:) = gn2ovmr(piplon,1:nlay)<a name='10963'>
              wkl(iplon,5,:) = 0.0<a name='10964'>
              wkl(iplon,6,:) = gch4vmr(piplon,1:nlay)<a name='10965'>
              wkl(iplon,7,:) = go2vmr(piplon,1:nlay)  <a name='10966'>
              coszen(iplon)  = gcoszen(piplon)<a name='10967'>
            end do<a name='10968'>
<font color=#447700>!$acc end kernels<a name='10969'></font>
          end if    <font color=#447700>! if-else-endif cc=1 (clear and cloudy cases)<a name='10970'></font>
<a name='10971'>
<font color=#447700>!$acc kernels<a name='10972'></font>
          cossza = max(zepzen,coszen)<a name='10973'>
<font color=#447700>!$acc end kernels  <a name='10974'></font>
<a name='10975'>
<font color=#447700>!$acc kernels<a name='10976'></font>
          do iplon = 1,colr<a name='10977'>
            do l = 1,nlay<a name='10978'>
              coldry(iplon, l) = (plev(iplon, l)-plev(iplon, l+1)) * 1.e3  * avogad / &amp;<a name='10979'>
                 (1.e2  * grav * ((1.  - wkl(iplon, 1,l)) * amd + wkl(iplon, 1,l) * amw) * &amp;<a name='10980'>
                 (1.  + wkl(iplon, 1,l)))<a name='10981'>
            end do<a name='10982'>
          end do<a name='10983'>
<font color=#447700>!$acc end kernels<a name='10984'></font>
<a name='10985'>
<font color=#447700>!$acc kernels<a name='10986'></font>
          do iplon = 1,colr<a name='10987'>
            do l = 1,nlay<a name='10988'>
              do imol = 1, nmol<a name='10989'>
                wkl(iplon,imol,l) = coldry(iplon,l) * wkl(iplon,imol,l)<a name='10990'>
              end do<a name='10991'>
            end do<a name='10992'>
          end do<a name='10993'>
<font color=#447700>!$acc end kernels<a name='10994'></font>
<a name='10995'>
#ifndef _ACCEL<a name='10996'>
<font color=#447700>! Use Tom Henderson's technique to pad out and vector remainder<a name='10997'></font>
<font color=#447700>! with valid data so that we can have a static loop range over <a name='10998'></font>
<font color=#447700>! columns without having to test for short vectors.<a name='10999'></font>
      IF ( colr &lt; CHNK ) THEN<a name='11000'>
<a name='11001'>
        DO jj = 1,ngptsw<a name='11002'>
        DO kk = 1,nlay+1<a name='11003'>
        DO ii = colr+1, CHNK<a name='11004'>
           taormc(ii,kk,jj) = taormc(colr,kk,jj)<a name='11005'>
           taucmc(ii,kk,jj) = taucmc(colr,kk,jj)<a name='11006'>
           ssacmc(ii,kk,jj) = ssacmc(colr,kk,jj)<a name='11007'>
           asmcmc(ii,kk,jj) = asmcmc(colr,kk,jj)<a name='11008'>
           fsfcmc(ii,kk,jj) = fsfcmc(colr,kk,jj)<a name='11009'>
        ENDDO<a name='11010'>
        ENDDO<a name='11011'>
        ENDDO<a name='11012'>
        DO ib = 1,13<a name='11013'>
        DO ii = colr+1, CHNK<a name='11014'>
           albdir(ii,ib) = albdir(colr,ib)<a name='11015'>
           albdif(ii,ib) = albdif(colr,ib)<a name='11016'>
        ENDDO<a name='11017'>
        ENDDO<a name='11018'>
        DO kk = 1,nlay+1<a name='11019'>
        DO ii = colr+1, CHNK<a name='11020'>
           plev(ii,kk) = plev(colr,kk)<a name='11021'>
           tlev(ii,kk) = tlev(colr,kk)<a name='11022'>
           coldry(ii,kk) = coldry(colr,kk)<a name='11023'>
        ENDDO<a name='11024'>
        ENDDO<a name='11025'>
        DO kk = 1,nlay<a name='11026'>
        DO ii = colr+1, CHNK<a name='11027'>
           play(ii,kk) = play(colr,kk)<a name='11028'>
           tlay(ii,kk) = tlay(colr,kk)<a name='11029'>
           cld(ii,kk)  = cld(colr,kk)<a name='11030'>
           ciwp(ii,kk) = ciwp(colr,kk)<a name='11031'>
           clwp(ii,kk) = clwp(colr,kk)<a name='11032'>
           cswp(ii,kk) = cswp(colr,kk)<a name='11033'>
           rei(ii,kk) = rei(colr,kk)<a name='11034'>
           rel(ii,kk) = rel(colr,kk)<a name='11035'>
           res(ii,kk) = res(colr,kk)<a name='11036'>
        ENDDO<a name='11037'>
        ENDDO<a name='11038'>
        DO ii = colr+1, CHNK<a name='11039'>
           tsfc(ii) = tsfc(colr)<a name='11040'>
        ENDDO<a name='11041'>
        IF ( iaer==10 ) THEN<a name='11042'>
         DO jj = 1,nbndsw<a name='11043'>
         DO kk = 1,nlay+1<a name='11044'>
         DO ii = colr+1, CHNK<a name='11045'>
           taua(ii,kk,jj) = taua(colr,kk,jj)<a name='11046'>
           asya(ii,kk,jj) = asya(colr,kk,jj)<a name='11047'>
           omga(ii,kk,jj) = omga(colr,kk,jj)<a name='11048'>
         ENDDO<a name='11049'>
         ENDDO<a name='11050'>
         ENDDO<a name='11051'>
        ENDIF<a name='11052'>
        DO jj = 1,nbndsw<a name='11053'>
        DO kk = 1,nlay<a name='11054'>
        DO ii = colr+1, CHNK<a name='11055'>
           tauc(ii,kk,jj) = tauc(colr,kk,jj)<a name='11056'>
           ssac(ii,kk,jj) = ssac(colr,kk,jj)<a name='11057'>
           asmc(ii,kk,jj) = asmc(colr,kk,jj)<a name='11058'>
           fsfc(ii,kk,jj) = fsfc(colr,kk,jj)<a name='11059'>
        ENDDO<a name='11060'>
        ENDDO<a name='11061'>
        ENDDO<a name='11062'>
        DO kk = 1,nlay<a name='11063'>
        DO jj = 1,mxmol<a name='11064'>
        DO ii = colr+1, CHNK<a name='11065'>
           wkl(ii,jj,kk) = wkl(colr,jj,kk)<a name='11066'>
        ENDDO<a name='11067'>
        ENDDO<a name='11068'>
        ENDDO<a name='11069'>
        DO ii = colr+1, CHNK<a name='11070'>
           coszen(ii) = coszen(colr)<a name='11071'>
        ENDDO<a name='11072'>
<a name='11073'>
      ENDIF<a name='11074'>
#endif<a name='11075'>
<a name='11076'>
#ifndef _ACCEL<a name='11077'>
#  define colr CHNK<a name='11078'>
#endif<a name='11079'>
<a name='11080'>
          if (cc==2) then   <font color=#447700>! call mcica for cloudy cases<a name='11081'></font>
            call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MCICA_SW'>mcica_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MCICA_SW_1">(colr, nlay, 112, icld, irng, play, &amp;<a name='11082'>
                          cld, ciwp, clwp, cswp, tauc, ssac, asmc, fsfc, &amp;<a name='11083'>
                          cldfmcl, ciwpmcl, clwpmcl, cswpmcl, &amp;<a name='11084'>
                          taucmc, ssacmc, asmcmc, fsfcmc, 1 ) <a name='11085'>
          end if   <a name='11086'>
<a name='11087'>
          if (cc==2) then   <font color=#447700>! call cldprmc for cloudy cases<a name='11088'></font>
            call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#CLDPRMC_SW'>cldprmc_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CLDPRMC_SW_2">(colr, nlay, inflgsw, iceflgsw, liqflgsw,  &amp;<a name='11089'>
                            cldfmcl, ciwpmcl, clwpmcl, cswpmcl, rei, rel, res, &amp;<a name='11090'>
                            taormc, taucmc, ssacmc, asmcmc, fsfcmc)<a name='11091'>
          end if<a name='11092'>
<a name='11093'>
          call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SETCOEF_SW'>setcoef_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SETCOEF_SW_2">(colr, nlay, play , tlay , plev , tlev , tsfc , &amp;<a name='11094'>
                          coldry , wkl , &amp;<a name='11095'>
                          laytrop, layswtch, laylow, jp , jt , jt1 , &amp;<a name='11096'>
                          co2mult , colch4 , colco2 , colh2o , colmol , coln2o , &amp;<a name='11097'>
                          colo2 , colo3 , fac00 , fac01 , fac10 , fac11 , &amp;<a name='11098'>
                          selffac , selffrac , indself , forfac , forfrac , indfor )<a name='11099'>
<a name='11100'>
          call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SPCVMC_SW'>spcvmc_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_SUB' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SPCVMC_SW_2">(cc, ncol, colr, nlay, istart, iend, icpr, idelm, iout, &amp;<a name='11101'>
                         play, tlay, plev, tlev, &amp;<a name='11102'>
                         tsfc, albdif, albdir, &amp;<a name='11103'>
                         cldfmcl, taucmc, asmcmc, ssacmc, taormc, &amp;<a name='11104'>
                         taua, asya, omga, cossza, coldry, adjflux, &amp;	 <a name='11105'>
                         laytrop, layswtch, laylow, jp, jt, jt1, &amp;<a name='11106'>
                         co2mult, colch4, colco2, colh2o, colmol, &amp;<a name='11107'>
                         coln2o, colo2, colo3, &amp;<a name='11108'>
                         fac00, fac01, fac10, fac11, &amp;<a name='11109'>
                         selffac, selffrac, indself, forfac, forfrac, indfor, &amp;<a name='11110'>
                         zbbfd, zbbfu, zbbcd, zbbcu, zuvfd, &amp;<a name='11111'>
                         zuvcd, znifd, znicd, &amp;<a name='11112'>
                         zbbfddir, zbbcddir, zuvfddir, zuvcddir, znifddir, znicddir,&amp;<a name='11113'>
                         zgco,zomco,zrdnd,zref,zrefo,zrefd,zrefdo,ztauo,zdbt,ztdbt,&amp;<a name='11114'>
                         ztra,ztrao,ztrad,ztrado,zfd,zfu,ztaug, ztaur, zsflxzen)<a name='11115'>
<a name='11116'>
#ifndef _ACCEL<a name='11117'>
#  undef colr<a name='11118'>
#endif<a name='11119'>
   <a name='11120'>
<font color=#447700>! Transfer up and down, clear and total sky fluxes to output arrays.<a name='11121'></font>
<font color=#447700>! Vertical indexing goes from bottom to top; reverse here for GCM if necessary.<a name='11122'></font>
<a name='11123'>
          if (cc==1) then   <font color=#447700>! clear<a name='11124'></font>
<font color=#447700>!$acc kernels loop independent<a name='11125'></font>
            do iplon = 1, colr<a name='11126'>
              piplon = profic(iplon + cols - 1)<a name='11127'>
        <a name='11128'>
              do i = 1, nlay+1<a name='11129'>
                swuflxc(piplon,i) = zbbcu(iplon,i) <a name='11130'>
                swdflxc(piplon,i) = zbbcd(iplon,i) <a name='11131'>
                swuflx(piplon,i) = zbbfu(iplon,i) <a name='11132'>
                swdflx(piplon,i) = zbbfd(iplon,i) <a name='11133'>
<a name='11134'>
<font color=#447700>!  All-sky downwward direct and diffuse fluxes<a name='11135'></font>
                swdkdir(piplon,i) = zbbfddir(iplon,i)<a name='11136'>
                swdkdif(piplon,i) = zbbfd(iplon,i) - zbbfddir(iplon,i)<a name='11137'>
<font color=#447700>!  UV/visible downward direct/diffuse fluxes<a name='11138'></font>
                sibvisdir(piplon,i) = zuvfddir(iplon,i)<a name='11139'>
                sibvisdif(piplon,i) = zuvfd(iplon,i) - zuvfddir(iplon,i)<a name='11140'>
<font color=#447700>!  Near-IR downward direct/diffuse fluxes<a name='11141'></font>
                sibnirdir(piplon,i) = znifddir(iplon,i)<a name='11142'>
                sibnirdif(piplon,i) = znifd(iplon,i) - znifddir(iplon,i)<a name='11143'>
              enddo<a name='11144'>
<a name='11145'>
<font color=#447700>!  Total and clear sky net fluxes<a name='11146'></font>
<a name='11147'>
              do i = 1, nlay+1<a name='11148'>
                swnflxc(iplon,i)  = swdflxc(piplon,i) - swuflxc(piplon,i)<a name='11149'>
                swnflx(iplon,i)  = swdflx(piplon,i) - swuflx(piplon,i)<a name='11150'>
              enddo<a name='11151'>
<a name='11152'>
<font color=#447700>!  Total and clear sky heating rates<a name='11153'></font>
<a name='11154'>
              do i = 1, nlay<a name='11155'>
                zdpgcp = heatfac / (plev(iplon, i) - plev(iplon, i+1))<a name='11156'>
                swhrc(piplon,i) = (swnflxc(iplon,i+1)  - swnflxc(iplon,i) ) * zdpgcp<a name='11157'>
                swhr(piplon,i) = (swnflx(iplon,i+1)  - swnflx(iplon,i) ) * zdpgcp<a name='11158'>
              enddo<a name='11159'>
              swhrc(piplon,nlay) = 0. <a name='11160'>
              swhr(piplon,nlay) = 0. <a name='11161'>
       <a name='11162'>
<font color=#447700>! End longitude loop<a name='11163'></font>
            enddo<a name='11164'>
<font color=#447700>!$acc end kernels <a name='11165'></font>
<a name='11166'>
          else     <font color=#447700>! cc = 2, cloudy<a name='11167'></font>
<font color=#447700>!$acc kernels loop independent<a name='11168'></font>
            do iplon = 1, colr<a name='11169'>
              piplon = profi(iplon + cols - 1)<a name='11170'>
<a name='11171'>
              do i = 1, nlay+1<a name='11172'>
                swuflxc(piplon,i) = zbbcu(iplon,i) <a name='11173'>
                swdflxc(piplon,i) = zbbcd(iplon,i) <a name='11174'>
                swuflx(piplon,i) = zbbfu(iplon,i) <a name='11175'>
                swdflx(piplon,i) = zbbfd(iplon,i) <a name='11176'>
<a name='11177'>
<font color=#447700>!  All-sky downwward direct and diffuse fluxes<a name='11178'></font>
                swdkdir(piplon,i) = zbbfddir(iplon,i)<a name='11179'>
                swdkdif(piplon,i) = zbbfd(iplon,i) - zbbfddir(iplon,i)<a name='11180'>
<font color=#447700>!  UV/visible downward direct/diffuse fluxes<a name='11181'></font>
                sibvisdir(piplon,i) = zuvfddir(iplon,i)<a name='11182'>
                sibvisdif(piplon,i) = zuvfd(iplon,i) - zuvfddir(iplon,i)<a name='11183'>
<font color=#447700>!  Near-IR downward direct/diffuse fluxes<a name='11184'></font>
                sibnirdir(piplon,i) = znifddir(iplon,i)<a name='11185'>
                sibnirdif(piplon,i) = znifd(iplon,i) - znifddir(iplon,i)<a name='11186'>
              enddo<a name='11187'>
<a name='11188'>
<font color=#447700>!  Total and clear sky net fluxes<a name='11189'></font>
<a name='11190'>
              do i = 1, nlay+1<a name='11191'>
                swnflxc(iplon,i)  = swdflxc(piplon,i) - swuflxc(piplon,i)<a name='11192'>
                swnflx(iplon,i)  = swdflx(piplon,i) - swuflx(piplon,i)<a name='11193'>
              enddo<a name='11194'>
<a name='11195'>
<font color=#447700>!  Total and clear sky heating rates<a name='11196'></font>
<a name='11197'>
              do i = 1, nlay<a name='11198'>
                zdpgcp = heatfac / (plev(iplon, i) - plev(iplon, i+1))<a name='11199'>
                swhrc(piplon,i) = (swnflxc(iplon,i+1)  - swnflxc(iplon,i) ) * zdpgcp<a name='11200'>
                swhr(piplon,i) = (swnflx(iplon,i+1)  - swnflx(iplon,i) ) * zdpgcp<a name='11201'>
              enddo<a name='11202'>
              swhrc(piplon,nlay) = 0. <a name='11203'>
              swhr(piplon,nlay) = 0. <a name='11204'>
         <a name='11205'>
<font color=#447700>! End longitude loop<a name='11206'></font>
            enddo<a name='11207'>
<font color=#447700>!$acc end kernels <a name='11208'></font>
<a name='11209'>
          end if   <font color=#447700>! if-else-endif clear-cloudy<a name='11210'></font>
<a name='11211'>
<font color=#447700>! End partition loops<a name='11212'></font>
        end do<a name='11213'>
        <a name='11214'>
      end do<a name='11215'>
<a name='11216'>
<font color=#447700>!$acc end data<a name='11217'></font>
<a name='11218'>
      end subroutine rrtmg_sw_sub<a name='11219'>
<a name='11220'>
<font color=#447700>!*************************************************************************<a name='11221'></font>
<A NAME='EARTH_SUN'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#EARTH_SUN' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='11222'>
      real  <font color=#993300>function </font><font color=#cc0000>earth_sun</font>(idn) <A href='../../call_to/EARTH_SUN.html' TARGET='index'>2</A>,<A href='../../call_from/EARTH_SUN.html' TARGET='index'>8</A><a name='11223'>
<font color=#447700>!*************************************************************************<a name='11224'></font>
<font color=#447700>!<a name='11225'></font>
<font color=#447700>!  Purpose: Function to calculate the correction factor of Earth's orbit<a name='11226'></font>
<font color=#447700>!  for current day of the year<a name='11227'></font>
<a name='11228'>
<font color=#447700>!  idn        : Day of the year<a name='11229'></font>
<font color=#447700>!  earth_sun  : square of the ratio of mean to actual Earth-Sun distance<a name='11230'></font>
<a name='11231'>
<font color=#447700>! ------- Modules -------<a name='11232'></font>
<a name='11233'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_CON_F'>rrsw_con_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#EARTH_SUN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_CON_F_6">, only : pi<a name='11234'>
<a name='11235'>
      integer , intent(in) :: idn<a name='11236'>
<a name='11237'>
      real  :: gamma<a name='11238'>
<a name='11239'>
      gamma = 2. *pi*(idn-1)/365. <a name='11240'>
<a name='11241'>
<font color=#447700>! Use Iqbal's equation 1.2.1<a name='11242'></font>
<a name='11243'>
      earth_sun = 1.000110  + .034221  * cos(gamma) + .001289  * sin(gamma) + &amp;<a name='11244'>
                   .000719  * cos(2. *gamma) + .000077  * sin(2. *gamma)<a name='11245'>
<a name='11246'>
      end function earth_sun<a name='11247'>
<a name='11248'>
      end module rrtmg_sw_rad_f<a name='11249'>
<a name='11250'>
<font color=#447700>!------------------------------------------------------------------<a name='11251'></font>
<A NAME='MODULE_RA_RRTMG_SWF'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#MODULE_RA_RRTMG_SWF' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='11252'>
      <font color=#993300>MODULE </font><font color=#cc0000>module_ra_rrtmg_swf</font> <A href='../../call_to/MODULE_RA_RRTMG_SWF.html' TARGET='index'>2</A><a name='11253'>
<a name='11254'>
      use <A href='../../html_code/share/module_model_constants.F.html#MODULE_MODEL_CONSTANTS'>module_model_constants</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#EARTH_SUN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MODEL_CONSTANTS_86">, only : cp<a name='11255'>
      USE <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#EARTH_SUN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_81"><a name='11256'>
<font color=#447700>!     USE module_dm<a name='11257'></font>
<a name='11258'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#PARRRSW_F'>parrrsw_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#EARTH_SUN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRRSW_F_38">, only : nbndsw, ngptsw, naerec<a name='11259'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INIT_F'>rrtmg_sw_init_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#EARTH_SUN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_INIT_F_1">, only: rrtmg_sw_ini<a name='11260'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_RAD_F'>rrtmg_sw_rad_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#EARTH_SUN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_RAD_F_1">, only: rrtmg_sw<a name='11261'>
<font color=#447700>!     use mcica_subcol_gen_sw, only: mcica_subcol_sw<a name='11262'></font>
<a name='11263'>
      use <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#MODULE_RA_RRTMG_LWF'>module_ra_rrtmg_lwf</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#EARTH_SUN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RA_RRTMG_LWF_2">, only : inirad, o3data, relcalc, reicalc, retab<a name='11264'>
<font color=#447700>!                               mcica_random_numbers, randomNumberSequence, &amp;<a name='11265'></font>
<font color=#447700>!                               new_RandomNumberSequence, getRandomReal<a name='11266'></font>
<a name='11267'>
      CONTAINS<a name='11268'>
<a name='11269'>
<font color=#447700>!------------------------------------------------------------------<a name='11270'></font>
<A NAME='RRTMG_SWRAD_FAST'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='11271'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>RRTMG_SWRAD_FAST</font>(                                &amp; <A href='../../call_to/RRTMG_SWRAD_FAST.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SWRAD_FAST.html' TARGET='index'>20</A><a name='11272'>
                       rthratensw,                                &amp;<a name='11273'>
                       swupt, swuptc, swdnt, swdntc,              &amp;<a name='11274'>
                       swupb, swupbc, swdnb, swdnbc,              &amp;<a name='11275'>
<font color=#447700>!                      swupflx, swupflxc, swdnflx, swdnflxc,      &amp;<a name='11276'></font>
                       swcf, gsw,                                 &amp;<a name='11277'>
                       xtime, gmt, xlat, xlong,                   &amp;<a name='11278'>
                       radt, degrad, declin,                      &amp;<a name='11279'>
                       coszr, julday, solcon,                     &amp;<a name='11280'>
                       albedo, t3d, t8w, tsk,                     &amp;<a name='11281'>
                       p3d, p8w, pi3d, rho3d,                     &amp;<a name='11282'>
                       dz8w, cldfra3d, lradius, iradius,          &amp; <a name='11283'>
                       is_cammgmp_used, r, g,                     &amp;<a name='11284'>
                       re_cloud,re_ice,re_snow,                   &amp;<a name='11285'>
                       has_reqc,has_reqi,has_reqs,                &amp;<a name='11286'>
                       icloud, warm_rain,                         &amp;<a name='11287'>
                       f_ice_phy, f_rain_phy,                     &amp;<a name='11288'>
                       xland, xice, snow,                         &amp;<a name='11289'>
                       qv3d, qc3d, qr3d,                          &amp;<a name='11290'>
                       qi3d, qs3d, qg3d,                          &amp;<a name='11291'>
                       o3input, o33d,                             &amp;<a name='11292'>
                       aer_opt, aerod, no_src,                    &amp;<a name='11293'>
                       alswvisdir, alswvisdif,                    &amp;  <font color=#447700>!Zhenxin ssib alb comp (06/20/2011)<a name='11294'></font>
                       alswnirdir, alswnirdif,                    &amp;  <font color=#447700>!Zhenxin ssib alb comp (06/20/2011)<a name='11295'></font>
                       swvisdir, swvisdif,                        &amp;  <font color=#447700>!Zhenxin ssib swr comp (06/20/2011)<a name='11296'></font>
                       swnirdir, swnirdif,                        &amp;  <font color=#447700>!Zhenxin ssib swi comp (06/20/2011)<a name='11297'></font>
                       sf_surface_physics,                        &amp;  <font color=#447700>!Zhenxin<a name='11298'></font>
                       f_qv, f_qc, f_qr, f_qi, f_qs, f_qg,        &amp;<a name='11299'>
                       tauaer300,tauaer400,tauaer600,tauaer999,   &amp; <font color=#447700>! czhao <a name='11300'></font>
                       gaer300,gaer400,gaer600,gaer999,           &amp; <font color=#447700>! czhao <a name='11301'></font>
                       waer300,waer400,waer600,waer999,           &amp; <font color=#447700>! czhao <a name='11302'></font>
                       aer_ra_feedback,                           &amp;<a name='11303'>
<font color=#447700>!jdfcz                 progn,prescribe,                           &amp;<a name='11304'></font>
                       progn,                                     &amp;<a name='11305'>
                       qndrop3d,f_qndrop,                         &amp; <font color=#447700>!czhao<a name='11306'></font>
                       ids,ide, jds,jde, kds,kde,                 &amp; <a name='11307'>
                       ims,ime, jms,jme, kms,kme,                 &amp;<a name='11308'>
                       its,ite, jts,jte, kts,kte,                 &amp;<a name='11309'>
                       swupflx, swupflxc, swdnflx, swdnflxc,      &amp;<a name='11310'>
                       tauaer3d_sw,ssaaer3d_sw,asyaer3d_sw,       &amp; <font color=#447700>! jararias 2013/11<a name='11311'></font>
                       swddir, swddni, swddif,                    &amp; <font color=#447700>! jararias 2013/08<a name='11312'></font>
                       xcoszen,julian                             &amp; <font color=#447700>! jararias 2013/08<a name='11313'></font>
                                                                  )<a name='11314'>
<font color=#447700>!------------------------------------------------------------------<a name='11315'></font>
      IMPLICIT NONE<a name='11316'>
<font color=#447700>!------------------------------------------------------------------<a name='11317'></font>
   LOGICAL, INTENT(IN )      ::        warm_rain<a name='11318'>
   LOGICAL, INTENT(IN )      ::   is_CAMMGMP_used <font color=#447700>! Added for CAM5 RRTMG&lt;-&gt;CAMMGMP<a name='11319'></font>
<font color=#447700>!<a name='11320'></font>
   INTEGER, INTENT(IN )      ::        ids,ide, jds,jde, kds,kde, &amp;<a name='11321'>
                                       ims,ime, jms,jme, kms,kme, &amp;<a name='11322'>
                                       its,ite, jts,jte, kts,kte<a name='11323'>
<a name='11324'>
   INTEGER, INTENT(IN )      ::        ICLOUD<a name='11325'>
<font color=#447700>!<a name='11326'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='11327'>
         INTENT(IN   ) ::                                   dz8w, &amp;<a name='11328'>
                                                             t3d, &amp;<a name='11329'>
                                                             t8w, &amp;<a name='11330'>
                                                             p3d, &amp;<a name='11331'>
                                                             p8w, &amp;<a name='11332'>
                                                            pi3d, &amp;<a name='11333'>
                                                           rho3d<a name='11334'>
<a name='11335'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='11336'>
         INTENT(INOUT)  ::                            RTHRATENSW<a name='11337'>
<a name='11338'>
   REAL, DIMENSION( ims:ime, jms:jme )                          , &amp;<a name='11339'>
         INTENT(INOUT)  ::                                   GSW, &amp;<a name='11340'>
                                                            SWCF, &amp;<a name='11341'>
                                                           COSZR<a name='11342'>
<a name='11343'>
   INTEGER, INTENT(IN  )     ::                           JULDAY<a name='11344'>
   REAL, INTENT(IN    )      ::                      RADT,DEGRAD, &amp;<a name='11345'>
                                         XTIME,DECLIN,SOLCON,GMT<a name='11346'>
<a name='11347'>
   REAL, DIMENSION( ims:ime, jms:jme )                          , &amp;<a name='11348'>
         INTENT(IN   )  ::                                  XLAT, &amp;<a name='11349'>
                                                           XLONG, &amp;<a name='11350'>
                                                           XLAND, &amp;<a name='11351'>
                                                            XICE, &amp;<a name='11352'>
                                                            SNOW, &amp;<a name='11353'>
                                                             TSK, &amp;<a name='11354'>
                                                          ALBEDO<a name='11355'>
<font color=#447700>!<a name='11356'></font>
<font color=#447700>!!! -------------------  Zhenxin (2011-06/20) ------------------<a name='11357'></font>
   REAL, DIMENSION( ims:ime, jms:jme )                          , &amp;<a name='11358'>
         OPTIONAL                                               , &amp;<a name='11359'>
         INTENT(IN)     ::                            ALSWVISDIR, &amp;     <font color=#447700>! ssib albedo of sw and lw<a name='11360'></font>
                                                      ALSWVISDIF, &amp;<a name='11361'>
                                                      ALSWNIRDIR, &amp;<a name='11362'>
                                                      ALSWNIRDIF<a name='11363'>
<a name='11364'>
   REAL, DIMENSION( ims:ime, jms:jme )                          , &amp;<a name='11365'>
         OPTIONAL                                               , &amp;<a name='11366'>
         INTENT(OUT)    ::                              SWVISDIR, &amp;<a name='11367'>
                                                        SWVISDIF, &amp;<a name='11368'>
                                                        SWNIRDIR, &amp;<a name='11369'>
                                                        SWNIRDIF        <font color=#447700>! ssib sw dir and diff rad<a name='11370'></font>
   INTEGER, INTENT(IN) :: sf_surface_physics                            <font color=#447700>! ssib para<a name='11371'></font>
<a name='11372'>
<font color=#447700>!  ----------------------- end Zhenxin --------------------------<a name='11373'></font>
<font color=#447700>!<a name='11374'></font>
<a name='11375'>
<font color=#447700>! ------------------------ jararias 2013/08/10 -----------------<a name='11376'></font>
   real, dimension(ims:ime,jms:jme), intent(out) :: &amp;<a name='11377'>
         swddir,  &amp;  <font color=#447700>! All-sky broadband surface direct horiz irradiance<a name='11378'></font>
         swddni,  &amp;  <font color=#447700>! All-sky broadband surface direct normal irradiance<a name='11379'></font>
         swddif      <font color=#447700>! All-sky broadband surface diffuse irradiance<a name='11380'></font>
   real, optional, intent(in) :: &amp;<a name='11381'>
         julian      <font color=#447700>! julian day (1-366)<a name='11382'></font>
   real, dimension(ims:ime,jms:jme), optional, intent(in) :: &amp;<a name='11383'>
         xcoszen     <font color=#447700>! cosine of the solar zenith angle<a name='11384'></font>
   real, dimension(:,:,:,:), pointer :: tauaer3d_sw,ssaaer3d_sw,asyaer3d_sw<a name='11385'>
<font color=#447700>! ------------------------ jararias end snippet -----------------<a name='11386'></font>
<a name='11387'>
<a name='11388'>
   REAL, INTENT(IN  )   ::                                   R,G<a name='11389'>
<font color=#447700>!<a name='11390'></font>
<font color=#447700>! Optional<a name='11391'></font>
<font color=#447700>!<a name='11392'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='11393'>
         OPTIONAL                                               , &amp;<a name='11394'>
         INTENT(IN   ) ::                                         &amp;<a name='11395'>
                                                        CLDFRA3D, &amp;<a name='11396'>
                                                         LRADIUS, &amp;<a name='11397'>
                                                         IRADIUS, &amp;<a name='11398'>
                                                            QV3D, &amp;<a name='11399'>
                                                            QC3D, &amp;<a name='11400'>
                                                            QR3D, &amp;<a name='11401'>
                                                            QI3D, &amp;<a name='11402'>
                                                            QS3D, &amp;<a name='11403'>
                                                            QG3D, &amp;<a name='11404'>
                                                        QNDROP3D<a name='11405'>
<a name='11406'>
<font color=#447700>!..Added by G. Thompson to couple cloud physics effective radii.<a name='11407'></font>
   REAL, DIMENSION(ims:ime, kms:kme, jms:jme), INTENT(IN)::       &amp;<a name='11408'>
                                                        RE_CLOUD, &amp;<a name='11409'>
                                                          RE_ICE, &amp;<a name='11410'>
                                                         RE_SNOW<a name='11411'>
   INTEGER, INTENT(IN):: has_reqc, has_reqi, has_reqs<a name='11412'>
<a name='11413'>
   real pi,third,relconst,lwpmin,rhoh2o<a name='11414'>
<a name='11415'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='11416'>
         OPTIONAL                                               , &amp;<a name='11417'>
         INTENT(IN   ) ::                                         &amp;<a name='11418'>
                                                       F_ICE_PHY, &amp;<a name='11419'>
                                                      F_RAIN_PHY<a name='11420'>
<a name='11421'>
   LOGICAL, OPTIONAL, INTENT(IN)   ::                             &amp;<a name='11422'>
                          F_QV,F_QC,F_QR,F_QI,F_QS,F_QG,F_QNDROP<a name='11423'>
<a name='11424'>
<font color=#447700>! Optional<a name='11425'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ), OPTIONAL ,       &amp;<a name='11426'>
       INTENT(IN    ) :: tauaer300,tauaer400,tauaer600,tauaer999, &amp; <font color=#447700>! czhao <a name='11427'></font>
                                 gaer300,gaer400,gaer600,gaer999, &amp; <font color=#447700>! czhao <a name='11428'></font>
                                 waer300,waer400,waer600,waer999    <font color=#447700>! czhao <a name='11429'></font>
<a name='11430'>
   INTEGER,    INTENT(IN  ), OPTIONAL   ::       aer_ra_feedback<a name='11431'>
<font color=#447700>!jdfcz   INTEGER,    INTENT(IN  ), OPTIONAL   ::       progn,prescribe<a name='11432'></font>
   INTEGER,    INTENT(IN  ), OPTIONAL   ::       progn<a name='11433'>
<font color=#447700>!  Ozone<a name='11434'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme )                 , &amp;<a name='11435'>
         OPTIONAL                                               , &amp;<a name='11436'>
         INTENT(IN   ) :: O33D<a name='11437'>
   INTEGER, OPTIONAL, INTENT(IN ) :: o3input<a name='11438'>
<font color=#447700>!  EC aerosol: no_src = naerec = 6<a name='11439'></font>
   INTEGER,           INTENT(IN ) :: no_src<a name='11440'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme, 1:no_src )       , &amp;<a name='11441'>
         OPTIONAL                                               , &amp;<a name='11442'>
         INTENT(IN   ) :: aerod<a name='11443'>
   INTEGER, OPTIONAL, INTENT(IN ) :: aer_opt<a name='11444'>
<a name='11445'>
<font color=#447700>!wavelength corresponding to wavenum1 and wavenum2 (cm-1)<a name='11446'></font>
   real, save :: wavemin(nbndsw) <font color=#447700>! Min wavelength (um) of 14 intervals<a name='11447'></font>
   data wavemin /3.077,2.500,2.150,1.942,1.626,1.299, &amp;<a name='11448'>
   1.242,0.778,0.625,0.442,0.345,0.263,0.200,3.846/<a name='11449'>
   real, save :: wavemax(nbndsw) <font color=#447700>! Max wavelength (um) of interval<a name='11450'></font>
   data wavemax/3.846,3.077,2.500,2.150,1.942,1.626, &amp;<a name='11451'>
   1.299,1.242,0.778,0.625,0.442,0.345,0.263,12.195/<a name='11452'>
   real wavemid(nbndsw) <font color=#447700>! Mid wavelength (um) of interval<a name='11453'></font>
   real, parameter :: thresh=1.e-9<a name='11454'>
   real ang,slope<a name='11455'>
   character(len=200) :: msg<a name='11456'>
<a name='11457'>
<font color=#447700>! Top of atmosphere and surface shortwave fluxes (W m-2)<a name='11458'></font>
   REAL, DIMENSION( ims:ime, jms:jme ),                           &amp;<a name='11459'>
         OPTIONAL, INTENT(INOUT) ::                               &amp;<a name='11460'>
                                       SWUPT,SWUPTC,SWDNT,SWDNTC, &amp;<a name='11461'>
                                       SWUPB,SWUPBC,SWDNB,SWDNBC<a name='11462'>
<a name='11463'>
<font color=#447700>! Layer shortwave fluxes (including extra layer above model top)<a name='11464'></font>
<font color=#447700>! Vertical ordering is from bottom to top (W m-2)<a name='11465'></font>
   REAL, DIMENSION( ims:ime, kms:kme+2, jms:jme ),                &amp;<a name='11466'>
         OPTIONAL, INTENT(OUT) ::                                 &amp;<a name='11467'>
                               SWUPFLX,SWUPFLXC,SWDNFLX,SWDNFLXC<a name='11468'>
<a name='11469'>
<font color=#447700>!  LOCAL VARS<a name='11470'></font>
 <a name='11471'>
   REAL, DIMENSION( kts:kte+1 ) ::                          Pw1D, &amp;<a name='11472'>
                                                            Tw1D<a name='11473'>
<a name='11474'>
   REAL, DIMENSION( kts:kte ) ::                          TTEN1D, &amp;<a name='11475'>
                                                        CLDFRA1D, &amp;<a name='11476'>
                                                            DZ1D, &amp;<a name='11477'>
                                                             P1D, &amp;<a name='11478'>
                                                             T1D, &amp;<a name='11479'>
                                                            QV1D, &amp;<a name='11480'>
                                                            QC1D, &amp;<a name='11481'>
                                                            QR1D, &amp;<a name='11482'>
                                                            QI1D, &amp;<a name='11483'>
                                                            QS1D, &amp;<a name='11484'>
                                                            QG1D, &amp;<a name='11485'>
                                                            O31D, &amp;<a name='11486'>
                                                        qndrop1d <a name='11487'>
<a name='11488'>
<font color=#447700>! Added local arrays for RRTMG<a name='11489'></font>
    integer ::                                              ncol, &amp;<a name='11490'>
                                                            nlay, &amp;<a name='11491'>
                                                            icld, &amp;<a name='11492'>
                                                            iaer, &amp;<a name='11493'>
                                                         inflgsw, &amp;<a name='11494'>
                                                        iceflgsw, &amp;<a name='11495'>
                                                        liqflgsw<a name='11496'>
<font color=#447700>! Dimension with extra layer from model top to TOA<a name='11497'></font>
    real, dimension( (jte-jts+1)*(ite-its+1), kts:kte+2 )  ::                  plev, &amp;<a name='11498'>
                                                            tlev<a name='11499'>
    real, dimension( (jte-jts+1)*(ite-its+1), kts:kte+1 )  ::                  play, &amp;<a name='11500'>
                                                            tlay, &amp;<a name='11501'>
                                                          h2ovmr, &amp;<a name='11502'>
                                                           o3vmr, &amp;<a name='11503'>
                                                          co2vmr, &amp;<a name='11504'>
                                                           o2vmr, &amp;<a name='11505'>
                                                          ch4vmr, &amp;<a name='11506'>
                                                          n2ovmr<a name='11507'>
    real, dimension( kts:kte+1 )  ::                       o3mmr<a name='11508'>
<font color=#447700>! Surface albedo (for UV/visible and near-IR spectral regions,<a name='11509'></font>
<font color=#447700>! and for direct and diffuse radiation)<a name='11510'></font>
    real, dimension( (jte-jts+1)*(ite-its+1) )  ::                            asdir, &amp;<a name='11511'>
                                                           asdif, &amp;<a name='11512'>
                                                           aldir, &amp;<a name='11513'>
                                                           aldif<a name='11514'>
<font color=#447700>! Dimension with extra layer from model top to TOA, <a name='11515'></font>
<font color=#447700>! though no clouds are allowed in extra layer<a name='11516'></font>
    real, dimension( (jte-jts+1)*(ite-its+1), kts:kte+1 )  ::                clwpth, &amp;<a name='11517'>
                                                          ciwpth, &amp;<a name='11518'>
                                                          cswpth, &amp;<a name='11519'>
                                                             rel, &amp;<a name='11520'>
                                                             rei, &amp;<a name='11521'>
                                                             res, &amp;<a name='11522'>
                                                         cldfrac<a name='11523'>
<font color=#447700>!                                                         cldfrac, &amp;<a name='11524'></font>
<font color=#447700>!                                                         relqmcl, &amp;<a name='11525'></font>
<font color=#447700>!                                                         reicmcl, &amp;<a name='11526'></font>
<font color=#447700>!                                                         resnmcl<a name='11527'></font>
    real, dimension( (jte-jts+1)*(ite-its+1), kts:kte+1, nbndsw )  ::        taucld, &amp;<a name='11528'>
                                                          ssacld, &amp;<a name='11529'>
                                                          asmcld, &amp;<a name='11530'>
                                                          fsfcld<a name='11531'>
<font color=#447700>!    real, dimension( ngptsw, (jte-jts+1)*(ite-its+1), kts:kte+1 )  ::       cldfmcl, &amp;<a name='11532'></font>
<font color=#447700>!                                                         clwpmcl, &amp;<a name='11533'></font>
<font color=#447700>!                                                         ciwpmcl, &amp;<a name='11534'></font>
<font color=#447700>!                                                         cswpmcl, &amp;<a name='11535'></font>
<font color=#447700>!                                                         taucmcl, &amp;<a name='11536'></font>
<font color=#447700>!                                                         ssacmcl, &amp;<a name='11537'></font>
<font color=#447700>!                                                         asmcmcl, &amp;<a name='11538'></font>
<font color=#447700>!                                                         fsfcmcl<a name='11539'></font>
    real, dimension( (jte-jts+1)*(ite-its+1), kts:kte+1, nbndsw )  ::        tauaer, &amp;<a name='11540'>
                                                          ssaaer, &amp;<a name='11541'>
                                                          asmaer   <a name='11542'>
    real, dimension( (jte-jts+1)*(ite-its+1), kts:kte+1, naerec )  ::         ecaer<a name='11543'>
<a name='11544'>
<font color=#447700>! Output arrays contain extra layer from model top to TOA<a name='11545'></font>
    real, dimension( (jte-jts+1)*(ite-its+1), kts:kte+2 )  ::                swuflx, &amp;<a name='11546'>
                                                          swdflx, &amp;<a name='11547'>
                                                         swuflxc, &amp;<a name='11548'>
                                                         swdflxc, &amp;<a name='11549'>
                                                       sibvisdir, &amp;  <font color=#447700>! Zhenxin 2011-06-20<a name='11550'></font>
                                                       sibvisdif, &amp;<a name='11551'>
                                                       sibnirdir, &amp;<a name='11552'>
                                                       sibnirdif     <font color=#447700>! Zhenxin 2011-06-20<a name='11553'></font>
<a name='11554'>
    real, dimension( (jte-jts+1)*(ite-its+1), kts:kte+2 ) ::                swdkdir, &amp;  <font color=#447700>! jararias, 2013/08/10<a name='11555'></font>
                                                         swdkdif     <font color=#447700>! jararias, 2013/08/10<a name='11556'></font>
<a name='11557'>
    real, dimension( (jte-jts+1)*(ite-its+1), kts:kte+1 )  ::                  swhr, &amp;<a name='11558'>
                                                           swhrc<a name='11559'>
<a name='11560'>
    real, dimension ( (jte-jts+1)*(ite-its+1) ) ::                             tsfc, &amp;<a name='11561'>
                                                              ps, &amp;<a name='11562'>
                                                          coszen<a name='11563'>
    real ::                                                   ro, &amp;<a name='11564'>
                                                              dz, &amp;<a name='11565'>
                                                           adjes, &amp;<a name='11566'>
                                                            scon, &amp;  <a name='11567'>
                                                snow_mass_factor<a name='11568'>
    integer ::                                            dyofyr<a name='11569'>
<a name='11570'>
    integer:: idx_rei<a name='11571'>
    real:: corr<a name='11572'>
<a name='11573'>
<font color=#447700>! Set trace gas volume mixing ratios, 2005 values, IPCC (2007)<a name='11574'></font>
<font color=#447700>! carbon dioxide (379 ppmv)<a name='11575'></font>
    real :: co2<a name='11576'>
    data co2 / 379.e-6 / <a name='11577'>
<font color=#447700>! methane (1774 ppbv)<a name='11578'></font>
    real :: ch4<a name='11579'>
    data ch4 / 1774.e-9 / <a name='11580'>
<font color=#447700>! nitrous oxide (319 ppbv)<a name='11581'></font>
    real :: n2o<a name='11582'>
    data n2o / 319.e-9 / <a name='11583'>
<font color=#447700>! Set oxygen volume mixing ratio (for o2mmr=0.23143)<a name='11584'></font>
    real :: o2<a name='11585'>
    data o2 / 0.209488 /<a name='11586'>
<a name='11587'>
    integer :: iplon, irng, permuteseed<a name='11588'>
    integer :: nb<a name='11589'>
<a name='11590'>
<font color=#447700>! For old lw cloud property specification<a name='11591'></font>
<font color=#447700>! Cloud and precipitation absorption coefficients<a name='11592'></font>
<font color=#447700>!    real :: abcw,abice,abrn,absn<a name='11593'></font>
<font color=#447700>!    data abcw /0.144/<a name='11594'></font>
<font color=#447700>!    data abice /0.0735/<a name='11595'></font>
<font color=#447700>!    data abrn /0.330e-3/<a name='11596'></font>
<font color=#447700>!    data absn /2.34e-3/<a name='11597'></font>
<a name='11598'>
<font color=#447700>! Molecular weights and ratios for converting mmr to vmr units<a name='11599'></font>
<font color=#447700>!    real :: amd       ! Effective molecular weight of dry air (g/mol)  <a name='11600'></font>
<font color=#447700>!    real :: amw       ! Molecular weight of water vapor (g/mol)        <a name='11601'></font>
<font color=#447700>!    real :: amo       ! Molecular weight of ozone (g/mol)              <a name='11602'></font>
<font color=#447700>!    real :: amo2      ! Molecular weight of oxygen (g/mol)              <a name='11603'></font>
<font color=#447700>! Atomic weights for conversion from mass to volume mixing ratios                <a name='11604'></font>
<font color=#447700>!    data amd   /  28.9660   /                                                  <a name='11605'></font>
<font color=#447700>!    data amw   /  18.0160   /                                                  <a name='11606'></font>
<font color=#447700>!    data amo   /  47.9998   /                                                  <a name='11607'></font>
<font color=#447700>!    data amo2  /  31.9999   /<a name='11608'></font>
                                                                                 <a name='11609'>
    real :: amdw     <font color=#447700>! Molecular weight of dry air / water vapor  <a name='11610'></font>
    real :: amdo     <font color=#447700>! Molecular weight of dry air / ozone<a name='11611'></font>
    real :: amdo2    <font color=#447700>! Molecular weight of dry air / oxygen<a name='11612'></font>
    data amdw /  1.607793 /                                                    <a name='11613'>
    data amdo /  0.603461 /<a name='11614'>
    data amdo2 / 0.905190 /<a name='11615'>
    <a name='11616'>
<font color=#447700>!!<a name='11617'></font>
    real, dimension((jte-jts+1)*(ite-its+1), 1:kte-kts+1 )  :: pdel          <font color=#447700>! Layer pressure thickness (mb)<a name='11618'></font>
<a name='11619'>
    real, dimension((jte-jts+1)*(ite-its+1), 1:kte-kts+1) ::   cicewp, &amp;     <font color=#447700>! in-cloud cloud ice water path<a name='11620'></font>
                                            cliqwp, &amp;     <font color=#447700>! in-cloud cloud liquid water path<a name='11621'></font>
                                            csnowp, &amp;     <font color=#447700>! in-cloud snow water path<a name='11622'></font>
                                             reliq, &amp;     <font color=#447700>! effective drop radius (microns)<a name='11623'></font>
                                             reice        <font color=#447700>! ice effective drop size (microns)<a name='11624'></font>
    real, dimension((jte-jts+1)*(ite-its+1), 1:kte-kts+1):: recloud1d, &amp;<a name='11625'>
                                           reice1d, &amp;<a name='11626'>
                                          resnow1d<a name='11627'>
    real :: gliqwp, gicewp, gsnowp, gravmks<a name='11628'>
<a name='11629'>
<font color=#447700>!<a name='11630'></font>
<font color=#447700>!    REAL   ::  TSFC,GLW0,OLR0,EMISS0,FP<a name='11631'></font>
    REAL   ::  FP<a name='11632'>
<a name='11633'>
<font color=#447700>!    real, dimension(1:ite-its+1 )          ::   clat     ! latitude in radians for columns<a name='11634'></font>
    real :: coszrs                      <font color=#447700>! Cosine of solar zenith angle for present latitude <a name='11635'></font>
    logical :: dorrsw                   <font color=#447700>! Flag to allow shortwave calculation<a name='11636'></font>
<a name='11637'>
    real, dimension ((jte-jts+1)*(ite-its+1)) :: landfrac, landm, snowh, icefrac<a name='11638'>
<a name='11639'>
    integer :: pcols, pver<a name='11640'>
    integer :: icol<a name='11641'>
    integer :: rpart<a name='11642'>
<a name='11643'>
    REAL :: XT24, TLOCTM, HRANG, XXLAT<a name='11644'>
<a name='11645'>
    INTEGER :: i,j,K, na<a name='11646'>
    LOGICAL :: predicate<a name='11647'>
<a name='11648'>
    REAL :: da, eot <font color=#447700>! jararias, 14/08/2013<a name='11649'></font>
<a name='11650'>
    integer :: icnt<a name='11651'>
<a name='11652'>
<font color=#447700>! mji - write<a name='11653'></font>
<font color=#447700>!    REAL, DIMENSION( ims:ime, jms:jme ) ::         SWDB, SWUT<a name='11654'></font>
<a name='11655'>
<font color=#447700>!------------------------------------------------------------------<a name='11656'></font>
#if ( WRF_CHEM == 1 )<a name='11657'>
      IF ( aer_ra_feedback == 1) then<a name='11658'>
      IF ( .NOT. &amp;<a name='11659'>
      ( PRESENT(tauaer300) .AND. &amp;<a name='11660'>
        PRESENT(tauaer400) .AND. &amp;<a name='11661'>
        PRESENT(tauaer600) .AND. &amp;<a name='11662'>
        PRESENT(tauaer999) .AND. &amp;<a name='11663'>
        PRESENT(gaer300) .AND. &amp;<a name='11664'>
        PRESENT(gaer400) .AND. &amp;<a name='11665'>
        PRESENT(gaer600) .AND. &amp;<a name='11666'>
        PRESENT(gaer999) .AND. &amp;<a name='11667'>
        PRESENT(waer300) .AND. &amp;<a name='11668'>
        PRESENT(waer400) .AND. &amp;<a name='11669'>
        PRESENT(waer600) .AND. &amp;<a name='11670'>
        PRESENT(waer999) ) ) THEN<a name='11671'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1103">  &amp;<a name='11672'>
      ('Warning: missing fields required for aerosol radiation' )<a name='11673'>
      ENDIF<a name='11674'>
      ENDIF<a name='11675'>
#endif<a name='11676'>
<a name='11677'>
<font color=#447700>! Initial value of number of columns per partition; <a name='11678'></font>
<font color=#447700>! Use 2 for CPU; for GPU set to 0 here to allow selection<a name='11679'></font>
<font color=#447700>! of appropriate value in rrtmg_sw<a name='11680'></font>
#ifdef _ACCEL<a name='11681'>
      rpart = 0<a name='11682'>
#else<a name='11683'>
      rpart = CHNK<a name='11684'>
#endif<a name='11685'>
<a name='11686'>
<a name='11687'>
<font color=#447700>!-----CALCULATE SHORT WAVE RADIATION<a name='11688'></font>
<font color=#447700>!                                                              <a name='11689'></font>
<font color=#447700>! All fields are ordered vertically from bottom to top<a name='11690'></font>
<font color=#447700>! Pressures are in mb<a name='11691'></font>
<a name='11692'>
<font color=#447700>! jararias, 14/08/2013<a name='11693'></font>
      if (present(xcoszen)) then<a name='11694'>
         call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_795">(100,'coszen from radiation driver')<a name='11695'>
      end if<a name='11696'>
<a name='11697'>
<font color=#447700>! Number of columns to process<a name='11698'></font>
   ncol = (jte-jts+1)*(ite-its+1)<a name='11699'>
<a name='11700'>
   icnt = 0<a name='11701'>
<font color=#447700>! latitude loop<a name='11702'></font>
   j_loop: do j = jts,jte<a name='11703'>
<a name='11704'>
<font color=#447700>! longitude loop<a name='11705'></font>
      i_loop: do i = its,ite<a name='11706'>
<font color=#447700>!<a name='11707'></font>
         icol = i-its+1 + (j-jts)*(ite-its+1)<a name='11708'>
<a name='11709'>
<font color=#447700>! Do shortwave by default, deactivate below if sun below horizon<a name='11710'></font>
         dorrsw = .true.<a name='11711'>
<a name='11712'>
<font color=#447700>! Cosine solar zenith angle for current time step<a name='11713'></font>
<font color=#447700>!<a name='11714'></font>
<font color=#447700>! xt24 is the fractional part of simulation days plus half of radt expressed in <a name='11715'></font>
<font color=#447700>! units of minutes<a name='11716'></font>
<font color=#447700>! julian is in days<a name='11717'></font>
<font color=#447700>! radt is in minutes<a name='11718'></font>
<font color=#447700>! jararias, 14/08/2013<a name='11719'></font>
         if (present(xcoszen)) then<a name='11720'>
            coszr(i,j)=xcoszen(i,j)<a name='11721'>
            coszrs=xcoszen(i,j)<a name='11722'>
         else<a name='11723'>
<font color=#447700>!            da=6.2831853071795862*(julian-1)/365.<a name='11724'></font>
<font color=#447700>!            eot=(0.000075+0.001868*cos(da)-0.032077*sin(da) &amp;<a name='11725'></font>
<font color=#447700>!               -0.014615*cos(2*da)-0.04089*sin(2*da))*(229.18)<a name='11726'></font>
            xt24 = mod(xtime+radt*0.5,1440.)+eot<a name='11727'>
            tloctm = gmt + xt24/60. + xlong(i,j)/15.<a name='11728'>
            hrang = 15. * (tloctm-12.) * degrad<a name='11729'>
            xxlat = xlat(i,j) * degrad<a name='11730'>
            coszrs = sin(xxlat) * sin(declin) &amp;<a name='11731'>
                   + cos(xxlat) * cos(declin) * cos(hrang)<a name='11732'>
            coszr(i,j) = coszrs<a name='11733'>
         end if<a name='11734'>
<a name='11735'>
<font color=#447700>! mji - count daytime points to not process fully nighttime scenes<a name='11736'></font>
         if (coszrs .gt. 0.0) icnt = icnt + 1<a name='11737'>
<a name='11738'>
<font color=#447700>! Set flag to prevent shortwave calculation when sun below horizon<a name='11739'></font>
<font color=#447700>! mji - must set up input everywhere to run model at all grid points on<a name='11740'></font>
<font color=#447700>!       GPU when any daytime points present <a name='11741'></font>
<font color=#447700>!         if (coszrs.le.0.0) dorrsw = .false.<a name='11742'></font>
<a name='11743'>
<font color=#447700>! Perform shortwave calculation if sun above horizon<a name='11744'></font>
         if (dorrsw) then<a name='11745'>
<a name='11746'>
         do k=kts,kte+1<a name='11747'>
            Pw1D(K) = p8w(I,K,J)/100.<a name='11748'>
            Tw1D(K) = t8w(I,K,J)<a name='11749'>
         enddo<a name='11750'>
<a name='11751'>
         DO K=kts,kte<a name='11752'>
            QV1D(K)=0.<a name='11753'>
            QC1D(K)=0.<a name='11754'>
            QR1D(K)=0.<a name='11755'>
            QI1D(K)=0.<a name='11756'>
            QS1D(K)=0.<a name='11757'>
            CLDFRA1D(k)=0.<a name='11758'>
            QNDROP1D(k)=0.<a name='11759'>
         ENDDO<a name='11760'>
<a name='11761'>
         DO K=kts,kte<a name='11762'>
            QV1D(K)=QV3D(I,K,J)<a name='11763'>
            QV1D(K)=max(0.,QV1D(K))<a name='11764'>
         ENDDO<a name='11765'>
<a name='11766'>
         IF (PRESENT(O33D)) THEN<a name='11767'>
            DO K=kts,kte<a name='11768'>
               O31D(K)=O33D(I,K,J)<a name='11769'>
            ENDDO<a name='11770'>
         ELSE<a name='11771'>
            DO K=kts,kte<a name='11772'>
               O31D(K)=0.0<a name='11773'>
            ENDDO<a name='11774'>
         ENDIF<a name='11775'>
<a name='11776'>
         DO K=kts,kte<a name='11777'>
            TTEN1D(K)=0.<a name='11778'>
            T1D(K)=t3d(I,K,J)<a name='11779'>
            P1D(K)=p3d(I,K,J)/100.<a name='11780'>
            DZ1D(K)=dz8w(I,K,J)<a name='11781'>
         ENDDO<a name='11782'>
<a name='11783'>
<font color=#447700>! moist variables<a name='11784'></font>
<a name='11785'>
         IF (ICLOUD .ne. 0) THEN<a name='11786'>
            IF ( PRESENT( CLDFRA3D ) ) THEN<a name='11787'>
              DO K=kts,kte<a name='11788'>
                 CLDFRA1D(k)=CLDFRA3D(I,K,J)<a name='11789'>
              ENDDO<a name='11790'>
            ENDIF<a name='11791'>
<a name='11792'>
            IF (PRESENT(F_QC) .AND. PRESENT(QC3D)) THEN<a name='11793'>
              IF ( F_QC) THEN<a name='11794'>
                 DO K=kts,kte<a name='11795'>
                    QC1D(K)=QC3D(I,K,J)<a name='11796'>
                    QC1D(K)=max(0.,QC1D(K))<a name='11797'>
                 ENDDO<a name='11798'>
              ENDIF<a name='11799'>
            ENDIF<a name='11800'>
<a name='11801'>
            IF (PRESENT(F_QR) .AND. PRESENT(QR3D)) THEN<a name='11802'>
              IF ( F_QR) THEN<a name='11803'>
                 DO K=kts,kte<a name='11804'>
                    QR1D(K)=QR3D(I,K,J)<a name='11805'>
                    QR1D(K)=max(0.,QR1D(K))<a name='11806'>
                 ENDDO<a name='11807'>
              ENDIF<a name='11808'>
            ENDIF<a name='11809'>
<a name='11810'>
            IF ( PRESENT(F_QNDROP).AND.PRESENT(QNDROP3D)) THEN<a name='11811'>
             IF (F_QNDROP) THEN<a name='11812'>
              DO K=kts,kte<a name='11813'>
               qndrop1d(K)=qndrop3d(I,K,J)<a name='11814'>
              ENDDO<a name='11815'>
             ENDIF<a name='11816'>
            ENDIF<a name='11817'>
<a name='11818'>
<font color=#447700>! This logic is tortured because cannot test F_QI unless<a name='11819'></font>
<font color=#447700>! it is present, and order of evaluation of expressions<a name='11820'></font>
<font color=#447700>! is not specified in Fortran<a name='11821'></font>
<a name='11822'>
            IF ( PRESENT ( F_QI ) ) THEN<a name='11823'>
              predicate = F_QI<a name='11824'>
            ELSE<a name='11825'>
              predicate = .FALSE.<a name='11826'>
            ENDIF<a name='11827'>
<a name='11828'>
<font color=#447700>! For MP option 3<a name='11829'></font>
            IF (.NOT. predicate .and. .not. warm_rain) THEN<a name='11830'>
               DO K=kts,kte<a name='11831'>
                  IF (T1D(K) .lt. 273.15) THEN<a name='11832'>
                  QI1D(K)=QC1D(K)<a name='11833'>
                  QS1D(K)=QR1D(K)<a name='11834'>
                  QC1D(K)=0.<a name='11835'>
                  QR1D(K)=0.<a name='11836'>
                  ENDIF<a name='11837'>
               ENDDO<a name='11838'>
            ENDIF<a name='11839'>
<a name='11840'>
            IF (PRESENT(F_QI) .AND. PRESENT(QI3D)) THEN<a name='11841'>
               IF (F_QI) THEN<a name='11842'>
                  DO K=kts,kte<a name='11843'>
                     QI1D(K)=QI3D(I,K,J)<a name='11844'>
                     QI1D(K)=max(0.,QI1D(K))<a name='11845'>
                  ENDDO<a name='11846'>
               ENDIF<a name='11847'>
            ENDIF<a name='11848'>
<a name='11849'>
            IF (PRESENT(F_QS) .AND. PRESENT(QS3D)) THEN<a name='11850'>
               IF (F_QS) THEN<a name='11851'>
                  DO K=kts,kte<a name='11852'>
                     QS1D(K)=QS3D(I,K,J)<a name='11853'>
                     QS1D(K)=max(0.,QS1D(K))<a name='11854'>
                  ENDDO<a name='11855'>
               ENDIF<a name='11856'>
            ENDIF<a name='11857'>
<a name='11858'>
            IF (PRESENT(F_QG) .AND. PRESENT(QG3D)) THEN<a name='11859'>
               IF (F_QG) THEN<a name='11860'>
                  DO K=kts,kte<a name='11861'>
                     QG1D(K)=QG3D(I,K,J)<a name='11862'>
                     QG1D(K)=max(0.,QG1D(K))<a name='11863'>
                  ENDDO<a name='11864'>
               ENDIF<a name='11865'>
            ENDIF<a name='11866'>
<a name='11867'>
<font color=#447700>! mji - For MP option 5<a name='11868'></font>
            IF ( PRESENT(F_QI) .and. PRESENT(F_QC) .and. PRESENT(F_QS) .and. PRESENT(F_ICE_PHY) ) THEN<a name='11869'>
               IF ( F_QC .and. .not. F_QI .and. F_QS ) THEN<a name='11870'>
                  DO K=kts,kte<a name='11871'>
                     qi1d(k) = 0.1*qs3d(i,k,j)<a name='11872'>
                     qs1d(k) = 0.9*qs3d(i,k,j)<a name='11873'>
                     qc1d(k) = qc3d(i,k,j)<a name='11874'>
                     qi1d(k) = max(0.,qi1d(k))<a name='11875'>
                     qc1d(k) = max(0.,qc1d(k))<a name='11876'>
                  ENDDO<a name='11877'>
               ENDIF<a name='11878'>
            ENDIF<a name='11879'>
<a name='11880'>
         ENDIF<a name='11881'>
<a name='11882'>
<font color=#447700>!         EMISS0=EMISS(I,J)<a name='11883'></font>
<font color=#447700>!         GLW0=0. <a name='11884'></font>
<font color=#447700>!         OLR0=0. <a name='11885'></font>
<font color=#447700>!         TSFC=TSK(I,J)<a name='11886'></font>
         DO K=kts,kte<a name='11887'>
            QV1D(K)=AMAX1(QV1D(K),1.E-12) <a name='11888'>
         ENDDO<a name='11889'>
<a name='11890'>
<font color=#447700>! Set up input for shortwave<a name='11891'></font>
<font color=#447700>!         ncol = 1<a name='11892'></font>
<font color=#447700>! Add extra layer from top of model to top of atmosphere<a name='11893'></font>
         nlay = (kte - kts + 1) + 1<a name='11894'>
<a name='11895'>
<font color=#447700>! Select cloud liquid and ice optics parameterization options<a name='11896'></font>
<font color=#447700>! For passing in cloud optical properties directly:<a name='11897'></font>
<font color=#447700>!         icld = 2<a name='11898'></font>
<font color=#447700>!         inflgsw = 0<a name='11899'></font>
<font color=#447700>!         iceflgsw = 0<a name='11900'></font>
<font color=#447700>!         liqflgsw = 0<a name='11901'></font>
<font color=#447700>! For passing in cloud physical properties; cloud optics parameterized in RRTMG:<a name='11902'></font>
         icld = 2<a name='11903'>
         inflgsw = 2<a name='11904'>
         iceflgsw = 3<a name='11905'>
         liqflgsw = 1<a name='11906'>
<a name='11907'>
<font color=#447700>!Mukul change the flags here with reference to the new effective cloud/ice/snow radius<a name='11908'></font>
         IF (ICLOUD .ne. 0) THEN<a name='11909'>
            IF ( has_reqc .ne. 0) THEN<a name='11910'>
               inflgsw = 3<a name='11911'>
               DO K=kts,kte<a name='11912'>
                  recloud1D(icol,K) = MAX(2.5, re_cloud(I,K,J)*1.E6)<a name='11913'>
                  if (recloud1D(icol,K).LE.2.5.AND.cldfra3d(i,k,j).gt.0. &amp;<a name='11914'>
     &amp;                            .AND. (XLAND(I,J)-1.5).GT.0.) then      <font color=#447700>!--- Ocean<a name='11915'></font>
                     recloud1D(icol,K) = 10.5<a name='11916'>
                  elseif (recloud1D(icol,K).LE.2.5.AND.cldfra3d(i,k,j).gt.0. &amp;<a name='11917'>
     &amp;                            .AND. (XLAND(I,J)-1.5).LT.0.) then      <font color=#447700>!--- Land<a name='11918'></font>
                     recloud1D(icol,K) = 7.5<a name='11919'>
                  endif<a name='11920'>
               ENDDO<a name='11921'>
            ELSE<a name='11922'>
               DO K=kts,kte<a name='11923'>
                  recloud1D(icol,K) = 5.0<a name='11924'>
               ENDDO<a name='11925'>
            ENDIF<a name='11926'>
<a name='11927'>
            IF ( has_reqi .ne. 0) THEN<a name='11928'>
               inflgsw  = 4<a name='11929'>
               iceflgsw = 4<a name='11930'>
               DO K=kts,kte<a name='11931'>
                  reice1D(icol,K) = MAX(5., re_ice(I,K,J)*1.E6)<a name='11932'>
                  if (reice1D(icol,K).LE.5..AND.cldfra3d(i,k,j).gt.0.) then<a name='11933'>
                     idx_rei = int(t3d(i,k,j)-179.)<a name='11934'>
                     idx_rei = min(max(idx_rei,1),75)<a name='11935'>
                     corr = t3d(i,k,j) - int(t3d(i,k,j))<a name='11936'>
                     reice1D(icol,K) = retab(idx_rei)*(1.-corr) +      &amp;<a name='11937'>
     &amp;                                 retab(idx_rei+1)*corr<a name='11938'>
                     reice1D(icol,K) = MAX(reice1D(icol,K), 5.0)<a name='11939'>
                  endif<a name='11940'>
               ENDDO<a name='11941'>
            ELSE<a name='11942'>
               DO K=kts,kte<a name='11943'>
                  reice1D(icol,K) = 10.0<a name='11944'>
               ENDDO<a name='11945'>
            ENDIF<a name='11946'>
<a name='11947'>
            IF ( has_reqs .ne. 0) THEN<a name='11948'>
               inflgsw  = 5<a name='11949'>
               iceflgsw = 5<a name='11950'>
               DO K=kts,kte<a name='11951'>
                  resnow1D(icol,K) = MAX(10., re_snow(I,K,J)*1.E6)<a name='11952'>
               ENDDO<a name='11953'>
            ELSE<a name='11954'>
               DO K=kts,kte<a name='11955'>
                  resnow1D(icol,K) = 10.<a name='11956'>
               ENDDO<a name='11957'>
            ENDIF<a name='11958'>
<a name='11959'>
<font color=#447700>! special case for P3 microphysics<a name='11960'></font>
<font color=#447700>! put ice into snow category for optics, then set ice to zero<a name='11961'></font>
            IF ( has_reqs .eq. 0 .and. has_reqi .ne. 0 .and. has_reqc .ne. 0) THEN<a name='11962'>
               inflgsw  = 5<a name='11963'>
               iceflgsw = 5<a name='11964'>
               DO K=kts,kte<a name='11965'>
                  resnow1D(ncol,K) = MAX(10., re_ice(I,K,J)*1.E6)<a name='11966'>
                  QS1D(K)=QI3D(I,K,J)<a name='11967'>
                  QI1D(K)=0.<a name='11968'>
                  reice1D(ncol,K)=10.<a name='11969'>
               END DO<a name='11970'>
<a name='11971'>
            END IF<a name='11972'>
<a name='11973'>
         ENDIF<a name='11974'>
<a name='11975'>
<font color=#447700>! Set cosine of solar zenith angle<a name='11976'></font>
         coszen(icol) = coszrs<a name='11977'>
<font color=#447700>! Set solar constant<a name='11978'></font>
         scon = solcon<a name='11979'>
<font color=#447700>! For Earth/Sun distance adjustment in RRTMG<a name='11980'></font>
<font color=#447700>!         dyofyr = julday<a name='11981'></font>
<font color=#447700>!         adjes = 0.0 <a name='11982'></font>
<font color=#447700>! For WRF, solar constant is already provided with eccentricity adjustment,<a name='11983'></font>
<font color=#447700>! so do not do this in RRTMG<a name='11984'></font>
         dyofyr = 0<a name='11985'>
         adjes = 1.0 <a name='11986'>
<a name='11987'>
<font color=#447700>! Layer indexing goes bottom to top here for all fields.<a name='11988'></font>
<font color=#447700>! Water vapor and ozone are converted from mmr to vmr. <a name='11989'></font>
<font color=#447700>! Pressures are in units of mb here. <a name='11990'></font>
         plev(icol,1) = pw1d(1)<a name='11991'>
         tlev(icol,1) = tw1d(1)<a name='11992'>
         tsfc(icol) = tsk(i,j)<a name='11993'>
         do k = kts, kte<a name='11994'>
            play(icol,k) = p1d(k)<a name='11995'>
            plev(icol,k+1) = pw1d(k+1)<a name='11996'>
            pdel(icol,k) = plev(icol,k) - plev(icol,k+1)<a name='11997'>
            tlay(icol,k) = t1d(k)<a name='11998'>
            tlev(icol,k+1) = tw1d(k+1)<a name='11999'>
            h2ovmr(icol,k) = qv1d(k) * amdw<a name='12000'>
            co2vmr(icol,k) = co2<a name='12001'>
            o2vmr(icol,k) = o2<a name='12002'>
            ch4vmr(icol,k) = ch4<a name='12003'>
            n2ovmr(icol,k) = n2o<a name='12004'>
         enddo<a name='12005'>
<a name='12006'>
<font color=#447700>!  Define profile values for extra layer from model top to top of atmosphere. <a name='12007'></font>
<font color=#447700>!  The top layer temperature for all gridpoints is set to the top layer-1 <a name='12008'></font>
<font color=#447700>!  temperature plus a constant (0 K) that represents an isothermal layer    <a name='12009'></font>
<font color=#447700>!  above ptop.  Top layer interface temperatures are linearly interpolated <a name='12010'></font>
<font color=#447700>!  from the layer temperatures.  <a name='12011'></font>
<a name='12012'>
         play(icol,kte+1) = 0.5 * plev(icol,kte+1)<a name='12013'>
         tlay(icol,kte+1) = tlev(icol,kte+1) + 0.0<a name='12014'>
         plev(icol,kte+2) = 1.0e-5<a name='12015'>
         tlev(icol,kte+2) = tlev(icol,kte+1) + 0.0<a name='12016'>
         tlev(icol,kte+2) = tlev(icol,kte+1) + 0.0<a name='12017'>
         h2ovmr(icol,kte+1) = h2ovmr(icol,kte) <a name='12018'>
         co2vmr(icol,kte+1) = co2vmr(icol,kte) <a name='12019'>
         o2vmr(icol,kte+1) = o2vmr(icol,kte) <a name='12020'>
         ch4vmr(icol,kte+1) = ch4vmr(icol,kte) <a name='12021'>
         n2ovmr(icol,kte+1) = n2ovmr(icol,kte) <a name='12022'>
<a name='12023'>
<font color=#447700>! Get ozone profile including amount in extra layer above model top<a name='12024'></font>
<font color=#447700>!         call inirad (o3mmr,plev,kts,kte)<a name='12025'></font>
         call <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#INIRAD'>inirad</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INIRAD_6"> (o3mmr,plev(icol,:),kts,kte)<a name='12026'>
<a name='12027'>
        if(present(o33d)) then<a name='12028'>
         do k = kts, kte+1<a name='12029'>
            o3vmr(icol,k) = o3mmr(k) * amdo<a name='12030'>
            IF ( PRESENT( O33D ) ) THEN<a name='12031'>
            if(o3input .eq. 2)then<a name='12032'>
               if(k.le.kte)then<a name='12033'>
                 o3vmr(icol,k) = o31d(k)<a name='12034'>
               else<a name='12035'>
<font color=#447700>! apply shifted climatology profile above model top<a name='12036'></font>
                 o3vmr(icol,k) = o31d(kte) - o3mmr(kte)*amdo + o3mmr(k)*amdo<a name='12037'>
                 if(o3vmr(icol,k) .le. 0.)o3vmr(icol,k) = o3mmr(k)*amdo<a name='12038'>
               endif<a name='12039'>
            endif<a name='12040'>
            ENDIF<a name='12041'>
         enddo<a name='12042'>
        else<a name='12043'>
         do k = kts, kte+1<a name='12044'>
            o3vmr(icol,k) = o3mmr(k) * amdo<a name='12045'>
         enddo<a name='12046'>
        endif<a name='12047'>
<a name='12048'>
<font color=#447700>! Set surface albedo for direct and diffuse radiation in UV/visible and<a name='12049'></font>
<font color=#447700>! near-IR spectral regions<a name='12050'></font>
<font color=#447700>! -------------- Zhenxin 2011-06-20 ----------- !<a name='12051'></font>
<a name='12052'>
<font color=#447700>! ------- 1.  Commented by Zhenxin 2011-06-20 for SSiB coupling modified ---- !<a name='12053'></font>
<font color=#447700>!         asdir(icol) = albedo(i,j)<a name='12054'></font>
<font color=#447700>!         asdif(icol) = albedo(i,j)<a name='12055'></font>
<font color=#447700>!         aldir(icol) = albedo(i,j)<a name='12056'></font>
<font color=#447700>!         aldif(icol) = albedo(i,j)<a name='12057'></font>
<font color=#447700>! -------    End of Comments    ------ !<a name='12058'></font>
<a name='12059'>
<font color=#447700>! ------- 2. New Addition  ------ !<a name='12060'></font>
    IF ( sf_surface_physics .eq. 8 .AND. XLAND(i,j) .LT. 1.5) THEN<a name='12061'>
         asdir(icol) = ALSWVISDIR(I,J)<a name='12062'>
         asdif(icol) = ALSWVISDIF(I,J)<a name='12063'>
         aldir(icol) = ALSWNIRDIR(I,J)<a name='12064'>
         aldif(icol) = ALSWNIRDIF(I,J)<a name='12065'>
    ELSE<a name='12066'>
         asdir(icol) = albedo(i,j)<a name='12067'>
         asdif(icol) = albedo(i,j)<a name='12068'>
         aldir(icol) = albedo(i,j)<a name='12069'>
         aldif(icol) = albedo(i,j)<a name='12070'>
    ENDIF<a name='12071'>
<a name='12072'>
<font color=#447700>! ---------- End of Addition ------!<a name='12073'></font>
<font color=#447700>! ----------  End of fds_Zhenxin 2011-06-20   --------------!<a name='12074'></font>
<a name='12075'>
<font color=#447700>! Define cloud optical properties for radiation (inflgsw = 0)<a name='12076'></font>
<font color=#447700>! This option is not currently active<a name='12077'></font>
<font color=#447700>! Cloud and precipitation paths in g/m2 <a name='12078'></font>
<font color=#447700>! qi=0 if no ice phase<a name='12079'></font>
<font color=#447700>! qs=0 if no ice phase<a name='12080'></font>
         if (inflgsw .eq. 0) then<a name='12081'>
<a name='12082'>
<font color=#447700>! Set cloud fraction and cloud optical properties here; not yet active<a name='12083'></font>
            do k = kts, kte<a name='12084'>
               cldfrac(icol,k) = cldfra1d(k)<a name='12085'>
               do nb = 1, nbndsw<a name='12086'>
                  taucld(icol,k,nb) = 0.0<a name='12087'>
                  ssacld(icol,k,nb) = 1.0<a name='12088'>
                  asmcld(icol,k,nb) = 0.0<a name='12089'>
                  fsfcld(icol,k,nb) = 0.0<a name='12090'>
               enddo<a name='12091'>
            enddo<a name='12092'>
<a name='12093'>
<font color=#447700>! Zero out cloud physical property arrays; not used when passing optical properties<a name='12094'></font>
<font color=#447700>! into radiation<a name='12095'></font>
            do k = kts, kte<a name='12096'>
               clwpth(icol,k) = 0.0<a name='12097'>
               ciwpth(icol,k) = 0.0<a name='12098'>
               rel(icol,k) = 10.0<a name='12099'>
               rei(icol,k) = 10.<a name='12100'>
            enddo<a name='12101'>
         endif<a name='12102'>
<a name='12103'>
<font color=#447700>! Define cloud physical properties for radiation (inflgsw = 1 or 2)<a name='12104'></font>
<font color=#447700>! Cloud fraction<a name='12105'></font>
<font color=#447700>! Set cloud arrays if passing cloud physical properties into radiation<a name='12106'></font>
         if (inflgsw .gt. 0) then <a name='12107'>
            do k = kts, kte<a name='12108'>
               cldfrac(icol,k) = cldfra1d(k)<a name='12109'>
            enddo<a name='12110'>
<a name='12111'>
<font color=#447700>! Compute cloud water/ice paths and particle sizes for input to radiation (CAM method)<a name='12112'></font>
            pcols = ncol<a name='12113'>
            pver = kte - kts + 1<a name='12114'>
            gravmks = g<a name='12115'>
            landfrac(icol) = 2.-XLAND(I,J)<a name='12116'>
            landm(icol) = landfrac(icol)<a name='12117'>
            snowh(icol) = 0.001*SNOW(I,J)<a name='12118'>
            icefrac(icol) = XICE(I,J)<a name='12119'>
<a name='12120'>
<font color=#447700>! From module_ra_cam: Convert liquid and ice mixing ratios to water paths;<a name='12121'></font>
<font color=#447700>! pdel is in mb here; convert back to Pa (*100.)<a name='12122'></font>
<font color=#447700>! Water paths are in units of g/m2<a name='12123'></font>
<font color=#447700>! snow added as ice cloud (JD 091022)<a name='12124'></font>
            do k = kts, kte<a name='12125'>
               gicewp = (qi1d(k)+qs1d(k)) * pdel(icol,k)*100.0 / gravmks * 1000.0     <font color=#447700>! Grid box ice water path.<a name='12126'></font>
               gliqwp = qc1d(k) * pdel(icol,k)*100.0 / gravmks * 1000.0     <font color=#447700>! Grid box liquid water path.<a name='12127'></font>
               cicewp(icol,k) = gicewp / max(0.01,cldfrac(icol,k))               <font color=#447700>! In-cloud ice water path.<a name='12128'></font>
               cliqwp(icol,k) = gliqwp / max(0.01,cldfrac(icol,k))               <font color=#447700>! In-cloud liquid water path.<a name='12129'></font>
            end do<a name='12130'>
<a name='12131'>
<font color=#447700>! Mukul<a name='12132'></font>
<font color=#447700>!..The ice water path is already sum of cloud ice and snow, but when we have explicit<a name='12133'></font>
<font color=#447700>!.. ice effective radius, overwrite the ice path with only the cloud ice variable,<a name='12134'></font>
<font color=#447700>!.. leaving out the snow for its own effect.<a name='12135'></font>
           if(iceflgsw.ge.4)then <a name='12136'>
              do k = kts, kte<a name='12137'>
                     gicewp = qi1d(k) * pdel(icol,k)*100.0 / gravmks * 1000.0     <font color=#447700>! Grid box ice water path.<a name='12138'></font>
                     cicewp(icol,k) = gicewp / max(0.01,cldfrac(icol,k))               <font color=#447700>! In-cloud ice water path.<a name='12139'></font>
              end do<a name='12140'>
           end if<a name='12141'>
<a name='12142'>
<font color=#447700>!..Here the snow path is adjusted if (radiation) effective radius of snow is<a name='12143'></font>
<font color=#447700>!.. larger than what we currently have in the lookup tables.  Since mass goes<a name='12144'></font>
<font color=#447700>!.. rather close to diameter squared, adjust the mixing ratio of snow used<a name='12145'></font>
<font color=#447700>!.. to compute its water path in combination with the max diameter.  Not a<a name='12146'></font>
<font color=#447700>!.. perfect fix, but certainly better than using all snow mass when diameter is<a name='12147'></font>
<font color=#447700>!.. far larger than table currently contains and crystal sizes much larger than<a name='12148'></font>
<font color=#447700>!.. about 140 microns have lesser impact than those much smaller sizes.<a name='12149'></font>
<a name='12150'>
           if(iceflgsw.eq.5)then<a name='12151'>
              do k = kts, kte<a name='12152'>
                 snow_mass_factor = 1.0                 <a name='12153'>
                 if (resnow1d(icol,k) .gt. 130.)then <a name='12154'>
                     snow_mass_factor = (130.0/resnow1d(icol,k))*(130.0/resnow1d(icol,k))<a name='12155'>
                     resnow1d(icol,k)   = 130.0<a name='12156'>
                 endif<a name='12157'>
                 gsnowp = qs1d(k) * snow_mass_factor * pdel(icol,k)*100.0 / gravmks * 1000.0     <font color=#447700>! Grid box snow water path.<a name='12158'></font>
                 csnowp(icol,k) = gsnowp / max(0.01,cldfrac(icol,k))<a name='12159'>
              end do<a name='12160'>
           end if<a name='12161'>
<a name='12162'>
<a name='12163'>
<font color=#447700>!link the aerosol feedback to cloud  -czhao<a name='12164'></font>
  if( PRESENT( progn ) ) then<a name='12165'>
    if (progn == 1) then<a name='12166'>
<font color=#447700>!jdfcz     if(prescribe==0) then<a name='12167'></font>
<a name='12168'>
      pi = 4.*atan(1.0)<a name='12169'>
      third=1./3.<a name='12170'>
      rhoh2o=1.e3<a name='12171'>
      relconst=3/(4.*pi*rhoh2o)<a name='12172'>
<font color=#447700>!     minimun liquid water path to calculate rel<a name='12173'></font>
<font color=#447700>!     corresponds to optical depth of 1.e-3 for radius 4 microns.<a name='12174'></font>
      lwpmin=3.e-5<a name='12175'>
      do k = kts, kte<a name='12176'>
         reliq(icol,k) = 10.<a name='12177'>
         if( PRESENT( F_QNDROP ) ) then<a name='12178'>
            if( F_QNDROP ) then<a name='12179'>
              if ( qc1d(k)*pdel(icol,k).gt.lwpmin.and. &amp;<a name='12180'>
                   qndrop1d(k).gt.1000. ) then<a name='12181'>
               reliq(icol,k)=(relconst*qc1d(k)/qndrop1d(k))**third <font color=#447700>! effective radius in m<a name='12182'></font>
<font color=#447700>!           apply scaling from Martin et al., JAS 51, 1830.<a name='12183'></font>
               reliq(icol,k)=1.1*reliq(icol,k)<a name='12184'>
               reliq(icol,k)=reliq(icol,k)*1.e6 <font color=#447700>! convert from m to microns<a name='12185'></font>
               reliq(icol,k)=max(reliq(icol,k),4.)<a name='12186'>
               reliq(icol,k)=min(reliq(icol,k),20.)<a name='12187'>
              end if<a name='12188'>
            end if<a name='12189'>
         end if<a name='12190'>
      end do<a name='12191'>
<font color=#447700>!jdfcz     else ! prescribe <a name='12192'></font>
<font color=#447700>! following Kiehl<a name='12193'></font>
<font color=#447700>!      call relcalc(icol, pcols, pver, tlay, landfrac, landm, icefrac, reliq, snowh)<a name='12194'></font>
<font color=#447700>!      write(0,*) 'sw prescribe aerosol',maxval(qndrop3d)<a name='12195'></font>
<font color=#447700>!jdfcz     endif<a name='12196'></font>
    else  <font color=#447700>! progn   (progn=1)<a name='12197'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#RELCALC'>relcalc</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RELCALC_7">(icol, pcols, pver, tlay, landfrac, landm, icefrac, reliq, snowh)<a name='12198'>
    endif<a name='12199'>
  else   <font color=#447700>!progn   (PRESENT)<a name='12200'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#RELCALC'>relcalc</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RELCALC_8">(icol, pcols, pver, tlay, landfrac, landm, icefrac, reliq, snowh)<a name='12201'>
  endif<a name='12202'>
<a name='12203'>
<font color=#447700>! following Kristjansson and Mitchell<a name='12204'></font>
      call <A href='../../html_code/phys/module_ra_rrtmg_lwf.F.html#REICALC'>reicalc</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="REICALC_4">(icol, pcols, pver, tlay, reice)<a name='12205'>
<a name='12206'>
<a name='12207'>
<a name='12208'>
<font color=#447700>!..If we already have effective radius of cloud and ice, then just overwrite what<a name='12209'></font>
<font color=#447700>!.. was computed in the relcalc and reicalc subroutines above.<a name='12210'></font>
<a name='12211'>
      if (inflgsw .ge. 3) then<a name='12212'>
         do k = kts, kte<a name='12213'>
            reliq(icol,k) = recloud1d(icol,k)<a name='12214'>
         end do<a name='12215'>
      endif<a name='12216'>
      if (iceflgsw .ge. 4) then<a name='12217'>
         do k = kts, kte<a name='12218'>
            reice(icol,k) = reice1d(icol,k)<a name='12219'>
         end do<a name='12220'>
      endif<a name='12221'>
<a name='12222'>
<a name='12223'>
<font color=#447700>! Limit upper bound of reice for Fu ice parameterization and convert<a name='12224'></font>
<font color=#447700>! from effective radius to generalized effective size (*1.0315; Fu, 1996)<a name='12225'></font>
            if (iceflgsw .eq. 3) then<a name='12226'>
               do k = kts, kte<a name='12227'>
                  reice(icol,k) = reice(icol,k) * 1.0315<a name='12228'>
                  reice(icol,k) = min(140.0,reice(icol,k))<a name='12229'>
               end do<a name='12230'>
            endif<a name='12231'>
<a name='12232'>
<font color=#447700>!if CAMMGMP is used, use output from CAMMGMP            <a name='12233'></font>
<font color=#447700>!PMA<a name='12234'></font>
            if(is_CAMMGMP_used) then<a name='12235'>
               do k = kts, kte<a name='12236'>
                  if ( qi1d(k) .gt. 1.e-20 .or. qs1d(k) .gt. 1.e-20) then<a name='12237'>
                     reice(icol,k) = iradius(i,k,j)<a name='12238'>
                  else<a name='12239'>
                     reice(icol,k) = 25.<a name='12240'>
                  end if<a name='12241'>
                  reice(icol,k) = max(5., min(140.0,reice(icol,k)))<a name='12242'>
                  if ( qc1d(k) .gt. 1.e-20) then<a name='12243'>
                     reliq(icol,k) = lradius(i,k,j)<a name='12244'>
                  else<a name='12245'>
                     reliq(icol,k) = 10.<a name='12246'>
                  end if<a name='12247'>
                  reliq(icol,k) = max(2.5, min(60.0,reliq(icol,k)))<a name='12248'>
               enddo<a name='12249'>
            endif<a name='12250'>
<a name='12251'>
<font color=#447700>! Set cloud physical property arrays<a name='12252'></font>
            do k = kts, kte<a name='12253'>
               clwpth(icol,k) = cliqwp(icol,k)<a name='12254'>
               ciwpth(icol,k) = cicewp(icol,k)<a name='12255'>
               rel(icol,k) = reliq(icol,k)<a name='12256'>
               rei(icol,k) = reice(icol,k)<a name='12257'>
            enddo<a name='12258'>
<a name='12259'>
<font color=#447700>!Mukul<a name='12260'></font>
            if (inflgsw .eq. 5) then<a name='12261'>
               do k = kts, kte<a name='12262'>
                  cswpth(icol,k) = csnowp(icol,k)<a name='12263'>
                  res(icol,k) = resnow1d(icol,k)<a name='12264'>
               end do<a name='12265'>
            else<a name='12266'>
               do k = kts, kte<a name='12267'>
                  cswpth(icol,k) = 0.0<a name='12268'>
                  res(icol,k) = 10.0<a name='12269'>
               end do<a name='12270'>
            endif<a name='12271'>
<a name='12272'>
<font color=#447700>! Zero out cloud optical properties here, calculated in radiation <a name='12273'></font>
            do k = kts, kte<a name='12274'>
               do nb = 1, nbndsw<a name='12275'>
                  taucld(icol,k,nb) = 0.0<a name='12276'>
                  ssacld(icol,k,nb) = 1.0<a name='12277'>
                  asmcld(icol,k,nb) = 0.0<a name='12278'>
                  fsfcld(icol,k,nb) = 0.0<a name='12279'>
               enddo<a name='12280'>
            enddo<a name='12281'>
         endif<a name='12282'>
<a name='12283'>
<font color=#447700>! No clouds are allowed in the extra layer from model top to TOA<a name='12284'></font>
         clwpth(icol,kte+1) = 0.<a name='12285'>
         ciwpth(icol,kte+1) = 0.<a name='12286'>
         cswpth(icol,kte+1) = 0.<a name='12287'>
         rel(icol,kte+1) = 10.<a name='12288'>
         rei(icol,kte+1) = 10.<a name='12289'>
         res(icol,kte+1) = 10.<a name='12290'>
         cldfrac(icol,kte+1) = 0.<a name='12291'>
         do nb = 1, nbndsw<a name='12292'>
            taucld(icol,kte+1,nb) = 0.<a name='12293'>
            ssacld(icol,kte+1,nb) = 1.<a name='12294'>
            asmcld(icol,kte+1,nb) = 0.<a name='12295'>
            fsfcld(icol,kte+1,nb) = 0.<a name='12296'>
         enddo<a name='12297'>
<a name='12298'>
<font color=#447700>! mji - mcica sub-column generator called inside rrtmg_sw for gpu<a name='12299'></font>
<font color=#447700>!         iplon = 1<a name='12300'></font>
<font color=#447700>!         irng = 0<a name='12301'></font>
<font color=#447700>!         permuteseed = 1<a name='12302'></font>
<font color=#447700>! Sub-column generator for McICA<a name='12303'></font>
<font color=#447700>!         call mcica_subcol_sw(iplon, icol, nlay, icld, permuteseed, irng, play, &amp;<a name='12304'></font>
<font color=#447700>!                       cldfrac, ciwpth, clwpth, cswpth, rei, rel, res, taucld, ssacld, asmcld, fsfcld, &amp;<a name='12305'></font>
<font color=#447700>!                       cldfmcl, ciwpmcl, clwpmcl, cswpmcl, reicmcl, relqmcl, resnmcl, &amp;<a name='12306'></font>
<font color=#447700>!                       taucmcl, ssacmcl, asmcmcl, fsfcmcl)<a name='12307'></font>
<a name='12308'>
<font color=#447700>!--------------------------------------------------------------------------<a name='12309'></font>
<font color=#447700>! Aerosol optical depth, single scattering albedo and asymmetry parameter -czhao 03/2010<a name='12310'></font>
<font color=#447700>!--------------------------------------------------------------------------<a name='12311'></font>
<font color=#447700>! by layer for each RRTMG shortwave band<a name='12312'></font>
<font color=#447700>! No aerosols in top layer above model top (kte+1).<a name='12313'></font>
<font color=#447700>!cz        do nb = 1, nbndsw<a name='12314'></font>
<font color=#447700>!cz           do k = kts, kte+1<a name='12315'></font>
<font color=#447700>!cz              tauaer(icol,k,nb) = 0.<a name='12316'></font>
<font color=#447700>!cz              ssaaer(icol,k,nb) = 1.<a name='12317'></font>
<font color=#447700>!cz              asmaer(icol,k,nb) = 0.<a name='12318'></font>
<font color=#447700>!cz           enddo<a name='12319'></font>
<font color=#447700>!cz        enddo<a name='12320'></font>
<a name='12321'>
<font color=#447700>! ... Aerosol effects. Added aerosol feedbacks from Chem , 03/2010 -czhao<a name='12322'></font>
<font color=#447700>!<a name='12323'></font>
      do nb = 1, nbndsw<a name='12324'>
      do k = kts,kte+1<a name='12325'>
         tauaer(icol,k,nb) = 0.<a name='12326'>
         ssaaer(icol,k,nb) = 1.<a name='12327'>
         asmaer(icol,k,nb) = 0.<a name='12328'>
      end do<a name='12329'>
      end do<a name='12330'>
<a name='12331'>
      if ( associated (tauaer3d_sw) ) then<a name='12332'>
<font color=#447700>! ---- jararias 11/2012<a name='12333'></font>
            do nb=1,nbndsw<a name='12334'>
               do k=kts,kte<a name='12335'>
                  tauaer(icol,k,nb)=tauaer3d_sw(i,k,j,nb)<a name='12336'>
                  ssaaer(icol,k,nb)=ssaaer3d_sw(i,k,j,nb)<a name='12337'>
                  asmaer(icol,k,nb)=asyaer3d_sw(i,k,j,nb)<a name='12338'>
               end do<a name='12339'>
            end do<a name='12340'>
      end if<a name='12341'>
<a name='12342'>
#if ( WRF_CHEM == 1 )<a name='12343'>
   IF ( AER_RA_FEEDBACK == 1) then<a name='12344'>
      do nb = 1, nbndsw<a name='12345'>
         wavemid(nb)=0.5*(wavemin(nb)+wavemax(nb))  <font color=#447700>! um<a name='12346'></font>
      do k = kts,kte      <font color=#447700>!wig<a name='12347'></font>
<a name='12348'>
<font color=#447700>! convert optical properties at 300,400,600, and 999 to conform to the band wavelengths<a name='12349'></font>
<font color=#447700>! tauaer - use angstrom exponent<a name='12350'></font>
        if(tauaer300(i,k,j).gt.thresh .and. tauaer999(i,k,j).gt.thresh) then<a name='12351'>
           ang=alog(tauaer300(i,k,j)/tauaer999(i,k,j))/alog(999./300.)<a name='12352'>
           tauaer(icol,k,nb)=tauaer400(i,k,j)*(0.4/wavemid(nb))**ang<a name='12353'>
           <font color=#447700>!tauaer(icol,k,nb)=tauaer600(i,k,j)*(0.6/wavemid(nb))**ang <a name='12354'></font>
<font color=#447700>!jm TODO need to fix these so they are not writing to stderr, stdout 20141218<a name='12355'></font>
           if (i==30.and.j==49.and.k==2.and.nb==12) then<a name='12356'>
            write(0,*) 'TAU from 600 vs 400 in RRTMG',tauaer600(i,k,j),tauaer400(i,k,j)<a name='12357'>
            print*, 'TAU from 600 vs 400 in RRTMG',tauaer600(i,k,j),tauaer400(i,k,j)<a name='12358'>
            write(0,*) tauaer600(i,k,j)*(0.6/wavemid(nb))**ang,tauaer400(i,k,j)*(0.4/wavemid(nb))**ang<a name='12359'>
            print*, tauaer600(i,k,j)*(0.6/wavemid(nb))**ang,tauaer400(i,k,j)*(0.4/wavemid(nb))**ang<a name='12360'>
           endif<a name='12361'>
<font color=#447700>! ssa - linear interpolation; extrapolation<a name='12362'></font>
           slope=(waer600(i,k,j)-waer400(i,k,j))/.2<a name='12363'>
           ssaaer(icol,k,nb) = slope*(wavemid(nb)-.6)+waer600(i,k,j)<a name='12364'>
           if(ssaaer(icol,k,nb).lt.0.4) ssaaer(icol,k,nb)=0.4<a name='12365'>
           if(ssaaer(icol,k,nb).ge.1.0) ssaaer(icol,k,nb)=1.0<a name='12366'>
<font color=#447700>! g - linear interpolation;extrapolation<a name='12367'></font>
           slope=(gaer600(i,k,j)-gaer400(i,k,j))/.2<a name='12368'>
           asmaer(icol,k,nb) = slope*(wavemid(nb)-.6)+gaer600(i,k,j) <font color=#447700>! notice reversed varaibles<a name='12369'></font>
           if(asmaer(icol,k,nb).lt.0.5) asmaer(icol,k,nb)=0.5<a name='12370'>
           if(asmaer(icol,k,nb).ge.1.0) asmaer(icol,k,nb)=1.0<a name='12371'>
        endif<a name='12372'>
      end do <font color=#447700>! k<a name='12373'></font>
      end do <font color=#447700>! nb<a name='12374'></font>
<a name='12375'>
<font color=#447700>!wig beg<a name='12376'></font>
      do nb = 1, nbndsw<a name='12377'>
         slope = 0.  <font color=#447700>!use slope as a sum holder<a name='12378'></font>
         do k = kts,kte<a name='12379'>
            slope = slope + tauaer(icol,k,nb)<a name='12380'>
         end do<a name='12381'>
         if( slope &lt; 0. ) then<a name='12382'>
            write(msg,'("ERROR: Negative total optical depth of ",f8.2,&amp;<a name='12383'>
           &amp; " at point i,j,nb=",3i5)') slope,i,j,nb<a name='12384'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1104">(msg)<a name='12385'>
         else if( slope &gt; 6. ) then<a name='12386'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_877">("-------------------------")<a name='12387'>
            write(msg,'("WARNING: Large total sw optical depth of ",f8.2,&amp;<a name='12388'>
           &amp; " at point i,j,nb=",3i5)') slope,i,j,nb<a name='12389'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_878">(msg)<a name='12390'>
<a name='12391'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_879">("Diagnostics 1: k, tauaer300, tauaer400,&amp;<a name='12392'>
             &amp; tauaer600, tauaer999, tauaer")<a name='12393'>
            do k=kts,kte<a name='12394'>
               write(msg,'(i4,5f8.2)') k, tauaer300(i,k,j), tauaer400(i,k,j), &amp;<a name='12395'>
                    tauaer600(i,k,j), tauaer999(i,k,j),tauaer(icol,k,nb)<a name='12396'>
               call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_880">(msg)<a name='12397'>
               <font color=#447700>!czhao set an up-limit here to avoid segmentation fault <a name='12398'></font>
               <font color=#447700>!from extreme AOD<a name='12399'></font>
               tauaer(icol,k,nb)=tauaer(icol,k,nb)*6.0/slope <a name='12400'>
            end do<a name='12401'>
<a name='12402'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_881">("Diagnostics 2: k, gaer300, gaer400, gaer600,&amp;<a name='12403'>
             &amp; gaer999")<a name='12404'>
            do k=kts,kte<a name='12405'>
               write(msg,'(i4,4f8.2)') k, gaer300(i,k,j), gaer400(i,k,j), &amp;<a name='12406'>
                    gaer600(i,k,j), gaer999(i,k,j)<a name='12407'>
               call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_882">(msg)<a name='12408'>
            end do<a name='12409'>
<a name='12410'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_883">("Diagnostics 3: k, waer300, waer400, waer600,&amp;<a name='12411'>
             &amp; waer999")<a name='12412'>
            do k=kts,kte<a name='12413'>
               write(msg,'(i4,4f8.2)') k, waer300(i,k,j), waer400(i,k,j), &amp;<a name='12414'>
                    waer600(i,k,j), waer999(i,k,j)<a name='12415'>
               call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_884">(msg)<a name='12416'>
            end do<a name='12417'>
<a name='12418'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_885">("Diagnostics 4: k, ssaal, asyal, taual")<a name='12419'>
            do k=kts-1,kte<a name='12420'>
               write(msg,'(i4,3f8.2)') k, ssaaer(i,k,nb), asmaer(i,k,nb), tauaer(i,k,nb)<a name='12421'>
               call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_886">(msg)<a name='12422'>
            end do<a name='12423'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_887">("-------------------------")<a name='12424'>
         endif<a name='12425'>
      enddo  <font color=#447700>! nb<a name='12426'></font>
      endif  <font color=#447700>! aer_ra_feedback<a name='12427'></font>
#endif<a name='12428'>
<a name='12429'>
<a name='12430'>
<font color=#447700>! Zero array for input of aerosol optical thickness for use with<a name='12431'></font>
<font color=#447700>! ECMWF aerosol types (not used)<a name='12432'></font>
      iaer = 0<a name='12433'>
      do na = 1, naerec<a name='12434'>
         do k = kts, kte+1<a name='12435'>
            ecaer(icol,k,na) = 0.<a name='12436'>
         enddo<a name='12437'>
      enddo<a name='12438'>
<a name='12439'>
      IF ( PRESENT( aerod ) ) THEN<a name='12440'>
      if ( aer_opt .eq. 0 .or. aer_opt .eq. 2 .or. aer_opt .eq. 3 ) then<a name='12441'>
         iaer = 10<a name='12442'>
         do na = 1, naerec<a name='12443'>
            do k = kts, kte+1<a name='12444'>
               ecaer(icol,k,na) = 0.<a name='12445'>
            enddo<a name='12446'>
         enddo<a name='12447'>
      else if ( aer_opt .eq. 1 ) then<a name='12448'>
         iaer = 6<a name='12449'>
         do na = 1, naerec<a name='12450'>
            do k = kts, kte<a name='12451'>
               ecaer(icol,k,na) = aerod(i,k,j,na)<a name='12452'>
            enddo<a name='12453'>
<font color=#447700>! assuming 0 or same value at the top?<a name='12454'></font>
<font color=#447700>!           ecaer(icol,kte+1,na) = ecaer(icol,kte,na)<a name='12455'></font>
            ecaer(icol,kte+1,na) = 0.<a name='12456'>
         enddo<a name='12457'>
      endif<a name='12458'>
      ENDIF<a name='12459'>
<font color=#447700>!<a name='12460'></font>
<font color=#447700>! End of dorrsw check<a name='12461'></font>
      endif<a name='12462'>
<font color=#447700>! End of grid loops<a name='12463'></font>
      enddo i_loop<a name='12464'>
   enddo j_loop                                           <a name='12465'>
<a name='12466'>
<font color=#447700>! Call RRTMG shortwave radiation model<a name='12467'></font>
<font color=#447700>! Perform shortwave calculation if sun above horizon in any part of grid<a name='12468'></font>
<font color=#447700>! Do not perform shortwave calculations if all of grid is in darkness<a name='12469'></font>
      if (icnt .eq. 0) dorrsw = .false.<a name='12470'>
      if (dorrsw) then<a name='12471'>
<a name='12472'>
         call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW'>rrtmg_sw</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_2"> &amp;<a name='12473'>
            (rpart   ,ncol    ,nlay    ,icld    ,iaer   , &amp;<a name='12474'>
             play    ,plev    ,tlay    ,tlev    ,tsfc   , &amp;<a name='12475'>
             h2ovmr  ,o3vmr   ,co2vmr  ,ch4vmr  ,n2ovmr ,o2vmr , &amp;<a name='12476'>
             asdir   ,asdif   ,aldir   ,aldif   , &amp;<a name='12477'>
             coszen  ,adjes   ,dyofyr  ,scon    , &amp;<a name='12478'>
             inflgsw ,iceflgsw,liqflgsw,cldfrac , &amp;<a name='12479'>
             taucld  ,ssacld  ,asmcld  ,fsfcld  , &amp;<a name='12480'>
             ciwpth  ,clwpth  ,cswpth  ,rei     ,rel     ,res, &amp;<a name='12481'>
             tauaer  ,ssaaer  ,asmaer  ,ecaer   , &amp;<a name='12482'>
             swuflx  ,swdflx  ,swhr    ,swuflxc ,swdflxc ,swhrc, &amp;<a name='12483'>
<font color=#447700>! -----      Zhenxin added for ssib coupiling 2011-06-20 --------!<a name='12484'></font>
             sibvisdir, sibvisdif, sibnirdir, sibnirdif,         &amp;<a name='12485'>
<font color=#447700>! --------------------   End of addition by Zhenxin 2011-06-20 ------!<a name='12486'></font>
             swdkdir, swdkdif                      &amp;  <font color=#447700>! jararias, 2012/08/10<a name='12487'></font>
                                                  )<a name='12488'>
<a name='12489'>
      endif<a name='12490'>
<a name='12491'>
<a name='12492'>
<font color=#447700>! Output net absorbed shortwave surface flux and shortwave cloud forcing<a name='12493'></font>
<font color=#447700>! at the top of atmosphere (W/m2)<a name='12494'></font>
<a name='12495'>
<font color=#447700>! latitude loop<a name='12496'></font>
   j_loop2: do j = jts,jte<a name='12497'>
<font color=#447700>! longitude loop<a name='12498'></font>
      i_loop2: do i = its,ite<a name='12499'>
<a name='12500'>
<font color=#447700>! Use calculated output only if in daylight, otherwise output is zero<a name='12501'></font>
      dorrsw = .true.<a name='12502'>
      if (coszr(i,j).le.0.0) dorrsw = .false.<a name='12503'>
<font color=#447700>! Complete shortwave calculation if sun above horizon<a name='12504'></font>
      if (dorrsw) then<a name='12505'>
<a name='12506'>
         if (present(xcoszen)) then<a name='12507'>
            coszr(i,j)=xcoszen(i,j)<a name='12508'>
            coszrs=xcoszen(i,j)<a name='12509'>
         else<a name='12510'>
            call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWRAD_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1105">('xcoszen must be passed into RRTMG_SWRAD_FAST')<a name='12511'>
         endif<a name='12512'>
<a name='12513'>
<a name='12514'>
         icol = i-its+1 + (j-jts)*(ite-its+1)<a name='12515'>
<a name='12516'>
         gsw(i,j) = swdflx(icol,1) - swuflx(icol,1)<a name='12517'>
         swcf(i,j) = (swdflx(icol,kte+2) - swuflx(icol,kte+2)) - (swdflxc(icol,kte+2) - swuflxc(icol,kte+2))<a name='12518'>
<a name='12519'>
<font color=#447700>! mji - write<a name='12520'></font>
<font color=#447700>!         swut(i,j) = swuflx(icol,kte+2)<a name='12521'></font>
<font color=#447700>!         swdb(i,j) = swdflx(icol,1)<a name='12522'></font>
<font color=#447700>!<a name='12523'></font>
         if (present(swupt)) then <a name='12524'>
<font color=#447700>! Output up and down toa fluxes for total and clear sky<a name='12525'></font>
            swupt(i,j)     = swuflx(icol,kte+2)<a name='12526'>
            swuptc(i,j)    = swuflxc(icol,kte+2)<a name='12527'>
            swdnt(i,j)     = swdflx(icol,kte+2)<a name='12528'>
            swdntc(i,j)    = swdflxc(icol,kte+2)<a name='12529'>
<font color=#447700>! Output up and down surface fluxes for total and clear sky<a name='12530'></font>
            swupb(i,j)     = swuflx(icol,1)<a name='12531'>
            swupbc(i,j)    = swuflxc(icol,1)<a name='12532'>
            swdnb(i,j)     = swdflx(icol,1)<a name='12533'>
<font color=#447700>! Added by Zhenxin for 4 compenants of swdown radiation<a name='12534'></font>
            swvisdir(i,j)  = sibvisdir(icol,1)<a name='12535'>
            swvisdif(i,j)  = sibvisdif(icol,1)<a name='12536'>
            swnirdir(i,j)  = sibnirdir(icol,1)<a name='12537'>
            swnirdif(i,j)  = sibnirdif(icol,1)<a name='12538'>
<font color=#447700>!  Ended, Zhenxin (2011/06/20)<a name='12539'></font>
            swdnbc(i,j)    = swdflxc(icol,1)<a name='12540'>
         endif<a name='12541'>
            swddir(i,j)    = swdkdir(icol,1)       <font color=#447700>! jararias 2013/08/10<a name='12542'></font>
            swddni(i,j)    = swddir(i,j) / coszrs  <font color=#447700>! jararias 2013/08/10<a name='12543'></font>
            swddif(i,j)    = swdkdif(icol,1)          <font color=#447700>! jararias 2013/08/10<a name='12544'></font>
<a name='12545'>
<font color=#447700>! Output up and down layer fluxes for total and clear sky.<a name='12546'></font>
<font color=#447700>! Vertical ordering is from bottom to top in units of W m-2. <a name='12547'></font>
         if ( present (swupflx) ) then<a name='12548'>
         do k=kts,kte+2<a name='12549'>
            swupflx(i,k,j)  = swuflx(icol,k)<a name='12550'>
            swupflxc(i,k,j) = swuflxc(icol,k)<a name='12551'>
            swdnflx(i,k,j)  = swdflx(icol,k)<a name='12552'>
            swdnflxc(i,k,j) = swdflxc(icol,k)<a name='12553'>
         enddo<a name='12554'>
         endif<a name='12555'>
<a name='12556'>
<font color=#447700>! Output heating rate tendency; convert heating rate from K/d to K/s<a name='12557'></font>
<font color=#447700>! Heating rate arrays are ordered vertically from bottom to top here. <a name='12558'></font>
         do k=kts,kte <a name='12559'>
            tten1d(k) = swhr(icol,k)/86400.<a name='12560'>
            rthratensw(i,k,j) = tten1d(k)/pi3d(i,k,j)<a name='12561'>
         enddo<a name='12562'>
<a name='12563'>
      else<a name='12564'>
         if (present(swupt)) then <a name='12565'>
<font color=#447700>! Output up and down toa fluxes for total and clear sky<a name='12566'></font>
            swupt(i,j)     = 0.<a name='12567'>
            swuptc(i,j)    = 0.<a name='12568'>
            swdnt(i,j)     = 0.<a name='12569'>
            swdntc(i,j)    = 0.<a name='12570'>
<font color=#447700>! Output up and down surface fluxes for total and clear sky<a name='12571'></font>
            swupb(i,j)     = 0.<a name='12572'>
            swupbc(i,j)    = 0.<a name='12573'>
            swdnb(i,j)     = 0.<a name='12574'>
            swdnbc(i,j)    = 0.<a name='12575'>
            swvisdir(i,j)  = 0.  <font color=#447700>! Add by Zhenxin (2011/06/20)<a name='12576'></font>
            swvisdif(i,j)  = 0.<a name='12577'>
            swnirdir(i,j)  = 0.<a name='12578'>
            swnirdif(i,j)  = 0.  <font color=#447700>! Add by Zhenxin (2011/06/20)<a name='12579'></font>
         endif<a name='12580'>
            swddir(i,j)    = 0.  <font color=#447700>! jararias 2013/08/10<a name='12581'></font>
            swddni(i,j)    = 0.  <font color=#447700>! jararias 2013/08/10<a name='12582'></font>
            swddif(i,j)    = 0.  <font color=#447700>! jararias 2013/08/10<a name='12583'></font>
<a name='12584'>
      endif<a name='12585'>
<a name='12586'>
      end do i_loop2<a name='12587'>
   end do j_loop2                                           <a name='12588'>
<a name='12589'>
<font color=#447700>! mji - write<a name='12590'></font>
<font color=#447700>!      do j=jts,jte<a name='12591'></font>
<font color=#447700>!      write(62,995) (swut(i,j),i=its,ite)<a name='12592'></font>
<font color=#447700>!      enddo<a name='12593'></font>
<font color=#447700>!      do j=jts,jte<a name='12594'></font>
<font color=#447700>!      write(62,995) (swdb(i,j),i=its,ite)<a name='12595'></font>
<font color=#447700>!      enddo<a name='12596'></font>
<font color=#447700>! 995  format(1p6e12.5)<a name='12597'></font>
<a name='12598'>
<font color=#447700>!-------------------------------------------------------------------<a name='12599'></font>
<a name='12600'>
   END SUBROUTINE RRTMG_SWRAD_FAST<a name='12601'>
<a name='12602'>
 <a name='12603'>
<font color=#447700>!====================================================================<a name='12604'></font>
<A NAME='RRTMG_SWINIT_FAST'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWINIT_FAST' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12605'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>rrtmg_swinit_fast</font>(                                         &amp; <A href='../../call_to/RRTMG_SWINIT_FAST.html' TARGET='index'>1</A>,<A href='../../call_from/RRTMG_SWINIT_FAST.html' TARGET='index'>2</A><a name='12606'>
                       allowed_to_read ,                            &amp;<a name='12607'>
                       ids, ide, jds, jde, kds, kde,                &amp;<a name='12608'>
                       ims, ime, jms, jme, kms, kme,                &amp;<a name='12609'>
                       its, ite, jts, jte, kts, kte                 )<a name='12610'>
<font color=#447700>!--------------------------------------------------------------------<a name='12611'></font>
   IMPLICIT NONE<a name='12612'>
<font color=#447700>!--------------------------------------------------------------------<a name='12613'></font>
<a name='12614'>
   LOGICAL , INTENT(IN)           :: allowed_to_read<a name='12615'>
   INTEGER , INTENT(IN)           :: ids, ide, jds, jde, kds, kde,  &amp;<a name='12616'>
                                     ims, ime, jms, jme, kms, kme,  &amp;<a name='12617'>
                                     its, ite, jts, jte, kts, kte<a name='12618'>
<a name='12619'>
<font color=#447700>! Read in absorption coefficients and other data<a name='12620'></font>
   IF ( allowed_to_read ) THEN<a name='12621'>
     CALL <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE'>rrtmg_swlookuptable</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWINIT_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SWLOOKUPTABLE_2"><a name='12622'>
   ENDIF<a name='12623'>
<a name='12624'>
<font color=#447700>! Perform g-point reduction and other initializations<a name='12625'></font>
<font color=#447700>! Specific heat of dry air (cp) used in flux to heating rate conversion factor.<a name='12626'></font>
   call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SW_INI'>rrtmg_sw_ini</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWINIT_FAST' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRTMG_SW_INI_2">(cp)<a name='12627'>
<a name='12628'>
   END SUBROUTINE rrtmg_swinit_fast<a name='12629'>
<a name='12630'>
<a name='12631'>
<font color=#447700>! **************************************************************************     <a name='12632'></font>
<A NAME='RRTMG_SWLOOKUPTABLE'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12633'>
      <font color=#993300>SUBROUTINE </font><font color=#cc0000>rrtmg_swlookuptable</font> <A href='../../call_to/RRTMG_SWLOOKUPTABLE.html' TARGET='index'>2</A>,<A href='../../call_from/RRTMG_SWLOOKUPTABLE.html' TARGET='index'>34</A><a name='12634'>
<font color=#447700>! **************************************************************************     <a name='12635'></font>
<a name='12636'>
      IMPLICIT NONE<a name='12637'>
<a name='12638'>
<font color=#447700>! Local                                    <a name='12639'></font>
      INTEGER :: i<a name='12640'>
      LOGICAL                 :: opened<a name='12641'>
      LOGICAL , EXTERNAL      :: wrf_dm_on_monitor<a name='12642'>
<a name='12643'>
      CHARACTER*80 errmess<a name='12644'>
      INTEGER rrtmg_unit<a name='12645'>
<a name='12646'>
      IF ( wrf_dm_on_monitor() ) THEN<a name='12647'>
        DO i = 10,99<a name='12648'>
          INQUIRE ( i , OPENED = opened )<a name='12649'>
          IF ( .NOT. opened ) THEN<a name='12650'>
            rrtmg_unit = i<a name='12651'>
            GOTO 2010<a name='12652'>
          ENDIF<a name='12653'>
        ENDDO<a name='12654'>
        rrtmg_unit = -1<a name='12655'>
 2010   CONTINUE<a name='12656'>
      ENDIF<a name='12657'>
      CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_367"> ( rrtmg_unit , IWORDSIZE )<a name='12658'>
      IF ( rrtmg_unit &lt; 0 ) THEN<a name='12659'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1106"> ( 'module_ra_rrtmg_swf: rrtm_swlookuptable: Can not '// &amp;<a name='12660'>
                               'find unused fortran unit to read in lookup table.' )<a name='12661'>
      ENDIF<a name='12662'>
<a name='12663'>
      IF ( wrf_dm_on_monitor() ) THEN<a name='12664'>
        OPEN(rrtmg_unit,FILE='RRTMG_SW_DATA',                  &amp;<a name='12665'>
             FORM='UNFORMATTED',STATUS='OLD',ERR=9009)<a name='12666'>
      ENDIF<a name='12667'>
<a name='12668'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16'>sw_kgb16</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB16_2">(rrtmg_unit)<a name='12669'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17'>sw_kgb17</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB17_2">(rrtmg_unit)<a name='12670'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18'>sw_kgb18</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB18_2">(rrtmg_unit)<a name='12671'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19'>sw_kgb19</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB19_2">(rrtmg_unit)<a name='12672'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20'>sw_kgb20</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB20_2">(rrtmg_unit)<a name='12673'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21'>sw_kgb21</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB21_2">(rrtmg_unit)<a name='12674'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22'>sw_kgb22</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB22_2">(rrtmg_unit)<a name='12675'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23'>sw_kgb23</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB23_2">(rrtmg_unit)<a name='12676'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24'>sw_kgb24</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB24_2">(rrtmg_unit)<a name='12677'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB25'>sw_kgb25</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB25_2">(rrtmg_unit)<a name='12678'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB26'>sw_kgb26</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB26_2">(rrtmg_unit)<a name='12679'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27'>sw_kgb27</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB27_2">(rrtmg_unit)<a name='12680'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28'>sw_kgb28</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB28_2">(rrtmg_unit)<a name='12681'>
      call <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29'>sw_kgb29</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SW_KGB29_2">(rrtmg_unit)<a name='12682'>
<a name='12683'>
      IF ( wrf_dm_on_monitor() ) CLOSE (rrtmg_unit)<a name='12684'>
<a name='12685'>
      RETURN<a name='12686'>
9009  CONTINUE<a name='12687'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error opening '// &amp;<a name='12688'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='12689'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRTMG_SWLOOKUPTABLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1107">(errmess)<a name='12690'>
<a name='12691'>
      END SUBROUTINE rrtmg_swlookuptable<a name='12692'>
<a name='12693'>
<font color=#447700>! **************************************************************************<a name='12694'></font>
<font color=#447700>!  RRTMG Shortwave Radiative Transfer Model<a name='12695'></font>
<font color=#447700>!  Atmospheric and Environmental Research, Inc., Cambridge, MA<a name='12696'></font>
<font color=#447700>!<a name='12697'></font>
<font color=#447700>!  Original by J.Delamere, Atmospheric &amp; Environmental Research.<a name='12698'></font>
<font color=#447700>!  Reformatted for F90: JJMorcrette, ECMWF<a name='12699'></font>
<font color=#447700>!  Revision for GCMs:  Michael J. Iacono, AER, July 2002<a name='12700'></font>
<font color=#447700>!  Further F90 reformatting:  Michael J. Iacono, AER, June 2006<a name='12701'></font>
<font color=#447700>!<a name='12702'></font>
<font color=#447700>!  This file contains 14 READ statements that include the <a name='12703'></font>
<font color=#447700>!  absorption coefficients and other data for each of the 14 shortwave<a name='12704'></font>
<font color=#447700>!  spectral bands used in RRTMG_SW.  Here, the data are defined for 16<a name='12705'></font>
<font color=#447700>!  g-points, or sub-intervals, per band.  These data are combined and<a name='12706'></font>
<font color=#447700>!  weighted using a mapping procedure in module RRTMG_SW_INIT to reduce<a name='12707'></font>
<font color=#447700>!  the total number of g-points from 224 to 112 for use in the GCM.<a name='12708'></font>
<font color=#447700>! **************************************************************************<a name='12709'></font>
<a name='12710'>
<font color=#447700>! **************************************************************************<a name='12711'></font>
<A NAME='SW_KGB16'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12712'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb16</font>(rrtmg_unit) <A href='../../call_to/SW_KGB16.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB16.html' TARGET='index'>10</A><a name='12713'>
<font color=#447700>! **************************************************************************<a name='12714'></font>
<a name='12715'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG16_F'>rrsw_kg16_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG16_F_5">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='12716'>
                            rayl, strrat1, layreffr<a name='12717'>
<font color=#447700>!      use rrsw_kg16_f, only : kao, kbo, selfrefo, forrefo, sfluxrefo, rayl<a name='12718'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : strrat1, layreffr<a name='12719'></font>
<a name='12720'>
      implicit none<a name='12721'>
      save<a name='12722'>
<a name='12723'>
<font color=#447700>! Input<a name='12724'></font>
      integer, intent(in) :: rrtmg_unit<a name='12725'>
<a name='12726'>
<font color=#447700>! Local                                    <a name='12727'></font>
      character*80 errmess<a name='12728'>
      logical, external  :: wrf_dm_on_monitor<a name='12729'>
<a name='12730'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='12731'></font>
<a name='12732'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 2925 cm-1.<a name='12733'></font>
<a name='12734'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='12735'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='12736'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='12737'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='12738'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='12739'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='12740'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='12741'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='12742'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='12743'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='12744'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='12745'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='12746'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='12747'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='12748'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='12749'></font>
<a name='12750'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='12751'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='12752'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='12753'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='12754'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='12755'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='12756'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='12757'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='12758'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='12759'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='12760'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='12761'></font>
<a name='12762'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='12763'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='12764'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='12765'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='12766'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='12767'></font>
<a name='12768'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='12769'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='12770'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='12771'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='12772'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='12773'></font>
<a name='12774'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_368"> ( A , size ( A ) * RWORDSIZE )<a name='12775'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_40"> ( A , 1 )<a name='12776'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_24"> ( A , 1 )<a name='12777'>
<a name='12778'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='12779'>
         rayl, strrat1, layreffr, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='12780'>
      DM_BCAST_REAL(rayl)<a name='12781'>
      DM_BCAST_REAL(strrat1)<a name='12782'>
      DM_BCAST_INTEGER(layreffr)<a name='12783'>
      DM_BCAST_MACRO(kao)<a name='12784'>
      DM_BCAST_MACRO(kbo)<a name='12785'>
      DM_BCAST_MACRO(selfrefo)<a name='12786'>
      DM_BCAST_MACRO(forrefo)<a name='12787'>
      DM_BCAST_MACRO(sfluxrefo)<a name='12788'>
<a name='12789'>
      RETURN<a name='12790'>
9010  CONTINUE<a name='12791'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='12792'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='12793'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB16' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1108">(errmess)<a name='12794'>
<a name='12795'>
      end subroutine sw_kgb16<a name='12796'>
<a name='12797'>
<font color=#447700>! **************************************************************************<a name='12798'></font>
<A NAME='SW_KGB17'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12799'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb17</font>(rrtmg_unit) <A href='../../call_to/SW_KGB17.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB17.html' TARGET='index'>10</A><a name='12800'>
<font color=#447700>! **************************************************************************<a name='12801'></font>
<a name='12802'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG17_F'>rrsw_kg17_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG17_F_5">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='12803'>
                            rayl, strrat, layreffr<a name='12804'>
<font color=#447700>!      use rrsw_kg17_f, only : kao, kbo, selfrefo, forrefo, sfluxrefo, rayl<a name='12805'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : strrat, layreffr<a name='12806'></font>
<a name='12807'>
      implicit none<a name='12808'>
      save<a name='12809'>
<a name='12810'>
<font color=#447700>! Input<a name='12811'></font>
      integer, intent(in) :: rrtmg_unit<a name='12812'>
<a name='12813'>
<font color=#447700>! Local                                    <a name='12814'></font>
      character*80 errmess<a name='12815'>
      logical, external  :: wrf_dm_on_monitor<a name='12816'>
<a name='12817'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='12818'></font>
<a name='12819'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 3625 cm-1.<a name='12820'></font>
<a name='12821'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='12822'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='12823'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='12824'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='12825'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='12826'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='12827'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='12828'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='12829'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='12830'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='12831'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='12832'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='12833'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='12834'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='12835'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='12836'></font>
<a name='12837'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='12838'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='12839'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='12840'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='12841'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='12842'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='12843'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='12844'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='12845'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='12846'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='12847'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='12848'></font>
<a name='12849'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='12850'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='12851'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='12852'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='12853'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='12854'></font>
<a name='12855'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='12856'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='12857'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='12858'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='12859'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='12860'></font>
<a name='12861'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_369"> ( A , size ( A ) * RWORDSIZE )<a name='12862'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_41"> ( A , 1 )<a name='12863'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_25"> ( A , 1 )<a name='12864'>
<a name='12865'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='12866'>
         rayl, strrat, layreffr, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='12867'>
      DM_BCAST_REAL(rayl)<a name='12868'>
      DM_BCAST_REAL(strrat)<a name='12869'>
      DM_BCAST_INTEGER(layreffr)<a name='12870'>
      DM_BCAST_MACRO(kao)<a name='12871'>
      DM_BCAST_MACRO(kbo)<a name='12872'>
      DM_BCAST_MACRO(selfrefo)<a name='12873'>
      DM_BCAST_MACRO(forrefo)<a name='12874'>
      DM_BCAST_MACRO(sfluxrefo)<a name='12875'>
<a name='12876'>
      RETURN<a name='12877'>
9010  CONTINUE<a name='12878'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='12879'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='12880'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB17' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1109">(errmess)<a name='12881'>
<a name='12882'>
      end subroutine sw_kgb17<a name='12883'>
<a name='12884'>
<font color=#447700>! **************************************************************************<a name='12885'></font>
<A NAME='SW_KGB18'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12886'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb18</font>(rrtmg_unit) <A href='../../call_to/SW_KGB18.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB18.html' TARGET='index'>10</A><a name='12887'>
<font color=#447700>! **************************************************************************<a name='12888'></font>
<a name='12889'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG18_F'>rrsw_kg18_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG18_F_5">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='12890'>
                            rayl, strrat, layreffr<a name='12891'>
<font color=#447700>!      use rrsw_kg18_f, only : kao, kbo, selfrefo, forrefo, sfluxrefo, rayl<a name='12892'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : strrat, layreffr<a name='12893'></font>
<a name='12894'>
      implicit none<a name='12895'>
      save<a name='12896'>
<a name='12897'>
<font color=#447700>! Input<a name='12898'></font>
      integer, intent(in) :: rrtmg_unit<a name='12899'>
<a name='12900'>
<font color=#447700>! Local                                    <a name='12901'></font>
      character*80 errmess<a name='12902'>
      logical, external  :: wrf_dm_on_monitor<a name='12903'>
<a name='12904'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='12905'></font>
<a name='12906'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 4325 cm-1.<a name='12907'></font>
<a name='12908'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='12909'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='12910'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='12911'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='12912'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='12913'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='12914'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='12915'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='12916'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='12917'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='12918'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='12919'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='12920'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='12921'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='12922'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='12923'></font>
<a name='12924'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='12925'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='12926'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='12927'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='12928'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='12929'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='12930'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='12931'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='12932'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='12933'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='12934'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='12935'></font>
<a name='12936'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='12937'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='12938'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='12939'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='12940'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='12941'></font>
<a name='12942'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='12943'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='12944'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='12945'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='12946'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='12947'></font>
<a name='12948'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_370"> ( A , size ( A ) * RWORDSIZE )<a name='12949'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_42"> ( A , 1 )<a name='12950'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_26"> ( A , 1 )<a name='12951'>
<a name='12952'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='12953'>
         rayl, strrat, layreffr, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='12954'>
      DM_BCAST_REAL(rayl)<a name='12955'>
      DM_BCAST_REAL(strrat)<a name='12956'>
      DM_BCAST_INTEGER(layreffr)<a name='12957'>
      DM_BCAST_MACRO(kao)<a name='12958'>
      DM_BCAST_MACRO(kbo)<a name='12959'>
      DM_BCAST_MACRO(selfrefo)<a name='12960'>
      DM_BCAST_MACRO(forrefo)<a name='12961'>
      DM_BCAST_MACRO(sfluxrefo)<a name='12962'>
<a name='12963'>
      RETURN<a name='12964'>
9010  CONTINUE<a name='12965'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='12966'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='12967'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB18' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1110">(errmess)<a name='12968'>
<a name='12969'>
      end subroutine sw_kgb18 <a name='12970'>
<a name='12971'>
<font color=#447700>! **************************************************************************<a name='12972'></font>
<A NAME='SW_KGB19'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12973'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb19</font>(rrtmg_unit) <A href='../../call_to/SW_KGB19.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB19.html' TARGET='index'>10</A><a name='12974'>
<font color=#447700>! **************************************************************************<a name='12975'></font>
<a name='12976'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG19_F'>rrsw_kg19_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG19_F_5">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='12977'>
                            rayl, strrat, layreffr<a name='12978'>
<font color=#447700>!      use rrsw_kg19_f, only : kao, kbo, selfrefo, forrefo, sfluxrefo, rayl<a name='12979'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : strrat, layreffr<a name='12980'></font>
<a name='12981'>
      implicit none<a name='12982'>
      save<a name='12983'>
<a name='12984'>
<font color=#447700>! Input<a name='12985'></font>
      integer, intent(in) :: rrtmg_unit<a name='12986'>
<a name='12987'>
<font color=#447700>! Local                                    <a name='12988'></font>
      character*80 errmess<a name='12989'>
      logical, external  :: wrf_dm_on_monitor<a name='12990'>
<a name='12991'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='12992'></font>
<a name='12993'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 4900 cm-1.<a name='12994'></font>
<a name='12995'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='12996'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='12997'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='12998'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='12999'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='13000'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='13001'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='13002'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='13003'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='13004'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='13005'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='13006'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='13007'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='13008'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='13009'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='13010'></font>
<a name='13011'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='13012'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='13013'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='13014'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='13015'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='13016'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='13017'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='13018'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='13019'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='13020'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='13021'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='13022'></font>
<a name='13023'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='13024'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='13025'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='13026'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='13027'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='13028'></font>
<a name='13029'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='13030'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='13031'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='13032'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='13033'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='13034'></font>
<a name='13035'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_371"> ( A , size ( A ) * RWORDSIZE )<a name='13036'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_43"> ( A , 1 )<a name='13037'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_27"> ( A , 1 )<a name='13038'>
<a name='13039'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='13040'>
         rayl, strrat, layreffr, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='13041'>
      DM_BCAST_REAL(rayl)<a name='13042'>
      DM_BCAST_REAL(strrat)<a name='13043'>
      DM_BCAST_INTEGER(layreffr)<a name='13044'>
      DM_BCAST_MACRO(kao)<a name='13045'>
      DM_BCAST_MACRO(kbo)<a name='13046'>
      DM_BCAST_MACRO(selfrefo)<a name='13047'>
      DM_BCAST_MACRO(forrefo)<a name='13048'>
      DM_BCAST_MACRO(sfluxrefo)<a name='13049'>
<a name='13050'>
      RETURN<a name='13051'>
9010  CONTINUE<a name='13052'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='13053'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='13054'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB19' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1111">(errmess)<a name='13055'>
<a name='13056'>
      end subroutine sw_kgb19<a name='13057'>
<a name='13058'>
<font color=#447700>! **************************************************************************<a name='13059'></font>
<A NAME='SW_KGB20'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='13060'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb20</font>(rrtmg_unit) <A href='../../call_to/SW_KGB20.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB20.html' TARGET='index'>10</A><a name='13061'>
<font color=#447700>! **************************************************************************<a name='13062'></font>
<a name='13063'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG20_F'>rrsw_kg20_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG20_F_5">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='13064'>
                            absch4o, rayl, layreffr<a name='13065'>
<font color=#447700>!      use rrsw_kg20_f, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='13066'></font>
<font color=#447700>!                            absch4o, rayl<a name='13067'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : layreffr<a name='13068'></font>
<a name='13069'>
      implicit none<a name='13070'>
      save<a name='13071'>
<a name='13072'>
<font color=#447700>! Input<a name='13073'></font>
      integer, intent(in) :: rrtmg_unit<a name='13074'>
<a name='13075'>
<font color=#447700>! Local                                    <a name='13076'></font>
      character*80 errmess<a name='13077'>
      logical, external  :: wrf_dm_on_monitor<a name='13078'>
<a name='13079'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='13080'></font>
<a name='13081'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 5670 cm-1.<a name='13082'></font>
<a name='13083'>
<font color=#447700>!     Array absch4o contains the absorption coefficients for methane.<a name='13084'></font>
<a name='13085'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='13086'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='13087'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='13088'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='13089'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='13090'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='13091'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='13092'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='13093'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='13094'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='13095'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='13096'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='13097'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='13098'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='13099'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='13100'></font>
<a name='13101'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='13102'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='13103'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='13104'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='13105'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='13106'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='13107'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='13108'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='13109'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='13110'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='13111'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='13112'></font>
<a name='13113'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='13114'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='13115'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='13116'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='13117'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='13118'></font>
<a name='13119'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='13120'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='13121'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='13122'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='13123'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='13124'></font>
<a name='13125'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_372"> ( A , size ( A ) * RWORDSIZE )<a name='13126'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_44"> ( A , 1 )<a name='13127'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_28"> ( A , 1 )<a name='13128'>
<a name='13129'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='13130'>
         rayl, layreffr, absch4o, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='13131'>
      DM_BCAST_REAL(rayl)<a name='13132'>
      DM_BCAST_INTEGER(layreffr)<a name='13133'>
      DM_BCAST_MACRO(absch4o)<a name='13134'>
      DM_BCAST_MACRO(kao)<a name='13135'>
      DM_BCAST_MACRO(kbo)<a name='13136'>
      DM_BCAST_MACRO(selfrefo)<a name='13137'>
      DM_BCAST_MACRO(forrefo)<a name='13138'>
      DM_BCAST_MACRO(sfluxrefo)<a name='13139'>
<a name='13140'>
      RETURN<a name='13141'>
9010  CONTINUE<a name='13142'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='13143'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='13144'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB20' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1112">(errmess)<a name='13145'>
<a name='13146'>
      end subroutine sw_kgb20<a name='13147'>
<a name='13148'>
<font color=#447700>! **************************************************************************<a name='13149'></font>
<A NAME='SW_KGB21'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='13150'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb21</font>(rrtmg_unit) <A href='../../call_to/SW_KGB21.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB21.html' TARGET='index'>10</A><a name='13151'>
<font color=#447700>! **************************************************************************<a name='13152'></font>
<a name='13153'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG21_F'>rrsw_kg21_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG21_F_5">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='13154'>
                            rayl, strrat, layreffr<a name='13155'>
<font color=#447700>!      use rrsw_kg21_f, only : kao, kbo, selfrefo, forrefo, sfluxrefo, rayl<a name='13156'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : strrat, layreffr<a name='13157'></font>
<a name='13158'>
      implicit none<a name='13159'>
      save<a name='13160'>
<a name='13161'>
<font color=#447700>! Input<a name='13162'></font>
      integer, intent(in) :: rrtmg_unit<a name='13163'>
<a name='13164'>
<font color=#447700>! Local                                    <a name='13165'></font>
      character*80 errmess<a name='13166'>
      logical, external  :: wrf_dm_on_monitor<a name='13167'>
<a name='13168'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='13169'></font>
<a name='13170'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 6925 cm-1.<a name='13171'></font>
<a name='13172'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='13173'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='13174'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='13175'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='13176'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='13177'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='13178'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='13179'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='13180'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='13181'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='13182'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='13183'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='13184'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='13185'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='13186'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='13187'></font>
<a name='13188'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='13189'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='13190'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='13191'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='13192'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='13193'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='13194'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='13195'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='13196'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='13197'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='13198'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='13199'></font>
<a name='13200'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='13201'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='13202'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='13203'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='13204'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='13205'></font>
<a name='13206'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='13207'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='13208'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='13209'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='13210'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='13211'></font>
<a name='13212'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_373"> ( A , size ( A ) * RWORDSIZE )<a name='13213'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_45"> ( A , 1 )<a name='13214'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_29"> ( A , 1 )<a name='13215'>
<a name='13216'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='13217'>
         rayl, strrat, layreffr, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='13218'>
      DM_BCAST_REAL(rayl)<a name='13219'>
      DM_BCAST_REAL(strrat)<a name='13220'>
      DM_BCAST_INTEGER(layreffr)<a name='13221'>
      DM_BCAST_MACRO(kao)<a name='13222'>
      DM_BCAST_MACRO(kbo)<a name='13223'>
      DM_BCAST_MACRO(selfrefo)<a name='13224'>
      DM_BCAST_MACRO(forrefo)<a name='13225'>
      DM_BCAST_MACRO(sfluxrefo)<a name='13226'>
<a name='13227'>
      RETURN<a name='13228'>
9010  CONTINUE<a name='13229'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='13230'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='13231'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB21' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1113">(errmess)<a name='13232'>
<a name='13233'>
      end subroutine sw_kgb21<a name='13234'>
<a name='13235'>
<font color=#447700>! **************************************************************************<a name='13236'></font>
<A NAME='SW_KGB22'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='13237'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb22</font>(rrtmg_unit) <A href='../../call_to/SW_KGB22.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB22.html' TARGET='index'>10</A><a name='13238'>
<font color=#447700>! **************************************************************************<a name='13239'></font>
<a name='13240'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG22_F'>rrsw_kg22_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG22_F_5">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='13241'>
                            rayl, strrat, layreffr<a name='13242'>
<font color=#447700>!      use rrsw_kg22_f, only : kao, kbo, selfrefo, forrefo, sfluxrefo, rayl<a name='13243'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : strrat, layreffr<a name='13244'></font>
<a name='13245'>
      implicit none<a name='13246'>
      save<a name='13247'>
<a name='13248'>
<font color=#447700>! Input<a name='13249'></font>
      integer, intent(in) :: rrtmg_unit<a name='13250'>
<a name='13251'>
<font color=#447700>! Local                                    <a name='13252'></font>
      character*80 errmess<a name='13253'>
      logical, external  :: wrf_dm_on_monitor<a name='13254'>
<a name='13255'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='13256'></font>
<a name='13257'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at v = 8000 cm-1.<a name='13258'></font>
<a name='13259'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='13260'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='13261'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='13262'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='13263'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='13264'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='13265'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='13266'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='13267'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='13268'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='13269'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='13270'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='13271'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='13272'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='13273'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='13274'></font>
<a name='13275'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='13276'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='13277'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='13278'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='13279'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='13280'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='13281'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='13282'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='13283'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='13284'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='13285'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='13286'></font>
<a name='13287'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='13288'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='13289'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='13290'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='13291'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='13292'></font>
<a name='13293'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='13294'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='13295'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='13296'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='13297'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='13298'></font>
<a name='13299'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_374"> ( A , size ( A ) * RWORDSIZE )<a name='13300'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_46"> ( A , 1 )<a name='13301'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_30"> ( A , 1 )<a name='13302'>
<a name='13303'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='13304'>
         rayl, strrat, layreffr, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='13305'>
      DM_BCAST_REAL(rayl)<a name='13306'>
      DM_BCAST_REAL(strrat)<a name='13307'>
      DM_BCAST_INTEGER(layreffr)<a name='13308'>
      DM_BCAST_MACRO(kao)<a name='13309'>
      DM_BCAST_MACRO(kbo)<a name='13310'>
      DM_BCAST_MACRO(selfrefo)<a name='13311'>
      DM_BCAST_MACRO(forrefo)<a name='13312'>
      DM_BCAST_MACRO(sfluxrefo)<a name='13313'>
<a name='13314'>
      RETURN<a name='13315'>
9010  CONTINUE<a name='13316'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='13317'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='13318'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB22' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1114">(errmess)<a name='13319'>
<a name='13320'>
      end subroutine sw_kgb22<a name='13321'>
<a name='13322'>
<font color=#447700>! **************************************************************************<a name='13323'></font>
<A NAME='SW_KGB23'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='13324'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb23</font>(rrtmg_unit) <A href='../../call_to/SW_KGB23.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB23.html' TARGET='index'>10</A><a name='13325'>
<font color=#447700>! **************************************************************************<a name='13326'></font>
<a name='13327'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG23_F'>rrsw_kg23_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG23_F_5">, only : kao, selfrefo, forrefo, sfluxrefo, &amp;<a name='13328'>
                            raylo, givfac, layreffr<a name='13329'>
<font color=#447700>!      use rrsw_kg23_f, only : kao, selfrefo, forrefo, sfluxrefo, raylo<a name='13330'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : givfac, layreffr<a name='13331'></font>
<a name='13332'>
      implicit none<a name='13333'>
      save<a name='13334'>
<a name='13335'>
<font color=#447700>! Input<a name='13336'></font>
      integer, intent(in) :: rrtmg_unit<a name='13337'>
<a name='13338'>
<font color=#447700>! Local                                    <a name='13339'></font>
      character*80 errmess<a name='13340'>
      logical, external  :: wrf_dm_on_monitor<a name='13341'>
<a name='13342'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='13343'></font>
<a name='13344'>
<font color=#447700>!     Array raylo contains the Rayleigh extinction coefficient at all v for this band<a name='13345'></font>
<a name='13346'>
<font color=#447700>!     Array givfac is the average Giver et al. correction factor for this band. <a name='13347'></font>
<a name='13348'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='13349'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='13350'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='13351'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='13352'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='13353'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='13354'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='13355'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='13356'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='13357'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='13358'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='13359'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='13360'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='13361'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='13362'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='13363'></font>
<a name='13364'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='13365'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='13366'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='13367'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='13368'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='13369'></font>
<a name='13370'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='13371'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='13372'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='13373'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='13374'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='13375'></font>
<a name='13376'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_375"> ( A , size ( A ) * RWORDSIZE )<a name='13377'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_47"> ( A , 1 )<a name='13378'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_31"> ( A , 1 )<a name='13379'>
<a name='13380'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='13381'>
         raylo, givfac, layreffr, kao, selfrefo, forrefo, sfluxrefo<a name='13382'>
      DM_BCAST_MACRO(raylo)<a name='13383'>
      DM_BCAST_REAL(givfac)<a name='13384'>
      DM_BCAST_INTEGER(layreffr)<a name='13385'>
      DM_BCAST_MACRO(kao)<a name='13386'>
      DM_BCAST_MACRO(selfrefo)<a name='13387'>
      DM_BCAST_MACRO(forrefo)<a name='13388'>
      DM_BCAST_MACRO(sfluxrefo)<a name='13389'>
<a name='13390'>
      RETURN<a name='13391'>
9010  CONTINUE<a name='13392'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='13393'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='13394'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB23' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1115">(errmess)<a name='13395'>
<a name='13396'>
      end subroutine sw_kgb23<a name='13397'>
<a name='13398'>
<font color=#447700>! **************************************************************************<a name='13399'></font>
<A NAME='SW_KGB24'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='13400'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb24</font>(rrtmg_unit) <A href='../../call_to/SW_KGB24.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB24.html' TARGET='index'>10</A><a name='13401'>
<font color=#447700>! **************************************************************************<a name='13402'></font>
<a name='13403'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG24_F'>rrsw_kg24_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG24_F_7">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='13404'>
                            raylao, raylbo, abso3ao, abso3bo, strrat, layreffr<a name='13405'>
<font color=#447700>!      use rrsw_kg24_f, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='13406'></font>
<font color=#447700>!                            raylao, raylbo, abso3ao, abso3bo<a name='13407'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : strrat, layreffr<a name='13408'></font>
<a name='13409'>
      implicit none<a name='13410'>
      save<a name='13411'>
<a name='13412'>
<font color=#447700>! Input<a name='13413'></font>
      integer, intent(in) :: rrtmg_unit<a name='13414'>
<a name='13415'>
<font color=#447700>! Local                                    <a name='13416'></font>
      character*80 errmess<a name='13417'>
      logical, external  :: wrf_dm_on_monitor<a name='13418'>
<a name='13419'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='13420'></font>
<a name='13421'>
<font color=#447700>!     Arrays raylao and raylbo contain the Rayleigh extinction coefficient at <a name='13422'></font>
<font color=#447700>!     all v for this band for the upper and lower atmosphere.<a name='13423'></font>
<a name='13424'>
<font color=#447700>!     Arrays abso3ao and abso3bo contain the ozone absorption coefficient at <a name='13425'></font>
<font color=#447700>!     all v for this band for the upper and lower atmosphere.<a name='13426'></font>
<a name='13427'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='13428'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='13429'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='13430'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='13431'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='13432'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='13433'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='13434'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='13435'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='13436'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='13437'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='13438'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='13439'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='13440'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='13441'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='13442'></font>
<a name='13443'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='13444'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='13445'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='13446'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='13447'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='13448'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='13449'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='13450'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='13451'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='13452'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='13453'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='13454'></font>
<a name='13455'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='13456'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='13457'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='13458'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='13459'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='13460'></font>
<a name='13461'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='13462'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='13463'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='13464'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='13465'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='13466'></font>
<a name='13467'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_376"> ( A , size ( A ) * RWORDSIZE )<a name='13468'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_48"> ( A , 1 )<a name='13469'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_32"> ( A , 1 )<a name='13470'>
<a name='13471'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='13472'>
         raylao, raylbo, strrat, layreffr, abso3ao, abso3bo, kao, kbo, selfrefo, &amp;<a name='13473'>
         forrefo, sfluxrefo<a name='13474'>
      DM_BCAST_MACRO(raylao)<a name='13475'>
      DM_BCAST_MACRO(raylbo)<a name='13476'>
      DM_BCAST_REAL(strrat)<a name='13477'>
      DM_BCAST_INTEGER(layreffr)<a name='13478'>
      DM_BCAST_MACRO(abso3ao)<a name='13479'>
      DM_BCAST_MACRO(abso3bo)<a name='13480'>
      DM_BCAST_MACRO(kao)<a name='13481'>
      DM_BCAST_MACRO(kbo)<a name='13482'>
      DM_BCAST_MACRO(selfrefo)<a name='13483'>
      DM_BCAST_MACRO(forrefo)<a name='13484'>
      DM_BCAST_MACRO(sfluxrefo)<a name='13485'>
<a name='13486'>
      RETURN<a name='13487'>
9010  CONTINUE<a name='13488'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='13489'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='13490'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB24' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1116">(errmess)<a name='13491'>
<a name='13492'>
      end subroutine sw_kgb24<a name='13493'>
<a name='13494'>
<font color=#447700>! **************************************************************************<a name='13495'></font>
<A NAME='SW_KGB25'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB25' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='13496'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb25</font>(rrtmg_unit) <A href='../../call_to/SW_KGB25.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB25.html' TARGET='index'>8</A><a name='13497'>
<font color=#447700>! **************************************************************************<a name='13498'></font>
<a name='13499'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG25_F'>rrsw_kg25_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG25_F_7">, only : kao, sfluxrefo, &amp;<a name='13500'>
                            raylo, abso3ao, abso3bo, layreffr<a name='13501'>
<font color=#447700>!      use rrsw_kg25_f, only : kao, sfluxrefo, raylo, abso3ao, abso3bo<a name='13502'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : layreffr<a name='13503'></font>
<a name='13504'>
      implicit none<a name='13505'>
      save<a name='13506'>
<a name='13507'>
<font color=#447700>! Input<a name='13508'></font>
      integer, intent(in) :: rrtmg_unit<a name='13509'>
<a name='13510'>
<font color=#447700>! Local                                    <a name='13511'></font>
      character*80 errmess<a name='13512'>
      logical, external  :: wrf_dm_on_monitor<a name='13513'>
<a name='13514'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='13515'></font>
<a name='13516'>
<font color=#447700>!     Array raylo contains the Rayleigh extinction coefficient at all v = 2925 cm-1.<a name='13517'></font>
<a name='13518'>
<font color=#447700>!     Arrays abso3ao and abso3bo contain the ozone absorption coefficient at <a name='13519'></font>
<font color=#447700>!     all v for this band for the upper and lower atmosphere.<a name='13520'></font>
<a name='13521'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='13522'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='13523'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='13524'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='13525'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='13526'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='13527'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='13528'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='13529'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='13530'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='13531'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='13532'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='13533'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='13534'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='13535'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='13536'></font>
<a name='13537'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_377"> ( A , size ( A ) * RWORDSIZE )<a name='13538'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_33"> ( A , 1 )<a name='13539'>
<a name='13540'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='13541'>
         raylo, layreffr, abso3ao, abso3bo, kao, sfluxrefo<a name='13542'>
      DM_BCAST_MACRO(raylo)<a name='13543'>
      DM_BCAST_INTEGER(layreffr)<a name='13544'>
      DM_BCAST_MACRO(abso3ao)<a name='13545'>
      DM_BCAST_MACRO(abso3bo)<a name='13546'>
      DM_BCAST_MACRO(kao)<a name='13547'>
      DM_BCAST_MACRO(sfluxrefo)<a name='13548'>
<a name='13549'>
      RETURN<a name='13550'>
9010  CONTINUE<a name='13551'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='13552'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='13553'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB25' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1117">(errmess)<a name='13554'>
<a name='13555'>
      end subroutine sw_kgb25<a name='13556'>
<a name='13557'>
<font color=#447700>! **************************************************************************<a name='13558'></font>
<A NAME='SW_KGB26'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB26' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='13559'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb26</font>(rrtmg_unit) <A href='../../call_to/SW_KGB26.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB26.html' TARGET='index'>6</A><a name='13560'>
<font color=#447700>! **************************************************************************<a name='13561'></font>
<a name='13562'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG26_F'>rrsw_kg26_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG26_F_5">, only : sfluxrefo, raylo<a name='13563'>
<a name='13564'>
      implicit none<a name='13565'>
      save<a name='13566'>
<a name='13567'>
<font color=#447700>! Input<a name='13568'></font>
      integer, intent(in) :: rrtmg_unit<a name='13569'>
<a name='13570'>
<font color=#447700>! Local                                    <a name='13571'></font>
      character*80 errmess<a name='13572'>
      logical, external  :: wrf_dm_on_monitor<a name='13573'>
<a name='13574'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='13575'></font>
<a name='13576'>
<font color=#447700>!     Array raylo contains the Rayleigh extinction coefficient at all v for this band.<a name='13577'></font>
<a name='13578'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_378"> ( A , size ( A ) * RWORDSIZE )<a name='13579'>
<a name='13580'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='13581'>
         raylo, sfluxrefo<a name='13582'>
      DM_BCAST_MACRO(raylo)<a name='13583'>
      DM_BCAST_MACRO(sfluxrefo)<a name='13584'>
<a name='13585'>
      RETURN<a name='13586'>
9010  CONTINUE<a name='13587'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='13588'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='13589'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB26' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1118">(errmess)<a name='13590'>
<a name='13591'>
      end subroutine sw_kgb26<a name='13592'>
<a name='13593'>
<font color=#447700>! **************************************************************************<a name='13594'></font>
<A NAME='SW_KGB27'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='13595'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb27</font>(rrtmg_unit) <A href='../../call_to/SW_KGB27.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB27.html' TARGET='index'>10</A><a name='13596'>
<font color=#447700>! **************************************************************************<a name='13597'></font>
<a name='13598'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG27_F'>rrsw_kg27_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG27_F_5">, only : kao, kbo, sfluxrefo, raylo, &amp;<a name='13599'>
                            scalekur, layreffr<a name='13600'>
<font color=#447700>!      use rrsw_kg27_f, only : kao, kbo, sfluxrefo, raylo<a name='13601'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : scalekur, layreffr<a name='13602'></font>
<a name='13603'>
      implicit none<a name='13604'>
      save<a name='13605'>
<a name='13606'>
<font color=#447700>! Input<a name='13607'></font>
      integer, intent(in) :: rrtmg_unit<a name='13608'>
<a name='13609'>
<font color=#447700>! Local                                    <a name='13610'></font>
      character*80 errmess<a name='13611'>
      logical, external  :: wrf_dm_on_monitor<a name='13612'>
<a name='13613'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='13614'></font>
<font color=#447700>!     The values in array sfluxrefo were obtained using the "low resolution"<a name='13615'></font>
<font color=#447700>!     version of the Kurucz solar source function.  For unknown reasons,<a name='13616'></font>
<font color=#447700>!     the total irradiance in this band differs from the corresponding<a name='13617'></font>
<font color=#447700>!     total in the "high-resolution" version of the Kurucz function.<a name='13618'></font>
<font color=#447700>!     Therefore, these values are scaled by the factor SCALEKUR.<a name='13619'></font>
<a name='13620'>
<font color=#447700>!     Array raylo contains the Rayleigh extinction coefficient at all v = 2925 cm-1.<a name='13621'></font>
<a name='13622'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='13623'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='13624'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='13625'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='13626'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='13627'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='13628'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='13629'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='13630'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='13631'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='13632'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='13633'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='13634'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='13635'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='13636'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='13637'></font>
<a name='13638'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='13639'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='13640'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='13641'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='13642'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='13643'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='13644'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='13645'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='13646'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='13647'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='13648'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='13649'></font>
<a name='13650'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_379"> ( A , size ( A ) * RWORDSIZE )<a name='13651'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_49"> ( A , 1 )<a name='13652'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_34"> ( A , 1 )<a name='13653'>
<a name='13654'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='13655'>
         raylo, scalekur, layreffr, kao, kbo, sfluxrefo<a name='13656'>
      DM_BCAST_MACRO(raylo)<a name='13657'>
      DM_BCAST_REAL(scalekur)<a name='13658'>
      DM_BCAST_INTEGER(layreffr)<a name='13659'>
      DM_BCAST_MACRO(kao)<a name='13660'>
      DM_BCAST_MACRO(kbo)<a name='13661'>
      DM_BCAST_MACRO(sfluxrefo)<a name='13662'>
<a name='13663'>
      RETURN<a name='13664'>
9010  CONTINUE<a name='13665'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='13666'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='13667'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB27' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1119">(errmess)<a name='13668'>
<a name='13669'>
      end subroutine sw_kgb27<a name='13670'>
<a name='13671'>
<font color=#447700>! **************************************************************************<a name='13672'></font>
<A NAME='SW_KGB28'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='13673'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb28</font>(rrtmg_unit) <A href='../../call_to/SW_KGB28.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB28.html' TARGET='index'>10</A><a name='13674'>
<font color=#447700>! **************************************************************************<a name='13675'></font>
<a name='13676'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG28_F'>rrsw_kg28_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG28_F_5">, only : kao, kbo, sfluxrefo, &amp;<a name='13677'>
                            rayl, strrat, layreffr<a name='13678'>
<font color=#447700>!      use rrsw_kg28_f, only : kao, kbo, sfluxrefo, rayl<a name='13679'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : strrat, layreffr<a name='13680'></font>
<a name='13681'>
      implicit none<a name='13682'>
      save<a name='13683'>
<a name='13684'>
<font color=#447700>! Input<a name='13685'></font>
      integer, intent(in) :: rrtmg_unit<a name='13686'>
<a name='13687'>
<font color=#447700>! Local                                    <a name='13688'></font>
      character*80 errmess<a name='13689'>
      logical, external  :: wrf_dm_on_monitor<a name='13690'>
<a name='13691'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='13692'></font>
<a name='13693'>
<font color=#447700>!     Array raylo contains the Rayleigh extinction coefficient at all v = ???? cm-1.<a name='13694'></font>
<a name='13695'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='13696'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='13697'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='13698'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='13699'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='13700'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='13701'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='13702'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='13703'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='13704'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='13705'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='13706'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='13707'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='13708'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='13709'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='13710'></font>
<a name='13711'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='13712'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='13713'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='13714'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='13715'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='13716'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='13717'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='13718'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='13719'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='13720'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='13721'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='13722'></font>
<a name='13723'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_380"> ( A , size ( A ) * RWORDSIZE )<a name='13724'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_50"> ( A , 1 )<a name='13725'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_35"> ( A , 1 )<a name='13726'>
<a name='13727'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='13728'>
         rayl, strrat, layreffr, kao, kbo, sfluxrefo<a name='13729'>
      DM_BCAST_REAL(rayl)<a name='13730'>
      DM_BCAST_REAL(strrat)<a name='13731'>
      DM_BCAST_INTEGER(layreffr)<a name='13732'>
      DM_BCAST_MACRO(kao)<a name='13733'>
      DM_BCAST_MACRO(kbo)<a name='13734'>
      DM_BCAST_MACRO(sfluxrefo)<a name='13735'>
<a name='13736'>
      RETURN<a name='13737'>
9010  CONTINUE<a name='13738'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='13739'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='13740'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB28' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1120">(errmess)<a name='13741'>
<a name='13742'>
      end subroutine sw_kgb28<a name='13743'>
<a name='13744'>
<font color=#447700>! **************************************************************************<a name='13745'></font>
<A NAME='SW_KGB29'><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='13746'>
      <font color=#993300>subroutine </font><font color=#cc0000>sw_kgb29</font>(rrtmg_unit) <A href='../../call_to/SW_KGB29.html' TARGET='index'>2</A>,<A href='../../call_from/SW_KGB29.html' TARGET='index'>10</A><a name='13747'>
<font color=#447700>! **************************************************************************<a name='13748'></font>
<a name='13749'>
      use <A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#RRSW_KG29_F'>rrsw_kg29_f</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RRSW_KG29_F_7">, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='13750'>
                            absh2oo, absco2o, rayl, layreffr<a name='13751'>
<font color=#447700>!      use rrsw_kg29_f, only : kao, kbo, selfrefo, forrefo, sfluxrefo, &amp;<a name='13752'></font>
<font color=#447700>!                            absh2oo, absco2o, rayl<a name='13753'></font>
<font color=#447700>!      use rrtmg_sw_taumol, only : layreffr<a name='13754'></font>
<a name='13755'>
      implicit none<a name='13756'>
      save<a name='13757'>
<a name='13758'>
<font color=#447700>! Input<a name='13759'></font>
      integer, intent(in) :: rrtmg_unit<a name='13760'>
<a name='13761'>
<font color=#447700>! Local                                    <a name='13762'></font>
      character*80 errmess<a name='13763'>
      logical, external  :: wrf_dm_on_monitor<a name='13764'>
<a name='13765'>
<font color=#447700>!     Array sfluxrefo contains the Kurucz solar source function for this band. <a name='13766'></font>
<a name='13767'>
<font color=#447700>!     Array rayl contains the Rayleigh extinction coefficient at all v = 2200 cm-1.<a name='13768'></font>
<a name='13769'>
<font color=#447700>!     Array absh2oo contains the water vapor absorption coefficient for this band.<a name='13770'></font>
<a name='13771'>
<font color=#447700>!     Array absco2o contains the carbon dioxide absorption coefficient for this band.<a name='13772'></font>
<a name='13773'>
<font color=#447700>!     The array KAO contains absorption coefs at the 16 chosen g-values <a name='13774'></font>
<font color=#447700>!     for a range of pressure levels&gt; ~100mb, temperatures, and binary<a name='13775'></font>
<font color=#447700>!     species parameters (see taumol.f for definition).  The first <a name='13776'></font>
<font color=#447700>!     index in the array, JS, runs from 1 to 9, and corresponds to <a name='13777'></font>
<font color=#447700>!     different values of the binary species parameter.  For instance, <a name='13778'></font>
<font color=#447700>!     JS=1 refers to dry air, JS = 2 corresponds to the paramter value 1/8, <a name='13779'></font>
<font color=#447700>!     JS = 3 corresponds to the parameter value 2/8, etc.  The second index<a name='13780'></font>
<font color=#447700>!     in the array, JT, which runs from 1 to 5, corresponds to different<a name='13781'></font>
<font color=#447700>!     temperatures.  More specifically, JT = 3 means that the data are for<a name='13782'></font>
<font color=#447700>!     the reference temperature TREF for this  pressure level, JT = 2 refers<a name='13783'></font>
<font color=#447700>!     to TREF-15, JT = 1 is for TREF-30, JT = 4 is for TREF+15, and JT = 5<a name='13784'></font>
<font color=#447700>!     is for TREF+30.  The third index, JP, runs from 1 to 13 and refers<a name='13785'></font>
<font color=#447700>!     to the JPth reference pressure level (see taumol.f for these levels<a name='13786'></font>
<font color=#447700>!     in mb).  The fourth index, IG, goes from 1 to 16, and indicates<a name='13787'></font>
<font color=#447700>!     which g-interval the absorption coefficients are for.<a name='13788'></font>
<a name='13789'>
<font color=#447700>!     The array KBO contains absorption coefs at the 16 chosen g-values <a name='13790'></font>
<font color=#447700>!     for a range of pressure levels &lt; ~100mb and temperatures. The first <a name='13791'></font>
<font color=#447700>!     index in the array, JT, which runs from 1 to 5, corresponds to <a name='13792'></font>
<font color=#447700>!     different temperatures.  More specifically, JT = 3 means that the <a name='13793'></font>
<font color=#447700>!     data are for the reference temperature TREF for this pressure <a name='13794'></font>
<font color=#447700>!     level, JT = 2 refers to the temperature TREF-15, JT = 1 is for<a name='13795'></font>
<font color=#447700>!     TREF-30, JT = 4 is for TREF+15, and JT = 5 is for TREF+30.  <a name='13796'></font>
<font color=#447700>!     The second index, JP, runs from 13 to 59 and refers to the JPth<a name='13797'></font>
<font color=#447700>!     reference pressure level (see taumol.f for the value of these<a name='13798'></font>
<font color=#447700>!     pressure levels in mb).  The third index, IG, goes from 1 to 16,<a name='13799'></font>
<font color=#447700>!     and tells us which g-interval the absorption coefficients are for.<a name='13800'></font>
<a name='13801'>
<font color=#447700>!     The array FORREFO contains the coefficient of the water vapor<a name='13802'></font>
<font color=#447700>!     foreign-continuum (including the energy term).  The first <a name='13803'></font>
<font color=#447700>!     index refers to reference temperature (296,260,224,260) and <a name='13804'></font>
<font color=#447700>!     pressure (970,475,219,3 mbar) levels.  The second index <a name='13805'></font>
<font color=#447700>!     runs over the g-channel (1 to 16).<a name='13806'></font>
<a name='13807'>
<font color=#447700>!     The array SELFREFO contains the coefficient of the water vapor<a name='13808'></font>
<font color=#447700>!     self-continuum (including the energy term).  The first index<a name='13809'></font>
<font color=#447700>!     refers to temperature in 7.2 degree increments.  For instance,<a name='13810'></font>
<font color=#447700>!     JT = 1 refers to a temperature of 245.6, JT = 2 refers to 252.8,<a name='13811'></font>
<font color=#447700>!     etc.  The second index runs over the g-channel (1 to 16).<a name='13812'></font>
<a name='13813'>
#define DM_BCAST_MACRO(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_381"> ( A , size ( A ) * RWORDSIZE )<a name='13814'>
#define DM_BCAST_REAL(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_REAL'>wrf_dm_bcast_real</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_REAL_51"> ( A , 1 )<a name='13815'>
#define DM_BCAST_INTEGER(A) CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_INTEGER'>wrf_dm_bcast_integer</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_INTEGER_36"> ( A , 1 )<a name='13816'>
<a name='13817'>
      IF ( wrf_dm_on_monitor() ) READ (rrtmg_unit,ERR=9010) &amp;<a name='13818'>
         rayl, layreffr, absh2oo, absco2o, kao, kbo, selfrefo, forrefo, sfluxrefo<a name='13819'>
      DM_BCAST_REAL(rayl)<a name='13820'>
      DM_BCAST_INTEGER(layreffr)<a name='13821'>
      DM_BCAST_MACRO(absh2oo)<a name='13822'>
      DM_BCAST_MACRO(absco2o)<a name='13823'>
      DM_BCAST_MACRO(kao)<a name='13824'>
      DM_BCAST_MACRO(kbo)<a name='13825'>
      DM_BCAST_MACRO(selfrefo)<a name='13826'>
      DM_BCAST_MACRO(forrefo)<a name='13827'>
      DM_BCAST_MACRO(sfluxrefo)<a name='13828'>
<a name='13829'>
      RETURN<a name='13830'>
9010  CONTINUE<a name='13831'>
      WRITE( errmess , '(A,I4)' ) 'module_ra_rrtmg_swf: error reading '// &amp;<a name='13832'>
                                  'RRTMG_SW_DATA on unit ',rrtmg_unit<a name='13833'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_ra_rrtmg_swf.F.html#SW_KGB29' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1121">(errmess)<a name='13834'>
<a name='13835'>
      end subroutine sw_kgb29<a name='13836'>
<a name='13837'>
<font color=#447700>!------------------------------------------------------------------<a name='13838'></font>
<a name='13839'>
      END MODULE module_ra_rrtmg_swf<a name='13840'>
</pre></body></html>