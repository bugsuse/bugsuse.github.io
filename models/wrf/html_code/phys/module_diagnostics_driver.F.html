<HTML> <BODY BGCOLOR=#ddddee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
#if (NMM_CORE == 1)<a name='2'>
<A NAME='MODULE_DIAGNOSTICS_DRIVER'><A href='../../html_code/phys/module_diagnostics_driver.F.html#MODULE_DIAGNOSTICS_DRIVER' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='3'>
<font color=#993300>MODULE </font><font color=#cc0000>module_diagnostics_driver</font> <A href='../../call_to/MODULE_DIAGNOSTICS_DRIVER.html' TARGET='index'>1</A><a name='4'>
CONTAINS<a name='5'>
<A NAME='DIAGNOSTICS_DRIVER_STUB'><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER_STUB' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='6'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>diagnostics_driver_stub</font><a name='7'>
   END SUBROUTINE diagnostics_driver_stub<a name='8'>
END MODULE module_diagnostics_driver<a name='9'>
#else<a name='10'>
<font color=#447700>!WRF:MODEL_LAYER:PHYSICS<a name='11'></font>
<a name='12'>
<A NAME='MODULE_DIAGNOSTICS_DRIVER'><A href='../../html_code/phys/module_diagnostics_driver.F.html#MODULE_DIAGNOSTICS_DRIVER' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='13'>
<font color=#993300>MODULE </font><font color=#cc0000>module_diagnostics_driver</font> <A href='../../call_to/MODULE_DIAGNOSTICS_DRIVER.html' TARGET='index'>1</A><a name='14'>
<a name='15'>
CONTAINS<a name='16'>
<a name='17'>
   <font color=#447700>!  This subroutine is the driver for the diagnostics packages.<a name='18'></font>
<a name='19'>
<a name='20'>
<A NAME='DIAGNOSTICS_DRIVER'><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='21'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>diagnostics_driver</font> ( grid, config_flags,                  &amp; <A href='../../call_to/DIAGNOSTICS_DRIVER.html' TARGET='index'>1</A>,<A href='../../call_from/DIAGNOSTICS_DRIVER.html' TARGET='index'>35</A><a name='22'>
                                   moist, chem, tracer, scalar,         &amp;<a name='23'>
                                   th_phy, pi_phy, p_phy, rho_phy,      &amp; <a name='24'>
                                   p8w, t8w, dz8w,                      &amp;<a name='25'>
                                   curr_secs2,                          &amp;<a name='26'>
                                   diag_flag,                           &amp;<a name='27'>
                                   ids,  ide,  jds,  jde,  kds,  kde,   &amp;<a name='28'>
                                   ims,  ime,  jms,  jme,  kms,  kme,   &amp;<a name='29'>
                                   ips,  ipe,  jps,  jpe,  kps,  kpe,   &amp;<a name='30'>
                                   imsx, imex, jmsx, jmex, kmsx, kmex,  &amp;<a name='31'>
                                   ipsx, ipex, jpsx, jpex, kpsx, kpex,  &amp;<a name='32'>
                                   imsy, imey, jmsy, jmey, kmsy, kmey,  &amp;<a name='33'>
                                   ipsy, ipey, jpsy, jpey, kpsy, kpey   )<a name='34'>
<a name='35'>
<a name='36'>
      <font color=#447700>!=============================================================<a name='37'></font>
      <font color=#447700>!  USE Association for Generic WRF Infrastructure<a name='38'></font>
      <font color=#447700>!=============================================================<a name='39'></font>
<a name='40'>
      <font color=#447700>!  Pick up the number of members for each of the 4d arrays - for declaration purposes.<a name='41'></font>
<a name='42'>
      USE <A href='../../html_code/frame/module_state_description.F.html#MODULE_STATE_DESCRIPTION'>module_state_description</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_STATE_DESCRIPTION_119">, ONLY: num_moist, num_chem, num_tracer, num_scalar, &amp;<a name='43'>
                                          SKIP_PRESS_DIAGS, SKIP_Z_DIAGS,              &amp;<a name='44'>
                                          P_QG, P_QH, P_QV,                            &amp;<a name='45'>
                                          P_QNG, P_QH, P_QNH, P_QR, P_QNR,             &amp;<a name='46'>
                     KESSLERSCHEME, LINSCHEME, SBU_YLINSCHEME, WSM3SCHEME, WSM5SCHEME, &amp;<a name='47'>
                     WSM6SCHEME, ETAMPNEW, THOMPSON, THOMPSONAERO,                     &amp;<a name='48'>
                     MORR_TWO_MOMENT, GSFCGCESCHEME, WDM5SCHEME, WDM6SCHEME,           &amp;<a name='49'>
                     NSSL_2MOM, NSSL_2MOMCCN, NSSL_1MOM, NSSL_1MOMLFO,                 &amp;<a name='50'>
                     MILBRANDT2MOM , CAMMGMPSCHEME, FAST_KHAIN_LYNN, FULL_KHAIN_LYNN    <font color=#447700>!,MILBRANDT3MOM, NSSL_3MOM, MORR_MILB_P3<a name='51'></font>
<a name='52'>
      USE <A href='../../html_code/frame/module_driver_constants.F.html#MODULE_DRIVER_CONSTANTS'>module_driver_constants</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DRIVER_CONSTANTS_54">, ONLY: max_plevs, max_zlevs<a name='53'>
<a name='54'>
      <font color=#447700>!  From where we preferably are pulling g, Cp, etc.<a name='55'></font>
<a name='56'>
      USE <A href='../../html_code/share/module_model_constants.F.html#MODULE_MODEL_CONSTANTS'>module_model_constants</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MODEL_CONSTANTS_60">, ONLY: g<a name='57'>
<a name='58'>
      <font color=#447700>!  This gives us the type definition for grid (domain) and some clock information.<a name='59'></font>
<a name='60'>
<font color=#447700>!     USE module_domain, ONLY : domain, domain_clock_get, get_ijk_from_subgrid<a name='61'></font>
      USE <A href='../../html_code/frame/module_domain.F.html#MODULE_DOMAIN'>module_domain</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DOMAIN_226">, ONLY : domain, domain_clock_get, domain_get_current_time<a name='62'>
<a name='63'>
      <font color=#447700>!  All of the information from the namelist is in config_flags.  The<a name='64'></font>
      <font color=#447700>!  type declaration for this puppy must be available.  While each domain<a name='65'></font>
      <font color=#447700>!  has a config_flags, together they are stored in model_config_rec.<a name='66'></font>
<a name='67'>
      USE <A href='../../html_code/frame/module_configure.F.html#MODULE_CONFIGURE'>module_configure</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CONFIGURE_147">, ONLY : grid_config_rec_type, &amp;<a name='68'>
                                   model_config_rec<a name='69'>
<a name='70'>
      USE <A href='../../html_code/frame/module_streams.F.html#MODULE_STREAMS'>module_streams</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_STREAMS_8"><a name='71'>
      USE module_utility, ONLY : WRFU_Time <a name='72'>
<a name='73'>
      <font color=#447700>!=============================================================<a name='74'></font>
      <font color=#447700>!  USE Association for the Diagnostic Packages<a name='75'></font>
      <font color=#447700>!=============================================================<a name='76'></font>
      <a name='77'>
      USE <A href='../../html_code/phys/module_lightning_driver.F.html#MODULE_LIGHTNING_DRIVER'>module_lightning_driver</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_LIGHTNING_DRIVER_2">, ONLY : lightning_driver      <a name='78'>
      USE <A href='../../html_code/phys/module_diag_misc.F.html#MODULE_DIAG_MISC'>module_diag_misc</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DIAG_MISC_1">, ONLY : diagnostic_output_calc<a name='79'>
      USE <A href='../../html_code/phys/module_diag_cl.F.html#MODULE_DIAG_CL'>module_diag_cl</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DIAG_CL_1">, ONLY : clwrf_output_calc<a name='80'>
      USE <A href='../../html_code/phys/module_diag_pld.F.html#MODULE_DIAG_PLD'>module_diag_pld</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DIAG_PLD_2">, ONLY : pld<a name='81'>
      USE <A href='../../html_code/phys/module_diag_zld.F.html#MODULE_DIAG_ZLD'>module_diag_zld</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DIAG_ZLD_2">, ONLY : zld<a name='82'>
      USE <A href='../../html_code/phys/module_diag_afwa.F.html#MODULE_DIAG_AFWA'>module_diag_afwa</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DIAG_AFWA_1">, ONLY : afwa_diagnostics_driver<a name='83'>
      USE <A href='../../html_code/phys/module_diag_rasm.F.html#MODULE_DIAG_RASM'>module_diag_rasm</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DIAG_RASM_1">, ONLY : mean_output_calc, diurnalcycle_output_calc<a name='84'>
      USE <A href='../../html_code/phys/module_diag_hailcast.F.html#MODULE_DIAG_HAILCAST'>module_diag_hailcast</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DIAG_HAILCAST_1">, ONLY : hailcast_diagnostic_driver<a name='85'>
<a name='86'>
      IMPLICIT NONE<a name='87'>
<a name='88'>
<a name='89'>
      <font color=#447700>!=============================================================<a name='90'></font>
      <font color=#447700>!  Subroutine Arguments<a name='91'></font>
      <font color=#447700>!=============================================================<a name='92'></font>
<a name='93'>
      <font color=#447700>!  Arguments passed in.  All of the diagnostics are part of the grid structure, so<a name='94'></font>
      <font color=#447700>!  even though we are not changing any of the fundamental variables, we are computing<a name='95'></font>
      <font color=#447700>!  the diagnostics.  Therefore grid is INOUT.<a name='96'></font>
<a name='97'>
      TYPE ( domain ), INTENT(INOUT) :: grid<a name='98'>
<a name='99'>
      <font color=#447700>!  We are not changing any of the namelist settings.<a name='100'></font>
<a name='101'>
      TYPE ( grid_config_rec_type ), INTENT(IN) :: config_flags<a name='102'>
<a name='103'>
      <font color=#447700>!  The 4d arrays are input only, no mods to them.<a name='104'></font>
<a name='105'>
      REAL , DIMENSION(ims:ime,kms:kme,jms:jme,num_moist ) , INTENT(IN) :: moist<a name='106'>
      REAL , DIMENSION(ims:ime,kms:kme,jms:jme,num_chem  ) , INTENT(IN) :: chem<a name='107'>
      REAL , DIMENSION(ims:ime,kms:kme,jms:jme,num_tracer) , INTENT(IN) :: tracer<a name='108'>
      REAL , DIMENSION(ims:ime,kms:kme,jms:jme,num_scalar) , INTENT(IN) :: scalar<a name='109'>
<a name='110'>
      <font color=#447700>!  A few handy 3d arrays computed for the physics scheme: pressure (Pa) and<a name='111'></font>
      <font color=#447700>!  temperature (K), on both half (_phy) and full levels.<a name='112'></font>
<a name='113'>
      REAL , DIMENSION(ims:ime,kms:kme,jms:jme)            , INTENT(IN) :: th_phy  , &amp;<a name='114'>
                                                                           p_phy   , &amp;<a name='115'>
                                                                           pi_phy  , &amp;<a name='116'>
                                                                           rho_phy , &amp;<a name='117'>
                                                                           dz8w    , &amp;<a name='118'>
                                                                           p8w     , &amp;<a name='119'>
                                                                           t8w<a name='120'>
<a name='121'>
      <font color=#447700>!  Time (s) since the beginning of the restart.<a name='122'></font>
<a name='123'>
      REAL :: curr_secs2<a name='124'>
<a name='125'>
      <font color=#447700>!  Is this to be a history output time?  If so, compute the diagnostics.<a name='126'></font>
<a name='127'>
      LOGICAL :: diag_flag<a name='128'>
<a name='129'>
      <font color=#447700>!  The sundry dimensions required to keep a model running smoothly:<a name='130'></font>
      <font color=#447700>!     The first letter:<a name='131'></font>
      <font color=#447700>!        i: refers to the nominally west east direction, the inner-most (fastest)<a name='132'></font>
      <font color=#447700>!           incrementing index<a name='133'></font>
      <font color=#447700>!        j: refers to the nominally south north direction, the outer-most (slowest)<a name='134'></font>
      <font color=#447700>!           incrementing index<a name='135'></font>
      <font color=#447700>!        k: refers to the vertical direction form bottom to top, the second dimension<a name='136'></font>
      <font color=#447700>!           in all 3d arrays<a name='137'></font>
      <font color=#447700>!     The second letter: <a name='138'></font>
      <font color=#447700>!        d: refers to the domain size, the geophysical extent of the entire domain,<a name='139'></font>
      <font color=#447700>!           not used in dimensions or looping, used to determine when we are close to<a name='140'></font>
      <font color=#447700>!           the edge of the boundary<a name='141'></font>
      <font color=#447700>!        m: refers to the memory size size, all 2d and 3d arrays from the Registry<a name='142'></font>
      <font color=#447700>!           (passed into here via the grid structure or the I1 variables [such as<a name='143'></font>
      <font color=#447700>!           p_phy, for example]) use these values for dimensioning<a name='144'></font>
      <font color=#447700>!        p: refers to the patch size, the extent over which computational loops run<a name='145'></font>
<a name='146'>
      INTEGER , INTENT(IN) :: ids, ide, jds, jde, kds, kde,     &amp;<a name='147'>
                              ims, ime, jms, jme, kms, kme,     &amp;<a name='148'>
                              ips, ipe, jps, jpe, kps, kpe<a name='149'>
<a name='150'>
      <font color=#447700>!  Hopefully unnecessary, these are the filtered dimensions.<a name='151'></font>
<a name='152'>
      INTEGER , INTENT(IN) :: imsx,imex,jmsx,jmex,kmsx,kmex,    &amp;<a name='153'>
                              ipsx,ipex,jpsx,jpex,kpsx,kpex,    &amp;<a name='154'>
                              imsy,imey,jmsy,jmey,kmsy,kmey,    &amp;<a name='155'>
                              ipsy,ipey,jpsy,jpey,kpsy,kpey<a name='156'>
<a name='157'>
<a name='158'>
      <font color=#447700>!=============================================================<a name='159'></font>
      <font color=#447700>!  Local Variables<a name='160'></font>
      <font color=#447700>!=============================================================<a name='161'></font>
<a name='162'>
      <font color=#447700>!  Handy little character string for use instead of print statements.<a name='163'></font>
<a name='164'>
      CHARACTER (LEN=1000) :: diag_message<a name='165'>
<a name='166'>
      <font color=#447700>!  OpenMP indexing of tiles.<a name='167'></font>
<a name='168'>
      INTEGER :: ij<a name='169'>
<a name='170'>
      <font color=#447700>!  Vertical indexing that only goes up to the half levels.<a name='171'></font>
<a name='172'>
      INTEGER :: k_start, k_end<a name='173'>
<a name='174'>
      <font color=#447700>! Current time associated with current simulation step (RASM_DIAGS)<a name='175'></font>
<a name='176'>
      TYPE(WRFU_Time) :: currentTime<a name='177'>
<a name='178'>
      <font color=#447700>!=============================================================<a name='179'></font>
      <font color=#447700>!  Start of executable code<a name='180'></font>
      <font color=#447700>!=============================================================<a name='181'></font>
<a name='182'>
      CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_606"> ( 100 , '--&gt; TOP OF DIAGNOSTICS PACKAGE' )<a name='183'>
<a name='184'>
      <font color=#447700>!  Some routine initializations.<a name='185'></font>
<a name='186'>
      k_start = kps<a name='187'>
      k_end   = kpe-1<a name='188'>
<a name='189'>
<a name='190'>
<a name='191'>
      <font color=#447700>!  Lightning flash rate diagnostic production.<a name='192'></font>
<a name='193'>
      LIGHTNING: IF ( config_flags%lightning_option /= 0 ) THEN <a name='194'>
         CALL wrf_debug ( 100 , '--&gt; CALL DIAGNOSTICS PACKAGE: LIGHTNING_DRIVER' )<a name='195'>
         CALL <A href='../../html_code/phys/module_lightning_driver.F.html#LIGHTNING_DRIVER'>lightning_driver</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LIGHTNING_DRIVER_1"> ( &amp;<a name='196'>
          <font color=#447700>! Frequently used prognostics<a name='197'></font>
            grid%itimestep, grid%dt, grid%dx, grid%dy,         &amp;<a name='198'>
            grid%xlat, grid%xlong, grid%xland, grid%ht,        &amp;<a name='199'>
            grid%t_phy, p_phy, grid%rho,                       &amp;<a name='200'>
            grid%u_phy, grid%v_phy, grid%w_2,                  &amp;    <a name='201'>
            th_phy,     pi_phy,dz8w,                           &amp;  <a name='202'>
            grid%z, moist,                                     &amp;<a name='203'>
          <font color=#447700>! Scheme specific prognostics<a name='204'></font>
            grid%ktop_deep, grid%refl_10cm,                    &amp;<a name='205'>
            domain_get_current_time( grid ),                   &amp;<a name='206'>
          <font color=#447700>! Flashrate namelist inputs<a name='207'></font>
            config_flags%lightning_option,                     &amp;<a name='208'>
            config_flags%lightning_dt,                         &amp;<a name='209'>
            config_flags%lightning_start_seconds,              &amp;<a name='210'>
            config_flags%flashrate_factor,                     &amp;<a name='211'>
          <font color=#447700>! IC:CG namelist settings<a name='212'></font>
            config_flags%iccg_method,                          &amp;<a name='213'>
            config_flags%iccg_prescribed_num,                  &amp;<a name='214'>
            config_flags%iccg_prescribed_den,                  &amp;<a name='215'>
          <font color=#447700>! IC:CG inputs<a name='216'></font>
            grid%iccg_in_num, grid%iccg_in_den,                &amp;<a name='217'>
          <font color=#447700>! Scheme specific namelist inputs<a name='218'></font>
            config_flags%cellcount_method,                     &amp;<a name='219'>
            config_flags%cldtop_adjustment,                    &amp;<a name='220'>
          <font color=#447700>! Order dependent args for domain, mem, and tile dims <a name='221'></font>
            ids, ide, jds, jde, kds, kde,         &amp;<a name='222'>
            ims, ime, jms, jme, kms, kme,         &amp;<a name='223'>
            ips, ipe, jps, jpe, kps, kpe,         &amp;<a name='224'>
          <font color=#447700>! Mandatory outputs for all quantitative schemes<a name='225'></font>
            grid%ic_flashcount, grid%ic_flashrate,          &amp;<a name='226'>
            grid%cg_flashcount, grid%cg_flashrate,          &amp;<a name='227'>
            grid%lpi                                        &amp;   <a name='228'>
      )    <a name='229'>
      END IF LIGHTNING<a name='230'>
<a name='231'>
<a name='232'>
      <font color=#447700>!WRF-HAILCAST diagnostic - hail size prediction<a name='233'></font>
      HAILCAST: IF ( config_flags%hailcast_opt /= 0 ) THEN<a name='234'>
<a name='235'>
      IF ( ( config_flags%history_interval == 0 ) ) THEN<a name='236'>
            WRITE (diag_message , * ) &amp;<a name='237'>
            "HAILCAST Error : No 'history_interval' defined in namelist"<a name='238'>
            CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_628"> ( diag_message )<a name='239'>
        END IF<a name='240'>
<a name='241'>
        <font color=#447700>!$OMP PARALLEL DO   &amp;<a name='242'></font>
        <font color=#447700>!$OMP PRIVATE ( ij )<a name='243'></font>
        DO ij = 1 , grid%num_tiles<a name='244'>
<a name='245'>
           CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_607"> ( 100 ,                                             &amp;<a name='246'>
             '--&gt; CALL DIAGNOSTICS PACKAGE: HAILCAST_DIAGNOSTIC_DRIVER' )<a name='247'>
<a name='248'>
           CALL <A href='../../html_code/phys/module_diag_hailcast.F.html#HAILCAST_DIAGNOSTIC_DRIVER'>hailcast_diagnostic_driver</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="HAILCAST_DIAGNOSTIC_DRIVER_1"> (    grid , config_flags           &amp;<a name='249'>
                         ,moist, grid%rho                                     &amp;<a name='250'>
                         ,ids, ide, jds, jde, kds, kde                        &amp;<a name='251'>
                         ,ims, ime, jms, jme, kms, kme                        &amp;<a name='252'>
                         ,ips, ipe, jps, jpe, kps, kpe                        &amp;<a name='253'>
                         ,ITS=grid%i_start(ij),ITE=grid%i_end(ij)             &amp;<a name='254'>
                         ,JTS=grid%j_start(ij),JTE=grid%j_end(ij)             &amp;<a name='255'>
                         ,K_START=k_start,K_END=k_end                         )<a name='256'>
        END DO<a name='257'>
        <font color=#447700>!$OMP END PARALLEL DO<a name='258'></font>
      END IF HAILCAST<a name='259'>
<a name='260'>
<a name='261'>
      <font color=#447700>!  Mostly surface values, precip, column integrated quantities.<a name='262'></font>
<a name='263'>
      CALL wrf_debug ( 100 , '--&gt; CALL DIAGNOSTICS PACKAGE: NWP DIAGNOSTICS' )<a name='264'>
<a name='265'>
<a name='266'>
<a name='267'>
      mp_select: SELECT CASE(config_flags%mp_physics)<a name='268'>
<a name='269'>
        CASE (LINSCHEME, WSM6SCHEME, WDM6SCHEME, GSFCGCESCHEME, NSSL_1MOMLFO)<a name='270'>
<a name='271'>
      CALL <A href='../../html_code/phys/module_diag_misc.F.html#DIAGNOSTIC_OUTPUT_CALC'>diagnostic_output_calc</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DIAGNOSTIC_OUTPUT_CALC_1">(                                   &amp;<a name='272'>
                 DPSDT=grid%dpsdt   ,DMUDT=grid%dmudt                &amp;<a name='273'>
                ,P8W=p8w   ,PK1M=grid%pk1m                           &amp;<a name='274'>
                ,MU_2=grid%mu_2  ,MU_2M=grid%mu_2m                   &amp;<a name='275'>
                ,U=grid%u_2    ,V=grid%v_2                           &amp;<a name='276'>
                ,TEMP=grid%t_phy                                     &amp;<a name='277'>
                ,RAINCV=grid%raincv    ,RAINNCV=grid%rainncv         &amp;<a name='278'>
                ,RAINC=grid%rainc    ,RAINNC=grid%rainnc             &amp;<a name='279'>
                ,I_RAINC=grid%i_rainc    ,I_RAINNC=grid%i_rainnc     &amp;<a name='280'>
                ,HFX=grid%hfx   ,SFCEVP=grid%sfcevp    ,LH=grid%lh   &amp;    <a name='281'>
                ,DT=grid%dt      ,SBW=config_flags%spec_bdy_width    &amp;    <a name='282'>
                ,XTIME=grid%xtime   ,T2=grid%t2                      &amp;<a name='283'>
           ,ACSWUPT=grid%acswupt    ,ACSWUPTC=grid%acswuptc          &amp;<a name='284'>
           ,ACSWDNT=grid%acswdnt    ,ACSWDNTC=grid%acswdntc          &amp;<a name='285'>
           ,ACSWUPB=grid%acswupb    ,ACSWUPBC=grid%acswupbc          &amp;<a name='286'>
           ,ACSWDNB=grid%acswdnb    ,ACSWDNBC=grid%acswdnbc          &amp;<a name='287'>
           ,ACLWUPT=grid%aclwupt    ,ACLWUPTC=grid%aclwuptc          &amp;<a name='288'>
           ,ACLWDNT=grid%aclwdnt    ,ACLWDNTC=grid%aclwdntc          &amp;<a name='289'>
           ,ACLWUPB=grid%aclwupb    ,ACLWUPBC=grid%aclwupbc          &amp;<a name='290'>
           ,ACLWDNB=grid%aclwdnb    ,ACLWDNBC=grid%aclwdnbc          &amp;<a name='291'>
         ,I_ACSWUPT=grid%i_acswupt  ,I_ACSWUPTC=grid%i_acswuptc      &amp;<a name='292'>
         ,I_ACSWDNT=grid%i_acswdnt  ,I_ACSWDNTC=grid%i_acswdntc      &amp;<a name='293'>
         ,I_ACSWUPB=grid%i_acswupb  ,I_ACSWUPBC=grid%i_acswupbc      &amp;<a name='294'>
         ,I_ACSWDNB=grid%i_acswdnb  ,I_ACSWDNBC=grid%i_acswdnbc      &amp;<a name='295'>
         ,I_ACLWUPT=grid%i_aclwupt  ,I_ACLWUPTC=grid%i_aclwuptc      &amp;<a name='296'>
         ,I_ACLWDNT=grid%i_aclwdnt  ,I_ACLWDNTC=grid%i_aclwdntc      &amp;<a name='297'>
         ,I_ACLWUPB=grid%i_aclwupb  ,I_ACLWUPBC=grid%i_aclwupbc      &amp;<a name='298'>
         ,I_ACLWDNB=grid%i_aclwdnb  ,I_ACLWDNBC=grid%i_aclwdnbc      &amp;<a name='299'>
      <font color=#447700>! Selection flag <a name='300'></font>
                ,DIAG_PRINT=config_flags%diag_print                  &amp;<a name='301'>
                ,BUCKET_MM=config_flags%bucket_mm                    &amp;<a name='302'>
                ,BUCKET_J =config_flags%bucket_J                     &amp;<a name='303'>
                ,MPHYSICS_OPT=config_flags%mp_physics                &amp;  <font color=#447700>!  gthompsn<a name='304'></font>
                ,GSFCGCE_HAIL=config_flags%gsfcgce_hail              &amp;  <font color=#447700>!  gthompsn<a name='305'></font>
                ,GSFCGCE_2ICE=config_flags%gsfcgce_2ice              &amp;  <font color=#447700>!  gthompsn<a name='306'></font>
                ,MPUSE_HAIL=config_flags%hail_opt                    &amp;  <font color=#447700>!  gthompsn<a name='307'></font>
                ,NSSL_ALPHAH=config_flags%nssl_alphah                &amp;  <font color=#447700>!  gthompsn<a name='308'></font>
                ,NSSL_ALPHAHL=config_flags%nssl_alphahl              &amp;  <font color=#447700>!  gthompsn<a name='309'></font>
                ,NSSL_CNOH=config_flags%nssl_cnoh                    &amp;  <font color=#447700>!  gthompsn<a name='310'></font>
                ,NSSL_CNOHL=config_flags%nssl_cnohl                  &amp;  <font color=#447700>!  gthompsn<a name='311'></font>
                ,NSSL_RHO_QH=config_flags%nssl_rho_qh                &amp;  <font color=#447700>!  gthompsn<a name='312'></font>
                ,NSSL_RHO_QHL=config_flags%nssl_rho_qhl              &amp;  <font color=#447700>!  gthompsn<a name='313'></font>
                ,SNOWNCV=grid%snowncv, SNOW_ACC_NC=grid%snow_acc_nc  &amp;    <a name='314'>
                ,PREC_ACC_C=grid%prec_acc_c                          &amp;<a name='315'>
                ,PREC_ACC_NC=grid%prec_acc_nc                        &amp;<a name='316'>
                ,PREC_ACC_DT=config_flags%prec_acc_dt                &amp;<a name='317'>
                ,CURR_SECS2=curr_secs2                               &amp;<a name='318'>
                ,NWP_DIAGNOSTICS=config_flags%nwp_diagnostics        &amp;<a name='319'>
                ,DIAGFLAG=diag_flag                                  &amp;<a name='320'>
                ,HISTORY_INTERVAL=grid%history_interval              &amp;<a name='321'>
                ,ITIMESTEP=grid%itimestep                            &amp;<a name='322'>
                ,U10=grid%u10,V10=grid%v10,W=grid%w_2                &amp;<a name='323'>
                ,WSPD10MAX=grid%wspd10max                            &amp;<a name='324'>
                ,UP_HELI_MAX=grid%up_heli_max                        &amp;<a name='325'>
                ,W_UP_MAX=grid%w_up_max,W_DN_MAX=grid%w_dn_max       &amp;<a name='326'>
                ,ZNW=grid%znw,W_COLMEAN=grid%w_colmean               &amp;<a name='327'>
                ,NUMCOLPTS=grid%numcolpts,W_MEAN=grid%w_mean         &amp;<a name='328'>
                ,GRPL_MAX=grid%grpl_max,GRPL_COLINT=grid%grpl_colint &amp;<a name='329'>
                ,REFD_MAX=grid%refd_max                              &amp;<a name='330'>
                ,refl_10cm=grid%refl_10cm                            &amp;<a name='331'>
                ,HAIL_MAXK1=grid%hail_maxk1,HAIL_MAX2D=grid%hail_max2d &amp;  <font color=#447700>!  gthompsn<a name='332'></font>
                ,QG_CURR=moist(ims,kms,jms,P_QG)                     &amp;<a name='333'>
                ,RHO=grid%rho,PH=grid%ph_2,PHB=grid%phb,G=g          &amp;<a name='334'>
      <font color=#447700>! Dimension arguments<a name='335'></font>
                ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde   &amp;<a name='336'>
                ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme   &amp;<a name='337'>
                ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe   &amp;<a name='338'>
                ,I_START=grid%i_start,I_END=min(grid%i_end, ide-1)   &amp;<a name='339'>
                ,J_START=grid%j_start,J_END=min(grid%j_end, jde-1)   &amp;<a name='340'>
                ,KTS=k_start, KTE=min(k_end,kde-1)                   &amp;<a name='341'>
                ,NUM_TILES=grid%num_tiles                            &amp;<a name='342'>
                                                                    )<a name='343'>
<a name='344'>
        CASE (THOMPSON, THOMPSONAERO)<a name='345'>
<a name='346'>
      CALL <A href='../../html_code/phys/module_diag_misc.F.html#DIAGNOSTIC_OUTPUT_CALC'>diagnostic_output_calc</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DIAGNOSTIC_OUTPUT_CALC_2">(                                   &amp;<a name='347'>
                 DPSDT=grid%dpsdt   ,DMUDT=grid%dmudt                &amp;<a name='348'>
                ,P8W=p8w   ,PK1M=grid%pk1m                           &amp;<a name='349'>
                ,MU_2=grid%mu_2  ,MU_2M=grid%mu_2m                   &amp;<a name='350'>
                ,U=grid%u_2    ,V=grid%v_2                           &amp;<a name='351'>
                ,TEMP=grid%t_phy                                     &amp;<a name='352'>
                ,RAINCV=grid%raincv    ,RAINNCV=grid%rainncv         &amp;<a name='353'>
                ,RAINC=grid%rainc    ,RAINNC=grid%rainnc             &amp;<a name='354'>
                ,I_RAINC=grid%i_rainc    ,I_RAINNC=grid%i_rainnc     &amp;<a name='355'>
                ,HFX=grid%hfx   ,SFCEVP=grid%sfcevp    ,LH=grid%lh   &amp;    <a name='356'>
                ,DT=grid%dt      ,SBW=config_flags%spec_bdy_width    &amp;    <a name='357'>
                ,XTIME=grid%xtime   ,T2=grid%t2                      &amp;<a name='358'>
           ,ACSWUPT=grid%acswupt    ,ACSWUPTC=grid%acswuptc          &amp;<a name='359'>
           ,ACSWDNT=grid%acswdnt    ,ACSWDNTC=grid%acswdntc          &amp;<a name='360'>
           ,ACSWUPB=grid%acswupb    ,ACSWUPBC=grid%acswupbc          &amp;<a name='361'>
           ,ACSWDNB=grid%acswdnb    ,ACSWDNBC=grid%acswdnbc          &amp;<a name='362'>
           ,ACLWUPT=grid%aclwupt    ,ACLWUPTC=grid%aclwuptc          &amp;<a name='363'>
           ,ACLWDNT=grid%aclwdnt    ,ACLWDNTC=grid%aclwdntc          &amp;<a name='364'>
           ,ACLWUPB=grid%aclwupb    ,ACLWUPBC=grid%aclwupbc          &amp;<a name='365'>
           ,ACLWDNB=grid%aclwdnb    ,ACLWDNBC=grid%aclwdnbc          &amp;<a name='366'>
         ,I_ACSWUPT=grid%i_acswupt  ,I_ACSWUPTC=grid%i_acswuptc      &amp;<a name='367'>
         ,I_ACSWDNT=grid%i_acswdnt  ,I_ACSWDNTC=grid%i_acswdntc      &amp;<a name='368'>
         ,I_ACSWUPB=grid%i_acswupb  ,I_ACSWUPBC=grid%i_acswupbc      &amp;<a name='369'>
         ,I_ACSWDNB=grid%i_acswdnb  ,I_ACSWDNBC=grid%i_acswdnbc      &amp;<a name='370'>
         ,I_ACLWUPT=grid%i_aclwupt  ,I_ACLWUPTC=grid%i_aclwuptc      &amp;<a name='371'>
         ,I_ACLWDNT=grid%i_aclwdnt  ,I_ACLWDNTC=grid%i_aclwdntc      &amp;<a name='372'>
         ,I_ACLWUPB=grid%i_aclwupb  ,I_ACLWUPBC=grid%i_aclwupbc      &amp;<a name='373'>
         ,I_ACLWDNB=grid%i_aclwdnb  ,I_ACLWDNBC=grid%i_aclwdnbc      &amp;<a name='374'>
      <font color=#447700>! Selection flag <a name='375'></font>
                ,DIAG_PRINT=config_flags%diag_print                  &amp;<a name='376'>
                ,BUCKET_MM=config_flags%bucket_mm                    &amp;<a name='377'>
                ,BUCKET_J =config_flags%bucket_J                     &amp;<a name='378'>
                ,MPHYSICS_OPT=config_flags%mp_physics                &amp;  <font color=#447700>!  gthompsn<a name='379'></font>
                ,GSFCGCE_HAIL=config_flags%gsfcgce_hail              &amp;  <font color=#447700>!  gthompsn<a name='380'></font>
                ,GSFCGCE_2ICE=config_flags%gsfcgce_2ice              &amp;  <font color=#447700>!  gthompsn<a name='381'></font>
                ,MPUSE_HAIL=config_flags%hail_opt                    &amp;  <font color=#447700>!  gthompsn<a name='382'></font>
                ,NSSL_ALPHAH=config_flags%nssl_alphah                &amp;  <font color=#447700>!  gthompsn<a name='383'></font>
                ,NSSL_ALPHAHL=config_flags%nssl_alphahl              &amp;  <font color=#447700>!  gthompsn<a name='384'></font>
                ,NSSL_CNOH=config_flags%nssl_cnoh                    &amp;  <font color=#447700>!  gthompsn<a name='385'></font>
                ,NSSL_CNOHL=config_flags%nssl_cnohl                  &amp;  <font color=#447700>!  gthompsn<a name='386'></font>
                ,NSSL_RHO_QH=config_flags%nssl_rho_qh                &amp;  <font color=#447700>!  gthompsn<a name='387'></font>
                ,NSSL_RHO_QHL=config_flags%nssl_rho_qhl              &amp;  <font color=#447700>!  gthompsn<a name='388'></font>
                ,SNOWNCV=grid%snowncv, SNOW_ACC_NC=grid%snow_acc_nc  &amp;    <a name='389'>
                ,PREC_ACC_C=grid%prec_acc_c                          &amp;<a name='390'>
                ,PREC_ACC_NC=grid%prec_acc_nc                        &amp;<a name='391'>
                ,PREC_ACC_DT=config_flags%prec_acc_dt                &amp;<a name='392'>
                ,CURR_SECS2=curr_secs2                               &amp;<a name='393'>
                ,NWP_DIAGNOSTICS=config_flags%nwp_diagnostics        &amp;<a name='394'>
                ,DIAGFLAG=diag_flag                                  &amp;<a name='395'>
                ,HISTORY_INTERVAL=grid%history_interval              &amp;<a name='396'>
                ,ITIMESTEP=grid%itimestep                            &amp;<a name='397'>
                ,U10=grid%u10,V10=grid%v10,W=grid%w_2                &amp;<a name='398'>
                ,WSPD10MAX=grid%wspd10max                            &amp;<a name='399'>
                ,UP_HELI_MAX=grid%up_heli_max                        &amp;<a name='400'>
                ,W_UP_MAX=grid%w_up_max,W_DN_MAX=grid%w_dn_max       &amp;<a name='401'>
                ,ZNW=grid%znw,W_COLMEAN=grid%w_colmean               &amp;<a name='402'>
                ,NUMCOLPTS=grid%numcolpts,W_MEAN=grid%w_mean         &amp;<a name='403'>
                ,GRPL_MAX=grid%grpl_max,GRPL_COLINT=grid%grpl_colint &amp;<a name='404'>
                ,REFD_MAX=grid%refd_max                              &amp;<a name='405'>
                ,refl_10cm=grid%refl_10cm                            &amp;<a name='406'>
                ,HAIL_MAXK1=grid%hail_maxk1,HAIL_MAX2D=grid%hail_max2d &amp;  <font color=#447700>!  gthompsn<a name='407'></font>
                ,QG_CURR=moist(ims,kms,jms,P_QG)                     &amp;<a name='408'>
                ,QR_CURR=moist(ims,kms,jms,P_QR)                     &amp;  <font color=#447700>!  gthompsn<a name='409'></font>
                ,NR_CURR=scalar(ims,kms,jms,P_QNR)                   &amp;  <font color=#447700>!  gthompsn<a name='410'></font>
                ,RHO=grid%rho,PH=grid%ph_2,PHB=grid%phb,G=g          &amp;<a name='411'>
      <font color=#447700>! Dimension arguments<a name='412'></font>
                ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde   &amp;<a name='413'>
                ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme   &amp;<a name='414'>
                ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe   &amp;<a name='415'>
                ,I_START=grid%i_start,I_END=min(grid%i_end, ide-1)   &amp;<a name='416'>
                ,J_START=grid%j_start,J_END=min(grid%j_end, jde-1)   &amp;<a name='417'>
                ,KTS=k_start, KTE=min(k_end,kde-1)                   &amp;<a name='418'>
                ,NUM_TILES=grid%num_tiles                            &amp;<a name='419'>
                                                                    )<a name='420'>
<a name='421'>
        CASE (MORR_TWO_MOMENT)<a name='422'>
<a name='423'>
      CALL <A href='../../html_code/phys/module_diag_misc.F.html#DIAGNOSTIC_OUTPUT_CALC'>diagnostic_output_calc</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DIAGNOSTIC_OUTPUT_CALC_3">(                                   &amp;<a name='424'>
                 DPSDT=grid%dpsdt   ,DMUDT=grid%dmudt                &amp;<a name='425'>
                ,P8W=p8w   ,PK1M=grid%pk1m                           &amp;<a name='426'>
                ,MU_2=grid%mu_2  ,MU_2M=grid%mu_2m                   &amp;<a name='427'>
                ,U=grid%u_2    ,V=grid%v_2                           &amp;<a name='428'>
                ,TEMP=grid%t_phy                                     &amp;<a name='429'>
                ,RAINCV=grid%raincv    ,RAINNCV=grid%rainncv         &amp;<a name='430'>
                ,RAINC=grid%rainc    ,RAINNC=grid%rainnc             &amp;<a name='431'>
                ,I_RAINC=grid%i_rainc    ,I_RAINNC=grid%i_rainnc     &amp;<a name='432'>
                ,HFX=grid%hfx   ,SFCEVP=grid%sfcevp    ,LH=grid%lh   &amp;    <a name='433'>
                ,DT=grid%dt      ,SBW=config_flags%spec_bdy_width    &amp;    <a name='434'>
                ,XTIME=grid%xtime   ,T2=grid%t2                      &amp;<a name='435'>
           ,ACSWUPT=grid%acswupt    ,ACSWUPTC=grid%acswuptc          &amp;<a name='436'>
           ,ACSWDNT=grid%acswdnt    ,ACSWDNTC=grid%acswdntc          &amp;<a name='437'>
           ,ACSWUPB=grid%acswupb    ,ACSWUPBC=grid%acswupbc          &amp;<a name='438'>
           ,ACSWDNB=grid%acswdnb    ,ACSWDNBC=grid%acswdnbc          &amp;<a name='439'>
           ,ACLWUPT=grid%aclwupt    ,ACLWUPTC=grid%aclwuptc          &amp;<a name='440'>
           ,ACLWDNT=grid%aclwdnt    ,ACLWDNTC=grid%aclwdntc          &amp;<a name='441'>
           ,ACLWUPB=grid%aclwupb    ,ACLWUPBC=grid%aclwupbc          &amp;<a name='442'>
           ,ACLWDNB=grid%aclwdnb    ,ACLWDNBC=grid%aclwdnbc          &amp;<a name='443'>
         ,I_ACSWUPT=grid%i_acswupt  ,I_ACSWUPTC=grid%i_acswuptc      &amp;<a name='444'>
         ,I_ACSWDNT=grid%i_acswdnt  ,I_ACSWDNTC=grid%i_acswdntc      &amp;<a name='445'>
         ,I_ACSWUPB=grid%i_acswupb  ,I_ACSWUPBC=grid%i_acswupbc      &amp;<a name='446'>
         ,I_ACSWDNB=grid%i_acswdnb  ,I_ACSWDNBC=grid%i_acswdnbc      &amp;<a name='447'>
         ,I_ACLWUPT=grid%i_aclwupt  ,I_ACLWUPTC=grid%i_aclwuptc      &amp;<a name='448'>
         ,I_ACLWDNT=grid%i_aclwdnt  ,I_ACLWDNTC=grid%i_aclwdntc      &amp;<a name='449'>
         ,I_ACLWUPB=grid%i_aclwupb  ,I_ACLWUPBC=grid%i_aclwupbc      &amp;<a name='450'>
         ,I_ACLWDNB=grid%i_aclwdnb  ,I_ACLWDNBC=grid%i_aclwdnbc      &amp;<a name='451'>
      <font color=#447700>! Selection flag <a name='452'></font>
                ,DIAG_PRINT=config_flags%diag_print                  &amp;<a name='453'>
                ,BUCKET_MM=config_flags%bucket_mm                    &amp;<a name='454'>
                ,BUCKET_J =config_flags%bucket_J                     &amp;<a name='455'>
                ,MPHYSICS_OPT=config_flags%mp_physics                &amp;  <font color=#447700>!  gthompsn<a name='456'></font>
                ,GSFCGCE_HAIL=config_flags%gsfcgce_hail              &amp;  <font color=#447700>!  gthompsn<a name='457'></font>
                ,GSFCGCE_2ICE=config_flags%gsfcgce_2ice              &amp;  <font color=#447700>!  gthompsn<a name='458'></font>
                ,MPUSE_HAIL=config_flags%hail_opt                    &amp;  <font color=#447700>!  gthompsn<a name='459'></font>
                ,NSSL_ALPHAH=config_flags%nssl_alphah                &amp;  <font color=#447700>!  gthompsn<a name='460'></font>
                ,NSSL_ALPHAHL=config_flags%nssl_alphahl              &amp;  <font color=#447700>!  gthompsn<a name='461'></font>
                ,NSSL_CNOH=config_flags%nssl_cnoh                    &amp;  <font color=#447700>!  gthompsn<a name='462'></font>
                ,NSSL_CNOHL=config_flags%nssl_cnohl                  &amp;  <font color=#447700>!  gthompsn<a name='463'></font>
                ,NSSL_RHO_QH=config_flags%nssl_rho_qh                &amp;  <font color=#447700>!  gthompsn<a name='464'></font>
                ,NSSL_RHO_QHL=config_flags%nssl_rho_qhl              &amp;  <font color=#447700>!  gthompsn<a name='465'></font>
                ,SNOWNCV=grid%snowncv, SNOW_ACC_NC=grid%snow_acc_nc  &amp;    <a name='466'>
                ,PREC_ACC_C=grid%prec_acc_c                          &amp;<a name='467'>
                ,PREC_ACC_NC=grid%prec_acc_nc                        &amp;<a name='468'>
                ,PREC_ACC_DT=config_flags%prec_acc_dt                &amp;<a name='469'>
                ,CURR_SECS2=curr_secs2                               &amp;<a name='470'>
                ,NWP_DIAGNOSTICS=config_flags%nwp_diagnostics        &amp;<a name='471'>
                ,DIAGFLAG=diag_flag                                  &amp;<a name='472'>
                ,HISTORY_INTERVAL=grid%history_interval              &amp;<a name='473'>
                ,ITIMESTEP=grid%itimestep                            &amp;<a name='474'>
                ,U10=grid%u10,V10=grid%v10,W=grid%w_2                &amp;<a name='475'>
                ,WSPD10MAX=grid%wspd10max                            &amp;<a name='476'>
                ,UP_HELI_MAX=grid%up_heli_max                        &amp;<a name='477'>
                ,W_UP_MAX=grid%w_up_max,W_DN_MAX=grid%w_dn_max       &amp;<a name='478'>
                ,ZNW=grid%znw,W_COLMEAN=grid%w_colmean               &amp;<a name='479'>
                ,NUMCOLPTS=grid%numcolpts,W_MEAN=grid%w_mean         &amp;<a name='480'>
                ,GRPL_MAX=grid%grpl_max,GRPL_COLINT=grid%grpl_colint &amp;<a name='481'>
                ,REFD_MAX=grid%refd_max                              &amp;<a name='482'>
                ,refl_10cm=grid%refl_10cm                            &amp;<a name='483'>
                ,HAIL_MAXK1=grid%hail_maxk1,HAIL_MAX2D=grid%hail_max2d &amp;  <font color=#447700>!  gthompsn<a name='484'></font>
                ,QG_CURR=moist(ims,kms,jms,P_QG)                     &amp;<a name='485'>
                ,NG_CURR=scalar(ims,kms,jms,P_QNG)                   &amp;  <font color=#447700>!  gthompsn<a name='486'></font>
                ,RHO=grid%rho,PH=grid%ph_2,PHB=grid%phb,G=g          &amp;<a name='487'>
      <font color=#447700>! Dimension arguments<a name='488'></font>
                ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde   &amp;<a name='489'>
                ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme   &amp;<a name='490'>
                ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe   &amp;<a name='491'>
                ,I_START=grid%i_start,I_END=min(grid%i_end, ide-1)   &amp;<a name='492'>
                ,J_START=grid%j_start,J_END=min(grid%j_end, jde-1)   &amp;<a name='493'>
                ,KTS=k_start, KTE=min(k_end,kde-1)                   &amp;<a name='494'>
                ,NUM_TILES=grid%num_tiles                            &amp;<a name='495'>
                                                                    )<a name='496'>
<a name='497'>
        CASE (NSSL_1MOM)<a name='498'>
<a name='499'>
      CALL <A href='../../html_code/phys/module_diag_misc.F.html#DIAGNOSTIC_OUTPUT_CALC'>diagnostic_output_calc</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DIAGNOSTIC_OUTPUT_CALC_4">(                                   &amp;<a name='500'>
                 DPSDT=grid%dpsdt   ,DMUDT=grid%dmudt                &amp;<a name='501'>
                ,P8W=p8w   ,PK1M=grid%pk1m                           &amp;<a name='502'>
                ,MU_2=grid%mu_2  ,MU_2M=grid%mu_2m                   &amp;<a name='503'>
                ,U=grid%u_2    ,V=grid%v_2                           &amp;<a name='504'>
                ,TEMP=grid%t_phy                                     &amp;<a name='505'>
                ,RAINCV=grid%raincv    ,RAINNCV=grid%rainncv         &amp;<a name='506'>
                ,RAINC=grid%rainc    ,RAINNC=grid%rainnc             &amp;<a name='507'>
                ,I_RAINC=grid%i_rainc    ,I_RAINNC=grid%i_rainnc     &amp;<a name='508'>
                ,HFX=grid%hfx   ,SFCEVP=grid%sfcevp    ,LH=grid%lh   &amp;    <a name='509'>
                ,DT=grid%dt      ,SBW=config_flags%spec_bdy_width    &amp;    <a name='510'>
                ,XTIME=grid%xtime   ,T2=grid%t2                      &amp;<a name='511'>
           ,ACSWUPT=grid%acswupt    ,ACSWUPTC=grid%acswuptc          &amp;<a name='512'>
           ,ACSWDNT=grid%acswdnt    ,ACSWDNTC=grid%acswdntc          &amp;<a name='513'>
           ,ACSWUPB=grid%acswupb    ,ACSWUPBC=grid%acswupbc          &amp;<a name='514'>
           ,ACSWDNB=grid%acswdnb    ,ACSWDNBC=grid%acswdnbc          &amp;<a name='515'>
           ,ACLWUPT=grid%aclwupt    ,ACLWUPTC=grid%aclwuptc          &amp;<a name='516'>
           ,ACLWDNT=grid%aclwdnt    ,ACLWDNTC=grid%aclwdntc          &amp;<a name='517'>
           ,ACLWUPB=grid%aclwupb    ,ACLWUPBC=grid%aclwupbc          &amp;<a name='518'>
           ,ACLWDNB=grid%aclwdnb    ,ACLWDNBC=grid%aclwdnbc          &amp;<a name='519'>
         ,I_ACSWUPT=grid%i_acswupt  ,I_ACSWUPTC=grid%i_acswuptc      &amp;<a name='520'>
         ,I_ACSWDNT=grid%i_acswdnt  ,I_ACSWDNTC=grid%i_acswdntc      &amp;<a name='521'>
         ,I_ACSWUPB=grid%i_acswupb  ,I_ACSWUPBC=grid%i_acswupbc      &amp;<a name='522'>
         ,I_ACSWDNB=grid%i_acswdnb  ,I_ACSWDNBC=grid%i_acswdnbc      &amp;<a name='523'>
         ,I_ACLWUPT=grid%i_aclwupt  ,I_ACLWUPTC=grid%i_aclwuptc      &amp;<a name='524'>
         ,I_ACLWDNT=grid%i_aclwdnt  ,I_ACLWDNTC=grid%i_aclwdntc      &amp;<a name='525'>
         ,I_ACLWUPB=grid%i_aclwupb  ,I_ACLWUPBC=grid%i_aclwupbc      &amp;<a name='526'>
         ,I_ACLWDNB=grid%i_aclwdnb  ,I_ACLWDNBC=grid%i_aclwdnbc      &amp;<a name='527'>
      <font color=#447700>! Selection flag <a name='528'></font>
                ,DIAG_PRINT=config_flags%diag_print                  &amp;<a name='529'>
                ,BUCKET_MM=config_flags%bucket_mm                    &amp;<a name='530'>
                ,BUCKET_J =config_flags%bucket_J                     &amp;<a name='531'>
                ,MPHYSICS_OPT=config_flags%mp_physics                &amp;  <font color=#447700>!  gthompsn<a name='532'></font>
                ,GSFCGCE_HAIL=config_flags%gsfcgce_hail              &amp;  <font color=#447700>!  gthompsn<a name='533'></font>
                ,GSFCGCE_2ICE=config_flags%gsfcgce_2ice              &amp;  <font color=#447700>!  gthompsn<a name='534'></font>
                ,MPUSE_HAIL=config_flags%hail_opt                    &amp;  <font color=#447700>!  gthompsn<a name='535'></font>
                ,NSSL_ALPHAH=config_flags%nssl_alphah                &amp;  <font color=#447700>!  gthompsn<a name='536'></font>
                ,NSSL_ALPHAHL=config_flags%nssl_alphahl              &amp;  <font color=#447700>!  gthompsn<a name='537'></font>
                ,NSSL_CNOH=config_flags%nssl_cnoh                    &amp;  <font color=#447700>!  gthompsn<a name='538'></font>
                ,NSSL_CNOHL=config_flags%nssl_cnohl                  &amp;  <font color=#447700>!  gthompsn<a name='539'></font>
                ,NSSL_RHO_QH=config_flags%nssl_rho_qh                &amp;  <font color=#447700>!  gthompsn<a name='540'></font>
                ,NSSL_RHO_QHL=config_flags%nssl_rho_qhl              &amp;  <font color=#447700>!  gthompsn<a name='541'></font>
                ,SNOWNCV=grid%snowncv, SNOW_ACC_NC=grid%snow_acc_nc  &amp;    <a name='542'>
                ,PREC_ACC_C=grid%prec_acc_c                          &amp;<a name='543'>
                ,PREC_ACC_NC=grid%prec_acc_nc                        &amp;<a name='544'>
                ,PREC_ACC_DT=config_flags%prec_acc_dt                &amp;<a name='545'>
                ,CURR_SECS2=curr_secs2                               &amp;<a name='546'>
                ,NWP_DIAGNOSTICS=config_flags%nwp_diagnostics        &amp;<a name='547'>
                ,DIAGFLAG=diag_flag                                  &amp;<a name='548'>
                ,HISTORY_INTERVAL=grid%history_interval              &amp;<a name='549'>
                ,ITIMESTEP=grid%itimestep                            &amp;<a name='550'>
                ,U10=grid%u10,V10=grid%v10,W=grid%w_2                &amp;<a name='551'>
                ,WSPD10MAX=grid%wspd10max                            &amp;<a name='552'>
                ,UP_HELI_MAX=grid%up_heli_max                        &amp;<a name='553'>
                ,W_UP_MAX=grid%w_up_max,W_DN_MAX=grid%w_dn_max       &amp;<a name='554'>
                ,ZNW=grid%znw,W_COLMEAN=grid%w_colmean               &amp;<a name='555'>
                ,NUMCOLPTS=grid%numcolpts,W_MEAN=grid%w_mean         &amp;<a name='556'>
                ,GRPL_MAX=grid%grpl_max,GRPL_COLINT=grid%grpl_colint &amp;<a name='557'>
                ,REFD_MAX=grid%refd_max                              &amp;<a name='558'>
                ,refl_10cm=grid%refl_10cm                            &amp;<a name='559'>
                ,HAIL_MAXK1=grid%hail_maxk1,HAIL_MAX2D=grid%hail_max2d &amp;  <font color=#447700>!  gthompsn<a name='560'></font>
                ,QG_CURR=moist(ims,kms,jms,P_QG)                     &amp;<a name='561'>
                ,QH_CURR=moist(ims,kms,jms,P_QH)                     &amp;  <font color=#447700>!  gthompsn<a name='562'></font>
                ,RHO=grid%rho,PH=grid%ph_2,PHB=grid%phb,G=g          &amp;<a name='563'>
      <font color=#447700>! Dimension arguments<a name='564'></font>
                ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde   &amp;<a name='565'>
                ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme   &amp;<a name='566'>
                ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe   &amp;<a name='567'>
                ,I_START=grid%i_start,I_END=min(grid%i_end, ide-1)   &amp;<a name='568'>
                ,J_START=grid%j_start,J_END=min(grid%j_end, jde-1)   &amp;<a name='569'>
                ,KTS=k_start, KTE=min(k_end,kde-1)                   &amp;<a name='570'>
                ,NUM_TILES=grid%num_tiles                            &amp;<a name='571'>
                                                                    )<a name='572'>
<a name='573'>
        CASE (MILBRANDT2MOM, NSSL_2MOM, NSSL_2MOMCCN)<a name='574'>
<a name='575'>
      CALL <A href='../../html_code/phys/module_diag_misc.F.html#DIAGNOSTIC_OUTPUT_CALC'>diagnostic_output_calc</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DIAGNOSTIC_OUTPUT_CALC_5">(                                   &amp;<a name='576'>
                 DPSDT=grid%dpsdt   ,DMUDT=grid%dmudt                &amp;<a name='577'>
                ,P8W=p8w   ,PK1M=grid%pk1m                           &amp;<a name='578'>
                ,MU_2=grid%mu_2  ,MU_2M=grid%mu_2m                   &amp;<a name='579'>
                ,U=grid%u_2    ,V=grid%v_2                           &amp;<a name='580'>
                ,TEMP=grid%t_phy                                     &amp;<a name='581'>
                ,RAINCV=grid%raincv    ,RAINNCV=grid%rainncv         &amp;<a name='582'>
                ,RAINC=grid%rainc    ,RAINNC=grid%rainnc             &amp;<a name='583'>
                ,I_RAINC=grid%i_rainc    ,I_RAINNC=grid%i_rainnc     &amp;<a name='584'>
                ,HFX=grid%hfx   ,SFCEVP=grid%sfcevp    ,LH=grid%lh   &amp;    <a name='585'>
                ,DT=grid%dt      ,SBW=config_flags%spec_bdy_width    &amp;    <a name='586'>
                ,XTIME=grid%xtime   ,T2=grid%t2                      &amp;<a name='587'>
           ,ACSWUPT=grid%acswupt    ,ACSWUPTC=grid%acswuptc          &amp;<a name='588'>
           ,ACSWDNT=grid%acswdnt    ,ACSWDNTC=grid%acswdntc          &amp;<a name='589'>
           ,ACSWUPB=grid%acswupb    ,ACSWUPBC=grid%acswupbc          &amp;<a name='590'>
           ,ACSWDNB=grid%acswdnb    ,ACSWDNBC=grid%acswdnbc          &amp;<a name='591'>
           ,ACLWUPT=grid%aclwupt    ,ACLWUPTC=grid%aclwuptc          &amp;<a name='592'>
           ,ACLWDNT=grid%aclwdnt    ,ACLWDNTC=grid%aclwdntc          &amp;<a name='593'>
           ,ACLWUPB=grid%aclwupb    ,ACLWUPBC=grid%aclwupbc          &amp;<a name='594'>
           ,ACLWDNB=grid%aclwdnb    ,ACLWDNBC=grid%aclwdnbc          &amp;<a name='595'>
         ,I_ACSWUPT=grid%i_acswupt  ,I_ACSWUPTC=grid%i_acswuptc      &amp;<a name='596'>
         ,I_ACSWDNT=grid%i_acswdnt  ,I_ACSWDNTC=grid%i_acswdntc      &amp;<a name='597'>
         ,I_ACSWUPB=grid%i_acswupb  ,I_ACSWUPBC=grid%i_acswupbc      &amp;<a name='598'>
         ,I_ACSWDNB=grid%i_acswdnb  ,I_ACSWDNBC=grid%i_acswdnbc      &amp;<a name='599'>
         ,I_ACLWUPT=grid%i_aclwupt  ,I_ACLWUPTC=grid%i_aclwuptc      &amp;<a name='600'>
         ,I_ACLWDNT=grid%i_aclwdnt  ,I_ACLWDNTC=grid%i_aclwdntc      &amp;<a name='601'>
         ,I_ACLWUPB=grid%i_aclwupb  ,I_ACLWUPBC=grid%i_aclwupbc      &amp;<a name='602'>
         ,I_ACLWDNB=grid%i_aclwdnb  ,I_ACLWDNBC=grid%i_aclwdnbc      &amp;<a name='603'>
      <font color=#447700>! Selection flag <a name='604'></font>
                ,DIAG_PRINT=config_flags%diag_print                  &amp;<a name='605'>
                ,BUCKET_MM=config_flags%bucket_mm                    &amp;<a name='606'>
                ,BUCKET_J =config_flags%bucket_J                     &amp;<a name='607'>
                ,MPHYSICS_OPT=config_flags%mp_physics                &amp;  <font color=#447700>!  gthompsn<a name='608'></font>
                ,GSFCGCE_HAIL=config_flags%gsfcgce_hail              &amp;  <font color=#447700>!  gthompsn<a name='609'></font>
                ,GSFCGCE_2ICE=config_flags%gsfcgce_2ice              &amp;  <font color=#447700>!  gthompsn<a name='610'></font>
                ,MPUSE_HAIL=config_flags%hail_opt                    &amp;  <font color=#447700>!  gthompsn<a name='611'></font>
                ,NSSL_ALPHAH=config_flags%nssl_alphah                &amp;  <font color=#447700>!  gthompsn<a name='612'></font>
                ,NSSL_ALPHAHL=config_flags%nssl_alphahl              &amp;  <font color=#447700>!  gthompsn<a name='613'></font>
                ,NSSL_CNOH=config_flags%nssl_cnoh                    &amp;  <font color=#447700>!  gthompsn<a name='614'></font>
                ,NSSL_CNOHL=config_flags%nssl_cnohl                  &amp;  <font color=#447700>!  gthompsn<a name='615'></font>
                ,NSSL_RHO_QH=config_flags%nssl_rho_qh                &amp;  <font color=#447700>!  gthompsn<a name='616'></font>
                ,NSSL_RHO_QHL=config_flags%nssl_rho_qhl              &amp;  <font color=#447700>!  gthompsn<a name='617'></font>
                ,SNOWNCV=grid%snowncv, SNOW_ACC_NC=grid%snow_acc_nc  &amp;    <a name='618'>
                ,PREC_ACC_C=grid%prec_acc_c                          &amp;<a name='619'>
                ,PREC_ACC_NC=grid%prec_acc_nc                        &amp;<a name='620'>
                ,PREC_ACC_DT=config_flags%prec_acc_dt                &amp;<a name='621'>
                ,CURR_SECS2=curr_secs2                               &amp;<a name='622'>
                ,NWP_DIAGNOSTICS=config_flags%nwp_diagnostics        &amp;<a name='623'>
                ,DIAGFLAG=diag_flag                                  &amp;<a name='624'>
                ,HISTORY_INTERVAL=grid%history_interval              &amp;<a name='625'>
                ,ITIMESTEP=grid%itimestep                            &amp;<a name='626'>
                ,U10=grid%u10,V10=grid%v10,W=grid%w_2                &amp;<a name='627'>
                ,WSPD10MAX=grid%wspd10max                            &amp;<a name='628'>
                ,UP_HELI_MAX=grid%up_heli_max                        &amp;<a name='629'>
                ,W_UP_MAX=grid%w_up_max,W_DN_MAX=grid%w_dn_max       &amp;<a name='630'>
                ,ZNW=grid%znw,W_COLMEAN=grid%w_colmean               &amp;<a name='631'>
                ,NUMCOLPTS=grid%numcolpts,W_MEAN=grid%w_mean         &amp;<a name='632'>
                ,GRPL_MAX=grid%grpl_max,GRPL_COLINT=grid%grpl_colint &amp;<a name='633'>
                ,REFD_MAX=grid%refd_max                              &amp;<a name='634'>
                ,refl_10cm=grid%refl_10cm                            &amp;<a name='635'>
                ,HAIL_MAXK1=grid%hail_maxk1,HAIL_MAX2D=grid%hail_max2d &amp;  <font color=#447700>!  gthompsn<a name='636'></font>
                ,QG_CURR=moist(ims,kms,jms,P_QG)                     &amp;<a name='637'>
                ,NG_CURR=scalar(ims,kms,jms,P_QNG)                   &amp;  <font color=#447700>!  gthompsn<a name='638'></font>
                ,QH_CURR=moist(ims,kms,jms,P_QH)                     &amp;  <font color=#447700>!  gthompsn<a name='639'></font>
                ,NH_CURR=scalar(ims,kms,jms,P_QNH)                   &amp;  <font color=#447700>!  gthompsn<a name='640'></font>
                ,RHO=grid%rho,PH=grid%ph_2,PHB=grid%phb,G=g          &amp;<a name='641'>
      <font color=#447700>! Dimension arguments<a name='642'></font>
                ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde   &amp;<a name='643'>
                ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme   &amp;<a name='644'>
                ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe   &amp;<a name='645'>
                ,I_START=grid%i_start,I_END=min(grid%i_end, ide-1)   &amp;<a name='646'>
                ,J_START=grid%j_start,J_END=min(grid%j_end, jde-1)   &amp;<a name='647'>
                ,KTS=k_start, KTE=min(k_end,kde-1)                   &amp;<a name='648'>
                ,NUM_TILES=grid%num_tiles                            &amp;<a name='649'>
                                                                    )<a name='650'>
<a name='651'>
<a name='652'>
        <font color=#447700>!..The remaining microphysics schemes do not have graupel, but<a name='653'></font>
        <font color=#447700>!..P_QG will just be empty and the remaining NWP-diagnostics can<a name='654'></font>
        <font color=#447700>!..still be computed, so go ahead, under DEFAULT, not their own.<a name='655'></font>
<a name='656'>
<font color=#447700>!       CASE (KESSLERSCHEME)<a name='657'></font>
<a name='658'>
<font color=#447700>!       CASE (WDM5SCHEME)<a name='659'></font>
<a name='660'>
<font color=#447700>!       CASE (SBU_YLINSCHEME)<a name='661'></font>
<a name='662'>
<font color=#447700>!       CASE (ETAMPNEW)<a name='663'></font>
<a name='664'>
<font color=#447700>!       CASE (NSSL_3MOM)<a name='665'></font>
<a name='666'>
<font color=#447700>!       CASE (MILBRANDT3MOM)<a name='667'></font>
<a name='668'>
<font color=#447700>!       CASE (MORR_MILB_P3)<a name='669'></font>
<a name='670'>
<font color=#447700>!       CASE (CAMMGMPSCHEME)<a name='671'></font>
<a name='672'>
<font color=#447700>!       CASE (FULL_KHAIN_LYNN)<a name='673'></font>
<a name='674'>
<font color=#447700>!       CASE (FAST_KHAIN_LYNN)<a name='675'></font>
<a name='676'>
<font color=#447700>!       CASE (WSM3SCHEME)<a name='677'></font>
<a name='678'>
<font color=#447700>!       CASE (WSM5SCHEME)<a name='679'></font>
<a name='680'>
        CASE DEFAULT<a name='681'>
<a name='682'>
      CALL <A href='../../html_code/phys/module_diag_misc.F.html#DIAGNOSTIC_OUTPUT_CALC'>diagnostic_output_calc</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DIAGNOSTIC_OUTPUT_CALC_6">(                                   &amp;<a name='683'>
                 DPSDT=grid%dpsdt   ,DMUDT=grid%dmudt                &amp;<a name='684'>
                ,P8W=p8w   ,PK1M=grid%pk1m                           &amp;<a name='685'>
                ,MU_2=grid%mu_2  ,MU_2M=grid%mu_2m                   &amp;<a name='686'>
                ,U=grid%u_2    ,V=grid%v_2                           &amp;<a name='687'>
                ,TEMP=grid%t_phy                                     &amp;<a name='688'>
                ,RAINCV=grid%raincv    ,RAINNCV=grid%rainncv         &amp;<a name='689'>
                ,RAINC=grid%rainc    ,RAINNC=grid%rainnc             &amp;<a name='690'>
                ,I_RAINC=grid%i_rainc    ,I_RAINNC=grid%i_rainnc     &amp;<a name='691'>
                ,HFX=grid%hfx   ,SFCEVP=grid%sfcevp    ,LH=grid%lh   &amp;    <a name='692'>
                ,DT=grid%dt      ,SBW=config_flags%spec_bdy_width    &amp;    <a name='693'>
                ,XTIME=grid%xtime   ,T2=grid%t2                      &amp;<a name='694'>
           ,ACSWUPT=grid%acswupt    ,ACSWUPTC=grid%acswuptc          &amp;<a name='695'>
           ,ACSWDNT=grid%acswdnt    ,ACSWDNTC=grid%acswdntc          &amp;<a name='696'>
           ,ACSWUPB=grid%acswupb    ,ACSWUPBC=grid%acswupbc          &amp;<a name='697'>
           ,ACSWDNB=grid%acswdnb    ,ACSWDNBC=grid%acswdnbc          &amp;<a name='698'>
           ,ACLWUPT=grid%aclwupt    ,ACLWUPTC=grid%aclwuptc          &amp;<a name='699'>
           ,ACLWDNT=grid%aclwdnt    ,ACLWDNTC=grid%aclwdntc          &amp;<a name='700'>
           ,ACLWUPB=grid%aclwupb    ,ACLWUPBC=grid%aclwupbc          &amp;<a name='701'>
           ,ACLWDNB=grid%aclwdnb    ,ACLWDNBC=grid%aclwdnbc          &amp;<a name='702'>
         ,I_ACSWUPT=grid%i_acswupt  ,I_ACSWUPTC=grid%i_acswuptc      &amp;<a name='703'>
         ,I_ACSWDNT=grid%i_acswdnt  ,I_ACSWDNTC=grid%i_acswdntc      &amp;<a name='704'>
         ,I_ACSWUPB=grid%i_acswupb  ,I_ACSWUPBC=grid%i_acswupbc      &amp;<a name='705'>
         ,I_ACSWDNB=grid%i_acswdnb  ,I_ACSWDNBC=grid%i_acswdnbc      &amp;<a name='706'>
         ,I_ACLWUPT=grid%i_aclwupt  ,I_ACLWUPTC=grid%i_aclwuptc      &amp;<a name='707'>
         ,I_ACLWDNT=grid%i_aclwdnt  ,I_ACLWDNTC=grid%i_aclwdntc      &amp;<a name='708'>
         ,I_ACLWUPB=grid%i_aclwupb  ,I_ACLWUPBC=grid%i_aclwupbc      &amp;<a name='709'>
         ,I_ACLWDNB=grid%i_aclwdnb  ,I_ACLWDNBC=grid%i_aclwdnbc      &amp;<a name='710'>
      <font color=#447700>! Selection flag <a name='711'></font>
                ,DIAG_PRINT=config_flags%diag_print                  &amp;<a name='712'>
                ,BUCKET_MM=config_flags%bucket_mm                    &amp;<a name='713'>
                ,BUCKET_J =config_flags%bucket_J                     &amp;<a name='714'>
                ,MPHYSICS_OPT=config_flags%mp_physics                &amp;  <font color=#447700>!  gthompsn<a name='715'></font>
                ,GSFCGCE_HAIL=config_flags%gsfcgce_hail              &amp;  <font color=#447700>!  gthompsn<a name='716'></font>
                ,GSFCGCE_2ICE=config_flags%gsfcgce_2ice              &amp;  <font color=#447700>!  gthompsn<a name='717'></font>
                ,MPUSE_HAIL=config_flags%hail_opt                    &amp;  <font color=#447700>!  gthompsn<a name='718'></font>
                ,NSSL_ALPHAH=config_flags%nssl_alphah                &amp;  <font color=#447700>!  gthompsn<a name='719'></font>
                ,NSSL_ALPHAHL=config_flags%nssl_alphahl              &amp;  <font color=#447700>!  gthompsn<a name='720'></font>
                ,NSSL_CNOH=config_flags%nssl_cnoh                    &amp;  <font color=#447700>!  gthompsn<a name='721'></font>
                ,NSSL_CNOHL=config_flags%nssl_cnohl                  &amp;  <font color=#447700>!  gthompsn<a name='722'></font>
                ,NSSL_RHO_QH=config_flags%nssl_rho_qh                &amp;  <font color=#447700>!  gthompsn<a name='723'></font>
                ,NSSL_RHO_QHL=config_flags%nssl_rho_qhl              &amp;  <font color=#447700>!  gthompsn<a name='724'></font>
                ,SNOWNCV=grid%snowncv, SNOW_ACC_NC=grid%snow_acc_nc  &amp;    <a name='725'>
                ,PREC_ACC_C=grid%prec_acc_c                          &amp;<a name='726'>
                ,PREC_ACC_NC=grid%prec_acc_nc                        &amp;<a name='727'>
                ,PREC_ACC_DT=config_flags%prec_acc_dt                &amp;<a name='728'>
                ,CURR_SECS2=curr_secs2                               &amp;<a name='729'>
                ,NWP_DIAGNOSTICS=config_flags%nwp_diagnostics        &amp;<a name='730'>
                ,DIAGFLAG=diag_flag                                  &amp;<a name='731'>
                ,HISTORY_INTERVAL=grid%history_interval              &amp;<a name='732'>
                ,ITIMESTEP=grid%itimestep                            &amp;<a name='733'>
                ,U10=grid%u10,V10=grid%v10,W=grid%w_2                &amp;<a name='734'>
                ,WSPD10MAX=grid%wspd10max                            &amp;<a name='735'>
                ,UP_HELI_MAX=grid%up_heli_max                        &amp;<a name='736'>
                ,W_UP_MAX=grid%w_up_max,W_DN_MAX=grid%w_dn_max       &amp;<a name='737'>
                ,ZNW=grid%znw,W_COLMEAN=grid%w_colmean               &amp;<a name='738'>
                ,NUMCOLPTS=grid%numcolpts,W_MEAN=grid%w_mean         &amp;<a name='739'>
                ,GRPL_MAX=grid%grpl_max,GRPL_COLINT=grid%grpl_colint &amp;<a name='740'>
                ,REFD_MAX=grid%refd_max                              &amp;<a name='741'>
                ,refl_10cm=grid%refl_10cm                            &amp;<a name='742'>
                ,HAIL_MAXK1=grid%hail_maxk1,HAIL_MAX2D=grid%hail_max2d &amp;  <font color=#447700>!  gthompsn<a name='743'></font>
                ,QG_CURR=moist(ims,kms,jms,P_QG)                     &amp;<a name='744'>
                ,RHO=grid%rho,PH=grid%ph_2,PHB=grid%phb,G=g          &amp;<a name='745'>
      <font color=#447700>! Dimension arguments<a name='746'></font>
                ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde   &amp;<a name='747'>
                ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme   &amp;<a name='748'>
                ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe   &amp;<a name='749'>
                ,I_START=grid%i_start,I_END=min(grid%i_end, ide-1)   &amp;<a name='750'>
                ,J_START=grid%j_start,J_END=min(grid%j_end, jde-1)   &amp;<a name='751'>
                ,KTS=k_start, KTE=min(k_end,kde-1)                   &amp;<a name='752'>
                ,NUM_TILES=grid%num_tiles                            &amp;<a name='753'>
                                                                    )<a name='754'>
<a name='755'>
<a name='756'>
<a name='757'>
   END SELECT mp_select<a name='758'>
<a name='759'>
<a name='760'>
      <font color=#447700>!  Climate-oriented diagnostic quantities.<a name='761'></font>
<a name='762'>
      CLIMATE_DIAGS : IF ( config_flags%output_diagnostics == 1 ) THEN<a name='763'>
<a name='764'>
         IF ( ( config_flags%auxhist3_interval == 0 ) ) THEN<a name='765'>
            WRITE (diag_message , * ) &amp;<a name='766'>
            "CLWRF: ERROR -- error -- ERROR -- error : NO 'auxhist3_interval' has been defined in 'namelist.input'"<a name='767'>
            CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_629"> ( diag_message )<a name='768'>
         END IF<a name='769'>
<a name='770'>
         CALL wrf_debug ( 100 , '--&gt; CALL DIAGNOSTICS PACKAGE: CLIMATE DIAGNOSTICS' )<a name='771'>
<a name='772'>
         CALL <A href='../../html_code/phys/module_diag_cl.F.html#CLWRF_OUTPUT_CALC'>clwrf_output_calc</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CLWRF_OUTPUT_CALC_1">(                                           &amp;<a name='773'>
                     is_restart=config_flags%restart                       &amp;<a name='774'>
                    ,clwrfH=config_flags%auxhist3_interval                 &amp;<a name='775'>
                    ,T2=grid%t2, Q2=grid%q2, U10=grid%u10, V10=grid%v10    &amp;<a name='776'>
                    ,SKINTEMP=grid%tsk                                     &amp;<a name='777'>
                    ,T2CLMIN=grid%t2min, T2CLMAX=grid%t2max                &amp;<a name='778'>
                    ,TT2CLMIN=grid%tt2min, TT2CLMAX=grid%tt2max            &amp;<a name='779'>
                    ,T2CLMEAN=grid%t2mean, T2CLSTD=grid%t2std              &amp;<a name='780'>
                    ,Q2CLMIN=grid%q2min, Q2CLMAX=grid%q2max                &amp;<a name='781'>
                    ,TQ2CLMIN=grid%tq2min, TQ2CLMAX=grid%tq2max            &amp;<a name='782'>
                    ,Q2CLMEAN=grid%q2mean, Q2CLSTD=grid%q2std              &amp;<a name='783'>
                    ,U10CLMAX=grid%u10max, V10CLMAX=grid%v10max            &amp;<a name='784'>
                    ,SPDUV10CLMAX=grid%spduv10max                          &amp;<a name='785'>
                    ,TSPDUV10CLMAX=grid%tspduv10max                        &amp;<a name='786'>
                    ,U10CLMEAN=grid%u10mean, V10CLMEAN=grid%v10mean        &amp;<a name='787'>
                    ,SPDUV10CLMEAN=grid%spduv10mean                        &amp;<a name='788'>
                    ,U10CLSTD=grid%u10std, V10CLSTD=grid%v10std            &amp;<a name='789'>
                    ,SPDUV10CLSTD=grid%spduv10std                          &amp;<a name='790'>
                    ,RAINCCLMAX=grid%raincvmax                             &amp;<a name='791'>
                    ,RAINNCCLMAX=grid%rainncvmax                           &amp;<a name='792'>
                    ,TRAINCCLMAX=grid%traincvmax                           &amp;<a name='793'>
                    ,TRAINNCCLMAX=grid%trainncvmax                         &amp;<a name='794'>
                    ,RAINCCLMEAN=grid%raincvmean                           &amp;<a name='795'>
                    ,RAINNCCLMEAN=grid%rainncvmean                         &amp;<a name='796'>
                    ,RAINCCLSTD=grid%raincvstd                             &amp;<a name='797'>
                    ,RAINNCCLSTD=grid%rainncvstd                           &amp;<a name='798'>
                    ,SKINTEMPCLMIN=grid%skintempmin                        &amp;<a name='799'>
                    ,SKINTEMPCLMAX=grid%skintempmax                        &amp;<a name='800'>
                    ,TSKINTEMPCLMIN=grid%tskintempmin                      &amp;<a name='801'>
                    ,TSKINTEMPCLMAX=grid%tskintempmax                      &amp;<a name='802'>
                    ,SKINTEMPCLMEAN=grid%skintempmean                      &amp;<a name='803'>
                    ,SKINTEMPCLSTD=grid%skintempstd                        &amp;<a name='804'>
                    ,RAINCV=grid%raincv    ,RAINNCV=grid%rainncv           &amp;<a name='805'>
                    ,DT=grid%dt                                            &amp;<a name='806'>
                    ,XTIME=grid%xtime,CURR_SECS2=curr_secs2                &amp;<a name='807'>
                    ,NSTEPS=grid%nsteps                                    &amp;<a name='808'>
         <font color=#447700>! Dimension arguments<a name='809'></font>
                    ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde     &amp;<a name='810'>
                    ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme     &amp;<a name='811'>
                    ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe     &amp;<a name='812'>
                    ,I_START=grid%i_start,I_END=min(grid%i_end, ide-1)     &amp;<a name='813'>
                    ,J_START=grid%j_start,J_END=min(grid%j_end, jde-1)     &amp;<a name='814'>
                    ,KTS=k_start, KTE=k_end                                &amp;<a name='815'>
                    ,NUM_TILES=grid%num_tiles                              &amp;<a name='816'>
                                                                   )<a name='817'>
      END IF CLIMATE_DIAGS<a name='818'>
<a name='819'>
<a name='820'>
<a name='821'>
<a name='822'>
<a name='823'>
      <font color=#447700>!  Pressure level diagnostics.<a name='824'></font>
<a name='825'>
<a name='826'>
      PL_DIAGNOSTICS : IF ( config_flags%p_lev_diags .NE. SKIP_PRESS_DIAGS ) THEN<a name='827'>
<a name='828'>
      <font color=#447700>!  Process the diags if this is the correct time step OR<a name='829'></font>
      <font color=#447700>!  if this is an adaptive timestep forecast.<a name='830'></font>
<a name='831'>
         TIME_TO_DO_PL_DIAGS : IF ( ( ( MOD(NINT(curr_secs2+grid%dt),NINT(config_flags%p_lev_interval)) .EQ. 0 ) ) .OR. &amp;<a name='832'>
               ( config_flags%use_adaptive_time_step ) ) THEN<a name='833'>
<a name='834'>
            <font color=#447700>!$OMP PARALLEL DO   &amp;<a name='835'></font>
            <font color=#447700>!$OMP PRIVATE ( ij )<a name='836'></font>
            DO ij = 1 , grid%num_tiles<a name='837'>
<a name='838'>
               CALL wrf_debug ( 100 , '--&gt; CALL DIAGNOSTICS PACKAGE: PRESSURE LEVEL DIAGNOSTICS' )<a name='839'>
<a name='840'>
               CALL <A href='../../html_code/phys/module_diag_pld.F.html#PLD'>pld</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PLD_2"> (                                                   &amp;<a name='841'>
               <font color=#447700>!  Input data for computing<a name='842'></font>
                       U=grid%u_2                                           &amp;<a name='843'>
                      ,V=grid%v_2                                           &amp;<a name='844'>
                      ,W=grid%w_2                                           &amp;<a name='845'>
                      ,t=grid%t_2                                           &amp;<a name='846'>
                      ,qv=moist(:,:,:,P_QV)                                 &amp;<a name='847'>
                      ,zp=grid%ph_2                                         &amp;<a name='848'>
                      ,zb=grid%phb                                          &amp;<a name='849'>
                      ,pp=grid%p                                            &amp;<a name='850'>
                      ,pb=grid%pb                                           &amp;<a name='851'>
                      ,p=grid%p_hyd                                         &amp;<a name='852'>
                      ,pw=grid%p_hyd_w                                      &amp;<a name='853'>
               <font color=#447700>!  Map factors, coriolis for diags<a name='854'></font>
                      ,msfux=grid%msfux                                     &amp;<a name='855'>
                      ,msfuy=grid%msfuy                                     &amp;<a name='856'>
                      ,msfvx=grid%msfvx                                     &amp;<a name='857'>
                      ,msfvy=grid%msfvy                                     &amp;<a name='858'>
                      ,msftx=grid%msftx                                     &amp;<a name='859'>
                      ,msfty=grid%msfty                                     &amp;<a name='860'>
                      ,f=grid%f                                             &amp;<a name='861'>
                      ,e=grid%e                                             &amp;<a name='862'>
               <font color=#447700>!  Namelist info<a name='863'></font>
                      ,use_tot_or_hyd_p=config_flags%use_tot_or_hyd_p       &amp;<a name='864'>
                      ,extrap_below_grnd=config_flags%extrap_below_grnd     &amp;<a name='865'>
                      ,missing=config_flags%p_lev_missing                   &amp;<a name='866'>
               <font color=#447700>!  The diagnostics, mostly output variables<a name='867'></font>
                      ,num_press_levels=config_flags%num_press_levels       &amp;<a name='868'>
                      ,max_press_levels=max_plevs                           &amp;<a name='869'>
                      ,press_levels=model_config_rec%press_levels           &amp;<a name='870'>
                      ,p_pl  = grid%p_pl                                    &amp;<a name='871'>
                      ,u_pl  = grid%u_pl                                    &amp;<a name='872'>
                      ,v_pl  = grid%v_pl                                    &amp;<a name='873'>
                      ,t_pl  = grid%t_pl                                    &amp;<a name='874'>
                      ,rh_pl = grid%rh_pl                                   &amp;<a name='875'>
                      ,ght_pl= grid%ght_pl                                  &amp;<a name='876'>
                      ,s_pl  = grid%s_pl                                    &amp;<a name='877'>
                      ,td_pl = grid%td_pl                                   &amp;<a name='878'>
                      ,q_pl = grid%q_pl                                     &amp;<a name='879'>
               <font color=#447700>!  Dimension arguments<a name='880'></font>
                      ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde    &amp;<a name='881'>
                      ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme    &amp;<a name='882'>
                      ,ITS=grid%i_start(ij),ITE=grid%i_end(ij)              &amp;<a name='883'>
                      ,JTS=grid%j_start(ij),JTE=grid%j_end(ij)              &amp;<a name='884'>
                      ,KTS=k_start,KTE=k_end+1                              )<a name='885'>
            END DO<a name='886'>
            <font color=#447700>!$OMP END PARALLEL DO<a name='887'></font>
         END IF TIME_TO_DO_PL_DIAGS<a name='888'>
      END IF PL_DIAGNOSTICS<a name='889'>
<a name='890'>
<a name='891'>
<a name='892'>
<a name='893'>
<a name='894'>
      <font color=#447700>!  Height level and AGL diagnostics.<a name='895'></font>
<a name='896'>
<a name='897'>
      ZL_DIAGNOSTICS : IF ( config_flags%z_lev_diags .NE. SKIP_Z_DIAGS ) THEN<a name='898'>
<a name='899'>
      <font color=#447700>!  Process the diags if this is the correct time step OR<a name='900'></font>
      <font color=#447700>!  if this is an adaptive timestep forecast.<a name='901'></font>
<a name='902'>
         TIME_TO_DO_ZL_DIAGS : IF ( ( ( MOD(NINT(curr_secs2+grid%dt),NINT(config_flags%z_lev_interval)) .EQ. 0 ) ) .OR. &amp;<a name='903'>
               ( config_flags%use_adaptive_time_step ) ) THEN<a name='904'>
<a name='905'>
            <font color=#447700>!$OMP PARALLEL DO   &amp;<a name='906'></font>
            <font color=#447700>!$OMP PRIVATE ( ij )<a name='907'></font>
            DO ij = 1 , grid%num_tiles<a name='908'>
<a name='909'>
               CALL wrf_debug ( 100 , '--&gt; CALL DIAGNOSTICS PACKAGE: HEIGHT LEVEL AND AGL DIAGNOSTICS' )<a name='910'>
<a name='911'>
               CALL <A href='../../html_code/phys/module_diag_zld.F.html#ZLD'>zld</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ZLD_2"> (                                                   &amp;<a name='912'>
               <font color=#447700>!  Input data for computing<a name='913'></font>
                       U=grid%u_2                                           &amp;<a name='914'>
                      ,V=grid%v_2                                           &amp;<a name='915'>
                      ,W=grid%w_2                                           &amp;<a name='916'>
                      ,t=grid%t_2                                           &amp;<a name='917'>
                      ,qv=moist(:,:,:,P_QV)                                 &amp;<a name='918'>
                      ,zp=grid%ph_2                                         &amp;<a name='919'>
                      ,zb=grid%phb                                          &amp;<a name='920'>
                      ,pp=grid%p                                            &amp;<a name='921'>
                      ,pb=grid%pb                                           &amp;<a name='922'>
                      ,p=grid%p_hyd                                         &amp;<a name='923'>
                      ,pw=grid%p_hyd_w                                      &amp;<a name='924'>
               <font color=#447700>!  Map factors, coriolis for diags<a name='925'></font>
                      ,msfux=grid%msfux                                     &amp;<a name='926'>
                      ,msfuy=grid%msfuy                                     &amp;<a name='927'>
                      ,msfvx=grid%msfvx                                     &amp;<a name='928'>
                      ,msfvy=grid%msfvy                                     &amp;<a name='929'>
                      ,msftx=grid%msftx                                     &amp;<a name='930'>
                      ,msfty=grid%msfty                                     &amp;<a name='931'>
                      ,f=grid%f                                             &amp;<a name='932'>
                      ,e=grid%e                                             &amp;<a name='933'>
                      ,ht=grid%ht                                           &amp;<a name='934'>
               <font color=#447700>!  Namelist info<a name='935'></font>
                      ,use_tot_or_hyd_p=config_flags%use_tot_or_hyd_p       &amp;<a name='936'>
                      ,extrap_below_grnd=config_flags%extrap_below_grnd     &amp;<a name='937'>
                      ,missing=config_flags%z_lev_missing                   &amp;<a name='938'>
               <font color=#447700>!  The diagnostics, mostly output variables<a name='939'></font>
                      ,num_z_levels=config_flags%num_z_levels               &amp;<a name='940'>
                      ,max_z_levels=max_zlevs                               &amp;<a name='941'>
                      ,z_levels=model_config_rec%z_levels                   &amp;<a name='942'>
                      ,z_zl  = grid%z_zl                                    &amp;<a name='943'>
                      ,u_zl  = grid%u_zl                                    &amp;<a name='944'>
                      ,v_zl  = grid%v_zl                                    &amp;<a name='945'>
                      ,t_zl  = grid%t_zl                                    &amp;<a name='946'>
                      ,rh_zl = grid%rh_zl                                   &amp;<a name='947'>
                      ,ght_zl= grid%ght_zl                                  &amp;<a name='948'>
                      ,s_zl  = grid%s_zl                                    &amp;<a name='949'>
                      ,td_zl = grid%td_zl                                   &amp;<a name='950'>
                      ,q_zl = grid%q_zl                                     &amp;<a name='951'>
               <font color=#447700>!  Dimension arguments<a name='952'></font>
                      ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde    &amp;<a name='953'>
                      ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme    &amp;<a name='954'>
                      ,ITS=grid%i_start(ij),ITE=grid%i_end(ij)              &amp;<a name='955'>
                      ,JTS=grid%j_start(ij),JTE=grid%j_end(ij)              &amp;<a name='956'>
                      ,KTS=k_start,KTE=k_end+1                              )<a name='957'>
            END DO<a name='958'>
            <font color=#447700>!$OMP END PARALLEL DO<a name='959'></font>
         END IF TIME_TO_DO_ZL_DIAGS<a name='960'>
      END IF ZL_DIAGNOSTICS<a name='961'>
<a name='962'>
<a name='963'>
<a name='964'>
<a name='965'>
      <font color=#447700>!  AFWA diagnostic package.<a name='966'></font>
<a name='967'>
      AFWA_DIAGS : IF ( config_flags%afwa_diag_opt == 1 ) THEN<a name='968'>
<a name='969'>
         IF ( ( config_flags%history_interval == 0 ) ) THEN<a name='970'>
            WRITE (diag_message , * ) &amp;<a name='971'>
            "AFWA Diagnostics Error : No 'history_interval' defined in namelist"<a name='972'>
            CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_630"> ( diag_message )<a name='973'>
         END IF<a name='974'>
<a name='975'>
         <font color=#447700>!$OMP PARALLEL DO   &amp;<a name='976'></font>
         <font color=#447700>!$OMP PRIVATE ( ij )<a name='977'></font>
         DO ij = 1 , grid%num_tiles<a name='978'>
<a name='979'>
            CALL wrf_debug ( 100 , '--&gt; CALL DIAGNOSTICS PACKAGE: AFWA DIAGNOSTICS' )<a name='980'>
<a name='981'>
            CALL <A href='../../html_code/phys/module_diag_afwa.F.html#AFWA_DIAGNOSTICS_DRIVER'>afwa_diagnostics_driver</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="AFWA_DIAGNOSTICS_DRIVER_1"> (   grid , config_flags              &amp;<a name='982'>
                         ,moist                                               &amp;<a name='983'>
                         ,scalar                                              &amp;<a name='984'>
                         ,chem                                                &amp;<a name='985'>
                         ,th_phy , pi_phy , p_phy                             &amp;<a name='986'>
                         ,grid%u_phy , grid%v_phy                             &amp;<a name='987'>
                         ,dz8w , p8w , t8w , rho_phy, grid%rho                &amp;<a name='988'>
                         ,ids, ide, jds, jde, kds, kde                        &amp;<a name='989'>
                         ,ims, ime, jms, jme, kms, kme                        &amp;<a name='990'>
                         ,ips, ipe, jps, jpe, kps, kpe                        &amp;<a name='991'>
                         ,ITS=grid%i_start(ij),ITE=grid%i_end(ij)             &amp;<a name='992'>
                         ,JTS=grid%j_start(ij),JTE=grid%j_end(ij)             &amp;<a name='993'>
                         ,K_START=k_start,K_END=k_end                         )<a name='994'>
<a name='995'>
            END DO<a name='996'>
            <font color=#447700>!$OMP END PARALLEL DO<a name='997'></font>
      ENDIF AFWA_DIAGS<a name='998'>
<a name='999'>
<a name='1000'>
<a name='1001'>
<a name='1002'>
      <font color=#447700>!  RASM Climate Diagnostics - mean output<a name='1003'></font>
<a name='1004'>
      RASM_DIAGS_MEAN : IF ( config_flags%mean_diag == 1 ) THEN<a name='1005'>
<a name='1006'>
         <font color=#447700>!IF ( ( config_flags%auxhist3_interval == 0 ) ) THEN<a name='1007'></font>
         <font color=#447700>!   WRITE (diag_message , * ) &amp;<a name='1008'></font>
         <font color=#447700>!   "CLWRF: ERROR -- error -- ERROR -- error : NO 'auxhist3_interval' has been defined in 'namelist.input'"<a name='1009'></font>
         <font color=#447700>!   CALL wrf_error_fatal ( diag_message )<a name='1010'></font>
         <font color=#447700>!END IF<a name='1011'></font>
<a name='1012'>
         CALL wrf_debug ( 100 , '--&gt; CALL DIAGNOSTICS PACKAGE: RASM DIAGNOSTICS - MEAN' )<a name='1013'>
<a name='1014'>
         CALL <A href='../../html_code/frame/module_domain.F.html#DOMAIN_CLOCK_GET'>domain_clock_get</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DOMAIN_CLOCK_GET_38"> ( grid, current_time=currentTime)<a name='1015'>
<a name='1016'>
         CALL <A href='../../html_code/phys/module_diag_rasm.F.html#MEAN_OUTPUT_CALC'>mean_output_calc</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MEAN_OUTPUT_CALC_1">(                                               &amp;<a name='1017'>
                        is_restart=config_flags%restart                       &amp;<a name='1018'>
                       ,CURRENTTIME=currentTime                               &amp;<a name='1019'>
                       ,stats_interval=config_flags%mean_interval             &amp;<a name='1020'>
                       ,output_freq=config_flags%mean_freq                    &amp;<a name='1021'>
                       ,run_days=config_flags%run_days                        &amp;<a name='1022'>
                       ,DT=grid%dt, XTIME=grid%xtime                          &amp;<a name='1023'>
                       ,PSFC=grid%psfc, PSFC_MEAN=grid%psfc_mean              &amp;<a name='1024'>
                       ,TSK=grid%tsk, TSK_MEAN=grid%tsk_mean                  &amp;<a name='1025'>
                       ,PMSL_MEAN=grid%pmsl_mean                              &amp;<a name='1026'>
                       ,T2=grid%t2, T2_MEAN=grid%t2_mean                      &amp;<a name='1027'>
                       ,T=grid%t_2, P=grid%p, PB=grid%pb                      &amp;<a name='1028'>
                       ,MOIST=grid%moist(:,:,:,P_QV), HT=grid%ht              &amp;<a name='1029'>
                       ,TH2=grid%th2, TH2_MEAN=grid%th2_mean                  &amp;<a name='1030'>
                       ,Q2=grid%q2, Q2_MEAN=grid%q2_mean                      &amp;<a name='1031'>
                       ,U10=grid%u10, U10_MEAN=grid%u10_mean                  &amp;<a name='1032'>
                       ,V10=grid%v10, V10_MEAN=grid%v10_mean                  &amp;           <a name='1033'>
                       ,HFX=grid%hfx, HFX_MEAN=grid%hfx_mean                  &amp;<a name='1034'>
                       ,LH=grid%lh, LH_MEAN=grid%lh_mean                      &amp;<a name='1035'>
                       ,SWDNB=grid%swdnb, SWDNB_MEAN=grid%swdnb_mean          &amp;<a name='1036'>
                       ,GLW=grid%glw , GLW_MEAN=grid%glw_mean                 &amp;<a name='1037'>
                       ,LWUPB=grid%lwupb, LWUPB_MEAN=grid%lwupb_mean          &amp;<a name='1038'>
                       ,SWUPB=grid%swupb, SWUPB_MEAN=grid%swupb_mean          &amp;<a name='1039'>
                       ,SWUPT=grid%swupt, SWUPT_MEAN=grid%swupt_mean          &amp;<a name='1040'>
                       ,SWDNT=grid%swdnt, SWDNT_MEAN=grid%swdnt_mean          &amp;<a name='1041'>
                       ,LWUPT=grid%lwupt, LWUPT_MEAN=grid%lwupt_mean          &amp;<a name='1042'>
                       ,LWDNT=grid%lwdnt, LWDNT_MEAN=grid%lwdnt_mean          &amp;<a name='1043'>
                       ,AVGOUTALARM=grid%alarms(AUXHIST5_ALARM)               &amp;<a name='1044'>
                       ,AVGOUTDATESTR=grid%OUTDATE_MEAN                       &amp;<a name='1045'>
                       ,NSTEPS=grid%NSTEPS_MEAN                               &amp;<a name='1046'>
         <font color=#447700>! Dimension arguments<a name='1047'></font>
                       ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde     &amp;<a name='1048'>
                       ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme     &amp;<a name='1049'>
                       ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe     &amp;<a name='1050'>
                       ,I_START=grid%i_start,I_END=min(grid%i_end, ide-1)     &amp;<a name='1051'>
                       ,J_START=grid%j_start,J_END=min(grid%j_end, jde-1)     &amp;<a name='1052'>
                       ,NUM_TILES=grid%num_tiles                              &amp;<a name='1053'>
                                                                      )<a name='1054'>
      END IF RASM_DIAGS_MEAN<a name='1055'>
<a name='1056'>
<a name='1057'>
<a name='1058'>
<a name='1059'>
      <font color=#447700>!  RASM Climate Diagnostics - diurnal output<a name='1060'></font>
<a name='1061'>
      RASM_DIAGS_DIURNAL : IF ( config_flags%diurnal_diag == 1 ) THEN<a name='1062'>
<a name='1063'>
         <font color=#447700>!IF ( ( config_flags%auxhist3_interval == 0 ) ) THEN<a name='1064'></font>
         <font color=#447700>!   WRITE (diag_message , * ) &amp;<a name='1065'></font>
         <font color=#447700>!   "CLWRF: ERROR -- error -- ERROR -- error : NO 'auxhist3_interval' has been defined in 'namelist.input'"<a name='1066'></font>
         <font color=#447700>!   CALL wrf_error_fatal ( diag_message )<a name='1067'></font>
         <font color=#447700>!END IF<a name='1068'></font>
<a name='1069'>
         CALL wrf_debug ( 100 , '--&gt; CALL DIAGNOSTICS PACKAGE: RASM DIAGNOSTICS - DIURNAL' )<a name='1070'>
<a name='1071'>
         CALL <A href='../../html_code/frame/module_domain.F.html#DOMAIN_CLOCK_GET'>domain_clock_get</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DOMAIN_CLOCK_GET_39"> ( grid, current_time=currentTime)<a name='1072'>
<a name='1073'>
         CALL <A href='../../html_code/phys/module_diag_rasm.F.html#DIURNALCYCLE_OUTPUT_CALC'>diurnalcycle_output_calc</A><A href='../../html_code/phys/module_diagnostics_driver.F.html#DIAGNOSTICS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DIURNALCYCLE_OUTPUT_CALC_1">(                                       &amp;<a name='1074'>
            is_restart=config_flags%restart                                   &amp;<a name='1075'>
           ,CURRENTTIME=currentTime                                           &amp;<a name='1076'>
           ,DT=grid%dt, XTIME=grid%xtime                                      &amp;<a name='1077'>
           ,PSFC=grid%psfc, PSFC_DTMP=grid%psfc_dtmp                          &amp;<a name='1078'>
           ,TSK=grid%tsk, TSK_DTMP=grid%tsk_dtmp                              &amp;<a name='1079'>
           ,T2=grid%t2, T2_DTMP=grid%t2_dtmp                                  &amp;<a name='1080'>
           ,T=grid%t_2, P=grid%p, PB=grid%pb, MOIST=grid%moist(:,:,:,P_QV)    &amp;<a name='1081'>
           ,TH2=grid%th2, TH2_DTMP=grid%th2_dtmp                              &amp;<a name='1082'>
           ,Q2=grid%q2, Q2_DTMP=grid%q2_dtmp                                  &amp;<a name='1083'>
           ,U10=grid%u10, U10_DTMP=grid%u10_dtmp                              &amp;<a name='1084'>
           ,V10=grid%v10, V10_DTMP=grid%v10_dtmp                              &amp;<a name='1085'>
           ,HFX=grid%hfx, HFX_DTMP=grid%hfx_dtmp                              &amp;<a name='1086'>
           ,LH=grid%lh, LH_DTMP=grid%lh_dtmp                                  &amp;<a name='1087'>
           ,SWDNB=grid%swdnb, SWDNB_DTMP=grid%swdnb_dtmp                      &amp;<a name='1088'>
           ,GLW=grid%glw, GLW_DTMP=grid%glw_dtmp                              &amp;<a name='1089'>
           ,LWUPB=grid%lwupb, LWUPB_DTMP=grid%lwupb_dtmp                      &amp;<a name='1090'>
           ,SWUPB=grid%swupb, SWUPB_DTMP=grid%swupb_dtmp                      &amp;<a name='1091'>
           ,SWUPT=grid%swupt, SWUPT_DTMP=grid%swupt_dtmp                      &amp;<a name='1092'>
           ,SWDNT=grid%swdnt, SWDNT_DTMP=grid%swdnt_dtmp                      &amp;<a name='1093'>
           ,LWUPT=grid%lwupt, LWUPT_DTMP=grid%lwupt_dtmp                      &amp;<a name='1094'>
           ,LWDNT=grid%lwdnt, LWDNT_DTMP=grid%lwdnt_dtmp                      &amp;<a name='1095'>
           ,AVGOUTALARM=grid%alarms(AUXHIST6_ALARM)                           &amp;<a name='1096'>
           ,DIURNOUTDATESTR=grid%OUTDATE_DIURN                                &amp;<a name='1097'>
           ,AVG_NSTEPS=grid%NSTEPSMEAN_DIURN                                  &amp;<a name='1098'>
           ,DIURNAL_NSTEPS=grid%NSTEPS_DIURN                                  &amp;<a name='1099'>
           ,PSFC_DIURN=grid%PSFC_DIURN                                        &amp;<a name='1100'>
           ,TSK_DIURN=grid%TSK_DIURN, T2_DIURN=grid%T2_DIURN                  &amp;<a name='1101'>
           ,TH2_DIURN=grid%TH2_DIURN, Q2_DIURN=grid%Q2_DIURN                  &amp;<a name='1102'>
           ,U10_DIURN=grid%U10_DIURN, V10_DIURN=grid%V10_DIURN                &amp;<a name='1103'>
           ,HFX_DIURN=grid%HFX_DIURN, LH_DIURN=grid%LH_DIURN                  &amp;<a name='1104'>
           ,SWDNB_DIURN=grid%SWDNB_DIURN, GLW_DIURN=grid%GLW_DIURN            &amp;<a name='1105'>
           ,LWUPB_DIURN=grid%LWUPB_DIURN, SWUPB_DIURN=grid%SWUPB_DIURN        &amp;<a name='1106'>
           ,SWUPT_DIURN=grid%SWUPT_DIURN, SWDNT_DIURN=grid%SWDNT_DIURN        &amp;<a name='1107'>
           ,LWUPT_DIURN=grid%LWUPT_DIURN, LWDNT_DIURN=grid%LWDNT_DIURN        &amp;<a name='1108'>
         <font color=#447700>! Dimension arguments<a name='1109'></font>
           ,IDS=ids, IDE=ide, JDS=jds, JDE=jde, KDS=kds, KDE=kde              &amp;<a name='1110'>
           ,IMS=ims, IME=ime, JMS=jms, JME=jme, KMS=kms, KME=kme              &amp; <a name='1111'>
           ,IPS=ips, IPE=ipe, JPS=jps, JPE=jpe, KPS=kps, KPE=kpe              &amp;         <a name='1112'>
           ,I_START=grid%i_start, I_END=min(grid%i_end, ide-1)                &amp;<a name='1113'>
           ,J_START=grid%j_start, J_END=min(grid%j_end, jde-1)                &amp;<a name='1114'>
           ,NUM_TILES=grid%num_tiles                                          &amp;<a name='1115'>
                                                                   )<a name='1116'>
      END IF RASM_DIAGS_DIURNAL<a name='1117'>
<a name='1118'>
<a name='1119'>
<a name='1120'>
<a name='1121'>
   END SUBROUTINE diagnostics_driver<a name='1122'>
<a name='1123'>
END MODULE module_diagnostics_driver<a name='1124'>
#endif<a name='1125'>
</pre></body></html>