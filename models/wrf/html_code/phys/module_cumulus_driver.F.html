<HTML> <BODY BGCOLOR=#ddddee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!WRF:MEDIATION_LAYER:PHYSICS<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<a name='4'>
<A NAME='MODULE_CUMULUS_DRIVER'><A href='../../html_code/phys/module_cumulus_driver.F.html#MODULE_CUMULUS_DRIVER' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='5'>
<font color=#993300>MODULE </font><font color=#cc0000>module_cumulus_driver</font> <A href='../../call_to/MODULE_CUMULUS_DRIVER.html' TARGET='index'>2</A><a name='6'>
CONTAINS<a name='7'>
<A NAME='CUMULUS_DRIVER'><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='8'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>cumulus_driver</font>(grid                                     &amp; <A href='../../call_to/CUMULUS_DRIVER.html' TARGET='index'>2</A>,<A href='../../call_from/CUMULUS_DRIVER.html' TARGET='index'>61</A><a name='9'>
                 <font color=#447700>! Order dependent args for domain, mem, and tile dims<a name='10'></font>
                     ,ids,ide, jds,jde, kds,kde                       &amp;<a name='11'>
                     ,ims,ime, jms,jme, kms,kme                       &amp;<a name='12'>
                     ,ips,ipe, jps,jpe, kps,kpe                       &amp;<a name='13'>
                     ,i_start,i_end,j_start,j_end,kts,kte,num_tiles   &amp;<a name='14'>
                 <font color=#447700>! Order independent args (use VAR= in call)<a name='15'></font>
                 <font color=#447700>! --Prognostic<a name='16'></font>
                     ,u,v,th,t,w                                      &amp;<a name='17'>
                     ,p,pi,rho                                        &amp;<a name='18'>
                 <font color=#447700>! --Other arguments<a name='19'></font>
                     ,itimestep,dt,dx,cudt,curr_secs,adapt_step_flag  &amp;<a name='20'>
                     ,cudtacttime                                     &amp; <a name='21'>
                     ,rainc,raincv,pratec,nca                         &amp;<a name='22'>
                     ,cldfra_dp,cldfra_sh,w_up                        &amp; <font color=#447700>!ckay for subgrid cloud<a name='23'></font>
                     ,udr_kf,ddr_kf,uer_kf,der_kf,timec_kf,kf_edrates &amp; <font color=#447700>!kf_edrates<a name='24'></font>
                     ,QC_CU,QI_CU                                     &amp;<a name='25'>
                     ,z,z_at_w,dz8w,mavail,pblh,p8w,psfc,tsk          &amp;<a name='26'>
                     ,tke_pbl, ust                                    &amp;<a name='27'>
                     ,ZOL,WSTAR                                       &amp;  <font color=#447700>!ckay<a name='28'></font>
                     ,forcet,forceq,w0avg,stepcu,gsw                  &amp;<a name='29'>
                     ,cldefi,lowlyr,xland,cu_act_flag,warm_rain       &amp;<a name='30'>
                     ,hfx,qfx,cldfra,cldfra_mp_all,tpert2d            &amp;<a name='31'>
                     ,htop,hbot,kpbl,ht                               &amp;<a name='32'>
                     ,ensdim,maxiens,maxens,maxens2,maxens3           &amp;<a name='33'>
                     ,shall                                           &amp; <font color=#447700>!CuP, wig 18-Sep-2006<a name='34'></font>
#if (EM_CORE == 1)<a name='35'>
                     <font color=#447700>!BSINGH - For WRFCuP Scheme<a name='36'></font>
                     ,akpbl, br,regime,t2,q2                            &amp; <font color=#447700>!CuP, wig 3-Aug-2006<a name='37'></font>
                     ,slopeSfc, slopeEZ, sigmaSfc, sigmaEZ            &amp; <font color=#447700>!CuP, wig 7-Aug-2006<a name='38'></font>
                     ,cupflag, cldfra_cup, cldfratend_cup             &amp; <font color=#447700>!CuP, wig 18-Sep-2006<a name='39'></font>
                     ,taucloud, tactive                               &amp; <font color=#447700>!CuP, wig 18-Sep-2006<a name='40'></font>
                     ,activeFrac                                      &amp; <font color=#447700>!CuP, lkb 4-May-2010<a name='41'></font>
                     ,tstar, lnterms, lnint                           &amp; <font color=#447700>!CuP, wig 4-Oct-2006<a name='42'></font>
                     ,numBins, thBinSize, rBinSize                    &amp; <font color=#447700>!CUP, lkb 4-Nov-2009<a name='43'></font>
                     ,minDeepFreq, minShallowFreq                     &amp; <font color=#447700>!CUP, lkb 4-Nov-2009<a name='44'></font>
                     ,wCloudBase                                      &amp; <font color=#447700>!CuP, lkb 29-April-2010                <a name='45'></font>
                     ,wact_cup                                        &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='46'></font>
                     ,wulcl_cup                                       &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='47'></font>
                     ,wup_cup                                         &amp; <font color=#447700>!CuP, rce 15-mar-2013 !BSINGH (12/06/2013)<a name='48'></font>
                     ,qc_ic_cup                                       &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='49'></font>
                     ,qndrop_ic_cup                                   &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='50'></font>
                     ,qc_iu_cup                                       &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='51'></font>
                     ,fcvt_qc_to_pr_cup                               &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='52'></font>
                     ,fcvt_qc_to_qi_cup                               &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='53'></font>
                     ,fcvt_qi_to_pr_cup                               &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='54'></font>
                     ,mfup_cup                                        &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='55'></font>
                     ,mfup_ent_cup                                    &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='56'></font>
                     ,mfdn_cup                                        &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='57'></font>
                     ,mfdn_ent_cup                                    &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='58'></font>
                     ,updfra_cup                                      &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='59'></font>
                     ,tcloud_cup                                      &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='60'></font>
                     <font color=#447700>!BSINGH -ENDS<a name='61'></font>
#endif<a name='62'>
                     ,periodic_x,periodic_y                           &amp;<a name='63'>
                     ,is_CAMMGMP_used                                 &amp; <a name='64'>
                     ,evapcdp3d,icwmrdp3d,rprddp3d                    &amp; <font color=#447700>!Balwinder.Singh@pnnl.gov: Used for CAM's wet scavenging<a name='65'></font>
                 <font color=#447700>! Package selection variables<a name='66'></font>
                     ,cu_physics, bl_pbl_physics, sf_sfclay_physics   &amp;<a name='67'>
#if (EM_CORE == 1)<a name='68'>
                     <font color=#447700>!BSINGH - For WRFCuP Scheme<a name='69'></font>
                     ,shcu_aerosols_opt                               &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='70'></font>
                     ,chem_opt                                        &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='71'></font>
                     <font color=#447700>!BSINGH - ENDS<a name='72'></font>
#endif<a name='73'>
                 <font color=#447700>! Optional moisture tracers <a name='74'></font>
                     ,qv_curr, qc_curr, qr_curr                       &amp;<a name='75'>
                     ,qi_curr, qs_curr, qg_curr                       &amp; <a name='76'>
                     ,qv_prev, qc_prev, qr_prev                       &amp; <a name='77'>
                     ,qi_prev, qs_prev, qg_prev                       &amp;<a name='78'>
                 <font color=#447700>! Optional arguments for GD scheme<a name='79'></font>
                     ,apr_gr,apr_w,apr_mc,apr_st,apr_as,apr_capma     &amp;<a name='80'>
                     ,apr_capme,apr_capmi,edt_out,clos_choice         &amp;<a name='81'>
                     ,mass_flux,xf_ens,pr_ens,cugd_avedx,imomentum    &amp;<a name='82'>
                     ,ishallow,cugd_tten,cugd_qvten,cugd_qcten        &amp;<a name='83'>
                     ,cugd_ttens,cugd_qvtens                          &amp;<a name='84'>
                     ,gd_cloud,gd_cloud2                              &amp;<a name='85'>
                 <font color=#447700>! Optional output arguments for CAMZM scheme<a name='86'></font>
                     ,cape, zmmu, zmmd, zmdt, zmdq, dlf, rliq         &amp;<a name='87'>
                     ,pconvb, pconvt                                  &amp;<a name='88'>
                     ,evaptzm, fzsntzm, evsntzm, evapqzm, zmflxprc    &amp;<a name='89'>
                     ,zmflxsnw, zmntprpd, zmntsnpd, zmeiheat          &amp;<a name='90'>
                     ,cmfmc, cmfmcdzm, preccdzm, precz                &amp;<a name='91'>
                     ,zmmtu, zmmtv, zmupgu, zmupgd, zmvpgu, zmvpgd    &amp;<a name='92'>
                     ,zmicuu, zmicud, zmicvu, zmicvd, zmdice, zmdliq  &amp;<a name='93'>
                     ,dp3d, du3d, ed3d, eu3d, md3d, mu3d, dsubcld2d   &amp;<a name='94'>
                     ,ideep2d, jt2d, maxg2d, lengath2d                &amp;<a name='95'>
                     ,k22_shallow,kbcon_shallow,ktop_shallow,xmb_shallow &amp;<a name='96'>
                     ,ktop_deep &amp;<a name='97'>
                 <font color=#447700>! Optional arguments for SAS scheme<a name='98'></font>
                     ,pgcon,sas_mass_flux                             &amp;<a name='99'>
                     ,pert_sas,ens_random_seed                        &amp;<a name='100'>
                     ,ens_sasamp                                      &amp;<a name='101'>
                     ,shalconv,shal_pgcon                             &amp;<a name='102'>
                     ,HPBL2D,EVAP2D,HEAT2D                            &amp;     <font color=#447700>!Kwon for SAS2010 shallow convection<a name='103'></font>
                     ,DX2D, DYNMM                                     &amp; <font color=#447700>! For scale-aware SAS<a name='104'></font>
                     ,SCALEFUN,SCALEFUN1                              &amp; <font color=#447700>!    scale functions <a name='105'></font>
                     ,SIGMU,SIGMU1                                    &amp; <font color=#447700>!    updraft fraction<a name='106'></font>
<a name='107'>
                 <font color=#447700>! Optional arguments for NSAS scheme<a name='108'></font>
                     ,mp_physics                                      &amp;<a name='109'>
                 <font color=#447700>! Optional moisture and other tendencies<a name='110'></font>
                     ,rqvcuten,rqccuten,rqrcuten                      &amp;<a name='111'>
                     ,rqicuten,rqscuten,rqgcuten                      &amp;<a name='112'>
                     ,rqcncuten,rqincuten                             &amp;<a name='113'>
                     ,rqvblten,rqvften                                &amp;<a name='114'>
                     ,rucuten,rvcuten                                 &amp;<a name='115'>
                     ,rthcuten,rthraten,rthblten,rthften              &amp;<a name='116'>
                     ,mommix,store_rand                               &amp;<a name='117'>
<font color=#447700>! Optional variables for tiedtke scheme - add by ZCX&amp;YQW <a name='118'></font>
                     ,znu                                             &amp;<a name='119'>
                 <font color=#447700>! Optional moisture tracer flags <a name='120'></font>
                     ,f_qv,f_qc,f_qr                                  &amp;<a name='121'>
                     ,f_qi,f_qs,f_qg                                  &amp;<a name='122'>
                     ,CFU1,CFD1,DFU1,EFU1,DFD1,EFD1,f_flux            &amp;<a name='123'>
                 <font color=#447700>! Optional trigger function activation variable<a name='124'></font>
                     ,kfeta_trigger                                   &amp;<a name='125'>
                     ,nsas_dx_factor                                  &amp;<a name='126'>
#if ( WRF_DFI_RADAR == 1 )<a name='127'>
                 <font color=#447700>! Optional CAP suppress option      --- 3.2 CLEANUP TODO -- THESE SHOULD BE OPTIONAL, NOT #IF/#ENDIF<a name='128'></font>
                     ,do_capsuppress                                  &amp;<a name='129'>
#endif                                 <a name='130'>
                                                                      )<a name='131'>
<font color=#447700>!----------------------------------------------------------------------<a name='132'></font>
   USE <A href='../../html_code/share/module_model_constants.F.html#MODULE_MODEL_CONSTANTS'>module_model_constants</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MODEL_CONSTANTS_53"><a name='133'>
   USE <A href='../../html_code/frame/module_state_description.F.html#MODULE_STATE_DESCRIPTION'>module_state_description</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_STATE_DESCRIPTION_115">, ONLY:     KFSCHEME,BMJSCHEME         &amp;<a name='134'>
                                          ,KFETASCHEME,GDSCHEME       &amp;<a name='135'>
                                          ,G3SCHEME,GFSCHEME          &amp;<a name='136'>
                                          ,P_QC,P_QI,Param_FIRST_SCALAR &amp;<a name='137'>
                                          ,CAMZMSCHEME, SASSCHEME     &amp;<a name='138'>
                                          ,OSASSCHEME                 &amp;  <a name='139'>
                                          ,SCALESASSCHEME             &amp;  <font color=#447700>! scale-sware sas<a name='140'></font>
<a name='141'>
                                          ,NSASSCHEME                 &amp;<a name='142'>
#if (EM_CORE == 1)<a name='143'>
                                          ,MSKFSCHEME                 &amp;<a name='144'>
                                          ,CAMMGMPSCHEME              &amp;<a name='145'>
                                          ,KFCUPSCHEME                &amp; <font color=#447700>!CuP, wig 3-Aug-2006  !BSINGH - For WRFCuP scheme<a name='146'></font>
                                          ,num_chem                   &amp; <font color=#447700>!CuP, rce 10-may-2012 !BSINGH - For WRFCuP scheme<a name='147'></font>
#endif<a name='148'>
                                          ,TIEDTKESCHEME              &amp;<a name='149'>
                                          ,NTIEDTKESCHEME             <a name='150'>
<a name='151'>
<a name='152'>
<font color=#447700>! *** add new modules of schemes here<a name='153'></font>
<a name='154'>
   USE <A href='../../html_code/phys/module_cu_kf.F.html#MODULE_CU_KF'>module_cu_kf</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_KF_1">     ,  ONLY : kfcps<a name='155'>
   USE <A href='../../html_code/phys/module_cu_bmj.F.html#MODULE_CU_BMJ'>module_cu_bmj</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_BMJ_2">    ,  ONLY : bmjdrv<a name='156'>
#ifdef DM_PARALLEL<a name='157'>
   USE <A href='../../html_code/frame/module_dm_stubs.F.html#MODULE_DM'>module_dm</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DM_142">        , ONLY : ntasks_x,ntasks_y,local_communicator,mytask,ntasks <a name='158'>
#if (EM_CORE == 1)<a name='159'>
   USE <A href='../../html_code/frame/module_comm_dm.F.html#MODULE_COMM_DM'>module_comm_dm</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_COMM_DM_30">   ,  ONLY : halo_cup_g3_in_sub, halo_cup_g3_out_sub<a name='160'>
#endif<a name='161'>
#endif<a name='162'>
   USE <A href='../../html_code/frame/module_domain.F.html#MODULE_DOMAIN'>module_domain</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DOMAIN_221">    , ONLY: domain<a name='163'>
   USE module_cu_kfeta  , ONLY : kf_eta_cps<a name='164'>
#if (EM_CORE==1)<a name='165'>
   USE <A href='../../html_code/phys/module_cu_mskf.F.html#MODULE_CU_MSKF'>module_cu_mskf</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_MSKF_1">   , ONLY : mskf_cps<a name='166'>
#endif<a name='167'>
   USE module_cu_gd     , ONLY : grelldrv<a name='168'>
   USE <A href='../../html_code/phys/module_cu_gf_wrfdrv.F.html#MODULE_CU_GF_WRFDRV'>module_cu_gf_wrfdrv</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_GF_WRFDRV_1">     , ONLY : gfdrv<a name='169'>
   USE <A href='../../html_code/phys/module_cu_g3.F.html#MODULE_CU_G3'>module_cu_g3</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_G3_1">     , ONLY : g3drv,conv_grell_spread3d<a name='170'>
   USE <A href='../../html_code/phys/module_cu_sas.F.html#MODULE_CU_SAS'>module_cu_sas</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_SAS_1">    , ONLY : cu_sas<a name='171'>
   USE <A href='../../html_code/phys/module_cu_scalesas.F.html#MODULE_CU_SCALESAS'>module_cu_scalesas</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_SCALESAS_1">    , ONLY : cu_scalesas<a name='172'>
<a name='173'>
#if (EM_CORE == 1)<a name='174'>
   USE <A href='../../html_code/phys/module_cu_kfcup.F.html#MODULE_CU_KFCUP'>module_cu_kfcup</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_KFCUP_1">  , ONLY : KF_CUP_CPS <font color=#447700>!wig, 3-Aug-2006 !BSINGH - For WRFCuP scheme <a name='175'></font>
#endif<a name='176'>
   USE <A href='../../html_code/phys/module_cu_osas.F.html#MODULE_CU_OSAS'>module_cu_osas</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_OSAS_1">   , ONLY : cu_osas<a name='177'>
   USE <A href='../../html_code/phys/module_cu_camzm_driver.F.html#MODULE_CU_CAMZM_DRIVER'>module_cu_camzm_driver</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_CAMZM_DRIVER_1">, ONLY : camzm_driver<a name='178'>
   USE <A href='../../html_code/phys/module_cu_tiedtke.F.html#MODULE_CU_TIEDTKE'>module_cu_tiedtke</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_TIEDTKE_1">, ONLY : cu_tiedtke<a name='179'>
   USE <A href='../../html_code/phys/module_cu_ntiedtke.F.html#MODULE_CU_NTIEDTKE'>module_cu_ntiedtke</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_NTIEDTKE_1">,ONLY : cu_ntiedtke<a name='180'>
   USE <A href='../../html_code/phys/module_cu_nsas.F.html#MODULE_CU_NSAS'>module_cu_nsas</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CU_NSAS_1">   , ONLY : cu_nsas<a name='181'>
   USE <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_48"> , ONLY : wrf_err_message<a name='182'>
<a name='183'>
   <font color=#447700>!  This driver calls subroutines for the cumulus parameterizations.<a name='184'></font>
   <font color=#447700>!<a name='185'></font>
   <font color=#447700>!  1. Kain &amp; Fritsch (1993)<a name='186'></font>
   <font color=#447700>!  2. Betts-Miller-Janjic (Janjic, 1994)<a name='187'></font>
   <font color=#447700>!  3. Grell-Devenyi (Grell and Devenyi, 2002)<a name='188'></font>
   <font color=#447700>!  4. Simplified Arakawa-Schubert scheme (NCEP)<a name='189'></font>
   <font color=#447700>!     (adapted by Zhang and Wang to work with ARW in V3.3)<a name='190'></font>
   <font color=#447700>!  5. Grell 3D ensemble scheme<a name='191'></font>
   <font color=#447700>!  6. Modified Tiedtke scheme (Zhang and Wang 2010)<a name='192'></font>
   <font color=#447700>! 14. New simplified Arakawa-Schubert scheme (NCEP, YSU)<a name='193'></font>
   <font color=#447700>! 16. New Tiedtke scheme (Bechtold et al. 2004, 2008, 2014)<a name='194'></font>
   <font color=#447700>!<a name='195'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='196'></font>
   IMPLICIT NONE<a name='197'>
<font color=#447700>!======================================================================<a name='198'></font>
<font color=#447700>! Grid structure in physics part of WRF<a name='199'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='200'></font>
<font color=#447700>! The horizontal velocities used in the physics are unstaggered<a name='201'></font>
<font color=#447700>! relative to temperature/moisture variables. All predicted<a name='202'></font>
<font color=#447700>! variables are carried at half levels except w, which is at full<a name='203'></font>
<font color=#447700>! levels. Some arrays with names (*8w) are at w (full) levels.<a name='204'></font>
<font color=#447700>!<a name='205'></font>
<font color=#447700>!----------------------------------------------------------------------<a name='206'></font>
<font color=#447700>! In WRF, kms (smallest number) is the bottom level and kme (largest<a name='207'></font>
<font color=#447700>! number) is the top level.  In your scheme, if 1 is at the top level,<a name='208'></font>
<font color=#447700>! then you have to reverse the order in the k direction.<a name='209'></font>
<font color=#447700>!<a name='210'></font>
<font color=#447700>!         kme      -   half level (no data at this level)<a name='211'></font>
<font color=#447700>!         kme    ----- full level<a name='212'></font>
<font color=#447700>!         kme-1    -   half level<a name='213'></font>
<font color=#447700>!         kme-1  ----- full level<a name='214'></font>
<font color=#447700>!         .<a name='215'></font>
<font color=#447700>!         .<a name='216'></font>
<font color=#447700>!         .<a name='217'></font>
<font color=#447700>!         kms+2    -   half level<a name='218'></font>
<font color=#447700>!         kms+2  ----- full level<a name='219'></font>
<font color=#447700>!         kms+1    -   half level<a name='220'></font>
<font color=#447700>!         kms+1  ----- full level<a name='221'></font>
<font color=#447700>!         kms      -   half level<a name='222'></font>
<font color=#447700>!         kms    ----- full level<a name='223'></font>
<font color=#447700>!<a name='224'></font>
<font color=#447700>!======================================================================<a name='225'></font>
<font color=#447700>! Definitions<a name='226'></font>
<font color=#447700>!-----------<a name='227'></font>
<font color=#447700>! Rho_d      dry density (kg/m^3)<a name='228'></font>
<font color=#447700>! Theta_m    moist potential temperature (K)<a name='229'></font>
<font color=#447700>! Qv         water vapor mixing ratio (kg/kg)<a name='230'></font>
<font color=#447700>! Qc         cloud water mixing ratio (kg/kg)<a name='231'></font>
<font color=#447700>! Qr         rain water mixing ratio (kg/kg)<a name='232'></font>
<font color=#447700>! Qi         cloud ice mixing ratio (kg/kg)<a name='233'></font>
<font color=#447700>! Qs         snow mixing ratio (kg/kg)<a name='234'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='235'></font>
<font color=#447700>!-- DT            time step (second)<a name='236'></font>
<font color=#447700>!-- CUDT          cumulus time step (minute)<a name='237'></font>
<font color=#447700>!-- curr_secs     current forecast time (seconds)<a name='238'></font>
<font color=#447700>!-- itimestep     number of time step (integer)   <a name='239'></font>
<font color=#447700>!-- DX            horizontal space interval (m)<a name='240'></font>
<font color=#447700>!-- rr            dry air density (kg/m^3)<a name='241'></font>
<font color=#447700>!<a name='242'></font>
<font color=#447700>!-- RUCUTEN       Zonal wind tendency due to <a name='243'></font>
<font color=#447700>!                 cumulus scheme precipitation (m/s/s)<a name='244'></font>
<font color=#447700>!-- RVCUTEN       Meridional wind tendency due to <a name='245'></font>
<font color=#447700>!                 cumulus scheme precipitation (m/s/s)<a name='246'></font>
<font color=#447700>!-- RTHCUTEN      Theta tendency due to <a name='247'></font>
<font color=#447700>!                 cumulus scheme precipitation (K/s)<a name='248'></font>
<font color=#447700>!-- RQVCUTEN      Qv tendency due to <a name='249'></font>
<font color=#447700>!                 cumulus scheme precipitation (kg/kg/s)<a name='250'></font>
<font color=#447700>!-- RQRCUTEN      Qr tendency due to <a name='251'></font>
<font color=#447700>!                 cumulus scheme precipitation (kg/kg/s)<a name='252'></font>
<font color=#447700>!-- RQCCUTEN      Qc tendency due to <a name='253'></font>
<font color=#447700>!                 cumulus scheme precipitation (kg/kg/s)<a name='254'></font>
<font color=#447700>!-- RQSCUTEN      Qs tendency due to <a name='255'></font>
<font color=#447700>!                 cumulus scheme precipitation (kg/kg/s)<a name='256'></font>
<font color=#447700>!-- RQICUTEN      Qi tendency due to <a name='257'></font>
<font color=#447700>!                 cumulus scheme precipitation (kg/kg/s)<a name='258'></font>
<font color=#447700>!<a name='259'></font>
<font color=#447700>!-- RAINC         accumulated total cumulus scheme precipitation (mm)<a name='260'></font>
<font color=#447700>!-- RAINCV        time-step cumulus scheme precipitation (mm)<a name='261'></font>
<font color=#447700>!-- PRATEC        precipitiation rate from cumulus scheme (mm/s)<a name='262'></font>
<font color=#447700>!-- NCA           counter of the cloud relaxation <a name='263'></font>
<font color=#447700>!                 time in KF cumulus scheme (integer)<a name='264'></font>
<font color=#447700>!-- u_phy         u-velocity interpolated to theta points (m/s)<a name='265'></font>
<font color=#447700>!-- v_phy         v-velocity interpolated to theta points (m/s)<a name='266'></font>
<font color=#447700>!-- th_phy        potential temperature (K)<a name='267'></font>
<font color=#447700>!-- t_phy         temperature (K)<a name='268'></font>
<font color=#447700>!-- tsk           skin temperature (K)<a name='269'></font>
<font color=#447700>!-- tke_pbl       turbulent kinetic energy from PBL scheme (m2/s2)<a name='270'></font>
<font color=#447700>!-- ust           u* in similarity theory (m/s)<a name='271'></font>
<font color=#447700>!-- w             vertical velocity (m/s)<a name='272'></font>
<font color=#447700>!-- moist         moisture array (4D - last index is species) (kg/kg)<a name='273'></font>
<font color=#447700>!-- z             height above sea level at middle of layers (m)<a name='274'></font>
<font color=#447700>!-- z_at_w        height above sea level at layer interfaces (m)<a name='275'></font>
<font color=#447700>!-- dz8w          dz between full levels (m)<a name='276'></font>
<font color=#447700>!-- pblh          planetary boundary layer height (m)<a name='277'></font>
<font color=#447700>!-- mavail        soil moisture availability<a name='278'></font>
<font color=#447700>!-- p8w           pressure at full levels (Pa)<a name='279'></font>
<font color=#447700>!-- psfc          surface pressure (Pa)<a name='280'></font>
<font color=#447700>!-- p_phy         pressure (Pa)<a name='281'></font>
<font color=#447700>!-- pi_phy        exner function (dimensionless)<a name='282'></font>
<font color=#447700>!                 points (dimensionless)<a name='283'></font>
<font color=#447700>!-- hfx           upward heat flux at surface (W/m2)<a name='284'></font>
<font color=#447700>!-- qfx           upward moisture flux at surface (kg/m2/s)<a name='285'></font>
<font color=#447700>!-- RTHRATEN      radiative temp forcing for Grell-Devenyi scheme<a name='286'></font>
<font color=#447700>!-- RTHBLTEN      PBL temp forcing for Grell-Devenyi scheme<a name='287'></font>
<font color=#447700>!-- RQVBLTEN      PBL moisture forcing for Grell-Devenyi scheme<a name='288'></font>
<font color=#447700>!-- RTHFTEN       Advective tendency for theta<a name='289'></font>
<font color=#447700>!-- RQVFTEN       Advective tendency for vapor<a name='290'></font>
<font color=#447700>!-- MASS_FLUX<a name='291'></font>
<font color=#447700>!-- XF_ENS<a name='292'></font>
<font color=#447700>!-- PR_ENS<a name='293'></font>
<font color=#447700>!-- warm_rain<a name='294'></font>
<font color=#447700>!-- cldfra        cloud fraction<a name='295'></font>
<font color=#447700>!-- cldfra_mp_all cloud fraction<a name='296'></font>
<font color=#447700>!-- CU_ACT_FLAG<a name='297'></font>
<font color=#447700>!-- W0AVG         average vertical velocity, (for KF scheme) (m/s)<a name='298'></font>
<font color=#447700>!-- kfeta_trigger namelist for KF trigger (=1, default; =2, moisture-advection-dependent trigger)<a name='299'></font>
<font color=#447700>!-- nsas_dx_factor namelist for NSAS deep scheme to have some dependency on grid sizes<a name='300'></font>
<font color=#447700>!-- rho           density (kg/m^3)<a name='301'></font>
<font color=#447700>!-- CLDEFI        precipitation efficiency (for BMJ scheme) (dimensionless)<a name='302'></font>
<font color=#447700>!-- STEPCU        # of fundamental timesteps between convection calls<a name='303'></font>
<font color=#447700>!-- XLAND         land-sea mask (1.0 for land; 2.0 for water)<a name='304'></font>
<font color=#447700>!-- LOWLYR        index of lowest model layer above the ground<a name='305'></font>
<font color=#447700>!-- XLV0          latent heat of vaporization constant <a name='306'></font>
<font color=#447700>!                 used in temperature dependent formula (J/kg)<a name='307'></font>
<font color=#447700>!-- XLV1          latent heat of vaporization constant <a name='308'></font>
<font color=#447700>!                 used in temperature dependent formula (J/kg/K)<a name='309'></font>
<font color=#447700>!-- XLS0          latent heat of sublimation constant <a name='310'></font>
<font color=#447700>!                 used in temperature dependent formula (J/kg)<a name='311'></font>
<font color=#447700>!-- XLS1          latent heat of sublimation constant<a name='312'></font>
<font color=#447700>!                 used in temperature dependent formula (J/kg/K)<a name='313'></font>
<font color=#447700>!-- R_d           gas constant for dry air ( 287. J/kg/K)<a name='314'></font>
<font color=#447700>!-- R_v           gas constant for water vapor (461 J/k/kg)<a name='315'></font>
<font color=#447700>!-- Cp            specific heat at constant pressure (1004 J/k/kg)<a name='316'></font>
<font color=#447700>!-- rvovrd        R_v divided by R_d (dimensionless)<a name='317'></font>
<font color=#447700>!-- G             acceleration due to gravity (m/s^2)<a name='318'></font>
<font color=#447700>!-- EP_1          constant for virtual temperature <a name='319'></font>
<font color=#447700>!                 (R_v/R_d - 1) (dimensionless)<a name='320'></font>
<font color=#447700>!-- pi_phy        the exner function, (p/p0)**(R/Cp) (none unit)<a name='321'></font>
<font color=#447700>!-- evapcdp3d     Evaporation of deep convective precipitation (kg/kg/s)<a name='322'></font>
<font color=#447700>!-- icwmrdp3d     Deep Convection in-cloud water mixing ratio (kg/m2)<a name='323'></font>
<font color=#447700>!-- rprddp3d      dq/dt due to deep convective rainout (kg/kg/s)<a name='324'></font>
<font color=#447700>!-- ids           start index for i in domain<a name='325'></font>
<font color=#447700>!-- ide           end index for i in domain<a name='326'></font>
<font color=#447700>!-- jds           start index for j in domain<a name='327'></font>
<font color=#447700>!-- jde           end index for j in domain<a name='328'></font>
<font color=#447700>!-- kds           start index for k in domain<a name='329'></font>
<font color=#447700>!-- kde           end index for k in domain<a name='330'></font>
<font color=#447700>!-- ims           start index for i in memory<a name='331'></font>
<font color=#447700>!-- ime           end index for i in memory<a name='332'></font>
<font color=#447700>!-- jms           start index for j in memory<a name='333'></font>
<font color=#447700>!-- jme           end index for j in memory<a name='334'></font>
<font color=#447700>!-- kms           start index for k in memory<a name='335'></font>
<font color=#447700>!-- kme           end index for k in memory<a name='336'></font>
<font color=#447700>!-- i_start       start indices for i in tile<a name='337'></font>
<font color=#447700>!-- i_end         end indices for i in tile<a name='338'></font>
<font color=#447700>!-- j_start       start indices for j in tile<a name='339'></font>
<font color=#447700>!-- j_end         end indices for j in tile<a name='340'></font>
<font color=#447700>!-- kts           start index for k in tile<a name='341'></font>
<font color=#447700>!-- kte           end index for k in tile<a name='342'></font>
<font color=#447700>!-- num_tiles     number of tiles<a name='343'></font>
<font color=#447700>!-- HBOT          index of lowest model layer with convection<a name='344'></font>
<font color=#447700>!-- HTOP          index of highest model layer with convection<a name='345'></font>
<font color=#447700>!-- LBOT          index of lowest model layer with convection<a name='346'></font>
<font color=#447700>!-- LTOP          index of highest model layer with convection<a name='347'></font>
<font color=#447700>!-- KPBL          layer index of the PBL<a name='348'></font>
<font color=#447700>!-- periodic_x    T/F this is using periodic lateral boundaries in the X direction<a name='349'></font>
<font color=#447700>!-- periodic_y    T/F this is using periodic lateral boundaries in the Y-direction<a name='350'></font>
<font color=#447700>!<a name='351'></font>
<font color=#447700>!======================================================================<a name='352'></font>
<a name='353'>
   INTEGER,      INTENT(IN   )    ::                             &amp;<a name='354'>
                                      ids,ide, jds,jde, kds,kde, &amp;<a name='355'>
                                      ims,ime, jms,jme, kms,kme, &amp;<a name='356'>
                                                        kts,kte, &amp;<a name='357'>
                                      itimestep, num_tiles<a name='358'>
   LOGICAL periodic_x, periodic_y<a name='359'>
   TYPE(domain) , INTENT(INOUT)          :: grid<a name='360'>
   INTEGER, DIMENSION(num_tiles), INTENT(IN) ::                       &amp;<a name='361'>
     &amp;           i_start,i_end,j_start,j_end<a name='362'>
<a name='363'>
   INTEGER,      INTENT(IN   )    ::                             &amp;<a name='364'>
                  ensdim,maxiens,maxens,maxens2,maxens3<a name='365'>
<a name='366'>
   INTEGER, OPTIONAL,     INTENT(IN   )    ::                    &amp;<a name='367'>
                   cugd_avedx,clos_choice,bl_pbl_physics,sf_sfclay_physics<a name='368'>
<a name='369'>
#if (EM_CORE == 1)<a name='370'>
   <font color=#447700>!BSINGH - For WRFCuP scheme<a name='371'></font>
   INTEGER, OPTIONAL,     INTENT(IN   )    ::                    &amp;<a name='372'>
        shcu_aerosols_opt    <font color=#447700>!CuP, rce 10-may-2012<a name='373'></font>
   <font color=#447700>!BSINGH - ENDS<a name='374'></font>
#endif<a name='375'>
<a name='376'>
<a name='377'>
   INTEGER,      INTENT(IN   )    ::                 cu_physics  <a name='378'>
   INTEGER,      INTENT(IN   )    ::   STEPCU<a name='379'>
   LOGICAL,      INTENT(IN   )    ::   warm_rain<a name='380'>
   LOGICAL,      INTENT(IN   )    ::   is_CAMMGMP_used <font color=#447700>!BSINGH:01/31/2013: Added for CAMZM<a name='381'></font>
<a name='382'>
   REAL, INTENT(IN), OPTIONAL :: pgcon,shal_pgcon,sas_mass_flux<a name='383'>
   logical,intent(in),optional  :: pert_sas<a name='384'>
   integer,intent(in),optional  :: ens_random_seed<a name='385'>
   real,intent(in),optional     :: ens_sasamp<a name='386'>
   INTEGER, INTENT(IN), OPTIONAL :: shalconv<a name='387'>
<a name='388'>
   INTEGER,DIMENSION( ims:ime, jms:jme ),                        &amp;<a name='389'>
           INTENT(IN ) ::                                LOWLYR<a name='390'>
<a name='391'>
   <font color=#447700>!BSINGH - For WRFCuP scheme<a name='392'></font>
   REAL,DIMENSION( ims:ime, jms:jme ),                           &amp;<a name='393'>
           INTENT(INOUT) ::                               shall    <font color=#447700>!CuP, wig 18-Sep-2006<a name='394'></font>
#if (EM_CORE == 1)<a name='395'>
   <font color=#447700>!BSINGH - For WRFCuP scheme<a name='396'></font>
   REAL,DIMENSION( ims:ime, jms:jme ),                           &amp;<a name='397'>
           INTENT(INOUT) ::                            taucloud, &amp; <font color=#447700>!CuP, wig 1-Oct-2006<a name='398'></font>
                                                        tactive, &amp; <font color=#447700>!CuP, wig 1-Oct-2006<a name='399'></font>
                                                     activeFrac, &amp; <font color=#447700>!CuP, lkb 5-May-2010<a name='400'></font>
                                                     wCloudBase    <font color=#447700>!CuP, lkb 29-April-2010  <a name='401'></font>
   <font color=#447700>!BSINGH - ENDS<a name='402'></font>
#endif<a name='403'>
<a name='404'>
<a name='405'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),                 &amp;<a name='406'>
         INTENT(IN ) ::                                          &amp;<a name='407'>
                                                              z  &amp;<a name='408'>
                                                      ,    dz8w  &amp;<a name='409'>
                                                      ,     p8w  &amp;<a name='410'>
                                                      ,       p  &amp;<a name='411'>
                                                      ,      pi  &amp;<a name='412'>
                                                      ,       u  &amp;<a name='413'>
                                                      ,       v  &amp;<a name='414'>
                                                      ,      th  &amp;<a name='415'>
                                                      ,       t  &amp;<a name='416'>
                                                      ,     rho    <font color=#447700>! ckay<a name='417'></font>
<font color=#447700>!ckay<a name='418'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),                 &amp;<a name='419'>
         INTENT(INout ) ::                                    w<a name='420'>
<a name='421'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ), INTENT(OUT ), OPTIONAL ::  evapcdp3d, icwmrdp3d, rprddp3d<a name='422'>
<a name='423'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),                 &amp;<a name='424'>
         INTENT(IN ),OPTIONAL ::                         z_at_w  &amp;<a name='425'>
                                                      ,  cldfra  &amp;<a name='426'>
                                               ,  cldfra_mp_all  &amp;<a name='427'>
                                                      , tke_pbl  <a name='428'>
<a name='429'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),                 &amp;<a name='430'>
         INTENT(INOUT)  ::                                       &amp;<a name='431'>
                                                          W0AVG <a name='432'>
<font color=#447700>!ckay<a name='433'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),                 &amp;<a name='434'>
         INTENT(INOUT)  ::                            cldfra_dp  &amp;<a name='435'>
                                                    , cldfra_sh<a name='436'>
<a name='437'>
<font color=#447700>!kf_edrates<a name='438'></font>
   REAL,  DIMENSION( ims:ime, kms:kme, jms:jme ),                 &amp;<a name='439'>
         INTENT(INOUT)  ::                            udr_kf     &amp;<a name='440'>
                                                    , ddr_kf     &amp;<a name='441'>
                                                    , uer_kf     &amp;<a name='442'>
                                                    , der_kf<a name='443'>
<a name='444'>
   REAL,  DIMENSION( ims:ime , jms:jme ), INTENT(INOUT) ::        &amp;<a name='445'>
          timec_kf<a name='446'>
<a name='447'>
   INTEGER, INTENT(IN   )        ::   kf_edrates<a name='448'>
<a name='449'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),                 &amp;<a name='450'>
         INTENT(INOUT ),OPTIONAL ::                        w_up<a name='451'>
<a name='452'>
   REAL, DIMENSION( ims:ime , jms:jme ), INTENT(IN) ::           &amp;<a name='453'>
          GSW,HT,XLAND<a name='454'>
#if (EM_CORE == 1)<a name='455'>
   <font color=#447700>!BSINGH - For WRFCuP scheme<a name='456'></font>
   REAL, DIMENSION( ims:ime , jms:jme ), INTENT(IN) ::           &amp;<a name='457'>
                                                             br, &amp; <font color=#447700>!CuP, wig 3-Aug-2006<a name='458'></font>
                                                         regime, &amp; <font color=#447700>!CuP, wig 3-Aug-2006<a name='459'></font>
                                                             t2, &amp; <font color=#447700>!CuP, wig 3-Aug-2006<a name='460'></font>
                                                             q2    <font color=#447700>!CuP, wig 3-Aug-2006<a name='461'></font>
<a name='462'>
   <font color=#447700>!BSINGH - ENDS<a name='463'></font>
#endif<a name='464'>
<a name='465'>
<a name='466'>
   REAL, DIMENSION( ims:ime , jms:jme ),                         &amp;<a name='467'>
          INTENT(INOUT) ::                                RAINC  &amp;<a name='468'>
                                                    ,    RAINCV  &amp;<a name='469'>
                                                    ,       NCA  &amp; <a name='470'>
                                                    ,      HTOP  &amp; <a name='471'>
                                                    ,      HBOT  &amp;<a name='472'>
                                                    ,    CLDEFI<a name='473'>
#if (EM_CORE == 1)<a name='474'>
   REAL, DIMENSION( ims:ime , jms:jme ), INTENT(INOUT) :: akpbl    <font color=#447700>!CuP, wig 6-Oct-2006 testing !BSINGH - For WRFCuP scheme<a name='475'></font>
#endif<a name='476'>
 <a name='477'>
   REAL, DIMENSION( kms:kme ), OPTIONAL, INTENT(IN   ) ::        &amp;<a name='478'>
                                                            znu<a name='479'>
<a name='480'>
   REAL, DIMENSION( ims:ime , jms:jme ),INTENT(INOUT),OPTIONAL :: &amp;<a name='481'>
        PRATEC,MAVAIL,PBLH,PSFC,TSK,TPERT2D,UST,HFX,QFX<a name='482'>
<a name='483'>
<font color=#447700>!ckay<a name='484'></font>
   REAL, DIMENSION( ims:ime , jms:jme ),                         &amp;<a name='485'>
         OPTIONAL, INTENT(INOUT) ::                         ZOL  &amp;<a name='486'>
                                                    ,     WSTAR<a name='487'>
<a name='488'>
   REAL, DIMENSION( ims:ime , jms:jme ) :: tmppratec<a name='489'>
                                                    <a name='490'>
   INTEGER, DIMENSION( ims:ime , jms:jme ),                      &amp;<a name='491'>
                    INTENT(IN) ::                          KPBL<a name='492'>
<a name='493'>
   LOGICAL, DIMENSION( ims:ime , jms:jme ),                      &amp;<a name='494'>
          INTENT(INOUT) :: CU_ACT_FLAG<a name='495'>
<a name='496'>
   INTEGER, INTENT(IN   ), OPTIONAL        ::   kfeta_trigger<a name='497'>
   INTEGER, INTENT(IN   ), OPTIONAL        ::   nsas_dx_factor<a name='498'>
<a name='499'>
   REAL,  INTENT(IN   ) :: DT, DX<a name='500'>
   INTEGER,      INTENT(IN   ),OPTIONAL    ::                             &amp;<a name='501'>
                   ips,ipe, jps,jpe, kps,kpe,imomentum,ishallow<a name='502'>
   REAL,  INTENT(IN   ),OPTIONAL :: CUDT<a name='503'>
   REAL,  INTENT(IN   ),OPTIONAL :: CURR_SECS<a name='504'>
   LOGICAL,INTENT(IN   ),OPTIONAL    ::     adapt_step_flag<a name='505'>
   REAL,  INTENT(INOUT ),OPTIONAL :: cudtacttime                 <a name='506'>
   REAL   :: cudt_pass, curr_secs_pass,cudtacttime_pass          <a name='507'>
   LOGICAL :: adapt_step_flag_pass<a name='508'>
<a name='509'>
   INTEGER,      INTENT(IN   ), OPTIONAL    ::   mp_physics<a name='510'>
   REAL, DIMENSION( ims:ime , jms:jme ), OPTIONAL, INTENT(IN) ::  STORE_RAND<a name='511'>
<font color=#447700>!<a name='512'></font>
   REAL, OPTIONAL,  INTENT(INOUT) :: mommix<a name='513'>
<a name='514'>
<a name='515'>
   REAL, DIMENSION( ims:ime , jms:jme ), OPTIONAL,               &amp;    <a name='516'>
                    INTENT(IN) ::  DX2D                           <font color=#447700>! For scale-aware SAS<a name='517'></font>
   REAL, OPTIONAL,  INTENT(IN) ::  DYNMM                          <font color=#447700>! For scale-aware SAS  <a name='518'></font>
   REAL, DIMENSION( ims:ime , jms:jme ), OPTIONAL,INTENT(INOUT) :: &amp;<a name='519'>
                                   SCALEFUN,SCALEFUN1,SIGMU,SIGMU1    <a name='520'>
<a name='521'>
<a name='522'>
   REAL, DIMENSION( ims:ime , jms:jme ), OPTIONAL,               &amp;    <font color=#447700>!Kwon for sas2010 shallow convection<a name='523'></font>
                    INTENT(INOUT) ::  HPBL2D, EVAP2D, HEAT2D<a name='524'>
<font color=#447700>!<a name='525'></font>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),                 &amp;<a name='526'>
                   INTENT(INOUT) :: rucuten,rvcuten<a name='527'>
<font color=#447700>!<a name='528'></font>
<font color=#447700>! optional arguments<a name='529'></font>
<font color=#447700>!<a name='530'></font>
   INTEGER, DIMENSION( ims:ime, jms:jme ),                       &amp;<a name='531'>
         OPTIONAL, INTENT(INOUT) ::                              &amp;<a name='532'>
     k22_shallow,kbcon_shallow,ktop_shallow,ideep2d,jt2d,maxg2d, &amp;<a name='533'>
     lengath2d <a name='534'>
   INTEGER, DIMENSION( ims:ime, jms:jme ),                       &amp;<a name='535'>
         OPTIONAL, INTENT(  OUT) :: ktop_deep<a name='536'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),                 &amp;<a name='537'>
         OPTIONAL, INTENT(INOUT) ::                              &amp;<a name='538'>
                      <font color=#447700>! optional moisture tracers<a name='539'></font>
                      <font color=#447700>! 2 time levels; if only one then use CURR<a name='540'></font>
                      qv_curr, qc_curr, qr_curr                  &amp;<a name='541'>
                     ,qi_curr, qs_curr, qg_curr                  &amp; <a name='542'>
                     ,qv_prev, qc_prev, qr_prev                  &amp; <a name='543'>
                     ,qi_prev, qs_prev, qg_prev                  &amp;<a name='544'>
                      <font color=#447700>! optional moisture and other tendencies<a name='545'></font>
                     ,rqvcuten,rqccuten,rqrcuten                 &amp;<a name='546'>
                     ,rqicuten,rqscuten,rqgcuten                 &amp;<a name='547'>
                     ,rqcncuten,rqincuten                        &amp;<a name='548'>
                     ,rqvblten,rqvften                           &amp;<a name='549'>
                     ,rthraten,rthblten                          &amp;<a name='550'>
                     ,cugd_tten,cugd_qvten,cugd_qcten            &amp;<a name='551'>
                     ,cugd_ttens,cugd_qvtens                     &amp;<a name='552'>
                     ,forcet, forceq                             &amp;<a name='553'>
                     ,rthften,rthcuten<a name='554'>
<a name='555'>
   REAL, DIMENSION( ims:ime , jms:jme ),                         &amp;<a name='556'>
                    OPTIONAL,                                    &amp;<a name='557'>
                    INTENT(INOUT) ::                             &amp;<a name='558'>
                apr_gr,apr_w,apr_mc,apr_st,apr_as,apr_capma      &amp;<a name='559'>
               ,apr_capme,apr_capmi,edt_out,xmb_shallow          &amp;<a name='560'>
                                                    , MASS_FLUX  &amp;<a name='561'>
               ,cape, pconvb, pconvt, preccdzm, precz, rliq      &amp;<a name='562'>
               ,dsubcld2d<a name='563'>
<a name='564'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),                 &amp;<a name='565'>
         OPTIONAL, INTENT(INOUT) ::                              &amp;<a name='566'>
                  GD_CLOUD,GD_CLOUD2,                            &amp;<a name='567'>
                  zmmd, zmmu, zmdt, zmdq, dlf,                   &amp;<a name='568'>
                  evaptzm, fzsntzm, evsntzm, evapqzm, zmflxprc,  &amp;<a name='569'>
                  zmflxsnw, zmntprpd, zmntsnpd, zmeiheat,        &amp;<a name='570'>
                  cmfmc, cmfmcdzm,                               &amp;<a name='571'>
                  zmmtu, zmmtv, zmupgu, zmupgd, zmvpgu, zmvpgd,  &amp;<a name='572'>
                  zmicuu, zmicud, zmicvu, zmicvd, zmdice, zmdliq,&amp;<a name='573'>
                  dp3d, du3d, ed3d, eu3d, md3d, mu3d<a name='574'>
<a name='575'>
   REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),                 &amp;<a name='576'>
                  INTENT(INOUT) ::                               &amp;<a name='577'>
                  QC_CU,QI_CU<a name='578'>
                  <a name='579'>
   REAL, DIMENSION( ims:ime , jms:jme , 1:ensdim ),              &amp;<a name='580'>
          OPTIONAL,                                              &amp;<a name='581'>
          INTENT(INOUT) ::                       XF_ENS, PR_ENS<a name='582'>
<a name='583'>
<a name='584'>
#if (EM_CORE == 1)<a name='585'>
<font color=#447700>!BSINGH - For WRFCuP Scheme<a name='586'></font>
  REAL, DIMENSION( ims:ime , jms:jme ),                         &amp;<a name='587'>
         INTENT(OUT) ::                       slopeSfc, slopeEZ, &amp; <font color=#447700>!CuP, wig 7-Aug-2006<a name='588'></font>
                                              sigmaSfc, SigmaEZ, &amp; <font color=#447700>!CuP, wig 7-Aug-2006<a name='589'></font>
                                                          tstar, &amp; <font color=#447700>!CuP, wig 4-Oct-2006<a name='590'></font>
                                                          lnint    <font color=#447700>!CuP, wig 4-Oct-2006<a name='591'></font>
<a name='592'>
   REAL, DIMENSION( ims:ime , kms:kme, jms:jme ),                &amp;<a name='593'>
         INTENT(OUT) ::                                          &amp;<a name='594'>
                                                        lnterms, &amp; <font color=#447700>!CuP, wig 4-Oct-2006<a name='595'></font>
                                                     cldfra_cup, &amp; <font color=#447700>!CuP, wig 18-Sep-2006<a name='596'></font>
                                                 cldfratend_cup    <font color=#447700>!CuP, wig 18-Sep-2006<a name='597'></font>
<a name='598'>
   REAL, DIMENSION( ims:ime , jms:jme ),                         &amp;<a name='599'>
          INTENT(INOUT) ::                             wact_cup, &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='600'></font>
                                                      wulcl_cup, &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='601'></font>
                                                     tcloud_cup    <font color=#447700>!CuP, rce 10-may-2012<a name='602'></font>
<a name='603'>
   REAL, DIMENSION( ims:ime , kms:kme, jms:jme ),                &amp;<a name='604'>
         INTENT(INOUT) ::                                        &amp;<a name='605'>
                                                        wup_cup, &amp; <font color=#447700>!CuP, rce 15-mar-2013 !BSINGH (12/06/2013)<a name='606'></font>
                                                      qc_ic_cup, &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='607'></font>
                                                  qndrop_ic_cup, &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='608'></font>
                                                      qc_iu_cup, &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='609'></font>
                                              fcvt_qc_to_pr_cup, &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='610'></font>
                                              fcvt_qc_to_qi_cup, &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='611'></font>
                                              fcvt_qi_to_pr_cup, &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='612'></font>
                                                       mfup_cup, &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='613'></font>
                                                   mfup_ent_cup, &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='614'></font>
                                                       mfdn_cup, &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='615'></font>
                                                   mfdn_ent_cup, &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='616'></font>
                                                     updfra_cup    <font color=#447700>!CuP, rce 10-may-2012<a name='617'></font>
<a name='618'>
   INTEGER, OPTIONAL, INTENT(IN) ::                    chem_opt    <font color=#447700>!CuP, rce 10-may-2012<a name='619'></font>
<a name='620'>
   LOGICAL, DIMENSION( ims:ime, jms:jme ),                       &amp;<a name='621'>
            INTENT(OUT) ::                              cupflag    <font color=#447700>!CuP, wig 9-Oct-2006<a name='622'></font>
<a name='623'>
   REAL,  INTENT(IN   ) :: thBinSize, rBinSize<a name='624'>
   INTEGER, INTENT(IN ) :: numBins <a name='625'>
   REAL,  INTENT(IN   ) :: minDeepFreq, minShallowFreq <a name='626'>
<font color=#447700>!BSINGH - ENDS<a name='627'></font>
#endif<a name='628'>
<a name='629'>
<a name='630'>
   REAL, DIMENSION( ims:ime , kms:kme , jms:jme ),              &amp;<a name='631'>
         OPTIONAL,                                              &amp;<a name='632'>
         INTENT(INOUT) ::                                       &amp;<a name='633'>
                                                   CFU1,        &amp;<a name='634'>
                                                   CFD1,        &amp;<a name='635'>
                                                   DFU1,        &amp;<a name='636'>
                                                   EFU1,        &amp;<a name='637'>
                                                   DFD1,        &amp;<a name='638'>
                                                   EFD1<a name='639'>
<a name='640'>
<font color=#447700>!<a name='641'></font>
<font color=#447700>! Flags relating to the optional tendency arrays declared above<a name='642'></font>
<font color=#447700>! Models that carry the optional tendencies will provdide the<a name='643'></font>
<font color=#447700>! optional arguments at compile time; these flags all the model<a name='644'></font>
<font color=#447700>! to determine at run-time whether a particular tracer is in<a name='645'></font>
<font color=#447700>! use or not.<a name='646'></font>
<font color=#447700>!<a name='647'></font>
   LOGICAL, INTENT(IN), OPTIONAL ::                             &amp;<a name='648'>
                                                      f_qv      &amp;<a name='649'>
                                                     ,f_qc      &amp;<a name='650'>
                                                     ,f_qr      &amp;<a name='651'>
                                                     ,f_qi      &amp;<a name='652'>
                                                     ,f_qs      &amp;<a name='653'>
                                                     ,f_qg<a name='654'>
   LOGICAL, INTENT(IN), OPTIONAL ::                   f_flux<a name='655'>
<a name='656'>
<font color=#447700>!beka - random pattern  arrays, if not existing, set to zero<a name='657'></font>
<font color=#447700>!<a name='658'></font>
<font color=#447700>!     REAL, DIMENSION( ims:ime, kms:kme, jms:jme ),INTENT(INOUT),OPTIONAL :: &amp;<a name='659'></font>
<font color=#447700>!           pattern_spp_conv,field_conv<a name='660'></font>
<font color=#447700>!     INTEGER, OPTIONAL :: spp_conv<a name='661'></font>
     REAL, DIMENSION( ims:ime, kms:kme, jms:jme ) :: &amp;<a name='662'>
           pattern_spp_conv,field_conv<a name='663'>
     INTEGER  :: spp_conv<a name='664'>
<a name='665'>
#if ( WRF_DFI_RADAR == 1 )<a name='666'>
<font color=#447700>!<a name='667'></font>
<font color=#447700>!  option of cap suppress: <a name='668'></font>
<font color=#447700>!        do_capsuppress = 1   do<a name='669'></font>
<font color=#447700>!        do_capsuppress = other   don't<a name='670'></font>
<font color=#447700>!<a name='671'></font>
<font color=#447700>!<a name='672'></font>
   INTEGER,      INTENT(IN   ) ,OPTIONAL   :: do_capsuppress<a name='673'>
   REAL, DIMENSION( ims:ime, jms:jme ) :: cap_suppress_loc<a name='674'>
#endif<a name='675'>
<a name='676'>
<font color=#447700>! LOCAL  VAR<a name='677'></font>
<a name='678'>
   INTEGER :: i,j,k,its,ite,jts,jte,ij,trigger_kf,dx_factor_nsas<a name='679'>
   logical :: l_flux<a name='680'>
   LOGICAL :: decided , run_param , doing_adapt_dt<a name='681'>
<a name='682'>
<a name='683'>
<font color=#447700>!-----------------------------------------------------------------<a name='684'></font>
    pattern_spp_conv=0.<a name='685'>
    field_conv=0.<a name='686'>
    spp_conv=0<a name='687'>
<a name='688'>
<a name='689'>
   l_flux=.FALSE.<a name='690'>
   if (present(f_flux)) l_flux=f_flux<a name='691'>
   if (.not. PRESENT(CURR_SECS)) then<a name='692'>
      curr_secs_pass = -1<a name='693'>
   else <a name='694'>
      curr_secs_pass = curr_secs<a name='695'>
   endif<a name='696'>
<a name='697'>
   if (.not. PRESENT(CUDT)) then<a name='698'>
      cudt_pass = -1<a name='699'>
      cudtacttime_pass = -1<a name='700'>
   else<a name='701'>
      cudt_pass = cudt<a name='702'>
      cudtacttime_pass = cudtacttime<a name='703'>
   endif<a name='704'>
<a name='705'>
   if (.not. PRESENT(adapt_step_flag)) then<a name='706'>
      adapt_step_flag_pass = .false.<a name='707'>
   else<a name='708'>
      adapt_step_flag_pass = adapt_step_flag<a name='709'>
   endif<a name='710'>
<a name='711'>
   <font color=#447700>! Initialize tmppratec to pratec<a name='712'></font>
<a name='713'>
   if ( PRESENT ( pratec ) ) then<a name='714'>
      tmppratec(:,:) = pratec(:,:)<a name='715'>
   else<a name='716'>
      tmppratec(:,:) = 0.<a name='717'>
   end if<a name='718'>
<a name='719'>
   if (.not. PRESENT(kfeta_trigger)) then<a name='720'>
      trigger_kf = 1<a name='721'>
   else<a name='722'>
      trigger_kf = kfeta_trigger<a name='723'>
   endif<a name='724'>
<a name='725'>
   if (.not. PRESENT(nsas_dx_factor)) then<a name='726'>
      dx_factor_nsas = 0<a name='727'>
   else<a name='728'>
      dx_factor_nsas = nsas_dx_factor<a name='729'>
   endif<a name='730'>
<a name='731'>
   IF (cu_physics .eq. 0) return<a name='732'>
<a name='733'>
<font color=#447700>!  Initialization for adaptive time step.<a name='734'></font>
<a name='735'>
   IF ( adapt_step_flag_pass ) THEN<a name='736'>
      doing_adapt_dt = .TRUE.<a name='737'>
      IF ( cudtacttime_pass .EQ. 0. ) THEN<a name='738'>
         cudtacttime_pass = curr_secs_pass + cudt_pass*60.<a name='739'>
      END IF<a name='740'>
   ELSE<a name='741'>
      doing_adapt_dt = .FALSE.<a name='742'>
   END IF<a name='743'>
<a name='744'>
<font color=#447700>!  Do we run through this scheme or not?<a name='745'></font>
<a name='746'>
<font color=#447700>!    Test 1:  If this is the initial model time, then yes.<a name='747'></font>
<font color=#447700>!                ITIMESTEP=1<a name='748'></font>
<font color=#447700>!    Test 2:  If the user asked for the cumulus to be run every time step, then yes.<a name='749'></font>
<font color=#447700>!                CUDT=0 or STEPCU=1<a name='750'></font>
<font color=#447700>!    Test 3:  If not adaptive dt, and this is on the requested cumulus frequency, then yes.<a name='751'></font>
<font color=#447700>!                MOD(ITIMESTEP,STEPCU)=0<a name='752'></font>
<font color=#447700>!    Test 4:  If using adaptive dt and the current time is past the last requested activate cumulus time, then yes.<a name='753'></font>
<font color=#447700>!                CURR_SECS &gt;= CUDTACTTIME<a name='754'></font>
<a name='755'>
<font color=#447700>!  If we do run through the scheme, we set the flag run_param to TRUE and we set the decided flag<a name='756'></font>
<font color=#447700>!  to TRUE.  The decided flag says that one of these tests was able to say "yes", run the scheme.<a name='757'></font>
<font color=#447700>!  We only proceed to other tests if the previous tests all have left decided as FALSE.<a name='758'></font>
<a name='759'>
<font color=#447700>!  If we set run_param to TRUE and this is adaptive time stepping, we set the time to the next<a name='760'></font>
<font color=#447700>!  cumulus run.<a name='761'></font>
<a name='762'>
   decided = .FALSE.<a name='763'>
   run_param = .FALSE.<a name='764'>
   IF ( ( .NOT. decided ) .AND. &amp;<a name='765'>
        ( itimestep .EQ. 1 ) ) THEN<a name='766'>
      run_param   = .TRUE.<a name='767'>
      decided     = .TRUE.<a name='768'>
   END IF<a name='769'>
<a name='770'>
   IF ( ( .NOT. decided ) .AND. &amp;<a name='771'>
        ( ( cudt_pass .EQ. 0. ) .OR. ( stepcu .EQ. 1 ) ) ) THEN<a name='772'>
      run_param   = .TRUE.<a name='773'>
      decided     = .TRUE.<a name='774'>
   END IF<a name='775'>
<a name='776'>
   IF ( ( .NOT. decided ) .AND. &amp;<a name='777'>
        ( .NOT. doing_adapt_dt ) .AND. &amp;<a name='778'>
        ( MOD(itimestep,stepcu) .EQ. 0 ) ) THEN<a name='779'>
      run_param   = .TRUE.<a name='780'>
      decided     = .TRUE.<a name='781'>
   END IF<a name='782'>
<a name='783'>
   IF ( ( .NOT. decided ) .AND. &amp;<a name='784'>
        ( doing_adapt_dt ) .AND. &amp;<a name='785'>
        ( curr_secs_pass .GE. cudtacttime_pass ) ) THEN<a name='786'>
      run_param   = .TRUE.<a name='787'>
      decided     = .TRUE.<a name='788'>
      cudtacttime_pass = curr_secs_pass + cudt_pass*60<a name='789'>
   END IF<a name='790'>
<a name='791'>
   IF ( run_param ) THEN<a name='792'>
<font color=#447700>!print *,'calling CU scheme'<a name='793'></font>
   ELSE<a name='794'>
<font color=#447700>!print *,'NOT calling CU scheme'<a name='795'></font>
      RETURN<a name='796'>
   END IF<a name='797'>
<a name='798'>
#if  ( EM_CORE == 1 )<a name='799'>
      if(cu_physics == G3SCHEME .or. cu_physics == NTIEDTKESCHEME) then<a name='800'>
      <font color=#447700>!$OMP PARALLEL DO   &amp;<a name='801'></font>
      <font color=#447700>!$OMP PRIVATE ( ij,i,j,k,its,ite,jts,jte )<a name='802'></font>
<a name='803'>
      DO ij = 1 , num_tiles<a name='804'>
        its = i_start(ij)<a name='805'>
        ite = i_end(ij)<a name='806'>
        jts = j_start(ij)<a name='807'>
        jte = j_end(ij)<a name='808'>
        do j=jts,min(jte,jde-1)<a name='809'>
        do k=kts,kte<a name='810'>
        do i=its,min(ite,ide-1)<a name='811'>
           RTHFTEN(i,k,j)=(RTHFTEN(i,k,j)+RTHRATEN(i,k,j) &amp;<a name='812'>
                               +RTHBLTEN(i,k,j))*pi(i,k,j)<a name='813'>
           RQVFTEN(i,k,j)=RQVFTEN(i,k,j)+RQVBLTEN(i,k,j)<a name='814'>
       enddo<a name='815'>
       enddo<a name='816'>
       enddo<a name='817'>
      ENDDO<a name='818'>
      <font color=#447700>!$OMP END PARALLEL DO<a name='819'></font>
      endif<a name='820'>
<a name='821'>
      IF ( cu_physics == G3SCHEME .OR.  cu_physics == GFSCHEME .OR.     &amp;<a name='822'>
           cu_physics == KFETASCHEME .OR. cu_physics == MSKFSCHEME ) THEN<a name='823'>
#ifdef DM_PARALLEL<a name='824'>
#include "<A href='../../html_code/include/HALO_CUP_G3_IN.inc.html'>HALO_CUP_G3_IN.inc</A>"<A NAME="HALO_CUP_G3_IN.inc_1"><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='825'>
#endif<a name='826'>
      ENDIF<a name='827'>
#endif<a name='828'>
<a name='829'>
<a name='830'>
<font color=#447700>! DON'T JUDGE TIME STEP HERE, SINCE KF NEEDS ACCUMULATED W FIELD.<a name='831'></font>
<font color=#447700>! DO IT INSIDE THE INDIVIDUAL CUMULUS SCHEME<a name='832'></font>
<a name='833'>
<font color=#447700>! SET START AND END POINTS FOR TILES<a name='834'></font>
      <font color=#447700>!$OMP PARALLEL DO   &amp;<a name='835'></font>
      <font color=#447700>!$OMP PRIVATE ( ij ,its,ite,jts,jte, i,j,k)<a name='836'></font>
<a name='837'>
      DO ij = 1 , num_tiles<a name='838'>
        its = i_start(ij)<a name='839'>
        ite = i_end(ij)<a name='840'>
        jts = j_start(ij)<a name='841'>
        jte = j_end(ij)<a name='842'>
        <a name='843'>
#if (EM_CORE == 1)<a name='844'>
        <font color=#447700>!BSINGH - For WRFCuP scheme<a name='845'></font>
        <font color=#447700>!wig, beg: testing for kpbl to get output to wrfout since kpbl won't output as an integer<a name='846'></font>
        do j=jts,jte<a name='847'>
           do i=its,ite<a name='848'>
              akpbl(i,j) = kpbl(i,j)<a name='849'>
           end do<a name='850'>
        end do<a name='851'>
        <font color=#447700>!wig, end.<a name='852'></font>
        <font color=#447700>!BSINGH - ENDS<a name='853'></font>
#endif<a name='854'>
<a name='855'>
<a name='856'>
   cps_select: SELECT CASE(cu_physics)<a name='857'>
<a name='858'>
     CASE (KFSCHEME)<a name='859'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_538">(100,'in kfcps')<a name='860'>
<a name='861'>
          CALL <A href='../../html_code/phys/module_cu_kf.F.html#KFCPS'>KFCPS</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="KFCPS_1">(                                           &amp;<a name='862'>
              <font color=#447700>! order independent arguments<a name='863'></font>
                DT=dt ,KTAU=itimestep ,DX=dx , CUDT=cudt_pass   &amp;<a name='864'>
               ,ADAPT_STEP_FLAG=adapt_step_flag_pass            &amp;<a name='865'>
               ,RHO=rho                                         &amp;<a name='866'>
               ,U=u ,V=v ,TH=th ,T=t ,W=w                       &amp;<a name='867'>
               ,PCPS=p ,PI=pi                                   &amp;<a name='868'>
               ,XLV0=xlv0 ,XLV1=xlv1 ,XLS0=xls0 ,XLS1=xls1      &amp;<a name='869'>
               ,RAINCV=raincv, PRATEC=tmppratec, NCA=nca        &amp;<a name='870'>
               ,DZ8W=dz8w                                       &amp;<a name='871'>
               ,W0AVG=w0avg                                     &amp;<a name='872'>
               ,CP=cp ,R=r_d ,G=g ,EP1=ep_1 ,EP2=ep_2           &amp;<a name='873'>
               ,SVP1=svp1 ,SVP2=svp2 ,SVP3=svp3 ,SVPT0=svpt0    &amp;<a name='874'>
               ,STEPCU=stepcu                                   &amp;<a name='875'>
               ,CU_ACT_FLAG=cu_act_flag                         &amp;<a name='876'>
               ,WARM_RAIN=warm_rain                             &amp;<a name='877'>
               ,QV=qv_curr                                      &amp;<a name='878'>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='879'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='880'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='881'>
              <font color=#447700>! optionals<a name='882'></font>
               ,RTHCUTEN=rthcuten ,RQVCUTEN=rqvcuten            &amp;<a name='883'>
               ,RQCCUTEN=rqccuten ,RQRCUTEN=rqrcuten            &amp;<a name='884'>
               ,RQICUTEN=rqicuten ,RQSCUTEN=rqscuten            &amp;<a name='885'>
               ,F_QV=f_qv,F_QC=f_qc,F_QR=f_qr                   &amp;<a name='886'>
               ,F_QI=f_qi,F_QS=f_qs                             &amp;<a name='887'>
               ,UDR_KF=udr_kf,DDR_KF=ddr_kf                     &amp; <font color=#447700>!kf_edrates<a name='888'></font>
               ,UER_KF=uer_kf,DER_KF=der_kf                     &amp; <a name='889'>
               ,TIMEC_KF=timec_kf,KF_EDRATES=kf_edrates         &amp; <a name='890'>
                                                                )<a name='891'>
<a name='892'>
     CASE (BMJSCHEME)<a name='893'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_539">(100,'in bmj_cps')<a name='894'>
          CALL <A href='../../html_code/phys/module_cu_bmj.F.html#BMJDRV'>BMJDRV</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="BMJDRV_1">(                                          &amp;<a name='895'>
                TH=th,T=T ,RAINCV=raincv, PRATEC=tmppratec      &amp;<a name='896'>
               ,RHO=rho                                         &amp;<a name='897'>
               ,DT=dt ,ITIMESTEP=itimestep ,STEPCU=stepcu       &amp;<a name='898'>
               ,CUTOP=htop, CUBOT=hbot, KPBL=kpbl               &amp;<a name='899'>
               ,DZ8W=dz8w ,PINT=p8w, PMID=p, PI=pi              &amp;<a name='900'>
               ,CP=cp ,R=r_d ,ELWV=xlv ,ELIV=xls ,G=g           &amp;<a name='901'>
               ,TFRZ=svpt0 ,D608=ep_1 ,CLDEFI=cldefi            &amp;<a name='902'>
               ,LOWLYR=lowlyr ,XLAND=xland                      &amp;<a name='903'>
               ,CU_ACT_FLAG=cu_act_flag                         &amp;<a name='904'>
               ,QV=qv_curr                                      &amp;<a name='905'>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='906'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='907'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='908'>
              <font color=#447700>! optionals<a name='909'></font>
               ,RTHCUTEN=rthcuten ,RQVCUTEN=rqvcuten            &amp;<a name='910'>
                                                                )<a name='911'>
<a name='912'>
     CASE (KFETASCHEME)<a name='913'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_540">(100,'in kf_eta_cps')<a name='914'>
          CALL KF_ETA_CPS(                                      &amp;<a name='915'>
                U=u ,V=v ,TH=th ,T=t ,W=w ,RHO=rho              &amp;<a name='916'>
               ,CUDT=cudt_pass                                  &amp;<a name='917'>
               ,ADAPT_STEP_FLAG=adapt_step_flag_pass            &amp;<a name='918'>
               ,RAINCV=raincv, PRATEC=tmppratec, NCA=nca        &amp;<a name='919'>
               ,DZ8W=dz8w                                       &amp;<a name='920'>
               ,PCPS=p, PI=pi ,W0AVG=W0AVG                      &amp;<a name='921'>
               ,CUTOP=HTOP,CUBOT=HBOT                           &amp;<a name='922'>
               ,XLV0=XLV0 ,XLV1=XLV1 ,XLS0=XLS0 ,XLS1=XLS1      &amp;<a name='923'>
               ,CP=CP ,R=R_d ,G=G ,EP1=EP_1 ,EP2=EP_2           &amp;<a name='924'>
               ,SVP1=SVP1 ,SVP2=SVP2 ,SVP3=SVP3 ,SVPT0=SVPT0    &amp;<a name='925'>
               ,DT=dt ,KTAU=itimestep ,DX=dx                    &amp;<a name='926'>
               ,STEPCU=stepcu                                   &amp;<a name='927'>
               ,CU_ACT_FLAG=cu_act_flag ,WARM_RAIN=warm_rain    &amp;<a name='928'>
               ,QV=qv_curr                                      &amp;<a name='929'>
               ,SHALL=shall                                     &amp; <font color=#447700>!BSINGH - For WRFCuP scheme added "shall"<a name='930'></font>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='931'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='932'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='933'>
               ,trigger=trigger_kf                              &amp;<a name='934'>
              <font color=#447700>! optionals<a name='935'></font>
               ,RTHCUTEN=rthcuten                               &amp;<a name='936'>
               ,RQVCUTEN=rqvcuten ,RQCCUTEN=rqccuten            &amp;<a name='937'>
               ,RQRCUTEN=rqrcuten ,RQICUTEN=rqicuten            &amp;<a name='938'>
               ,RQSCUTEN=rqscuten, RQVFTEN=RQVFTEN              &amp;<a name='939'>
               ,F_QV=f_qv,F_QC=f_qc,F_QR=f_qr                   &amp;<a name='940'>
               ,F_QI=f_qi,F_QS=f_qs                             &amp;<a name='941'>
               ,CLDFRA_DP_KF=cldfra_dp                          &amp; <font color=#447700>! ckay for sub-grid cloud<a name='942'></font>
               ,CLDFRA_SH_KF=cldfra_sh                          &amp;<a name='943'>
               ,QC_KF=QC_CU,QI_KF=QI_CU                         &amp;<a name='944'>
               ,UDR_KF=udr_kf,DDR_KF=ddr_kf                     &amp; <font color=#447700>!kf_edrates<a name='945'></font>
               ,UER_KF=uer_kf,DER_KF=der_kf                     &amp; <a name='946'>
               ,TIMEC_KF=timec_kf,KF_EDRATES=kf_edrates         ) <a name='947'>
<a name='948'>
#if (EM_CORE==1)<a name='949'>
     CASE (MSKFSCHEME)<a name='950'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_541">(100,'in mskf_cps')<a name='951'>
          CALL <A href='../../html_code/phys/module_cu_mskf.F.html#MSKF_CPS'>MSKF_CPS</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MSKF_CPS_1">(                                        &amp;<a name='952'>
                U=u ,V=v ,TH=th ,T=t ,W=w ,RHO=rho              &amp;<a name='953'>
               ,CUDT=cudt_pass                                  &amp;<a name='954'>
               ,ADAPT_STEP_FLAG=adapt_step_flag_pass            &amp;<a name='955'>
               ,RAINCV=raincv, PRATEC=tmppratec, NCA=nca        &amp;<a name='956'>
               ,DZ8W=dz8w                                       &amp;<a name='957'>
               ,PCPS=p, PI=pi ,W0AVG=W0AVG                      &amp;<a name='958'>
               ,CUTOP=HTOP,CUBOT=HBOT                           &amp;<a name='959'>
               ,XLV0=XLV0 ,XLV1=XLV1 ,XLS0=XLS0 ,XLS1=XLS1      &amp;<a name='960'>
               ,CP=CP ,R=R_d ,G=G ,EP1=EP_1 ,EP2=EP_2           &amp;<a name='961'>
               ,SVP1=SVP1 ,SVP2=SVP2 ,SVP3=SVP3 ,SVPT0=SVPT0    &amp;<a name='962'>
               ,DT=dt ,KTAU=itimestep ,DX=dx                    &amp;<a name='963'>
               ,STEPCU=stepcu                                   &amp;<a name='964'>
               ,CU_ACT_FLAG=cu_act_flag ,WARM_RAIN=warm_rain    &amp;<a name='965'>
               ,QV=qv_curr                                      &amp;<a name='966'>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='967'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='968'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='969'>
               ,trigger=trigger_kf                              &amp;<a name='970'>
              <font color=#447700>! optionals<a name='971'></font>
               ,RTHCUTEN=rthcuten                               &amp;<a name='972'>
               ,RQVCUTEN=rqvcuten ,RQCCUTEN=rqccuten            &amp;<a name='973'>
               ,RQRCUTEN=rqrcuten ,RQICUTEN=rqicuten            &amp;<a name='974'>
               ,RQSCUTEN=rqscuten, RQVFTEN=RQVFTEN              &amp;<a name='975'>
               ,F_QV=f_qv,F_QC=f_qc,F_QR=f_qr                   &amp;<a name='976'>
               ,F_QI=f_qi,F_QS=f_qs                             &amp;<a name='977'>
               ,CLDFRA_DP_KF=cldfra_dp                          &amp; <font color=#447700>! ckay for sub-grid cloud<a name='978'></font>
               ,CLDFRA_SH_KF=cldfra_sh                          &amp;<a name='979'>
               ,W_UP=w_up                                       &amp; <font color=#447700>! ckay<a name='980'></font>
               ,QC_KF=QC_CU,QI_KF=QI_CU                         &amp;<a name='981'>
               ,UDR_KF=udr_kf,DDR_KF=ddr_kf                     &amp; <font color=#447700>!kf_edrates<a name='982'></font>
               ,UER_KF=uer_kf,DER_KF=der_kf                     &amp; <a name='983'>
               ,TIMEC_KF=timec_kf,KF_EDRATES=kf_edrates         &amp; <a name='984'>
               ,ZOL=zol,WSTAR=wstar,UST=ust,PBLH=pblh           )  <font color=#447700>!ckay<a name='985'></font>
#endif<a name='986'>
<a name='987'>
     CASE (GDSCHEME)<a name='988'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_542">(100,'in grelldrv')<a name='989'>
          CALL GRELLDRV(                                        &amp;<a name='990'>
                DT=dt, ITIMESTEP=itimestep, DX=dx               &amp;<a name='991'>
               ,U=u,V=v,T=t,W=w ,RHO=rho                        &amp;<a name='992'>
               ,P=p,PI=pi ,Q=qv_curr ,RAINCV=raincv             &amp;<a name='993'>
               ,DZ8W=dz8w,P8W=p8w,XLV=xlv,CP=cp,G=g,R_V=r_v     &amp;<a name='994'>
               ,PRATEC=tmppratec                                &amp;<a name='995'>
               ,APR_GR=apr_gr,APR_W=apr_w,APR_MC=apr_mc         &amp;<a name='996'>
               ,APR_ST=apr_st,APR_AS=apr_as                     &amp;<a name='997'>
               ,APR_CAPMA=apr_capma,APR_CAPME=apr_capme         &amp;<a name='998'>
               ,APR_CAPMI=apr_capmi,MASS_FLUX=mass_flux         &amp;<a name='999'>
               ,XF_ENS=xf_ens,PR_ENS=pr_ens,HT=ht               &amp;<a name='1000'>
               ,xland=xland,gsw=gsw                             &amp;<a name='1001'>
               ,GDC=gd_cloud,GDC2=gd_cloud2 &amp;<a name='1002'>
               ,ENSDIM=ensdim,MAXIENS=maxiens,MAXENS=maxens     &amp;<a name='1003'>
               ,MAXENS2=maxens2,MAXENS3=maxens3                 &amp;<a name='1004'>
               ,htop=htop,hbot=hbot                             &amp;<a name='1005'>
               ,ktop_deep=ktop_deep                             &amp;<a name='1006'>
               ,CU_ACT_FLAG=CU_ACT_FLAG,warm_rain=warm_rain     &amp;<a name='1007'>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='1008'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='1009'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='1010'>
               ,PERIODIC_X=periodic_x,PERIODIC_Y=periodic_y     &amp;<a name='1011'>
              <font color=#447700>! optionals<a name='1012'></font>
#if (NMM_CORE == 1 )<a name='1013'>
               ,RTHCUTEN=RTHCUTEN ,RTHFTEN=forcet               &amp;<a name='1014'>
               ,RQICUTEN=RQICUTEN ,RQVFTEN=forceq               &amp;<a name='1015'>
#else<a name='1016'>
               ,RTHCUTEN=RTHCUTEN ,RTHFTEN=RTHFTEN              &amp;<a name='1017'>
               ,RQICUTEN=RQICUTEN ,RQVFTEN=RQVFTEN              &amp;<a name='1018'>
#endif<a name='1019'>
               ,RTHRATEN=RTHRATEN,RTHBLTEN=RTHBLTEN             &amp;<a name='1020'>
               ,RQVCUTEN=RQVCUTEN,RQCCUTEN=RQCCUTEN             &amp;<a name='1021'>
               ,RQVBLTEN=RQVBLTEN                               &amp;<a name='1022'>
               ,F_QV=f_qv,F_QC=f_qc,F_QR=f_qr                   &amp;<a name='1023'>
               ,F_QI=f_qi,F_QS=f_qs                             &amp;<a name='1024'>
               ,CFU1=CFU1,CFD1=CFD1,DFU1=DFU1,EFU1=EFU1         &amp;<a name='1025'>
               ,DFD1=DFD1,EFD1=EFD1,f_flux=l_flux               )<a name='1026'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_543">(200,'back from grelldrv')<a name='1027'>
<a name='1028'>
     CASE (SASSCHEME)<a name='1029'>
                                                                                                                                           <a name='1030'>
          IF ( adapt_step_flag_pass ) THEN<a name='1031'>
            WRITE( wrf_err_message , * ) 'The SAS cumulus option will not work properly with an adaptive time step'<a name='1032'>
            CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_617"> ( wrf_err_message )<a name='1033'>
          END IF<a name='1034'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_544">(100,'in cu_sas')<a name='1035'>
          CALL <A href='../../html_code/phys/module_cu_sas.F.html#CU_SAS'>CU_SAS</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CU_SAS_1">(                                          &amp;<a name='1036'>
                DT=dt,ITIMESTEP=itimestep,STEPCU=STEPCU         &amp;<a name='1037'>
               ,RTHCUTEN=RTHCUTEN,RQVCUTEN=RQVCUTEN             &amp;<a name='1038'>
               ,RQCCUTEN=RQCCUTEN,RQICUTEN=RQICUTEN             &amp;<a name='1039'>
               ,RUCUTEN=RUCUTEN, RVCUTEN=RVCUTEN                &amp;<a name='1040'>
               ,RAINCV=RAINCV,PRATEC=tmpPRATEC,HTOP=HTOP,HBOT=HBOT &amp;<a name='1041'>
               ,U3D=u,V3D=v,W=w,T3D=t                           &amp;<a name='1042'>
               ,QV3D=QV_CURR,QC3D=QC_CURR,QI3D=QI_CURR          &amp;<a name='1043'>
               ,PI3D=pi,RHO3D=rho                               &amp;<a name='1044'>
               ,DZ8W=dz8w,PCPS=p,P8W=p8w,XLAND=XLAND            &amp;<a name='1045'>
               ,CU_ACT_FLAG=CU_ACT_FLAG                         &amp;<a name='1046'>
               ,P_QC=p_qc                                       &amp;<a name='1047'>
               ,MOMMIX=MOMMIX  &amp;<a name='1048'>
               ,pgcon=pgcon,sas_mass_flux=sas_mass_flux         &amp;<a name='1049'>
               ,pert_sas=pert_sas,ens_random_seed=ens_random_seed   &amp;<a name='1050'>
               ,ens_sasamp=ens_sasamp &amp;<a name='1051'>
               ,shalconv=shalconv,shal_pgcon=shal_pgcon         &amp;<a name='1052'>
               ,hpbl2d=hpbl2d,evap2d=evap2d,heat2d=heat2d       &amp;<a name='1053'>
               ,P_QI=p_qi,P_FIRST_SCALAR=param_first_scalar     &amp;<a name='1054'>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='1055'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='1056'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='1057'>
                                                                )<a name='1058'>
     CASE (SCALESASSCHEME)   <font color=#447700>! 2015-12-11 added to call scale-aware SAS<a name='1059'></font>
<a name='1060'>
          IF ( adapt_step_flag_pass ) THEN<a name='1061'>
            WRITE( wrf_err_message , * ) 'The SCALE-AWARE SAS cumulus option will not work properly with an adaptive time step'<a name='1062'>
            CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_618"> ( wrf_err_message )<a name='1063'>
          END IF<a name='1064'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_545">(100,'in cu_scalesas')<a name='1065'>
          CALL <A href='../../html_code/phys/module_cu_scalesas.F.html#CU_SCALESAS'>CU_SCALESAS</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CU_SCALESAS_1">(                                     &amp;<a name='1066'>
                DT=dt,ITIMESTEP=itimestep,STEPCU=STEPCU         &amp;<a name='1067'>
               ,RTHCUTEN=RTHCUTEN,RQVCUTEN=RQVCUTEN             &amp;<a name='1068'>
               ,RQCCUTEN=RQCCUTEN,RQICUTEN=RQICUTEN             &amp;<a name='1069'>
               ,RUCUTEN=RUCUTEN, RVCUTEN=RVCUTEN                &amp;<a name='1070'>
               ,RAINCV=RAINCV,PRATEC=tmpPRATEC,HTOP=HTOP,HBOT=HBOT &amp;<a name='1071'>
               ,U3D=u,V3D=v,W=w,T3D=t                           &amp;<a name='1072'>
               ,QV3D=QV_CURR,QC3D=QC_CURR,QI3D=QI_CURR          &amp;<a name='1073'>
               ,PI3D=pi,RHO3D=rho                               &amp;<a name='1074'>
               ,DZ8W=dz8w,PCPS=p,P8W=p8w,XLAND=XLAND            &amp;<a name='1075'>
               ,CU_ACT_FLAG=CU_ACT_FLAG                         &amp;<a name='1076'>
               ,P_QC=p_qc                                       &amp;<a name='1077'>
               ,MOMMIX=MOMMIX  &amp;<a name='1078'>
               ,pgcon=pgcon,sas_mass_flux=sas_mass_flux         &amp;<a name='1079'>
               ,shalconv=shalconv,shal_pgcon=shal_pgcon         &amp;<a name='1080'>
               ,hpbl2d=hpbl2d,evap2d=evap2d,heat2d=heat2d       &amp;<a name='1081'>
               ,P_QI=p_qi,P_FIRST_SCALAR=param_first_scalar     &amp;<a name='1082'>
               ,DX2D=dx2d,DY=dynmm                              &amp; <font color=#447700>! 2 new <a name='1083'></font>
               ,SCALEFUN=SCALEFUN,SCALEFUN1=SCALEFUN1           &amp; <font color=#447700>! CNV scale functions<a name='1084'></font>
               ,SIGMU=SIGMU,SIGMU1=SIGMU1                       &amp; <font color=#447700>! CNV updraft fractions<a name='1085'></font>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='1086'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='1087'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='1088'>
                                                                )<a name='1089'>
     CASE (OSASSCHEME)<a name='1090'>
                                                                                                                                           <a name='1091'>
          IF ( adapt_step_flag_pass ) THEN<a name='1092'>
            WRITE( wrf_err_message , * ) 'The SAS cumulus option will not work properly with an adaptive time step'<a name='1093'>
            CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_619"> ( wrf_err_message )<a name='1094'>
          END IF<a name='1095'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_546">(100,'in cu_osas')<a name='1096'>
          CALL <A href='../../html_code/phys/module_cu_osas.F.html#CU_OSAS'>CU_OSAS</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CU_OSAS_1">(                                          &amp;<a name='1097'>
                DT=dt,ITIMESTEP=itimestep,STEPCU=STEPCU         &amp;<a name='1098'>
               ,RTHCUTEN=RTHCUTEN,RQVCUTEN=RQVCUTEN             &amp;<a name='1099'>
               ,RQCCUTEN=RQCCUTEN,RQICUTEN=RQICUTEN             &amp;<a name='1100'>
               ,RUCUTEN=RUCUTEN, RVCUTEN=RVCUTEN                &amp;<a name='1101'>
               ,RAINCV=RAINCV,PRATEC=tmpPRATEC,HTOP=HTOP,HBOT=HBOT &amp;<a name='1102'>
               ,U3D=u,V3D=v,W=w,T3D=t                           &amp;<a name='1103'>
               ,QV3D=QV_CURR,QC3D=QC_CURR,QI3D=QI_CURR          &amp;<a name='1104'>
               ,PI3D=pi,RHO3D=rho                               &amp;<a name='1105'>
               ,DZ8W=dz8w,PCPS=p,P8W=p8w,XLAND=XLAND            &amp;<a name='1106'>
               ,CU_ACT_FLAG=CU_ACT_FLAG                         &amp;<a name='1107'>
               ,P_QC=p_qc                                       &amp;<a name='1108'>
               ,store_rand=store_rand  &amp;<a name='1109'>
               ,MOMMIX=MOMMIX  &amp;<a name='1110'>
               ,P_QI=p_qi,P_FIRST_SCALAR=param_first_scalar     &amp;<a name='1111'>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='1112'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='1113'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='1114'>
                                                                )<a name='1115'>
     CASE (G3SCHEME)<a name='1116'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_547">(100,'in grelldrv')<a name='1117'>
#if ( WRF_DFI_RADAR == 1 )<a name='1118'>
          if (do_capsuppress == 1) then<a name='1119'>
            WRITE( wrf_err_message , * ) 'G3 do CAP suppress',its,jts,min( jte,jde-1 ),min( ite,ide-1 ),kte<a name='1120'>
            CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_548">(200, wrf_err_message)<a name='1121'>
            DO j = jts, min( jte,jde-1 )<a name='1122'>
            DO i = its, min( ite,ide-1 )<a name='1123'>
               cap_suppress_loc(i,j) = grid%dfi_tten_rad(i,kte,j)<a name='1124'>
            ENDDO<a name='1125'>
            ENDDO<a name='1126'>
         endif<a name='1127'>
#endif<a name='1128'>
          CALL <A href='../../html_code/phys/module_cu_g3.F.html#G3DRV'>G3DRV</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="G3DRV_1">(                                           &amp;<a name='1129'>
                DT=dt, ITIMESTEP=itimestep, DX=dx               &amp;<a name='1130'>
               ,U=u,V=v,T=t,W=w ,RHO=rho                        &amp;<a name='1131'>
               ,P=p,PI=pi,Q=qv_curr,RAINCV=raincv               &amp;<a name='1132'>
               ,DZ8W=dz8w ,P8W=p8w,XLV=xlv,CP=cp,G=g,R_V=r_v    &amp;<a name='1133'>
               ,APR_GR=apr_gr,APR_W=apr_w,APR_MC=apr_mc         &amp;<a name='1134'>
               ,APR_ST=apr_st,APR_AS=apr_as,PRATEC=tmppratec    &amp;<a name='1135'>
               ,APR_CAPMA=apr_capma,APR_CAPME=apr_capme         &amp;<a name='1136'>
               ,APR_CAPMI=apr_capmi,MASS_FLUX=mass_flux         &amp;<a name='1137'>
               ,XF_ENS=xf_ens,PR_ENS=pr_ens,HT=ht               &amp;<a name='1138'>
               ,xland=xland,gsw=gsw,edt_out=edt_out             &amp;<a name='1139'>
               ,GDC=gd_cloud,GDC2=gd_cloud2,kpbl=kpbl           &amp;<a name='1140'>
               ,k22_shallow=k22_shallow                         &amp;<a name='1141'>
               ,kbcon_shallow=kbcon_shallow                     &amp;<a name='1142'>
               ,ktop_shallow=ktop_shallow                       &amp;<a name='1143'>
               ,xmb_shallow=xmb_shallow                         &amp;<a name='1144'>
               ,ktop_deep=ktop_deep                             &amp;<a name='1145'>
               ,cugd_tten=cugd_tten,cugd_qvten=cugd_qvten       &amp;<a name='1146'>
               ,cugd_ttens=cugd_ttens,cugd_qvtens=cugd_qvtens   &amp;<a name='1147'>
               ,cugd_qcten=cugd_qcten,cugd_avedx=cugd_avedx     &amp;<a name='1148'>
               ,imomentum=imomentum,ishallow_g3=ishallow        &amp;<a name='1149'>
               ,ENSDIM=ensdim,MAXIENS=maxiens,MAXENS=maxens     &amp;<a name='1150'>
               ,MAXENS2=maxens2,MAXENS3=maxens3,ichoice=clos_choice &amp;<a name='1151'>
               ,htop=htop,hbot=hbot                             &amp;<a name='1152'>
               ,CU_ACT_FLAG=CU_ACT_FLAG,warm_rain=warm_rain     &amp;<a name='1153'>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='1154'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='1155'>
               ,IPS=ips,IPE=ipe,JPS=jps,JPE=jpe,KPS=kps,KPE=kpe &amp;<a name='1156'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='1157'>
               ,PERIODIC_X=periodic_x,PERIODIC_Y=periodic_y     &amp;<a name='1158'>
              <font color=#447700>! optionals<a name='1159'></font>
#if (NMM_CORE == 1 )<a name='1160'>
               ,RTHCUTEN=RTHCUTEN ,RTHFTEN=forcet               &amp;<a name='1161'>
               ,RQICUTEN=RQICUTEN ,RQVFTEN=forceq               &amp;<a name='1162'>
#else<a name='1163'>
               ,RTHCUTEN=RTHCUTEN ,RTHFTEN=RTHFTEN              &amp;<a name='1164'>
               ,RQICUTEN=RQICUTEN ,RQVFTEN=RQVFTEN              &amp;<a name='1165'>
               ,rqvblten=rqvblten,rthblten=rthblten             &amp;<a name='1166'>
#endif<a name='1167'>
               ,RQVCUTEN=RQVCUTEN,RQCCUTEN=RQCCUTEN             &amp;<a name='1168'>
               ,F_QV=f_qv,F_QC=f_qc,F_QR=f_qr                   &amp;<a name='1169'>
               ,F_QI=f_qi,F_QS=f_qs                             &amp;<a name='1170'>
#if ( WRF_DFI_RADAR == 1 )<a name='1171'>
                 <font color=#447700>! Optional CAP suppress option<a name='1172'></font>
              ,do_capsuppress=do_capsuppress                    &amp;<a name='1173'>
              ,cap_suppress_loc=cap_suppress_loc                &amp;<a name='1174'>
#endif                                 <a name='1175'>
                                                                )<a name='1176'>
     CASE (GFSCHEME)<a name='1177'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_549">(100,'in grelldrv')<a name='1178'>
#if ( WRF_DFI_RADAR == 1 )<a name='1179'>
          if (do_capsuppress == 1) then<a name='1180'>
            WRITE( wrf_err_message , * ) 'G3 do CAP suppress',its,jts,min( jte,jde-1 ),min( ite,ide-1 ),kte<a name='1181'>
            CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_550">(200, wrf_err_message)<a name='1182'>
            DO j = jts, min( jte,jde-1 )<a name='1183'>
            DO i = its, min( ite,ide-1 )<a name='1184'>
               cap_suppress_loc(i,j) = grid%dfi_tten_rad(i,kte,j)<a name='1185'>
            ENDDO<a name='1186'>
            ENDDO<a name='1187'>
         endif<a name='1188'>
#endif<a name='1189'>
<a name='1190'>
         CALL <A href='../../html_code/phys/module_cu_gf_wrfdrv.F.html#GFDRV'>GFDRV</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GFDRV_1">(spp_conv,pattern_spp_conv,field_conv,       &amp;<a name='1191'>
                DT=dt,DX=dx                                     &amp;<a name='1192'>
               ,RHO=rho,RAINCV=raincv,PRATEC=tmppratec          &amp;<a name='1193'>
               ,U=u,V=v,T=t,W=w,Q=qv_curr,P=p,PI=pi             &amp;<a name='1194'>
               ,DZ8W=dz8w ,P8W=p8w                              &amp;<a name='1195'>
               ,htop=htop,hbot=hbot,ktop_deep=ktop_deep         &amp;<a name='1196'>
               ,HT=ht,hfx=hfx,qfx=qfx,xland=xland               &amp;<a name='1197'>
               ,GDC=gd_cloud,GDC2=gd_cloud2,kpbl=kpbl           &amp;<a name='1198'>
               ,k22_shallow=k22_shallow                         &amp;<a name='1199'>
               ,kbcon_shallow=kbcon_shallow                     &amp;<a name='1200'>
               ,ktop_shallow=ktop_shallow                       &amp;<a name='1201'>
               ,xmb_shallow=xmb_shallow                         &amp;<a name='1202'>
               ,ichoice=clos_choice,ishallow_g3=ishallow        &amp;<a name='1203'>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='1204'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='1205'>
<font color=#447700>!              ,IPS=ips,IPE=ipe,JPS=jps,JPE=jpe,KPS=kps,KPE=kpe &amp;<a name='1206'></font>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='1207'>
               ,PERIODIC_X=periodic_x,PERIODIC_Y=periodic_y     &amp;<a name='1208'>
              <font color=#447700>! optionals<a name='1209'></font>
#if (NMM_CORE == 1 ) <a name='1210'>
               ,RTHCUTEN=RTHCUTEN ,RTHFTEN=forcet               &amp;<a name='1211'>
               ,RTHRATEN=RTHRATEN                               &amp;<a name='1212'>
               ,RQICUTEN=RQICUTEN ,RQVFTEN=forceq               &amp;<a name='1213'>
#else<a name='1214'>
               ,RTHCUTEN=RTHCUTEN ,RTHFTEN=RTHFTEN              &amp;<a name='1215'>
               ,RTHRATEN=RTHRATEN                               &amp;<a name='1216'>
               ,RQICUTEN=RQICUTEN ,RQVFTEN=RQVFTEN              &amp;<a name='1217'>
               ,rqvblten=rqvblten,rthblten=rthblten             &amp;<a name='1218'>
#endif<a name='1219'>
               ,RQVCUTEN=RQVCUTEN,RQCCUTEN=RQCCUTEN             &amp;<a name='1220'>
               ,dudt_phy=rucuten, dvdt_phy=rvcuten              &amp;<a name='1221'>
#if ( WRF_DFI_RADAR == 1 )<a name='1222'>
                 <font color=#447700>! Optional CAP suppress option<a name='1223'></font>
               ,do_capsuppress=do_capsuppress                   &amp;<a name='1224'>
               ,cap_suppress_loc=cap_suppress_loc               &amp;<a name='1225'>
#endif <a name='1226'>
                                                                )<a name='1227'>
     CASE (CAMZMSCHEME)<a name='1228'>
          IF (PRESENT(z_at_w) .AND. PRESENT(mavail)                 &amp;<a name='1229'>
                 .AND. PRESENT(pblh) .AND. PRESENT(psfc).AND.PRESENT(RQCNCUTEN))THEN<a name='1230'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_551">(100,'in camzm_cps')<a name='1231'>
      IF(.not.f_qi)THEN<a name='1232'>
         WRITE( wrf_err_message , * ) 'This cumulus option requires ice microphysics option: f_qi = ', f_qi<a name='1233'>
         CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_620"> ( wrf_err_message )<a name='1234'>
      ENDIF<a name='1235'>
          CALL <A href='../../html_code/phys/module_cu_camzm_driver.F.html#CAMZM_DRIVER'>CAMZM_DRIVER</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CAMZM_DRIVER_1">(                                        &amp;<a name='1236'>
                IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde     &amp;<a name='1237'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme     &amp;<a name='1238'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte     &amp;<a name='1239'>
               ,ITIMESTEP=itimestep, BL_PBL_PHYSICS=bl_pbl_physics  &amp;<a name='1240'>
               ,SF_SFCLAY_PHYSICS=sf_sfclay_physics                 &amp;<a name='1241'>
               ,TH=th, T_PHY=t, TSK=tsk, TKE_PBL=tke_pbl            &amp;<a name='1242'>
               ,UST=ust, QV=qv_curr, QC=qc_curr, QI=qi_curr         &amp;<a name='1243'>
               ,MAVAIL=mavail,KPBL=kpbl, PBLH=pblh, XLAND=xland     &amp; <a name='1244'>
               ,Z=z, Z_AT_W=z_at_w                                  &amp;<a name='1245'>
               ,DZ8W=dz8w, HT=ht                                    &amp;<a name='1246'>
               ,P=p, P8W=p8w, PI_PHY=pi, PSFC=psfc                  &amp;<a name='1247'>
               ,U_PHY=u, V_PHY=v, HFX=hfx, QFX=qfx, CLDFRA=cldfra   &amp;<a name='1248'>
               ,CLDFRA_MP_ALL=cldfra_mp_all                         &amp;<a name='1249'>
               ,IS_CAMMGMP_USED=is_CAMMGMP_used                     &amp;<a name='1250'>
               ,TPERT_CAMUWPBL=tpert2d                              &amp;<a name='1251'>
               ,DX=dx, DT=dt, STEPCU=stepcu, CUDT=cudt              &amp;<a name='1252'>
               ,CURR_SECS=curr_secs                                 &amp;<a name='1253'>
               ,ADAPT_STEP_FLAG=adapt_step_flag                     &amp;<a name='1254'>
               ,CUDTACTTIME=cudtacttime_pass                        &amp; <a name='1255'>
               ,CAPE_OUT=cape                                       &amp;<a name='1256'>
               ,MU_OUT=zmmu, MD_OUT=zmmd                            &amp;<a name='1257'>
               ,ZMDT=zmdt, ZMDQ=zmdq, DLF_OUT=dlf, RLIQ_OUT=rliq    &amp;<a name='1258'>
               ,PCONVT=pconvt, PCONVB=pconvb, CUBOT=hbot, CUTOP=htop&amp;<a name='1259'>
               ,RAINCV=raincv, PRATEC=tmppratec                     &amp;<a name='1260'>
               ,RUCUTEN=rucuten, RVCUTEN=rvcuten                    &amp;<a name='1261'>
               ,RTHCUTEN=rthcuten, RQVCUTEN=rqvcuten                &amp;<a name='1262'>
               ,RQCCUTEN=rqccuten, RQICUTEN=rqicuten                &amp;<a name='1263'>
               ,RQCNCUTEN=rqcncuten, RQINCUTEN=rqincuten            &amp;<a name='1264'>
               ,EVAPTZM=evaptzm, FZSNTZM=fzsntzm, EVSNTZM=evsntzm   &amp;<a name='1265'>
               ,EVAPQZM=evapqzm, ZMFLXPRC=zmflxprc                  &amp;<a name='1266'>
               ,ZMFLXSNW=zmflxsnw, ZMNTPRPD=zmntprpd                &amp;<a name='1267'>
               ,ZMNTSNPD=zmntsnpd, ZMEIHEAT=zmeiheat                &amp;<a name='1268'>
               ,CMFMC=cmfmc, CMFMCDZM=cmfmcdzm                      &amp;<a name='1269'>
               ,PRECCDZM=preccdzm, PRECZ=precz                      &amp;<a name='1270'>
               ,ZMMTU=zmmtu, ZMMTV=zmmtv, ZMUPGU=zmupgu             &amp;<a name='1271'>
               ,ZMUPGD=zmupgd, ZMVPGU=zmvpgu, ZMVPGD=zmvpgd         &amp;<a name='1272'>
               ,ZMICUU=zmicuu, ZMICUD=zmicud, ZMICVU=zmicvu         &amp;<a name='1273'>
               ,ZMICVD=zmicvd, ZMDICE=zmdice, ZMDLIQ=zmdliq         &amp;<a name='1274'>
               ,EVAPCDP3D=evapcdp3d, ICWMRDP3D=icwmrdp3d            &amp;<a name='1275'>
               ,RPRDDP3D=rprddp3d,DP3D=dp3d, DU3D=du3d, ED3D=ed3d   &amp;<a name='1276'>
               ,EU3D=eu3d, MD3D=md3d, MU3D=mu3d,DSUBCLD2D=dsubcld2d &amp;<a name='1277'>
               ,IDEEP2D=ideep2d, JT2D=jt2d, MAXG2D=maxg2d           &amp;<a name='1278'>
               ,LENGATH2D=lengath2d                                 )<a name='1279'>
        ELSE<a name='1280'>
             WRITE( wrf_err_message , * ) 'Insufficient arguments to call CAMZM cu scheme'<a name='1281'>
             CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_621"> ( wrf_err_message )<a name='1282'>
          ENDIF<a name='1283'>
<a name='1284'>
<font color=#447700>! TIEDTKE SCHEME - ZCX&amp;YQW (U of Hawaii)<a name='1285'></font>
     CASE (TIEDTKESCHEME)<a name='1286'>
<a name='1287'>
        IF ( PRESENT ( QFX ) .AND. PRESENT( ZNU ) ) THEN<a name='1288'>
<a name='1289'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_552">(100,'in cu_tiedtke')<a name='1290'>
          CALL <A href='../../html_code/phys/module_cu_tiedtke.F.html#CU_TIEDTKE'>CU_TIEDTKE</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CU_TIEDTKE_1">(                                      &amp;<a name='1291'>
                DT=dt,ITIMESTEP=itimestep,STEPCU=STEPCU         &amp;<a name='1292'>
               ,RAINCV=RAINCV,PRATEC=tmppratec,QFX=qfx,ZNU=znu  &amp;<a name='1293'>
               ,U3D=u,V3D=v,W=w,T3D=t,PI3D=pi,RHO3D=rho         &amp;<a name='1294'>
               ,QV3D=QV_CURR,QC3D=QC_CURR,QI3D=QI_CURR          &amp;<a name='1295'>
               ,QVPBLTEN=RQVBLTEN                               &amp;<a name='1296'>
               ,DZ8W=dz8w,PCPS=p,P8W=p8w,XLAND=XLAND            &amp;<a name='1297'>
               ,CU_ACT_FLAG=CU_ACT_FLAG                         &amp;<a name='1298'>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='1299'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='1300'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='1301'>
              <font color=#447700>! optionals<a name='1302'></font>
#if (NMM_CORE == 1 )<a name='1303'>
               ,QVFTEN=FORCEQ                                   &amp;<a name='1304'>
#else<a name='1305'>
               ,QVFTEN=RQVFTEN                                  &amp;<a name='1306'>
#endif<a name='1307'>
               ,RTHCUTEN=RTHCUTEN,RQVCUTEN=RQVCUTEN             &amp;<a name='1308'>
               ,RQCCUTEN=RQCCUTEN,RQICUTEN=RQICUTEN             &amp;<a name='1309'>
               ,RUCUTEN = RUCUTEN,RVCUTEN = RVCUTEN             &amp;<a name='1310'>
               ,F_QV=f_qv,F_QC=f_qc,F_QR=f_qr                   &amp;<a name='1311'>
               ,F_QI=f_qi,F_QS=f_qs                             &amp;<a name='1312'>
                                                             )<a name='1313'>
        ELSE<a name='1314'>
          CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_622">('Lacking arguments for CU_TIEDTKE in cumulus driver')<a name='1315'>
        ENDIF<a name='1316'>
<a name='1317'>
<font color=#447700>! NEW TIEDTKE SCHEME - ZCX&amp;YQW (U of Hawaii)<a name='1318'></font>
     CASE (NTIEDTKESCHEME)<a name='1319'>
<a name='1320'>
        IF ( PRESENT ( QFX ) .AND. PRESENT( HFX )) THEN<a name='1321'>
<a name='1322'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_553">(100,'in cu_ntiedtke')<a name='1323'>
          CALL <A href='../../html_code/phys/module_cu_ntiedtke.F.html#CU_NTIEDTKE'>CU_NTIEDTKE</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CU_NTIEDTKE_1">(                                      &amp;<a name='1324'>
                DT=dt,ITIMESTEP=itimestep,STEPCU=STEPCU,HFX=hfx  &amp;<a name='1325'>
               ,RAINCV=RAINCV,PRATEC=tmppratec,QFX=qfx          &amp;<a name='1326'>
               ,U3D=u,V3D=v,W=w,T3D=t,PI3D=pi,RHO3D=rho         &amp;<a name='1327'>
               ,QV3D=QV_CURR,QC3D=QC_CURR,QI3D=QI_CURR          &amp;<a name='1328'>
               ,DZ8W=dz8w,PCPS=p,P8W=p8w,XLAND=XLAND,DX=dx      &amp;<a name='1329'>
               ,CU_ACT_FLAG=CU_ACT_FLAG                         &amp;<a name='1330'>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='1331'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='1332'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='1333'>
              <font color=#447700>! optionals<a name='1334'></font>
#if (NMM_CORE == 1 )<a name='1335'>
               ,QVFTEN=FORCEQ, THFTEN=FORCET                    &amp;<a name='1336'>
#else<a name='1337'>
               ,QVFTEN=RQVFTEN,THFTEN=RTHFTEN                   &amp;<a name='1338'>
#endif<a name='1339'>
               ,RTHCUTEN=RTHCUTEN,RQVCUTEN=RQVCUTEN             &amp;<a name='1340'>
               ,RQCCUTEN=RQCCUTEN,RQICUTEN=RQICUTEN             &amp;<a name='1341'>
               ,RUCUTEN = RUCUTEN,RVCUTEN = RVCUTEN             &amp;<a name='1342'>
               ,F_QV=f_qv,F_QC=f_qc,F_QR=f_qr                   &amp;<a name='1343'>
               ,F_QI=f_qi,F_QS=f_qs                             &amp;<a name='1344'>
                                                             )<a name='1345'>
        ELSE<a name='1346'>
          CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_623">('Lacking arguments for CU_NTIEDTKE in cumulus driver')<a name='1347'>
        ENDIF<a name='1348'>
<a name='1349'>
<font color=#447700>! New GFS SAS SCHEME - (Yonsei Univ., South Korea)<a name='1350'></font>
     CASE (NSASSCHEME)<a name='1351'>
        IF ( PRESENT ( QFX ) .AND. PRESENT( HFX ) ) THEN<a name='1352'>
          CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_554">(100,'in nsas_cps')<a name='1353'>
          CALL <A href='../../html_code/phys/module_cu_nsas.F.html#CU_NSAS'>CU_NSAS</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CU_NSAS_1">(                                         &amp;<a name='1354'>
                DT=dt,DX=dx,P3DI=p8w,P3D=p,PI3D=pi,             &amp;<a name='1355'>
                QC3D=QC_CURR,QI3D=QI_CURR,RHO3D=rho,            &amp;<a name='1356'>
                ITIMESTEP=itimestep,STEPCU=STEPCU,              &amp;<a name='1357'>
                HBOT=HBOT,HTOP=HTOP,                            &amp;<a name='1358'>
                CU_ACT_FLAG=CU_ACT_FLAG,                        &amp;<a name='1359'>
                RTHCUTEN=RTHCUTEN,RQVCUTEN=RQVCUTEN,            &amp;<a name='1360'>
                RQCCUTEN=RQCCUTEN,RQICUTEN=RQICUTEN,            &amp;<a name='1361'>
                RUCUTEN=RUCUTEN,RVCUTEN=RVCUTEN,                &amp;<a name='1362'>
                QV3D=QV_CURR,T3D=t,                             &amp;<a name='1363'>
                RAINCV=RAINCV,PRATEC=tmpPRATEC,                 &amp;<a name='1364'>
                XLAND=XLAND,DZ8W=dz8w,W=w,U3D=u,V3D=v,          &amp;<a name='1365'>
                HPBL=pblh,HFX=hfx,QFX=qfx,                      &amp; <a name='1366'>
                MP_PHYSICS=mp_physics,                          &amp; <a name='1367'>
                DX_FACTOR_NSAS=dx_factor_nsas,                  &amp; <a name='1368'>
                pgcon=pgcon,                                    &amp;<a name='1369'>
                P_QC=p_qc,P_QI=p_qi,                            &amp;<a name='1370'>
                P_FIRST_SCALAR=param_first_scalar               &amp;<a name='1371'>
               ,CP=cp,CLIQ=cliq,CPV=cpv,G=g,XLV=xlv,R_D=r_d     &amp;<a name='1372'>
               ,R_V=r_v,EP_1=ep_1,EP_2=EP_2                     &amp;<a name='1373'>
               ,CICE=cice,XLS=xls,PSAT=psat                     &amp;<a name='1374'>
               ,F_QI=f_qi,F_QC=f_qc                             &amp; <a name='1375'>
               ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde &amp;<a name='1376'>
               ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme &amp;<a name='1377'>
               ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte &amp;<a name='1378'>
                                                                )<a name='1379'>
        ELSE<a name='1380'>
          CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_624">('Lacking arguments for CU_NSAS in cumulus driver')<a name='1381'>
        ENDIF<a name='1382'>
#if (EM_CORE == 1)<a name='1383'>
        <font color=#447700>!BSINGH -  For WRFCuP scheme<a name='1384'></font>
     CASE (KFCUPSCHEME)<a name='1385'>
        <a name='1386'>
        CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_555">(100,'in cu_kfcup')        <a name='1387'>
        CALL <A href='../../html_code/phys/module_cu_kfcup.F.html#KF_CUP_CPS'>KF_CUP_CPS</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="KF_CUP_CPS_1">( GRID_ID=grid%grid_id                        &amp; <font color=#447700>!rce 10-may-2012 add grid%id<a name='1388'></font>
             ,U=u ,V=v ,TH=th ,T=t ,W=w ,RHO=rho                &amp;<a name='1389'>
             ,RAINCV=raincv,NCA=nca ,DZ8W=dz8w,XLAND=xland      &amp; <font color=#447700>!LD add PRATEC 21-Apr-2011<a name='1390'></font>
             ,PCPS=p, PI=pi ,W0AVG=W0AVG                        &amp;<a name='1391'>
             ,CUTOP=HTOP,CUBOT=HBOT                             &amp;<a name='1392'>
             ,XLV0=XLV0 ,XLV1=XLV1 ,XLS0=XLS0 ,XLS1=XLS1        &amp;<a name='1393'>
             ,CP=CP ,R=R_d ,G=G ,EP1=EP_1 ,EP2=EP_2             &amp;<a name='1394'>
             ,SVP1=SVP1 ,SVP2=SVP2 ,SVP3=SVP3 ,SVPT0=SVPT0      &amp;<a name='1395'>
             ,DT=dt ,KTAU=itimestep ,DX=dx                      &amp;<a name='1396'>
             ,STEPCU=stepcu                                     &amp;<a name='1397'>
             ,CU_ACT_FLAG=cu_act_flag ,warm_rain=warm_rain      &amp;<a name='1398'>
             ,QV=qv_curr                                        &amp;<a name='1399'>
             ,IDS=ids,IDE=ide,JDS=jds,JDE=jde,KDS=kds,KDE=kde   &amp;<a name='1400'>
             ,IMS=ims,IME=ime,JMS=jms,JME=jme,KMS=kms,KME=kme   &amp;<a name='1401'>
             ,ITS=its,ITE=ite,JTS=jts,JTE=jte,KTS=kts,KTE=kte   &amp;<a name='1402'>
             ,PSFC=psfc,Z=z,Z_AT_W=z_at_w,HT=ht,TSK=tsk         &amp; <font color=#447700>!CuP, wig 5-Oct-2006<a name='1403'></font>
             ,HFX=hfx,QFX=qfx                                   &amp; <font color=#447700>!CuP, wig, 24-Aug-2006<a name='1404'></font>
             ,MAVAIL=mavail,SF_SFCLAY_PHYSICS=sf_sfclay_physics &amp; <font color=#447700>!CuP, wig, 24-Aug-2006<a name='1405'></font>
             ,BR=br,REGIME=regime,PBLH=pblh,KPBL=kpbl           &amp; <font color=#447700>!CuP, wig, 24-Aug-2006<a name='1406'></font>
             ,T2=t2,Q2=q2                                       &amp; <font color=#447700>!CuP, wig, 24-Aug-2006<a name='1407'></font>
             ,SLOPESFC=slopeSfc,SLOPEEZ=slopeEZ                 &amp; <font color=#447700>!CuP, wig, 24-Aug-2006<a name='1408'></font>
             ,SIGMASFC=sigmasfc,SIGMAEZ=sigmaEZ                 &amp; <font color=#447700>!CuP, wig, 24-Aug-2006<a name='1409'></font>
             ,CUPFLAG=cupflag,CLDFRA_CUP=cldfra_cup             &amp; <font color=#447700>!CuP, wig, 18-Sep-2006<a name='1410'></font>
             ,CLDFRATEND_CUP=cldfratend_cup                     &amp; <font color=#447700>!CuP, wig, 18-Sep-2006<a name='1411'></font>
             ,SHALL=shall,TAUCLOUD=taucloud,TACTIVE=tactive     &amp; <font color=#447700>!CuP, wig, 18-Sep-2006<a name='1412'></font>
             ,ACTIVEFRAC=activeFrac                             &amp; <font color=#447700>!CuP, lkb, 5-May-2010<a name='1413'></font>
             ,TSTAR=tstar, LNTERMS=lnterms                      &amp; <font color=#447700>!CuP, wig 4-Oct-2006<a name='1414'></font>
             ,LNINT=lnint                                       &amp; <font color=#447700>!CuP, wig 4-Oct-2006<a name='1415'></font>
             ,NUMBINS=numBins                                   &amp; <font color=#447700>!CuP, lkb 4-Nov-2009<a name='1416'></font>
             ,THBINSIZE=thBinSize, RBINSIZE=rBinSize            &amp; <font color=#447700>!CuP, lkb 4-Nov-2009<a name='1417'></font>
             ,MINDEEPFREQ=minDeepFreq, MINSHALLOWFREQ=minShallowFreq  &amp; <font color=#447700>!CuP, lkb 4-Nov-2009<a name='1418'></font>
             ,WCLOUDBASE=wCloudBase                             &amp; <font color=#447700>!CuP, lkb 29-April-2010<a name='1419'></font>
             ,WACT_CUP=wact_cup                                 &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1420'></font>
             ,WULCL_CUP=wulcl_cup                               &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1421'></font>
             ,WUP_CUP=wup_cup                                   &amp; <font color=#447700>!CuP, rce 15-mar-2013 !BSINGH (12/06/2013)<a name='1422'></font>
             ,QC_IC_CUP=qc_ic_cup                               &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1423'></font>
             ,QNDROP_IC_CUP=qndrop_ic_cup                       &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1424'></font>
             ,QC_IU_CUP=qc_iu_cup                               &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1425'></font>
             ,FCVT_QC_TO_PR_CUP=fcvt_qc_to_pr_cup               &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1426'></font>
             ,FCVT_QC_TO_QI_CUP=fcvt_qc_to_qi_cup               &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1427'></font>
             ,FCVT_QI_TO_PR_CUP=fcvt_qi_to_pr_cup               &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1428'></font>
             ,MFUP_CUP=mfup_cup                                 &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1429'></font>
             ,MFUP_ENT_CUP=mfup_ent_cup                         &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1430'></font>
             ,MFDN_CUP=mfdn_cup                                 &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1431'></font>
             ,MFDN_ENT_CUP=mfdn_ent_cup                         &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1432'></font>
             ,UPDFRA_CUP=updfra_cup                             &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1433'></font>
             ,TCLOUD_CUP=tcloud_cup                             &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1434'></font>
             ,SHCU_AEROSOLS_OPT=shcu_aerosols_opt               &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1435'></font>
#if ( WRF_CHEM == 1 )<a name='1436'>
             ,CHEM_OPT=chem_opt                                 &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1437'></font>
             ,CHEM=grid%chem                                    &amp; <font color=#447700>!CuP, rce 10-may-2012<a name='1438'></font>
#endif<a name='1439'>
             <font color=#447700>! optionals<a name='1440'></font>
             ,RTHCUTEN=rthcuten                                 &amp;<a name='1441'>
             ,RQVCUTEN=rqvcuten ,RQCCUTEN=rqccuten              &amp;<a name='1442'>
             ,RQRCUTEN=rqrcuten ,RQICUTEN=rqicuten              &amp;<a name='1443'>
             ,RQSCUTEN=rqscuten                                 &amp;<a name='1444'>
             ,F_QV=f_qv,F_QC=f_qc,F_QR=f_qr                     &amp;<a name='1445'>
             ,F_QI=f_qi,F_QS=f_qs                               &amp;<a name='1446'>
             )<a name='1447'>
        <a name='1448'>
        <a name='1449'>
        DO J = jts,jte<a name='1450'>
           DO I=its,ite<a name='1451'>
              tmppratec(i,j)=raincv(i,j)/DT      <font color=#447700>!!!!!byang, move the pratec after calling cup<a name='1452'></font>
           end do<a name='1453'>
        end do<a name='1454'>
        <font color=#447700>!BSINGH -ENDS<a name='1455'></font>
#endif<a name='1456'>
<a name='1457'>
     CASE DEFAULT <a name='1458'>
<a name='1459'>
         WRITE( wrf_err_message , * ) 'The cumulus option does not exist: cu_physics = ', cu_physics<a name='1460'>
         CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_625"> ( wrf_err_message )<a name='1461'>
<a name='1462'>
   END SELECT cps_select<a name='1463'>
<a name='1464'>
      ENDDO<a name='1465'>
      <font color=#447700>!$OMP END PARALLEL DO<a name='1466'></font>
#if  ( EM_CORE == 1 )<a name='1467'>
   IF(cu_physics .eq. 5 )then<a name='1468'>
#ifdef DM_PARALLEL<a name='1469'>
#     include "<A href='../../html_code/include/HALO_CUP_G3_OUT.inc.html'>HALO_CUP_G3_OUT.inc</A>"<A NAME="HALO_CUP_G3_OUT.inc_2"><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1470'>
#endif<a name='1471'>
      <font color=#447700>!$OMP PARALLEL DO   &amp;<a name='1472'></font>
      <font color=#447700>!$OMP PRIVATE ( ij ,its,ite,jts,jte, i,j,k)<a name='1473'></font>
      DO ij = 1 , num_tiles<a name='1474'>
        its = i_start(ij)<a name='1475'>
        ite = i_end(ij)<a name='1476'>
        jts = j_start(ij)<a name='1477'>
        jte = j_end(ij)<a name='1478'>
<a name='1479'>
        call <A href='../../html_code/phys/module_cu_g3.F.html#CONV_GRELL_SPREAD3D'>conv_grell_spread3d</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CONV_GRELL_SPREAD3D_1">(rthcuten=rthcuten,rqvcuten=rqvcuten                &amp;<a name='1480'>
     &amp;            ,rqccuten=rqccuten,raincv=raincv,cugd_avedx=cugd_avedx            &amp;<a name='1481'>
     &amp;            ,cugd_tten=cugd_tten,cugd_qvten=cugd_qvten,rqicuten=rqicuten      &amp;<a name='1482'>
     &amp;            ,cugd_ttens=cugd_ttens,cugd_qvtens=cugd_qvtens                    &amp;<a name='1483'>
     &amp;            ,cugd_qcten=cugd_qcten,pi_phy=pi,moist_qv=qv_curr                 &amp;<a name='1484'>
     &amp;            ,PRATEC=tmppratec,dt=dt,num_tiles=num_tiles                       &amp;<a name='1485'>
     &amp;            ,imomentum=imomentum                             &amp;<a name='1486'>
     &amp;            ,F_QV=F_QV,F_QC=F_QC,F_QR=F_QR,F_QI=F_QI,F_QS=F_QS                &amp;<a name='1487'>
     &amp;            ,ids=IDS,ide=IDE, jds=JDS,jde=JDE, kds=KDS,kde=KDE                &amp;<a name='1488'>
     &amp;            ,ips=IPS,ipe=IPE, jps=JPS,jpe=JPE, kps=KPS,kpe=KPE                &amp;<a name='1489'>
     &amp;            ,ims=IMS,ime=IME, jms=JMS,jme=JME, kms=KMS,kme=KME                &amp;<a name='1490'>
     &amp;            ,its=its,ite=ite, jts=jts,jte=jte, kts=kts,kte=kte)<a name='1491'>
      ENDDO<a name='1492'>
      <font color=#447700>!$OMP END PARALLEL DO<a name='1493'></font>
   endif<a name='1494'>
#endif<a name='1495'>
<a name='1496'>
<a name='1497'>
   <font color=#447700>! Copy pratec back to output array, if necessary.<a name='1498'></font>
<a name='1499'>
   if (PRESENT(PRATEC)) then<a name='1500'>
      pratec(:,:) = tmppratec(:,:)<a name='1501'>
   endif<a name='1502'>
<a name='1503'>
   <font color=#447700>! Copy cudtacttime back if necessary<a name='1504'></font>
<a name='1505'>
   if ( PRESENT(CUDTACTTIME) ) then<a name='1506'>
      cudtacttime = cudtacttime_pass<a name='1507'>
   end if<a name='1508'>
<a name='1509'>
   CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_556">(200,'returning from cumulus_driver')<a name='1510'>
<a name='1511'>
   END SUBROUTINE cumulus_driver<a name='1512'>
<a name='1513'>
END MODULE module_cumulus_driver<a name='1514'>
</pre></body></html>