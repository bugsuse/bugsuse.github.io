<HTML> <BODY BGCOLOR=#bbccdd LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!*-----------------------------------------------------------------------------<a name='2'></font>
<font color=#447700>!*<a name='3'></font>
<font color=#447700>!*  Todd Hutchinson<a name='4'></font>
<font color=#447700>!*  WSI<a name='5'></font>
<font color=#447700>!*  400 Minuteman Road<a name='6'></font>
<font color=#447700>!*  Andover, MA     01810<a name='7'></font>
<font color=#447700>!*  thutchinson@wsi.com<a name='8'></font>
<font color=#447700>!*<a name='9'></font>
<font color=#447700>!*-----------------------------------------------------------------------------<a name='10'></font>
<a name='11'>
<font color=#447700>!*<a name='12'></font>
<font color=#447700>!* This io_grib1 API is designed to read WRF input and write WRF output data<a name='13'></font>
<font color=#447700>!*   in grib version 1 format.  <a name='14'></font>
<font color=#447700>!*<a name='15'></font>
<a name='16'>
<a name='17'>
<A NAME='GR1_DATA_INFO'><A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='18'>
<font color=#993300>module </font><font color=#cc0000>gr1_data_info</font> <A href='../../call_to/GR1_DATA_INFO.html' TARGET='index'>70</A><a name='19'>
<a name='20'>
<font color=#447700>!*<a name='21'></font>
<font color=#447700>!* This module will hold data internal to this I/O implementation.  <a name='22'></font>
<font color=#447700>!*   The variables will be accessible by all functions (provided they have a <a name='23'></font>
<font color=#447700>!*   "USE gr1_data_info" line).<a name='24'></font>
<font color=#447700>!*<a name='25'></font>
<a name='26'>
  integer                , parameter       :: FATAL            = 1<a name='27'>
  integer                , parameter       :: DEBUG            = 100<a name='28'>
  integer                , parameter       :: DateStrLen       = 19<a name='29'>
<a name='30'>
  integer                , parameter       :: firstFileHandle  = 8<a name='31'>
  integer                , parameter       :: maxFileHandles   = 30 <a name='32'>
  integer                , parameter       :: maxLevels        = 1000<a name='33'>
  integer                , parameter       :: maxSoilLevels    = 100<a name='34'>
  integer                , parameter       :: maxPressLevels   = 100<a name='35'>
  integer                , parameter       :: maxTurbLayers    = 100<a name='36'>
  integer                , parameter       :: maxDomains       = 500<a name='37'>
<a name='38'>
  logical ,      dimension(maxFileHandles) :: committed, opened, used<a name='39'>
  character*128, dimension(maxFileHandles) :: DataFile<a name='40'>
  integer,       dimension(maxFileHandles) :: FileFd<a name='41'>
  integer,       dimension(maxFileHandles) :: FileStatus<a name='42'>
  REAL,          dimension(maxLevels)      :: half_eta, full_eta<a name='43'>
  REAL,          dimension(maxSoilLevels)  :: soil_depth, soil_thickness<a name='44'>
  REAL,          dimension(maxPressLevels) :: press_levels<a name='45'>
  REAL,          dimension(maxTurbLayers)  :: turb_layer_bot<a name='46'>
  REAL,          dimension(maxTurbLayers)  :: turb_layer_top<a name='47'>
  character*24                             :: StartDate = ''<a name='48'>
  character*24                             :: InputProgramName = ''<a name='49'>
  integer                                  :: projection<a name='50'>
  integer                                  :: wg_grid_id<a name='51'>
  real                                     :: dx,dy<a name='52'>
  real                                     :: truelat1, truelat2<a name='53'>
  real                                     :: center_lat, center_lon<a name='54'>
  real                                     :: proj_central_lon<a name='55'>
  real                                     :: timestep<a name='56'>
  character,     dimension(:), pointer     :: grib_tables<a name='57'>
  logical                                  :: table_filled = .FALSE.<a name='58'>
  character,     dimension(:), pointer     :: grid_info<a name='59'>
  integer                                  :: full_xsize, full_ysize<a name='60'>
  integer, dimension(maxDomains)           :: domains = -1<a name='61'>
  integer                                  :: this_domain = 0<a name='62'>
  integer                                  :: max_domain = 0<a name='63'>
  <a name='64'>
  TYPE :: HandleVar<a name='65'>
     character, dimension(:), pointer      :: fileindex(:)<a name='66'>
     integer                               :: CurrentTime<a name='67'>
     integer                               :: NumberTimes<a name='68'>
     character (DateStrLen), dimension(:),pointer  :: Times(:)<a name='69'>
  ENDTYPE<a name='70'>
  TYPE (HandleVar), dimension(maxFileHandles) :: fileinfo<a name='71'>
<a name='72'>
  TYPE :: prevdata<a name='73'>
     integer :: fcst_secs_rainc<a name='74'>
     integer :: fcst_secs_rainnc<a name='75'>
     real, dimension(:,:), pointer         :: rainc, rainnc<a name='76'>
  END TYPE prevdata<a name='77'>
  TYPE (prevdata), DIMENSION(500)          :: lastdata<a name='78'>
<a name='79'>
  TYPE :: initdata<a name='80'>
     real,         dimension(:,:), pointer :: snod<a name='81'>
  END TYPE initdata<a name='82'>
<a name='83'>
  TYPE (initdata), dimension(maxDomains)   :: firstdata<a name='84'>
<a name='85'>
  TYPE :: prestype<a name='86'>
     real,         dimension(:,:,:), pointer :: vals<a name='87'>
     logical                                :: newtime<a name='88'>
     character*120                          :: lastDateStr<a name='89'>
  END TYPE prestype<a name='90'>
<a name='91'>
  character*120, dimension(maxDomains)     :: lastDateStr<a name='92'>
<a name='93'>
  TYPE (prestype), dimension(maxDomains)   :: pressure<a name='94'>
  TYPE (prestype), dimension(maxDomains)   :: geopotential<a name='95'>
<a name='96'>
  integer                                  :: center, subcenter, parmtbl<a name='97'>
<a name='98'>
  character(len=15000), dimension(firstFileHandle:maxFileHandles) :: td_output<a name='99'>
  character(len=15000), dimension(firstFileHandle:maxFileHandles) :: ti_output<a name='100'>
<a name='101'>
  logical                                  :: WrfIOnotInitialized = .true.<a name='102'>
<a name='103'>
end module gr1_data_info<a name='104'>
<a name='105'>
<a name='106'>
<A NAME='EXT_GR1_IOINIT'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOINIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='107'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_gr1_ioinit</font>(SysDepInfo,Status) <A href='../../call_to/EXT_GR1_IOINIT.html' TARGET='index'>6</A>,<A href='../../call_from/EXT_GR1_IOINIT.html' TARGET='index'>3</A><a name='108'>
<a name='109'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_1"><a name='110'>
  implicit none<a name='111'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_1"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='112'>
#include "<A href='../../html_code/include/wrf_io_flags.h.html'>wrf_io_flags.h</A>"<A NAME="wrf_io_flags.h_2"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='113'>
  CHARACTER*(*), INTENT(IN) :: SysDepInfo<a name='114'>
  integer ,intent(out) :: Status<a name='115'>
  integer :: i<a name='116'>
  integer :: size, istat<a name='117'>
  CHARACTER (LEN=300) :: wrf_err_message<a name='118'>
<a name='119'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1134"> ( DEBUG , 'Entering ext_gr1_ioinit')<a name='120'>
<a name='121'>
  do i=firstFileHandle, maxFileHandles<a name='122'>
<A href='../../html_code/share/dfi.F.html#D'></A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="D_24">d(i) = .false.<a name='123'>
        committed(i) = .false.<a name='124'>
        opened(i) = .false.<a name='125'>
        td_output(i) = ''<a name='126'>
        ti_output(i) = ''<a name='127'>
  enddo<a name='128'>
  domains(:) = -1<a name='129'>
<a name='130'>
  do i = 1, maxDomains<a name='131'>
    pressure(i)%newtime = .false.<a name='132'>
    pressure(i)%lastDateStr = ''<a name='133'>
    geopotential(i)%newtime = .false.<a name='134'>
    geopotential(i)%lastDateStr = ''<a name='135'>
    lastDateStr(i) = ''<a name='136'>
  enddo<a name='137'>
<a name='138'>
  lastdata%fcst_secs_rainc = 0<a name='139'>
  lastdata%fcst_secs_rainnc = 0<a name='140'>
  FileStatus(1:maxFileHandles) = WRF_FILE_NOT_OPENED<a name='141'>
  WrfIOnotInitialized = .false.<a name='142'>
<a name='143'>
  Status = WRF_NO_ERR<a name='144'>
<a name='145'>
  return<a name='146'>
end subroutine ext_gr1_ioinit<a name='147'>
<a name='148'>
<font color=#447700>!*****************************************************************************<a name='149'></font>
<a name='150'>
<A NAME='EXT_GR1_IOEXIT'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOEXIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='151'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_gr1_ioexit</font>(Status) <A href='../../call_to/EXT_GR1_IOEXIT.html' TARGET='index'>6</A>,<A href='../../call_from/EXT_GR1_IOEXIT.html' TARGET='index'>2</A><a name='152'>
<a name='153'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOEXIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_2"><a name='154'>
  implicit none<a name='155'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_3"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOEXIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='156'>
  integer istat<a name='157'>
  integer ,intent(out) :: Status<a name='158'>
<a name='159'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOEXIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1135"> ( DEBUG , 'Entering ext_gr1_ioexit')<a name='160'>
<a name='161'>
  if (table_filled) then<a name='162'>
     CALL free_gribmap(grib_tables)<a name='163'>
     DEALLOCATE(grib_tables, stat=istat)<a name='164'>
     table_filled = .FALSE.<a name='165'>
  endif<a name='166'>
  IF ( ASSOCIATED ( grid_info ) ) THEN<a name='167'>
    DEALLOCATE(grid_info, stat=istat)<a name='168'>
  ENDIF<a name='169'>
  NULLIFY(grid_info)<a name='170'>
<a name='171'>
  Status = WRF_NO_ERR<a name='172'>
<a name='173'>
  return<a name='174'>
end subroutine ext_gr1_ioexit<a name='175'>
<a name='176'>
<font color=#447700>!*****************************************************************************<a name='177'></font>
<a name='178'>
<A NAME='EXT_GR1_OPEN_FOR_READ_BEGIN'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='179'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_open_for_read_begin</font> ( FileName , Comm_compute, Comm_io, &amp; <A href='../../call_to/EXT_GR1_OPEN_FOR_READ_BEGIN.html' TARGET='index'>2</A>,<A href='../../call_from/EXT_GR1_OPEN_FOR_READ_BEGIN.html' TARGET='index'>9</A><a name='180'>
     SysDepInfo, DataHandle , Status )<a name='181'>
<a name='182'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_3"><a name='183'>
  IMPLICIT NONE<a name='184'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_4"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='185'>
#include "<A href='../../html_code/include/wrf_io_flags.h.html'>wrf_io_flags.h</A>"<A NAME="wrf_io_flags.h_5"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='186'>
  CHARACTER*(*) :: FileName<a name='187'>
  INTEGER ,       INTENT(IN)  :: Comm_compute , Comm_io<a name='188'>
  CHARACTER*(*) :: SysDepInfo<a name='189'>
  INTEGER ,       INTENT(OUT) :: DataHandle<a name='190'>
  INTEGER ,       INTENT(OUT) :: Status<a name='191'>
  integer                     :: ierr<a name='192'>
  integer                     :: size<a name='193'>
  integer                     :: idx<a name='194'>
  integer                     :: parmid<a name='195'>
  integer                     :: dpth_parmid<a name='196'>
  integer                     :: thk_parmid<a name='197'>
  integer                     :: leveltype<a name='198'>
  integer , DIMENSION(1000)   :: indices<a name='199'>
  integer                     :: numindices<a name='200'>
  real , DIMENSION(1000)      :: levels<a name='201'>
  real                        :: tmp<a name='202'>
  integer                     :: swapped<a name='203'>
  integer                     :: etaidx<a name='204'>
  integer                     :: grb_index<a name='205'>
  integer                     :: level1, level2<a name='206'>
  integer   :: tablenum<a name='207'>
  integer   :: stat<a name='208'>
  integer   :: endchar<a name='209'>
  integer   :: last_grb_index<a name='210'>
  CHARACTER (LEN=300) :: wrf_err_message<a name='211'>
<a name='212'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1136"> ( DEBUG , 'Entering ext_gr1_open_for_read_begin')<a name='213'>
<a name='214'>
  CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_GET_NEW_HANDLE'>gr1_get_new_handle</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_GET_NEW_HANDLE_1">(DataHandle)<a name='215'>
<a name='216'>
  if (DataHandle .GT. 0) then<a name='217'>
     CALL open_file(TRIM(FileName), 'r', FileFd(DataHandle), ierr)<a name='218'>
     if (ierr .ne. 0) then<a name='219'>
        Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='220'>
     else<a name='221'>
        opened(DataHandle) = .true.<a name='222'>
        DataFile(DataHandle) = TRIM(FileName)<a name='223'>
        FileStatus(DataHandle) = WRF_FILE_OPENED_NOT_COMMITTED<a name='224'>
     endif<a name='225'>
  else<a name='226'>
     Status = WRF_WARN_TOO_MANY_FILES<a name='227'>
     return<a name='228'>
  endif<a name='229'>
 <a name='230'>
  <font color=#447700>! Read the grib index file first<a name='231'></font>
  if (.NOT. table_filled) then<a name='232'>
     table_filled = .TRUE.<a name='233'>
     CALL GET_GRIB1_TABLES_SIZE(size)<a name='234'>
     ALLOCATE(grib_tables(1:size), STAT=ierr)<a name='235'>
     CALL LOAD_GRIB1_TABLES ("gribmap.txt", grib_tables, ierr)<a name='236'>
     if (ierr .ne. 0) then<a name='237'>
        DEALLOCATE(grib_tables)<a name='238'>
        WRITE( wrf_err_message , * ) &amp;<a name='239'>
             'Could not open file gribmap.txt '<a name='240'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1501"> ( TRIM ( wrf_err_message ) )<a name='241'>
        Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='242'>
        return<a name='243'>
     endif<a name='244'>
  endif<a name='245'>
<a name='246'>
  <font color=#447700>! Begin by indexing file and reading metadata into structure.<a name='247'></font>
  CALL GET_FILEINDEX_SIZE(size)<a name='248'>
  ALLOCATE(fileinfo(DataHandle)%fileindex(1:size), STAT=ierr)<a name='249'>
<a name='250'>
  CALL ALLOC_INDEX_FILE(fileinfo(DataHandle)%fileindex(:))<a name='251'>
  CALL INDEX_FILE(FileFd(DataHandle),fileinfo(DataHandle)%fileindex(:))<a name='252'>
<a name='253'>
  <font color=#447700>! Get times into Times variable<a name='254'></font>
  CALL GET_NUM_TIMES(fileinfo(DataHandle)%fileindex(:), &amp;<a name='255'>
       fileinfo(DataHandle)%NumberTimes);<a name='256'>
<a name='257'>
  ALLOCATE(fileinfo(DataHandle)%Times(1:fileinfo(DataHandle)%NumberTimes), STAT=ierr)<a name='258'>
  do idx = 1,fileinfo(DataHandle)%NumberTimes<a name='259'>
     CALL GET_TIME(fileinfo(DataHandle)%fileindex(:),idx, &amp;<a name='260'>
          fileinfo(DataHandle)%Times(idx))<a name='261'>
  enddo<a name='262'>
<a name='263'>
  <font color=#447700>! CurrentTime starts as 0.  The first time in the file is 1.  So,<a name='264'></font>
  <font color=#447700>!   until set_time or get_next_time is called, the current time<a name='265'></font>
  <font color=#447700>!   is not set.<a name='266'></font>
  fileinfo(DataHandle)%CurrentTime = 0<a name='267'>
<a name='268'>
  CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_FILL_ETA_LEVELS'>gr1_fill_eta_levels</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_FILL_ETA_LEVELS_1">(fileinfo(DataHandle)%fileindex(:), &amp;<a name='269'>
       FileFd(DataHandle), &amp; <a name='270'>
       grib_tables, "ZNW", full_eta)<a name='271'>
  CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_FILL_ETA_LEVELS'>gr1_fill_eta_levels</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_FILL_ETA_LEVELS_2">(fileinfo(DataHandle)%fileindex(:), FileFd(DataHandle), &amp;<a name='272'>
       grib_tables, "ZNU", half_eta)<a name='273'>
<a name='274'>
  <font color=#447700>! <a name='275'></font>
  <font color=#447700>! Now, get the soil levels<a name='276'></font>
  <font color=#447700>!<a name='277'></font>
  CALL GET_GRIB_PARAM(grib_tables, "ZS", center, subcenter, parmtbl, &amp;<a name='278'>
       tablenum, dpth_parmid)<a name='279'>
  CALL GET_GRIB_PARAM(grib_tables,"DZS", center, subcenter, parmtbl, &amp;<a name='280'>
       tablenum, thk_parmid)<a name='281'>
  if (dpth_parmid == -1) then<a name='282'>
     call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1465"> ('Error getting grib parameter')<a name='283'>
  endif<a name='284'>
<a name='285'>
  leveltype = 112<a name='286'>
<a name='287'>
  CALL GET_GRIB_INDICES(fileinfo(DataHandle)%fileindex(:),center, subcenter, parmtbl, &amp;<a name='288'>
       dpth_parmid,"*",leveltype, &amp;<a name='289'>
       -HUGE(1),-HUGE(1), -HUGE(1),-HUGE(1),indices,numindices)<a name='290'>
<a name='291'>
  last_grb_index = -1;<a name='292'>
  do idx = 1,numindices<a name='293'>
     CALL READ_GRIB(fileinfo(DataHandle)%fileindex(:), FileFd(DataHandle), &amp;<a name='294'>
          indices(idx), soil_depth(idx))<a name='295'>
     <font color=#447700>!<a name='296'></font>
     <font color=#447700>! Now read the soil thickenesses<a name='297'></font>
     <font color=#447700>!<a name='298'></font>
     CALL GET_LEVEL1(fileinfo(DataHandle)%fileindex(:),indices(idx),level1)<a name='299'>
     CALL GET_LEVEL2(fileinfo(DataHandle)%fileindex(:),indices(idx),level2)<a name='300'>
     CALL GET_GRIB_INDEX_GUESS(fileinfo(DataHandle)%fileindex(:), &amp;<a name='301'>
          center, subcenter, parmtbl, thk_parmid,"*",leveltype, &amp;<a name='302'>
          level1,level2,-HUGE(1),-HUGE(1), last_grb_index+1, grb_index)<a name='303'>
     CALL READ_GRIB(fileinfo(DataHandle)%fileindex(:),FileFd(DataHandle),grb_index, &amp;<a name='304'>
          soil_thickness(idx))<a name='305'>
<a name='306'>
     last_grb_index = grb_index<a name='307'>
  enddo<a name='308'>
  <a name='309'>
<a name='310'>
<a name='311'>
  <font color=#447700>!<a name='312'></font>
  <font color=#447700>! Fill up any variables that need to be retrieved from Metadata<a name='313'></font>
  <font color=#447700>!<a name='314'></font>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), 'PROGRAM_NAME', "none", &amp;<a name='315'>
       "none", InputProgramName, stat)<a name='316'>
  if (stat /= 0) then<a name='317'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1137"> (DEBUG , "PROGRAM_NAME not found in input METADATA")<a name='318'>
  else <a name='319'>
     endchar = SCAN(InputProgramName," ")<a name='320'>
     InputProgramName = InputProgramName(1:endchar)<a name='321'>
  endif<a name='322'>
<a name='323'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1138"> ( DEBUG , 'Exiting ext_gr1_open_for_read_begin')<a name='324'>
<a name='325'>
  RETURN<a name='326'>
END SUBROUTINE ext_gr1_open_for_read_begin<a name='327'>
<a name='328'>
<font color=#447700>!*****************************************************************************<a name='329'></font>
<a name='330'>
<A NAME='EXT_GR1_OPEN_FOR_READ_COMMIT'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_COMMIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='331'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_open_for_read_commit</font>( DataHandle , Status ) <A href='../../call_to/EXT_GR1_OPEN_FOR_READ_COMMIT.html' TARGET='index'>2</A>,<A href='../../call_from/EXT_GR1_OPEN_FOR_READ_COMMIT.html' TARGET='index'>3</A><a name='332'>
<a name='333'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_4"><a name='334'>
  IMPLICIT NONE<a name='335'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_6"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='336'>
#include "<A href='../../html_code/include/wrf_io_flags.h.html'>wrf_io_flags.h</A>"<A NAME="wrf_io_flags.h_7"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='337'>
  character(len=1000) :: msg<a name='338'>
  INTEGER ,       INTENT(IN ) :: DataHandle<a name='339'>
  INTEGER ,       INTENT(OUT) :: Status<a name='340'>
<a name='341'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1139"> ( DEBUG , 'Entering ext_gr1_open_for_read_commit')<a name='342'>
<a name='343'>
  Status = WRF_NO_ERR<a name='344'>
  if(WrfIOnotInitialized) then<a name='345'>
    Status = WRF_IO_NOT_INITIALIZED<a name='346'>
    write(msg,*) 'ext_gr1_ioinit was not called ',__FILE__,', line', __LINE__<a name='347'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1140"> ( FATAL , msg)<a name='348'>
    return<a name='349'>
  endif<a name='350'>
  committed(DataHandle) = .true.<a name='351'>
  FileStatus(DataHandle) = WRF_FILE_OPENED_FOR_READ<a name='352'>
<a name='353'>
  Status = WRF_NO_ERR<a name='354'>
<a name='355'>
  RETURN<a name='356'>
END SUBROUTINE ext_gr1_open_for_read_commit<a name='357'>
<a name='358'>
<font color=#447700>!*****************************************************************************<a name='359'></font>
<a name='360'>
<A NAME='EXT_GR1_OPEN_FOR_READ'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='361'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_open_for_read</font> ( FileName , Comm_compute, Comm_io, &amp; <A href='../../call_to/EXT_GR1_OPEN_FOR_READ.html' TARGET='index'>1</A>,<A href='../../call_from/EXT_GR1_OPEN_FOR_READ.html' TARGET='index'>4</A><a name='362'>
     SysDepInfo, DataHandle , Status )<a name='363'>
<a name='364'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_5"><a name='365'>
  IMPLICIT NONE<a name='366'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_8"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='367'>
#include "<A href='../../html_code/include/wrf_io_flags.h.html'>wrf_io_flags.h</A>"<A NAME="wrf_io_flags.h_9"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='368'>
  CHARACTER*(*) :: FileName<a name='369'>
  INTEGER ,       INTENT(IN)  :: Comm_compute , Comm_io<a name='370'>
  CHARACTER*(*) :: SysDepInfo<a name='371'>
  INTEGER ,       INTENT(OUT) :: DataHandle<a name='372'>
  INTEGER ,       INTENT(OUT) :: Status<a name='373'>
<a name='374'>
<a name='375'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1141"> ( DEBUG , 'Entering ext_gr1_open_for_read')<a name='376'>
<a name='377'>
  DataHandle = 0   <font color=#447700>! dummy setting to quiet warning message<a name='378'></font>
  CALL <A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_BEGIN'>ext_gr1_open_for_read_begin</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_GR1_OPEN_FOR_READ_BEGIN_2">( FileName, Comm_compute, Comm_io, &amp;<a name='379'>
       SysDepInfo, DataHandle, Status )<a name='380'>
  IF ( Status .EQ. WRF_NO_ERR ) THEN<a name='381'>
     FileStatus(DataHandle) = WRF_FILE_OPENED_NOT_COMMITTED<a name='382'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ_COMMIT'>ext_gr1_open_for_read_commit</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_READ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_GR1_OPEN_FOR_READ_COMMIT_2">( DataHandle, Status )<a name='383'>
  ENDIF<a name='384'>
  return<a name='385'>
<a name='386'>
  RETURN  <a name='387'>
END SUBROUTINE ext_gr1_open_for_read<a name='388'>
<a name='389'>
<font color=#447700>!*****************************************************************************<a name='390'></font>
<a name='391'>
<A NAME='EXT_GR1_OPEN_FOR_WRITE_BEGIN'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_WRITE_BEGIN' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='392'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_open_for_write_begin</font>(FileName, Comm, IOComm, SysDepInfo, &amp; <A href='../../call_to/EXT_GR1_OPEN_FOR_WRITE_BEGIN.html' TARGET='index'>6</A>,<A href='../../call_from/EXT_GR1_OPEN_FOR_WRITE_BEGIN.html' TARGET='index'>4</A><a name='393'>
     DataHandle, Status)<a name='394'>
  <a name='395'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_6"><a name='396'>
  implicit none<a name='397'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_10"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='398'>
#include "<A href='../../html_code/include/wrf_io_flags.h.html'>wrf_io_flags.h</A>"<A NAME="wrf_io_flags.h_11"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='399'>
<a name='400'>
  character*(*)        ,intent(in)  :: FileName<a name='401'>
  integer              ,intent(in)  :: Comm<a name='402'>
  integer              ,intent(in)  :: IOComm<a name='403'>
  character*(*)        ,intent(in)  :: SysDepInfo<a name='404'>
  integer              ,intent(out) :: DataHandle<a name='405'>
  integer              ,intent(out) :: Status<a name='406'>
  integer :: ierr<a name='407'>
  CHARACTER (LEN=300) :: wrf_err_message<a name='408'>
  integer             :: size<a name='409'>
<a name='410'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1142"> ( DEBUG , 'Entering ext_gr1_open_for_write_begin')<a name='411'>
<a name='412'>
  if (.NOT. table_filled) then<a name='413'>
     table_filled = .TRUE.<a name='414'>
     CALL GET_GRIB1_TABLES_SIZE(size)<a name='415'>
     ALLOCATE(grib_tables(1:size), STAT=ierr)<a name='416'>
     CALL LOAD_GRIB1_TABLES ("gribmap.txt", grib_tables, ierr)<a name='417'>
     if (ierr .ne. 0) then<a name='418'>
        DEALLOCATE(grib_tables)<a name='419'>
        WRITE( wrf_err_message , * ) &amp;<a name='420'>
             'Could not open file gribmap.txt '<a name='421'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1502"> ( TRIM ( wrf_err_message ) )<a name='422'>
        Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='423'>
        return<a name='424'>
     endif<a name='425'>
  endif<a name='426'>
<a name='427'>
  Status = WRF_NO_ERR<a name='428'>
  CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_GET_NEW_HANDLE'>gr1_get_new_handle</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_GET_NEW_HANDLE_2">(DataHandle)<a name='429'>
  if (DataHandle .GT. 0) then<a name='430'>
     CALL open_file(TRIM(FileName), 'w', FileFd(DataHandle), ierr)<a name='431'>
     if (ierr .ne. 0) then<a name='432'>
        Status = WRF_WARN_WRITE_RONLY_FILE<a name='433'>
     else<a name='434'>
        opened(DataHandle) = .true.<a name='435'>
        DataFile(DataHandle) = TRIM(FileName)<a name='436'>
        FileStatus(DataHandle) = WRF_FILE_OPENED_NOT_COMMITTED<a name='437'>
     endif<a name='438'>
     committed(DataHandle) = .false.<a name='439'>
     td_output(DataHandle) = ''<a name='440'>
  else<a name='441'>
     Status = WRF_WARN_TOO_MANY_FILES<a name='442'>
  endif<a name='443'>
<a name='444'>
  RETURN  <a name='445'>
END SUBROUTINE ext_gr1_open_for_write_begin<a name='446'>
<a name='447'>
<font color=#447700>!*****************************************************************************<a name='448'></font>
<a name='449'>
<A NAME='EXT_GR1_OPEN_FOR_WRITE_COMMIT'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_WRITE_COMMIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='450'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_open_for_write_commit</font>( DataHandle , Status ) <A href='../../call_to/EXT_GR1_OPEN_FOR_WRITE_COMMIT.html' TARGET='index'>6</A>,<A href='../../call_from/EXT_GR1_OPEN_FOR_WRITE_COMMIT.html' TARGET='index'>2</A><a name='451'>
<a name='452'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_7"><a name='453'>
  IMPLICIT NONE<a name='454'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_12"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='455'>
#include "<A href='../../html_code/include/wrf_io_flags.h.html'>wrf_io_flags.h</A>"<A NAME="wrf_io_flags.h_13"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='456'>
  INTEGER ,       INTENT(IN ) :: DataHandle<a name='457'>
  INTEGER ,       INTENT(OUT) :: Status<a name='458'>
<a name='459'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1143"> ( DEBUG , 'Entering ext_gr1_open_for_write_commit')<a name='460'>
<a name='461'>
  IF ( opened( DataHandle ) ) THEN<a name='462'>
    IF ( used( DataHandle ) ) THEN<a name='463'>
      committed(DataHandle) = .true.<a name='464'>
      FileStatus(DataHandle) = WRF_FILE_OPENED_FOR_WRITE<a name='465'>
    ENDIF<a name='466'>
  ENDIF<a name='467'>
<a name='468'>
  Status = WRF_NO_ERR<a name='469'>
<a name='470'>
  RETURN  <a name='471'>
END SUBROUTINE ext_gr1_open_for_write_commit<a name='472'>
<a name='473'>
<font color=#447700>!*****************************************************************************<a name='474'></font>
<a name='475'>
<A NAME='EXT_GR1_INQUIRY'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='476'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_gr1_inquiry</font> (Inquiry, Result, Status),<A href='../../call_from/EXT_GR1_INQUIRY.html' TARGET='index'>1</A><a name='477'>
  use <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_8"><a name='478'>
  implicit none<a name='479'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_14"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='480'>
  character *(*), INTENT(IN)    :: Inquiry<a name='481'>
  character *(*), INTENT(OUT)   :: Result<a name='482'>
  integer        ,INTENT(INOUT) :: Status<a name='483'>
  SELECT CASE (Inquiry)<a name='484'>
  CASE ("RANDOM_WRITE","RANDOM_READ")<a name='485'>
     Result='ALLOW'<a name='486'>
  CASE ("SEQUENTIAL_WRITE","SEQUENTIAL_READ")<a name='487'>
     Result='NO'<a name='488'>
  CASE ("OPEN_READ", "OPEN_WRITE", "OPEN_COMMIT_WRITE")<a name='489'>
     Result='REQUIRE'<a name='490'>
  CASE ("OPEN_COMMIT_READ","PARALLEL_IO")<a name='491'>
     Result='NO'<a name='492'>
  CASE ("SELF_DESCRIBING","SUPPORT_METADATA","SUPPORT_3D_FIELDS")<a name='493'>
     Result='YES'<a name='494'>
  CASE ("MEDIUM")<a name='495'>
     Result ='FILE'<a name='496'>
  CASE DEFAULT<a name='497'>
     Result = 'No Result for that inquiry<font color=#447700>!'<a name='498'></font>
  END SELECT<a name='499'>
  Status=WRF_NO_ERR<a name='500'>
  return<a name='501'>
end subroutine ext_gr1_inquiry<a name='502'>
<a name='503'>
<font color=#447700>!*****************************************************************************<a name='504'></font>
<a name='505'>
<A NAME='EXT_GR1_INQUIRE_OPENED'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRE_OPENED' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='506'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_inquire_opened</font> ( DataHandle, FileName , FileStat, Status ) <A href='../../call_to/EXT_GR1_INQUIRE_OPENED.html' TARGET='index'>2</A>,<A href='../../call_from/EXT_GR1_INQUIRE_OPENED.html' TARGET='index'>2</A><a name='507'>
<a name='508'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRE_OPENED' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_9"><a name='509'>
  IMPLICIT NONE<a name='510'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_15"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRE_OPENED' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='511'>
#include "<A href='../../html_code/include/wrf_io_flags.h.html'>wrf_io_flags.h</A>"<A NAME="wrf_io_flags.h_16"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRE_OPENED' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='512'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='513'>
  CHARACTER*(*) :: FileName<a name='514'>
  INTEGER ,       INTENT(OUT) :: FileStat<a name='515'>
  INTEGER ,       INTENT(OUT) :: Status<a name='516'>
<a name='517'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRE_OPENED' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1144"> ( DEBUG , 'Entering ext_gr1_inquire_opened')<a name='518'>
<a name='519'>
  FileStat = WRF_NO_ERR<a name='520'>
  if ((DataHandle .ge. firstFileHandle) .and. &amp;<a name='521'>
       (DataHandle .le. maxFileHandles)) then<a name='522'>
     FileStat = FileStatus(DataHandle)<a name='523'>
  else<a name='524'>
     FileStat = WRF_FILE_NOT_OPENED<a name='525'>
  endif<a name='526'>
  <a name='527'>
  Status = FileStat<a name='528'>
<a name='529'>
  RETURN<a name='530'>
END SUBROUTINE ext_gr1_inquire_opened<a name='531'>
<a name='532'>
<font color=#447700>!*****************************************************************************<a name='533'></font>
<a name='534'>
<A NAME='EXT_GR1_IOCLOSE'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOCLOSE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='535'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_ioclose</font> ( DataHandle, Status ) <A href='../../call_to/EXT_GR1_IOCLOSE.html' TARGET='index'>7</A>,<A href='../../call_from/EXT_GR1_IOCLOSE.html' TARGET='index'>3</A><a name='536'>
<a name='537'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_10"><a name='538'>
  IMPLICIT NONE<a name='539'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_17"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='540'>
  INTEGER DataHandle, Status<a name='541'>
  INTEGER istat<a name='542'>
  INTEGER ierr<a name='543'>
  character(len=1000) :: outstring<a name='544'>
  character :: lf<a name='545'>
  lf=char(10)<a name='546'>
     <a name='547'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1145"> ( DEBUG , 'Entering ext_gr1_ioclose')<a name='548'>
<a name='549'>
  Status = WRF_NO_ERR<a name='550'>
<a name='551'>
  CALL write_file(FileFd(DataHandle), lf//'&lt;METADATA&gt;'//lf,ierr)<a name='552'>
  outstring = &amp;<a name='553'>
       '&lt;<font color=#447700>!-- The following are fields that were supplied to the WRF I/O API.'//lf//&amp;<a name='554'></font>
       'Many variables (but not all) are redundant with the variables within '//lf//&amp;<a name='555'>
       'the grib headers.  They are stored here, as METADATA, so that the '//lf//&amp;<a name='556'>
       'WRF I/O API has simple access to these variables.--&gt;'<a name='557'>
  CALL write_file(FileFd(DataHandle), trim(outstring), ierr)<a name='558'>
  if (trim(ti_output(DataHandle)) /= '') then<a name='559'>
     CALL write_file(FileFd(DataHandle), trim(ti_output(DataHandle)), ierr)<a name='560'>
     CALL write_file(FileFd(DataHandle), lf, ierr)<a name='561'>
  endif<a name='562'>
  if (trim(td_output(DataHandle)) /= '') then<a name='563'>
     CALL write_file(FileFd(DataHandle), trim(td_output(DataHandle)), ierr)<a name='564'>
     CALL write_file(FileFd(DataHandle), lf, ierr)<a name='565'>
  endif<a name='566'>
  CALL write_file(FileFd(DataHandle), '&lt;/METADATA&gt;'//lf,ierr)<a name='567'>
  ti_output(DataHandle) = ''<a name='568'>
  td_output(DataHandle) = ''<a name='569'>
  if (ierr .ne. 0) then<a name='570'>
     Status = WRF_WARN_WRITE_RONLY_FILE<a name='571'>
  endif<a name='572'>
  CALL close_file(FileFd(DataHandle))<a name='573'>
<a name='574'>
<A href='../../html_code/share/dfi.F.html#D'></A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="D_25">d(DataHandle) = .false.<a name='575'>
<a name='576'>
  RETURN<a name='577'>
END SUBROUTINE ext_gr1_ioclose<a name='578'>
<a name='579'>
<font color=#447700>!*****************************************************************************<a name='580'></font>
<a name='581'>
<A NAME='EXT_GR1_WRITE_FIELD'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='582'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_write_field</font>( DataHandle , DateStrIn , VarName , &amp; <A href='../../call_to/EXT_GR1_WRITE_FIELD.html' TARGET='index'>3</A>,<A href='../../call_from/EXT_GR1_WRITE_FIELD.html' TARGET='index'>12</A><a name='583'>
     Field , FieldType , Comm , IOComm, &amp;<a name='584'>
     DomainDesc , MemoryOrder , Stagger , &amp;<a name='585'>
     DimNames , &amp;<a name='586'>
     DomainStart , DomainEnd , &amp;<a name='587'>
     MemoryStart , MemoryEnd , &amp;<a name='588'>
     PatchStart , PatchEnd , &amp;<a name='589'>
     Status )<a name='590'>
<a name='591'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_11"><a name='592'>
  IMPLICIT NONE<a name='593'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_18"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='594'>
#include "<A href='../../html_code/include/wrf_io_flags.h.html'>wrf_io_flags.h</A>"<A NAME="wrf_io_flags.h_19"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='595'>
#include "<A href='../../html_code/include/wrf_projection.h.html'>wrf_projection.h</A>"<A NAME="wrf_projection.h_20"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='596'>
  INTEGER ,       INTENT(IN)    :: DataHandle <a name='597'>
  CHARACTER*(*) :: DateStrIn<a name='598'>
  CHARACTER(DateStrLen) :: DateStr<a name='599'>
  CHARACTER*(*) :: VarName<a name='600'>
  CHARACTER*120 :: OutName<a name='601'>
  CHARACTER(120) :: TmpVarName<a name='602'>
  integer                       ,intent(in)    :: FieldType<a name='603'>
  integer                       ,intent(inout) :: Comm<a name='604'>
  integer                       ,intent(inout) :: IOComm<a name='605'>
  integer                       ,intent(in)    :: DomainDesc<a name='606'>
  character*(*)                 ,intent(in)    :: MemoryOrder<a name='607'>
  character*(*)                 ,intent(in)    :: Stagger<a name='608'>
  character*(*) , dimension (*) ,intent(in)    :: DimNames<a name='609'>
  integer ,dimension(*)         ,intent(in)    :: DomainStart, DomainEnd<a name='610'>
  integer ,dimension(*)         ,intent(in)    :: MemoryStart, MemoryEnd<a name='611'>
  integer ,dimension(*)         ,intent(in)    :: PatchStart,  PatchEnd<a name='612'>
  integer                       ,intent(out)   :: Status<a name='613'>
  integer                                      :: ierror<a name='614'>
  character (120)                         :: msg<a name='615'>
  integer :: xsize, ysize, zsize<a name='616'>
  integer :: x, y, z<a name='617'>
  integer :: x_start,x_end,y_start,y_end,z_start,z_end,ndim<a name='618'>
  integer :: idx<a name='619'>
  integer :: proj_center_flag<a name='620'>
  logical :: vert_stag = .false.<a name='621'>
  integer :: levelnum<a name='622'>
  real, DIMENSION(:,:), POINTER :: data,tmpdata<a name='623'>
  integer, DIMENSION(:), POINTER :: mold<a name='624'>
  integer :: istat<a name='625'>
  integer :: accum_period<a name='626'>
  integer :: size<a name='627'>
  integer, dimension(1000) :: level1, level2<a name='628'>
  real, DIMENSION( 1:1,MemoryStart(1):MemoryEnd(1), &amp;<a name='629'>
                   MemoryStart(2):MemoryEnd(2), &amp;<a name='630'>
                   MemoryStart(3):MemoryEnd(3) ) :: Field<a name='631'>
  real    :: fcst_secs<a name='632'>
  logical :: soil_layers, fraction, is_press_levels,is_turb_layers<a name='633'>
  integer :: vert_unit<a name='634'>
  integer :: abc(2,2,2)<a name='635'>
  integer :: def(8)<a name='636'>
  logical :: output = .true.<a name='637'>
  integer :: idx1, idx2, idx3<a name='638'>
  logical :: new_domain<a name='639'>
  real    :: region_center_lat, region_center_lon<a name='640'>
  integer :: dom_xsize, dom_ysize;<a name='641'>
  integer :: ierr<a name='642'>
  logical :: already_have_domain<a name='643'>
<a name='644'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1146"> ( DEBUG , 'Entering ext_gr1_write_field for parameter'//VarName)<a name='645'>
<a name='646'>
  <font color=#447700>!<a name='647'></font>
  <font color=#447700>! If DateStr is all 0's, we reset it to StartDate (if StartDate exists).  <a name='648'></font>
  <font color=#447700>!   For some reason, <a name='649'></font>
  <font color=#447700>!   in idealized simulations, StartDate is 0001-01-01_00:00:00 while<a name='650'></font>
  <font color=#447700>!   the first DateStr is 0000-00-00_00:00:00.  <a name='651'></font>
  <font color=#447700>!<a name='652'></font>
  if (DateStrIn .eq. '0000-00-00_00:00:00') then<a name='653'>
     if (StartDate .ne. '') then<a name='654'>
        DateStr = TRIM(StartDate)<a name='655'>
     else<a name='656'>
        DateStr = '0001-01-01_00:00:00'<a name='657'>
     endif<a name='658'>
  else<a name='659'>
     DateStr = DateStrIn<a name='660'>
  endif<a name='661'>
<a name='662'>
  <font color=#447700>!<a name='663'></font>
  <font color=#447700>! Check if this is a domain that we haven't seen yet.  If so, add it to <a name='664'></font>
  <font color=#447700>!   the list of domains.<a name='665'></font>
  <font color=#447700>!<a name='666'></font>
  new_domain = .false.<a name='667'>
  already_have_domain = .false.<a name='668'>
  do idx = 1, max_domain<a name='669'>
     if (this_domain .eq. domains(idx)) then<a name='670'>
        already_have_domain = .true.<a name='671'>
     endif<a name='672'>
  enddo<a name='673'>
  if (.NOT. already_have_domain) then<a name='674'>
     max_domain = max_domain + 1<a name='675'>
     domains(max_domain) = this_domain<a name='676'>
     new_domain = .true.<a name='677'>
  endif<a name='678'>
<a name='679'>
  <font color=#447700>!<a name='680'></font>
  <font color=#447700>! If the time has changed, we open a new file.  This is a kludge to get<a name='681'></font>
  <font color=#447700>!   around slowness in WRF that occurs when opening a new data file the<a name='682'></font>
  <font color=#447700>!   standard way.<a name='683'></font>
  <font color=#447700>!<a name='684'></font>
#ifdef GRIB_ONE_TIME_PER_FILE<a name='685'>
  if (lastDateStr(this_domain) .ne. DateStr) then<a name='686'>
     write(DataFile(DataHandle),'(A8,i2.2,A1,A19)') 'wrfout_d',this_domain,'_',DateStr<a name='687'>
     call <A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOCLOSE'>ext_gr1_ioclose</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_GR1_IOCLOSE_6"> ( DataHandle, Status )<a name='688'>
     CALL open_file(TRIM(DataFile(DataHandle)), 'w', FileFd(DataHandle), ierr)<a name='689'>
     if (ierr .ne. 0) then<a name='690'>
        print *,'Could not open new file: ',DataFile(DataHandle)<a name='691'>
        print *,'  Appending to old file.'<a name='692'>
     else<a name='693'>
        <font color=#447700>! Just set used back to .true. here, since ioclose set it to false.<a name='694'></font>
<A href='../../html_code/share/dfi.F.html#D'></A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="D_26">d(DataHandle) = .true.<a name='695'>
     endif<a name='696'>
     td_output(DataHandle) = ''<a name='697'>
  endif<a name='698'>
  lastDateStr(this_domain) = DateStr<a name='699'>
#endif<a name='700'>
<a name='701'>
  output = .true.<a name='702'>
  zsize = 1<a name='703'>
  xsize = 1<a name='704'>
  ysize = 1<a name='705'>
  OutName = VarName<a name='706'>
  is_press_levels = .false.<a name='707'>
  is_turb_layers = .false.<a name='708'>
  soil_layers = .false.<a name='709'>
  fraction = .false.<a name='710'>
<a name='711'>
  <font color=#447700>! First, handle then special cases for the boundary data.<a name='712'></font>
<a name='713'>
  CALL <A href='../../html_code/io_grib_share/io_grib_share.F.html#GET_DIMS'>get_dims</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_DIMS_1">(MemoryOrder, PatchStart, PatchEnd, ndim, x_start, x_end, &amp;<a name='714'>
       y_start, y_end,z_start,z_end)<a name='715'>
  xsize = x_end - x_start + 1<a name='716'>
  ysize = y_end - y_start + 1<a name='717'>
  zsize = z_end - z_start + 1<a name='718'>
<a name='719'>
  do idx = 1, len(MemoryOrder)<a name='720'>
     if ((MemoryOrder(idx:idx) .eq. 'Z') .and. &amp;<a name='721'>
          (DimNames(idx) .eq. 'soil_layers_stag')) then<a name='722'>
        soil_layers = .true.<a name='723'>
     else if ((MemoryOrder(idx:idx) .eq. 'Z') .and. &amp;<a name='724'>
          (DimNames(idx) .eq. 'num_press_levels_stag')) then<a name='725'>
        is_press_levels = .true.<a name='726'>
     else if ((MemoryOrder(idx:idx) .eq. 'Z') .and. &amp;<a name='727'>
          (DimNames(idx) .eq. 'num_turb_layers')) then<a name='728'>
        is_turb_layers = .true.<a name='729'>
     else if ((OutName .eq. 'LANDUSEF') .or. (OutName .eq. 'SOILCBOT') .or. &amp;<a name='730'>
          (OutName .eq. 'SOILCTOP')) then<a name='731'>
        fraction = .true.<a name='732'>
     endif<a name='733'>
  enddo<a name='734'>
<a name='735'>
  if (.not. ASSOCIATED(grid_info)) then<a name='736'>
     CALL get_grid_info_size(size)<a name='737'>
     ALLOCATE(grid_info(1:size), STAT=istat)<a name='738'>
     if (istat .eq. -1) then<a name='739'>
        DEALLOCATE(grid_info)<a name='740'>
        Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='741'>
        return<a name='742'>
     endif<a name='743'>
  endif<a name='744'>
     <a name='745'>
<a name='746'>
  if (new_domain) then<a name='747'>
     ALLOCATE(firstdata(this_domain)%snod(xsize,ysize))<a name='748'>
     firstdata(this_domain)%snod(:,:) = 0.0<a name='749'>
     ALLOCATE(lastdata(this_domain)%rainc(xsize,ysize))<a name='750'>
     lastdata(this_domain)%rainc(:,:) = 0.0<a name='751'>
     ALLOCATE(lastdata(this_domain)%rainnc(xsize,ysize))<a name='752'>
     lastdata(this_domain)%rainnc(:,:) = 0.0<a name='753'>
  endif<a name='754'>
<a name='755'>
  if (zsize .eq. 0) then <a name='756'>
     zsize = 1<a name='757'>
  endif<a name='758'>
<a name='759'>
  ALLOCATE(data(1:xsize,1:ysize), STAT=istat)<a name='760'>
  ALLOCATE(mold(1:ysize), STAT=istat)<a name='761'>
  ALLOCATE(tmpdata(1:xsize,1:ysize), STAT=istat)<a name='762'>
<a name='763'>
  if (OutName .eq. 'ZNU') then<a name='764'>
     do idx = 1, zsize<a name='765'>
        half_eta(idx) = Field(1,idx,1,1)<a name='766'>
     enddo<a name='767'>
  endif<a name='768'>
<a name='769'>
  if (OutName .eq. 'ZNW') then<a name='770'>
     do idx = 1, zsize<a name='771'>
        full_eta(idx) = Field(1,idx,1,1)<a name='772'>
     enddo<a name='773'>
  endif<a name='774'>
<a name='775'>
  if (OutName .eq. 'ZS') then<a name='776'>
     do idx = 1, zsize<a name='777'>
        soil_depth(idx) = Field(1,idx,1,1)<a name='778'>
     enddo<a name='779'>
  endif<a name='780'>
<a name='781'>
  if (OutName .eq. 'DZS') then<a name='782'>
     do idx = 1, zsize<a name='783'>
        soil_thickness(idx) = Field(1,idx,1,1)<a name='784'>
     enddo<a name='785'>
  endif<a name='786'>
<a name='787'>
  if (OutName .eq. 'P_PL') then<a name='788'>
     do idx = 1, zsize<a name='789'>
        press_levels(idx) = Field(1,idx,1,1)<a name='790'>
     enddo<a name='791'>
  endif<a name='792'>
<a name='793'>
  if (OutName .eq. 'AFWA_TLYRBOT') then<a name='794'>
     do idx = 1, zsize<a name='795'>
        turb_layer_bot(idx) = Field(1,idx,1,1)<a name='796'>
     enddo<a name='797'>
  endif<a name='798'>
<a name='799'>
  if (OutName .eq. 'AFWA_TLYRTOP') then<a name='800'>
     do idx = 1, zsize<a name='801'>
        turb_layer_top(idx) = Field(1,idx,1,1)<a name='802'>
     enddo<a name='803'>
  endif<a name='804'>
  if ((xsize .lt. 1) .or. (ysize .lt. 1)) then<a name='805'>
     write(msg,*) 'Cannot output field with memory order: ', &amp;<a name='806'>
          MemoryOrder,Varname<a name='807'>
     call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1466">(msg)<a name='808'>
     return<a name='809'>
  endif<a name='810'>
     <a name='811'>
  call <A href='../../html_code/io_grib_share/io_grib_share.F.html#GET_VERT_STAG'>get_vert_stag</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_VERT_STAG_1">(OutName,Stagger,vert_stag)<a name='812'>
<a name='813'>
  do idx = 1, zsize<a name='814'>
     call <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_GET_LEVELS'>gr1_get_levels</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_GET_LEVELS_1">(OutName, idx, zsize, soil_layers, vert_stag, fraction, &amp;<a name='815'>
          is_press_levels, is_turb_layers, vert_unit, level1(idx), level2(idx))<a name='816'>
  enddo<a name='817'>
<a name='818'>
  <font color=#447700>! <a name='819'></font>
  <font color=#447700>! Get the center lat/lon for the area being output.  For some cases (such<a name='820'></font>
  <font color=#447700>!    as for boundary areas, the center of the area is different from the<a name='821'></font>
  <font color=#447700>!    center of the model grid.<a name='822'></font>
  <font color=#447700>!<a name='823'></font>
  if (index(Stagger,'X') .le. 0) then<a name='824'>
     dom_xsize = full_xsize - 1<a name='825'>
  else<a name='826'>
     dom_xsize = full_xsize<a name='827'>
  endif<a name='828'>
  if (index(Stagger,'Y') .le. 0) then<a name='829'>
     dom_ysize = full_ysize - 1<a name='830'>
  else<a name='831'>
     dom_ysize = full_ysize<a name='832'>
  endif<a name='833'>
<a name='834'>
  <font color=#447700>!<a name='835'></font>
  <font color=#447700>! Handle case of polare stereographic centered on pole.  In that case,<a name='836'></font>
  <font color=#447700>!   always set center lon to be the projection central longitude.<a name='837'></font>
  <font color=#447700>!<a name='838'></font>
  if ((projection .eq. WRF_POLAR_STEREO) .AND. &amp;<a name='839'>
       (abs(center_lat - 90.0) &lt; 0.01)) then<a name='840'>
     center_lon = proj_central_lon<a name='841'>
  endif<a name='842'>
<a name='843'>
  CALL get_region_center(MemoryOrder, projection, center_lat, center_lon, &amp;<a name='844'>
       dom_xsize, dom_ysize, dx, dy, proj_central_lon, proj_center_flag, &amp;<a name='845'>
       truelat1, truelat2, xsize, ysize, region_center_lat, region_center_lon)<a name='846'>
<a name='847'>
  if ( .not. opened(DataHandle)) then<a name='848'>
     Status = WRF_WARN_FILE_NOT_OPENED<a name='849'>
     return<a name='850'>
  endif<a name='851'>
<a name='852'>
<a name='853'>
  if (opened(DataHandle) .and. committed(DataHandle)) then<a name='854'>
<a name='855'>
<a name='856'>
#ifdef OUTPUT_FULL_PRESSURE<a name='857'>
<a name='858'>
     <font color=#447700>! <a name='859'></font>
     <font color=#447700>! The following is a kludge to output full pressure instead of the two <a name='860'></font>
     <font color=#447700>!  fields of base-state pressure and pressure perturbation.<a name='861'></font>
     <font color=#447700>!<a name='862'></font>
     <font color=#447700>! This code can be turned on by adding -DOUTPUT_FULL_PRESSURE to the <a name='863'></font>
     <font color=#447700>!  compile line<a name='864'></font>
     <font color=#447700>!<a name='865'></font>
     <a name='866'>
     if ((OutName .eq. 'P') .or. (OutName.eq.'PB')) then<a name='867'>
        do idx = 1, len(MemoryOrder)<a name='868'>
            if (MemoryOrder(idx:idx) .eq. 'X') then<a name='869'>
              idx1=idx<a name='870'>
           endif<a name='871'>
           if (MemoryOrder(idx:idx) .eq. 'Y') then<a name='872'>
              idx2=idx<a name='873'>
           endif<a name='874'>
           if (MemoryOrder(idx:idx) .eq. 'Z') then<a name='875'>
              idx3=idx<a name='876'>
           endif<a name='877'>
        enddo<a name='878'>
<a name='879'>
        <font color=#447700>! <a name='880'></font>
        <font color=#447700>! Allocate space for pressure values (this variable holds <a name='881'></font>
        <font color=#447700>!   base-state pressure or pressure perturbation to be used <a name='882'></font>
        <font color=#447700>!   later to sum base-state and perturbation pressure to get full <a name='883'></font>
        <font color=#447700>!   pressure).<a name='884'></font>
        <font color=#447700>!<a name='885'></font>
<a name='886'>
        if (.not. ASSOCIATED(pressure(this_domain)%vals)) then<a name='887'>
           ALLOCATE(pressure(this_domain)%vals(MemoryStart(1):MemoryEnd(1), &amp;<a name='888'>
                MemoryStart(2):MemoryEnd(2),MemoryStart(3):MemoryEnd(3)))<a name='889'>
        endif<a name='890'>
        if (DateStr .NE. &amp;<a name='891'>
             pressure(this_domain)%lastDateStr) then<a name='892'>
           pressure(this_domain)%newtime = .true.<a name='893'>
        endif<a name='894'>
        if (pressure(this_domain)%newtime) then<a name='895'>
           pressure(this_domain)%vals = Field(1,:,:,:)<a name='896'>
           pressure(this_domain)%newtime = .false.<a name='897'>
           output = .false.<a name='898'>
        else <a name='899'>
           output = .true.<a name='900'>
        endif<a name='901'>
        pressure(this_domain)%lastDateStr=DateStr<a name='902'>
     endif<a name='903'>
#endif<a name='904'>
<a name='905'>
#ifdef OUTPUT_FULL_GEOPOTENTIAL<a name='906'>
<a name='907'>
     <font color=#447700>! <a name='908'></font>
     <font color=#447700>! The following is a kludge to output full geopotential height instead <a name='909'></font>
     <font color=#447700>!  of the two fields of base-state geopotential and perturbation <a name='910'></font>
     <font color=#447700>!  geopotential.<a name='911'></font>
     <font color=#447700>!<a name='912'></font>
     <font color=#447700>! This code can be turned on by adding -DOUTPUT_FULL_GEOPOTENTIAL to the <a name='913'></font>
     <font color=#447700>!  compile line<a name='914'></font>
     <font color=#447700>!<a name='915'></font>
     <a name='916'>
     if ((OutName .eq. 'PHB') .or. (OutName.eq.'PH')) then<a name='917'>
        do idx = 1, len(MemoryOrder)<a name='918'>
            if (MemoryOrder(idx:idx) .eq. 'X') then<a name='919'>
              idx1=idx<a name='920'>
           endif<a name='921'>
           if (MemoryOrder(idx:idx) .eq. 'Y') then<a name='922'>
              idx2=idx<a name='923'>
           endif<a name='924'>
           if (MemoryOrder(idx:idx) .eq. 'Z') then<a name='925'>
              idx3=idx<a name='926'>
           endif<a name='927'>
        enddo<a name='928'>
<a name='929'>
        <font color=#447700>! <a name='930'></font>
        <font color=#447700>! Allocate space for geopotential values (this variable holds <a name='931'></font>
        <font color=#447700>!   geopotential to be used <a name='932'></font>
        <font color=#447700>!   later to sum base-state and perturbation to get full <a name='933'></font>
        <font color=#447700>!   geopotential).<a name='934'></font>
        <font color=#447700>!<a name='935'></font>
<a name='936'>
        if (.not. ASSOCIATED(geopotential(this_domain)%vals)) then<a name='937'>
           ALLOCATE(geopotential(this_domain)%vals(MemoryStart(1):MemoryEnd(1), &amp;<a name='938'>
                MemoryStart(2):MemoryEnd(2),MemoryStart(3):MemoryEnd(3)))<a name='939'>
        endif<a name='940'>
        if (DateStr .NE. &amp;<a name='941'>
             geopotential(this_domain)%lastDateStr) then<a name='942'>
           geopotential(this_domain)%newtime = .true.<a name='943'>
        endif<a name='944'>
        if (geopotential(this_domain)%newtime) then<a name='945'>
           geopotential(this_domain)%vals = Field(1,:,:,:)<a name='946'>
           geopotential(this_domain)%newtime = .false.<a name='947'>
           output = .false.<a name='948'>
        else <a name='949'>
           output = .true.<a name='950'>
        endif<a name='951'>
        geopotential(this_domain)%lastDateStr=DateStr<a name='952'>
     endif<a name='953'>
#endif<a name='954'>
<a name='955'>
     if (output) then <a name='956'>
        if (StartDate == '') then<a name='957'>
           StartDate = DateStr<a name='958'>
        endif<a name='959'>
        CALL <A href='../../html_code/io_grib_share/io_grib_share.F.html#GETH_IDTS'>geth_idts</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETH_IDTS_3">(DateStr,StartDate,fcst_secs)<a name='960'>
        <a name='961'>
        if (center_lat .lt. 0) then<a name='962'>
           proj_center_flag = 2<a name='963'>
        else<a name='964'>
           proj_center_flag = 1<a name='965'>
        endif<a name='966'>
         <a name='967'>
        do z = 1, zsize<a name='968'>
           SELECT CASE (MemoryOrder)<a name='969'>
           CASE ('XYZ')<a name='970'>
              data = Field(1,1:xsize,1:ysize,z)<a name='971'>
           CASE ('XZY')<a name='972'>
              data = Field(1,1:xsize,z,1:ysize)<a name='973'>
           CASE ('YXZ')<a name='974'>
              do x = 1,xsize<a name='975'>
                 do y = 1,ysize<a name='976'>
                    data(x,y) = Field(1,y,x,z)<a name='977'>
                 enddo<a name='978'>
              enddo<a name='979'>
           CASE ('YZX')<a name='980'>
              do x = 1,xsize<a name='981'>
                 do y = 1,ysize<a name='982'>
                    data(x,y) = Field(1,y,z,x)<a name='983'>
                 enddo<a name='984'>
              enddo<a name='985'>
           CASE ('ZXY')<a name='986'>
              data = Field(1,z,1:xsize,1:ysize)<a name='987'>
           CASE ('ZYX')<a name='988'>
              do x = 1,xsize<a name='989'>
                 do y = 1,ysize<a name='990'>
                    data(x,y) = Field(1,z,y,x)<a name='991'>
                 enddo<a name='992'>
              enddo<a name='993'>
           CASE ('XY')<a name='994'>
              data = Field(1,1:xsize,1:ysize,1)<a name='995'>
           CASE ('YX')<a name='996'>
              do x = 1,xsize<a name='997'>
                 do y = 1,ysize<a name='998'>
                    data(x,y) = Field(1,y,x,1)<a name='999'>
                 enddo<a name='1000'>
              enddo<a name='1001'>
<a name='1002'>
           CASE ('XSZ')<a name='1003'>
              do x = 1,xsize<a name='1004'>
                 do y = 1,ysize<a name='1005'>
                    data(x,y) = Field(1,y,z,x)<a name='1006'>
                 enddo<a name='1007'>
              enddo<a name='1008'>
           CASE ('XEZ')<a name='1009'>
              do x = 1,xsize<a name='1010'>
                 do y = 1,ysize<a name='1011'>
                    data(x,y) = Field(1,y,z,x)<a name='1012'>
                 enddo<a name='1013'>
              enddo<a name='1014'>
           CASE ('YSZ')<a name='1015'>
              do x = 1,xsize<a name='1016'>
                 do y = 1,ysize<a name='1017'>
                    data(x,y) = Field(1,x,z,y)<a name='1018'>
                 enddo<a name='1019'>
              enddo<a name='1020'>
           CASE ('YEZ')<a name='1021'>
              do x = 1,xsize<a name='1022'>
                 do y = 1,ysize<a name='1023'>
                    data(x,y) = Field(1,x,z,y)<a name='1024'>
                 enddo<a name='1025'>
              enddo<a name='1026'>
<a name='1027'>
           CASE ('XS')<a name='1028'>
              do x = 1,xsize<a name='1029'>
                 do y = 1,ysize<a name='1030'>
                    data(x,y) = Field(1,y,x,1)<a name='1031'>
                 enddo<a name='1032'>
              enddo<a name='1033'>
           CASE ('XE')<a name='1034'>
              do x = 1,xsize<a name='1035'>
                 do y = 1,ysize<a name='1036'>
                    data(x,y) = Field(1,y,x,1)<a name='1037'>
                 enddo<a name='1038'>
              enddo<a name='1039'>
           CASE ('YS')<a name='1040'>
              do x = 1,xsize<a name='1041'>
                 do y = 1,ysize<a name='1042'>
                    data(x,y) = Field(1,x,y,1)<a name='1043'>
                 enddo<a name='1044'>
              enddo<a name='1045'>
           CASE ('YE')<a name='1046'>
              do x = 1,xsize<a name='1047'>
                 do y = 1,ysize<a name='1048'>
                    data(x,y) = Field(1,x,y,1)<a name='1049'>
                 enddo<a name='1050'>
              enddo<a name='1051'>
<a name='1052'>
           CASE ('Z')<a name='1053'>
              data(1,1) = Field(1,z,1,1)<a name='1054'>
           CASE ('z')<a name='1055'>
              data(1,1) = Field(1,z,1,1)<a name='1056'>
           CASE ('C')<a name='1057'>
              data = Field(1,1:xsize,1:ysize,z)<a name='1058'>
           CASE ('c')<a name='1059'>
              data = Field(1,1:xsize,1:ysize,z)<a name='1060'>
           CASE ('0')<a name='1061'>
              data(1,1) = Field(1,1,1,1)<a name='1062'>
           END SELECT<a name='1063'>
<a name='1064'>
           <font color=#447700>! <a name='1065'></font>
           <font color=#447700>! Here, we convert any integer fields to real<a name='1066'></font>
           <font color=#447700>!<a name='1067'></font>
           if (FieldType == WRF_INTEGER) then<a name='1068'>
              mold = 0<a name='1069'>
              do idx=1,xsize<a name='1070'>
                 <font color=#447700>!<a name='1071'></font>
                 <font color=#447700>! The parentheses around data(idx,:) are needed in order<a name='1072'></font>
                 <font color=#447700>!   to fix a bug with transfer with the xlf compiler on NCAR's<a name='1073'></font>
                 <font color=#447700>!   IBM (bluesky).<a name='1074'></font>
                 <font color=#447700>!<a name='1075'></font>
                 data(idx,:)=transfer((data(idx,:)),mold)<a name='1076'>
              enddo<a name='1077'>
           endif<a name='1078'>
           <font color=#447700>! <a name='1079'></font>
           <font color=#447700>! Here, we do any necessary conversions to the data.<a name='1080'></font>
           <font color=#447700>!<a name='1081'></font>
           <a name='1082'>
           <font color=#447700>! Potential temperature is sometimes passed in as perturbation <a name='1083'></font>
           <font color=#447700>!   potential temperature (i.e., POT-300).<a name='1084'></font>
           <font color=#447700>!<a name='1085'></font>
           if (OutName == 'T') then<a name='1086'>
              data = data + 300<a name='1087'>
           endif<a name='1088'>
<a name='1089'>
           <font color=#447700>! <a name='1090'></font>
           <font color=#447700>! For precip, we setup the accumulation period, and output a precip<a name='1091'></font>
           <font color=#447700>!    rate for time-step precip.<a name='1092'></font>
           <font color=#447700>!<a name='1093'></font>
           if (OutName .eq. 'RAINNCV') then<a name='1094'>
              <font color=#447700>! Convert time-step precip to precip rate.<a name='1095'></font>
              data = data/timestep<a name='1096'>
              accum_period = 0<a name='1097'>
           else<a name='1098'>
              accum_period = 0<a name='1099'>
           endif<a name='1100'>
 <a name='1101'>
           if ((OutName .eq. 'AFWA_TOTPRECIP') .or. &amp;<a name='1102'>
               (OutName .eq. 'AFWA_RAIN') .or. &amp;<a name='1103'>
               (OutName .eq. 'AFWA_FZRA') .or. &amp;<a name='1104'>
               (OutName .eq. 'AFWA_SNOW') .or. &amp;<a name='1105'>
               (OutName .eq. 'AFWA_SNOWFALL') .or. &amp;<a name='1106'>
               (OutName .eq. 'RAINC') .or. &amp;<a name='1107'>
               (OutName .eq. 'AFWA_ICE')) then<a name='1108'>
               accum_period = fcst_secs<a name='1109'>
           endif<a name='1110'>
<a name='1111'>
#ifdef OUTPUT_FULL_PRESSURE<a name='1112'>
           <font color=#447700>!<a name='1113'></font>
           <font color=#447700>! Computation of full-pressure off by default since there are <a name='1114'></font>
           <font color=#447700>!  uses for base-state and perturbation (i.e., restarts<a name='1115'></font>
           <font color=#447700>!<a name='1116'></font>
            if ((OutName .eq. 'P') .or. (OutName.eq.'PB')) then<a name='1117'>
               if (idx3 .eq. 1) then<a name='1118'>
                  data = data + &amp;<a name='1119'>
                       pressure(this_domain)%vals(z, &amp;<a name='1120'>
                       patchstart(2):patchend(2),patchstart(3):patchend(3))<a name='1121'>
               elseif (idx3 .eq. 2) then<a name='1122'>
                  data = data + &amp;<a name='1123'>
                       pressure(this_domain)%vals(patchstart(1):patchend(1), &amp;<a name='1124'>
                       z,patchstart(3):patchend(3))<a name='1125'>
               elseif (idx3 .eq. 3) then<a name='1126'>
                  data = data + &amp;<a name='1127'>
                       pressure(this_domain)%vals(patchstart(1):patchend(1), &amp;<a name='1128'>
                       patchstart(2):patchend(2),z)<a name='1129'>
               else<a name='1130'>
                  call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1467"> ('error in idx3, continuing')<a name='1131'>
               endif<a name='1132'>
<a name='1133'>
               OutName = 'P'<a name='1134'>
            endif<a name='1135'>
#endif<a name='1136'>
<a name='1137'>
#ifdef OUTPUT_FULL_GEOPOTENTIAL<a name='1138'>
           <font color=#447700>!<a name='1139'></font>
           <font color=#447700>! Computation of full-geopotential off by default since there are <a name='1140'></font>
           <font color=#447700>!  uses for base-state and perturbation (i.e., restarts<a name='1141'></font>
           <font color=#447700>!<a name='1142'></font>
            if ((OutName .eq. 'PHB') .or. (OutName.eq.'PH')) then<a name='1143'>
               if (idx3 .eq. 1) then<a name='1144'>
                  data = data + &amp;<a name='1145'>
                       geopotential(this_domain)%vals(z, &amp;<a name='1146'>
                       patchstart(2):patchend(2),patchstart(3):patchend(3))<a name='1147'>
               elseif (idx3 .eq. 2) then<a name='1148'>
                  data = data + &amp;<a name='1149'>
                       geopotential(this_domain)%vals(patchstart(1):patchend(1), &amp;<a name='1150'>
                       z,patchstart(3):patchend(3))<a name='1151'>
               elseif (idx3 .eq. 3) then<a name='1152'>
                  data = data + &amp;<a name='1153'>
                       geopotential(this_domain)%vals(patchstart(1):patchend(1), &amp;<a name='1154'>
                       patchstart(2):patchend(2),z)<a name='1155'>
               else<a name='1156'>
                  call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1468"> ('error in idx3, continuing')<a name='1157'>
               endif<a name='1158'>
<a name='1159'>
               OutName = 'PHP'<a name='1160'>
            endif<a name='1161'>
#endif<a name='1162'>
<a name='1163'>
           <font color=#447700>!<a name='1164'></font>
           <font color=#447700>!    Output current level<a name='1165'></font>
           <font color=#447700>!<a name='1166'></font>
           CALL load_grid_info(OutName, StartDate, vert_unit, level1(z), &amp;<a name='1167'>
                level2(z), fcst_secs, accum_period, wg_grid_id, projection, &amp;<a name='1168'>
                xsize, ysize, region_center_lat, region_center_lon, dx, dy, &amp;<a name='1169'>
                proj_central_lon, proj_center_flag, truelat1, truelat2, &amp;<a name='1170'>
                grib_tables, grid_info)<a name='1171'>
           <a name='1172'>
           <font color=#447700>!<a name='1173'></font>
           <font color=#447700>! Here, we copy data to a temporary array.  After write_grib,<a name='1174'></font>
           <font color=#447700>!    we copy back from the temporary array to the permanent<a name='1175'></font>
           <font color=#447700>!    array.  write_grib modifies data.  For certain fields that<a name='1176'></font>
           <font color=#447700>!    we use below, we want the original (unmodified) data <a name='1177'></font>
           <font color=#447700>!    values.  This kludge assures that we have the original<a name='1178'></font>
           <font color=#447700>!    values.<a name='1179'></font>
           <font color=#447700>!<a name='1180'></font>
<a name='1181'>
           if ((OutName .eq. 'RAINC') .or. (OutName .eq. 'RAINNC') .or. &amp;<a name='1182'>
                (OutName .eq. 'SNOWH')) then<a name='1183'>
              tmpdata(:,:) = data(:,:)<a name='1184'>
           endif<a name='1185'>
<a name='1186'>
           CALL write_grib(grid_info, FileFd(DataHandle), data)<a name='1187'>
<a name='1188'>
           if ((OutName .eq. 'RAINC') .or. (OutName .eq. 'RAINNC') .or. &amp;<a name='1189'>
                (OutName .eq. 'SNOWH')) then<a name='1190'>
              data(:,:) = tmpdata(:,:)<a name='1191'>
           endif<a name='1192'>
<a name='1193'>
           CALL free_grid_info(grid_info)<a name='1194'>
           <a name='1195'>
           <font color=#447700>!<a name='1196'></font>
           <font color=#447700>! If this is the total accumulated rain, call write_grib again <a name='1197'></font>
           <font color=#447700>!   to output the accumulation since the last output time as well.<a name='1198'></font>
           <font color=#447700>!   This is somewhat of a kludge to meet the requirements of PF.<a name='1199'></font>
           <font color=#447700>!<a name='1200'></font>
           if ((OutName .eq. 'RAINC') .or. (OutName .eq. 'RAINNC') .or. &amp;<a name='1201'>
                (OutName .eq. 'SNOWH')) then<a name='1202'>
              if (OutName .eq. 'RAINC') then<a name='1203'>
                 data(:,:) = data(:,:) - lastdata(this_domain)%rainc(:,:)<a name='1204'>
                 lastdata(this_domain)%rainc(:,:) = tmpdata(:,:)<a name='1205'>
                 accum_period = fcst_secs - &amp;<a name='1206'>
                      lastdata(this_domain)%fcst_secs_rainc<a name='1207'>
                 lastdata(this_domain)%fcst_secs_rainc = fcst_secs<a name='1208'>
                 TmpVarName = 'ACPCP'<a name='1209'>
              else if (OutName .eq. 'RAINNC') then<a name='1210'>
                 tmpdata(:,:) = data(:,:)<a name='1211'>
                 data(:,:) = data(:,:) - lastdata(this_domain)%rainnc(:,:)<a name='1212'>
                 lastdata(this_domain)%rainnc(:,:) = tmpdata(:,:)<a name='1213'>
                 accum_period = fcst_secs - &amp;<a name='1214'>
                      lastdata(this_domain)%fcst_secs_rainnc<a name='1215'>
                 lastdata(this_domain)%fcst_secs_rainnc = fcst_secs<a name='1216'>
                 TmpVarName = 'NCPCP'<a name='1217'>
              else if (OutName .eq. 'SNOWH') then<a name='1218'>
                 if (fcst_secs .eq. 0) then<a name='1219'>
                    firstdata(this_domain)%snod(:,:) = data(:,:)<a name='1220'>
                 endif<a name='1221'>
                 data(:,:) = data(:,:) - firstdata(this_domain)%snod(:,:)<a name='1222'>
                 TmpVarName = 'SNOWCU'<a name='1223'>
              endif<a name='1224'>
<a name='1225'>
              CALL load_grid_info(TmpVarName, StartDate, vert_unit, level1(z),&amp;<a name='1226'>
                   level2(z), fcst_secs, accum_period, wg_grid_id, &amp;<a name='1227'>
                   projection, xsize, ysize, region_center_lat, &amp;<a name='1228'>
                   region_center_lon, dx, dy, proj_central_lon, &amp;<a name='1229'>
                   proj_center_flag, truelat1, truelat2, grib_tables, &amp;<a name='1230'>
                   grid_info)<a name='1231'>
           <a name='1232'>
              CALL write_grib(grid_info, FileFd(DataHandle), data)<a name='1233'>
              CALL free_grid_info(grid_info)<a name='1234'>
           endif<a name='1235'>
<a name='1236'>
        enddo<a name='1237'>
     endif<a name='1238'>
  endif<a name='1239'>
<a name='1240'>
  deallocate(data, STAT = istat)<a name='1241'>
  deallocate(mold, STAT = istat)<a name='1242'>
  deallocate(tmpdata, STAT = istat)<a name='1243'>
<a name='1244'>
  Status = WRF_NO_ERR<a name='1245'>
<a name='1246'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1147"> ( DEBUG , 'Leaving ext_gr1_write_field')<a name='1247'>
<a name='1248'>
  RETURN<a name='1249'>
END SUBROUTINE ext_gr1_write_field<a name='1250'>
<a name='1251'>
<font color=#447700>!*****************************************************************************<a name='1252'></font>
<a name='1253'>
<A NAME='EXT_GR1_READ_FIELD'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1254'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_read_field</font> ( DataHandle , DateStr , VarName , Field , &amp;,<A href='../../call_from/EXT_GR1_READ_FIELD.html' TARGET='index'>10</A><a name='1255'>
     FieldType , Comm , IOComm, DomainDesc , MemoryOrder , Stagger ,     &amp;<a name='1256'>
     DimNames , DomainStart , DomainEnd , MemoryStart , MemoryEnd ,      &amp;<a name='1257'>
     PatchStart , PatchEnd ,  Status )<a name='1258'>
<a name='1259'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_12"><a name='1260'>
  IMPLICIT NONE  <a name='1261'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_21"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1262'>
#include "<A href='../../html_code/include/wrf_io_flags.h.html'>wrf_io_flags.h</A>"<A NAME="wrf_io_flags.h_22"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1263'>
  INTEGER ,       INTENT(IN)    :: DataHandle <a name='1264'>
  CHARACTER*(*) :: DateStr<a name='1265'>
  CHARACTER*(*) :: VarName<a name='1266'>
  CHARACTER (len=400) :: msg<a name='1267'>
  integer                       ,intent(inout)    :: FieldType<a name='1268'>
  integer                       ,intent(inout)    :: Comm<a name='1269'>
  integer                       ,intent(inout)    :: IOComm<a name='1270'>
  integer                       ,intent(inout)    :: DomainDesc<a name='1271'>
  character*(*)                 ,intent(inout)    :: MemoryOrder<a name='1272'>
  character*(*)                 ,intent(inout)    :: Stagger<a name='1273'>
  character*(*) , dimension (*) ,intent(inout)    :: DimNames<a name='1274'>
  integer ,dimension(*)         ,intent(inout)    :: DomainStart, DomainEnd<a name='1275'>
  integer ,dimension(*)         ,intent(inout)    :: MemoryStart, MemoryEnd<a name='1276'>
  integer ,dimension(*)         ,intent(inout)    :: PatchStart,  PatchEnd<a name='1277'>
  integer                       ,intent(out)      :: Status<a name='1278'>
  INTEGER                       ,intent(out)      :: Field(*)<a name='1279'>
  integer   :: ndim,x_start,x_end,y_start,y_end,z_start,z_end<a name='1280'>
  integer   :: zidx<a name='1281'>
  REAL, DIMENSION(:,:), POINTER :: data<a name='1282'>
  logical                     :: vert_stag<a name='1283'>
  logical                     :: soil_layers<a name='1284'>
  integer                     :: level1,level2<a name='1285'>
<a name='1286'>
  integer                     :: parmid<a name='1287'>
  integer                     :: vert_unit<a name='1288'>
  integer                     :: grb_index<a name='1289'>
  integer                     :: numcols, numrows<a name='1290'>
  integer                     :: data_allocated<a name='1291'>
  integer                     :: istat<a name='1292'>
  integer                     :: tablenum<a name='1293'>
  integer                     :: di<a name='1294'>
  integer                     :: last_grb_index<a name='1295'>
  logical                     :: fraction<a name='1296'>
<a name='1297'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1148"> ( DEBUG , 'Entering ext_gr1_read_field')<a name='1298'>
<a name='1299'>
  <font color=#447700>!<a name='1300'></font>
  <font color=#447700>! Get dimensions of data.  <a name='1301'></font>
  <font color=#447700>! Assume that the domain size in the input data is the same as the Domain <a name='1302'></font>
  <font color=#447700>!     Size from the input arguments.<a name='1303'></font>
  <font color=#447700>!<a name='1304'></font>
  <a name='1305'>
  CALL <A href='../../html_code/io_grib_share/io_grib_share.F.html#GET_DIMS'>get_dims</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_DIMS_2">(MemoryOrder,DomainStart,DomainEnd,ndim,x_start,x_end,y_start, &amp;<a name='1306'>
       y_end,z_start,z_end) <a name='1307'>
<a name='1308'>
  <font color=#447700>!<a name='1309'></font>
  <font color=#447700>! Get grib parameter id<a name='1310'></font>
  <font color=#447700>!<a name='1311'></font>
  CALL GET_GRIB_PARAM(grib_tables, VarName, center, subcenter, parmtbl, &amp;<a name='1312'>
       tablenum, parmid)<a name='1313'>
<a name='1314'>
  <font color=#447700>!<a name='1315'></font>
  <font color=#447700>! Setup the vertical unit and levels<a name='1316'></font>
  <font color=#447700>!<a name='1317'></font>
  CALL <A href='../../html_code/io_grib_share/io_grib_share.F.html#GET_VERT_STAG'>get_vert_stag</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_VERT_STAG_2">(VarName,Stagger,vert_stag)<a name='1318'>
  CALL <A href='../../html_code/io_grib_share/io_grib_share.F.html#GET_SOIL_LAYERS'>get_soil_layers</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_SOIL_LAYERS_1">(VarName,soil_layers)<a name='1319'>
<a name='1320'>
  <font color=#447700>!<a name='1321'></font>
  <font color=#447700>! Loop over levels, grabbing data from each level, then assembling into a <a name='1322'></font>
  <font color=#447700>!   3D array.<a name='1323'></font>
  <font color=#447700>!<a name='1324'></font>
  data_allocated = 0<a name='1325'>
  last_grb_index = -1<a name='1326'>
  do zidx = z_start,z_end<a name='1327'>
     <a name='1328'>
     IF ((VarName .eq. 'LANDUSEF') .or. (VarName .eq. 'SOILCBOT') .or. &amp;<a name='1329'>
          (VarName .eq. 'SOILCTOP')) then<a name='1330'>
        fraction = .true.<a name='1331'>
     ELSE<a name='1332'>
        fraction = .false.<a name='1333'>
     END IF<a name='1334'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_GET_LEVELS'>gr1_get_levels</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_GET_LEVELS_2">(VarName,zidx,z_end-z_start,soil_layers,vert_stag,fraction, &amp;<a name='1335'>
          .false., .false., vert_unit,level1,level2)<a name='1336'>
     <a name='1337'>
     CALL GET_GRIB_INDEX_VALIDTIME_GUESS(fileinfo(DataHandle)%fileindex(:), center, &amp;<a name='1338'>
          subcenter, parmtbl, parmid,DateStr,vert_unit,level1, &amp;<a name='1339'>
          level2, last_grb_index + 1, grb_index)<a name='1340'>
     if (grb_index &lt; 0) then<a name='1341'>
        write(msg,*)'Field not found: parmid: ',VarName,parmid,DateStr, &amp;<a name='1342'>
             vert_unit,level1,level2<a name='1343'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1149"> (DEBUG , msg)<a name='1344'>
        cycle<a name='1345'>
     endif<a name='1346'>
<a name='1347'>
     if (data_allocated .eq. 0) then<a name='1348'>
        CALL GET_SIZEOF_GRID(fileinfo(DataHandle)%fileindex(:),grb_index,numcols,numrows)<a name='1349'>
        allocate(data(z_start:z_end,1:numcols*numrows),stat=istat)<a name='1350'>
        data_allocated = 1<a name='1351'>
     endif<a name='1352'>
<a name='1353'>
     CALL READ_GRIB(fileinfo(DataHandle)%fileindex(:), FileFd(DataHandle), grb_index, &amp;<a name='1354'>
          data(zidx,:))<a name='1355'>
<a name='1356'>
     <font color=#447700>!<a name='1357'></font>
     <font color=#447700>! Transpose data into the order specified by MemoryOrder, setting only <a name='1358'></font>
     <font color=#447700>!   entries within the memory dimensions<a name='1359'></font>
     <font color=#447700>!<a name='1360'></font>
     CALL <A href='../../html_code/io_grib_share/io_grib_share.F.html#GET_DIMS'>get_dims</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_DIMS_3">(MemoryOrder, MemoryStart, MemoryEnd, ndim, x_start, x_end, &amp;<a name='1361'>
          y_start, y_end,z_start,z_end)<a name='1362'>
<a name='1363'>
     if(FieldType == WRF_DOUBLE) then<a name='1364'>
        di = 2<a name='1365'>
     else <a name='1366'>
        di = 1<a name='1367'>
     endif<a name='1368'>
<a name='1369'>
     <font color=#447700>! <a name='1370'></font>
     <font color=#447700>! Here, we do any necessary conversions to the data.<a name='1371'></font>
     <font color=#447700>!<a name='1372'></font>
     <font color=#447700>! The WRF executable (wrf.exe) expects perturbation potential<a name='1373'></font>
     <font color=#447700>!   temperature.  However, real.exe expects full potential T.<a name='1374'></font>
     <font color=#447700>! So, if the program is WRF, subtract 300 from Potential Temperature <a name='1375'></font>
     <font color=#447700>!   to get perturbation potential temperature.<a name='1376'></font>
     <font color=#447700>!<a name='1377'></font>
     if (VarName == 'T') then<a name='1378'>
        if ( &amp;<a name='1379'>
             (InputProgramName .eq. 'REAL_EM') .or. &amp;<a name='1380'>
             (InputProgramName .eq. 'IDEAL') .or. &amp;<a name='1381'>
             (InputProgramName .eq. 'NDOWN_EM')) then<a name='1382'>
           data(zidx,:) = data(zidx,:) - 300<a name='1383'>
        endif<a name='1384'>
     endif<a name='1385'>
<a name='1386'>
     CALL <A href='../../html_code/io_grib_share/io_grib_share.F.html#TRANSPOSE_GRIB'>Transpose_grib</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRANSPOSE_GRIB_1">(MemoryOrder, di, FieldType, Field, &amp;<a name='1387'>
          MemoryStart(1), MemoryEnd(1), MemoryStart(2), MemoryEnd(2), &amp;<a name='1388'>
          MemoryStart(3), MemoryEnd(3), &amp;<a name='1389'>
          data(zidx,:), zidx, numrows, numcols)<a name='1390'>
<a name='1391'>
     if (zidx .eq. z_end) then<a name='1392'>
        data_allocated = 0<a name='1393'>
        deallocate(data)<a name='1394'>
     endif<a name='1395'>
<a name='1396'>
     last_grb_index = grb_index<a name='1397'>
<a name='1398'>
  enddo<a name='1399'>
<a name='1400'>
  Status = WRF_NO_ERR<a name='1401'>
  if (grb_index &lt; 0) Status = WRF_WARN_VAR_NF<a name='1402'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1150"> ( DEBUG , 'Leaving ext_gr1_read_field')<a name='1403'>
<a name='1404'>
  RETURN<a name='1405'>
END SUBROUTINE ext_gr1_read_field<a name='1406'>
<a name='1407'>
<font color=#447700>!*****************************************************************************<a name='1408'></font>
<a name='1409'>
<A NAME='EXT_GR1_GET_NEXT_VAR'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_NEXT_VAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1410'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_next_var</font> ( DataHandle, VarName, Status ) <A href='../../call_to/EXT_GR1_GET_NEXT_VAR.html' TARGET='index'>1</A>,<A href='../../call_from/EXT_GR1_GET_NEXT_VAR.html' TARGET='index'>3</A><a name='1411'>
<a name='1412'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_NEXT_VAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_13"><a name='1413'>
  IMPLICIT NONE<a name='1414'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_23"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_NEXT_VAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1415'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='1416'>
  CHARACTER*(*) :: VarName<a name='1417'>
  INTEGER ,       INTENT(OUT) :: Status<a name='1418'>
<a name='1419'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_NEXT_VAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1151"> ( DEBUG , 'Entering ext_gr1_get_next_var')<a name='1420'>
<a name='1421'>
  call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_NEXT_VAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1469"> ( 'WARNING: ext_gr1_get_next_var is not supported.')<a name='1422'>
<a name='1423'>
  Status = WRF_WARN_NOOP<a name='1424'>
<a name='1425'>
  RETURN<a name='1426'>
END SUBROUTINE ext_gr1_get_next_var<a name='1427'>
<a name='1428'>
<font color=#447700>!*****************************************************************************<a name='1429'></font>
<a name='1430'>
<A NAME='EXT_GR1_END_OF_FRAME'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_END_OF_FRAME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1431'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_gr1_end_of_frame</font>(DataHandle, Status),<A href='../../call_from/EXT_GR1_END_OF_FRAME.html' TARGET='index'>2</A><a name='1432'>
<a name='1433'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_END_OF_FRAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_14"><a name='1434'>
  implicit none<a name='1435'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_24"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_END_OF_FRAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1436'>
  integer               ,intent(in)     :: DataHandle<a name='1437'>
  integer               ,intent(out)    :: Status<a name='1438'>
<a name='1439'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_END_OF_FRAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1152"> ( DEBUG , 'Entering ext_gr1_end_of_frame')<a name='1440'>
<a name='1441'>
  Status = WRF_WARN_NOOP<a name='1442'>
<a name='1443'>
  return<a name='1444'>
end subroutine ext_gr1_end_of_frame<a name='1445'>
<a name='1446'>
<font color=#447700>!*****************************************************************************<a name='1447'></font>
<a name='1448'>
<A NAME='EXT_GR1_IOSYNC'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOSYNC' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1449'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_iosync</font> ( DataHandle, Status ) <A href='../../call_to/EXT_GR1_IOSYNC.html' TARGET='index'>3</A>,<A href='../../call_from/EXT_GR1_IOSYNC.html' TARGET='index'>2</A><a name='1450'>
<a name='1451'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOSYNC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_15">  <a name='1452'>
  IMPLICIT NONE<a name='1453'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_25"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOSYNC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1454'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='1455'>
  INTEGER ,       INTENT(OUT) :: Status<a name='1456'>
<a name='1457'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_IOSYNC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1153"> ( DEBUG , 'Entering ext_gr1_iosync')<a name='1458'>
<a name='1459'>
  Status = WRF_NO_ERR<a name='1460'>
  if (DataHandle .GT. 0) then<a name='1461'>
     CALL flush_file(FileFd(DataHandle))<a name='1462'>
  else<a name='1463'>
     Status = WRF_WARN_TOO_MANY_FILES<a name='1464'>
  endif<a name='1465'>
<a name='1466'>
  RETURN<a name='1467'>
END SUBROUTINE ext_gr1_iosync<a name='1468'>
<a name='1469'>
<font color=#447700>!*****************************************************************************<a name='1470'></font>
<a name='1471'>
<A NAME='EXT_GR1_INQUIRE_FILENAME'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRE_FILENAME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1472'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_inquire_filename</font> ( DataHandle, FileName , FileStat, &amp; <A href='../../call_to/EXT_GR1_INQUIRE_FILENAME.html' TARGET='index'>9</A>,<A href='../../call_from/EXT_GR1_INQUIRE_FILENAME.html' TARGET='index'>2</A><a name='1473'>
     Status )<a name='1474'>
<a name='1475'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRE_FILENAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_16"><a name='1476'>
  IMPLICIT NONE<a name='1477'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_26"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRE_FILENAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1478'>
#include "<A href='../../html_code/include/wrf_io_flags.h.html'>wrf_io_flags.h</A>"<A NAME="wrf_io_flags.h_27"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRE_FILENAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1479'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='1480'>
  CHARACTER*(*) :: FileName<a name='1481'>
  INTEGER ,       INTENT(OUT) :: FileStat<a name='1482'>
  INTEGER ,       INTENT(OUT) :: Status<a name='1483'>
  CHARACTER *80   SysDepInfo<a name='1484'>
<a name='1485'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_INQUIRE_FILENAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1154"> ( DEBUG , 'Entering ext_gr1_inquire_filename')<a name='1486'>
<a name='1487'>
  FileName = DataFile(DataHandle) <a name='1488'>
<a name='1489'>
  if ((DataHandle .ge. firstFileHandle) .and. &amp;<a name='1490'>
       (DataHandle .le. maxFileHandles)) then<a name='1491'>
     FileStat = FileStatus(DataHandle)<a name='1492'>
  else<a name='1493'>
     FileStat = WRF_FILE_NOT_OPENED<a name='1494'>
  endif<a name='1495'>
  <a name='1496'>
  Status = WRF_NO_ERR<a name='1497'>
<a name='1498'>
  RETURN<a name='1499'>
END SUBROUTINE ext_gr1_inquire_filename<a name='1500'>
<a name='1501'>
<font color=#447700>!*****************************************************************************<a name='1502'></font>
<a name='1503'>
<A NAME='EXT_GR1_GET_VAR_INFO'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_INFO' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1504'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_info</font> ( DataHandle , VarName , NDim , &amp; <A href='../../call_to/EXT_GR1_GET_VAR_INFO.html' TARGET='index'>1</A>,<A href='../../call_from/EXT_GR1_GET_VAR_INFO.html' TARGET='index'>3</A><a name='1505'>
     MemoryOrder , Stagger , DomainStart , DomainEnd , Status )<a name='1506'>
<a name='1507'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_17"><a name='1508'>
  IMPLICIT NONE<a name='1509'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_28"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1510'>
  integer               ,intent(in)     :: DataHandle<a name='1511'>
  character*(*)         ,intent(in)     :: VarName<a name='1512'>
  integer               ,intent(out)    :: NDim<a name='1513'>
  character*(*)         ,intent(out)    :: MemoryOrder<a name='1514'>
  character*(*)         ,intent(out)    :: Stagger<a name='1515'>
  integer ,dimension(*) ,intent(out)    :: DomainStart, DomainEnd<a name='1516'>
  integer               ,intent(out)    :: Status<a name='1517'>
<a name='1518'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1155"> ( DEBUG , 'Entering ext_gr1_get_var_info')<a name='1519'>
<a name='1520'>
  CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1470">('ext_gr1_get_var_info not supported for grib version1 data')<a name='1521'>
  Status = WRF_NO_ERR<a name='1522'>
<a name='1523'>
  RETURN<a name='1524'>
END SUBROUTINE ext_gr1_get_var_info<a name='1525'>
<a name='1526'>
<font color=#447700>!*****************************************************************************<a name='1527'></font>
<a name='1528'>
<A NAME='EXT_GR1_SET_TIME'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_SET_TIME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1529'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_set_time</font> ( DataHandle, DateStr, Status ) <A href='../../call_to/EXT_GR1_SET_TIME.html' TARGET='index'>1</A>,<A href='../../call_from/EXT_GR1_SET_TIME.html' TARGET='index'>2</A><a name='1530'>
<a name='1531'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_18"><a name='1532'>
  IMPLICIT NONE<a name='1533'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_29"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1534'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='1535'>
  CHARACTER*(*) :: DateStr<a name='1536'>
  INTEGER ,       INTENT(OUT) :: Status<a name='1537'>
  integer       :: found_time<a name='1538'>
  integer       :: idx<a name='1539'>
<a name='1540'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1156"> ( DEBUG , 'Entering ext_gr1_set_time')<a name='1541'>
<a name='1542'>
  found_time = 0<a name='1543'>
  do idx = 1,fileinfo(DataHandle)%NumberTimes<a name='1544'>
     if (fileinfo(DataHandle)%Times(idx) == DateStr) then<a name='1545'>
        found_time = 1<a name='1546'>
        fileinfo(DataHandle)%CurrentTime = idx<a name='1547'>
     endif<a name='1548'>
  enddo<a name='1549'>
  if (found_time == 0) then <a name='1550'>
     Status = WRF_WARN_TIME_NF<a name='1551'>
  else<a name='1552'>
     Status = WRF_NO_ERR<a name='1553'>
  endif<a name='1554'>
<a name='1555'>
  RETURN<a name='1556'>
END SUBROUTINE ext_gr1_set_time<a name='1557'>
<a name='1558'>
<font color=#447700>!*****************************************************************************<a name='1559'></font>
<a name='1560'>
<A NAME='EXT_GR1_GET_NEXT_TIME'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_NEXT_TIME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1561'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_next_time</font> ( DataHandle, DateStr, Status ) <A href='../../call_to/EXT_GR1_GET_NEXT_TIME.html' TARGET='index'>1</A>,<A href='../../call_from/EXT_GR1_GET_NEXT_TIME.html' TARGET='index'>2</A><a name='1562'>
<a name='1563'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_NEXT_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_19"><a name='1564'>
  IMPLICIT NONE<a name='1565'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_30"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_NEXT_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1566'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='1567'>
  CHARACTER*(*) , INTENT(OUT) :: DateStr<a name='1568'>
  INTEGER ,       INTENT(OUT) :: Status<a name='1569'>
<a name='1570'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_NEXT_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1157"> ( DEBUG , 'Entering ext_gr1_get_next_time')<a name='1571'>
<a name='1572'>
  if (fileinfo(DataHandle)%CurrentTime == fileinfo(DataHandle)%NumberTimes) then<a name='1573'>
     Status = WRF_WARN_TIME_EOF<a name='1574'>
  else<a name='1575'>
     fileinfo(DataHandle)%CurrentTime = fileinfo(DataHandle)%CurrentTime + 1<a name='1576'>
     DateStr = fileinfo(DataHandle)%Times(fileinfo(DataHandle)%CurrentTime)<a name='1577'>
     Status = WRF_NO_ERR<a name='1578'>
  endif<a name='1579'>
<a name='1580'>
  RETURN<a name='1581'>
END SUBROUTINE ext_gr1_get_next_time<a name='1582'>
<a name='1583'>
<font color=#447700>!*****************************************************************************<a name='1584'></font>
<a name='1585'>
<A NAME='EXT_GR1_GET_PREVIOUS_TIME'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_PREVIOUS_TIME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1586'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_previous_time</font> ( DataHandle, DateStr, Status ) <A href='../../call_to/EXT_GR1_GET_PREVIOUS_TIME.html' TARGET='index'>1</A>,<A href='../../call_from/EXT_GR1_GET_PREVIOUS_TIME.html' TARGET='index'>2</A><a name='1587'>
<a name='1588'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_PREVIOUS_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_20"><a name='1589'>
  IMPLICIT NONE<a name='1590'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_31"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_PREVIOUS_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1591'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='1592'>
  CHARACTER*(*) :: DateStr<a name='1593'>
  INTEGER ,       INTENT(OUT) :: Status<a name='1594'>
<a name='1595'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_PREVIOUS_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1158"> ( DEBUG , 'Entering ext_gr1_get_previous_time')<a name='1596'>
<a name='1597'>
  if (fileinfo(DataHandle)%CurrentTime &lt;= 0) then<a name='1598'>
     Status = WRF_WARN_TIME_EOF<a name='1599'>
  else<a name='1600'>
     fileinfo(DataHandle)%CurrentTime = fileinfo(DataHandle)%CurrentTime - 1<a name='1601'>
     DateStr = fileinfo(DataHandle)%Times(fileinfo(DataHandle)%CurrentTime)<a name='1602'>
     Status = WRF_NO_ERR<a name='1603'>
  endif<a name='1604'>
<a name='1605'>
  RETURN<a name='1606'>
END SUBROUTINE ext_gr1_get_previous_time<a name='1607'>
<a name='1608'>
<font color=#447700>!******************************************************************************<a name='1609'></font>
<font color=#447700>!* Start of get_var_ti_* routines<a name='1610'></font>
<font color=#447700>!******************************************************************************<a name='1611'></font>
<a name='1612'>
<A NAME='EXT_GR1_GET_VAR_TI_REAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1613'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_ti_real</font> ( DataHandle,Element,  Varname, Data, &amp;,<A href='../../call_from/EXT_GR1_GET_VAR_TI_REAL.html' TARGET='index'>4</A><a name='1614'>
     Count, Outcount, Status )<a name='1615'>
<a name='1616'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_21"><a name='1617'>
  IMPLICIT NONE<a name='1618'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_32"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1619'>
  INTEGER ,       INTENT(IN)    :: DataHandle<a name='1620'>
  CHARACTER*(*) :: Element<a name='1621'>
  CHARACTER*(*) :: VarName <a name='1622'>
  real ,          INTENT(OUT)   :: Data(*)<a name='1623'>
  INTEGER ,       INTENT(IN)    :: Count<a name='1624'>
  INTEGER ,       INTENT(OUT)   :: OutCount<a name='1625'>
  INTEGER ,       INTENT(OUT)   :: Status<a name='1626'>
  INTEGER          :: idx<a name='1627'>
  INTEGER          :: stat<a name='1628'>
  CHARACTER*(1000) :: VALUE<a name='1629'>
<a name='1630'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1159"> ( DEBUG , 'Entering ext_gr1_get_var_ti_real')<a name='1631'>
<a name='1632'>
  Status = WRF_NO_ERR<a name='1633'>
  <a name='1634'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), "none", &amp;<a name='1635'>
       Varname, Value, stat)<a name='1636'>
  if (stat /= 0) then<a name='1637'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1160"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='1638'>
     Status = WRF_WARN_VAR_NF<a name='1639'>
     RETURN<a name='1640'>
  endif<a name='1641'>
<a name='1642'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='1643'>
  if (stat .ne. 0) then<a name='1644'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1471">("Reading data from"//Value//"failed")<a name='1645'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='1646'>
     RETURN<a name='1647'>
  endif<a name='1648'>
  Outcount = idx<a name='1649'>
 <a name='1650'>
  RETURN<a name='1651'>
END SUBROUTINE ext_gr1_get_var_ti_real <a name='1652'>
<a name='1653'>
<font color=#447700>!*****************************************************************************<a name='1654'></font>
<a name='1655'>
<A NAME='EXT_GR1_GET_VAR_TI_REAL8'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_REAL8' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1656'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_ti_real8</font> ( DataHandle,Element,  Varname, Data, &amp;,<A href='../../call_from/EXT_GR1_GET_VAR_TI_REAL8.html' TARGET='index'>4</A><a name='1657'>
     Count, Outcount, Status )<a name='1658'>
<a name='1659'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_22"><a name='1660'>
  IMPLICIT NONE<a name='1661'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_33"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1662'>
  INTEGER ,       INTENT(IN)      :: DataHandle<a name='1663'>
  CHARACTER*(*) :: Element<a name='1664'>
  CHARACTER*(*) :: VarName <a name='1665'>
  real*8 ,        INTENT(OUT)     :: Data(*)<a name='1666'>
  INTEGER ,       INTENT(IN)      :: Count<a name='1667'>
  INTEGER ,       INTENT(OUT)     :: OutCount<a name='1668'>
  INTEGER ,       INTENT(OUT)     :: Status<a name='1669'>
  INTEGER          :: idx<a name='1670'>
  INTEGER          :: stat<a name='1671'>
  CHARACTER*(1000) :: VALUE<a name='1672'>
<a name='1673'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1161"> ( DEBUG , 'Entering ext_gr1_get_var_ti_real8')<a name='1674'>
<a name='1675'>
  Status = WRF_NO_ERR<a name='1676'>
  <a name='1677'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:),TRIM(Element),&amp;<a name='1678'>
       "none",Varname,Value,stat)<a name='1679'>
  if (stat /= 0) then<a name='1680'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1162"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='1681'>
     Status = WRF_WARN_VAR_NF<a name='1682'>
     RETURN<a name='1683'>
  endif<a name='1684'>
<a name='1685'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='1686'>
  if (stat .ne. 0) then<a name='1687'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1472">("Reading data from"//Value//"failed")<a name='1688'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='1689'>
     RETURN<a name='1690'>
  endif<a name='1691'>
  Outcount = idx<a name='1692'>
 <a name='1693'>
  RETURN<a name='1694'>
END SUBROUTINE ext_gr1_get_var_ti_real8 <a name='1695'>
<a name='1696'>
<font color=#447700>!*****************************************************************************<a name='1697'></font>
<a name='1698'>
<A NAME='EXT_GR1_GET_VAR_TI_DOUBLE'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1699'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_ti_double</font> ( DataHandle,Element,  Varname, Data, &amp;,<A href='../../call_from/EXT_GR1_GET_VAR_TI_DOUBLE.html' TARGET='index'>4</A><a name='1700'>
     Count, Outcount, Status )<a name='1701'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_23"><a name='1702'>
  IMPLICIT NONE<a name='1703'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_34"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1704'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='1705'>
  CHARACTER*(*) , INTENT(IN)  :: Element<a name='1706'>
  CHARACTER*(*) , INTENT(IN)  :: VarName<a name='1707'>
  real*8 ,            INTENT(OUT) :: Data(*)<a name='1708'>
  INTEGER ,       INTENT(IN)  :: Count<a name='1709'>
  INTEGER ,       INTENT(OUT)  :: OutCount<a name='1710'>
  INTEGER ,       INTENT(OUT) :: Status<a name='1711'>
  INTEGER          :: idx<a name='1712'>
  INTEGER          :: stat<a name='1713'>
  CHARACTER*(1000) :: VALUE<a name='1714'>
<a name='1715'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1163"> ( DEBUG , 'Entering ext_gr1_get_var_ti_double')<a name='1716'>
<a name='1717'>
  Status = WRF_NO_ERR<a name='1718'>
  <a name='1719'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), &amp;<a name='1720'>
       "none", Varname, &amp;<a name='1721'>
       Value,stat)<a name='1722'>
  if (stat /= 0) then<a name='1723'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1164"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='1724'>
     Status = WRF_WARN_VAR_NF<a name='1725'>
     RETURN<a name='1726'>
  endif<a name='1727'>
<a name='1728'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='1729'>
  if (stat .ne. 0) then<a name='1730'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1473">("Reading data from"//Value//"failed")<a name='1731'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='1732'>
     RETURN<a name='1733'>
  endif<a name='1734'>
  Outcount = idx<a name='1735'>
<a name='1736'>
  RETURN<a name='1737'>
END SUBROUTINE ext_gr1_get_var_ti_double<a name='1738'>
<a name='1739'>
<font color=#447700>!*****************************************************************************<a name='1740'></font>
<a name='1741'>
<A NAME='EXT_GR1_GET_VAR_TI_INTEGER'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1742'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_ti_integer</font> ( DataHandle,Element,  Varname, Data, &amp;,<A href='../../call_from/EXT_GR1_GET_VAR_TI_INTEGER.html' TARGET='index'>4</A><a name='1743'>
     Count, Outcount, Status )<a name='1744'>
<a name='1745'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_24"><a name='1746'>
  IMPLICIT NONE<a name='1747'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_35"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1748'>
  INTEGER ,       INTENT(IN)       :: DataHandle<a name='1749'>
  CHARACTER*(*) :: Element<a name='1750'>
  CHARACTER*(*) :: VarName <a name='1751'>
  integer ,       INTENT(OUT)      :: Data(*)<a name='1752'>
  INTEGER ,       INTENT(IN)       :: Count<a name='1753'>
  INTEGER ,       INTENT(OUT)      :: OutCount<a name='1754'>
  INTEGER ,       INTENT(OUT)      :: Status<a name='1755'>
  INTEGER          :: idx<a name='1756'>
  INTEGER          :: stat<a name='1757'>
  CHARACTER*(1000) :: VALUE<a name='1758'>
<a name='1759'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1165"> ( DEBUG , 'Entering ext_gr1_get_var_ti_integer')<a name='1760'>
<a name='1761'>
  Status = WRF_NO_ERR<a name='1762'>
  <a name='1763'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), &amp;<a name='1764'>
       "none", Varname, Value, stat)<a name='1765'>
  if (stat /= 0) then<a name='1766'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1166"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='1767'>
     Status = WRF_WARN_VAR_NF<a name='1768'>
     RETURN<a name='1769'>
  endif<a name='1770'>
<a name='1771'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='1772'>
  if (stat .ne. 0) then<a name='1773'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1474">("Reading data from"//Value//"failed")<a name='1774'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='1775'>
     RETURN<a name='1776'>
  endif<a name='1777'>
  Outcount = idx<a name='1778'>
<a name='1779'>
  RETURN<a name='1780'>
END SUBROUTINE ext_gr1_get_var_ti_integer <a name='1781'>
<a name='1782'>
<font color=#447700>!*****************************************************************************<a name='1783'></font>
<a name='1784'>
<A NAME='EXT_GR1_GET_VAR_TI_LOGICAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1785'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_ti_logical</font> ( DataHandle,Element,  Varname, Data, &amp;,<A href='../../call_from/EXT_GR1_GET_VAR_TI_LOGICAL.html' TARGET='index'>4</A><a name='1786'>
     Count, Outcount, Status )<a name='1787'>
<a name='1788'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_25"><a name='1789'>
  IMPLICIT NONE<a name='1790'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_36"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1791'>
  INTEGER ,       INTENT(IN)       :: DataHandle<a name='1792'>
  CHARACTER*(*) :: Element<a name='1793'>
  CHARACTER*(*) :: VarName <a name='1794'>
  logical ,       INTENT(OUT)      :: Data(*)<a name='1795'>
  INTEGER ,       INTENT(IN)       :: Count<a name='1796'>
  INTEGER ,       INTENT(OUT)      :: OutCount<a name='1797'>
  INTEGER ,       INTENT(OUT)      :: Status<a name='1798'>
  INTEGER          :: idx<a name='1799'>
  INTEGER          :: stat<a name='1800'>
  CHARACTER*(1000) :: VALUE<a name='1801'>
<a name='1802'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1167"> ( DEBUG , 'Entering ext_gr1_get_var_ti_logical')<a name='1803'>
<a name='1804'>
  Status = WRF_NO_ERR<a name='1805'>
  <a name='1806'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), &amp;<a name='1807'>
       "none", Varname, Value,stat)<a name='1808'>
  if (stat /= 0) then<a name='1809'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1168"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='1810'>
     Status = WRF_WARN_VAR_NF<a name='1811'>
     RETURN<a name='1812'>
  endif<a name='1813'>
<a name='1814'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='1815'>
  if (stat .ne. 0) then<a name='1816'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1475">("Reading data from"//Value//"failed")<a name='1817'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='1818'>
     RETURN<a name='1819'>
  endif<a name='1820'>
  Outcount = idx<a name='1821'>
<a name='1822'>
  RETURN<a name='1823'>
END SUBROUTINE ext_gr1_get_var_ti_logical <a name='1824'>
<a name='1825'>
<font color=#447700>!*****************************************************************************<a name='1826'></font>
<a name='1827'>
<A NAME='EXT_GR1_GET_VAR_TI_CHAR'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1828'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_ti_char</font> ( DataHandle,Element,  Varname, Data,  &amp;,<A href='../../call_from/EXT_GR1_GET_VAR_TI_CHAR.html' TARGET='index'>3</A><a name='1829'>
     Status )<a name='1830'>
<a name='1831'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_26"><a name='1832'>
  IMPLICIT NONE<a name='1833'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_37"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1834'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='1835'>
  CHARACTER*(*) :: Element<a name='1836'>
  CHARACTER*(*) :: VarName <a name='1837'>
  CHARACTER*(*) :: Data<a name='1838'>
  INTEGER ,       INTENT(OUT) :: Status<a name='1839'>
  INTEGER       :: stat<a name='1840'>
<a name='1841'>
  Status = WRF_NO_ERR<a name='1842'>
  <a name='1843'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1169"> ( DEBUG , 'Entering ext_gr1_get_var_ti_char')<a name='1844'>
<a name='1845'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), &amp;<a name='1846'>
       "none", Varname, Data,stat)<a name='1847'>
  if (stat /= 0) then<a name='1848'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1170"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='1849'>
     Status = WRF_WARN_VAR_NF<a name='1850'>
     RETURN<a name='1851'>
  endif<a name='1852'>
<a name='1853'>
  RETURN<a name='1854'>
END SUBROUTINE ext_gr1_get_var_ti_char <a name='1855'>
<a name='1856'>
<font color=#447700>!******************************************************************************<a name='1857'></font>
<font color=#447700>!* End of get_var_ti_* routines<a name='1858'></font>
<font color=#447700>!******************************************************************************<a name='1859'></font>
<a name='1860'>
<a name='1861'>
<font color=#447700>!******************************************************************************<a name='1862'></font>
<font color=#447700>!* Start of put_var_ti_* routines<a name='1863'></font>
<font color=#447700>!******************************************************************************<a name='1864'></font>
<a name='1865'>
<A NAME='EXT_GR1_PUT_VAR_TI_REAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1866'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_var_ti_real</font> ( DataHandle,Element,  Varname, Data, &amp;,<A href='../../call_from/EXT_GR1_PUT_VAR_TI_REAL.html' TARGET='index'>3</A><a name='1867'>
     Count,  Status )<a name='1868'>
<a name='1869'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_27"><a name='1870'>
  IMPLICIT NONE<a name='1871'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_38"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1872'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='1873'>
  CHARACTER*(*) :: Element<a name='1874'>
  CHARACTER*(*) :: VarName <a name='1875'>
  real ,          INTENT(IN)  :: Data(*)<a name='1876'>
  INTEGER ,       INTENT(IN)  :: Count<a name='1877'>
  INTEGER ,       INTENT(OUT) :: Status<a name='1878'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='1879'>
  INTEGER             :: idx<a name='1880'>
<a name='1881'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1171"> ( DEBUG , 'Entering ext_gr1_put_var_ti_real')<a name='1882'>
<a name='1883'>
  if (committed(DataHandle)) then<a name='1884'>
<a name='1885'>
     do idx = 1,Count<a name='1886'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='1887'>
     enddo<a name='1888'>
<a name='1889'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_1"> (ti_output(DataHandle), Element, tmpstr, Count, Status)<a name='1890'>
<a name='1891'>
  endif<a name='1892'>
<a name='1893'>
  RETURN<a name='1894'>
END SUBROUTINE ext_gr1_put_var_ti_real <a name='1895'>
<a name='1896'>
<font color=#447700>!*****************************************************************************<a name='1897'></font>
<a name='1898'>
<A NAME='EXT_GR1_PUT_VAR_TI_DOUBLE'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1899'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_var_ti_double</font> ( DataHandle,Element,  Varname, Data, &amp;,<A href='../../call_from/EXT_GR1_PUT_VAR_TI_DOUBLE.html' TARGET='index'>3</A><a name='1900'>
     Count,  Status )<a name='1901'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_28"><a name='1902'>
  IMPLICIT NONE<a name='1903'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_39"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1904'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='1905'>
  CHARACTER*(*) , INTENT(IN)  :: Element<a name='1906'>
  CHARACTER*(*) , INTENT(IN)  :: VarName<a name='1907'>
  real*8 ,            INTENT(IN) :: Data(*)<a name='1908'>
  INTEGER ,       INTENT(IN)  :: Count<a name='1909'>
  INTEGER ,       INTENT(OUT) :: Status<a name='1910'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='1911'>
  INTEGER             :: idx<a name='1912'>
<a name='1913'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1172"> ( DEBUG , 'Entering ext_gr1_put_var_ti_double')<a name='1914'>
<a name='1915'>
  if (committed(DataHandle)) then<a name='1916'>
<a name='1917'>
     do idx = 1,Count<a name='1918'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='1919'>
     enddo<a name='1920'>
     <a name='1921'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_2"> (ti_output(DataHandle), Element, tmpstr, Count, Status)<a name='1922'>
  endif<a name='1923'>
<a name='1924'>
  RETURN<a name='1925'>
END SUBROUTINE ext_gr1_put_var_ti_double<a name='1926'>
<a name='1927'>
<font color=#447700>!*****************************************************************************<a name='1928'></font>
<a name='1929'>
<A NAME='EXT_GR1_PUT_VAR_TI_REAL8'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_REAL8' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1930'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_var_ti_real8</font> ( DataHandle,Element,  Varname, Data, &amp;,<A href='../../call_from/EXT_GR1_PUT_VAR_TI_REAL8.html' TARGET='index'>3</A><a name='1931'>
     Count,  Status )<a name='1932'>
<a name='1933'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_29"><a name='1934'>
  IMPLICIT NONE<a name='1935'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_40"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1936'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='1937'>
  CHARACTER*(*) :: Element<a name='1938'>
  CHARACTER*(*) :: VarName <a name='1939'>
  real*8 ,        INTENT(IN)  :: Data(*)<a name='1940'>
  INTEGER ,       INTENT(IN)  :: Count<a name='1941'>
  INTEGER ,       INTENT(OUT) :: Status<a name='1942'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='1943'>
  INTEGER             :: idx<a name='1944'>
<a name='1945'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1173"> ( DEBUG , 'Entering ext_gr1_put_var_ti_real8')<a name='1946'>
<a name='1947'>
  if (committed(DataHandle)) then<a name='1948'>
<a name='1949'>
     do idx = 1,Count<a name='1950'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='1951'>
     enddo<a name='1952'>
     <a name='1953'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_3"> (ti_output(DataHandle), Element, tmpstr, Count, Status)<a name='1954'>
  endif<a name='1955'>
<a name='1956'>
  RETURN<a name='1957'>
END SUBROUTINE ext_gr1_put_var_ti_real8 <a name='1958'>
<a name='1959'>
<font color=#447700>!*****************************************************************************<a name='1960'></font>
<a name='1961'>
<A NAME='EXT_GR1_PUT_VAR_TI_INTEGER'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1962'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_var_ti_integer</font> ( DataHandle,Element,  Varname, Data, &amp;,<A href='../../call_from/EXT_GR1_PUT_VAR_TI_INTEGER.html' TARGET='index'>3</A><a name='1963'>
     Count,  Status )<a name='1964'>
<a name='1965'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_30"><a name='1966'>
  IMPLICIT NONE<a name='1967'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_41"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1968'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='1969'>
  CHARACTER*(*) :: Element<a name='1970'>
  CHARACTER*(*) :: VarName <a name='1971'>
  integer ,       INTENT(IN)  :: Data(*)<a name='1972'>
  INTEGER ,       INTENT(IN)  :: Count<a name='1973'>
  INTEGER ,       INTENT(OUT) :: Status<a name='1974'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='1975'>
  INTEGER             :: idx<a name='1976'>
<a name='1977'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1174"> ( DEBUG , 'Entering ext_gr1_put_var_ti_integer')<a name='1978'>
<a name='1979'>
  if (committed(DataHandle)) then<a name='1980'>
<a name='1981'>
     do idx = 1,Count<a name='1982'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='1983'>
     enddo<a name='1984'>
     <a name='1985'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_4"> (ti_output(DataHandle), Element, tmpstr, Count, Status)<a name='1986'>
  endif<a name='1987'>
<a name='1988'>
  RETURN<a name='1989'>
END SUBROUTINE ext_gr1_put_var_ti_integer <a name='1990'>
<a name='1991'>
<font color=#447700>!*****************************************************************************<a name='1992'></font>
<a name='1993'>
<A NAME='EXT_GR1_PUT_VAR_TI_LOGICAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1994'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_var_ti_logical</font> ( DataHandle,Element,  Varname, Data, &amp;,<A href='../../call_from/EXT_GR1_PUT_VAR_TI_LOGICAL.html' TARGET='index'>3</A><a name='1995'>
     Count,  Status )<a name='1996'>
<a name='1997'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_31"><a name='1998'>
  IMPLICIT NONE<a name='1999'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_42"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2000'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2001'>
  CHARACTER*(*) :: Element<a name='2002'>
  CHARACTER*(*) :: VarName <a name='2003'>
  logical ,       INTENT(IN)  :: Data(*)<a name='2004'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2005'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2006'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='2007'>
  INTEGER             :: idx<a name='2008'>
<a name='2009'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1175"> ( DEBUG , 'Entering ext_gr1_put_var_ti_logical')<a name='2010'>
<a name='2011'>
  if (committed(DataHandle)) then<a name='2012'>
<a name='2013'>
     do idx = 1,Count<a name='2014'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='2015'>
     enddo<a name='2016'>
     <a name='2017'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_5"> (ti_output(DataHandle), Element, tmpstr, Count, Status)<a name='2018'>
<a name='2019'>
  endif<a name='2020'>
<a name='2021'>
RETURN<a name='2022'>
END SUBROUTINE ext_gr1_put_var_ti_logical <a name='2023'>
<a name='2024'>
<font color=#447700>!*****************************************************************************<a name='2025'></font>
<a name='2026'>
<A NAME='EXT_GR1_PUT_VAR_TI_CHAR'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2027'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_var_ti_char</font> ( DataHandle,Element,  Varname, Data,  &amp; <A href='../../call_to/EXT_GR1_PUT_VAR_TI_CHAR.html' TARGET='index'>4</A>,<A href='../../call_from/EXT_GR1_PUT_VAR_TI_CHAR.html' TARGET='index'>3</A><a name='2028'>
     Status )<a name='2029'>
<a name='2030'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_32"><a name='2031'>
  IMPLICIT NONE<a name='2032'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_43"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2033'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2034'>
  CHARACTER(len=*) :: Element<a name='2035'>
  CHARACTER(len=*) :: VarName <a name='2036'>
  CHARACTER(len=*) :: Data<a name='2037'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2038'>
  REAL dummy<a name='2039'>
  INTEGER                     :: Count<a name='2040'>
  CHARACTER(len=1000) :: tmpstr(1)<a name='2041'>
  INTEGER             :: idx<a name='2042'>
<a name='2043'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1176"> ( DEBUG , 'Entering ext_gr1_put_var_ti_char')<a name='2044'>
<a name='2045'>
  if (committed(DataHandle)) then<a name='2046'>
<a name='2047'>
     write(tmpstr(1),*)trim(Data)<a name='2048'>
<a name='2049'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_6"> (ti_output(DataHandle), Element, tmpstr, 1, Status)<a name='2050'>
<a name='2051'>
  endif<a name='2052'>
<a name='2053'>
  RETURN<a name='2054'>
END SUBROUTINE ext_gr1_put_var_ti_char <a name='2055'>
<a name='2056'>
<font color=#447700>!******************************************************************************<a name='2057'></font>
<font color=#447700>!* End of put_var_ti_* routines<a name='2058'></font>
<font color=#447700>!******************************************************************************<a name='2059'></font>
<a name='2060'>
<font color=#447700>!******************************************************************************<a name='2061'></font>
<font color=#447700>!* Start of get_var_td_* routines<a name='2062'></font>
<font color=#447700>!******************************************************************************<a name='2063'></font>
<a name='2064'>
<A NAME='EXT_GR1_GET_VAR_TD_DOUBLE'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2065'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_td_double</font> ( DataHandle,Element,  DateStr, &amp;,<A href='../../call_from/EXT_GR1_GET_VAR_TD_DOUBLE.html' TARGET='index'>4</A><a name='2066'>
     Varname, Data, Count, Outcount, Status )<a name='2067'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_33"><a name='2068'>
  IMPLICIT NONE<a name='2069'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_44"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2070'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2071'>
  CHARACTER*(*) , INTENT(IN)  :: Element<a name='2072'>
  CHARACTER*(*) , INTENT(IN)  :: DateStr<a name='2073'>
  CHARACTER*(*) , INTENT(IN)  :: VarName<a name='2074'>
  real*8 ,            INTENT(OUT) :: Data(*)<a name='2075'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2076'>
  INTEGER ,       INTENT(OUT)  :: OutCount<a name='2077'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2078'>
  INTEGER          :: idx<a name='2079'>
  INTEGER          :: stat<a name='2080'>
  CHARACTER*(1000) :: VALUE<a name='2081'>
<a name='2082'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1177"> ( DEBUG , 'Entering ext_gr1_get_var_td_double')<a name='2083'>
<a name='2084'>
  Status = WRF_NO_ERR<a name='2085'>
  <a name='2086'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:),TRIM(Element),DateStr,&amp;<a name='2087'>
       Varname,Value,stat)<a name='2088'>
  if (stat /= 0) then<a name='2089'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1178"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='2090'>
     Status = WRF_WARN_VAR_NF<a name='2091'>
     RETURN<a name='2092'>
  endif<a name='2093'>
<a name='2094'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='2095'>
  if (stat .ne. 0) then<a name='2096'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1476">("Reading data from"//Value//"failed")<a name='2097'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='2098'>
     RETURN<a name='2099'>
  endif<a name='2100'>
  Outcount = idx<a name='2101'>
<a name='2102'>
RETURN<a name='2103'>
END SUBROUTINE ext_gr1_get_var_td_double<a name='2104'>
<a name='2105'>
<font color=#447700>!*****************************************************************************<a name='2106'></font>
<a name='2107'>
<A NAME='EXT_GR1_GET_VAR_TD_REAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2108'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_td_real</font> ( DataHandle,Element,  DateStr,Varname, &amp;,<A href='../../call_from/EXT_GR1_GET_VAR_TD_REAL.html' TARGET='index'>4</A><a name='2109'>
     Data, Count, Outcount, Status )<a name='2110'>
<a name='2111'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_34"><a name='2112'>
  IMPLICIT NONE<a name='2113'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_45"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2114'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2115'>
  CHARACTER*(*) :: Element<a name='2116'>
  CHARACTER*(*) :: DateStr<a name='2117'>
  CHARACTER*(*) :: VarName <a name='2118'>
  real ,          INTENT(OUT) :: Data(*)<a name='2119'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2120'>
  INTEGER ,       INTENT(OUT) :: OutCount<a name='2121'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2122'>
  INTEGER          :: idx<a name='2123'>
  INTEGER          :: stat<a name='2124'>
  CHARACTER*(1000) :: VALUE<a name='2125'>
<a name='2126'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1179"> ( DEBUG , 'Entering ext_gr1_get_var_td_real')<a name='2127'>
<a name='2128'>
  Status = WRF_NO_ERR<a name='2129'>
  <a name='2130'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), DateStr, &amp;<a name='2131'>
       Varname, Value, stat)<a name='2132'>
  if (stat /= 0) then<a name='2133'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1180"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='2134'>
     Status = WRF_WARN_VAR_NF<a name='2135'>
     RETURN<a name='2136'>
  endif<a name='2137'>
<a name='2138'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='2139'>
  if (stat .ne. 0) then<a name='2140'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1477">("Reading data from"//Value//"failed")<a name='2141'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='2142'>
     RETURN<a name='2143'>
  endif<a name='2144'>
  Outcount = idx<a name='2145'>
<a name='2146'>
  RETURN<a name='2147'>
END SUBROUTINE ext_gr1_get_var_td_real <a name='2148'>
<a name='2149'>
<font color=#447700>!*****************************************************************************<a name='2150'></font>
<a name='2151'>
<A NAME='EXT_GR1_GET_VAR_TD_REAL8'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_REAL8' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2152'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_td_real8</font> ( DataHandle,Element,  DateStr,Varname, &amp;,<A href='../../call_from/EXT_GR1_GET_VAR_TD_REAL8.html' TARGET='index'>4</A><a name='2153'>
     Data, Count, Outcount, Status )<a name='2154'>
<a name='2155'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_35"><a name='2156'>
  IMPLICIT NONE<a name='2157'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_46"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2158'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2159'>
  CHARACTER*(*) :: Element<a name='2160'>
  CHARACTER*(*) :: DateStr<a name='2161'>
  CHARACTER*(*) :: VarName <a name='2162'>
  real*8 ,        INTENT(OUT) :: Data(*)<a name='2163'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2164'>
  INTEGER ,       INTENT(OUT) :: OutCount<a name='2165'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2166'>
  INTEGER          :: idx<a name='2167'>
  INTEGER          :: stat<a name='2168'>
  CHARACTER*(1000) :: VALUE<a name='2169'>
<a name='2170'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1181"> ( DEBUG , 'Entering ext_gr1_get_var_td_real8')<a name='2171'>
<a name='2172'>
  Status = WRF_NO_ERR<a name='2173'>
  <a name='2174'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:),TRIM(Element),DateStr,&amp;<a name='2175'>
       Varname,Value,stat)<a name='2176'>
  if (stat /= 0) then<a name='2177'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1182"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='2178'>
     Status = WRF_WARN_VAR_NF<a name='2179'>
     RETURN<a name='2180'>
  endif<a name='2181'>
<a name='2182'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='2183'>
  if (stat .ne. 0) then<a name='2184'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1478">("Reading data from"//Value//"failed")<a name='2185'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='2186'>
     RETURN<a name='2187'>
  endif<a name='2188'>
  Outcount = idx<a name='2189'>
<a name='2190'>
  RETURN<a name='2191'>
END SUBROUTINE ext_gr1_get_var_td_real8 <a name='2192'>
<a name='2193'>
<font color=#447700>!*****************************************************************************<a name='2194'></font>
<a name='2195'>
<A NAME='EXT_GR1_GET_VAR_TD_INTEGER'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2196'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_td_integer</font> ( DataHandle,Element,  DateStr,Varname, &amp;,<A href='../../call_from/EXT_GR1_GET_VAR_TD_INTEGER.html' TARGET='index'>4</A><a name='2197'>
     Data, Count, Outcount, Status )<a name='2198'>
<a name='2199'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_36"><a name='2200'>
  IMPLICIT NONE<a name='2201'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_47"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2202'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2203'>
  CHARACTER*(*) :: Element<a name='2204'>
  CHARACTER*(*) :: DateStr<a name='2205'>
  CHARACTER*(*) :: VarName <a name='2206'>
  integer ,       INTENT(OUT) :: Data(*)<a name='2207'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2208'>
  INTEGER ,       INTENT(OUT) :: OutCount<a name='2209'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2210'>
  INTEGER          :: idx<a name='2211'>
  INTEGER          :: stat<a name='2212'>
  CHARACTER*(1000) :: VALUE<a name='2213'>
<a name='2214'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1183"> ( DEBUG , 'Entering ext_gr1_get_var_td_integer')<a name='2215'>
<a name='2216'>
  Status = WRF_NO_ERR<a name='2217'>
  <a name='2218'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), DateStr, &amp;<a name='2219'>
       Varname, Value,stat)<a name='2220'>
  if (stat /= 0) then<a name='2221'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1184"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='2222'>
     Status = WRF_WARN_VAR_NF<a name='2223'>
     RETURN<a name='2224'>
  endif<a name='2225'>
<a name='2226'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='2227'>
  if (stat .ne. 0) then<a name='2228'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1479">("Reading data from"//Value//"failed")<a name='2229'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='2230'>
     RETURN<a name='2231'>
  endif<a name='2232'>
  Outcount = idx<a name='2233'>
<a name='2234'>
  RETURN<a name='2235'>
END SUBROUTINE ext_gr1_get_var_td_integer <a name='2236'>
<a name='2237'>
<font color=#447700>!*****************************************************************************<a name='2238'></font>
<a name='2239'>
<A NAME='EXT_GR1_GET_VAR_TD_LOGICAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2240'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_td_logical</font> ( DataHandle,Element,  DateStr,Varname, &amp;,<A href='../../call_from/EXT_GR1_GET_VAR_TD_LOGICAL.html' TARGET='index'>4</A><a name='2241'>
     Data, Count, Outcount, Status )<a name='2242'>
  <a name='2243'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_37"><a name='2244'>
  IMPLICIT NONE<a name='2245'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_48"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2246'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2247'>
  CHARACTER*(*) :: Element<a name='2248'>
  CHARACTER*(*) :: DateStr<a name='2249'>
  CHARACTER*(*) :: VarName <a name='2250'>
  logical ,       INTENT(OUT) :: Data(*)<a name='2251'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2252'>
  INTEGER ,       INTENT(OUT) :: OutCount<a name='2253'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2254'>
  INTEGER          :: idx<a name='2255'>
  INTEGER          :: stat<a name='2256'>
  CHARACTER*(1000) :: VALUE<a name='2257'>
<a name='2258'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1185"> ( DEBUG , 'Entering ext_gr1_get_var_td_logical')<a name='2259'>
<a name='2260'>
  Status = WRF_NO_ERR<a name='2261'>
  <a name='2262'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), DateStr, &amp;<a name='2263'>
       Varname, Value,stat)<a name='2264'>
  if (stat /= 0) then<a name='2265'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1186"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='2266'>
     Status = WRF_WARN_VAR_NF<a name='2267'>
     RETURN<a name='2268'>
  endif<a name='2269'>
<a name='2270'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='2271'>
  if (stat .ne. 0) then<a name='2272'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1480">("Reading data from"//Value//"failed")<a name='2273'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='2274'>
     RETURN<a name='2275'>
  endif<a name='2276'>
  Outcount = idx<a name='2277'>
<a name='2278'>
  RETURN<a name='2279'>
END SUBROUTINE ext_gr1_get_var_td_logical <a name='2280'>
<a name='2281'>
<font color=#447700>!*****************************************************************************<a name='2282'></font>
<a name='2283'>
<A NAME='EXT_GR1_GET_VAR_TD_CHAR'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2284'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_var_td_char</font> ( DataHandle,Element,  DateStr,Varname, &amp;,<A href='../../call_from/EXT_GR1_GET_VAR_TD_CHAR.html' TARGET='index'>3</A><a name='2285'>
     Data,  Status )<a name='2286'>
<a name='2287'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_38"><a name='2288'>
  IMPLICIT NONE<a name='2289'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_49"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2290'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2291'>
  CHARACTER*(*) :: Element<a name='2292'>
  CHARACTER*(*) :: DateStr<a name='2293'>
  CHARACTER*(*) :: VarName <a name='2294'>
  CHARACTER*(*) :: Data<a name='2295'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2296'>
  INTEGER       :: stat<a name='2297'>
<a name='2298'>
  Status = WRF_NO_ERR<a name='2299'>
  <a name='2300'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1187"> ( DEBUG , 'Entering ext_gr1_get_var_td_char')<a name='2301'>
<a name='2302'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), DateStr, &amp;<a name='2303'>
       Varname, Data,stat)<a name='2304'>
  if (stat /= 0) then<a name='2305'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_VAR_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1188"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='2306'>
     Status = WRF_WARN_VAR_NF<a name='2307'>
     RETURN<a name='2308'>
  endif<a name='2309'>
<a name='2310'>
  RETURN<a name='2311'>
END SUBROUTINE ext_gr1_get_var_td_char <a name='2312'>
<a name='2313'>
<font color=#447700>!******************************************************************************<a name='2314'></font>
<font color=#447700>!* End of get_var_td_* routines<a name='2315'></font>
<font color=#447700>!******************************************************************************<a name='2316'></font>
<a name='2317'>
<font color=#447700>!******************************************************************************<a name='2318'></font>
<font color=#447700>!* Start of put_var_td_* routines<a name='2319'></font>
<font color=#447700>!******************************************************************************<a name='2320'></font>
<a name='2321'>
<A NAME='EXT_GR1_PUT_VAR_TD_DOUBLE'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2322'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_var_td_double</font> ( DataHandle, Element, DateStr, Varname, &amp;,<A href='../../call_from/EXT_GR1_PUT_VAR_TD_DOUBLE.html' TARGET='index'>3</A><a name='2323'>
     Data, Count,  Status )<a name='2324'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_39"><a name='2325'>
  IMPLICIT NONE<a name='2326'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_50"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2327'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2328'>
  CHARACTER*(*) , INTENT(IN)  :: Element<a name='2329'>
  CHARACTER*(*) , INTENT(IN)  :: DateStr<a name='2330'>
  CHARACTER*(*) , INTENT(IN)  :: VarName<a name='2331'>
  real*8 ,            INTENT(IN) :: Data(*)<a name='2332'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2333'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2334'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='2335'>
  INTEGER             :: idx<a name='2336'>
<a name='2337'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1189"> ( DEBUG , 'Entering ext_gr1_put_var_td_double')<a name='2338'>
<a name='2339'>
<a name='2340'>
  if (committed(DataHandle)) then<a name='2341'>
<a name='2342'>
     do idx = 1,Count<a name='2343'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='2344'>
     enddo<a name='2345'>
<a name='2346'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_7"> (td_output(DataHandle), &amp;<a name='2347'>
          Varname//';'//DateStr//';'//Element, tmpstr, Count, Status)<a name='2348'>
<a name='2349'>
  endif<a name='2350'>
<a name='2351'>
RETURN<a name='2352'>
END SUBROUTINE ext_gr1_put_var_td_double<a name='2353'>
<a name='2354'>
<font color=#447700>!*****************************************************************************<a name='2355'></font>
<a name='2356'>
<A NAME='EXT_GR1_PUT_VAR_TD_INTEGER'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2357'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_var_td_integer</font> ( DataHandle,Element,  DateStr, &amp;,<A href='../../call_from/EXT_GR1_PUT_VAR_TD_INTEGER.html' TARGET='index'>3</A><a name='2358'>
     Varname, Data, Count,  Status )<a name='2359'>
<a name='2360'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_40"><a name='2361'>
  IMPLICIT NONE<a name='2362'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_51"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2363'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2364'>
  CHARACTER*(*) :: Element<a name='2365'>
  CHARACTER*(*) :: DateStr<a name='2366'>
  CHARACTER*(*) :: VarName <a name='2367'>
  integer ,       INTENT(IN)  :: Data(*)<a name='2368'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2369'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2370'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='2371'>
  INTEGER             :: idx<a name='2372'>
<a name='2373'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1190"> ( DEBUG , 'Entering ext_gr1_put_var_td_integer')<a name='2374'>
<a name='2375'>
  if (committed(DataHandle)) then<a name='2376'>
<a name='2377'>
     do idx = 1,Count<a name='2378'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='2379'>
     enddo<a name='2380'>
     <a name='2381'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_8"> (td_output(DataHandle), &amp;<a name='2382'>
          Varname//';'//DateStr//';'//Element, tmpstr, Count, Status)<a name='2383'>
<a name='2384'>
  endif<a name='2385'>
<a name='2386'>
RETURN<a name='2387'>
END SUBROUTINE ext_gr1_put_var_td_integer <a name='2388'>
<a name='2389'>
<font color=#447700>!*****************************************************************************<a name='2390'></font>
<a name='2391'>
<A NAME='EXT_GR1_PUT_VAR_TD_REAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2392'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_var_td_real</font> ( DataHandle,Element,  DateStr,Varname, &amp;,<A href='../../call_from/EXT_GR1_PUT_VAR_TD_REAL.html' TARGET='index'>3</A><a name='2393'>
     Data, Count,  Status )<a name='2394'>
<a name='2395'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_41"><a name='2396'>
  IMPLICIT NONE<a name='2397'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_52"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2398'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2399'>
  CHARACTER*(*) :: Element<a name='2400'>
  CHARACTER*(*) :: DateStr<a name='2401'>
  CHARACTER*(*) :: VarName <a name='2402'>
  real ,          INTENT(IN)  :: Data(*)<a name='2403'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2404'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2405'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='2406'>
  INTEGER             :: idx<a name='2407'>
<a name='2408'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1191"> ( DEBUG , 'Entering ext_gr1_put_var_td_real')<a name='2409'>
<a name='2410'>
  if (committed(DataHandle)) then<a name='2411'>
<a name='2412'>
     do idx = 1,Count<a name='2413'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='2414'>
     enddo<a name='2415'>
     <a name='2416'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_9"> (td_output(DataHandle), &amp;<a name='2417'>
          Varname//';'//DateStr//';'//Element, tmpstr, Count, Status)<a name='2418'>
<a name='2419'>
  endif<a name='2420'>
<a name='2421'>
  RETURN<a name='2422'>
END SUBROUTINE ext_gr1_put_var_td_real <a name='2423'>
<a name='2424'>
<font color=#447700>!*****************************************************************************<a name='2425'></font>
<a name='2426'>
<A NAME='EXT_GR1_PUT_VAR_TD_REAL8'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_REAL8' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2427'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_var_td_real8</font> ( DataHandle,Element,  DateStr,Varname, &amp;,<A href='../../call_from/EXT_GR1_PUT_VAR_TD_REAL8.html' TARGET='index'>3</A><a name='2428'>
     Data, Count,  Status )<a name='2429'>
<a name='2430'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_42"><a name='2431'>
  IMPLICIT NONE<a name='2432'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_53"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2433'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2434'>
  CHARACTER*(*) :: Element<a name='2435'>
  CHARACTER*(*) :: DateStr<a name='2436'>
  CHARACTER*(*) :: VarName <a name='2437'>
  real*8 ,        INTENT(IN)  :: Data(*)<a name='2438'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2439'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2440'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='2441'>
  INTEGER             :: idx<a name='2442'>
<a name='2443'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1192"> ( DEBUG , 'Entering ext_gr1_put_var_td_real8')<a name='2444'>
<a name='2445'>
  if (committed(DataHandle)) then<a name='2446'>
     do idx = 1,Count<a name='2447'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='2448'>
     enddo<a name='2449'>
     <a name='2450'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_10"> (td_output(DataHandle), &amp;<a name='2451'>
          Varname//';'//DateStr//';'//Element, tmpstr, Count, Status)<a name='2452'>
  endif<a name='2453'>
<a name='2454'>
  RETURN<a name='2455'>
END SUBROUTINE ext_gr1_put_var_td_real8 <a name='2456'>
<a name='2457'>
<font color=#447700>!*****************************************************************************<a name='2458'></font>
<a name='2459'>
<A NAME='EXT_GR1_PUT_VAR_TD_LOGICAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2460'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_var_td_logical</font> ( DataHandle,Element,  DateStr, &amp;,<A href='../../call_from/EXT_GR1_PUT_VAR_TD_LOGICAL.html' TARGET='index'>3</A><a name='2461'>
     Varname, Data, Count,  Status )<a name='2462'>
<a name='2463'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_43"><a name='2464'>
  IMPLICIT NONE<a name='2465'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_54"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2466'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2467'>
  CHARACTER*(*) :: Element<a name='2468'>
  CHARACTER*(*) :: DateStr<a name='2469'>
  CHARACTER*(*) :: VarName <a name='2470'>
  logical ,       INTENT(IN)  :: Data(*)<a name='2471'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2472'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2473'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='2474'>
  INTEGER             :: idx<a name='2475'>
<a name='2476'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1193"> ( DEBUG , 'Entering ext_gr1_put_var_td_logical')<a name='2477'>
<a name='2478'>
  if (committed(DataHandle)) then<a name='2479'>
<a name='2480'>
     do idx = 1,Count<a name='2481'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='2482'>
     enddo<a name='2483'>
<a name='2484'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_11"> (td_output(DataHandle), &amp;<a name='2485'>
          Varname//';'//DateStr//';'//Element, tmpstr, Count, Status)<a name='2486'>
<a name='2487'>
  endif<a name='2488'>
<a name='2489'>
  RETURN<a name='2490'>
END SUBROUTINE ext_gr1_put_var_td_logical <a name='2491'>
<a name='2492'>
<font color=#447700>!*****************************************************************************<a name='2493'></font>
<a name='2494'>
<A NAME='EXT_GR1_PUT_VAR_TD_CHAR'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2495'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_var_td_char</font> ( DataHandle,Element,  DateStr,Varname, &amp;,<A href='../../call_from/EXT_GR1_PUT_VAR_TD_CHAR.html' TARGET='index'>3</A><a name='2496'>
     Data,  Status )<a name='2497'>
<a name='2498'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_44"><a name='2499'>
  IMPLICIT NONE<a name='2500'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_55"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2501'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2502'>
  CHARACTER*(*) :: Element<a name='2503'>
  CHARACTER*(*) :: DateStr<a name='2504'>
  CHARACTER*(*) :: VarName <a name='2505'>
  CHARACTER*(*) :: Data<a name='2506'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2507'>
  CHARACTER(len=1000) :: tmpstr<a name='2508'>
  INTEGER             :: idx<a name='2509'>
<a name='2510'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1194"> ( DEBUG , 'Entering ext_gr1_put_var_td_char')<a name='2511'>
<a name='2512'>
  if (committed(DataHandle)) then<a name='2513'>
<a name='2514'>
    <a name='2515'>
     DO idx=1,LEN(Data)<a name='2516'>
        tmpstr(idx:idx)=Data(idx:idx)<a name='2517'>
     END DO<a name='2518'>
     DO idx=LEN(Data)+1,1000<a name='2519'>
        tmpstr(idx:idx)=' '<a name='2520'>
     END DO<a name='2521'>
<a name='2522'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_VAR_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_12"> (td_output(DataHandle), &amp;<a name='2523'>
          Varname//';'//DateStr//';'//Element, tmpstr, 1, Status)<a name='2524'>
<a name='2525'>
  endif<a name='2526'>
<a name='2527'>
  RETURN<a name='2528'>
END SUBROUTINE ext_gr1_put_var_td_char <a name='2529'>
<a name='2530'>
<font color=#447700>!******************************************************************************<a name='2531'></font>
<font color=#447700>!* End of put_var_td_* routines<a name='2532'></font>
<font color=#447700>!******************************************************************************<a name='2533'></font>
<a name='2534'>
<a name='2535'>
<font color=#447700>!******************************************************************************<a name='2536'></font>
<font color=#447700>!* Start of get_dom_ti_* routines<a name='2537'></font>
<font color=#447700>!******************************************************************************<a name='2538'></font>
<a name='2539'>
<A NAME='EXT_GR1_GET_DOM_TI_REAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2540'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_dom_ti_real</font> ( DataHandle,Element,   Data, Count, &amp;,<A href='../../call_from/EXT_GR1_GET_DOM_TI_REAL.html' TARGET='index'>4</A><a name='2541'>
     Outcount, Status )<a name='2542'>
<a name='2543'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_45"><a name='2544'>
  IMPLICIT NONE<a name='2545'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_56"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2546'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2547'>
  CHARACTER*(*) :: Element<a name='2548'>
  real ,          INTENT(OUT) :: Data(*)<a name='2549'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2550'>
  INTEGER ,       INTENT(OUT) :: Outcount<a name='2551'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2552'>
  INTEGER          :: idx<a name='2553'>
  INTEGER          :: stat<a name='2554'>
  CHARACTER*(1000) :: VALUE<a name='2555'>
<a name='2556'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1195"> ( DEBUG , 'Entering ext_gr1_get_dom_ti_real')<a name='2557'>
<a name='2558'>
  Status = WRF_NO_ERR<a name='2559'>
  <a name='2560'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), "none", &amp;<a name='2561'>
       "none", Value,stat)<a name='2562'>
  if (stat /= 0) then<a name='2563'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1196"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='2564'>
     Status = WRF_WARN_VAR_NF<a name='2565'>
     RETURN<a name='2566'>
  endif<a name='2567'>
<a name='2568'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='2569'>
  if (stat .ne. 0) then<a name='2570'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1481">("Reading data from"//Value//"failed")<a name='2571'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='2572'>
     RETURN<a name='2573'>
  endif<a name='2574'>
  Outcount = idx<a name='2575'>
 <a name='2576'>
  RETURN<a name='2577'>
END SUBROUTINE ext_gr1_get_dom_ti_real <a name='2578'>
<a name='2579'>
<font color=#447700>!*****************************************************************************<a name='2580'></font>
<a name='2581'>
<A NAME='EXT_GR1_GET_DOM_TI_REAL8'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_REAL8' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2582'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_dom_ti_real8</font> ( DataHandle,Element,   Data, Count, &amp;,<A href='../../call_from/EXT_GR1_GET_DOM_TI_REAL8.html' TARGET='index'>4</A><a name='2583'>
     Outcount, Status )<a name='2584'>
<a name='2585'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_46"><a name='2586'>
  IMPLICIT NONE<a name='2587'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_57"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2588'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2589'>
  CHARACTER*(*) :: Element<a name='2590'>
  real*8 ,        INTENT(OUT) :: Data(*)<a name='2591'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2592'>
  INTEGER ,       INTENT(OUT) :: OutCount<a name='2593'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2594'>
  INTEGER          :: idx<a name='2595'>
  INTEGER          :: stat<a name='2596'>
  CHARACTER*(1000) :: VALUE<a name='2597'>
<a name='2598'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1197"> ( DEBUG , 'Entering ext_gr1_get_dom_ti_real8')<a name='2599'>
<a name='2600'>
  Status = WRF_NO_ERR<a name='2601'>
  <a name='2602'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), "none", &amp;<a name='2603'>
       "none", Value,stat)<a name='2604'>
  if (stat /= 0) then<a name='2605'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1198"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='2606'>
     Status = WRF_WARN_VAR_NF<a name='2607'>
     RETURN<a name='2608'>
  endif<a name='2609'>
<a name='2610'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='2611'>
  if (stat .ne. 0) then<a name='2612'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1482">("Reading data from"//Value//"failed")<a name='2613'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='2614'>
     RETURN<a name='2615'>
  endif<a name='2616'>
  Outcount = idx<a name='2617'>
 <a name='2618'>
  RETURN<a name='2619'>
END SUBROUTINE ext_gr1_get_dom_ti_real8 <a name='2620'>
<a name='2621'>
<font color=#447700>!*****************************************************************************<a name='2622'></font>
<a name='2623'>
<A NAME='EXT_GR1_GET_DOM_TI_INTEGER'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2624'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_dom_ti_integer</font> ( DataHandle,Element,   Data, Count, &amp;,<A href='../../call_from/EXT_GR1_GET_DOM_TI_INTEGER.html' TARGET='index'>4</A><a name='2625'>
     Outcount, Status )<a name='2626'>
<a name='2627'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_47"><a name='2628'>
  IMPLICIT NONE<a name='2629'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_58"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2630'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2631'>
  CHARACTER*(*) :: Element<a name='2632'>
  integer ,       INTENT(OUT) :: Data(*)<a name='2633'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2634'>
  INTEGER ,       INTENT(OUT) :: OutCount<a name='2635'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2636'>
  INTEGER          :: idx<a name='2637'>
  INTEGER          :: stat<a name='2638'>
  CHARACTER*(1000) :: VALUE<a name='2639'>
  <a name='2640'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1199"> ( DEBUG , 'Entering ext_gr1_get_dom_ti_integer Element: '//Element)<a name='2641'>
<a name='2642'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), "none", &amp;<a name='2643'>
       "none", Value,stat)<a name='2644'>
  if (stat /= 0) then<a name='2645'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1200"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='2646'>
     Status = WRF_WARN_VAR_NF<a name='2647'>
     RETURN<a name='2648'>
  endif<a name='2649'>
<a name='2650'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='2651'>
  if (stat .ne. 0) then<a name='2652'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1483">("Reading data from"//Value//"failed")<a name='2653'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='2654'>
     RETURN<a name='2655'>
  endif<a name='2656'>
  Outcount = Count<a name='2657'>
 <a name='2658'>
  RETURN<a name='2659'>
END SUBROUTINE ext_gr1_get_dom_ti_integer <a name='2660'>
<a name='2661'>
<font color=#447700>!*****************************************************************************<a name='2662'></font>
<a name='2663'>
<A NAME='EXT_GR1_GET_DOM_TI_LOGICAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2664'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_dom_ti_logical</font> ( DataHandle,Element,   Data, Count, &amp;,<A href='../../call_from/EXT_GR1_GET_DOM_TI_LOGICAL.html' TARGET='index'>4</A><a name='2665'>
     Outcount, Status )<a name='2666'>
<a name='2667'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_48"><a name='2668'>
  IMPLICIT NONE<a name='2669'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_59"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2670'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2671'>
  CHARACTER*(*) :: Element<a name='2672'>
  logical ,       INTENT(OUT) :: Data(*)<a name='2673'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2674'>
  INTEGER ,       INTENT(OUT) :: OutCount<a name='2675'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2676'>
  INTEGER          :: idx<a name='2677'>
  INTEGER          :: stat<a name='2678'>
  CHARACTER*(1000) :: VALUE<a name='2679'>
<a name='2680'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1201"> ( DEBUG , 'Entering ext_gr1_get_dom_ti_logical')<a name='2681'>
<a name='2682'>
  Status = WRF_NO_ERR<a name='2683'>
  <a name='2684'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), "none", &amp;<a name='2685'>
       "none", Value,stat)<a name='2686'>
  if (stat /= 0) then<a name='2687'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1202"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='2688'>
     Status = WRF_WARN_VAR_NF<a name='2689'>
     RETURN<a name='2690'>
  endif<a name='2691'>
<a name='2692'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='2693'>
  if (stat .ne. 0) then<a name='2694'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1484">("Reading data from"//Value//"failed")<a name='2695'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='2696'>
     RETURN<a name='2697'>
  endif<a name='2698'>
  Outcount = idx<a name='2699'>
 <a name='2700'>
  RETURN<a name='2701'>
END SUBROUTINE ext_gr1_get_dom_ti_logical <a name='2702'>
<a name='2703'>
<font color=#447700>!*****************************************************************************<a name='2704'></font>
<a name='2705'>
<A NAME='EXT_GR1_GET_DOM_TI_CHAR'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2706'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_dom_ti_char</font> ( DataHandle,Element,   Data,  Status ),<A href='../../call_from/EXT_GR1_GET_DOM_TI_CHAR.html' TARGET='index'>3</A><a name='2707'>
<a name='2708'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_49"><a name='2709'>
  IMPLICIT NONE<a name='2710'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_60"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2711'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2712'>
  CHARACTER*(*) :: Element<a name='2713'>
  CHARACTER*(*) :: Data<a name='2714'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2715'>
  INTEGER       :: stat<a name='2716'>
  INTEGER       :: endchar<a name='2717'>
<a name='2718'>
  Status = WRF_NO_ERR<a name='2719'>
  <a name='2720'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1203"> ( DEBUG , 'Entering ext_gr1_get_dom_ti_char')<a name='2721'>
<a name='2722'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), "none", &amp;<a name='2723'>
       "none", Data, stat)<a name='2724'>
  if (stat /= 0) then<a name='2725'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1204"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='2726'>
     Status = WRF_WARN_VAR_NF<a name='2727'>
     RETURN<a name='2728'>
  endif<a name='2729'>
<a name='2730'>
  RETURN<a name='2731'>
END SUBROUTINE ext_gr1_get_dom_ti_char <a name='2732'>
<a name='2733'>
<font color=#447700>!*****************************************************************************<a name='2734'></font>
<a name='2735'>
<A NAME='EXT_GR1_GET_DOM_TI_DOUBLE'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2736'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_dom_ti_double</font> ( DataHandle,Element,   Data, Count, &amp;,<A href='../../call_from/EXT_GR1_GET_DOM_TI_DOUBLE.html' TARGET='index'>4</A><a name='2737'>
     Outcount, Status )<a name='2738'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_50"><a name='2739'>
  IMPLICIT NONE<a name='2740'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_61"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2741'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2742'>
  CHARACTER*(*) , INTENT(IN)  :: Element<a name='2743'>
  real*8 ,            INTENT(OUT) :: Data(*)<a name='2744'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2745'>
  INTEGER ,       INTENT(OUT)  :: OutCount<a name='2746'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2747'>
  INTEGER          :: idx<a name='2748'>
  INTEGER          :: stat<a name='2749'>
  CHARACTER*(1000) :: VALUE<a name='2750'>
<a name='2751'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1205"> ( DEBUG , 'Entering ext_gr1_get_dom_ti_double')<a name='2752'>
<a name='2753'>
  Status = WRF_NO_ERR<a name='2754'>
  <a name='2755'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), "none", &amp;<a name='2756'>
       "none", Value, stat)<a name='2757'>
  if (stat /= 0) then<a name='2758'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1206"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='2759'>
     Status = WRF_WARN_VAR_NF<a name='2760'>
     RETURN<a name='2761'>
  endif<a name='2762'>
<a name='2763'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='2764'>
  if (stat .ne. 0) then<a name='2765'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1485">("Reading data from"//Value//"failed")<a name='2766'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='2767'>
     RETURN<a name='2768'>
  endif<a name='2769'>
  Outcount = idx<a name='2770'>
 <a name='2771'>
RETURN<a name='2772'>
END SUBROUTINE ext_gr1_get_dom_ti_double<a name='2773'>
<a name='2774'>
<font color=#447700>!******************************************************************************<a name='2775'></font>
<font color=#447700>!* End of get_dom_ti_* routines<a name='2776'></font>
<font color=#447700>!******************************************************************************<a name='2777'></font>
<a name='2778'>
<a name='2779'>
<font color=#447700>!******************************************************************************<a name='2780'></font>
<font color=#447700>!* Start of put_dom_ti_* routines<a name='2781'></font>
<font color=#447700>!******************************************************************************<a name='2782'></font>
<a name='2783'>
<A NAME='EXT_GR1_PUT_DOM_TI_REAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2784'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_dom_ti_real</font> ( DataHandle,Element,   Data, Count,  &amp; <A href='../../call_to/EXT_GR1_PUT_DOM_TI_REAL.html' TARGET='index'>4</A>,<A href='../../call_from/EXT_GR1_PUT_DOM_TI_REAL.html' TARGET='index'>3</A><a name='2785'>
     Status )<a name='2786'>
<a name='2787'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_51"><a name='2788'>
  IMPLICIT NONE<a name='2789'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_62"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2790'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2791'>
  CHARACTER*(*) :: Element<a name='2792'>
  real ,          INTENT(IN)  :: Data(*)<a name='2793'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2794'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2795'>
  REAL dummy<a name='2796'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='2797'>
  character(len=2)    :: lf<a name='2798'>
  integer             :: idx<a name='2799'>
<a name='2800'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1207"> ( DEBUG , 'Entering ext_gr1_put_dom_ti_real')<a name='2801'>
<a name='2802'>
  if (Element .eq. 'DX') then<a name='2803'>
     dx = Data(1)/1000.<a name='2804'>
  endif<a name='2805'>
  if (Element .eq. 'DY') then<a name='2806'>
     dy = Data(1)/1000.<a name='2807'>
  endif<a name='2808'>
  if (Element .eq. 'CEN_LAT') then<a name='2809'>
     center_lat = Data(1)<a name='2810'>
  endif<a name='2811'>
  if (Element .eq. 'CEN_LON') then<a name='2812'>
     center_lon = Data(1)<a name='2813'>
  endif  <a name='2814'>
  if (Element .eq. 'TRUELAT1') then<a name='2815'>
     truelat1 = Data(1)<a name='2816'>
  endif<a name='2817'>
  if (Element .eq. 'TRUELAT2') then<a name='2818'>
     truelat2 = Data(1)<a name='2819'>
  endif<a name='2820'>
  if (Element == 'STAND_LON') then<a name='2821'>
     proj_central_lon = Data(1)<a name='2822'>
  endif<a name='2823'>
  if (Element == 'DT') then<a name='2824'>
     timestep = Data(1)<a name='2825'>
  endif<a name='2826'>
<a name='2827'>
  if (committed(DataHandle)) then<a name='2828'>
<a name='2829'>
     do idx = 1,Count<a name='2830'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='2831'>
     enddo<a name='2832'>
     <a name='2833'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_13"> (ti_output(DataHandle), Element, tmpstr, Count, Status)<a name='2834'>
<a name='2835'>
  endif<a name='2836'>
<a name='2837'>
  RETURN<a name='2838'>
END SUBROUTINE ext_gr1_put_dom_ti_real <a name='2839'>
<a name='2840'>
<font color=#447700>!*****************************************************************************<a name='2841'></font>
<a name='2842'>
<A NAME='EXT_GR1_PUT_DOM_TI_REAL8'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_REAL8' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2843'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_dom_ti_real8</font> ( DataHandle,Element,   Data, Count,  &amp;,<A href='../../call_from/EXT_GR1_PUT_DOM_TI_REAL8.html' TARGET='index'>3</A><a name='2844'>
     Status )<a name='2845'>
<a name='2846'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_52"><a name='2847'>
  IMPLICIT NONE<a name='2848'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_63"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2849'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2850'>
  CHARACTER*(*) :: Element<a name='2851'>
  real*8 ,        INTENT(IN)  :: Data(*)<a name='2852'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2853'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2854'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='2855'>
  INTEGER             :: idx<a name='2856'>
<a name='2857'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1208"> ( DEBUG , 'Entering ext_gr1_put_dom_ti_real8')<a name='2858'>
<a name='2859'>
  if (committed(DataHandle)) then<a name='2860'>
<a name='2861'>
     do idx = 1,Count<a name='2862'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='2863'>
     enddo<a name='2864'>
     <a name='2865'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_14"> (ti_output(DataHandle), Element, tmpstr, Count, Status)<a name='2866'>
<a name='2867'>
  endif<a name='2868'>
<a name='2869'>
  RETURN<a name='2870'>
END SUBROUTINE ext_gr1_put_dom_ti_real8 <a name='2871'>
<a name='2872'>
<font color=#447700>!*****************************************************************************<a name='2873'></font>
<a name='2874'>
<A NAME='EXT_GR1_PUT_DOM_TI_INTEGER'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2875'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_dom_ti_integer</font> ( DataHandle,Element,   Data, Count,  &amp; <A href='../../call_to/EXT_GR1_PUT_DOM_TI_INTEGER.html' TARGET='index'>4</A>,<A href='../../call_from/EXT_GR1_PUT_DOM_TI_INTEGER.html' TARGET='index'>4</A><a name='2876'>
     Status )<a name='2877'>
<a name='2878'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_53"><a name='2879'>
  IMPLICIT NONE<a name='2880'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_64"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2881'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2882'>
  CHARACTER*(*) :: Element<a name='2883'>
  INTEGER ,       INTENT(IN)  :: Data(*)<a name='2884'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2885'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2886'>
  REAL dummy<a name='2887'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='2888'>
  INTEGER             :: idx<a name='2889'>
<a name='2890'>
<a name='2891'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1209"> ( DEBUG , 'Entering ext_gr1_put_dom_ti_integer')<a name='2892'>
<a name='2893'>
  if (Element == 'WEST-EAST_GRID_DIMENSION') then<a name='2894'>
     full_xsize = Data(1)<a name='2895'>
  else if (Element == 'SOUTH-NORTH_GRID_DIMENSION') then<a name='2896'>
     full_ysize = Data(1)<a name='2897'>
  else if (Element == 'MAP_PROJ') then<a name='2898'>
     projection = Data(1)<a name='2899'>
  else if (Element == 'WG_GRID_ID') then<a name='2900'>
     wg_grid_id = Data(1)<a name='2901'>
  else if (Element == 'GRID_ID') then<a name='2902'>
     this_domain = Data(1)<a name='2903'>
  endif<a name='2904'>
<a name='2905'>
  if (committed(DataHandle)) then<a name='2906'>
<a name='2907'>
     do idx = 1,Count<a name='2908'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='2909'>
     enddo<a name='2910'>
     <a name='2911'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_15"> (ti_output(DataHandle), Element, tmpstr, Count, Status)<a name='2912'>
<a name='2913'>
  endif<a name='2914'>
<a name='2915'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1210"> ( DEBUG , 'Leaving ext_gr1_put_dom_ti_integer')<a name='2916'>
<a name='2917'>
  RETURN<a name='2918'>
END SUBROUTINE ext_gr1_put_dom_ti_integer <a name='2919'>
<a name='2920'>
<font color=#447700>!*****************************************************************************<a name='2921'></font>
<a name='2922'>
<A NAME='EXT_GR1_PUT_DOM_TI_LOGICAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2923'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_dom_ti_logical</font> ( DataHandle,Element,   Data, Count,  &amp;,<A href='../../call_from/EXT_GR1_PUT_DOM_TI_LOGICAL.html' TARGET='index'>3</A><a name='2924'>
     Status )<a name='2925'>
<a name='2926'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_54"><a name='2927'>
  IMPLICIT NONE<a name='2928'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_65"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2929'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2930'>
  CHARACTER*(*) :: Element<a name='2931'>
  logical ,       INTENT(IN)  :: Data(*)<a name='2932'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2933'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2934'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='2935'>
  INTEGER             :: idx<a name='2936'>
<a name='2937'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1211"> ( DEBUG , 'Entering ext_gr1_put_dom_ti_logical')<a name='2938'>
<a name='2939'>
  if (committed(DataHandle)) then<a name='2940'>
<a name='2941'>
     do idx = 1,Count<a name='2942'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='2943'>
     enddo<a name='2944'>
     <a name='2945'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_16"> (ti_output(DataHandle), Element, tmpstr, Count, Status)<a name='2946'>
<a name='2947'>
  endif<a name='2948'>
<a name='2949'>
  RETURN<a name='2950'>
END SUBROUTINE ext_gr1_put_dom_ti_logical <a name='2951'>
<a name='2952'>
<font color=#447700>!*****************************************************************************<a name='2953'></font>
<a name='2954'>
<A NAME='EXT_GR1_PUT_DOM_TI_CHAR'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2955'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_dom_ti_char</font> ( DataHandle,Element,   Data,  &amp; <A href='../../call_to/EXT_GR1_PUT_DOM_TI_CHAR.html' TARGET='index'>4</A>,<A href='../../call_from/EXT_GR1_PUT_DOM_TI_CHAR.html' TARGET='index'>3</A><a name='2956'>
     Status )<a name='2957'>
<a name='2958'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_55"><a name='2959'>
  IMPLICIT NONE<a name='2960'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_66"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2961'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2962'>
  CHARACTER*(*) :: Element<a name='2963'>
  CHARACTER*(*),     INTENT(IN)  :: Data<a name='2964'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2965'>
  REAL dummy<a name='2966'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='2967'>
<a name='2968'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1212"> ( DEBUG , 'Entering ext_gr1_put_dom_ti_char')<a name='2969'>
<a name='2970'>
  if (Element .eq. 'START_DATE') then<a name='2971'>
     StartDate = Data<a name='2972'>
  endif<a name='2973'>
<a name='2974'>
  if (committed(DataHandle)) then<a name='2975'>
<a name='2976'>
     write(tmpstr(1),*)trim(Data)<a name='2977'>
     <a name='2978'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_17"> (ti_output(DataHandle), Element, tmpstr, 1, Status)<a name='2979'>
<a name='2980'>
  endif<a name='2981'>
<a name='2982'>
  RETURN<a name='2983'>
END SUBROUTINE ext_gr1_put_dom_ti_char<a name='2984'>
<a name='2985'>
<font color=#447700>!*****************************************************************************<a name='2986'></font>
<a name='2987'>
<A NAME='EXT_GR1_PUT_DOM_TI_DOUBLE'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2988'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_dom_ti_double</font> ( DataHandle,Element, Data, Count, &amp;,<A href='../../call_from/EXT_GR1_PUT_DOM_TI_DOUBLE.html' TARGET='index'>3</A><a name='2989'>
     Status )<a name='2990'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_56"><a name='2991'>
  IMPLICIT NONE<a name='2992'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_67"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2993'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='2994'>
  CHARACTER*(*) , INTENT(IN)  :: Element<a name='2995'>
  real*8 ,            INTENT(IN) :: Data(*)<a name='2996'>
  INTEGER ,       INTENT(IN)  :: Count<a name='2997'>
  INTEGER ,       INTENT(OUT) :: Status<a name='2998'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='2999'>
  INTEGER             :: idx<a name='3000'>
<a name='3001'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1213"> ( DEBUG , 'Entering ext_gr1_put_dom_ti_double')<a name='3002'>
<a name='3003'>
  if (committed(DataHandle)) then<a name='3004'>
<a name='3005'>
     do idx = 1,Count<a name='3006'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='3007'>
     enddo<a name='3008'>
<a name='3009'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_18"> (ti_output(DataHandle), Element, tmpstr, Count, Status)<a name='3010'>
<a name='3011'>
  endif<a name='3012'>
  <a name='3013'>
  RETURN<a name='3014'>
END SUBROUTINE ext_gr1_put_dom_ti_double<a name='3015'>
<a name='3016'>
<font color=#447700>!******************************************************************************<a name='3017'></font>
<font color=#447700>!* End of put_dom_ti_* routines<a name='3018'></font>
<font color=#447700>!******************************************************************************<a name='3019'></font>
<a name='3020'>
<a name='3021'>
<font color=#447700>!******************************************************************************<a name='3022'></font>
<font color=#447700>!* Start of get_dom_td_* routines<a name='3023'></font>
<font color=#447700>!******************************************************************************<a name='3024'></font>
<a name='3025'>
<A NAME='EXT_GR1_GET_DOM_TD_REAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3026'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_dom_td_real</font> ( DataHandle,Element, DateStr,  Data, &amp;,<A href='../../call_from/EXT_GR1_GET_DOM_TD_REAL.html' TARGET='index'>4</A><a name='3027'>
     Count, Outcount, Status )<a name='3028'>
<a name='3029'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_57"><a name='3030'>
  IMPLICIT NONE<a name='3031'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_68"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3032'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='3033'>
  CHARACTER*(*) :: Element<a name='3034'>
  CHARACTER*(*) :: DateStr<a name='3035'>
  real ,          INTENT(OUT) :: Data(*)<a name='3036'>
  INTEGER ,       INTENT(IN)  :: Count<a name='3037'>
  INTEGER ,       INTENT(OUT) :: OutCount<a name='3038'>
  INTEGER ,       INTENT(OUT) :: Status<a name='3039'>
  INTEGER          :: idx<a name='3040'>
  INTEGER          :: stat<a name='3041'>
  CHARACTER*(1000) :: VALUE<a name='3042'>
<a name='3043'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1214"> ( DEBUG , 'Entering ext_gr1_get_dom_td_real')<a name='3044'>
<a name='3045'>
  Status = WRF_NO_ERR<a name='3046'>
  <a name='3047'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), DateStr, &amp;<a name='3048'>
       "none", Value, stat)<a name='3049'>
  if (stat /= 0) then<a name='3050'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1215"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='3051'>
     Status = WRF_WARN_VAR_NF<a name='3052'>
     RETURN<a name='3053'>
  endif<a name='3054'>
<a name='3055'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='3056'>
  if (stat .ne. 0) then<a name='3057'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1486">("Reading data from"//Value//"failed")<a name='3058'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='3059'>
     RETURN<a name='3060'>
  endif<a name='3061'>
  Outcount = idx<a name='3062'>
<a name='3063'>
  RETURN<a name='3064'>
END SUBROUTINE ext_gr1_get_dom_td_real <a name='3065'>
<a name='3066'>
<font color=#447700>!*****************************************************************************<a name='3067'></font>
<a name='3068'>
<A NAME='EXT_GR1_GET_DOM_TD_REAL8'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_REAL8' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3069'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_dom_td_real8</font> ( DataHandle,Element, DateStr,  Data, &amp;,<A href='../../call_from/EXT_GR1_GET_DOM_TD_REAL8.html' TARGET='index'>4</A><a name='3070'>
     Count, Outcount, Status )<a name='3071'>
<a name='3072'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_58"><a name='3073'>
  IMPLICIT NONE<a name='3074'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_69"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3075'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='3076'>
  CHARACTER*(*) :: Element<a name='3077'>
  CHARACTER*(*) :: DateStr<a name='3078'>
  real*8 ,        INTENT(OUT) :: Data(*)<a name='3079'>
  INTEGER ,       INTENT(IN)  :: Count<a name='3080'>
  INTEGER ,       INTENT(OUT) :: OutCount<a name='3081'>
  INTEGER ,       INTENT(OUT) :: Status<a name='3082'>
  INTEGER          :: idx<a name='3083'>
  INTEGER          :: stat<a name='3084'>
  CHARACTER*(1000) :: VALUE<a name='3085'>
<a name='3086'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1216"> ( DEBUG , 'Entering ext_gr1_get_dom_td_real8')<a name='3087'>
<a name='3088'>
  Status = WRF_NO_ERR<a name='3089'>
  <a name='3090'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), DateStr, &amp;<a name='3091'>
       "none", Value, stat)<a name='3092'>
  if (stat /= 0) then<a name='3093'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1217"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='3094'>
     Status = WRF_WARN_VAR_NF<a name='3095'>
     RETURN<a name='3096'>
  endif<a name='3097'>
<a name='3098'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='3099'>
  if (stat .ne. 0) then<a name='3100'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1487">("Reading data from"//Value//"failed")<a name='3101'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='3102'>
     RETURN<a name='3103'>
  endif<a name='3104'>
  Outcount = idx<a name='3105'>
<a name='3106'>
  RETURN<a name='3107'>
END SUBROUTINE ext_gr1_get_dom_td_real8 <a name='3108'>
<a name='3109'>
<font color=#447700>!*****************************************************************************<a name='3110'></font>
<a name='3111'>
<A NAME='EXT_GR1_GET_DOM_TD_INTEGER'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3112'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_dom_td_integer</font> ( DataHandle,Element, DateStr,  Data, &amp;,<A href='../../call_from/EXT_GR1_GET_DOM_TD_INTEGER.html' TARGET='index'>4</A><a name='3113'>
     Count, Outcount, Status )<a name='3114'>
<a name='3115'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_59"><a name='3116'>
  IMPLICIT NONE<a name='3117'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_70"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3118'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='3119'>
  CHARACTER*(*) :: Element<a name='3120'>
  CHARACTER*(*) :: DateStr<a name='3121'>
  integer ,       INTENT(OUT) :: Data(*)<a name='3122'>
  INTEGER ,       INTENT(IN)  :: Count<a name='3123'>
  INTEGER ,       INTENT(OUT) :: OutCount<a name='3124'>
  INTEGER ,       INTENT(OUT) :: Status<a name='3125'>
  INTEGER          :: idx<a name='3126'>
  INTEGER          :: stat<a name='3127'>
  CHARACTER*(1000) :: VALUE<a name='3128'>
<a name='3129'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1218"> ( DEBUG , 'Entering ext_gr1_get_dom_td_integer')<a name='3130'>
<a name='3131'>
  Status = WRF_NO_ERR<a name='3132'>
  <a name='3133'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), DateStr, &amp;<a name='3134'>
       "none", Value,stat)<a name='3135'>
  if (stat /= 0) then<a name='3136'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1219"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='3137'>
     Status = WRF_WARN_VAR_NF<a name='3138'>
     RETURN<a name='3139'>
  endif<a name='3140'>
<a name='3141'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='3142'>
  if (stat .ne. 0) then<a name='3143'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1488">("Reading data from"//Value//"failed")<a name='3144'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='3145'>
     RETURN<a name='3146'>
  endif<a name='3147'>
  Outcount = idx<a name='3148'>
<a name='3149'>
  RETURN<a name='3150'>
END SUBROUTINE ext_gr1_get_dom_td_integer <a name='3151'>
<a name='3152'>
<font color=#447700>!*****************************************************************************<a name='3153'></font>
<a name='3154'>
<A NAME='EXT_GR1_GET_DOM_TD_LOGICAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3155'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_dom_td_logical</font> ( DataHandle,Element, DateStr,  Data, &amp;,<A href='../../call_from/EXT_GR1_GET_DOM_TD_LOGICAL.html' TARGET='index'>4</A><a name='3156'>
     Count, Outcount, Status )<a name='3157'>
<a name='3158'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_60"><a name='3159'>
  IMPLICIT NONE<a name='3160'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_71"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3161'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='3162'>
  CHARACTER*(*) :: Element<a name='3163'>
  CHARACTER*(*) :: DateStr<a name='3164'>
  logical ,       INTENT(OUT) :: Data(*)<a name='3165'>
  INTEGER ,       INTENT(IN)  :: Count<a name='3166'>
  INTEGER ,       INTENT(OUT) :: OutCount<a name='3167'>
  INTEGER ,       INTENT(OUT) :: Status<a name='3168'>
  INTEGER          :: idx<a name='3169'>
  INTEGER          :: stat<a name='3170'>
  CHARACTER*(1000) :: VALUE<a name='3171'>
<a name='3172'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1220"> ( DEBUG , 'Entering ext_gr1_get_dom_td_logical')<a name='3173'>
<a name='3174'>
  Status = WRF_NO_ERR<a name='3175'>
  <a name='3176'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), DateStr, &amp;<a name='3177'>
       "none", Value, stat)<a name='3178'>
  if (stat /= 0) then<a name='3179'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1221"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='3180'>
     Status = WRF_WARN_VAR_NF<a name='3181'>
     RETURN<a name='3182'>
  endif<a name='3183'>
<a name='3184'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='3185'>
  if (stat .ne. 0) then<a name='3186'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1489">("Reading data from"//Value//"failed")<a name='3187'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='3188'>
     RETURN<a name='3189'>
  endif<a name='3190'>
  Outcount = idx<a name='3191'>
<a name='3192'>
  RETURN<a name='3193'>
END SUBROUTINE ext_gr1_get_dom_td_logical <a name='3194'>
<a name='3195'>
<font color=#447700>!*****************************************************************************<a name='3196'></font>
<a name='3197'>
<A NAME='EXT_GR1_GET_DOM_TD_CHAR'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3198'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_dom_td_char</font> ( DataHandle,Element, DateStr,  Data,  &amp;,<A href='../../call_from/EXT_GR1_GET_DOM_TD_CHAR.html' TARGET='index'>3</A><a name='3199'>
     Status )<a name='3200'>
<a name='3201'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_61"><a name='3202'>
  IMPLICIT NONE<a name='3203'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_72"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3204'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='3205'>
  CHARACTER*(*) :: Element<a name='3206'>
  CHARACTER*(*) :: DateStr<a name='3207'>
  CHARACTER*(*) :: Data<a name='3208'>
  INTEGER ,       INTENT(OUT) :: Status<a name='3209'>
  INTEGER       :: stat<a name='3210'>
<a name='3211'>
  Status = WRF_NO_ERR<a name='3212'>
  <a name='3213'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1222"> ( DEBUG , 'Entering ext_gr1_get_dom_td_char')<a name='3214'>
<a name='3215'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), DateStr, &amp;<a name='3216'>
       "none", Data, stat)<a name='3217'>
  if (stat /= 0) then<a name='3218'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1223"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='3219'>
     Status = WRF_WARN_VAR_NF<a name='3220'>
     RETURN<a name='3221'>
  endif<a name='3222'>
<a name='3223'>
  RETURN<a name='3224'>
END SUBROUTINE ext_gr1_get_dom_td_char <a name='3225'>
<a name='3226'>
<font color=#447700>!*****************************************************************************<a name='3227'></font>
<a name='3228'>
<A NAME='EXT_GR1_GET_DOM_TD_DOUBLE'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3229'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_get_dom_td_double</font> ( DataHandle,Element, DateStr,  Data, &amp;,<A href='../../call_from/EXT_GR1_GET_DOM_TD_DOUBLE.html' TARGET='index'>4</A><a name='3230'>
     Count, Outcount, Status )<a name='3231'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_62"><a name='3232'>
  IMPLICIT NONE<a name='3233'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_73"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3234'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='3235'>
  CHARACTER*(*) , INTENT(IN)  :: Element<a name='3236'>
  CHARACTER*(*) , INTENT(IN)  :: DateStr<a name='3237'>
  real*8 ,            INTENT(OUT) :: Data(*)<a name='3238'>
  INTEGER ,       INTENT(IN)  :: Count<a name='3239'>
  INTEGER ,       INTENT(OUT)  :: OutCount<a name='3240'>
  INTEGER ,       INTENT(OUT) :: Status<a name='3241'>
  INTEGER          :: idx<a name='3242'>
  INTEGER          :: stat<a name='3243'>
  CHARACTER*(1000) :: VALUE<a name='3244'>
<a name='3245'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1224"> ( DEBUG , 'Entering ext_gr1_get_dom_td_double')<a name='3246'>
<a name='3247'>
  Status = WRF_NO_ERR<a name='3248'>
  <a name='3249'>
  CALL GET_METADATA_VALUE(fileinfo(DataHandle)%fileindex(:), TRIM(Element), DateStr, &amp;<a name='3250'>
       "none", Value, stat)<a name='3251'>
  if (stat /= 0) then<a name='3252'>
     CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1225"> ( DEBUG , "GET_METADATA_VALUE failed for "//Element)<a name='3253'>
     Status = WRF_WARN_VAR_NF<a name='3254'>
     RETURN<a name='3255'>
  endif<a name='3256'>
<a name='3257'>
  READ(Value,*,IOSTAT=stat)(Data(idx),idx=1,Count)<a name='3258'>
  if (stat .ne. 0) then<a name='3259'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_GET_DOM_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1490">("Reading data from"//Value//"failed")<a name='3260'>
     Status = WRF_WARN_COUNT_TOO_LONG<a name='3261'>
     RETURN<a name='3262'>
  endif<a name='3263'>
  Outcount = idx<a name='3264'>
<a name='3265'>
RETURN<a name='3266'>
END SUBROUTINE ext_gr1_get_dom_td_double<a name='3267'>
<a name='3268'>
<font color=#447700>!******************************************************************************<a name='3269'></font>
<font color=#447700>!* End of get_dom_td_* routines<a name='3270'></font>
<font color=#447700>!******************************************************************************<a name='3271'></font>
<a name='3272'>
<a name='3273'>
<font color=#447700>!******************************************************************************<a name='3274'></font>
<font color=#447700>!* Start of put_dom_td_* routines<a name='3275'></font>
<font color=#447700>!******************************************************************************<a name='3276'></font>
<a name='3277'>
<a name='3278'>
<A NAME='EXT_GR1_PUT_DOM_TD_REAL8'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_REAL8' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3279'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_dom_td_real8</font> ( DataHandle,Element, DateStr,  Data, &amp;,<A href='../../call_from/EXT_GR1_PUT_DOM_TD_REAL8.html' TARGET='index'>3</A><a name='3280'>
     Count,  Status )<a name='3281'>
<a name='3282'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_63"><a name='3283'>
  IMPLICIT NONE<a name='3284'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_74"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3285'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='3286'>
  CHARACTER*(*) :: Element<a name='3287'>
  CHARACTER*(*) :: DateStr<a name='3288'>
  real*8 ,        INTENT(IN)  :: Data(*)<a name='3289'>
  INTEGER ,       INTENT(IN)  :: Count<a name='3290'>
  INTEGER ,       INTENT(OUT) :: Status<a name='3291'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='3292'>
  INTEGER             :: idx<a name='3293'>
<a name='3294'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1226"> ( DEBUG , 'Entering ext_gr1_put_dom_td_real8')<a name='3295'>
<a name='3296'>
  if (committed(DataHandle)) then<a name='3297'>
<a name='3298'>
     do idx = 1,Count<a name='3299'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='3300'>
     enddo<a name='3301'>
<a name='3302'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_REAL8' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_19"> (td_output(DataHandle), DateStr//';'//Element, tmpstr, &amp;<a name='3303'>
          Count, Status)<a name='3304'>
<a name='3305'>
  endif<a name='3306'>
<a name='3307'>
  RETURN<a name='3308'>
END SUBROUTINE ext_gr1_put_dom_td_real8 <a name='3309'>
<a name='3310'>
<font color=#447700>!*****************************************************************************<a name='3311'></font>
<a name='3312'>
<A NAME='EXT_GR1_PUT_DOM_TD_INTEGER'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3313'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_dom_td_integer</font> ( DataHandle,Element, DateStr,  Data, &amp; <A href='../../call_to/EXT_GR1_PUT_DOM_TD_INTEGER.html' TARGET='index'>4</A>,<A href='../../call_from/EXT_GR1_PUT_DOM_TD_INTEGER.html' TARGET='index'>3</A><a name='3314'>
     Count,  Status )<a name='3315'>
<a name='3316'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_64"><a name='3317'>
  IMPLICIT NONE<a name='3318'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_75"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3319'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='3320'>
  CHARACTER*(*) :: Element<a name='3321'>
  CHARACTER*(*) :: DateStr<a name='3322'>
  integer ,       INTENT(IN)  :: Data(*)<a name='3323'>
  INTEGER ,       INTENT(IN)  :: Count<a name='3324'>
  INTEGER ,       INTENT(OUT) :: Status<a name='3325'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='3326'>
  INTEGER             :: idx<a name='3327'>
<a name='3328'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1227"> ( DEBUG , 'Entering ext_gr1_put_dom_td_integer')<a name='3329'>
<a name='3330'>
  if (committed(DataHandle)) then<a name='3331'>
<a name='3332'>
     do idx = 1,Count<a name='3333'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='3334'>
     enddo<a name='3335'>
     <a name='3336'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_20"> (td_output(DataHandle), DateStr//';'//Element, tmpstr, &amp;<a name='3337'>
          Count, Status)<a name='3338'>
<a name='3339'>
  endif<a name='3340'>
<a name='3341'>
  RETURN<a name='3342'>
END SUBROUTINE ext_gr1_put_dom_td_integer<a name='3343'>
<a name='3344'>
<font color=#447700>!*****************************************************************************<a name='3345'></font>
<a name='3346'>
<A NAME='EXT_GR1_PUT_DOM_TD_LOGICAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3347'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_dom_td_logical</font> ( DataHandle,Element, DateStr,  Data, &amp;,<A href='../../call_from/EXT_GR1_PUT_DOM_TD_LOGICAL.html' TARGET='index'>3</A><a name='3348'>
     Count,  Status )<a name='3349'>
<a name='3350'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_65"><a name='3351'>
  IMPLICIT NONE<a name='3352'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_76"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3353'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='3354'>
  CHARACTER*(*) :: Element<a name='3355'>
  CHARACTER*(*) :: DateStr<a name='3356'>
  logical ,       INTENT(IN)  :: Data(*)<a name='3357'>
  INTEGER ,       INTENT(IN)  :: Count<a name='3358'>
  INTEGER ,       INTENT(OUT) :: Status<a name='3359'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='3360'>
  INTEGER             :: idx<a name='3361'>
<a name='3362'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1228"> ( DEBUG , 'Entering ext_gr1_put_dom_td_logical')<a name='3363'>
<a name='3364'>
  if (committed(DataHandle)) then<a name='3365'>
<a name='3366'>
     do idx = 1,Count<a name='3367'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='3368'>
     enddo<a name='3369'>
     <a name='3370'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_21"> (td_output(DataHandle), DateStr//';'//Element, tmpstr, &amp;<a name='3371'>
          Count, Status)<a name='3372'>
<a name='3373'>
  endif<a name='3374'>
<a name='3375'>
  RETURN<a name='3376'>
END SUBROUTINE ext_gr1_put_dom_td_logical<a name='3377'>
<a name='3378'>
<font color=#447700>!*****************************************************************************<a name='3379'></font>
<a name='3380'>
<A NAME='EXT_GR1_PUT_DOM_TD_CHAR'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3381'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_dom_td_char</font> ( DataHandle,Element, DateStr,  Data, &amp;,<A href='../../call_from/EXT_GR1_PUT_DOM_TD_CHAR.html' TARGET='index'>3</A><a name='3382'>
     Status )<a name='3383'>
<a name='3384'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_66"><a name='3385'>
  IMPLICIT NONE<a name='3386'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_77"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3387'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='3388'>
  CHARACTER*(*) :: Element<a name='3389'>
  CHARACTER*(*) :: DateStr<a name='3390'>
  CHARACTER(len=*), INTENT(IN)  :: Data<a name='3391'>
  INTEGER ,       INTENT(OUT) :: Status<a name='3392'>
  CHARACTER(len=1000) :: tmpstr(1)<a name='3393'>
<a name='3394'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1229"> ( DEBUG , 'Entering ext_gr1_put_dom_td_char')<a name='3395'>
<a name='3396'>
  if (committed(DataHandle)) then<a name='3397'>
<a name='3398'>
     write(tmpstr(1),*)Data<a name='3399'>
<a name='3400'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_22"> (td_output(DataHandle), DateStr//';'//Element, tmpstr, &amp;<a name='3401'>
          1, Status)<a name='3402'>
<a name='3403'>
  endif<a name='3404'>
<a name='3405'>
  RETURN<a name='3406'>
END SUBROUTINE ext_gr1_put_dom_td_char <a name='3407'>
<a name='3408'>
<font color=#447700>!*****************************************************************************<a name='3409'></font>
<a name='3410'>
<A NAME='EXT_GR1_PUT_DOM_TD_DOUBLE'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3411'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_dom_td_double</font> ( DataHandle,Element, DateStr,  Data, &amp;,<A href='../../call_from/EXT_GR1_PUT_DOM_TD_DOUBLE.html' TARGET='index'>3</A><a name='3412'>
     Count,  Status )<a name='3413'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_67"><a name='3414'>
  IMPLICIT NONE<a name='3415'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_78"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3416'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='3417'>
  CHARACTER*(*) , INTENT(IN)  :: Element<a name='3418'>
  CHARACTER*(*) , INTENT(IN)  :: DateStr<a name='3419'>
  real*8 ,            INTENT(IN) :: Data(*)<a name='3420'>
  INTEGER ,       INTENT(IN)  :: Count<a name='3421'>
  INTEGER ,       INTENT(OUT) :: Status<a name='3422'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='3423'>
  INTEGER             :: idx<a name='3424'>
<a name='3425'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1230"> ( DEBUG , 'Entering ext_gr1_put_dom_td_double')<a name='3426'>
<a name='3427'>
  if (committed(DataHandle)) then<a name='3428'>
<a name='3429'>
     do idx = 1,Count<a name='3430'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='3431'>
     enddo<a name='3432'>
<a name='3433'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_23"> (td_output(DataHandle), DateStr//';'//Element, tmpstr, &amp;<a name='3434'>
          Count, Status)<a name='3435'>
<a name='3436'>
  endif<a name='3437'>
<a name='3438'>
RETURN<a name='3439'>
END SUBROUTINE ext_gr1_put_dom_td_double<a name='3440'>
<a name='3441'>
<font color=#447700>!*****************************************************************************<a name='3442'></font>
<a name='3443'>
<A NAME='EXT_GR1_PUT_DOM_TD_REAL'><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3444'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_gr1_put_dom_td_real</font> ( DataHandle,Element, DateStr,  Data, &amp; <A href='../../call_to/EXT_GR1_PUT_DOM_TD_REAL.html' TARGET='index'>4</A>,<A href='../../call_from/EXT_GR1_PUT_DOM_TD_REAL.html' TARGET='index'>3</A><a name='3445'>
     Count,  Status )<a name='3446'>
<a name='3447'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_68"><a name='3448'>
  IMPLICIT NONE<a name='3449'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_79"><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3450'>
  INTEGER ,       INTENT(IN)  :: DataHandle<a name='3451'>
  CHARACTER*(*) :: Element<a name='3452'>
  CHARACTER*(*) :: DateStr<a name='3453'>
  real ,          INTENT(IN)  :: Data(*)<a name='3454'>
  INTEGER ,       INTENT(IN)  :: Count<a name='3455'>
  INTEGER ,       INTENT(OUT) :: Status<a name='3456'>
  CHARACTER(len=1000) :: tmpstr(1000)<a name='3457'>
  INTEGER             :: idx<a name='3458'>
<a name='3459'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1231"> ( DEBUG , 'Entering ext_gr1_put_dom_td_real')<a name='3460'>
<a name='3461'>
  if (committed(DataHandle)) then<a name='3462'>
<a name='3463'>
     do idx = 1,Count<a name='3464'>
        write(tmpstr(idx),'(G17.10)')Data(idx)<a name='3465'>
     enddo<a name='3466'>
     <a name='3467'>
     CALL <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING'>gr1_build_string</A><A href='../../html_code/io_grib1/io_grib1.F.html#EXT_GR1_PUT_DOM_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_BUILD_STRING_24"> (td_output(DataHandle), DateStr//';'//Element, tmpstr, &amp;<a name='3468'>
          Count, Status)<a name='3469'>
<a name='3470'>
  endif<a name='3471'>
<a name='3472'>
  RETURN<a name='3473'>
END SUBROUTINE ext_gr1_put_dom_td_real <a name='3474'>
<a name='3475'>
<a name='3476'>
<font color=#447700>!******************************************************************************<a name='3477'></font>
<font color=#447700>!* End of put_dom_td_* routines<a name='3478'></font>
<font color=#447700>!******************************************************************************<a name='3479'></font>
<a name='3480'>
<a name='3481'>
<font color=#447700>!*****************************************************************************<a name='3482'></font>
<a name='3483'>
<A NAME='GR1_BUILD_STRING'><A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3484'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>gr1_build_string</font> (string, Element, Value, Count, Status) <A href='../../call_to/GR1_BUILD_STRING.html' TARGET='index'>24</A><a name='3485'>
<a name='3486'>
  IMPLICIT NONE<a name='3487'>
#include "<A href='../../html_code/include/wrf_status_codes.h.html'>wrf_status_codes.h</A>"<A NAME="wrf_status_codes.h_80"><A href='../../html_code/io_grib1/io_grib1.F.html#GR1_BUILD_STRING' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='3488'>
<a name='3489'>
  CHARACTER (LEN=*) , INTENT(INOUT) :: string<a name='3490'>
  CHARACTER (LEN=*) , INTENT(IN)    :: Element<a name='3491'>
  CHARACTER (LEN=*) , INTENT(IN)    :: Value(*)<a name='3492'>
  INTEGER ,           INTENT(IN)    :: Count<a name='3493'>
  INTEGER ,           INTENT(OUT)   :: Status<a name='3494'>
<a name='3495'>
  CHARACTER (LEN=2)                 :: lf<a name='3496'>
  INTEGER                           :: IDX<a name='3497'>
<a name='3498'>
  lf=char(10)//' '<a name='3499'>
  if (len_trim(string) == 0) then<a name='3500'>
     string = lf//Element//' = '<a name='3501'>
  else<a name='3502'>
     string = trim(string)//lf//Element//' = '<a name='3503'>
  endif<a name='3504'>
  do idx = 1,Count<a name='3505'>
     if (idx &gt; 1) then<a name='3506'>
        string = trim(string)//','<a name='3507'>
     endif<a name='3508'>
     string = trim(string)//' '//trim(adjustl(Value(idx)))<a name='3509'>
  enddo<a name='3510'>
<a name='3511'>
  Status = WRF_NO_ERR<a name='3512'>
<a name='3513'>
END SUBROUTINE gr1_build_string<a name='3514'>
<a name='3515'>
<font color=#447700>!*****************************************************************************<a name='3516'></font>
<a name='3517'>
<A NAME='GR1_GET_NEW_HANDLE'><A href='../../html_code/io_grib1/io_grib1.F.html#GR1_GET_NEW_HANDLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3518'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>gr1_get_new_handle</font>(DataHandle) <A href='../../call_to/GR1_GET_NEW_HANDLE.html' TARGET='index'>2</A>,<A href='../../call_from/GR1_GET_NEW_HANDLE.html' TARGET='index'>2</A><a name='3519'>
  USE <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#GR1_GET_NEW_HANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_69"><a name='3520'>
  IMPLICIT NONE<a name='3521'>
  <a name='3522'>
  INTEGER ,       INTENT(OUT)  :: DataHandle<a name='3523'>
  INTEGER :: i<a name='3524'>
<a name='3525'>
  DataHandle = -1<a name='3526'>
  do i=firstFileHandle, maxFileHandles<a name='3527'>
     if (.NOT. used(i)) then<a name='3528'>
        DataHandle = i<a name='3529'>
<A href='../../html_code/share/dfi.F.html#D'></A><A href='../../html_code/io_grib1/io_grib1.F.html#GR1_GET_NEW_HANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="D_27">d(i) = .true.<a name='3530'>
        exit<a name='3531'>
     endif<a name='3532'>
  enddo<a name='3533'>
<a name='3534'>
  RETURN<a name='3535'>
END SUBROUTINE gr1_get_new_handle<a name='3536'>
<a name='3537'>
<a name='3538'>
<font color=#447700>!******************************************************************************<a name='3539'></font>
<a name='3540'>
<a name='3541'>
<A NAME='GR1_GET_LEVELS'><A href='../../html_code/io_grib1/io_grib1.F.html#GR1_GET_LEVELS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3542'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>gr1_get_levels</font>(VarName, zidx, zsize, soil_layers, vert_stag, fraction, &amp; <A href='../../call_to/GR1_GET_LEVELS.html' TARGET='index'>2</A>,<A href='../../call_from/GR1_GET_LEVELS.html' TARGET='index'>1</A><a name='3543'>
     is_press_levels, is_turb_layers, vert_unit, level1, level2)<a name='3544'>
<a name='3545'>
  use <A href='../../html_code/io_grib1/io_grib1.F.html#GR1_DATA_INFO'>gr1_data_info</A><A href='../../html_code/io_grib1/io_grib1.F.html#GR1_GET_LEVELS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GR1_DATA_INFO_70"><a name='3546'>
  IMPLICIT NONE<a name='3547'>
<a name='3548'>
  integer :: zidx<a name='3549'>
  integer :: zsize<a name='3550'>
  logical :: soil_layers<a name='3551'>
  logical :: vert_stag<a name='3552'>
  logical :: fraction<a name='3553'>
  logical :: is_press_levels<a name='3554'>
  logical :: is_turb_layers <a name='3555'>
  integer :: vert_unit<a name='3556'>
  integer :: level1<a name='3557'>
  integer :: level2<a name='3558'>
  character (LEN=*) :: VarName<a name='3559'>
<a name='3560'>
  <font color=#447700>! Setup vert_unit, and vertical levels in grib units<a name='3561'></font>
<a name='3562'>
  if ((VarName .eq. 'LANDUSEF') .or. (VarName .eq. 'SOILCTOP') &amp;<a name='3563'>
       .or. (VarName .eq. 'SOILCBOT')) then<a name='3564'>
     vert_unit = 109;<a name='3565'>
     level1 = zidx<a name='3566'>
     level2 = 0<a name='3567'>
  else if ((zsize .gt. 1) .and. (.not. soil_layers) .and. (.not. fraction) &amp;<a name='3568'>
            .and. (.not. is_press_levels) .and. (.not. is_turb_layers)) then<a name='3569'>
     vert_unit = 119;<a name='3570'>
     if (vert_stag) then<a name='3571'>
        level1 = (10000*full_eta(zidx)+0.5)<a name='3572'>
     else<a name='3573'>
        level1 = (10000*half_eta(zidx)+0.5)<a name='3574'>
     endif<a name='3575'>
     level2 = 0<a name='3576'>
  else<a name='3577'>
     <font color=#447700>! Set the vertical coordinate and level for soil and 2D fields<a name='3578'></font>
     if (fraction) then<a name='3579'>
        vert_unit = 109<a name='3580'>
        level1 = zidx<a name='3581'>
        level2 = 0           <a name='3582'>
     else if (soil_layers) then<a name='3583'>
        vert_unit = 112<a name='3584'>
        level1 = 100*(soil_depth(zidx) - 0.5*soil_thickness(zidx))+0.5<a name='3585'>
        level2 = 100*(soil_depth(zidx) + 0.5*soil_thickness(zidx))+0.5<a name='3586'>
     <font color=#447700>! Added pressure level as vertical unit - GAC 20140402<a name='3587'></font>
     else if (is_press_levels) then<a name='3588'>
        vert_unit = 100<a name='3589'>
        level1 = press_levels(zidx)/100.<a name='3590'>
        level2 = 0<a name='3591'>
     else if (is_turb_layers) then<a name='3592'>
        vert_unit = 106<a name='3593'>
        level1 = turb_layer_top(zidx)/100.<a name='3594'>
        level2 = turb_layer_bot(zidx)/100.<a name='3595'>
     else if (VarName .eq. 'mu') then<a name='3596'>
        vert_unit = 200<a name='3597'>
        level1 = 0<a name='3598'>
        level2 = 0<a name='3599'>
     else if ((VarName .eq. 'Q2') .or. (VarName .eq. 'TH2') .or. &amp;<a name='3600'>
        (VarName .eq. 'T2')) then<a name='3601'>
        vert_unit = 105<a name='3602'>
        level1 = 2<a name='3603'>
        level2 = 0<a name='3604'>
     else if ((VarName .eq. 'Q10') .or. (VarName .eq. 'TH10') .or. &amp;<a name='3605'>
          (VarName .eq. 'U10') .or. (VarName .eq. 'V10')) then<a name='3606'>
        vert_unit = 105<a name='3607'>
        level1 = 10<a name='3608'>
        level2 = 0<a name='3609'>
     <font color=#447700>! Until a more sophisticated way to do this becomes clear,<a name='3610'></font>
     <font color=#447700>! adding AFWA diagnostic variable vertical unit and level info<a name='3611'></font>
     <font color=#447700>! here.  GAC 20140402<a name='3612'></font>
     else if ((VarName .eq. 'TCOLI_MAX') .or.                      &amp;<a name='3613'>
             (Varname .eq. 'GRPL_FLX_MAX') .or.                    &amp;<a name='3614'>
             (Varname .eq. 'VIL') .or.                             &amp;<a name='3615'>
             (Varname .eq. 'RADARVIL') .or.                        &amp;<a name='3616'>
             (Varname .eq. 'FZLEV') .or.                           &amp;<a name='3617'>
             (Varname .eq. 'REFD_COM') .or.                        &amp;<a name='3618'>
             (Varname .eq. 'ICINGTOP') .or.                        &amp;<a name='3619'>
             (Varname .eq. 'ICINGBOT') .or.                        &amp;<a name='3620'>
             (Varname .eq. 'ICING_LG') .or.                        &amp;<a name='3621'>
             (Varname .eq. 'ICING_SM') .or.                        &amp;<a name='3622'>
             (Varname .eq. 'AFWA_CLOUD') .or.                      &amp;<a name='3623'>
             (Varname .eq. 'AFWA_CLOUD_CEIL') .or.                 &amp;<a name='3624'>
             (Varname .eq. 'AFWA_HAIL') .or.                       &amp;<a name='3625'>
             (Varname .eq. 'AFWA_TORNADO') .or.                    &amp;<a name='3626'>
             (Varname .eq. 'AFWA_PWAT') .or.                       &amp;<a name='3627'>
             (Varname .eq. 'QICING_LG_MAX') .or.                   &amp;<a name='3628'>
             (Varname .eq. 'QICING_SM_MAX')) then<a name='3629'>
        vert_unit = 200<a name='3630'>
        level1 = 0<a name='3631'>
        level2 = 0<a name='3632'>
     else if (VarName .eq. 'REFD_MAX') then<a name='3633'>
        vert_unit = 105<a name='3634'>
        level1 = 1000<a name='3635'>
        level2 = 0<a name='3636'>
     else if (VarName .eq. 'WSPD10MAX') then<a name='3637'>
        vert_unit = 105<a name='3638'>
        level1 = 10<a name='3639'>
        level2 = 0<a name='3640'>
     else if (VarName .eq. 'UP_HELI_MAX') then<a name='3641'>
        vert_unit = 106<a name='3642'>
        level1 = 50 <font color=#447700>!5000 m<a name='3643'></font>
        level2 = 20 <font color=#447700>!2000 m<a name='3644'></font>
     else if (Varname .eq. 'AFWA_LLWS') then<a name='3645'>
        vert_unit = 106<a name='3646'>
        level1 = 20 <font color=#447700>!2000 m<a name='3647'></font>
        level2 = 0  <font color=#447700>!0 m<a name='3648'></font>
     else if ((Varname .eq. 'AFWA_LLTURB') .or.                   &amp;<a name='3649'>
              (Varname .eq. 'AFWA_LLTURBLGT') .or.                &amp;<a name='3650'>
              (Varname .eq. 'AFWA_LLTURBMDT') .or.                &amp;<a name='3651'>
              (Varname .eq. 'AFWA_LLTURBSVR')) then<a name='3652'>
        vert_unit = 106<a name='3653'>
        level1 = 15 <font color=#447700>!1500 m<a name='3654'></font>
        level2 = 0  <font color=#447700>!0 m<a name='3655'></font>
     else if ((VarName .eq. 'W_UP_MAX') .or. (VarName .eq. 'W_DN_MAX')) then<a name='3656'>
        vert_unit = 101<a name='3657'>
        level1 = 40  <font color=#447700>!400 mb<a name='3658'></font>
        level2 = 100 <font color=#447700>!1000 mb<a name='3659'></font>
     else if (VarName .eq. 'AFWA_LIDX') then<a name='3660'>
        vert_unit = 101<a name='3661'>
        level1 = 50  <font color=#447700>!500 mb<a name='3662'></font>
        level2 = 100 <font color=#447700>!1000 mb<a name='3663'></font>
     else if (VarName .eq. 'AFWA_MSLP') then<a name='3664'>
        vert_unit = 102  <font color=#447700>! Mean sea level<a name='3665'></font>
        level1 = 0<a name='3666'>
        level2 = 0<a name='3667'>
     else if ((VarName .eq. 'AFWA_CAPE_MU') .or.                  &amp;<a name='3668'>
              (VarName .eq. 'AFWA_CIN_MU')) then<a name='3669'>
        vert_unit = 116  <font color=#447700>! Pressure above ground<a name='3670'></font>
        <font color=#447700>!level1 = 180     ! 180 mb AGL<a name='3671'></font>
        <font color=#447700>!level2 = 0<a name='3672'></font>
        level1 = 0       <font color=#447700>! 180 mb AGL<a name='3673'></font>
        level2 = 180<a name='3674'>
     else <a name='3675'>
        vert_unit = 1<a name='3676'>
        level1 = 0<a name='3677'>
        level2 = 0<a name='3678'>
     endif<a name='3679'>
  endif<a name='3680'>
<a name='3681'>
end SUBROUTINE gr1_get_levels<a name='3682'>
<a name='3683'>
<font color=#447700>!*****************************************************************************<a name='3684'></font>
<a name='3685'>
<a name='3686'>
<A NAME='GR1_FILL_ETA_LEVELS'><A href='../../html_code/io_grib1/io_grib1.F.html#GR1_FILL_ETA_LEVELS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3687'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>gr1_fill_eta_levels</font>(fileindex, FileFd, grib_tables, VarName, eta_levels) <A href='../../call_to/GR1_FILL_ETA_LEVELS.html' TARGET='index'>2</A>,<A href='../../call_from/GR1_FILL_ETA_LEVELS.html' TARGET='index'>1</A><a name='3688'>
  IMPLICIT NONE<a name='3689'>
<a name='3690'>
  CHARACTER (len=*) :: fileindex<a name='3691'>
  INTEGER   :: FileFd<a name='3692'>
  CHARACTER (len=*) :: grib_tables<a name='3693'>
  character (len=*) :: VarName<a name='3694'>
  REAL,DIMENSION(*) :: eta_levels<a name='3695'>
<a name='3696'>
  INTEGER   :: center, subcenter, parmtbl<a name='3697'>
  INTEGER   :: swapped<a name='3698'>
  INTEGER   :: leveltype<a name='3699'>
  INTEGER   :: idx<a name='3700'>
  INTEGER   :: parmid<a name='3701'>
  INTEGER   :: tablenum<a name='3702'>
  REAL      :: tmp<a name='3703'>
  INTEGER   :: numindices<a name='3704'>
  integer , DIMENSION(1000)   :: indices<a name='3705'>
<a name='3706'>
  <font color=#447700>!<a name='3707'></font>
  <font color=#447700>! Read the levels from the grib file<a name='3708'></font>
  <font color=#447700>!<a name='3709'></font>
  CALL GET_GRIB_PARAM(grib_tables, VarName, center, subcenter, parmtbl, &amp;<a name='3710'>
       tablenum, parmid)<a name='3711'>
<a name='3712'>
  if (parmid == -1) then<a name='3713'>
     call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/io_grib1/io_grib1.F.html#GR1_FILL_ETA_LEVELS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1491"> ('Error getting grib parameter')<a name='3714'>
  endif<a name='3715'>
<a name='3716'>
  leveltype = 119<a name='3717'>
<a name='3718'>
  CALL GET_GRIB_INDICES(fileindex(:), center, subcenter, parmtbl, &amp;<a name='3719'>
       parmid, "*", leveltype, &amp;<a name='3720'>
       -HUGE(1), -HUGE(1), -HUGE(1), -HUGE(1), indices, numindices)<a name='3721'>
<a name='3722'>
  do idx = 1,numindices<a name='3723'>
     CALL READ_GRIB(fileindex(:),FileFd,indices(idx),eta_levels(idx))<a name='3724'>
  enddo<a name='3725'>
<a name='3726'>
  <font color=#447700>!<a name='3727'></font>
  <font color=#447700>! Sort the levels--from highest (bottom) to lowest (top)<a name='3728'></font>
  <font color=#447700>!<a name='3729'></font>
  swapped = 1<a name='3730'>
  sortloop : do<a name='3731'>
     if (swapped /= 1) exit sortloop<a name='3732'>
     swapped = 0<a name='3733'>
     do idx=2, numindices<a name='3734'>
        <font color=#447700>!<a name='3735'></font>
        <font color=#447700>! Remove duplicate levels, caused by multiple time periods in a <a name='3736'></font>
        <font color=#447700>! single file.<a name='3737'></font>
        <font color=#447700>!<a name='3738'></font>
        if (eta_levels(idx) == eta_levels(idx-1)) eta_levels(idx) = 0.0<a name='3739'>
        if (eta_levels(idx) &gt; eta_levels(idx-1)) then<a name='3740'>
          tmp = eta_levels(idx)<a name='3741'>
          eta_levels(idx) = eta_levels(idx - 1)<a name='3742'>
          eta_levels(idx - 1) = tmp<a name='3743'>
          swapped = 1<a name='3744'>
        endif<a name='3745'>
     enddo<a name='3746'>
  enddo sortloop<a name='3747'>
<a name='3748'>
end subroutine gr1_fill_eta_levels<a name='3749'>
<a name='3750'>
</pre></body></html>