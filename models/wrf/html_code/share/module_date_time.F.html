<HTML> <BODY BGCOLOR=#eedddd LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!WRF:MODEL_LAYER:UTIL<a name='2'></font>
<font color=#447700>!<a name='3'></font>
<A NAME='MODULE_DATE_TIME'><A href='../../html_code/share/module_date_time.F.html#MODULE_DATE_TIME' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='4'>
<font color=#993300>MODULE </font><font color=#cc0000>module_date_time</font> <A href='../../call_to/MODULE_DATE_TIME.html' TARGET='index'>32</A><a name='5'>
<a name='6'>
  USE <A href='../../html_code/frame/module_wrf_error.F.html#MODULE_WRF_ERROR'>module_wrf_error</A><A href='../../html_code/share/module_date_time.F.html#module_date_time.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_WRF_ERROR_107"><a name='7'>
  USE <A href='../../html_code/frame/module_configure.F.html#MODULE_CONFIGURE'>module_configure</A><A href='../../html_code/share/module_date_time.F.html#module_date_time.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CONFIGURE_265"><a name='8'>
  USE <A href='../../html_code/share/module_model_constants.F.html#MODULE_MODEL_CONSTANTS'>module_model_constants</A><A href='../../html_code/share/module_date_time.F.html#module_date_time.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MODEL_CONSTANTS_116"><a name='9'>
<a name='10'>
  CHARACTER* 24 ::   start_date = '                        '<a name='11'>
  CHARACTER* 24 ::   current_date<a name='12'>
  INTEGER , PARAMETER :: len_current_date  = 24<a name='13'>
  REAL , PRIVATE :: xtime<a name='14'>
<a name='15'>
<font color=#447700>!  1.  geth_idts (ndate, odate, idts)<a name='16'></font>
<font color=#447700>!  Get the time period between two dates.<a name='17'></font>
<a name='18'>
<font color=#447700>!  2. geth_newdate ( ndate, odate, idts)<a name='19'></font>
<font color=#447700>!  Get the new date based on the old date and a time difference.<a name='20'></font>
<a name='21'>
<font color=#447700>!  3. split_date_char ( date , century_year , month , day , hour , minute , second , ten_thousandth)<a name='22'></font>
<font color=#447700>!  Given the date, return the integer components.<a name='23'></font>
<a name='24'>
CONTAINS<a name='25'>
<a name='26'>
<font color=#447700>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<a name='27'></font>
<a name='28'>
<A NAME='GET_JULGMT'><A href='../../html_code/share/module_date_time.F.html#GET_JULGMT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='29'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>get_julgmt</font>(date_str,julyr,julday,gmt) <A href='../../call_to/GET_JULGMT.html' TARGET='index'>2</A>,<A href='../../call_from/GET_JULGMT.html' TARGET='index'>1</A><a name='30'>
     IMPLICIT NONE<a name='31'>
<font color=#447700>! Arguments<a name='32'></font>
     CHARACTER (LEN=24) , INTENT(IN) :: date_str<a name='33'>
     INTEGER, INTENT(OUT  ) :: julyr<a name='34'>
     INTEGER, INTENT(OUT  ) :: julday<a name='35'>
     REAL   , INTENT(OUT  ) :: gmt<a name='36'>
<font color=#447700>! Local<a name='37'></font>
     INTEGER :: ny , nm , nd , nh , ni , ns , nt<a name='38'>
     INTEGER :: my1, my2, my3, monss<a name='39'>
     INTEGER, DIMENSION(12) :: mmd<a name='40'>
     DATA MMD/31,28,31,30,31,30,31,31,30,31,30,31/<a name='41'>
     CALL <A href='../../html_code/share/module_date_time.F.html#SPLIT_DATE_CHAR'>split_date_char</A><A href='../../html_code/share/module_date_time.F.html#GET_JULGMT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SPLIT_DATE_CHAR_4"> ( date_str , ny , nm , nd , nh , ni , ns , nt )<a name='42'>
#ifdef PLANET<a name='43'>
     GMT=nh+FLOAT(ni)/60.+(FLOAT(ns)+FLOAT(nt)/1.e6)/3600.<a name='44'>
     JULDAY=nd<a name='45'>
     JULYR=ny<a name='46'>
#else<a name='47'>
     GMT=nh+FLOAT(ni)/60.+FLOAT(ns)/3600.<a name='48'>
     MY1=MOD(ny,4)<a name='49'>
     MY2=MOD(ny,100)<a name='50'>
     MY3=MOD(ny,400)<a name='51'>
     IF(MY1.EQ.0.AND.MY2.NE.0.OR.MY3.EQ.0)MMD(2)=29<a name='52'>
     JULDAY=nd<a name='53'>
     JULYR=ny<a name='54'>
     DO MONSS=1,nm-1<a name='55'>
       JULDAY=JULDAY+MMD(MONSS)<a name='56'>
     ENDDO<a name='57'>
#endif<a name='58'>
   END SUBROUTINE get_julgmt<a name='59'>
<a name='60'>
<a name='61'>
<A NAME='GETH_JULGMT'><A href='../../html_code/share/module_date_time.F.html#GETH_JULGMT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='62'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>geth_julgmt</font>(julyr,julday, gmt) <A href='../../call_to/GETH_JULGMT.html' TARGET='index'>7</A>,<A href='../../call_from/GETH_JULGMT.html' TARGET='index'>1</A><a name='63'>
     IMPLICIT NONE<a name='64'>
<font color=#447700>! Arguments<a name='65'></font>
     INTEGER, INTENT(OUT  ) :: julyr<a name='66'>
     INTEGER, INTENT(OUT  ) :: julday<a name='67'>
     REAL   , INTENT(OUT  ) :: gmt<a name='68'>
<font color=#447700>! Local<a name='69'></font>
     INTEGER :: ny , nm , nd , nh , ni , ns , nt<a name='70'>
     INTEGER :: my1, my2, my3, monss<a name='71'>
     INTEGER, DIMENSION(12) :: mmd<a name='72'>
     DATA MMD/31,28,31,30,31,30,31,31,30,31,30,31/<a name='73'>
     CALL <A href='../../html_code/share/module_date_time.F.html#SPLIT_DATE_CHAR'>split_date_char</A><A href='../../html_code/share/module_date_time.F.html#GETH_JULGMT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SPLIT_DATE_CHAR_5"> ( current_date , ny , nm , nd , nh , ni , ns , nt )<a name='74'>
#ifdef PLANET<a name='75'>
     GMT=nh+FLOAT(ni)/60.+(FLOAT(ns)+FLOAT(nt)/1.e6)/3600.<a name='76'>
     JULDAY=nd<a name='77'>
     JULYR=ny<a name='78'>
#else<a name='79'>
     GMT=nh+FLOAT(ni)/60.+FLOAT(ns)/3600.<a name='80'>
     MY1=MOD(ny,4)<a name='81'>
     MY2=MOD(ny,100)<a name='82'>
     MY3=MOD(ny,400)<a name='83'>
     IF(MY1.EQ.0.AND.MY2.NE.0.OR.MY3.EQ.0)MMD(2)=29<a name='84'>
     JULDAY=nd<a name='85'>
     JULYR=ny<a name='86'>
     DO MONSS=1,nm-1<a name='87'>
       JULDAY=JULDAY+MMD(MONSS)<a name='88'>
     ENDDO<a name='89'>
#endif<a name='90'>
   END SUBROUTINE geth_julgmt<a name='91'>
<a name='92'>
<A NAME='CALC_CURRENT_DATE'><A href='../../html_code/share/module_date_time.F.html#CALC_CURRENT_DATE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='93'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>calc_current_date</font> (id, time) <A href='../../call_to/CALC_CURRENT_DATE.html' TARGET='index'>1</A>,<A href='../../call_from/CALC_CURRENT_DATE.html' TARGET='index'>7</A><a name='94'>
<font color=#447700>! This subroutines calculates current_date and xtime<a name='95'></font>
   IMPLICIT NONE<a name='96'>
<font color=#447700>! Arguments<a name='97'></font>
   INTEGER, INTENT(IN   ) :: id <font color=#447700>! grid id<a name='98'></font>
   REAL, INTENT(IN   ) :: time <font color=#447700>! time in seconds since start time<a name='99'></font>
<font color=#447700>! Local<a name='100'></font>
   INTEGER :: julyr, julday, idt<a name='101'>
   CHARACTER*19  new_date<a name='102'>
   CHARACTER*24  base_date<a name='103'>
   CHARACTER*128 mess<a name='104'>
   REAL :: gmt<a name='105'>
<a name='106'>
    xtime = time/60.<a name='107'>
    CALL nl_get_gmt (id, gmt)<a name='108'>
    CALL nl_get_julyr (id, julyr)<a name='109'>
    CALL nl_get_julday (id, julday)<a name='110'>
    idt        = 86400*(julday-1)+nint(3600*gmt)<a name='111'>
    write (mess,*) 'calc_current_date called: time = ',time,' idt = ',idt<a name='112'>
    CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/share/module_date_time.F.html#CALC_CURRENT_DATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1058">(300,TRIM(mess))<a name='113'>
    write (mess,*) 'calc_current_date called: gmt  = ',gmt<a name='114'>
    CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/share/module_date_time.F.html#CALC_CURRENT_DATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1059">(300,TRIM(mess))<a name='115'>
    write (mess,*) 'calc_current_date called: julyr  = ',julyr<a name='116'>
    CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/share/module_date_time.F.html#CALC_CURRENT_DATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1060">(300,TRIM(mess))<a name='117'>
    write (mess,*) 'calc_current_date called: julday = ',julday<a name='118'>
    CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/share/module_date_time.F.html#CALC_CURRENT_DATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1061">(300,TRIM(mess))<a name='119'>
#ifdef PLANET<a name='120'>
    base_date  = '0000-00001_00:00:00.0000'<a name='121'>
#else<a name='122'>
    base_date  = '0000-01-01_00:00:00.0000'<a name='123'>
#endif<a name='124'>
    write(base_date(1:4),'(I4.4)')julyr<a name='125'>
    CALL <A href='../../html_code/share/module_date_time.F.html#GETH_NEWDATE'>geth_newdate</A><A href='../../html_code/share/module_date_time.F.html#CALC_CURRENT_DATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETH_NEWDATE_16"> (start_date(1:19), base_date(1:19), idt)<a name='126'>
    CALL <A href='../../html_code/share/module_date_time.F.html#GETH_NEWDATE'>geth_newdate</A><A href='../../html_code/share/module_date_time.F.html#CALC_CURRENT_DATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETH_NEWDATE_17"> (new_date, start_date(1:19), nint(time))<a name='127'>
    write (current_date(1:24),fmt=340)new_date<a name='128'>
    340 format(a19, '.0000')<a name='129'>
    write (mess,*) current_date,gmt,julday,julyr,'=current_date,gmt,julday,julyr: calc_current_date'<a name='130'>
    CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/share/module_date_time.F.html#CALC_CURRENT_DATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1062">(300,TRIM(mess))<a name='131'>
   END SUBROUTINE calc_current_date<a name='132'>
<a name='133'>
<font color=#447700>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<a name='134'></font>
<a name='135'>
<A NAME='GETH_IDTS'><A href='../../html_code/share/module_date_time.F.html#GETH_IDTS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='136'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>geth_idts</font> (ndate, odate, idts) <A href='../../call_to/GETH_IDTS.html' TARGET='index'>5</A>,<A href='../../call_from/GETH_IDTS.html' TARGET='index'>8</A><a name='137'>
   <a name='138'>
      IMPLICIT NONE<a name='139'>
      <a name='140'>
      <font color=#447700>!  From 2 input mdates ('YYYY-MM-DD HH:MM:SS.ffff'), <a name='141'></font>
      <font color=#447700>!                   or ('YYYY-DDDDD HH:MM:SS.ffff'),<a name='142'></font>
      <font color=#447700>!  compute the time difference.<a name='143'></font>
      <a name='144'>
      <font color=#447700>!  on entry     -  ndate  -  the new hdate.<a name='145'></font>
      <font color=#447700>!                  odate  -  the old hdate.<a name='146'></font>
      <a name='147'>
      <font color=#447700>!  on exit      -  idts    -  the change in time in seconds.<a name='148'></font>
      <a name='149'>
      CHARACTER (LEN=*) , INTENT(INOUT) :: ndate, odate<a name='150'>
      INTEGER           , INTENT(OUT)   :: idts<a name='151'>
      <a name='152'>
      <font color=#447700>!  Local Variables<a name='153'></font>
      <a name='154'>
      <font color=#447700>!  yrnew    -  indicates the year associated with "ndate"<a name='155'></font>
      <font color=#447700>!  yrold    -  indicates the year associated with "odate"<a name='156'></font>
      <font color=#447700>!  monew    -  indicates the month associated with "ndate"<a name='157'></font>
      <font color=#447700>!  moold    -  indicates the month associated with "odate"<a name='158'></font>
      <font color=#447700>!  dynew    -  indicates the day associated with "ndate"<a name='159'></font>
      <font color=#447700>!  dyold    -  indicates the day associated with "odate"<a name='160'></font>
      <font color=#447700>!  hrnew    -  indicates the hour associated with "ndate"<a name='161'></font>
      <font color=#447700>!  hrold    -  indicates the hour associated with "odate"<a name='162'></font>
      <font color=#447700>!  minew    -  indicates the minute associated with "ndate"<a name='163'></font>
      <font color=#447700>!  miold    -  indicates the minute associated with "odate"<a name='164'></font>
      <font color=#447700>!  scnew    -  indicates the second associated with "ndate"<a name='165'></font>
      <font color=#447700>!  scold    -  indicates the second associated with "odate"<a name='166'></font>
      <font color=#447700>!  i        -  loop counter<a name='167'></font>
      <font color=#447700>!  mday     -  a list assigning the number of days in each month<a name='168'></font>
      <a name='169'>
      CHARACTER (LEN=24) :: tdate<a name='170'>
      INTEGER :: olen, nlen<a name='171'>
      INTEGER :: yrnew, monew, dynew, hrnew, minew, scnew<a name='172'>
      INTEGER :: yrold, moold, dyold, hrold, miold, scold<a name='173'>
      INTEGER :: mday(12), i, newdys, olddys<a name='174'>
      LOGICAL :: npass, opass<a name='175'>
      INTEGER :: isign<a name='176'>
      <a name='177'>
      IF (odate.GT.ndate) THEN<a name='178'>
         isign = -1<a name='179'>
         tdate=ndate<a name='180'>
         ndate=odate<a name='181'>
         odate=tdate<a name='182'>
      ELSE<a name='183'>
         isign = 1<a name='184'>
      END IF<a name='185'>
      <a name='186'>
      <font color=#447700>!  Assign the number of days in a months<a name='187'></font>
      <a name='188'>
      mday( 1) = 31<a name='189'>
      mday( 2) = 28<a name='190'>
      mday( 3) = 31<a name='191'>
      mday( 4) = 30<a name='192'>
      mday( 5) = 31<a name='193'>
      mday( 6) = 30<a name='194'>
      mday( 7) = 31<a name='195'>
      mday( 8) = 31<a name='196'>
      mday( 9) = 30<a name='197'>
      mday(10) = 31<a name='198'>
      mday(11) = 30<a name='199'>
      mday(12) = 31<a name='200'>
      <a name='201'>
      <font color=#447700>!  Break down old hdate into parts<a name='202'></font>
      <a name='203'>
      hrold = 0<a name='204'>
      miold = 0<a name='205'>
      scold = 0<a name='206'>
      olen = LEN(odate)<a name='207'>
      <a name='208'>
      READ(odate(1:4),  '(I4.4)') yrold<a name='209'>
#ifdef PLANET<a name='210'>
      READ(odate(6:10), '(I5)') dyold<a name='211'>
      moold=0.<a name='212'>
#else<a name='213'>
      READ(odate(6:7),  '(I2)') moold<a name='214'>
      READ(odate(9:10), '(I2)') dyold<a name='215'>
#endif<a name='216'>
      IF (olen.GE.13) THEN<a name='217'>
         READ(odate(12:13),'(I2)') hrold<a name='218'>
         IF (olen.GE.16) THEN<a name='219'>
            READ(odate(15:16),'(I2)') miold<a name='220'>
            IF (olen.GE.19) THEN<a name='221'>
               READ(odate(18:19),'(I2)') scold<a name='222'>
            END IF<a name='223'>
         END IF<a name='224'>
      END IF<a name='225'>
      <a name='226'>
      <font color=#447700>!  Break down new hdate into parts<a name='227'></font>
      <a name='228'>
      hrnew = 0<a name='229'>
      minew = 0<a name='230'>
      scnew = 0<a name='231'>
      nlen = LEN(ndate)<a name='232'>
      <a name='233'>
      READ(ndate(1:4),  '(I4.4)') yrnew<a name='234'>
#ifdef PLANET<a name='235'>
      READ(ndate(6:10), '(I5)') dynew<a name='236'>
      monew=0.<a name='237'>
#else<a name='238'>
      READ(ndate(6:7),  '(I2)') monew<a name='239'>
      READ(ndate(9:10), '(I2)') dynew<a name='240'>
#endif<a name='241'>
      IF (nlen.GE.13) THEN<a name='242'>
         READ(ndate(12:13),'(I2)') hrnew<a name='243'>
         IF (nlen.GE.16) THEN<a name='244'>
            READ(ndate(15:16),'(I2)') minew<a name='245'>
            IF (nlen.GE.19) THEN<a name='246'>
               READ(ndate(18:19),'(I2)') scnew<a name='247'>
            END IF<a name='248'>
         END IF<a name='249'>
      END IF<a name='250'>
      <a name='251'>
      <font color=#447700>!  Check that the dates make sense.<a name='252'></font>
      <a name='253'>
      npass = .true.<a name='254'>
      opass = .true.<a name='255'>
      <a name='256'>
#ifdef PLANET<a name='257'>
      <font color=#447700>!  Check that the day of NDATE makes sense.<a name='258'></font>
      <a name='259'>
      IF ((dynew &gt; PLANET_YEAR).or.(dynew &lt; 1)) THEN<a name='260'>
         PRINT*, 'GETH_IDTS:  Day of NDATE = ', dynew<a name='261'>
         npass = .false.<a name='262'>
      END IF<a name='263'>
<a name='264'>
      <font color=#447700>!  Check that the day of ODATE makes sense.<a name='265'></font>
<a name='266'>
      IF ((dyold &gt; PLANET_YEAR).or.(dyold &lt; 1)) THEN<a name='267'>
         PRINT*, 'GETH_IDTS:  Day of ODATE = ', dyold<a name='268'>
         opass = .false.<a name='269'>
      END IF<a name='270'>
<a name='271'>
#else<a name='272'>
      <font color=#447700>!  Check that the month of NDATE makes sense.<a name='273'></font>
      <a name='274'>
      IF ((monew.GT.12).or.(monew.LT.1)) THEN<a name='275'>
         PRINT*, 'GETH_IDTS:  Month of NDATE = ', monew<a name='276'>
         npass = .false.<a name='277'>
      END IF<a name='278'>
      <a name='279'>
      <font color=#447700>!  Check that the month of ODATE makes sense.<a name='280'></font>
      <a name='281'>
      IF ((moold.GT.12).or.(moold.LT.1)) THEN<a name='282'>
         PRINT*, 'GETH_IDTS:  Month of ODATE = ', moold<a name='283'>
         opass = .false.<a name='284'>
      END IF<a name='285'>
      <a name='286'>
      <font color=#447700>!  Check that the day of NDATE makes sense.<a name='287'></font>
      <a name='288'>
      IF (monew.ne.2) THEN<a name='289'>
      <font color=#447700>! ...... For all months but February<a name='290'></font>
         IF ((dynew.GT.mday(monew)).or.(dynew.LT.1)) THEN<a name='291'>
            PRINT*, 'GETH_IDTS:  Day of NDATE = ', dynew<a name='292'>
            npass = .false.<a name='293'>
         END IF<a name='294'>
      ELSE IF (monew.eq.2) THEN<a name='295'>
      <font color=#447700>! ...... For February<a name='296'></font>
         IF ((dynew.GT.nfeb(yrnew)).OR.(dynew.LT.1)) THEN<a name='297'>
            PRINT*, 'GETH_IDTS:  Day of NDATE = ', dynew<a name='298'>
            npass = .false.<a name='299'>
         END IF<a name='300'>
      END IF<a name='301'>
      <a name='302'>
      <font color=#447700>!  Check that the day of ODATE makes sense.<a name='303'></font>
      <a name='304'>
      IF (moold.ne.2) THEN<a name='305'>
      <font color=#447700>! ...... For all months but February<a name='306'></font>
         IF ((dyold.GT.mday(moold)).or.(dyold.LT.1)) THEN<a name='307'>
            PRINT*, 'GETH_IDTS:  Day of ODATE = ', dyold<a name='308'>
            opass = .false.<a name='309'>
         END IF<a name='310'>
      ELSE IF (moold.eq.2) THEN<a name='311'>
      <font color=#447700>! ....... For February<a name='312'></font>
         IF ((dyold.GT.nfeb(yrold)).or.(dyold.LT.1)) THEN<a name='313'>
            PRINT*, 'GETH_IDTS:  Day of ODATE = ', dyold<a name='314'>
            opass = .false.<a name='315'>
         END IF<a name='316'>
      END IF<a name='317'>
#endif<a name='318'>
      <font color=#447700>!  Check that the hour of NDATE makes sense.<a name='319'></font>
      <a name='320'>
      IF ((hrnew.GT.23).or.(hrnew.LT.0)) THEN<a name='321'>
         PRINT*, 'GETH_IDTS:  Hour of NDATE = ', hrnew<a name='322'>
         npass = .false.<a name='323'>
      END IF<a name='324'>
      <a name='325'>
      <font color=#447700>!  Check that the hour of ODATE makes sense.<a name='326'></font>
      <a name='327'>
      IF ((hrold.GT.23).or.(hrold.LT.0)) THEN<a name='328'>
         PRINT*, 'GETH_IDTS:  Hour of ODATE = ', hrold<a name='329'>
         opass = .false.<a name='330'>
      END IF<a name='331'>
      <a name='332'>
      <font color=#447700>!  Check that the minute of NDATE makes sense.<a name='333'></font>
      <a name='334'>
      IF ((minew.GT.59).or.(minew.LT.0)) THEN<a name='335'>
         PRINT*, 'GETH_IDTS:  Minute of NDATE = ', minew<a name='336'>
         npass = .false.<a name='337'>
      END IF<a name='338'>
      <a name='339'>
      <font color=#447700>!  Check that the minute of ODATE makes sense.<a name='340'></font>
      <a name='341'>
      IF ((miold.GT.59).or.(miold.LT.0)) THEN<a name='342'>
         PRINT*, 'GETH_IDTS:  Minute of ODATE = ', miold<a name='343'>
         opass = .false.<a name='344'>
      END IF<a name='345'>
      <a name='346'>
      <font color=#447700>!  Check that the second of NDATE makes sense.<a name='347'></font>
      <a name='348'>
      IF ((scnew.GT.59).or.(scnew.LT.0)) THEN<a name='349'>
         PRINT*, 'GETH_IDTS:  SECOND of NDATE = ', scnew<a name='350'>
         npass = .false.<a name='351'>
      END IF<a name='352'>
      <a name='353'>
      <font color=#447700>!  Check that the second of ODATE makes sense.<a name='354'></font>
      <a name='355'>
      IF ((scold.GT.59).or.(scold.LT.0)) THEN<a name='356'>
         PRINT*, 'GETH_IDTS:  Second of ODATE = ', scold<a name='357'>
         opass = .false.<a name='358'>
      END IF<a name='359'>
      <a name='360'>
      IF (.not. npass) THEN<a name='361'>
         WRITE( wrf_err_message , * ) 'module_date_time: geth_idts: Bad NDATE: ', ndate(1:nlen)<a name='362'>
         CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/io_grib_share/io_grib_share.F.html#GETH_IDTS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1382"> ( TRIM ( wrf_err_message ) )<a name='363'>
      END IF<a name='364'>
      <a name='365'>
      IF (.not. opass) THEN<a name='366'>
         WRITE( wrf_err_message , * ) 'module_date_time: geth_idts: Bad ODATE: ', odate(1:olen)<a name='367'>
         CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/io_grib_share/io_grib_share.F.html#GETH_IDTS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1383"> ( TRIM ( wrf_err_message ) )<a name='368'>
      END IF<a name='369'>
      <a name='370'>
      <font color=#447700>!  Date Checks are completed.  Continue.<a name='371'></font>
      <a name='372'>
      <font color=#447700>!  Compute number of days from 1 January ODATE, 00:00:00 until ndate<a name='373'></font>
      <font color=#447700>!  Compute number of hours from 1 January ODATE, 00:00:00 until ndate<a name='374'></font>
      <font color=#447700>!  Compute number of minutes from 1 January ODATE, 00:00:00 until ndate<a name='375'></font>
      <a name='376'>
      newdys = 0<a name='377'>
#ifdef PLANET<a name='378'>
      DO i = yrold, yrnew - 1<a name='379'>
         newdys = newdys + PLANET_YEAR<a name='380'>
      END DO<a name='381'>
#else<a name='382'>
      DO i = yrold, yrnew - 1<a name='383'>
         newdys = newdys + (365 + (nfeb(i)-28))<a name='384'>
      END DO<a name='385'>
      <a name='386'>
      IF (monew .GT. 1) THEN<a name='387'>
         mday(2) = <A href='../../html_code/share/module_date_time.F.html#NFEB'>nfeb</A><A href='../../html_code/io_grib_share/io_grib_share.F.html#GETH_IDTS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NFEB_1">(yrnew)<a name='388'>
         DO i = 1, monew - 1<a name='389'>
            newdys = newdys + mday(i)<a name='390'>
         END DO<a name='391'>
         mday(2) = 28<a name='392'>
      END IF<a name='393'>
#endif<a name='394'>
      <a name='395'>
      newdys = newdys + dynew-1<a name='396'>
      <a name='397'>
      <font color=#447700>!  Compute number of hours from 1 January ODATE, 00:00:00 until odate<a name='398'></font>
      <font color=#447700>!  Compute number of minutes from 1 January ODATE, 00:00:00 until odate<a name='399'></font>
      <a name='400'>
      olddys = 0<a name='401'>
      <a name='402'>
#ifndef PLANET<a name='403'>
      IF (moold .GT. 1) THEN<a name='404'>
         mday(2) = <A href='../../html_code/share/module_date_time.F.html#NFEB'>nfeb</A><A href='../../html_code/io_grib_share/io_grib_share.F.html#GETH_IDTS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NFEB_2">(yrold)<a name='405'>
         DO i = 1, moold - 1<a name='406'>
            olddys = olddys + mday(i)<a name='407'>
         END DO<a name='408'>
         mday(2) = 28<a name='409'>
      END IF<a name='410'>
#endif<a name='411'>
      <a name='412'>
      olddys = olddys + dyold-1<a name='413'>
      <a name='414'>
      <font color=#447700>!  Determine the time difference in seconds<a name='415'></font>
      <a name='416'>
      idts = (newdys - olddys) * 86400<a name='417'>
      idts = idts + (hrnew - hrold) * 3600<a name='418'>
      idts = idts + (minew - miold) * 60<a name='419'>
      idts = idts + (scnew - scold)<a name='420'>
      <a name='421'>
      IF (isign .eq. -1) THEN<a name='422'>
         tdate=ndate<a name='423'>
         ndate=odate<a name='424'>
         odate=tdate<a name='425'>
         idts = idts * isign<a name='426'>
      END IF<a name='427'>
   <a name='428'>
   END SUBROUTINE geth_idts<a name='429'>
<a name='430'>
<font color=#447700>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<a name='431'></font>
<a name='432'>
<A NAME='GETH_NEWDATE'><A href='../../html_code/share/module_date_time.F.html#GETH_NEWDATE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='433'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>geth_newdate</font> (ndate, odate, idt) <A href='../../call_to/GETH_NEWDATE.html' TARGET='index'>18</A>,<A href='../../call_from/GETH_NEWDATE.html' TARGET='index'>5</A><a name='434'>
   <a name='435'>
      IMPLICIT NONE<a name='436'>
      <a name='437'>
      <font color=#447700>!  From old date ('YYYY-MM-DD HH:MM:SS.ffff') and <a name='438'></font>
      <font color=#447700>!            [or ('YYYY-DDDDD HH:MM:SS.ffff')]<a name='439'></font>
      <font color=#447700>!  delta-time, compute the new date.<a name='440'></font>
   <a name='441'>
      <font color=#447700>!  on entry     -  odate  -  the old hdate.<a name='442'></font>
      <font color=#447700>!                  idt    -  the change in time<a name='443'></font>
   <a name='444'>
      <font color=#447700>!  on exit      -  ndate  -  the new hdate.<a name='445'></font>
      <a name='446'>
      INTEGER , INTENT(IN)           :: idt<a name='447'>
      CHARACTER (LEN=*) , INTENT(OUT) :: ndate<a name='448'>
      CHARACTER (LEN=*) , INTENT(IN)  :: odate<a name='449'>
      <a name='450'>
       <a name='451'>
      <font color=#447700>!  Local Variables<a name='452'></font>
       <a name='453'>
      <font color=#447700>!  yrold    -  indicates the year associated with "odate"<a name='454'></font>
      <font color=#447700>!  moold    -  indicates the month associated with "odate"<a name='455'></font>
      <font color=#447700>!  dyold    -  indicates the day associated with "odate"<a name='456'></font>
      <font color=#447700>!  hrold    -  indicates the hour associated with "odate"<a name='457'></font>
      <font color=#447700>!  miold    -  indicates the minute associated with "odate"<a name='458'></font>
      <font color=#447700>!  scold    -  indicates the second associated with "odate"<a name='459'></font>
       <a name='460'>
      <font color=#447700>!  yrnew    -  indicates the year associated with "ndate"<a name='461'></font>
      <font color=#447700>!  monew    -  indicates the month associated with "ndate"<a name='462'></font>
      <font color=#447700>!  dynew    -  indicates the day associated with "ndate"<a name='463'></font>
      <font color=#447700>!  hrnew    -  indicates the hour associated with "ndate"<a name='464'></font>
      <font color=#447700>!  minew    -  indicates the minute associated with "ndate"<a name='465'></font>
      <font color=#447700>!  scnew    -  indicates the second associated with "ndate"<a name='466'></font>
       <a name='467'>
      <font color=#447700>!  mday     -  a list assigning the number of days in each month<a name='468'></font>
      <a name='469'>
      <font color=#447700>!  i        -  loop counter<a name='470'></font>
      <font color=#447700>!  nday     -  the integer number of days represented by "idt"<a name='471'></font>
      <font color=#447700>!  nhour    -  the integer number of hours in "idt" after taking out<a name='472'></font>
      <font color=#447700>!              all the whole days<a name='473'></font>
      <font color=#447700>!  nmin     -  the integer number of minutes in "idt" after taking out<a name='474'></font>
      <font color=#447700>!              all the whole days and whole hours.<a name='475'></font>
      <font color=#447700>!  nsec     -  the integer number of minutes in "idt" after taking out<a name='476'></font>
      <font color=#447700>!              all the whole days, whole hours, and whole minutes.<a name='477'></font>
       <a name='478'>
      INTEGER :: nlen, olen<a name='479'>
      INTEGER :: yrnew, monew, dynew, hrnew, minew, scnew, frnew<a name='480'>
      INTEGER :: yrold, moold, dyold, hrold, miold, scold, frold<a name='481'>
      INTEGER :: mday(12), nday, nhour, nmin, nsec, nfrac, i, ifrc<a name='482'>
      LOGICAL :: opass<a name='483'>
      CHARACTER (LEN=10) :: hfrc<a name='484'>
      CHARACTER (LEN=1) :: sp<a name='485'>
      <font color=#447700>! INTEGER, EXTERNAL :: nfeb  ! in the same module now<a name='486'></font>
      <a name='487'>
      <font color=#447700>!  Assign the number of days in a months<a name='488'></font>
      <a name='489'>
      mday( 1) = 31<a name='490'>
      mday( 2) = 28<a name='491'>
      mday( 3) = 31<a name='492'>
      mday( 4) = 30<a name='493'>
      mday( 5) = 31<a name='494'>
      mday( 6) = 30<a name='495'>
      mday( 7) = 31<a name='496'>
      mday( 8) = 31<a name='497'>
      mday( 9) = 30<a name='498'>
      mday(10) = 31<a name='499'>
      mday(11) = 30<a name='500'>
      mday(12) = 31<a name='501'>
      <a name='502'>
      <font color=#447700>!  Break down old hdate into parts<a name='503'></font>
      <a name='504'>
      hrold = 0<a name='505'>
      miold = 0<a name='506'>
      scold = 0<a name='507'>
      frold = 0<a name='508'>
      olen = LEN(odate)<a name='509'>
      IF (olen.GE.11) THEN<a name='510'>
         sp = odate(11:11)<a name='511'>
      else<a name='512'>
         sp = ' '<a name='513'>
      END IF<a name='514'>
      <a name='515'>
      <font color=#447700>!  Use internal READ statements to convert the CHARACTER string<a name='516'></font>
      <font color=#447700>!  date into INTEGER components.<a name='517'></font>
   <a name='518'>
      READ(odate(1:4),  '(I4.4)') yrold<a name='519'>
#ifdef PLANET<a name='520'>
      READ(odate(6:10), '(I5)') dyold<a name='521'>
      moold=0.<a name='522'>
#else<a name='523'>
      READ(odate(6:7),  '(I2)') moold<a name='524'>
      READ(odate(9:10), '(I2)') dyold<a name='525'>
#endif<a name='526'>
      IF (olen.GE.13) THEN<a name='527'>
         READ(odate(12:13),'(I2)') hrold<a name='528'>
         IF (olen.GE.16) THEN<a name='529'>
            READ(odate(15:16),'(I2)') miold<a name='530'>
            IF (olen.GE.19) THEN<a name='531'>
               READ(odate(18:19),'(I2)') scold<a name='532'>
               IF (olen.GT.20) THEN<a name='533'>
                  READ(odate(21:olen),'(I2)') frold<a name='534'>
               END IF<a name='535'>
            END IF<a name='536'>
         END IF<a name='537'>
      END IF<a name='538'>
      <a name='539'>
      <font color=#447700>!  Set the number of days in February for that year.<a name='540'></font>
      <a name='541'>
      mday(2) = <A href='../../html_code/share/module_date_time.F.html#NFEB'>nfeb</A><A href='../../html_code/share/module_date_time.F.html#GETH_NEWDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NFEB_3">(yrold)<a name='542'>
      <a name='543'>
      <font color=#447700>!  Check that ODATE makes sense.<a name='544'></font>
      <a name='545'>
      opass = .TRUE.<a name='546'>
      <a name='547'>
#ifdef PLANET<a name='548'>
      <font color=#447700>!  Check that the day of ODATE makes sense.<a name='549'></font>
      IF ((dyold.GT.PLANET_YEAR).or.(dyold.LT.1)) THEN<a name='550'>
         WRITE(*,*) 'GETH_NEWDATE:  Day of ODATE = ', dyold<a name='551'>
         opass = .FALSE.<a name='552'>
      END IF<a name='553'>
#else<a name='554'>
      <font color=#447700>!  Check that the month of ODATE makes sense.<a name='555'></font>
      <a name='556'>
      IF ((moold.GT.12).or.(moold.LT.1)) THEN<a name='557'>
         WRITE(*,*) 'GETH_NEWDATE:  Month of ODATE = ', moold<a name='558'>
         opass = .FALSE.<a name='559'>
      END IF<a name='560'>
      <a name='561'>
      <font color=#447700>!  Check that the day of ODATE makes sense.<a name='562'></font>
      <a name='563'>
      IF ((dyold.GT.mday(moold)).or.(dyold.LT.1)) THEN<a name='564'>
         WRITE(*,*) 'GETH_NEWDATE:  Day of ODATE = ', dyold<a name='565'>
         opass = .FALSE.<a name='566'>
      END IF<a name='567'>
#endif<a name='568'>
      <font color=#447700>!  Check that the hour of ODATE makes sense.<a name='569'></font>
      <a name='570'>
      IF ((hrold.GT.23).or.(hrold.LT.0)) THEN<a name='571'>
         WRITE(*,*) 'GETH_NEWDATE:  Hour of ODATE = ', hrold<a name='572'>
         opass = .FALSE.<a name='573'>
      END IF<a name='574'>
      <a name='575'>
      <font color=#447700>!  Check that the minute of ODATE makes sense.<a name='576'></font>
      <a name='577'>
      IF ((miold.GT.59).or.(miold.LT.0)) THEN<a name='578'>
         WRITE(*,*) 'GETH_NEWDATE:  Minute of ODATE = ', miold<a name='579'>
         opass = .FALSE.<a name='580'>
      END IF<a name='581'>
      <a name='582'>
      <font color=#447700>!  Check that the second of ODATE makes sense.<a name='583'></font>
      <a name='584'>
      IF ((scold.GT.59).or.(scold.LT.0)) THEN<a name='585'>
         WRITE(*,*) 'GETH_NEWDATE:  Second of ODATE = ', scold<a name='586'>
         opass = .FALSE.<a name='587'>
      END IF<a name='588'>
      <a name='589'>
      <font color=#447700>!  Check that the fractional part  of ODATE makes sense.<a name='590'></font>
      <a name='591'>
      <a name='592'>
      IF (.not.opass) THEN<a name='593'>
         WRITE( wrf_err_message , * ) 'module_date_time: GETH_NEWDATE: Bad ODATE: ', odate(1:olen), olen<a name='594'>
         CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/share/module_date_time.F.html#GETH_NEWDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1384"> ( TRIM ( wrf_err_message ) )<a name='595'>
      END IF<a name='596'>
      <a name='597'>
      <font color=#447700>!  Date Checks are completed.  Continue.<a name='598'></font>
      <a name='599'>
      <a name='600'>
      <font color=#447700>!  Compute the number of days, hours, minutes, and seconds in idt<a name='601'></font>
      <a name='602'>
      IF (olen.GT.20) THEN <font color=#447700>!idt should be in fractions of seconds<a name='603'></font>
         ifrc = olen-20<a name='604'>
         ifrc = 10**ifrc<a name='605'>
         nday   = ABS(idt)/(86400*ifrc)<a name='606'>
         nhour  = MOD(ABS(idt),86400*ifrc)/(3600*ifrc)<a name='607'>
         nmin   = MOD(ABS(idt),3600*ifrc)/(60*ifrc)<a name='608'>
         nsec   = MOD(ABS(idt),60*ifrc)/(ifrc)<a name='609'>
         nfrac = MOD(ABS(idt), ifrc)<a name='610'>
      ELSE IF (olen.eq.19) THEN  <font color=#447700>!idt should be in seconds<a name='611'></font>
         ifrc = 1<a name='612'>
         nday   = ABS(idt)/86400 <font color=#447700>! Integer number of days in delta-time<a name='613'></font>
         nhour  = MOD(ABS(idt),86400)/3600<a name='614'>
         nmin   = MOD(ABS(idt),3600)/60<a name='615'>
         nsec   = MOD(ABS(idt),60)<a name='616'>
         nfrac  = 0<a name='617'>
      ELSE IF (olen.eq.16) THEN <font color=#447700>!idt should be in minutes<a name='618'></font>
         ifrc = 1<a name='619'>
         nday   = ABS(idt)/1440 <font color=#447700>! Integer number of days in delta-time<a name='620'></font>
         nhour  = MOD(ABS(idt),1440)/60<a name='621'>
         nmin   = MOD(ABS(idt),60)<a name='622'>
         nsec   = 0<a name='623'>
         nfrac  = 0<a name='624'>
      ELSE IF (olen.eq.13) THEN <font color=#447700>!idt should be in hours<a name='625'></font>
         ifrc = 1<a name='626'>
         nday   = ABS(idt)/24 <font color=#447700>! Integer number of days in delta-time<a name='627'></font>
         nhour  = MOD(ABS(idt),24)<a name='628'>
         nmin   = 0<a name='629'>
         nsec   = 0<a name='630'>
         nfrac  = 0<a name='631'>
      ELSE IF (olen.eq.10) THEN <font color=#447700>!idt should be in days<a name='632'></font>
         ifrc = 1<a name='633'>
         nday   = ABS(idt)/24 <font color=#447700>! Integer number of days in delta-time<a name='634'></font>
         nhour  = 0<a name='635'>
         nmin   = 0<a name='636'>
         nsec   = 0<a name='637'>
         nfrac  = 0<a name='638'>
      ELSE<a name='639'>
         WRITE( wrf_err_message , * ) 'module_date_time: GETH_NEWDATE: Strange length for ODATE: ',olen<a name='640'>
         CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/share/module_date_time.F.html#GETH_NEWDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1385"> ( TRIM ( wrf_err_message ) )<a name='641'>
      END IF<a name='642'>
      <a name='643'>
      IF (idt.GE.0) THEN<a name='644'>
      <a name='645'>
         frnew = frold + nfrac<a name='646'>
         IF (frnew.GE.ifrc) THEN<a name='647'>
            frnew = frnew - ifrc<a name='648'>
            nsec = nsec + 1<a name='649'>
         END IF<a name='650'>
      <a name='651'>
         scnew = scold + nsec<a name='652'>
         IF (scnew .GE. 60) THEN<a name='653'>
            scnew = scnew - 60<a name='654'>
            nmin  = nmin + 1<a name='655'>
         END IF<a name='656'>
      <a name='657'>
         minew = miold + nmin<a name='658'>
         IF (minew .GE. 60) THEN<a name='659'>
            minew = minew - 60<a name='660'>
            nhour  = nhour + 1<a name='661'>
         END IF<a name='662'>
      <a name='663'>
         hrnew = hrold + nhour<a name='664'>
         IF (hrnew .GE. 24) THEN<a name='665'>
            hrnew = hrnew - 24<a name='666'>
            nday  = nday + 1<a name='667'>
         END IF<a name='668'>
      <a name='669'>
         dynew = dyold<a name='670'>
         monew = moold<a name='671'>
         yrnew = yrold<a name='672'>
         DO i = 1, nday<a name='673'>
            dynew = dynew + 1<a name='674'>
#ifdef PLANET<a name='675'>
            IF (dynew .GT. PLANET_YEAR) THEN<a name='676'>
               dynew = dynew - PLANET_YEAR<a name='677'>
               yrnew = yrnew + 1<a name='678'>
            END IF<a name='679'>
#else<a name='680'>
            IF (dynew.GT.mday(monew)) THEN<a name='681'>
               dynew = dynew - mday(monew)<a name='682'>
               monew = monew + 1<a name='683'>
               IF (monew .GT. 12) THEN<a name='684'>
                  monew = 1<a name='685'>
                  yrnew = yrnew + 1<a name='686'>
                  <font color=#447700>! If the year changes, recompute the number of days in February<a name='687'></font>
                  mday(2) = <A href='../../html_code/share/module_date_time.F.html#NFEB'>nfeb</A><A href='../../html_code/share/module_date_time.F.html#GETH_NEWDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NFEB_4">(yrnew)<a name='688'>
               END IF<a name='689'>
            END IF<a name='690'>
#endif<a name='691'>
         END DO<a name='692'>
      <a name='693'>
      ELSE IF (idt.LT.0) THEN<a name='694'>
      <a name='695'>
         frnew = frold - nfrac<a name='696'>
         IF (frnew .LT. 0) THEN<a name='697'>
            frnew = frnew + ifrc<a name='698'>
            nsec = nsec - 1<a name='699'>
         END IF<a name='700'>
      <a name='701'>
         scnew = scold - nsec<a name='702'>
         IF (scnew .LT. 00) THEN<a name='703'>
            scnew = scnew + 60<a name='704'>
            nmin  = nmin + 1<a name='705'>
         END IF<a name='706'>
      <a name='707'>
         minew = miold - nmin<a name='708'>
         IF (minew .LT. 00) THEN<a name='709'>
            minew = minew + 60<a name='710'>
            nhour  = nhour + 1<a name='711'>
         END IF<a name='712'>
      <a name='713'>
         hrnew = hrold - nhour<a name='714'>
         IF (hrnew .LT. 00) THEN<a name='715'>
            hrnew = hrnew + 24<a name='716'>
            nday  = nday + 1<a name='717'>
         END IF<a name='718'>
      <a name='719'>
         dynew = dyold<a name='720'>
         monew = moold<a name='721'>
         yrnew = yrold<a name='722'>
         DO i = 1, nday<a name='723'>
            dynew = dynew - 1<a name='724'>
#ifdef PLANET<a name='725'>
            IF (dynew.eq.0) THEN<a name='726'>
               dynew = PLANET_YEAR<a name='727'>
               yrnew = yrnew - 1<a name='728'>
            END IF<a name='729'>
#else<a name='730'>
            IF (dynew.eq.0) THEN<a name='731'>
               monew = monew - 1<a name='732'>
               IF (monew.eq.0) THEN<a name='733'>
                  monew = 12<a name='734'>
                  yrnew = yrnew - 1<a name='735'>
                  <font color=#447700>! If the year changes, recompute the number of days in February<a name='736'></font>
                  mday(2) = <A href='../../html_code/share/module_date_time.F.html#NFEB'>nfeb</A><A href='../../html_code/share/module_date_time.F.html#GETH_NEWDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NFEB_5">(yrnew)<a name='737'>
               END IF<a name='738'>
               dynew = mday(monew)<a name='739'>
            END IF<a name='740'>
#endif<a name='741'>
         END DO<a name='742'>
      END IF<a name='743'>
      <a name='744'>
      <font color=#447700>!  Now construct the new mdate<a name='745'></font>
      <a name='746'>
      nlen = LEN(ndate)<a name='747'>
      <a name='748'>
#ifdef PLANET<a name='749'>
      IF (nlen.GT.20) THEN<a name='750'>
         WRITE(ndate(1:19),19) yrnew, dynew, hrnew, minew, scnew<a name='751'>
         WRITE(hfrc,'(I10)') frnew+1000000000<a name='752'>
         ndate = ndate(1:19)//'.'//hfrc(31-nlen:10)<a name='753'>
      <a name='754'>
      ELSE IF (nlen.eq.19.or.nlen.eq.20) THEN<a name='755'>
         WRITE(ndate(1:19),19) yrnew, dynew, hrnew, minew, scnew<a name='756'>
      19   format(I4.4,'-',I5.5,'_',I2.2,':',I2.2,':',I2.2)<a name='757'>
         IF (nlen.eq.20) ndate = ndate(1:19)//'.'<a name='758'>
      <a name='759'>
      ELSE IF (nlen.eq.16) THEN<a name='760'>
         WRITE(ndate,16) yrnew, dynew, hrnew, minew<a name='761'>
      16   format(I4.4,'-',I5.5,'_',I2.2,':',I2.2)<a name='762'>
      <a name='763'>
      ELSE IF (nlen.eq.13) THEN<a name='764'>
         WRITE(ndate,13) yrnew, dynew, hrnew<a name='765'>
      13   format(I4.4,'-',I5.5,'_',I2.2)<a name='766'>
      <a name='767'>
      ELSE IF (nlen.eq.10) THEN<a name='768'>
         WRITE(ndate,10) yrnew, dynew<a name='769'>
      10   format(I4.4,'-',I5.5)<a name='770'>
      <a name='771'>
      END IF<a name='772'>
      <a name='773'>
      IF (olen.GE.11) ndate(11:11) = sp<a name='774'>
#else<a name='775'>
      IF (nlen.GT.20) THEN<a name='776'>
         WRITE(ndate(1:19),19) yrnew, monew, dynew, hrnew, minew, scnew<a name='777'>
         WRITE(hfrc,'(I10)') frnew+1000000000<a name='778'>
         ndate = ndate(1:19)//'.'//hfrc(31-nlen:10)<a name='779'>
      <a name='780'>
      ELSE IF (nlen.eq.19.or.nlen.eq.20) THEN<a name='781'>
         WRITE(ndate(1:19),19) yrnew, monew, dynew, hrnew, minew, scnew<a name='782'>
      19   format(I4.4,'-',I2.2,'-',I2.2,'_',I2.2,':',I2.2,':',I2.2)<a name='783'>
         IF (nlen.eq.20) ndate = ndate(1:19)//'.'<a name='784'>
      <a name='785'>
      ELSE IF (nlen.eq.16) THEN<a name='786'>
         WRITE(ndate,16) yrnew, monew, dynew, hrnew, minew<a name='787'>
      16   format(I4.4,'-',I2.2,'-',I2.2,'_',I2.2,':',I2.2)<a name='788'>
      <a name='789'>
      ELSE IF (nlen.eq.13) THEN<a name='790'>
         WRITE(ndate,13) yrnew, monew, dynew, hrnew<a name='791'>
      13   format(I4.4,'-',I2.2,'-',I2.2,'_',I2.2)<a name='792'>
      <a name='793'>
      ELSE IF (nlen.eq.10) THEN<a name='794'>
         WRITE(ndate,10) yrnew, monew, dynew<a name='795'>
      10   format(I4.4,'-',I2.2,'-',I2.2)<a name='796'>
      <a name='797'>
      END IF<a name='798'>
      <a name='799'>
      IF (olen.GE.11) ndate(11:11) = sp<a name='800'>
#endif<a name='801'>
   END SUBROUTINE geth_newdate<a name='802'>
<a name='803'>
<font color=#447700>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<a name='804'></font>
<a name='805'>
<A NAME='NFEB'><A href='../../html_code/share/module_date_time.F.html#NFEB' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='806'>
   <font color=#993300>FUNCTION </font><font color=#cc0000>nfeb</font> ( year ) RESULT (num_days) <A href='../../call_to/NFEB.html' TARGET='index'>5</A><a name='807'>
   <a name='808'>
      <font color=#447700>! Compute the number of days in February for the given year<a name='809'></font>
   <a name='810'>
      IMPLICIT NONE<a name='811'>
   <a name='812'>
      INTEGER :: year<a name='813'>
      INTEGER :: num_days<a name='814'>
   <a name='815'>
#ifdef NO_LEAP_CALENDAR<a name='816'>
      num_days = 28 <font color=#447700>! By default, February has 28 days ...<a name='817'></font>
#else<a name='818'>
      num_days = 28 <font color=#447700>! By default, February has 28 days ...<a name='819'></font>
      IF (MOD(year,4).eq.0) THEN  <a name='820'>
         num_days = 29  <font color=#447700>! But every four years, it has 29 days ...<a name='821'></font>
         IF (MOD(year,100).eq.0) THEN<a name='822'>
            num_days = 28  <font color=#447700>! Except every 100 years, when it has 28 days ...<a name='823'></font>
            IF (MOD(year,400).eq.0) THEN<a name='824'>
               num_days = 29  <font color=#447700>! Except every 400 years, when it has 29 days.<a name='825'></font>
            END IF<a name='826'>
         END IF<a name='827'>
      END IF<a name='828'>
#endif<a name='829'>
   <a name='830'>
   END FUNCTION nfeb<a name='831'>
<a name='832'>
<font color=#447700>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<a name='833'></font>
<A NAME='SPLIT_DATE_CHAR'><A href='../../html_code/share/module_date_time.F.html#SPLIT_DATE_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='834'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>split_date_char</font> ( date , century_year , month , day , hour , minute , second , ten_thousandth) <A href='../../call_to/SPLIT_DATE_CHAR.html' TARGET='index'>5</A><a name='835'>
     <a name='836'>
      IMPLICIT NONE<a name='837'>
   <a name='838'>
      <font color=#447700>!  Input data.<a name='839'></font>
   <a name='840'>
      CHARACTER(LEN=24) , INTENT(IN) :: date <a name='841'>
   <a name='842'>
      <font color=#447700>!  Output data.<a name='843'></font>
   <a name='844'>
      INTEGER , INTENT(OUT) :: century_year , month , day , hour , minute , second , ten_thousandth<a name='845'>
      <a name='846'>
      READ(date,FMT='(    I4.4)') century_year<a name='847'>
#ifdef PLANET<a name='848'>
      month = 0<a name='849'>
      READ(date,FMT='( 5X,I5.5)') day<a name='850'>
#else<a name='851'>
      READ(date,FMT='( 5X,I2.2)') month<a name='852'>
      READ(date,FMT='( 8X,I2.2)') day<a name='853'>
#endif<a name='854'>
      READ(date,FMT='(11X,I2.2)') hour<a name='855'>
      READ(date,FMT='(14X,I2.2)') minute<a name='856'>
      READ(date,FMT='(17X,I2.2)') second<a name='857'>
      READ(date,FMT='(20X,I4.4)') ten_thousandth<a name='858'>
   <a name='859'>
   END SUBROUTINE split_date_char<a name='860'>
<a name='861'>
<A NAME='INIT_MODULE_DATE_TIME'><A href='../../html_code/share/module_date_time.F.html#INIT_MODULE_DATE_TIME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='862'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>init_module_date_time</font><a name='863'>
   END SUBROUTINE init_module_date_time<a name='864'>
<a name='865'>
END MODULE module_date_time<a name='866'>
<a name='867'>
<a name='868'>
   <font color=#447700>! TBH:  NOTE:  <a name='869'></font>
   <font color=#447700>! TBH:  Linkers whine if these routines are placed inside the module.  Not <a name='870'></font>
   <font color=#447700>! TBH:  sure if these should live here or inside an external package.  They <a name='871'></font>
   <font color=#447700>! TBH:  have dependencies both on WRF (for the format of the WRF date-time <a name='872'></font>
   <font color=#447700>! TBH:  strings) and on the time manager.  Currently, the format of the WRF <a name='873'></font>
   <font color=#447700>! TBH:  date-time strings is a slight variant on ISO 8601 (ISO is <a name='874'></font>
   <font color=#447700>! TBH:  "YYYY-MM-DDThh:mm:ss" while WRF is "YYYY-MM-DD_hh:mm:ss").  If we <a name='875'></font>
   <font color=#447700>! TBH:  change the WRF format to match the standard, then we remove the <a name='876'></font>
   <font color=#447700>! TBH:  WRF dependence...  <a name='877'></font>
<a name='878'>
   <font color=#447700>! Converts WRF date-time string into an WRFU_Time object.  <a name='879'></font>
   <font color=#447700>! The format of the WRF date-time strings is a slight variant on ISO 8601: <a name='880'></font>
   <font color=#447700>! ISO is "YYYY-MM-DDThh:mm:ss" while WRF is "YYYY-MM-DD_hh:mm:ss".  <a name='881'></font>
<A NAME='WRF_ATOTIME'><A href='../../html_code/share/module_date_time.F.html#WRF_ATOTIME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='882'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>wrf_atotime</font> ( str, time ) <A href='../../call_to/WRF_ATOTIME.html' TARGET='index'>23</A>,<A href='../../call_from/WRF_ATOTIME.html' TARGET='index'>1</A><a name='883'>
      USE module_utility<a name='884'>
      CHARACTER (LEN=*), INTENT(INOUT) :: str<a name='885'>
      TYPE(WRFU_Time),   INTENT(OUT) :: time<a name='886'>
      INTEGER yr, mm, dd, h, m, s, ms<a name='887'>
      INTEGER rc<a name='888'>
      IF ( LEN( str ) .GE. 20 ) THEN<a name='889'>
        IF ( str(20:20) .EQ. '.' ) THEN<a name='890'>
#ifdef PLANET<a name='891'>
          READ(str,'(I4.4,1x,I5.5,1x,I2.2,1x,I2.2,1x,I2.2,1x,I4.4)') yr,dd,h,m,s,ms<a name='892'>
          mm = 1<a name='893'>
#else<a name='894'>
          READ(str,34) yr,mm,dd,h,m,s,ms<a name='895'>
#endif<a name='896'>
          <font color=#447700>!  last four digits are ten-thousandths of a sec, convert to ms<a name='897'></font>
          ms=nint(real(ms)/10)<a name='898'>
        ELSE<a name='899'>
#ifdef PLANET<a name='900'>
          READ(str,'(I4.4,1x,I5.5,1x,I2.2,1x,I2.2,1x,I2.2)') yr,dd,h,m,s<a name='901'>
          mm = 1<a name='902'>
#else<a name='903'>
          READ(str,33) yr,mm,dd,h,m,s<a name='904'>
#endif<a name='905'>
          ms = 0<a name='906'>
        ENDIF<a name='907'>
      ELSE<a name='908'>
#ifdef PLANET<a name='909'>
        READ(str,'(I4.4,1x,I5.5,1x,I2.2,1x,I2.2,1x,I2.2)') yr,dd,h,m,s<a name='910'>
        mm = 1<a name='911'>
#else<a name='912'>
        READ(str,33) yr,mm,dd,h,m,s<a name='913'>
#endif<a name='914'>
        ms = 0<a name='915'>
      ENDIF<a name='916'>
      CALL WRFU_TimeSet( time, YY=yr, MM=mm, DD=dd, H=h, M=m, S=s, MS=ms, rc=rc )<a name='917'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_CHECK_ERROR'>wrf_check_error</A><A href='../../html_code/share/module_date_time.F.html#WRF_ATOTIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_CHECK_ERROR_10">( WRFU_SUCCESS, rc, &amp;<a name='918'>
                            'WRFU_TimeSet() in wrf_atotime() FAILED', &amp;<a name='919'>
                            __FILE__ , &amp;<a name='920'>
                            __LINE__  )<a name='921'>
33 FORMAT (I4.4,1x,I2.2,1x,I2.2,1x,I2.2,1x,I2.2,1x,I2.2)<a name='922'>
34 FORMAT (I4.4,1x,I2.2,1x,I2.2,1x,I2.2,1x,I2.2,1x,I2.2,1x,I4.4)<a name='923'>
      RETURN<a name='924'>
   END SUBROUTINE wrf_atotime<a name='925'>
<a name='926'>
   <font color=#447700>! Converts an WRFU_Time object into a WRF date-time string.  <a name='927'></font>
   <font color=#447700>! The format of the WRF date-time strings is a slight variant on ISO 8601: <a name='928'></font>
   <font color=#447700>! ISO is "YYYY-MM-DDThh:mm:ss" while WRF is "YYYY-MM-DD_hh:mm:ss".  <a name='929'></font>
<A NAME='WRF_TIMETOA'><A href='../../html_code/share/module_date_time.F.html#WRF_TIMETOA' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='930'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>wrf_timetoa</font> ( time, str ) <A href='../../call_to/WRF_TIMETOA.html' TARGET='index'>16</A>,<A href='../../call_from/WRF_TIMETOA.html' TARGET='index'>3</A><a name='931'>
      USE module_utility, ONLY : WRFU_Time, WRFU_TimeGet, WRFU_SUCCESS<a name='932'>
      IMPLICIT NONE<a name='933'>
      TYPE(WRFU_Time),   INTENT(INOUT) :: time<a name='934'>
      CHARACTER (LEN=*), INTENT(OUT) :: str<a name='935'>
      INTEGER strlen, rc<a name='936'>
      CHARACTER (LEN=256) :: mess, tmpstr<a name='937'>
      <font color=#447700>! Assertion<a name='938'></font>
      IF ( LEN(str) &lt; 19 ) THEN<a name='939'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/share/module_date_time.F.html#WRF_TIMETOA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_1386">( 'wrf_timetoa:  str is too short' )<a name='940'>
      ENDIF<a name='941'>
      tmpstr = ''<a name='942'>
      CALL WRFU_TimeGet( time, timeString=tmpstr, rc=rc )<a name='943'>
      WRITE(mess,*)'WRFU_TimeGet() returns ',rc,' in wrf_timetoa() FAILED: timeString &gt;',TRIM(tmpstr),'&lt;'<a name='944'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_CHECK_ERROR'>wrf_check_error</A><A href='../../html_code/share/module_date_time.F.html#WRF_TIMETOA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_CHECK_ERROR_11">( WRFU_SUCCESS, rc, &amp;<a name='945'>
                            mess, &amp;<a name='946'>
                            __FILE__ , &amp;<a name='947'>
                            __LINE__  )<a name='948'>
      <font color=#447700>! change ISO 8601 'T' to WRF '_' and hack off fraction if str is not <a name='949'></font>
      <font color=#447700>! big enough to hold it<a name='950'></font>
      strlen = MIN( LEN(str), LEN_TRIM(tmpstr) )<a name='951'>
      str = ''<a name='952'>
      str(1:strlen) = tmpstr(1:strlen)<a name='953'>
      str(11:11) = '_'<a name='954'>
      WRITE (mess,*) 'DEBUG wrf_timetoa():  returning with str = [',TRIM(str),']'<a name='955'>
      CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/share/module_date_time.F.html#WRF_TIMETOA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1063"> ( 150 , TRIM(mess) )<a name='956'>
      RETURN<a name='957'>
   END SUBROUTINE wrf_timetoa<a name='958'>
<a name='959'>
   <font color=#447700>! Converts an WRFU_TimeInterval object into a time-interval string.  <a name='960'></font>
<A NAME='WRF_TIMEINTTOA'><A href='../../html_code/share/module_date_time.F.html#WRF_TIMEINTTOA' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='961'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>wrf_timeinttoa</font> ( timeinterval, str ) <A href='../../call_to/WRF_TIMEINTTOA.html' TARGET='index'>1</A>,<A href='../../call_from/WRF_TIMEINTTOA.html' TARGET='index'>2</A><a name='962'>
      USE module_utility<a name='963'>
      IMPLICIT NONE<a name='964'>
      TYPE(WRFU_TimeInterval),   INTENT(INOUT) :: timeinterval<a name='965'>
      CHARACTER (LEN=*), INTENT(OUT) :: str<a name='966'>
      INTEGER rc<a name='967'>
      CHARACTER (LEN=256) :: mess<a name='968'>
      CALL WRFU_TimeIntervalGet( timeinterval, timeString=str, rc=rc )<a name='969'>
      CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_CHECK_ERROR'>wrf_check_error</A><A href='../../html_code/share/module_date_time.F.html#WRF_TIMEINTTOA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_CHECK_ERROR_12">( WRFU_SUCCESS, rc, &amp;<a name='970'>
                            'WRFU_TimeIntervalGet() in wrf_timeinttoa() FAILED', &amp;<a name='971'>
                            __FILE__ , &amp;<a name='972'>
                            __LINE__  )<a name='973'>
      WRITE (mess,*) 'DEBUG wrf_timeinttoa():  returning with str = [',TRIM(str),']'<a name='974'>
      CALL <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/share/module_date_time.F.html#WRF_TIMEINTTOA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1064"> ( 150 , TRIM(mess) )<a name='975'>
      RETURN<a name='976'>
   END SUBROUTINE wrf_timeinttoa<a name='977'>
<a name='978'>
<a name='979'>
<a name='980'>
   <font color=#447700>! Debug routine to print key clock information.  <a name='981'></font>
   <font color=#447700>! Every printed line begins with pre_str.  <a name='982'></font>
<A NAME='WRF_CLOCKPRINT'><A href='../../html_code/share/module_date_time.F.html#WRF_CLOCKPRINT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='983'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>wrf_clockprint</font> ( level, clock, pre_str ) <A href='../../call_to/WRF_CLOCKPRINT.html' TARGET='index'>8</A>,<A href='../../call_from/WRF_CLOCKPRINT.html' TARGET='index'>10</A><a name='984'>
      USE module_utility<a name='985'>
      INTEGER,           INTENT( IN) :: level<a name='986'>
      TYPE(WRFU_Clock),  INTENT( IN) :: clock<a name='987'>
      CHARACTER (LEN=*), INTENT( IN) :: pre_str<a name='988'>
      INTEGER rc<a name='989'>
      INTEGER :: debug_level<a name='990'>
      TYPE(WRFU_Time) :: currTime, startTime, stopTime<a name='991'>
      TYPE(WRFU_TimeInterval) :: timeStep<a name='992'>
      CHARACTER (LEN=64) :: currTime_str, startTime_str, stopTime_str<a name='993'>
      CHARACTER (LEN=64) :: timeStep_str<a name='994'>
      CHARACTER (LEN=256) :: mess<a name='995'>
      CALL <A href='../../html_code/frame/wrf_debug.F.html#GET_WRF_DEBUG_LEVEL'>get_wrf_debug_level</A><A href='../../html_code/share/module_date_time.F.html#WRF_CLOCKPRINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_WRF_DEBUG_LEVEL_9">( debug_level )<a name='996'>
      IF ( level .LE. debug_level ) THEN<a name='997'>
        CALL WRFU_ClockGet( clock, CurrTime=currTime, StartTime=startTime, &amp;<a name='998'>
                                   StopTime=stopTime, TimeStep=timeStep, rc=rc )<a name='999'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_CHECK_ERROR'>wrf_check_error</A><A href='../../html_code/share/module_date_time.F.html#WRF_CLOCKPRINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_CHECK_ERROR_13">( WRFU_SUCCESS, rc, &amp;<a name='1000'>
                              'wrf_clockprint:  WRFU_ClockGet() FAILED', &amp;<a name='1001'>
                              __FILE__ , &amp;<a name='1002'>
                              __LINE__  )<a name='1003'>
        CALL <A href='../../html_code/share/module_date_time.F.html#WRF_TIMETOA'>wrf_timetoa</A><A href='../../html_code/share/module_date_time.F.html#WRF_CLOCKPRINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_TIMETOA_12">( currTime, currTime_str )<a name='1004'>
        CALL <A href='../../html_code/share/module_date_time.F.html#WRF_TIMETOA'>wrf_timetoa</A><A href='../../html_code/share/module_date_time.F.html#WRF_CLOCKPRINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_TIMETOA_13">( startTime, startTime_str )<a name='1005'>
        CALL <A href='../../html_code/share/module_date_time.F.html#WRF_TIMETOA'>wrf_timetoa</A><A href='../../html_code/share/module_date_time.F.html#WRF_CLOCKPRINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_TIMETOA_14">( stopTime, stopTime_str )<a name='1006'>
        CALL <A href='../../html_code/share/module_date_time.F.html#WRF_TIMEINTTOA'>wrf_timeinttoa</A><A href='../../html_code/share/module_date_time.F.html#WRF_CLOCKPRINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_TIMEINTTOA_1">( timeStep, timeStep_str )<a name='1007'>
        WRITE (mess,*) TRIM(pre_str),'  clock start time = ',TRIM(startTime_str)<a name='1008'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/share/module_date_time.F.html#WRF_CLOCKPRINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1355">(TRIM(mess))<a name='1009'>
        WRITE (mess,*) TRIM(pre_str),'  clock current time = ',TRIM(currTime_str)<a name='1010'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/share/module_date_time.F.html#WRF_CLOCKPRINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1356">(TRIM(mess))<a name='1011'>
        WRITE (mess,*) TRIM(pre_str),'  clock stop time = ',TRIM(stopTime_str)<a name='1012'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/share/module_date_time.F.html#WRF_CLOCKPRINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1357">(TRIM(mess))<a name='1013'>
        WRITE (mess,*) TRIM(pre_str),'  clock time step = ',TRIM(timeStep_str)<a name='1014'>
        CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/share/module_date_time.F.html#WRF_CLOCKPRINT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_1358">(TRIM(mess))<a name='1015'>
      ENDIF<a name='1016'>
      RETURN<a name='1017'>
   END SUBROUTINE wrf_clockprint<a name='1018'>
<a name='1019'>
</pre></body></html>