<HTML> <BODY BGCOLOR=#ddeeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!IDEAL:MODEL_LAYER:INITIALIZATION<a name='2'></font>
<a name='3'>
<font color=#447700>!  This MODULE holds the routines which are used to perform various initializations<a name='4'></font>
<font color=#447700>!  for the individual domains.  <a name='5'></font>
<a name='6'>
<font color=#447700>!-----------------------------------------------------------------------<a name='7'></font>
<a name='8'>
<A NAME='MODULE_INITIALIZE_IDEAL'><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#MODULE_INITIALIZE_IDEAL' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='9'>
<font color=#993300>MODULE </font><font color=#cc0000>module_initialize_ideal</font> <A href='../../call_to/MODULE_INITIALIZE_IDEAL.html' TARGET='index'>4</A><a name='10'>
<a name='11'>
   USE <A href='../../html_code/frame/module_domain.F.html#MODULE_DOMAIN'>module_domain</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#module_initialize_b_wave.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DOMAIN_12"><a name='12'>
   USE <A href='../../html_code/share/module_io_domain.F.html#MODULE_IO_DOMAIN'>module_io_domain</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#module_initialize_b_wave.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_IO_DOMAIN_1"><a name='13'>
   USE <A href='../../html_code/frame/module_state_description.F.html#MODULE_STATE_DESCRIPTION'>module_state_description</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#module_initialize_b_wave.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_STATE_DESCRIPTION_9"><a name='14'>
   USE <A href='../../html_code/share/module_model_constants.F.html#MODULE_MODEL_CONSTANTS'>module_model_constants</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#module_initialize_b_wave.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MODEL_CONSTANTS_9"><a name='15'>
   USE <A href='../../html_code/share/module_bc.F.html#MODULE_BC'>module_bc</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#module_initialize_b_wave.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BC_7"><a name='16'>
   USE <A href='../../html_code/frame/module_timing.F.html#MODULE_TIMING'>module_timing</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#module_initialize_b_wave.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_TIMING_1"><a name='17'>
   USE <A href='../../html_code/frame/module_configure.F.html#MODULE_CONFIGURE'>module_configure</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#module_initialize_b_wave.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CONFIGURE_10"><a name='18'>
   USE <A href='../../html_code/dyn_em/module_init_utilities.F.html#MODULE_INIT_UTILITIES'>module_init_utilities</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#module_initialize_b_wave.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_INIT_UTILITIES_2"><a name='19'>
#ifdef DM_PARALLEL<a name='20'>
   USE <A href='../../html_code/frame/module_dm_stubs.F.html#MODULE_DM'>module_dm</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#module_initialize_b_wave.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DM_8"><a name='21'>
#endif<a name='22'>
   CHARACTER (LEN=256) , PRIVATE :: a_message<a name='23'>
<a name='24'>
<a name='25'>
CONTAINS<a name='26'>
<a name='27'>
<a name='28'>
<font color=#447700>!-------------------------------------------------------------------<a name='29'></font>
<font color=#447700>! this is a wrapper for the solver-specific init_domain routines.<a name='30'></font>
<font color=#447700>! Also dereferences the grid variables and passes them down as arguments.<a name='31'></font>
<font color=#447700>! This is crucial, since the lower level routines may do message passing<a name='32'></font>
<font color=#447700>! and this will get fouled up on machines that insist on passing down<a name='33'></font>
<font color=#447700>! copies of assumed-shape arrays (by passing down as arguments, the <a name='34'></font>
<font color=#447700>! data are treated as assumed-size -- ie. f77 -- arrays and the copying<a name='35'></font>
<font color=#447700>! business is avoided).  Fie on the F90 designers.  Fie and a pox.<a name='36'></font>
<a name='37'>
<A NAME='INIT_DOMAIN'><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='38'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>init_domain</font> ( grid ) <A href='../../call_to/INIT_DOMAIN.html' TARGET='index'>4</A>,<A href='../../call_from/INIT_DOMAIN.html' TARGET='index'>2</A><a name='39'>
<a name='40'>
   IMPLICIT NONE<a name='41'>
<a name='42'>
   <font color=#447700>!  Input data.<a name='43'></font>
   TYPE (domain), POINTER :: grid <a name='44'>
   <font color=#447700>!  Local data.<a name='45'></font>
   INTEGER :: idum1, idum2<a name='46'>
<a name='47'>
   CALL <A href='../../html_code/frame/module_configure.F.html#SET_SCALAR_INDICES_FROM_CONFIG'>set_scalar_indices_from_config</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_SCALAR_INDICES_FROM_CONFIG_1"> ( head_grid%id , idum1, idum2 )<a name='48'>
<a name='49'>
     CALL <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK'>init_domain_rk</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INIT_DOMAIN_RK_1">( grid &amp;<a name='50'>
<font color=#447700>!<a name='51'></font>
#include "<A href='../../html_code/include/actual_new_args.inc.html'>actual_new_args.inc</A>"<A NAME="actual_new_args.inc_1"><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='52'>
<font color=#447700>!<a name='53'></font>
                        )<a name='54'>
<a name='55'>
   END SUBROUTINE init_domain<a name='56'>
<a name='57'>
<font color=#447700>!-------------------------------------------------------------------<a name='58'></font>
<a name='59'>
<A NAME='INIT_DOMAIN_RK'><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='60'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>init_domain_rk</font> ( grid &amp; <A href='../../call_to/INIT_DOMAIN_RK.html' TARGET='index'>1</A>,<A href='../../call_from/INIT_DOMAIN_RK.html' TARGET='index'>16</A><a name='61'>
<font color=#447700>!<a name='62'></font>
# include "<A href='../../html_code/include/dummy_new_args.inc.html'>dummy_new_args.inc</A>"<A NAME="dummy_new_args.inc_2"><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='63'>
<font color=#447700>!<a name='64'></font>
)<a name='65'>
   IMPLICIT NONE<a name='66'>
<a name='67'>
   <font color=#447700>!  Input data.<a name='68'></font>
   TYPE (domain), POINTER :: grid<a name='69'>
<a name='70'>
# include "<A href='../../html_code/include/dummy_decl.inc.html'>dummy_decl.inc</A>"<A NAME="dummy_decl.inc_3"><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='71'>
<a name='72'>
   TYPE (grid_config_rec_type)              :: config_flags<a name='73'>
<a name='74'>
   <font color=#447700>!  Local data<a name='75'></font>
   INTEGER                             ::                       &amp;<a name='76'>
                                  ids, ide, jds, jde, kds, kde, &amp;<a name='77'>
                                  ims, ime, jms, jme, kms, kme, &amp;<a name='78'>
                                  its, ite, jts, jte, kts, kte, &amp;<a name='79'>
                                  i, j, k<a name='80'>
<a name='81'>
   <font color=#447700>! Local data<a name='82'></font>
<a name='83'>
   INTEGER, PARAMETER :: nl_max = 1000<a name='84'>
   REAL, DIMENSION(nl_max) :: zk, p_in, theta, rho_local, u, v, qv, pd_in<a name='85'>
   INTEGER :: nl_in<a name='86'>
<a name='87'>
   INTEGER :: icm,jcm, ii, im1, jj, jm1, loop, error, fid, nxc, nyc<a name='88'>
   REAL    :: u_mean,v_mean, f0, p_surf, p_level, qvf, z_at_v, z_at_u<a name='89'>
   REAL    :: z_scale, xrad, yrad, zrad, rad, delt, cof1, cof2<a name='90'>
<font color=#447700>!   REAL, EXTERNAL :: interp_0<a name='91'></font>
   REAL    :: hm<a name='92'>
   REAL    :: pi<a name='93'>
<a name='94'>
<font color=#447700>!  stuff from original initialization that has been dropped from the Registry <a name='95'></font>
   REAL    :: vnu, xnu, xnus, dinit0, cbh, p0_temp, t0_temp, zd, zt<a name='96'>
   REAL    :: qvf1, qvf2, pd_surf<a name='97'>
   INTEGER :: it<a name='98'>
<a name='99'>
   LOGICAL :: moisture_init<a name='100'>
   LOGICAL :: stretch_grid, dry_sounding, debug<a name='101'>
<a name='102'>
<font color=#447700>!  kludge space for initial jet<a name='103'></font>
<a name='104'>
   INTEGER, parameter :: nz_jet=64, ny_jet=80<a name='105'>
   REAL, DIMENSION(nz_jet, ny_jet) :: u_jet, rho_jet, th_jet, z_jet<a name='106'>
<a name='107'>
<font color=#447700>!  perturbation parameters<a name='108'></font>
<a name='109'>
   REAL, PARAMETER :: htbub=8000., radbub=2000000., radz=8000., tpbub=1.0<a name='110'>
   REAL :: piov2, tp<a name='111'>
   INTEGER :: icen, jcen<a name='112'>
   real :: thtmp, ptmp, temp(3)<a name='113'>
<a name='114'>
   SELECT CASE ( model_data_order )<a name='115'>
         CASE ( DATA_ORDER_ZXY )<a name='116'>
   kds = grid%sd31 ; kde = grid%ed31 ;<a name='117'>
   ids = grid%sd32 ; ide = grid%ed32 ;<a name='118'>
   jds = grid%sd33 ; jde = grid%ed33 ;<a name='119'>
<a name='120'>
   kms = grid%sm31 ; kme = grid%em31 ;<a name='121'>
   ims = grid%sm32 ; ime = grid%em32 ;<a name='122'>
   jms = grid%sm33 ; jme = grid%em33 ;<a name='123'>
<a name='124'>
   kts = grid%sp31 ; kte = grid%ep31 ;   <font color=#447700>! note that tile is entire patch<a name='125'></font>
   its = grid%sp32 ; ite = grid%ep32 ;   <font color=#447700>! note that tile is entire patch<a name='126'></font>
   jts = grid%sp33 ; jte = grid%ep33 ;   <font color=#447700>! note that tile is entire patch<a name='127'></font>
         CASE ( DATA_ORDER_XYZ )<a name='128'>
   ids = grid%sd31 ; ide = grid%ed31 ;<a name='129'>
   jds = grid%sd32 ; jde = grid%ed32 ;<a name='130'>
   kds = grid%sd33 ; kde = grid%ed33 ;<a name='131'>
<a name='132'>
   ims = grid%sm31 ; ime = grid%em31 ;<a name='133'>
   jms = grid%sm32 ; jme = grid%em32 ;<a name='134'>
   kms = grid%sm33 ; kme = grid%em33 ;<a name='135'>
<a name='136'>
   its = grid%sp31 ; ite = grid%ep31 ;   <font color=#447700>! note that tile is entire patch<a name='137'></font>
   jts = grid%sp32 ; jte = grid%ep32 ;   <font color=#447700>! note that tile is entire patch<a name='138'></font>
   kts = grid%sp33 ; kte = grid%ep33 ;   <font color=#447700>! note that tile is entire patch<a name='139'></font>
         CASE ( DATA_ORDER_XZY )<a name='140'>
   ids = grid%sd31 ; ide = grid%ed31 ;<a name='141'>
   kds = grid%sd32 ; kde = grid%ed32 ;<a name='142'>
   jds = grid%sd33 ; jde = grid%ed33 ;<a name='143'>
<a name='144'>
   ims = grid%sm31 ; ime = grid%em31 ;<a name='145'>
   kms = grid%sm32 ; kme = grid%em32 ;<a name='146'>
   jms = grid%sm33 ; jme = grid%em33 ;<a name='147'>
<a name='148'>
   its = grid%sp31 ; ite = grid%ep31 ;   <font color=#447700>! note that tile is entire patch<a name='149'></font>
   kts = grid%sp32 ; kte = grid%ep32 ;   <font color=#447700>! note that tile is entire patch<a name='150'></font>
   jts = grid%sp33 ; jte = grid%ep33 ;   <font color=#447700>! note that tile is entire patch<a name='151'></font>
<a name='152'>
   END SELECT<a name='153'>
<a name='154'>
   piov2 = 2.*atan(1.0)<a name='155'>
   icen = ide/4<a name='156'>
   jcen = jde/2<a name='157'>
<a name='158'>
   stretch_grid = .true.<a name='159'>
   delt = 0.<a name='160'>
   z_scale = .50<a name='161'>
   pi = 2.*asin(1.0)<a name='162'>
   write(a_message,*) ' pi is ',pi<a name='163'>
   call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_2">(a_message)<a name='164'>
   nxc = (ide-ids)/4<a name='165'>
   nyc = (jde-jds)/2<a name='166'>
<a name='167'>
   CALL <A href='../../html_code/frame/module_configure.F.html#MODEL_TO_GRID_CONFIG_REC'>model_to_grid_config_rec</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODEL_TO_GRID_CONFIG_REC_2"> ( grid%id , model_config_rec , config_flags )<a name='168'>
<a name='169'>
<font color=#447700>! here we check to see if the boundary conditions are set properly<a name='170'></font>
<a name='171'>
   CALL <A href='../../html_code/share/module_bc.F.html#BOUNDARY_CONDITION_CHECK'>boundary_condition_check</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="BOUNDARY_CONDITION_CHECK_1">( config_flags, bdyzone, error, grid%id )<a name='172'>
<a name='173'>
   moisture_init = .true.<a name='174'>
<a name='175'>
    grid%itimestep=0<a name='176'>
<a name='177'>
#ifdef DM_PARALLEL<a name='178'>
   CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_1">( icm , IWORDSIZE )<a name='179'>
   CALL <A href='../../html_code/frame/module_dm_stubs.F.html#WRF_DM_BCAST_BYTES'>wrf_dm_bcast_bytes</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DM_BCAST_BYTES_2">( jcm , IWORDSIZE )<a name='180'>
#endif<a name='181'>
<a name='182'>
    CALL nl_set_mminlu(1,'    ')<a name='183'>
    CALL nl_set_iswater(1,0)<a name='184'>
    CALL nl_set_cen_lat(1,40.)<a name='185'>
    CALL nl_set_cen_lon(1,-105.)<a name='186'>
    CALL nl_set_truelat1(1,0.)<a name='187'>
    CALL nl_set_truelat2(1,0.)<a name='188'>
    CALL nl_set_moad_cen_lat (1,0.)<a name='189'>
    CALL nl_set_stand_lon (1,0.)<a name='190'>
    CALL nl_set_pole_lon (1,0.)<a name='191'>
    CALL nl_set_pole_lat (1,90.)<a name='192'>
    CALL nl_set_map_proj(1,0)<a name='193'>
<a name='194'>
<a name='195'>
<font color=#447700>!  here we initialize data we currently is not initialized <a name='196'></font>
<font color=#447700>!  in the input data<a name='197'></font>
<a name='198'>
    DO j = jts, jte<a name='199'>
      DO i = its, ite<a name='200'>
<a name='201'>
         grid%ht(i,j)       = 0.<a name='202'>
         grid%msftx(i,j)    = 1.<a name='203'>
         grid%msfty(i,j)    = 1.<a name='204'>
         grid%msfux(i,j)    = 1.<a name='205'>
         grid%msfuy(i,j)    = 1.<a name='206'>
         grid%msfvx(i,j)    = 1.<a name='207'>
         grid%msfvx_inv(i,j)= 1.<a name='208'>
         grid%msfvy(i,j)    = 1.<a name='209'>
         grid%sina(i,j)     = 0.<a name='210'>
         grid%cosa(i,j)     = 1.<a name='211'>
         grid%e(i,j)        = 0.<a name='212'>
         grid%f(i,j)        = 1.e-04<a name='213'>
<a name='214'>
      END DO<a name='215'>
   END DO<a name='216'>
<a name='217'>
    DO j = jts, jte<a name='218'>
    DO k = kts, kte<a name='219'>
      DO i = its, ite<a name='220'>
         grid%ww(i,k,j)     = 0.<a name='221'>
      END DO<a name='222'>
   END DO<a name='223'>
   END DO<a name='224'>
<a name='225'>
   grid%step_number = 0<a name='226'>
<a name='227'>
<font color=#447700>! set up the grid<a name='228'></font>
<a name='229'>
   IF (stretch_grid) THEN <font color=#447700>! exponential stretch for eta (nearly constant dz)<a name='230'></font>
     DO k=1, kde<a name='231'>
      grid%znw(k) = (exp(-(k-1)/float(kde-1)/z_scale) - exp(-1./z_scale))/ &amp;<a name='232'>
                                (1.-exp(-1./z_scale))<a name='233'>
     ENDDO<a name='234'>
   ELSE<a name='235'>
     DO k=1, kde<a name='236'>
      grid%znw(k) = 1. - float(k-1)/float(kde-1)<a name='237'>
     ENDDO<a name='238'>
   ENDIF<a name='239'>
<a name='240'>
   DO k=1, kde-1<a name='241'>
    grid%dnw(k) = grid%znw(k+1) - grid%znw(k)<a name='242'>
    grid%rdnw(k) = 1./grid%dnw(k)<a name='243'>
    grid%znu(k) = 0.5*(grid%znw(k+1)+grid%znw(k))<a name='244'>
   ENDDO<a name='245'>
<a name='246'>
   IF ( config_flags%hybrid_opt .NE. 0 ) THEN<a name='247'>
      call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_26"> ( '--- ERROR: Hybrid Vertical Coordinate option not supported with this idealized case' )<a name='248'>
   END IF<a name='249'>
   grid%hybrid_opt = 0<a name='250'>
<a name='251'>
   DO k=1, kde<a name='252'>
    grid%c3f(k) = grid%znw(k)<a name='253'>
    grid%c4f(k) = 0.<a name='254'>
    grid%c3h(k) = grid%znu(k)<a name='255'>
    grid%c4h(k) = 0.<a name='256'>
    grid%c1f(k) = 1.<a name='257'>
    grid%c2f(k) = 0.<a name='258'>
    grid%c1h(k) = 1.<a name='259'>
    grid%c2h(k) = 0.<a name='260'>
   ENDDO <a name='261'>
<a name='262'>
   DO k=2, kde-1<a name='263'>
    grid%dn(k) = 0.5*(grid%dnw(k)+grid%dnw(k-1))<a name='264'>
    grid%rdn(k) = 1./grid%dn(k)<a name='265'>
    grid%fnp(k) = .5* grid%dnw(k  )/grid%dn(k)<a name='266'>
    grid%fnm(k) = .5* grid%dnw(k-1)/grid%dn(k)<a name='267'>
   ENDDO<a name='268'>
<a name='269'>
   cof1 = (2.*grid%dn(2)+grid%dn(3))/(grid%dn(2)+grid%dn(3))*grid%dnw(1)/grid%dn(2) <a name='270'>
   cof2 =     grid%dn(2)        /(grid%dn(2)+grid%dn(3))*grid%dnw(1)/grid%dn(3) <a name='271'>
   grid%cf1  = grid%fnp(2) + cof1<a name='272'>
   grid%cf2  = grid%fnm(2) - cof1 - cof2<a name='273'>
   grid%cf3  = cof2       <a name='274'>
<a name='275'>
   grid%cfn  = (.5*grid%dnw(kde-1)+grid%dn(kde-1))/grid%dn(kde-1)<a name='276'>
   grid%cfn1 = -.5*grid%dnw(kde-1)/grid%dn(kde-1)<a name='277'>
   grid%rdx = 1./config_flags%dx<a name='278'>
   grid%rdy = 1./config_flags%dy<a name='279'>
<a name='280'>
<font color=#447700>!  get the sounding from the ascii sounding file, first get dry sounding and <a name='281'></font>
<font color=#447700>!  calculate base state<a name='282'></font>
<a name='283'>
  write(6,*) ' reading input jet sounding '<a name='284'>
  call <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#READ_INPUT_JET'>read_input_jet</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="READ_INPUT_JET_1">( u_jet, rho_jet, th_jet, z_jet, nz_jet, ny_jet )<a name='285'>
<a name='286'>
  write(6,*) ' getting dry sounding for base state '<a name='287'>
  write(6,*) ' using middle column in jet sounding, j = ',ny_jet/2<a name='288'>
  dry_sounding = .true.<a name='289'>
<a name='290'>
  dry_sounding   = .true.<a name='291'>
  debug = .true.  <font color=#447700>!  this will produce print of the sounding<a name='292'></font>
  CALL <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#GET_SOUNDING'>get_sounding</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_SOUNDING_1">( zk, p_in, pd_in, theta, rho_local, u, v, qv, dry_sounding, &amp;<a name='293'>
                      nl_max, nl_in, u_jet, rho_jet, th_jet, z_jet,      &amp;<a name='294'>
                      nz_jet, ny_jet, ny_jet/2, debug                   )<a name='295'>
<a name='296'>
  write(6,*) ' returned from reading sounding, nl_in is ',nl_in<a name='297'>
<a name='298'>
<font color=#447700>!  find ptop for the desired ztop (ztop is input from the namelist),<a name='299'></font>
<font color=#447700>!  and find surface pressure<a name='300'></font>
<a name='301'>
<font color=#447700>!  For the jet, using the middle column for the base state means that<a name='302'></font>
<font color=#447700>!  we will be extrapolating above the highest height data to the south<a name='303'></font>
<font color=#447700>!  of the centerline.<a name='304'></font>
<a name='305'>
  grid%p_top = <A href='../../html_code/dyn_em/module_init_utilities.F.html#INTERP_0'>interp_0</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERP_0_43">( p_in, zk, config_flags%ztop, nl_in )<a name='306'>
<a name='307'>
  DO j=jts,jte<a name='308'>
  DO i=its,ite  <font color=#447700>! flat surface<a name='309'></font>
    grid%phb(i,1,j) = 0.<a name='310'>
    grid%php(i,1,j) = 0.<a name='311'>
    grid%ph0(i,1,j) = 0.<a name='312'>
    grid%ht(i,j) = 0.<a name='313'>
  ENDDO<a name='314'>
  ENDDO<a name='315'>
<a name='316'>
  DO J = jts, jte<a name='317'>
  DO I = its, ite<a name='318'>
<a name='319'>
    p_surf = <A href='../../html_code/dyn_em/module_init_utilities.F.html#INTERP_0'>interp_0</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERP_0_44">( p_in, zk, grid%phb(i,1,j)/g, nl_in )<a name='320'>
    grid%mub(i,j) = p_surf-grid%p_top<a name='321'>
<a name='322'>
<font color=#447700>!  this is dry hydrostatic sounding (base state), so given grid%p (coordinate),<a name='323'></font>
<font color=#447700>!  interp theta (from interp) and compute 1/rho from eqn. of state<a name='324'></font>
<a name='325'>
    DO K = 1, kte-1<a name='326'>
      p_level = grid%znu(k)*(p_surf - grid%p_top) + grid%p_top<a name='327'>
      grid%pb(i,k,j) = p_level<a name='328'>
      grid%t_init(i,k,j) = <A href='../../html_code/dyn_em/module_init_utilities.F.html#INTERP_0'>interp_0</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERP_0_45">( theta, p_in, p_level, nl_in ) - t0<a name='329'>
      grid%alb(i,k,j) = (r_d/p1000mb)*(grid%t_init(i,k,j)+t0)*(grid%pb(i,k,j)/p1000mb)**cvpm<a name='330'>
    ENDDO<a name='331'>
<a name='332'>
<font color=#447700>!  calc hydrostatic balance (alternatively we could interp the geopotential from the<a name='333'></font>
<font color=#447700>!  sounding, but this assures that the base state is in exact hydrostatic balance with<a name='334'></font>
<font color=#447700>!  respect to the model eqns.<a name='335'></font>
<a name='336'>
    DO k  = 2,kte<a name='337'>
      grid%phb(i,k,j) = grid%phb(i,k-1,j) - grid%dnw(k-1)*grid%mub(i,j)*grid%alb(i,k-1,j)<a name='338'>
    ENDDO<a name='339'>
<a name='340'>
  ENDDO<a name='341'>
  ENDDO<a name='342'>
<a name='343'>
  write(6,*) ' ptop is ',grid%p_top<a name='344'>
  write(6,*) ' base state grid%mub(1,1), p_surf is ',grid%mub(1,1),grid%mub(1,1)+grid%p_top<a name='345'>
<a name='346'>
<font color=#447700>!  calculate full state for each column - this includes moisture.<a name='347'></font>
<a name='348'>
  write(6,*) ' getting grid%moist sounding for full state '<a name='349'>
<a name='350'>
  dry_sounding = .true.<a name='351'>
  IF (config_flags%mp_physics /= 0)  dry_sounding = .false.<a name='352'>
<a name='353'>
  DO J = jts, min(jde-1,jte)<a name='354'>
<a name='355'>
<font color=#447700>!  get sounding for this point<a name='356'></font>
<a name='357'>
  debug = .false.  <font color=#447700>!  this will turn off print of the sounding<a name='358'></font>
  CALL <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#GET_SOUNDING'>get_sounding</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_SOUNDING_2">( zk, p_in, pd_in, theta, rho_local, u, v, qv, dry_sounding, &amp;<a name='359'>
                      nl_max, nl_in, u_jet, rho_jet, th_jet, z_jet,      &amp;<a name='360'>
                      nz_jet, ny_jet, j, debug                          )<a name='361'>
<a name='362'>
  DO I = its, min(ide-1,ite)<a name='363'>
<a name='364'>
<font color=#447700>!   we could just do the first point in "i" and copy from there, but we'll<a name='365'></font>
<font color=#447700>!   be lazy and do all the points as if they are all, independent<a name='366'></font>
<a name='367'>
<font color=#447700>!   At this point grid%p_top is already set. find the DRY mass in the column <a name='368'></font>
<font color=#447700>!   by interpolating the DRY pressure.  <a name='369'></font>
<a name='370'>
    pd_surf = <A href='../../html_code/dyn_em/module_init_utilities.F.html#INTERP_0'>interp_0</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERP_0_46">( pd_in, zk, grid%phb(i,1,j)/g, nl_in )<a name='371'>
<a name='372'>
<font color=#447700>!   compute the perturbation mass and the full mass<a name='373'></font>
<a name='374'>
    grid%mu_1(i,j) = pd_surf-grid%p_top - grid%mub(i,j)<a name='375'>
    grid%mu_2(i,j) = grid%mu_1(i,j)<a name='376'>
    grid%mu0(i,j) = grid%mu_1(i,j) + grid%mub(i,j)<a name='377'>
<a name='378'>
<font color=#447700>!   given the dry pressure and coordinate system, interp the potential<a name='379'></font>
<font color=#447700>!   temperature and qv<a name='380'></font>
<a name='381'>
    do k=1,kde-1<a name='382'>
<a name='383'>
      p_level = grid%znu(k)*(pd_surf - grid%p_top) + grid%p_top<a name='384'>
<a name='385'>
      grid%moist(i,k,j,P_QV) = <A href='../../html_code/dyn_em/module_init_utilities.F.html#INTERP_0'>interp_0</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERP_0_47">( qv, pd_in, p_level, nl_in )<a name='386'>
      grid%t_1(i,k,j)          = <A href='../../html_code/dyn_em/module_init_utilities.F.html#INTERP_0'>interp_0</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERP_0_48">( theta, pd_in, p_level, nl_in ) - t0<a name='387'>
      grid%t_2(i,k,j)          = grid%t_1(i,k,j)<a name='388'>
      <a name='389'>
<a name='390'>
    enddo<a name='391'>
<a name='392'>
<font color=#447700>!   integrate the hydrostatic equation (from the RHS of the bigstep<a name='393'></font>
<font color=#447700>!   vertical momentum equation) down from the top to get grid%p.<a name='394'></font>
<font color=#447700>!   first from the top of the model to the top pressure<a name='395'></font>
<a name='396'>
    k = kte-1  <font color=#447700>! top level<a name='397'></font>
<a name='398'>
    qvf1 = 0.5*(grid%moist(i,k,j,P_QV)+grid%moist(i,k,j,P_QV))<a name='399'>
    qvf2 = 1./(1.+qvf1)<a name='400'>
    qvf1 = qvf1*qvf2<a name='401'>
<a name='402'>
<font color=#447700>!    grid%p(i,k,j) = - 0.5*grid%mu_1(i,j)/grid%rdnw(k)<a name='403'></font>
    grid%p(i,k,j) = - 0.5*(grid%mu_1(i,j)+qvf1*grid%mub(i,j))/grid%rdnw(k)/qvf2<a name='404'>
    qvf = 1. + rvovrd*grid%moist(i,k,j,P_QV)<a name='405'>
    grid%alt(i,k,j) = (r_d/p1000mb)*(grid%t_1(i,k,j)+t0)*qvf* &amp;<a name='406'>
                (((grid%p(i,k,j)+grid%pb(i,k,j))/p1000mb)**cvpm)<a name='407'>
    grid%al(i,k,j) = grid%alt(i,k,j) - grid%alb(i,k,j)<a name='408'>
<a name='409'>
<font color=#447700>!  down the column<a name='410'></font>
<a name='411'>
    do k=kte-2,1,-1<a name='412'>
      qvf1 = 0.5*(grid%moist(i,k,j,P_QV)+grid%moist(i,k+1,j,P_QV))<a name='413'>
      qvf2 = 1./(1.+qvf1)<a name='414'>
      qvf1 = qvf1*qvf2<a name='415'>
      grid%p(i,k,j) = grid%p(i,k+1,j) - (grid%mu_1(i,j) + qvf1*grid%mub(i,j))/qvf2/grid%rdn(k+1)<a name='416'>
      qvf = 1. + rvovrd*grid%moist(i,k,j,P_QV)<a name='417'>
      grid%alt(i,k,j) = (r_d/p1000mb)*(grid%t_1(i,k,j)+t0)*qvf* &amp;<a name='418'>
                  (((grid%p(i,k,j)+grid%pb(i,k,j))/p1000mb)**cvpm)<a name='419'>
      grid%al(i,k,j) = grid%alt(i,k,j) - grid%alb(i,k,j)<a name='420'>
    enddo<a name='421'>
<a name='422'>
<font color=#447700>!  this is the hydrostatic equation used in the model after the<a name='423'></font>
<font color=#447700>!  small timesteps.  In the model, grid%al (inverse density)<a name='424'></font>
<font color=#447700>!  is computed from the geopotential.<a name='425'></font>
<a name='426'>
<a name='427'>
    grid%ph_1(i,1,j) = 0.<a name='428'>
    DO k  = 2,kte<a name='429'>
      grid%ph_1(i,k,j) = grid%ph_1(i,k-1,j) - (grid%dnw(k-1))*(       &amp;<a name='430'>
                   (grid%mub(i,j)+grid%mu_1(i,j))*grid%al(i,k-1,j)+ &amp;<a name='431'>
                    grid%mu_1(i,j)*grid%alb(i,k-1,j)  )<a name='432'>
                                                   <a name='433'>
      grid%ph_2(i,k,j) = grid%ph_1(i,k,j) <a name='434'>
      grid%ph0(i,k,j) = grid%ph_1(i,k,j) + grid%phb(i,k,j)<a name='435'>
    ENDDO<a name='436'>
<a name='437'>
<font color=#447700>! interp u<a name='438'></font>
<a name='439'>
    DO K = 1, kte<a name='440'>
      p_level = grid%znu(k)*(p_surf - grid%p_top) + grid%p_top<a name='441'>
      grid%u_1(i,k,j) = <A href='../../html_code/dyn_em/module_init_utilities.F.html#INTERP_0'>interp_0</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_DOMAIN_RK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INTERP_0_49">( u, p_in, p_level, nl_in )<a name='442'>
      grid%u_2(i,k,j) = grid%u_1(i,k,j)<a name='443'>
    ENDDO<a name='444'>
<a name='445'>
  ENDDO<a name='446'>
  ENDDO<a name='447'>
<a name='448'>
<font color=#447700>!  thermal perturbation to kick off convection<a name='449'></font>
<a name='450'>
  write(6,*) ' nxc, nyc for perturbation ',nxc,nyc<a name='451'>
  write(6,*) ' delt for perturbation ',tpbub<a name='452'>
<a name='453'>
  DO J = jts, min(jde-1,jte)<a name='454'>
    yrad = config_flags%dy*float(j-jde/2-1)/radbub<a name='455'>
    DO I = its, min(ide-1,ite)<a name='456'>
      xrad = float(i-1)/float(ide-ids)<a name='457'>
<a name='458'>
      DO K = 1, kte-1<a name='459'>
<a name='460'>
<font color=#447700>!  put in preturbation theta (bubble) and recalc density.  note,<a name='461'></font>
<font color=#447700>!  the mass in the column is not changing, so when theta changes,<a name='462'></font>
<font color=#447700>!  we recompute density and geopotential<a name='463'></font>
<a name='464'>
        zrad = 0.5*(grid%ph_1(i,k,j)+grid%ph_1(i,k+1,j)  &amp;<a name='465'>
                   +grid%phb(i,k,j)+grid%phb(i,k+1,j))/g<a name='466'>
        zrad = (zrad-htbub)/radz<a name='467'>
        RAD=SQRT(yrad*yrad+zrad*zrad)<a name='468'>
        IF(RAD &lt;= 1.) THEN<a name='469'>
           tp = tpbub*cos(rad*piov2)*cos(rad*piov2)*cos(xrad*2*pi+pi)<a name='470'>
           grid%t_1(i,k,j)=grid%t_1(i,k,j)+tp<a name='471'>
           grid%t_2(i,k,j)=grid%t_1(i,k,j)<a name='472'>
           qvf = 1. + rvovrd*grid%moist(i,k,j,P_QV)<a name='473'>
           grid%alt(i,k,j) = (r_d/p1000mb)*(grid%t_1(i,k,j)+t0)*qvf* &amp;<a name='474'>
                        (((grid%p(i,k,j)+grid%pb(i,k,j))/p1000mb)**cvpm)<a name='475'>
           grid%al(i,k,j) = grid%alt(i,k,j) - grid%alb(i,k,j)<a name='476'>
        ENDIF<a name='477'>
      ENDDO<a name='478'>
<a name='479'>
<font color=#447700>!  rebalance hydrostatically<a name='480'></font>
<a name='481'>
      DO k  = 2,kte<a name='482'>
        grid%ph_1(i,k,j) = grid%ph_1(i,k-1,j) - (grid%dnw(k-1))*(       &amp;<a name='483'>
                     (grid%mub(i,j)+grid%mu_1(i,j))*grid%al(i,k-1,j)+ &amp;<a name='484'>
                      grid%mu_1(i,j)*grid%alb(i,k-1,j)  )<a name='485'>
                                                   <a name='486'>
        grid%ph_2(i,k,j) = grid%ph_1(i,k,j) <a name='487'>
        grid%ph0(i,k,j) = grid%ph_1(i,k,j) + grid%phb(i,k,j)<a name='488'>
      ENDDO<a name='489'>
<a name='490'>
    ENDDO<a name='491'>
  ENDDO<a name='492'>
<a name='493'>
<font color=#447700>!#endif<a name='494'></font>
<a name='495'>
   write(6,*) ' grid%mu_1 from comp ', grid%mu_1(1,1)<a name='496'>
   write(6,*) ' pert state sounding from comp, grid%ph_1, pp, grid%al, grid%t_1, qv '<a name='497'>
   do k=1,kde-1<a name='498'>
     write(6,'(i3,1x,5(1x,1pe10.3))') k, grid%ph_1(1,k,1),grid%p(1,k,1), grid%al(1,k,1), &amp;<a name='499'>
                     grid%t_1(1,k,1), grid%moist(1,k,1,P_QV)<a name='500'>
   enddo<a name='501'>
<a name='502'>
   write(6,*) ' grid%mu_1 from comp ', grid%mu_1(1,1)<a name='503'>
   write(6,*) ' full state sounding from comp, ph, grid%p, grid%al, grid%t_1, qv '<a name='504'>
   write(6,*) ' at j = 1 '<a name='505'>
   do k=1,kde-1<a name='506'>
     write(6,'(i3,1x,5(1x,1pe10.3))') k, grid%ph_1(1,k,1)+grid%phb(1,k,1), &amp;<a name='507'>
                     grid%p(1,k,1)+grid%pb(1,k,1), grid%al(1,k,1)+grid%alb(1,k,1), &amp;<a name='508'>
                     grid%t_1(1,k,1)+t0, grid%moist(1,k,1,P_QV)<a name='509'>
   enddo<a name='510'>
<a name='511'>
<a name='512'>
   write(6,*) ' full state sounding from comp, ph, grid%p, grid%al, grid%t_1, qv '<a name='513'>
   write(6,*) ' at j = jde/2 '<a name='514'>
   do k=1,kde-1<a name='515'>
     write(6,'(i3,1x,5(1x,1pe10.3))') k, grid%ph_1(1,k,jde/2)+grid%phb(1,k,jde/2), &amp;<a name='516'>
                     grid%p(1,k,jde/2)+grid%pb(1,k,jde/2), grid%al(1,k,jde/2)+grid%alb(1,k,jde/2), &amp;<a name='517'>
                     grid%t_1(1,k,jde/2)+t0, grid%moist(1,k,jde/2,P_QV)<a name='518'>
   enddo<a name='519'>
<a name='520'>
   write(6,*) ' full state sounding from comp, ph, grid%p, grid%al, grid%t_1, qv '<a name='521'>
   write(6,*) ' at j = jde-1 '<a name='522'>
   do k=1,kde-1<a name='523'>
     write(6,'(i3,1x,5(1x,1pe10.3))') k, grid%ph_1(1,k,jde-1)+grid%phb(1,k,jde-1), &amp;<a name='524'>
                     grid%p(1,k,jde-1)+grid%pb(1,k,jde-1), grid%al(1,k,jde-1)+grid%alb(1,k,jde-1), &amp;<a name='525'>
                     grid%t_1(1,k,jde-1)+t0, grid%moist(1,k,jde-1,P_QV)<a name='526'>
   enddo<a name='527'>
<a name='528'>
<font color=#447700>! set v<a name='529'></font>
<a name='530'>
  DO J = jts, jte<a name='531'>
  DO I = its, min(ide-1,ite)<a name='532'>
<a name='533'>
    DO K = 1, kte<a name='534'>
      grid%v_1(i,k,j) = 0.<a name='535'>
      grid%v_2(i,k,j) = grid%v_1(i,k,j)<a name='536'>
    ENDDO<a name='537'>
<a name='538'>
  ENDDO<a name='539'>
  ENDDO<a name='540'>
<a name='541'>
<font color=#447700>!  fill out last i row for u<a name='542'></font>
<a name='543'>
  DO J = jts, min(jde-1,jte)<a name='544'>
  DO I = ite, ite<a name='545'>
<a name='546'>
    DO K = 1, kte<a name='547'>
      grid%u_1(i,k,j) = grid%u_1(its,k,j)<a name='548'>
      grid%u_2(i,k,j) = grid%u_2(its,k,j)<a name='549'>
    ENDDO<a name='550'>
<a name='551'>
  ENDDO<a name='552'>
  ENDDO<a name='553'>
<a name='554'>
<font color=#447700>!  set w<a name='555'></font>
<a name='556'>
  DO J = jts, min(jde-1,jte)<a name='557'>
  DO K = kts, kte<a name='558'>
  DO I = its, min(ide-1,ite)<a name='559'>
    grid%w_1(i,k,j) = 0.<a name='560'>
    grid%w_2(i,k,j) = 0.<a name='561'>
  ENDDO<a name='562'>
  ENDDO<a name='563'>
  ENDDO<a name='564'>
<a name='565'>
<font color=#447700>!  set a few more things<a name='566'></font>
<a name='567'>
  DO J = jts, min(jde-1,jte)<a name='568'>
  DO K = kts, kte-1<a name='569'>
  DO I = its, min(ide-1,ite)<a name='570'>
    grid%h_diabatic(i,k,j) = 0.<a name='571'>
  ENDDO<a name='572'>
  ENDDO<a name='573'>
  ENDDO<a name='574'>
<a name='575'>
  DO k=1,kte-1<a name='576'>
    grid%t_base(k) = grid%t_1(1,k,1)<a name='577'>
    grid%qv_base(k) = grid%moist(1,k,1,P_QV)<a name='578'>
    grid%u_base(k) = grid%u_1(1,k,1)<a name='579'>
    grid%v_base(k) = grid%v_1(1,k,1)<a name='580'>
  ENDDO<a name='581'>
<a name='582'>
  DO J = jts, min(jde-1,jte)<a name='583'>
  DO I = its, min(ide-1,ite)<a name='584'>
     thtmp   = grid%t_2(i,1,j)+t0<a name='585'>
     ptmp    = grid%p(i,1,j)+grid%pb(i,1,j)<a name='586'>
     temp(1) = thtmp * (ptmp/p1000mb)**rcp<a name='587'>
     thtmp   = grid%t_2(i,2,j)+t0<a name='588'>
     ptmp    = grid%p(i,2,j)+grid%pb(i,2,j)<a name='589'>
     temp(2) = thtmp * (ptmp/p1000mb)**rcp<a name='590'>
     thtmp   = grid%t_2(i,3,j)+t0<a name='591'>
     ptmp    = grid%p(i,3,j)+grid%pb(i,3,j)<a name='592'>
     temp(3) = thtmp * (ptmp/p1000mb)**rcp<a name='593'>
<a name='594'>
     grid%tsk(I,J)=grid%cf1*temp(1)+grid%cf2*temp(2)+grid%cf3*temp(3)<a name='595'>
     if (i .eq. 1) print*,'sfctem',j,temp(1),temp(2),temp(3),grid%tsk(I,J)<a name='596'>
     grid%tmn(I,J)=grid%tsk(I,J)-0.5<a name='597'>
  ENDDO<a name='598'>
  ENDDO<a name='599'>
<a name='600'>
  RETURN<a name='601'>
<a name='602'>
 END SUBROUTINE init_domain_rk<a name='603'>
<a name='604'>
<font color=#447700>!---------------------------------------------------------------------<a name='605'></font>
<a name='606'>
<A NAME='INIT_MODULE_INITIALIZE'><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_MODULE_INITIALIZE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='607'>
 <font color=#993300>SUBROUTINE </font><font color=#cc0000>init_module_initialize</font>,<A href='../../call_from/INIT_MODULE_INITIALIZE.html' TARGET='index'>8</A><a name='608'>
 END SUBROUTINE init_module_initialize<a name='609'>
<a name='610'>
<font color=#447700>!---------------------------------------------------------------------<a name='611'></font>
#if 0<a name='612'>
<font color=#447700>! TEST DRIVER FOR "read_input_jet" and "get_sounding"<a name='613'></font>
  implicit none <a name='614'>
  integer, parameter :: nz_jet=64, ny_jet=80<a name='615'>
  real, dimension(nz_jet,ny_jet) :: u_jet, rho_jet, &amp;<a name='616'>
                                    th_jet, z_jet<a name='617'>
<a name='618'>
  real, dimension(nz_jet,ny_jet) :: zk,p,p_dry,theta,rho_local,u,v,qv<a name='619'>
  logical :: dry, debug<a name='620'>
  integer :: j, nl<a name='621'>
<a name='622'>
  call <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#READ_INPUT_JET'>read_input_jet</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_MODULE_INITIALIZE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="READ_INPUT_JET_2">( u_jet, rho_jet, th_jet, z_jet, nz_jet, ny_jet )<a name='623'>
<a name='624'>
  call opngks<a name='625'>
  call <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#PARRAY'>parray</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_MODULE_INITIALIZE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRAY_1">( u_jet, nz_jet, ny_jet)<a name='626'>
  call <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#PARRAY'>parray</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_MODULE_INITIALIZE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRAY_2">( rho_jet, nz_jet, ny_jet)<a name='627'>
  call <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#PARRAY'>parray</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_MODULE_INITIALIZE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRAY_3">( th_jet, nz_jet, ny_jet)<a name='628'>
<font color=#447700>!  call clsgks<a name='629'></font>
<a name='630'>
<font color=#447700>!  set up initial jet<a name='631'></font>
<a name='632'>
  debug = .true.<a name='633'>
  dry = .true.<a name='634'>
  do j=1,ny_jet<a name='635'>
<a name='636'>
    call <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#GET_SOUNDING'>get_sounding</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_MODULE_INITIALIZE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_SOUNDING_3">( zk(:,j),p(:,j),p_dry(:,j),theta(:,j),      &amp;<a name='637'>
                       rho_local(:,j),u(:,j), v(:,j),  qv(:,j),        &amp;<a name='638'>
                       dry, nz_jet, nl, u_jet, rho_jet, th_jet,  &amp;<a name='639'>
                       z_jet, nz_jet, ny_jet, j, debug          )<a name='640'>
    debug = .false.<a name='641'>
<a name='642'>
  enddo<a name='643'>
<a name='644'>
  write(6,*) ' lowest level p, th, and rho, highest level p '<a name='645'>
<a name='646'>
  do j=1,ny_jet<a name='647'>
    write(6,*) j, p(1,j),theta(1,j),rho_local(1,j), p(nz_jet,j)<a name='648'>
  enddo<a name='649'>
<a name='650'>
  call <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#PARRAY'>parray</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_MODULE_INITIALIZE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRAY_4">( p, nz_jet, ny_jet)<a name='651'>
  call <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#PARRAY'>parray</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_MODULE_INITIALIZE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRAY_5">( p_dry, nz_jet, ny_jet)<a name='652'>
  call <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#PARRAY'>parray</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#INIT_MODULE_INITIALIZE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PARRAY_6">( theta, nz_jet, ny_jet)<a name='653'>
<a name='654'>
  call clsgks<a name='655'>
<a name='656'>
  end<a name='657'>
<a name='658'>
<font color=#447700>!---------------------------------<a name='659'></font>
<a name='660'>
<A NAME='PARRAY'><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#PARRAY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='661'>
      <font color=#993300>subroutine </font><font color=#cc0000>parray</font>(a,m,n) <A href='../../call_to/PARRAY.html' TARGET='index'>6</A><a name='662'>
      dimension a(m,n)<a name='663'>
      dimension b(n,m)<a name='664'>
<a name='665'>
    do i=1,m<a name='666'>
    do j=1,n<a name='667'>
      b(j,i) = a(i,j)<a name='668'>
    enddo<a name='669'>
    enddo<a name='670'>
      <a name='671'>
      write(6,'(''  dimensions m,n  '',2i6)')m,n<a name='672'>
        call set(.05,.95,.05,.95,0.,1.,0.,1.,1)<a name='673'>
        call perim(4,5,4,5)<a name='674'>
        call setusv('LW',2000)<a name='675'>
<font color=#447700>!        CALL CONREC(a,m,m,n,cmax,cmin,cinc,-1,-638,-922)<a name='676'></font>
        CALL CONREC(b,n,n,m,0.,0.,0.,-1,-638,-922)<a name='677'>
        call frame<a name='678'>
      return<a name='679'>
      end<a name='680'>
<a name='681'>
<font color=#447700>! END TEST DRIVER FOR "read_input_jet" and "get_sounding"<a name='682'></font>
#endif<a name='683'>
<a name='684'>
<font color=#447700>!------------------------------------------------------------------<a name='685'></font>
<a name='686'>
<A NAME='GET_SOUNDING'><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#GET_SOUNDING' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='687'>
    <font color=#993300>subroutine </font><font color=#cc0000>get_sounding</font>( zk, p, p_dry, theta, rho,       &amp; <A href='../../call_to/GET_SOUNDING.html' TARGET='index'>3</A>,<A href='../../call_from/GET_SOUNDING.html' TARGET='index'>2</A><a name='688'>
                             u, v, qv, dry, nl_max, nl_in,  &amp;<a name='689'>
                             u_jet, rho_jet, th_jet, z_jet, &amp;<a name='690'>
                             nz_jet, ny_jet, j_point, debug )<a name='691'>
    implicit none<a name='692'>
<a name='693'>
    integer nl_max, nl_in<a name='694'>
    real zk(nl_max), p(nl_max), theta(nl_max), rho(nl_max), &amp;<a name='695'>
         u(nl_max), v(nl_max), qv(nl_max), p_dry(nl_max)<a name='696'>
    logical dry<a name='697'>
<a name='698'>
    integer nz_jet, ny_jet, j_point<a name='699'>
    real, dimension(nz_jet, ny_jet) :: u_jet, rho_jet, th_jet, z_jet<a name='700'>
<a name='701'>
    integer n<a name='702'>
    parameter(n=1000)<a name='703'>
    logical debug<a name='704'>
<a name='705'>
<font color=#447700>! input sounding data<a name='706'></font>
<a name='707'>
    real p_surf, th_surf, qv_surf<a name='708'>
    real pi_surf, pi(n)<a name='709'>
    real h_input(n), th_input(n), qv_input(n), u_input(n), v_input(n)<a name='710'>
<a name='711'>
<font color=#447700>! diagnostics<a name='712'></font>
<a name='713'>
    real rho_surf, p_input(n), rho_input(n)<a name='714'>
    real pm_input(n)  <font color=#447700>!  this are for full moist sounding<a name='715'></font>
<a name='716'>
<font color=#447700>! local data<a name='717'></font>
<a name='718'>
    real r<a name='719'>
    parameter (r = r_d)<a name='720'>
    integer k, it, nl<a name='721'>
    real qvf, qvf1, dz<a name='722'>
<a name='723'>
<font color=#447700>!  first, read the sounding<a name='724'></font>
<a name='725'>
<font color=#447700>!    call read_sounding( p_surf, th_surf, qv_surf, &amp;<a name='726'></font>
<font color=#447700>!                          h_input, th_input, qv_input, u_input, v_input,n, nl, debug )<a name='727'></font>
<a name='728'>
   call <A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#CALC_JET_SOUNDING'>calc_jet_sounding</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#GET_SOUNDING' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CALC_JET_SOUNDING_1">( p_surf, th_surf, qv_surf,                             &amp;<a name='729'>
                           h_input, th_input, qv_input, u_input, v_input,        &amp;<a name='730'>
                           n, nl, debug, u_jet, rho_jet, th_jet, z_jet, j_point, &amp;<a name='731'>
                           nz_jet, ny_jet, dry                                  )<a name='732'>
<a name='733'>
   nl = nz_jet<a name='734'>
<a name='735'>
    if(dry) then<a name='736'>
     do k=1,nl<a name='737'>
       qv_input(k) = 0.<a name='738'>
     enddo<a name='739'>
    endif<a name='740'>
<a name='741'>
    if(debug) write(6,*) ' number of input levels = ',nl<a name='742'>
<a name='743'>
      nl_in = nl<a name='744'>
      if(nl_in .gt. nl_max ) then<a name='745'>
        write(6,*) ' too many levels for input arrays ',nl_in,nl_max<a name='746'>
        call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#GET_SOUNDING' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_27"> ( ' too many levels for input arrays ' )<a name='747'>
      end if<a name='748'>
<a name='749'>
<font color=#447700>!  compute diagnostics,<a name='750'></font>
<font color=#447700>!  first, convert qv(g/kg) to qv(g/g)<a name='751'></font>
<font color=#447700>!<a name='752'></font>
<font color=#447700>!      do k=1,nl<a name='753'></font>
<font color=#447700>!        qv_input(k) = 0.001*qv_input(k)<a name='754'></font>
<font color=#447700>!      enddo<a name='755'></font>
<font color=#447700>!      p_surf = 100.*p_surf  ! convert to pascals<a name='756'></font>
<a name='757'>
    qvf = 1. + rvovrd*qv_input(1) <a name='758'>
    rho_surf = 1./((r/p1000mb)*th_surf*qvf*((p_surf/p1000mb)**cvpm))<a name='759'>
    pi_surf = (p_surf/p1000mb)**(r/cp)<a name='760'>
<a name='761'>
    if(debug) then<a name='762'>
      write(6,*) ' surface density is ',rho_surf<a name='763'>
      write(6,*) ' surface pi is    ',pi_surf<a name='764'>
    end if<a name='765'>
<a name='766'>
<a name='767'>
<font color=#447700>!  integrate moist sounding hydrostatically, starting from the<a name='768'></font>
<font color=#447700>!  specified surface pressure<a name='769'></font>
<font color=#447700>!  -&gt; first, integrate from surface to lowest level<a name='770'></font>
<a name='771'>
        qvf = 1. + rvovrd*qv_input(1) <a name='772'>
        qvf1 = 1. + qv_input(1)<a name='773'>
        rho_input(1) = rho_surf<a name='774'>
        dz = h_input(1)<a name='775'>
        do it=1,10<a name='776'>
          pm_input(1) = p_surf &amp;<a name='777'>
                  - 0.5*dz*(rho_surf+rho_input(1))*g*qvf1<a name='778'>
          rho_input(1) = 1./((r/p1000mb)*th_input(1)*qvf*((pm_input(1)/p1000mb)**cvpm))<a name='779'>
        enddo<a name='780'>
<a name='781'>
<font color=#447700>! integrate up the column<a name='782'></font>
<a name='783'>
        do k=2,nl<a name='784'>
          rho_input(k) = rho_input(k-1)<a name='785'>
          dz = h_input(k)-h_input(k-1)<a name='786'>
          qvf1 = 0.5*(2.+(qv_input(k-1)+qv_input(k)))<a name='787'>
          qvf = 1. + rvovrd*qv_input(k)   <font color=#447700>! qv is in g/kg here<a name='788'></font>
 <a name='789'>
          do it=1,10<a name='790'>
            pm_input(k) = pm_input(k-1) &amp;<a name='791'>
                    - 0.5*dz*(rho_input(k)+rho_input(k-1))*g*qvf1<a name='792'>
            rho_input(k) = 1./((r/p1000mb)*th_input(k)*qvf*((pm_input(k)/p1000mb)**cvpm))<a name='793'>
          enddo<a name='794'>
        enddo<a name='795'>
<a name='796'>
<font color=#447700>!  we have the moist sounding<a name='797'></font>
<a name='798'>
<font color=#447700>!  next, compute the dry sounding using p at the highest level from the<a name='799'></font>
<font color=#447700>!  moist sounding and integrating down.<a name='800'></font>
<a name='801'>
        p_input(nl) = pm_input(nl)<a name='802'>
<a name='803'>
          do k=nl-1,1,-1<a name='804'>
            dz = h_input(k+1)-h_input(k)<a name='805'>
            p_input(k) = p_input(k+1) + 0.5*dz*(rho_input(k)+rho_input(k+1))*g<a name='806'>
          enddo<a name='807'>
<a name='808'>
<a name='809'>
        do k=1,nl<a name='810'>
<a name='811'>
          zk(k) = h_input(k)<a name='812'>
          p(k) = pm_input(k)<a name='813'>
          p_dry(k) = p_input(k)<a name='814'>
          theta(k) = th_input(k)<a name='815'>
          rho(k) = rho_input(k)<a name='816'>
          u(k) = u_input(k)<a name='817'>
          v(k) = v_input(k)<a name='818'>
          qv(k) = qv_input(k)<a name='819'>
<a name='820'>
        enddo<a name='821'>
<a name='822'>
     if(debug) then<a name='823'>
      write(6,*) ' sounding '<a name='824'>
      write(6,*) '  k  height(m)  press (Pa)   pd(Pa)   theta (K)  den(kg/m^3)  u(m/s)     v(m/s)    qv(g/g) '<a name='825'>
      do k=1,nl<a name='826'>
        write(6,'(1x,i3,8(1x,1pe10.3))') k, zk(k), p(k), p_dry(k), theta(k), rho(k), u(k), v(k), qv(k)<a name='827'>
      enddo<a name='828'>
<a name='829'>
     end if<a name='830'>
<a name='831'>
     end subroutine get_sounding<a name='832'>
<a name='833'>
<font color=#447700>!------------------------------------------------------------------<a name='834'></font>
<a name='835'>
<A NAME='CALC_JET_SOUNDING'><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#CALC_JET_SOUNDING' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='836'>
  <font color=#993300>subroutine </font><font color=#cc0000>calc_jet_sounding</font>( p_surf, th_surf, qv_surf,      &amp; <A href='../../call_to/CALC_JET_SOUNDING.html' TARGET='index'>1</A><a name='837'>
                                h, th, qv, u, v, n, nl, debug, &amp;<a name='838'>
                                u_jet, rho_jet, th_jet, z_jet, &amp;<a name='839'>
                                jp, nz_jet, ny_jet, dry       )<a name='840'>
  implicit none<a name='841'>
  integer :: n, nl, jp, nz_jet, ny_jet<a name='842'>
<a name='843'>
  real, dimension(nz_jet, ny_jet) :: u_jet, rho_jet, th_jet, z_jet<a name='844'>
  real, dimension(n) :: h,th,qv,u,v<a name='845'>
  real :: p_surf, th_surf, qv_surf<a name='846'>
  logical :: debug, dry<a name='847'>
<a name='848'>
  real, dimension(1:nz_jet) :: rho, rel_hum, p<a name='849'>
  integer :: k<a name='850'>
<a name='851'>
<font color=#447700>!  some local stuff<a name='852'></font>
<a name='853'>
  real :: tmppi, es, qvs, temperature<a name='854'>
<a name='855'>
<font color=#447700>!  get sounding from column jp<a name='856'></font>
<a name='857'>
   do k=1,nz_jet<a name='858'>
     h(k)  = z_jet(k,jp)<a name='859'>
     th(k) = th_jet(k,jp)<a name='860'>
     qv(k) = 0.<a name='861'>
     rho(k) = rho_jet(k,jp)<a name='862'>
     u(k) = u_jet(k,jp)<a name='863'>
     v(k) = 0.<a name='864'>
   enddo<a name='865'>
<a name='866'>
   if (.not.dry) then<a name='867'>
     DO k=1,nz_jet<a name='868'>
       if(h(k) .gt. 8000.) then<a name='869'>
         rel_hum(k)=0.1<a name='870'>
       else<a name='871'>
         rel_hum(k)=(1.-0.90*(h(k)/8000.)**1.25)<a name='872'>
       end if<a name='873'>
       rel_hum(k) = min(0.7,rel_hum(k))<a name='874'>
     ENDDO<a name='875'>
   else<a name='876'>
     do k=1,nz_jet<a name='877'>
       rel_hum(k) = 0.<a name='878'>
     enddo<a name='879'>
   endif<a name='880'>
<a name='881'>
<font color=#447700>!  next, compute pressure<a name='882'></font>
<a name='883'>
   do k=1,nz_jet<a name='884'>
     p(k) = p1000mb*(R_d*rho(k)*th(k)/p1000mb)**cpovcv<a name='885'>
   enddo<a name='886'>
<a name='887'>
<font color=#447700>!  here we adjust for fixed moisture profile<a name='888'></font>
<a name='889'>
     IF (.not.dry)  THEN<a name='890'>
<a name='891'>
<font color=#447700>!  here we assume the input theta is th_v, so we reset theta accordingly<a name='892'></font>
<a name='893'>
       DO k=1,nz_jet<a name='894'>
         tmppi=(p(k)/p1000mb)**rcp<a name='895'>
         temperature = tmppi*th(k)<a name='896'>
         if (temperature .gt. svpt0) then<a name='897'>
            es  = 1000.*svp1*exp(svp2*(temperature-svpt0)/(temperature-svp3))<a name='898'>
            qvs = ep_2*es/(p(k)-es)<a name='899'>
         else<a name='900'>
            es  = 1000.*svp1*exp( 21.8745584*(temperature-273.16)/(temperature-7.66) )<a name='901'>
            qvs = ep_2*es/(p(k)-es)<a name='902'>
         endif<a name='903'>
         qv(k) = rel_hum(k)*qvs<a name='904'>
         th(k) = th(k)/(1.+.61*qv(k))<a name='905'>
       ENDDO<a name='906'>
 <a name='907'>
     ENDIF<a name='908'>
<a name='909'>
<font color=#447700>!  finally, set the surface data. We'll just do a simple extrapolation<a name='910'></font>
<a name='911'>
   p_surf = 1.5*p(1) - 0.5*p(2)<a name='912'>
   th_surf = 1.5*th(1) - 0.5*th(2)<a name='913'>
   qv_surf = 1.5*qv(1) - 0.5*qv(2)<a name='914'>
<a name='915'>
   end subroutine calc_jet_sounding<a name='916'>
<a name='917'>
<font color=#447700>!---------------------------------------------------------------------<a name='918'></font>
<a name='919'>
<A NAME='READ_INPUT_JET'><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#READ_INPUT_JET' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='920'>
 <font color=#993300>SUBROUTINE </font><font color=#cc0000>read_input_jet</font>( u, r, t, zk, nz, ny ) <A href='../../call_to/READ_INPUT_JET.html' TARGET='index'>2</A>,<A href='../../call_from/READ_INPUT_JET.html' TARGET='index'>4</A><a name='921'>
 implicit none<a name='922'>
<a name='923'>
 integer, intent(in) :: nz,ny<a name='924'>
 real, dimension(nz,ny), intent(out) :: u,r,t,zk<a name='925'>
 integer :: ny_in, nz_in, j,k<a name='926'>
 real, dimension(ny,nz) :: field_in<a name='927'>
<a name='928'>
<font color=#447700>! this code assumes it is called on processor 0 only<a name='929'></font>
<a name='930'>
   OPEN(unit=10, file='input_jet', form='unformatted', status='old' )<a name='931'>
   REWIND(10) <a name='932'>
   read(10) ny_in,nz_in<a name='933'>
   if((ny_in /= ny ) .or. (nz_in /= nz)) then<a name='934'>
     write(a_message,*) ' error in input jet dimensions '<a name='935'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#READ_INPUT_JET' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_3"> (a_message)<a name='936'>
     write(a_message,*) ' ny, ny_input, nz, nz_input ', ny, ny_in, nz,nz_in<a name='937'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#READ_INPUT_JET' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_4"> (a_message)<a name='938'>
     write(a_message,*) ' error exit '<a name='939'>
     CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_MESSAGE'>wrf_message</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#READ_INPUT_JET' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_MESSAGE_5"> (a_message)<a name='940'>
     call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/dyn_em/module_initialize_b_wave.F.html#READ_INPUT_JET' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_28"> ( ' error in input jet dimensions ' )<a name='941'>
   end if<a name='942'>
   read(10) field_in<a name='943'>
   do j=1,ny<a name='944'>
   do k=1,nz<a name='945'>
     u(k,j) = field_in(j,k)<a name='946'>
   enddo<a name='947'>
   enddo<a name='948'>
   read(10) field_in<a name='949'>
   do j=1,ny<a name='950'>
   do k=1,nz<a name='951'>
     t(k,j) = field_in(j,k)<a name='952'>
   enddo<a name='953'>
   enddo<a name='954'>
<a name='955'>
   read(10) field_in<a name='956'>
   do j=1,ny<a name='957'>
   do k=1,nz<a name='958'>
     r(k,j) = field_in(j,k)<a name='959'>
   enddo<a name='960'>
   enddo<a name='961'>
<a name='962'>
   do j=1,ny<a name='963'>
   do k=1,nz<a name='964'>
     zk(k,j) = 125. + 250.*float(k-1)<a name='965'>
   enddo<a name='966'>
   enddo<a name='967'>
<a name='968'>
 end subroutine read_input_jet<a name='969'>
<a name='970'>
END MODULE module_initialize_ideal<a name='971'>
</pre></body></html>