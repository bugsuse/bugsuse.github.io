<HTML> <BODY BGCOLOR=#ddeeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!WRF:MEDIATION_LAYER:SOLVER<a name='2'></font>
<a name='3'>
#define BENCH_START(A)<a name='4'>
#define BENCH_END(A)<a name='5'>
<a name='6'>
<A NAME='MODULE_FIRST_RK_STEP_PART1'><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#MODULE_FIRST_RK_STEP_PART1' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='7'>
<font color=#993300>MODULE </font><font color=#cc0000>module_first_rk_step_part1</font> <A href='../../call_to/MODULE_FIRST_RK_STEP_PART1.html' TARGET='index'>1</A><a name='8'>
<a name='9'>
CONTAINS<a name='10'>
<a name='11'>
<A NAME='FIRST_RK_STEP_PART1'><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='12'>
  <font color=#993300>SUBROUTINE </font><font color=#cc0000>first_rk_step_part1</font> (   grid , config_flags              &amp; <A href='../../call_to/FIRST_RK_STEP_PART1.html' TARGET='index'>1</A>,<A href='../../call_from/FIRST_RK_STEP_PART1.html' TARGET='index'>33</A><a name='13'>
                             , moist , moist_tend               &amp;<a name='14'>
                             , chem  , chem_tend                &amp;<a name='15'>
                             , tracer, tracer_tend              &amp;<a name='16'>
                             , scalar , scalar_tend             &amp;<a name='17'>
                             , fdda3d, fdda2d                   &amp;<a name='18'>
                             , aerod                            &amp;<a name='19'>
                             , ru_tendf, rv_tendf               &amp;<a name='20'>
                             , rw_tendf, t_tendf                &amp;<a name='21'>
                             , ph_tendf, mu_tendf               &amp;<a name='22'>
                             , tke_tend                         &amp;<a name='23'>
                             , adapt_step_flag , curr_secs      &amp;<a name='24'>
                             , psim , psih , wspd , gz1oz0 , chklowq &amp;<a name='25'>
                             , cu_act_flag , hol , th_phy       &amp;<a name='26'>
                             , pi_phy , p_phy , t_phy           &amp;<a name='27'>
                             , dz8w , p8w , t8w                 &amp;<a name='28'>
                             , ids, ide, jds, jde, kds, kde     &amp;<a name='29'>
                             , ims, ime, jms, jme, kms, kme     &amp;<a name='30'>
                             , ips, ipe, jps, jpe, kps, kpe     &amp;<a name='31'>
                             , imsx,imex,jmsx,jmex,kmsx,kmex    &amp;<a name='32'>
                             , ipsx,ipex,jpsx,jpex,kpsx,kpex    &amp;<a name='33'>
                             , imsy,imey,jmsy,jmey,kmsy,kmey    &amp;<a name='34'>
                             , ipsy,ipey,jpsy,jpey,kpsy,kpey    &amp;<a name='35'>
                             , k_start , k_end                  &amp;<a name='36'>
                             , f_flux                           &amp;<a name='37'>
                            )<a name='38'>
    USE <A href='../../html_code/frame/module_state_description.F.html#MODULE_STATE_DESCRIPTION'>module_state_description</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_STATE_DESCRIPTION_7"><a name='39'>
    USE <A href='../../html_code/share/module_model_constants.F.html#MODULE_MODEL_CONSTANTS'>module_model_constants</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_MODEL_CONSTANTS_7"><a name='40'>
    USE <A href='../../html_code/frame/module_domain.F.html#MODULE_DOMAIN'>module_domain</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DOMAIN_10">, ONLY : domain, domain_clock_get, get_ijk_from_subgrid<a name='41'>
    USE <A href='../../html_code/frame/module_configure.F.html#MODULE_CONFIGURE'>module_configure</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CONFIGURE_8">, ONLY : grid_config_rec_type, model_config_rec<a name='42'>
    USE <A href='../../html_code/phys/module_radiation_driver.F.html#MODULE_RADIATION_DRIVER'>module_radiation_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_RADIATION_DRIVER_1">, ONLY : pre_radiation_driver, radiation_driver<a name='43'>
    USE <A href='../../html_code/phys/module_surface_driver.F.html#MODULE_SURFACE_DRIVER'>module_surface_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SURFACE_DRIVER_1">, ONLY : surface_driver<a name='44'>
    USE <A href='../../html_code/phys/module_cumulus_driver.F.html#MODULE_CUMULUS_DRIVER'>module_cumulus_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CUMULUS_DRIVER_1">, ONLY : cumulus_driver<a name='45'>
    USE <A href='../../html_code/phys/module_shallowcu_driver.F.html#MODULE_SHALLOWCU_DRIVER'>module_shallowcu_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SHALLOWCU_DRIVER_1">, ONLY : shallowcu_driver<a name='46'>
    USE <A href='../../html_code/phys/module_pbl_driver.F.html#MODULE_PBL_DRIVER'>module_pbl_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_PBL_DRIVER_1">, ONLY : pbl_driver<a name='47'>
    USE <A href='../../html_code/phys/module_fr_fire_driver_wrf.F.html#MODULE_FR_FIRE_DRIVER_WRF'>module_fr_fire_driver_wrf</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_FR_FIRE_DRIVER_WRF_1">, ONLY : fire_driver_em_step<a name='48'>
    USE <A href='../../html_code/phys/module_fddagd_driver.F.html#MODULE_FDDAGD_DRIVER'>module_fddagd_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_FDDAGD_DRIVER_1">, ONLY : fddagd_driver<a name='49'>
    USE <A href='../../html_code/dyn_em/module_em.F.html#MODULE_EM'>module_em</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_EM_1">, ONLY : init_zero_tendency<a name='50'>
    USE <A href='../../html_code/dyn_em/module_force_scm.F.html#MODULE_FORCE_SCM'>module_force_scm</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_FORCE_SCM_1"><a name='51'>
    USE <A href='../../html_code/dyn_em/module_convtrans_prep.F.html#MODULE_CONVTRANS_PREP'>module_convtrans_prep</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_CONVTRANS_PREP_1"><a name='52'>
    USE <A href='../../html_code/dyn_em/module_big_step_utilities_em.F.html#MODULE_BIG_STEP_UTILITIES_EM'>module_big_step_utilities_em</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_BIG_STEP_UTILITIES_EM_3">, ONLY : phy_prep<a name='53'>
<font color=#447700>!use module_scalar_tables<a name='54'></font>
#ifdef DM_PARALLEL<a name='55'>
    USE <A href='../../html_code/frame/module_dm_stubs.F.html#MODULE_DM'>module_dm</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DM_6">, ONLY : local_communicator, mytask, ntasks, ntasks_x, ntasks_y, local_communicator_periodic, wrf_dm_maxval<a name='56'>
    USE <A href='../../html_code/frame/module_comm_dm.F.html#MODULE_COMM_DM'>module_comm_dm</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_COMM_DM_3">, ONLY : halo_em_phys_a_sub,halo_em_fdda_sfc_sub,halo_pwp_sub,halo_em_chem_e_3_sub, &amp;<a name='57'>
    halo_em_chem_e_5_sub, halo_em_hydro_noahmp_sub<a name='58'>
#endif<a name='59'>
    USE module_utility<a name='60'>
    IMPLICIT NONE<a name='61'>
<a name='62'>
    TYPE ( domain ), INTENT(INOUT) :: grid<a name='63'>
    TYPE ( grid_config_rec_type ), INTENT(IN) :: config_flags<a name='64'>
    TYPE(WRFU_Time)                :: currentTime<a name='65'>
<a name='66'>
    INTEGER, INTENT(IN) :: ids, ide, jds, jde, kds, kde,     &amp;<a name='67'>
                           ims, ime, jms, jme, kms, kme,     &amp;<a name='68'>
                           ips, ipe, jps, jpe, kps, kpe,     &amp;<a name='69'>
                           imsx,imex,jmsx,jmex,kmsx,kmex,    &amp;<a name='70'>
                           ipsx,ipex,jpsx,jpex,kpsx,kpex,    &amp;<a name='71'>
                           imsy,imey,jmsy,jmey,kmsy,kmey,    &amp;<a name='72'>
                           ipsy,ipey,jpsy,jpey,kpsy,kpey<a name='73'>
<a name='74'>
<a name='75'>
    LOGICAL ,INTENT(IN)                        :: adapt_step_flag<a name='76'>
    REAL, INTENT(IN)                           :: curr_secs<a name='77'>
<a name='78'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme,num_moist),INTENT(INOUT)   :: moist<a name='79'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme,num_moist),INTENT(INOUT)   :: moist_tend<a name='80'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme,num_chem),INTENT(INOUT)   :: chem<a name='81'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme,num_chem),INTENT(INOUT)   :: chem_tend<a name='82'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme,num_tracer),INTENT(INOUT)   :: tracer<a name='83'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme,num_tracer),INTENT(INOUT)   :: tracer_tend<a name='84'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme,num_scalar),INTENT(INOUT)   :: scalar<a name='85'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme,num_scalar),INTENT(INOUT)   :: scalar_tend<a name='86'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme,num_fdda3d),INTENT(INOUT)  :: fdda3d<a name='87'>
    REAL    ,DIMENSION(ims:ime,1:1,jms:jme,num_fdda2d),INTENT(INOUT)      :: fdda2d<a name='88'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme,num_aerod),INTENT(INOUT)   :: aerod<a name='89'>
    REAL    ,DIMENSION(ims:ime,jms:jme), INTENT(INOUT)         :: psim<a name='90'>
    REAL    ,DIMENSION(ims:ime,jms:jme), INTENT(INOUT)         :: psih<a name='91'>
    REAL    ,DIMENSION(ims:ime,jms:jme), INTENT(INOUT)         :: wspd<a name='92'>
    REAL    ,DIMENSION(ims:ime,jms:jme), INTENT(INOUT)         :: gz1oz0<a name='93'>
    REAL    ,DIMENSION(ims:ime,jms:jme), INTENT(INOUT)         :: chklowq<a name='94'>
    LOGICAL ,DIMENSION(ims:ime,jms:jme), INTENT(INOUT)         :: cu_act_flag<a name='95'>
    REAL    ,DIMENSION(ims:ime,jms:jme), INTENT(INOUT)         :: hol<a name='96'>
<a name='97'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: th_phy<a name='98'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: pi_phy<a name='99'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: p_phy<a name='100'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: t_phy<a name='101'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: dz8w<a name='102'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: p8w<a name='103'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: t8w<a name='104'>
<a name='105'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: ru_tendf<a name='106'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: rv_tendf<a name='107'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: rw_tendf<a name='108'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: ph_tendf<a name='109'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: t_tendf<a name='110'>
    REAL    ,DIMENSION(ims:ime,kms:kme,jms:jme), INTENT(INOUT) :: tke_tend<a name='111'>
<a name='112'>
    REAL    ,DIMENSION(ims:ime,jms:jme), INTENT(INOUT) :: mu_tendf<a name='113'>
<a name='114'>
    INTEGER, INTENT(IN)                           ::  k_start, k_end<a name='115'>
    LOGICAL, INTENT(IN), OPTIONAL                 ::  f_flux<a name='116'>
<a name='117'>
<font color=#447700>! Local<a name='118'></font>
    real :: HYDRO_dt<a name='119'>
    REAL, DIMENSION( ims:ime, jms:jme ) :: exch_temf  <font color=#447700>! 1/7/09 WA<a name='120'></font>
<a name='121'>
    REAL, DIMENSION( ims:ime, jms:jme ) :: ht_loc, mixht<a name='122'>
<a name='123'>
    INTEGER                             :: ij<a name='124'>
    INTEGER  num_roof_layers<a name='125'>
    INTEGER  num_wall_layers<a name='126'>
    INTEGER  num_road_layers<a name='127'>
    INTEGER  iswater<a name='128'>
    LOGICAL  :: l_flux<a name='129'>
    INTEGER  :: isurban<a name='130'>
    INTEGER  rk_step<a name='131'>
    INTEGER                         :: yr, month, day, hr, minute, sec, rc<a name='132'>
    CHARACTER*80                    :: mesg<a name='133'>
<a name='134'>
   INTEGER                         :: sids , side , sjds , sjde , skds , skde , &amp;<a name='135'>
                                      sims , sime , sjms , sjme , skms , skme , &amp;<a name='136'>
                                      sips , sipe , sjps , sjpe , skps , skpe<a name='137'>
<a name='138'>
   CHARACTER (LEN=256) :: mminlu<a name='139'>
   CHARACTER (LEN=1000) :: message<a name='140'>
<a name='141'>
#if ( WRF_DFI_RADAR == 1 )<a name='142'>
    INTEGER  do_capsupress   <font color=#447700>! =1 do CAP supress, other = don't<a name='143'></font>
#endif<a name='144'>
<a name='145'>
  CALL <A href='../../html_code/frame/module_domain.F.html#GET_IJK_FROM_SUBGRID'>get_ijk_from_subgrid</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_IJK_FROM_SUBGRID_1"> (  grid ,                   &amp;<a name='146'>
                            sids, side, sjds, sjde, skds, skde,    &amp;<a name='147'>
                            sims, sime, sjms, sjme, skms, skme,    &amp;<a name='148'>
                            sips, sipe, sjps, sjpe, skps, skpe    )<a name='149'>
<a name='150'>
 <font color=#447700>! initialize all tendencies to zero in order to update physics<a name='151'></font>
 <font color=#447700>! tendencies first (separate from dry dynamics).<a name='152'></font>
<a name='153'>
   l_flux=.FALSE.<a name='154'>
   if (present(f_flux)) l_flux=f_flux<a name='155'>
<a name='156'>
    rk_step = 1<a name='157'>
<a name='158'>
BENCH_START(init_zero_tend_tim)<a name='159'>
       <font color=#447700>!$OMP PARALLEL DO   &amp;<a name='160'></font>
       <font color=#447700>!$OMP PRIVATE ( ij )<a name='161'></font>
<a name='162'>
       DO ij = 1 , grid%num_tiles<a name='163'>
<a name='164'>
         CALL wrf_debug ( 200 , ' call init_zero_tendency' )<a name='165'>
         CALL <A href='../../html_code/dyn_em/module_em.F.html#INIT_ZERO_TENDENCY'>init_zero_tendency</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="INIT_ZERO_TENDENCY_1"> ( ru_tendf, rv_tendf, rw_tendf,     &amp;<a name='166'>
                                   ph_tendf, t_tendf, tke_tend,      &amp;<a name='167'>
                                   mu_tendf,                         &amp;<a name='168'>
                                   moist_tend,chem_tend,scalar_tend, &amp;<a name='169'>
                                   tracer_tend,num_tracer,           &amp;<a name='170'>
                                   num_moist,num_chem,num_scalar,    &amp;<a name='171'>
                                   rk_step,                          &amp;<a name='172'>
                                   ids, ide, jds, jde, kds, kde,     &amp;<a name='173'>
                                   ims, ime, jms, jme, kms, kme,     &amp;<a name='174'>
                                   grid%i_start(ij), grid%i_end(ij), &amp;<a name='175'>
                                   grid%j_start(ij), grid%j_end(ij), &amp;<a name='176'>
                                   k_start, k_end                   )<a name='177'>
<a name='178'>
       END DO<a name='179'>
       <font color=#447700>!$OMP END PARALLEL DO<a name='180'></font>
BENCH_END(init_zero_tend_tim)<a name='181'>
<a name='182'>
#ifdef DM_PARALLEL<a name='183'>
#     include "<A href='../../html_code/include/HALO_EM_PHYS_A.inc.html'>HALO_EM_PHYS_A.inc</A>"<A NAME="HALO_EM_PHYS_A.inc_1"><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='184'>
#endif<a name='185'>
<a name='186'>
      <font color=#447700>!$OMP PARALLEL DO   &amp;<a name='187'></font>
      <font color=#447700>!$OMP PRIVATE ( ij )<a name='188'></font>
      DO ij = 1 , grid%num_tiles<a name='189'>
<a name='190'>
        CALL wrf_debug ( 200 , ' call phy_prep' )<a name='191'>
        CALL <A href='../../html_code/dyn_em/module_big_step_utilities_em.F.html#PHY_PREP'>phy_prep</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PHY_PREP_1"> ( config_flags,                                    &amp;<a name='192'>
                        grid%mut, grid%muu, grid%muv,                    &amp;<a name='193'>
                        grid%c1h, grid%c2h, grid%c1f, grid%c2f,          &amp;<a name='194'>
                        grid%u_2, grid%v_2, grid%p, grid%pb, grid%alt,   &amp;<a name='195'>
                        grid%ph_2, grid%phb, grid%t_2, moist, num_moist, &amp;<a name='196'>
                        grid%rho,th_phy, p_phy, pi_phy, grid%u_phy, grid%v_phy,      &amp;<a name='197'>
                        p8w, t_phy, t8w, grid%z, grid%z_at_w, dz8w,      &amp;<a name='198'>
                        grid%p_hyd, grid%p_hyd_w, grid%dnw,              &amp;<a name='199'>
                        grid%fnm, grid%fnp, grid%znw, grid%p_top,        &amp;<a name='200'>
                        ids, ide, jds, jde, kds, kde,                    &amp;<a name='201'>
                        ims, ime, jms, jme, kms, kme,                    &amp;<a name='202'>
                        grid%i_start(ij), grid%i_end(ij),                &amp;<a name='203'>
                        grid%j_start(ij), grid%j_end(ij),                &amp;<a name='204'>
                        k_start, k_end                                   )<a name='205'>
      ENDDO<a name='206'>
      <font color=#447700>!$OMP END PARALLEL DO<a name='207'></font>
<a name='208'>
BENCH_END(phy_prep_tim)<a name='209'>
<a name='210'>
<font color=#447700>! radiation<a name='211'></font>
     CALL <A href='../../html_code/frame/module_domain.F.html#DOMAIN_CLOCK_GET'>domain_clock_get</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DOMAIN_CLOCK_GET_2">( grid, current_time=currentTime, &amp;<a name='212'>
                            current_timestr=mesg )<a name='213'>
     CALL WRFU_TimeGet( currentTime, YY=yr, dayOfYear=day, H=hr, M=minute, S=sec, rc=rc)<a name='214'>
         IF( rc/= WRFU_SUCCESS)THEN<a name='215'>
         CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_22">('WRFU_TimeGet failed')<a name='216'>
         ENDIF<a name='217'>
<a name='218'>
<font color=#447700>! this driver is only needed to handle non-local shadowing effects<a name='219'></font>
      CALL <A href='../../html_code/phys/module_radiation_driver.F.html#PRE_RADIATION_DRIVER'>pre_radiation_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PRE_RADIATION_DRIVER_1"> ( grid, config_flags                        &amp;<a name='220'>
     &amp;        ,itimestep=grid%itimestep, ra_call_offset=grid%ra_call_offset    &amp;<a name='221'>
     &amp;        ,XLAT=grid%xlat, XLONG=grid%xlong, GMT=grid%gmt                  &amp;<a name='222'>
     &amp;        ,julian=grid%julian, xtime=grid%xtime, RADT=grid%radt            &amp;<a name='223'>
     &amp;        ,STEPRA=grid%stepra                                              &amp;<a name='224'>
     &amp;        ,ht=grid%ht,dx=grid%dx,dy=grid%dy,sina=grid%sina,cosa=grid%cosa  &amp;<a name='225'>
     &amp;        ,shadowmask=grid%shadowmask,slope_rad=config_flags%slope_rad     &amp;<a name='226'>
     &amp;        ,topo_shading=config_flags%topo_shading                          &amp;<a name='227'>
     &amp;        ,shadlen=config_flags%shadlen,ht_shad=grid%ht_shad,ht_loc=ht_loc &amp;<a name='228'>
     &amp;        ,ht_shad_bxs=grid%ht_shad_bxs, ht_shad_bxe=grid%ht_shad_bxe      &amp;<a name='229'>
     &amp;        ,ht_shad_bys=grid%ht_shad_bys, ht_shad_bye=grid%ht_shad_bye      &amp;<a name='230'>
     &amp;        ,nested=config_flags%nested, min_ptchsz=grid%min_ptchsz          &amp;<a name='231'>
     &amp;        ,spec_bdy_width=config_flags%spec_bdy_width                      &amp;<a name='232'>
            <font color=#447700>! indexes<a name='233'></font>
     &amp;        ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde          &amp;<a name='234'>
     &amp;        ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme          &amp;<a name='235'>
     &amp;        ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe          &amp;<a name='236'>
     &amp;        ,i_start=grid%i_start,i_end=min(grid%i_end, ide-1)          &amp;<a name='237'>
     &amp;        ,j_start=grid%j_start,j_end=min(grid%j_end, jde-1)          &amp;<a name='238'>
     &amp;        ,kts=k_start, kte=min(k_end,kde-1)                          &amp;<a name='239'>
     &amp;        ,num_tiles=grid%num_tiles                                   )<a name='240'>
<a name='241'>
      CALL wrf_debug ( 200 , ' call radiation_driver' )<a name='242'>
BENCH_START(rad_driver_tim)<a name='243'>
<a name='244'>
      CALL <A href='../../html_code/phys/module_radiation_driver.F.html#RADIATION_DRIVER'>radiation_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="RADIATION_DRIVER_1">(                                                  &amp;<a name='245'>
     &amp;         p_top=grid%p_top &amp; <font color=#447700>!DJW 140312 added p_top for vertical nesting<a name='246'></font>
     &amp;        ,ACFRCV=grid%acfrcv      ,ACFRST=grid%acfrst      ,ALBEDO=grid%albedo  &amp;<a name='247'>
     &amp;        ,CFRACH=grid%cfrach      ,CFRACL=grid%cfracl      ,CFRACM=grid%cfracm  &amp;<a name='248'>
     &amp;        ,CUPPT=grid%cuppt        ,CZMEAN=grid%czmean      ,DT=grid%dt          &amp;<a name='249'>
     &amp;        ,DZ8W=dz8w               ,EMISS=grid%emiss        ,GLW=grid%glw        &amp;<a name='250'>
     &amp;        ,GMT=grid%gmt            ,GSW=grid%gsw            ,HBOT=grid%hbot      &amp;<a name='251'>
     &amp;        ,HTOP=grid%htop          ,HBOTR=grid%hbotr        ,HTOPR=grid%htopr    &amp;<a name='252'>
     &amp;        ,ICLOUD=config_flags%icloud                                            &amp;<a name='253'>
     &amp;        ,ITIMESTEP=grid%itimestep,JULDAY=grid%julday      , JULIAN=grid%julian &amp;<a name='254'>
     &amp;        ,JULYR=grid%julyr        ,LW_PHYSICS=config_flags%ra_lw_physics        &amp;<a name='255'>
     &amp;        ,NCFRCV=grid%ncfrcv      ,NCFRST=grid%ncfrst      ,NPHS=1              &amp;<a name='256'>
     &amp;        ,o3input=config_flags%o3input     ,O3rad=grid%o3rad                    &amp;<a name='257'>
     &amp;        ,aer_opt=config_flags%aer_opt ,aerod=aerod(:,:,:,P_ocarbon:P_upperaer) &amp;<a name='258'>
     &amp;        ,swint_opt=config_flags%swint_opt                                      &amp;<a name='259'>
     &amp;        ,P8W=grid%p_hyd_w        ,P=grid%p_hyd            ,PI=pi_phy           &amp;<a name='260'>
     &amp;        ,RADT=grid%radt          ,RA_CALL_OFFSET=grid%ra_call_offset           &amp;<a name='261'>
     &amp;        ,RHO=grid%rho            ,RLWTOA=grid%rlwtoa                           &amp;<a name='262'>
     &amp;        ,RSWTOA=grid%rswtoa      ,RTHRATEN=grid%rthraten                       &amp;<a name='263'>
     &amp;        ,RTHRATENLW=grid%rthratenlw       ,RTHRATENSW=grid%rthratensw          &amp;<a name='264'>
     &amp;        ,SNOW=grid%snow          ,STEPRA=grid%stepra      ,SWDOWN=grid%swdown  &amp;<a name='265'>
     &amp;        ,SWDOWNC=grid%swdownc    ,SW_PHYSICS=config_flags%ra_sw_physics        &amp;<a name='266'>
     &amp;        ,T8W=t8w                 ,T=grid%t_phy           ,TAUCLDC=grid%taucldc &amp;<a name='267'>
     &amp;        ,TAUCLDI=grid%taucldi    ,TSK=grid%tsk            ,VEGFRA=grid%vegfra  &amp;<a name='268'>
     &amp;        ,WARM_RAIN=grid%warm_rain ,XICE=grid%xice         ,XLAND=grid%xland    &amp;<a name='269'>
     &amp;        ,XLAT=grid%xlat          ,XLONG=grid%xlong        ,YR=yr               &amp;<a name='270'>
           <font color=#447700>! SSiB LSM radiation components (fds 06/2010)<a name='271'></font>
     &amp;        ,ALSWVISDIR=grid%alswvisdir ,ALSWVISDIF=grid%alswvisdif      &amp;  <font color=#447700>!ssib <a name='272'></font>
     &amp;        ,ALSWNIRDIR=grid%alswnirdir ,ALSWNIRDIF=grid%alswnirdif      &amp;  <font color=#447700>!ssib<a name='273'></font>
     &amp;        ,SWVISDIR=grid%swvisdir ,SWVISDIF=grid%swvisdif              &amp;  <font color=#447700>!ssib<a name='274'></font>
     &amp;        ,SWNIRDIR=grid%swnirdir ,SWNIRDIF=grid%swnirdif              &amp;  <font color=#447700>!ssib<a name='275'></font>
     &amp;        ,SF_SURFACE_PHYSICS=config_flags%sf_surface_physics          &amp;  <font color=#447700>!ssib<a name='276'></font>
<font color=#447700>! WRF-solar and aerosol variables from jararias 2013/8 and 2013/11<a name='277'></font>
     &amp;       ,SWDDIR=grid%swddir,SWDDNI=grid%swddni,SWDDIF=grid%swddif                              &amp; <a name='278'>
     &amp;       ,Gx=grid%Gx,Bx=grid%Bx,gg=grid%gg,bb=grid%bb                                           &amp;<a name='279'>
     &amp;       ,swdown_ref=grid%swdown_ref,swddir_ref=grid%swddir_ref                                 &amp;<a name='280'>
     &amp;       ,coszen_ref=grid%coszen_ref                                                            &amp;<a name='281'>
     &amp;       ,aer_type=config_flags%aer_type                                                        &amp;<a name='282'>
     &amp;       ,aer_aod550_opt=config_flags%aer_aod550_opt,aer_aod550_val=config_flags%aer_aod550_val &amp;<a name='283'>
     &amp;       ,aer_angexp_opt=config_flags%aer_angexp_opt,aer_angexp_val=config_flags%aer_angexp_val &amp;<a name='284'>
     &amp;       ,aer_ssa_opt=config_flags%aer_ssa_opt,aer_ssa_val=config_flags%aer_ssa_val             &amp;<a name='285'>
     &amp;       ,aer_asy_opt=config_flags%aer_asy_opt,aer_asy_val=config_flags%aer_asy_val             &amp;<a name='286'>
     &amp;       ,aod5502d=grid%aod5502d,angexp2d=grid%angexp2d,aerssa2d=grid%aerssa2d                  &amp;<a name='287'>
     &amp;       ,aerasy2d=grid%aerasy2d,aod5503d=grid%aod5503d                                         &amp;<a name='288'>
     &amp;       ,taod5502d=grid%taod5502d,taod5503d=grid%taod5503d                                     &amp; <font color=#447700>! Trude<a name='289'></font>
<font color=#447700>!Optional solar variables<a name='290'></font>
     &amp;        ,DECLINX=grid%declin ,SOLCONX=grid%solcon ,COSZEN=grid%coszen ,HRANG=grid%hrang    &amp;<a name='291'>
     &amp;        , CEN_LAT=grid%cen_lat                                      &amp;<a name='292'>
     &amp;        ,Z=grid%z                                                   &amp;<a name='293'>
     &amp;        ,ALEVSIZ=grid%alevsiz, no_src_types=grid%no_src_types       &amp;<a name='294'>
     &amp;        ,LEVSIZ=grid%levsiz, N_OZMIXM=num_ozmixm                    &amp;<a name='295'>
     &amp;        ,N_AEROSOLC=num_aerosolc                                    &amp;<a name='296'>
     &amp;        ,PAERLEV=grid%paerlev   ,ID=grid%id                         &amp;<a name='297'>
     &amp;        ,CAM_ABS_DIM1=grid%cam_abs_dim1, CAM_ABS_DIM2=grid%cam_abs_dim2 &amp;<a name='298'>
     &amp;        ,CAM_ABS_FREQ_S=grid%cam_abs_freq_s                         &amp;<a name='299'>
     &amp;        ,XTIME=grid%xtime                                                &amp;<a name='300'>
              ,CURR_SECS=curr_secs, ADAPT_STEP_FLAG=adapt_step_flag       &amp;<a name='301'>
<font color=#447700>!BSINGH - For WRFCuP scheme<a name='302'></font>
     &amp;        ,CU_PHYSICS=config_flags%cu_physics                         &amp; <font color=#447700>!CuP, wig 5-Oct-2006<a name='303'></font>
     &amp;        ,SHALLOWCU_FORCED_RA=config_flags%shallowcu_forced_ra       &amp; <font color=#447700>!CuP, wig<a name='304'></font>
     &amp;        ,CUBOT=grid%cubot, CUTOP=grid%cutop                         &amp; <font color=#447700>!CuP, wig 9-Oct-2006<a name='305'></font>
     &amp;        ,CLDFRA_CUP=grid%cldfra_cup                                 &amp; <font color=#447700>!CuP, wig 1-Oct-2006<a name='306'></font>
     &amp;        ,SHALL=grid%shall                                           &amp; <font color=#447700>!CuP, wig 4-Feb-2008<a name='307'></font>
<font color=#447700>!BSINGH - ENDS<a name='308'></font>
            <font color=#447700>! indexes<a name='309'></font>
     &amp;        ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde          &amp;<a name='310'>
     &amp;        ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme          &amp;<a name='311'>
     &amp;        ,i_start=grid%i_start,i_end=min(grid%i_end, ide-1)          &amp;<a name='312'>
     &amp;        ,j_start=grid%j_start,j_end=min(grid%j_end, jde-1)          &amp;<a name='313'>
     &amp;        ,kts=k_start, kte=min(k_end,kde-1)                          &amp;<a name='314'>
     &amp;        ,num_tiles=grid%num_tiles                                   &amp;<a name='315'>
            <font color=#447700>! Optional<a name='316'></font>
<font color=#447700>!JJS 20101020 vvvvv<a name='317'></font>
     &amp;        , TLWDN=grid%tlwdn, TLWUP=grid%tlwup                        &amp; <font color=#447700>! goddard schemes<a name='318'></font>
     &amp;        , SLWDN=grid%slwdn, SLWUP=grid%slwup                        &amp; <font color=#447700>! goddard schemes<a name='319'></font>
     &amp;        , TSWDN=grid%tswdn, TSWUP=grid%tswup                        &amp; <font color=#447700>! goddard schemes<a name='320'></font>
     &amp;        , SSWDN=grid%sswdn, SSWUP=grid%sswup                        &amp; <font color=#447700>! goddard schemes<a name='321'></font>
<font color=#447700>!JJS 20101020 ^^^^^<a name='322'></font>
<font color=#447700>!ZCX+ cloud fraction for CLWRF<a name='323'></font>
     &amp;        , CLDT=grid%cldt, ZNU=grid%znu                              &amp;<a name='324'>
<font color=#447700>!ZCX-<a name='325'></font>
     &amp;        , CLDFRA=grid%cldfra, CLDFRA_MP_ALL=grid%cldfra_mp_all      &amp;<a name='326'>
     &amp;        , LRADIUS=grid%LRADIUS,IRADIUS=grid%IRADIUS                 &amp; <font color=#447700>!BSINGH(01/22/2014)<a name='327'></font>
     &amp;        , CLDFRA_DP=grid%cldfra_dp                                  &amp; <font color=#447700>! ckay for subgrid cloud<a name='328'></font>
     &amp;        , CLDFRA_SH=grid%cldfra_sh                                  &amp;<a name='329'>
     &amp;        , icloud_bl=config_flags%icloud_bl                          &amp; <font color=#447700>!JOE: subgrid BL clouds<a name='330'></font>
     &amp;        , qc_bl=grid%qc_bl,cldfra_bl=grid%cldfra_bl                 &amp; <font color=#447700>!JOE: subgrid bl clouds<a name='331'></font>
     &amp;        , re_cloud=grid%re_cloud, re_ice=grid%re_ice, re_snow=grid%re_snow &amp; <font color=#447700>! G. Thompson<a name='332'></font>
     &amp;        , has_reqc=grid%has_reqc, has_reqi=grid%has_reqi, has_reqs=grid%has_reqs &amp; <font color=#447700>! G. Thompson<a name='333'></font>
     &amp;        , PB=grid%pb                                                &amp;<a name='334'>
     &amp;        , F_ICE_PHY=grid%f_ice_phy,F_RAIN_PHY=grid%f_rain_phy       &amp;<a name='335'>
     &amp;        , QV=moist(ims,kms,jms,P_QV), F_QV=F_QV                     &amp;<a name='336'>
     &amp;        , QC=moist(ims,kms,jms,P_QC), F_QC=F_QC                     &amp;<a name='337'>
     &amp;        , QR=moist(ims,kms,jms,P_QR), F_QR=F_QR                     &amp;<a name='338'>
     &amp;        , QI=moist(ims,kms,jms,P_QI), F_QI=F_QI                     &amp;<a name='339'>
     &amp;        , QS=moist(ims,kms,jms,P_QS), F_QS=F_QS                     &amp;<a name='340'>
     &amp;        , QG=moist(ims,kms,jms,P_QG), F_QG=F_QG                     &amp;<a name='341'>
     &amp;        , QNDROP=scalar(ims,kms,jms,P_QNDROP), F_QNDROP=F_QNDROP    &amp;<a name='342'>
     &amp;        ,QNIFA=scalar(ims,kms,jms,P_QNIFA),F_QNIFA=F_QNIFA          &amp; <font color=#447700>!Trude<a name='343'></font>
     &amp;        ,QNWFA=scalar(ims,kms,jms,P_QNWFA),F_QNWFA=F_QNWFA          &amp; <font color=#447700>!Trude<a name='344'></font>
     &amp;        ,ACSWUPT=grid%acswupt    ,ACSWUPTC=grid%acswuptc            &amp;<a name='345'>
     &amp;        ,ACSWDNT=grid%acswdnt    ,ACSWDNTC=grid%acswdntc            &amp;<a name='346'>
     &amp;        ,ACSWUPB=grid%acswupb    ,ACSWUPBC=grid%acswupbc            &amp;<a name='347'>
     &amp;        ,ACSWDNB=grid%acswdnb    ,ACSWDNBC=grid%acswdnbc            &amp;<a name='348'>
     &amp;        ,ACLWUPT=grid%aclwupt    ,ACLWUPTC=grid%aclwuptc            &amp;<a name='349'>
     &amp;        ,ACLWDNT=grid%aclwdnt    ,ACLWDNTC=grid%aclwdntc            &amp;<a name='350'>
     &amp;        ,ACLWUPB=grid%aclwupb    ,ACLWUPBC=grid%aclwupbc            &amp;<a name='351'>
     &amp;        ,ACLWDNB=grid%aclwdnb    ,ACLWDNBC=grid%aclwdnbc            &amp;<a name='352'>
     &amp;        ,SWUPT=grid%swupt    ,SWUPTC=grid%swuptc                    &amp;<a name='353'>
     &amp;        ,SWDNT=grid%swdnt    ,SWDNTC=grid%swdntc                    &amp;<a name='354'>
     &amp;        ,SWUPB=grid%swupb    ,SWUPBC=grid%swupbc                    &amp;<a name='355'>
     &amp;        ,SWDNB=grid%swdnb    ,SWDNBC=grid%swdnbc                    &amp;<a name='356'>
     &amp;        ,LWUPT=grid%lwupt    ,LWUPTC=grid%lwuptc                    &amp;<a name='357'>
     &amp;        ,LWDNT=grid%lwdnt    ,LWDNTC=grid%lwdntc                    &amp;<a name='358'>
     &amp;        ,LWUPB=grid%lwupb    ,LWUPBC=grid%lwupbc                    &amp;<a name='359'>
     &amp;        ,LWDNB=grid%lwdnb    ,LWDNBC=grid%lwdnbc                    &amp;<a name='360'>
     &amp;        ,LWCF=grid%lwcf                                                  &amp;<a name='361'>
     &amp;        ,SWCF=grid%swcf                                                  &amp;<a name='362'>
     &amp;        ,OLR=grid%olr                                                    &amp;<a name='363'>
     &amp;        ,AERODM=grid%aerodm, PINA=grid%pina, AODTOT=grid%aodtot          &amp;<a name='364'>
     &amp;        ,OZMIXM=grid%ozmixm, PIN=grid%pin                                &amp;<a name='365'>
     &amp;        ,M_PS_1=grid%m_ps_1, M_PS_2=grid%m_ps_2, AEROSOLC_1=grid%aerosolc_1        &amp;<a name='366'>
     &amp;        ,AEROSOLC_2=grid%aerosolc_2, M_HYBI0=grid%m_hybi                      &amp;<a name='367'>
     &amp;        ,ABSTOT=grid%abstot, ABSNXT=grid%absnxt, EMSTOT=grid%emstot                &amp;<a name='368'>
     &amp;        ,RADTACTTIME=grid%radtacttime                                         &amp;  <a name='369'>
     &amp;        ,ICLOUD_CU=config_flags%ICLOUD_CU                            &amp;<a name='370'>
     &amp;        ,QC_CU=grid%QC_CU , QI_CU=grid%QI_CU                         &amp;<a name='371'>
#if (WRF_CHEM == 1)<a name='372'>
     &amp;        ,AER_RA_FEEDBACK=config_flags%aer_ra_feedback                &amp;<a name='373'>
     &amp;        ,PM2_5_DRY=grid%pm2_5_dry, PM2_5_WATER=grid%pm2_5_water               &amp;<a name='374'>
     &amp;        ,PM2_5_DRY_EC=grid%pm2_5_dry_ec                                  &amp;<a name='375'>
     &amp;        ,TAUAER300=grid%tauaer1, TAUAER400=grid%tauaer2 &amp; <font color=#447700>! jcb<a name='376'></font>
     &amp;        ,TAUAER600=grid%tauaer3, TAUAER999=grid%tauaer4 &amp; <font color=#447700>! jcb<a name='377'></font>
     &amp;        ,GAER300=grid%gaer1, GAER400=grid%gaer2, GAER600=grid%gaer3, GAER999=grid%gaer4 &amp; <font color=#447700>! jcb<a name='378'></font>
     &amp;        ,WAER300=grid%waer1, WAER400=grid%waer2, WAER600=grid%waer3, WAER999=grid%waer4 &amp; <font color=#447700>! jcb<a name='379'></font>
     &amp;        ,TAUAERlw1  =grid%tauaerlw1,  TAUAERlw2=grid%tauaerlw2    &amp; <a name='380'>
     &amp;        ,TAUAERlw3  =grid%tauaerlw3,  TAUAERlw4=grid%tauaerlw4    &amp; <a name='381'>
     &amp;        ,TAUAERlw5  =grid%tauaerlw5,  TAUAERlw6=grid%tauaerlw6    &amp; <a name='382'>
     &amp;        ,TAUAERlw7  =grid%tauaerlw7,  TAUAERlw8=grid%tauaerlw8    &amp; <a name='383'>
     &amp;        ,TAUAERlw9  =grid%tauaerlw9,  TAUAERlw10=grid%tauaerlw10    &amp; <a name='384'>
     &amp;        ,TAUAERlw11 =grid%tauaerlw11, TAUAERlw12=grid%tauaerlw12    &amp; <a name='385'>
     &amp;        ,TAUAERlw13 =grid%tauaerlw13, TAUAERlw14=grid%tauaerlw14    &amp; <a name='386'>
     &amp;        ,TAUAERlw15 =grid%tauaerlw15, TAUAERlw16=grid%tauaerlw16   &amp; <a name='387'>
     &amp;        ,progn=config_flags%progn                                            &amp;<a name='388'>
#endif<a name='389'>
     &amp;         ,slope_rad=config_flags%slope_rad,topo_shading=config_flags%topo_shading     &amp;<a name='390'>
     &amp;         ,shadowmask=grid%shadowmask,ht=grid%ht,dx=grid%dx,dy=grid%dy &amp;           <a name='391'>
     &amp;         ,diffuse_frac=grid%diffuse_frac &amp;           <a name='392'>
     &amp;         ,IS_CAMMGMP_USED = grid%is_CAMMGMP_used    &amp;<a name='393'>
     &amp;         ,MP_PHYSICS=CONFIG_FLAGS%MP_PHYSICS )<a name='394'>
<a name='395'>
BENCH_END(rad_driver_tim)<a name='396'>
<a name='397'>
<font color=#447700>!********* Surface driver<a name='398'></font>
<font color=#447700>! surface<a name='399'></font>
<a name='400'>
BENCH_START(surf_driver_tim)<a name='401'>
<a name='402'>
<font color=#447700>!gmm halo of wtd and riverflow for leafhydro<a name='403'></font>
#ifdef DM_PARALLEL<a name='404'>
  IF ( config_flags%sf_surface_physics.eq.NOAHMPSCHEME ) THEN<a name='405'>
       IF ( config_flags%opt_run.eq.5.and.mod(grid%itimestep,grid%STEPWTD).eq.0 )  THEN<a name='406'>
#     include "<A href='../../html_code/include/HALO_EM_HYDRO_NOAHMP.inc.html'>HALO_EM_HYDRO_NOAHMP.inc</A>"<A NAME="HALO_EM_HYDRO_NOAHMP.inc_2"><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='407'>
       ENDIF<a name='408'>
  ENDIF<a name='409'>
#endif<a name='410'>
<a name='411'>
<font color=#447700>!-----------------------------------------------------------------<a name='412'></font>
<font color=#447700>! urban related variable are added to arguments of surface_driver<a name='413'></font>
<font color=#447700>!-----------------------------------------------------------------<a name='414'></font>
      num_roof_layers = grid%num_soil_layers <font color=#447700>!urban<a name='415'></font>
      num_wall_layers = grid%num_soil_layers <font color=#447700>!urban<a name='416'></font>
      num_road_layers = grid%num_soil_layers <font color=#447700>!urban<a name='417'></font>
      CALL nl_get_iswater(grid%id, iswater)<a name='418'>
      CALL nl_get_isurban(grid%id, isurban)<a name='419'>
      call nl_get_mminlu(grid%id, mminlu)<a name='420'>
<a name='421'>
#ifdef DM_PARALLEL<a name='422'>
#     include "<A href='../../html_code/include/HALO_PWP.inc.html'>HALO_PWP.inc</A>"<A NAME="HALO_PWP.inc_3"><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='423'>
#endif<a name='424'>
<a name='425'>
      CALL wrf_debug ( 200 , ' call surface_driver' )<a name='426'>
<a name='427'>
      if( grid%num_nests .lt. 1 )then<a name='428'>
          HYDRO_dt = 0<a name='429'>
      else<a name='430'>
          HYDRO_dt = -1<a name='431'>
      endif<a name='432'>
<a name='433'>
      CALL <A href='../../html_code/phys/module_surface_driver.F.html#SURFACE_DRIVER'>surface_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SURFACE_DRIVER_1">(                                                &amp;<a name='434'>
     &amp;        HYDRO_dt=HYDRO_dt,  sfcheadrt=grid%sfcheadrt,               &amp;<a name='435'>
     &amp;        INFXSRT=grid%INFXSRT,  soldrain=grid%soldrain,              &amp;<a name='436'>
     &amp;         ACGRDFLX=grid%acgrdflx  ,ACHFX=grid%achfx        ,ACLHF=grid%aclhf        &amp;<a name='437'>
     &amp;        ,ACSNOM=grid%acsnom      ,ACSNOW=grid%acsnow      ,AKHS=grid%akhs          &amp;<a name='438'>
     &amp;        ,AKMS=grid%akms          ,ALBBCK=grid%albbck      ,ALBEDO=grid%albedo      &amp;<a name='439'>
     &amp;        ,EMBCK=grid%embck                                                          &amp;<a name='440'>
     &amp;        ,BR=grid%br              ,CANWAT=grid%canwat      ,CHKLOWQ=chklowq    &amp;<a name='441'>
     &amp;        ,CT=grid%ct              ,DT=grid%dt         ,DX=grid%dx         &amp;<a name='442'>
     &amp;        ,DZ8W=dz8w          ,DZS=grid%dzs            ,FLHC=grid%flhc          &amp;<a name='443'>
     &amp;        ,FM=grid%fm         ,FHH=grid%fh                                      &amp;<a name='444'>
     &amp;        ,FLQC=grid%flqc          ,GLW=grid%glw            ,GRDFLX=grid%grdflx      &amp;<a name='445'>
     &amp;        ,GSW=grid%gsw    ,SWDOWN=grid%swdown        ,GZ1OZ0=gz1oz0      ,HFX=grid%hfx              &amp;<a name='446'>
     &amp;        ,HT=grid%ht              ,IFSNOW=config_flags%ifsnow      ,ISFFLX=config_flags%isfflx      &amp;<a name='447'>
     &amp;        ,FRACTIONAL_SEAICE=config_flags%fractional_seaice           &amp;<a name='448'>
     &amp;        ,SEAICE_ALBEDO_OPT=config_flags%seaice_albedo_opt           &amp;<a name='449'>
     &amp;        ,SEAICE_ALBEDO_DEFAULT=config_flags%seaice_albedo_default   &amp;<a name='450'>
     &amp;        ,SEAICE_THICKNESS_OPT=config_flags%seaice_thickness_opt     &amp;<a name='451'>
     &amp;        ,SEAICE_THICKNESS_DEFAULT=config_flags%seaice_thickness_default     &amp;<a name='452'>
     &amp;        ,SEAICE_SNOWDEPTH_OPT=config_flags%seaice_snowdepth_opt     &amp;<a name='453'>
     &amp;        ,SEAICE_SNOWDEPTH_MAX=config_flags%seaice_snowdepth_max     &amp;<a name='454'>
     &amp;        ,SEAICE_SNOWDEPTH_MIN=config_flags%seaice_snowdepth_min     &amp;<a name='455'>
     &amp;        ,TICE2TSK_IF2COLD=config_flags%tice2tsk_if2cold             &amp;<a name='456'>
     &amp;        ,IFNDALBSI=grid%ifndalbsi, IFNDICEDEPTH=grid%ifndicedepth   &amp;<a name='457'>
     &amp;        ,IFNDSNOWSI=grid%ifndsnowsi                                 &amp;<a name='458'>
     &amp;        ,ISLTYP=grid%isltyp      ,ITIMESTEP=grid%itimestep, JULIAN_IN=grid%julian                  &amp;<a name='459'>
     &amp;        ,IVGTYP=grid%ivgtyp      ,LH=grid%lh              ,LOWLYR=grid%lowlyr      &amp;<a name='460'>
     &amp;        ,MAVAIL=grid%mavail      ,NUM_SOIL_LAYERS=config_flags%num_soil_layers        &amp;<a name='461'>
     &amp;        ,P8W=grid%p_hyd_w            ,PBLH=grid%pblh          ,PI_PHY=pi_phy      &amp;<a name='462'>
     &amp;        ,PSFC=grid%psfc          ,PSHLTR=grid%pshltr      ,PSIH=psih          &amp;<a name='463'>
     &amp;        ,BLDT=grid%bldt     ,CURR_SECS=curr_secs, ADAPT_STEP_FLAG=adapt_step_flag  &amp;<a name='464'>
     &amp;        ,BLDTACTTIME=grid%bldtacttime                                              &amp; <a name='465'>
     &amp;        ,PSIM=psim          ,P_PHY=grid%p_hyd        ,Q10=grid%q10            &amp;<a name='466'>
     &amp;        ,Q2=grid%q2              ,QFX=grid%qfx            ,QSFC=grid%qsfc          &amp;<a name='467'>
     &amp;        ,QSHLTR=grid%qshltr      ,QZ0=grid%qz0            ,RAINCV=grid%raincv      &amp;<a name='468'>
     &amp;        ,RA_LW_PHYSICS=config_flags%ra_lw_physics         ,RHO=grid%rho            &amp;<a name='469'>
     &amp;        ,RMOL=grid%rmol          ,SFCEVP=grid%sfcevp      ,SFCEXC=grid%sfcexc      &amp;<a name='470'>
     &amp;        ,SFCRUNOFF=grid%sfcrunoff,ACRUNOFF=grid%ACRUNOFF                           &amp;<a name='471'>
     &amp;        ,opt_thcnd=config_flags%opt_thcnd                                          &amp;<a name='472'>
     &amp;        ,SF_SFCLAY_PHYSICS=config_flags%sf_sfclay_physics                        &amp;<a name='473'>
     &amp;        ,SF_SURFACE_PHYSICS=config_flags%sf_surface_physics  ,SH2O=grid%sh2o          &amp;<a name='474'>
     &amp;        ,SHDMAX=grid%shdmax      ,SHDMIN=grid%shdmin      ,SMOIS=grid%smois        &amp;<a name='475'>
     &amp;        ,SMSTAV=grid%smstav      ,SMSTOT=grid%smstot      ,SNOALB=grid%snoalb      &amp;<a name='476'>
     &amp;        ,SNOW=grid%snow          ,SNOWC=grid%snowc        ,SNOWH=grid%snowh        &amp;<a name='477'>
     &amp;        ,SMCREL=grid%smcrel                                                        &amp;<a name='478'>
     &amp;        ,SST=grid%sst            ,SST_INPUT=grid%sst_input,SST_UPDATE=grid%sst_update                  &amp;<a name='479'>
     &amp;        ,SSTSK=grid%sstsk        ,DTW=grid%dtw            ,SST_SKIN=grid%sst_skin  &amp;<a name='480'>
     &amp;        ,SCM_FORCE_SKINTEMP=grid%scm_force_skintemp                                &amp;<a name='481'>
     &amp;        ,SCM_FORCE_FLUX=grid%scm_force_flux                                        &amp;<a name='482'>
     &amp;        ,STEPBL=grid%stepbl      ,TH10=grid%th10          ,TH2=grid%th2            &amp;<a name='483'>
     &amp;        ,THZ0=grid%thz0          ,TH_PHY=th_phy      ,TKE_PBL=grid%tke_pbl    &amp;<a name='484'>
     &amp;        ,TMN=grid%tmn            ,TSHLTR=grid%tshltr      ,TSK=grid%tsk            &amp;<a name='485'>
     &amp;        ,TYR=grid%tyr            ,TYRA=grid%tyra          ,TDLY=grid%tdly          &amp;<a name='486'>
     &amp;        ,TLAG=grid%tlag          ,LAGDAY=config_flags%lagday      ,NYEAR=grid%nyear        &amp;<a name='487'>
     &amp;        ,NDAY=grid%nday          ,TMN_UPDATE=grid%tmn_update      ,YR=yr            &amp;<a name='488'>
     &amp;        ,TSLB=grid%tslb          ,T_PHY=t_phy        ,U10=grid%u10            &amp;<a name='489'>
     &amp;        ,URATX=grid%uratx        ,VRATX=grid%vratx   ,TRATX=grid%tratx        &amp;<a name='490'>
     &amp;        ,UDRUNOFF=grid%udrunoff  ,UST=grid%ust       ,UZ0=grid%uz0            &amp;<a name='491'>
     &amp;        ,U_FRAME=grid%u_frame    ,U_PHY=grid%u_phy   ,V10=grid%v10            &amp;<a name='492'>
     &amp;        ,UOCE=grid%uoce          ,VOCE=grid%voce                              &amp;<a name='493'>
     &amp;        ,VEGFRA=grid%vegfra      ,VZ0=grid%vz0       ,V_FRAME=grid%v_frame    &amp;<a name='494'>
     &amp;        ,V_PHY=grid%v_phy        ,WARM_RAIN=grid%warm_rain                    &amp;<a name='495'>
     &amp;        ,WSPD=wspd               ,XICE=grid%xice     ,XLAND=grid%xland        &amp;<a name='496'>
     &amp;        ,MAX_EDOM=grid%num_ext_model_couple_dom      ,CPLMASK=grid%cplmask    &amp;<a name='497'>
     &amp;        ,Z0=grid%z0              ,Z=grid%z        ,ZNT=grid%znt               &amp;<a name='498'>
     &amp;        ,ZS=grid%zs              ,ALBSI=grid%albsi , ICEDEPTH=grid%icedepth   &amp;<a name='499'>
     &amp;        ,SNOWSI=grid%snowsi                                                   &amp;<a name='500'>
     &amp;        ,XICEM=grid%xicem   ,ISICE=grid%landuse_isice                         &amp;<a name='501'>
     &amp;        ,USTM=grid%ustm          ,CK=grid%ck         ,CKA=grid%cka            &amp;<a name='502'>
     &amp;                                 ,CD=grid%cd         ,CDA=grid%cda            &amp;<a name='503'>
     &amp;        ,ISFTCFLX=config_flags%isftcflx, IZ0TLND=config_flags%iz0tlnd         &amp;<a name='504'>
     &amp;        ,SF_OCEAN_PHYSICS=config_flags%sf_ocean_physics                       &amp;<a name='505'>
     &amp;        ,OML_HML0=config_flags%oml_hml0 ,OML_GAMMA=config_flags%oml_gamma     &amp;<a name='506'>
     &amp;        ,TML=grid%tml, T0ML=grid%t0ml, HML=grid%hml, H0ML=grid%h0ml           &amp;<a name='507'>
     &amp;        ,HUML=grid%huml, HVML=grid%hvml, F=grid%f                             &amp;<a name='508'>
     &amp;        ,TMOML=grid%TMOML,ISWATER=iswater                                     &amp;<a name='509'>
     &amp;        ,OML_RELAXATION_TIME=grid%OML_RELAXATION_TIME                         &amp;<a name='510'>
     &amp;        ,lakedepth2d=grid%lakedepth2d,    savedtke12d=grid%savedtke12d        &amp;   <a name='511'>
     &amp;        ,snowdp2d=grid%snowdp2d,          h2osno2d=grid%h2osno2d              &amp; <font color=#447700>!lake<a name='512'></font>
     &amp;        ,snl2d=grid%snl2d,                t_grnd2d=grid%t_grnd2d              &amp;   <a name='513'>
     &amp;        ,t_lake3d=grid%t_lake3d,          lake_icefrac3d=grid%lake_icefrac3d  &amp; <font color=#447700>!lake  <a name='514'></font>
     &amp;        ,z_lake3d=grid%z_lake3d,          dz_lake3d=grid%dz_lake3d            &amp;   <a name='515'>
     &amp;        ,t_soisno3d=grid%t_soisno3d,      h2osoi_ice3d=grid%h2osoi_ice3d      &amp; <font color=#447700>!lake<a name='516'></font>
     &amp;        ,h2osoi_liq3d=grid%h2osoi_liq3d,  h2osoi_vol3d=grid%h2osoi_vol3d      &amp;   <a name='517'>
     &amp;        ,z3d=grid%z3d,                    dz3d=grid%dz3d                      &amp; <font color=#447700>!lake<a name='518'></font>
     &amp;        ,zi3d=grid%zi3d,                  watsat3d=grid%watsat3d              &amp;   <a name='519'>
     &amp;        ,csol3d=grid%csol3d,              tkmg3d=grid%tkmg3d                  &amp; <font color=#447700>!lake     <a name='520'></font>
     &amp;        ,tkdry3d=grid%tkdry3d,            tksatu3d=grid%tksatu3d              &amp;   <a name='521'>
     &amp;        ,LakeModel=grid%sf_lake_physics,  lake_min_elev=grid%lake_min_elev    &amp; <font color=#447700>!lake  <a name='522'></font>
#if ( EM_CORE == 1)<a name='523'>
     &amp;        ,LakeMask=grid%LakeMask                                               &amp; <font color=#447700>! lake<a name='524'></font>
#endif<a name='525'>
<font color=#447700>! CLM Varaibles<a name='526'></font>
     &amp;        ,NUMC=grid%numc,NUMP=grid%nump,SABV=grid%sabv,SABG=grid%sabg,         &amp;<a name='527'>
     &amp;         LWUP=grid%lwup,SNL=grid%snl,                                         &amp;<a name='528'>
     &amp;         HISTORY_INTERVAL=config_flags%history_interval ,                     &amp;<font color=#447700>!ylu add hist inverval for accumulation T max/min<a name='529'></font>
     &amp;         SNOWDP=grid%snowdp, WTC=grid%wtc,WTP=grid%wtp, H2OSNO=grid%h2osno,   &amp;<a name='530'>
     &amp;         T_GRND=grid%t_grnd,T_VEG=grid%t_veg,                                 &amp;<a name='531'>
     &amp;         H2OCAN=grid%h2ocan, H2OCAN_COL=grid%h2ocan_col,T2M_MAX=grid%t2m_max, &amp;<a name='532'>
     &amp;         T2M_MIN=grid%t2m_min,T2CLM=grid%t2clm,                               &amp;<a name='533'>
     &amp;         T_REF2M=grid%t_ref2m,H2OSOI_LIQ_S1=grid%h2osoi_liq_s1,               &amp;<a name='534'>
     &amp;         H2OSOI_LIQ_S2=grid%h2osoi_liq_s2,                                    &amp;<a name='535'>
     &amp;         H2OSOI_LIQ_S3=grid%h2osoi_liq_s3,H2OSOI_LIQ_S4=grid%h2osoi_liq_s4,   &amp;<a name='536'>
     &amp;         H2OSOI_LIQ_S5=grid%h2osoi_liq_s5,                                    &amp;<a name='537'>
     &amp;         H2OSOI_LIQ1=grid%h2osoi_liq1,H2OSOI_LIQ2=grid%h2osoi_liq2,           &amp;<a name='538'>
     &amp;         H2OSOI_LIQ3=grid%h2osoi_liq3,H2OSOI_LIQ4=grid%h2osoi_liq4,           &amp;<a name='539'>
     &amp;         H2OSOI_LIQ5=grid%h2osoi_liq5,H2OSOI_LIQ6=grid%h2osoi_liq6,           &amp;<a name='540'>
     &amp;         H2OSOI_LIQ7=grid%h2osoi_liq7,H2OSOI_LIQ8=grid%h2osoi_liq8,           &amp;<a name='541'>
     &amp;         H2OSOI_LIQ9=grid%h2osoi_liq9, H2OSOI_LIQ10=grid%h2osoi_liq10,        &amp;<a name='542'>
     &amp;         H2OSOI_ICE_S1=grid%h2osoi_ice_s1,H2OSOI_ICE_S2=grid%h2osoi_ice_s2,   &amp;<a name='543'>
     &amp;         H2OSOI_ICE_S3=grid%h2osoi_ice_s3, H2OSOI_ICE_S4=grid%h2osoi_ice_s4,  &amp;<a name='544'>
     &amp;         H2OSOI_ICE_S5=grid%h2osoi_ice_s5,                                    &amp;<a name='545'>
     &amp;         H2OSOI_ICE1=grid%h2osoi_ice1, H2OSOI_ICE2=grid%h2osoi_ice2,          &amp;<a name='546'>
     &amp;         H2OSOI_ICE3=grid%h2osoi_ice3,H2OSOI_ICE4=grid%h2osoi_ice4,           &amp;<a name='547'>
     &amp;         H2OSOI_ICE5=grid%h2osoi_ice5, H2OSOI_ICE6=grid%h2osoi_ice6,          &amp;<a name='548'>
     &amp;         H2OSOI_ICE7=grid%h2osoi_ice7,H2OSOI_ICE8=grid%h2osoi_ice8,           &amp;<a name='549'>
     &amp;         H2OSOI_ICE9=grid%h2osoi_ice9,H2OSOI_ICE10=grid%h2osoi_ice10,         &amp;<a name='550'>
     &amp;         T_SOISNO_S1=grid%t_soisno_s1,T_SOISNO_S2=grid%t_soisno_s2,           &amp;<a name='551'>
     &amp;         T_SOISNO_S3=grid%t_soisno_s3,T_SOISNO_S4=grid%t_soisno_s4,           &amp;<a name='552'>
     &amp;         T_SOISNO_S5=grid%t_soisno_s5,T_SOISNO1=grid%t_soisno1,               &amp;<a name='553'>
     &amp;         T_SOISNO2=grid%t_soisno2,T_SOISNO3=grid%t_soisno3,                   &amp;<a name='554'>
     &amp;         T_SOISNO4=grid%t_soisno4,T_SOISNO5=grid%t_soisno5,                   &amp;<a name='555'>
     &amp;         T_SOISNO6=grid%t_soisno6,T_SOISNO7=grid%t_soisno7,                   &amp;<a name='556'>
     &amp;         T_SOISNO8=grid%t_soisno8,T_SOISNO9=grid%t_soisno9,                   &amp;<a name='557'>
     &amp;         T_SOISNO10=grid%t_soisno10,DZSNOW1=grid%dzsnow1,DZSNOW2=grid%dzsnow2,&amp; <a name='558'>
     &amp;         DZSNOW3=grid%dzsnow3,DZSNOW4=grid%dzsnow4, DZSNOW5=grid%dzsnow5,     &amp;<a name='559'>
     &amp;         SNOWRDS1=grid%snowrds1,SNOWRDS2=grid%snowrds2,                       &amp;<a name='560'>
     &amp;         SNOWRDS3=grid%snowrds3 ,SNOWRDS4=grid%snowrds4,                      &amp;<a name='561'>
     &amp;         SNOWRDS5=grid%snowrds5,                                              &amp;<a name='562'>
     &amp;         T_LAKE1=grid%t_lake1,T_LAKE2=grid%t_lake2,T_LAKE3=grid%t_lake3,      &amp;<a name='563'>
     &amp;         T_LAKE4=grid%t_lake4,                                                &amp;<a name='564'>
     &amp;         T_LAKE5=grid%t_lake5,T_LAKE6=grid%t_lake6, T_LAKE7=grid%t_lake7,     &amp;<a name='565'>
     &amp;         T_LAKE8=grid%t_lake8, T_LAKE9=grid%t_lake9,T_LAKE10=grid%t_lake10,   &amp;<a name='566'>
     &amp;         H2OSOI_VOL1=grid%h2osoi_vol1,H2OSOI_VOL2=grid%h2osoi_vol2,           &amp;<a name='567'>
     &amp;         H2OSOI_VOL3=grid%h2osoi_vol3,H2OSOI_VOL4=grid%h2osoi_vol4,           &amp;<a name='568'>
     &amp;         H2OSOI_VOL5=grid%h2osoi_vol5,                                        &amp;<a name='569'>
     &amp;         H2OSOI_VOL6=grid%h2osoi_vol6,H2OSOI_VOL7=grid%h2osoi_vol7,           &amp;<a name='570'>
     &amp;         H2OSOI_VOL8=grid%h2osoi_vol8,                                        &amp;<a name='571'>
     &amp;         H2OSOI_VOL9=grid%h2osoi_vol9,H2OSOI_VOL10=grid%h2osoi_vol10,         &amp;<a name='572'>
     &amp;         MAXPATCH=config_flags%maxpatch,                                      &amp;<a name='573'>
     &amp;         INEST=grid%id,ALBEDOsubgrid=grid%ALBEDOsubgrid,                      &amp;<a name='574'>
     &amp;         LHsubgrid=grid%LHsubgrid,                                            &amp;<a name='575'>
     &amp;         HFXsubgrid=grid%HFXsubgrid,LWUPsubgrid=grid%LWUPsubgrid,             &amp;<a name='576'>
     &amp;         Q2subgrid=grid%Q2subgrid,SABVsubgrid=grid%SABVsubgrid,               &amp;<a name='577'>
     &amp;         SABGsubgrid=grid%SABGsubgrid,NRAsubgrid=grid%NRAsubgrid,             &amp;<a name='578'>
     &amp;         SWUPsubgrid=grid%SWUPsubgrid,LHsoi=grid%LHsoi,                       &amp;<a name='579'>
     &amp;         LHveg=grid%LHveg, LHtran=grid%LHtran                                 &amp;<a name='580'>
<font color=#447700>! end of CLM variables<a name='581'></font>
     &amp;        ,SLOPE_RAD=config_flags%slope_rad,TOPO_SHADING=config_flags%topo_shading &amp; <font color=#447700>! solar<a name='582'></font>
     &amp;        ,SHADOWMASK=grid%shadowmask,DIFFUSE_FRAC=grid%diffuse_frac               &amp; <font color=#447700>! solar<a name='583'></font>
     &amp;        ,SLOPE=grid%slope, SLP_AZI=grid%slp_azi, SWNORM=grid%swnorm              &amp; <font color=#447700>! solar<a name='584'></font>
     &amp;        ,DECLIN=grid%declin ,SOLCON=grid%solcon ,COSZEN=grid%coszen ,HRANG=grid%hrang    &amp;<a name='585'>
     &amp;        ,xlat_urb2d=grid%XLAT                                       &amp; <font color=#447700>!I urban<a name='586'></font>
     &amp;        ,NUM_ROOF_LAYERS=num_roof_layers                            &amp; <font color=#447700>!I urban<a name='587'></font>
     &amp;        ,NUM_WALL_LAYERS=num_wall_layers                            &amp; <font color=#447700>!I urban<a name='588'></font>
     &amp;        ,NUM_ROAD_LAYERS=num_road_layers                            &amp;<a name='589'>
     &amp;        ,DZR=grid%dzr ,DZB=grid%dzb ,DZG=grid%dzg                   &amp; <font color=#447700>!I urban<a name='590'></font>
     &amp;        ,TR_URB2D=grid%tr_urb2d ,TB_URB2D=grid%tb_urb2d             &amp;<a name='591'>
     &amp;        ,TG_URB2D=grid%tg_urb2d                                     &amp; <font color=#447700>!H urban<a name='592'></font>
     &amp;        ,TC_URB2D=grid%tc_urb2d ,QC_URB2D=grid%qc_urb2d             &amp; <font color=#447700>!H urban<a name='593'></font>
     &amp;        ,UC_URB2D=grid%uc_urb2d                                     &amp; <font color=#447700>!H urban<a name='594'></font>
     &amp;        ,XXXR_URB2D=grid%xxxr_urb2d                                 &amp;<a name='595'>
     &amp;        ,XXXB_URB2D=grid%xxxb_urb2d                                 &amp; <font color=#447700>!H urban<a name='596'></font>
     &amp;        ,XXXG_URB2D=grid%xxxg_urb2d                                 &amp;<a name='597'>
     &amp;        ,XXXC_URB2D=grid%xxxc_urb2d                                 &amp; <font color=#447700>!H urban<a name='598'></font>
     &amp;        ,CMCR_URB2D=grid%cmcr_urb2d,TGR_URB2D=grid%tgr_urb2d        &amp; <font color=#447700>!H urban<a name='599'></font>
     &amp;        ,TGRL_URB3D=grid%tgrl_urb3d,SMR_URB3D=grid%smr_urb3d        &amp; <font color=#447700>!H urban<a name='600'></font>
     &amp;        ,JULIAN=grid%julday, JULYR=grid%julyr                       &amp; <font color=#447700>!I urban<a name='601'></font>
     &amp;        ,DRELR_URB2D=grid%drelr_urb2d,DRELB_URB2D=grid%drelb_urb2d  &amp; <font color=#447700>!H urban<a name='602'></font>
     &amp;        ,DRELG_URB2D=grid%drelg_urb2d                               &amp; <font color=#447700>!H urban<a name='603'></font>
     &amp;        ,FLXHUMR_URB2D=grid%flxhumr_urb2d                           &amp; <font color=#447700>!H urban<a name='604'></font>
     &amp;        ,FLXHUMB_URB2D=grid%flxhumb_urb2d                           &amp; <font color=#447700>!H urban<a name='605'></font>
     &amp;        ,FLXHUMG_URB2D=grid%flxhumg_urb2d                           &amp; <font color=#447700>!H urban<a name='606'></font>
     &amp;        ,TRL_URB3D=grid%trl_urb3d   ,TBL_URB3D=grid%tbl_urb3d       &amp; <font color=#447700>!H urban<a name='607'></font>
     &amp;        ,TGL_URB3D=grid%tgl_urb3d                                   &amp; <font color=#447700>!H urban<a name='608'></font>
     &amp;        ,SH_URB2D=grid%sh_urb2d     ,LH_URB2D=grid%lh_urb2d         &amp;<a name='609'>
     &amp;        ,G_URB2D=grid%g_urb2d                                       &amp; <font color=#447700>!H urban<a name='610'></font>
     &amp;        ,RN_URB2D=grid%rn_urb2d     , TS_URB2D=grid%ts_urb2d        &amp; <font color=#447700>!H urban<a name='611'></font>
     &amp;        ,FRC_URB2D=grid%frc_urb2d                                   &amp; <font color=#447700>!H urban<a name='612'></font>
     &amp;        ,UTYPE_URB2D=grid%utype_urb2d                               &amp; <font color=#447700>!H urban<a name='613'></font>
         <font color=#447700>! Optional urban for BEP scheme<a name='614'></font>
     &amp;        ,SF_URBAN_PHYSICS=config_flags%sf_urban_physics             &amp;<a name='615'>
     &amp;        ,NUM_URBAN_LAYERS=config_flags%num_urban_layers             &amp; <font color=#447700>!multi-layer urban<a name='616'></font>
     &amp;        ,NUM_URBAN_HI=config_flags%num_urban_hi                     &amp; <font color=#447700>!multi-layer urban<a name='617'></font>
     &amp;        ,TRB_URB4D=grid%trb_urb4d,TW1_URB4D=grid%tw1_urb4d          &amp; <font color=#447700>!multi-layer urban<a name='618'></font>
     &amp;        ,TW2_URB4D=grid%tw2_urb4d,TGB_URB4D=grid%tgb_urb4d          &amp; <font color=#447700>!multi-layer urban<a name='619'></font>
     &amp;        ,TLEV_URB3D=grid%tlev_urb3d                               &amp; <font color=#447700>!multi-layer urban<a name='620'></font>
     &amp;        ,QLEV_URB3D=grid%qlev_urb3d                               &amp; <font color=#447700>!multi-layer urban<a name='621'></font>
     &amp;        ,TW1LEV_URB3D=grid%tw1lev_urb3d                           &amp; <font color=#447700>!multi-layer urban<a name='622'></font>
     &amp;        ,TW2LEV_URB3D=grid%tw2lev_urb3d                           &amp; <font color=#447700>!multi-layer urban<a name='623'></font>
     &amp;        ,TGLEV_URB3D=grid%tglev_urb3d                             &amp; <font color=#447700>!multi-layer urban<a name='624'></font>
     &amp;        ,TFLEV_URB3D=grid%tflev_urb3d                             &amp; <font color=#447700>!multi-layer urban<a name='625'></font>
     &amp;        ,SF_AC_URB3D=grid%sf_ac_urb3d                             &amp; <font color=#447700>!multi-layer urban<a name='626'></font>
     &amp;        ,LF_AC_URB3D=grid%lf_ac_urb3d                             &amp; <font color=#447700>!multi-layer urban<a name='627'></font>
     &amp;        ,CM_AC_URB3D=grid%cm_ac_urb3d                             &amp; <font color=#447700>!multi-layer urban<a name='628'></font>
     &amp;        ,SFVENT_URB3D=grid%sfvent_urb3d                           &amp; <font color=#447700>!multi-layer urban<a name='629'></font>
     &amp;        ,LFVENT_URB3D=grid%lfvent_urb3d                           &amp; <font color=#447700>!multi-layer urban<a name='630'></font>
     &amp;        ,SFWIN1_URB3D=grid%sfwin1_urb3d                           &amp; <font color=#447700>!multi-layer urban<a name='631'></font>
     &amp;        ,SFWIN2_URB3D=grid%sfwin2_urb3d                           &amp; <font color=#447700>!multi-layer urban<a name='632'></font>
     &amp;        ,SFW1_URB3D=grid%sfw1_urb3d,SFW2_URB3D=grid%sfw2_urb3d      &amp; <font color=#447700>!multi-layer urban<a name='633'></font>
     &amp;        ,SFR_URB3D=grid%sfr_urb3d,SFG_URB3D=grid%sfg_urb3d          &amp; <font color=#447700>!multi-layer urban<a name='634'></font>
     &amp;        ,LP_URB2D=grid%lp_urb2d,HI_URB2D=grid%hi_urb2d              &amp; <font color=#447700>!multi-layer urban<a name='635'></font>
     &amp;        ,LB_URB2D=grid%lb_urb2d,HGT_URB2D=grid%hgt_urb2d            &amp; <font color=#447700>!multi-layer urban<a name='636'></font>
     &amp;        ,MH_URB2D=grid%mh_urb2d,STDH_URB2D=grid%stdh_urb2d          &amp; <font color=#447700>!SLUCM<a name='637'></font>
     &amp;        ,LF_URB2D=grid%lf_urb2d                                           &amp; <a name='638'>
     &amp;        ,GMT=grid%gmt,XLAT=grid%xlat,XLONG=grid%xlong,JULDAY=grid%julday  &amp;<a name='639'>
     &amp;        ,A_U_BEP=grid%a_u_bep,A_V_BEP=grid%a_v_bep,A_T_BEP=grid%a_t_bep   &amp;<a name='640'>
     &amp;        ,A_Q_BEP=grid%a_q_bep                                             &amp;<a name='641'>
     &amp;        ,B_U_BEP=grid%b_u_bep,B_V_BEP=grid%b_v_bep,B_T_BEP=grid%b_t_bep   &amp;<a name='642'>
     &amp;        ,B_Q_BEP=grid%b_q_bep                                             &amp;<a name='643'>
     &amp;        ,SF_BEP=grid%sf_bep,VL_BEP=grid%vl_bep                            &amp;<a name='644'>
     &amp;        ,A_E_BEP=grid%a_e_bep,B_E_BEP=grid%b_e_bep,DLG_BEP=grid%dlg_bep   &amp;<a name='645'>
     &amp;        ,DL_U_BEP=grid%dl_u_bep                                           &amp;<a name='646'>
     &amp;        ,CMR_SFCDIF=grid%cmr_sfcdif, CHR_SFCDIF=grid%chr_sfcdif     &amp; <font color=#447700>!I/O urban<a name='647'></font>
     &amp;        ,CMC_SFCDIF=grid%cmc_sfcdif, CHC_SFCDIF=grid%chc_sfcdif     &amp; <font color=#447700>!I/O urban<a name='648'></font>
     &amp;        ,CMGR_SFCDIF=grid%cmgr_sfcdif, CHGR_SFCDIF=grid%chgr_sfcdif &amp; <font color=#447700>!I/O urban<a name='649'></font>
           <font color=#447700>! P-X LSM Variables<a name='650'></font>
     &amp;        ,LANDUSEF=grid%landusef, SOILCTOP=grid%soilctop             &amp;   <font color=#447700>! P-X LSM<a name='651'></font>
     &amp;        ,SOILCBOT=grid%soilcbot                                     &amp;   <font color=#447700>! P-X LSM<a name='652'></font>
     &amp;        ,RA=grid%ra, RS=grid%rs, LAI=grid%lai, IMPERV=grid%imperv   &amp;   <font color=#447700>! P-X LSM<a name='653'></font>
     &amp;        ,CANFRA=grid%canfra, NLCAT=grid%num_land_cat                &amp;   <font color=#447700>! P-X LSM<a name='654'></font>
     &amp;        ,NSCAT=grid%num_soil_cat                                    &amp;   <font color=#447700>! P-X LSM<a name='655'></font>
     &amp;        ,VEGF_PX=grid%vegf_px, SNOWNCV=grid%snowncv                 &amp;   <font color=#447700>! P-X LSM<a name='656'></font>
     &amp;        ,ANAL_INTERVAL=config_flags%auxinput9_interval_s+config_flags%auxinput9_interval_m*60  &amp;   <font color=#447700>! P-X LSM<a name='657'></font>
     &amp;        ,PXLSM_SMOIS_INIT=config_flags%pxlsm_smois_init             &amp;   <font color=#447700>! P-X LSM<a name='658'></font>
     &amp;        ,PXLSM_SOIL_NUDGE=config_flags%pxlsm_soil_nudge             &amp;   <font color=#447700>! P-X LSM<a name='659'></font>
           <font color=#447700>! SSiB LSM variables (fds 06/2010)<a name='660'></font>
     &amp;        ,alswvisdir=grid%alswvisdir, alswvisdif=grid%alswvisdif    &amp; <font color=#447700>!ssib<a name='661'></font>
     &amp;        ,alswnirdir=grid%alswnirdir, alswnirdif=grid%alswnirdif    &amp; <font color=#447700>!ssib<a name='662'></font>
     &amp;        ,swvisdir=grid%swvisdir, swvisdif=grid%swvisdif            &amp; <font color=#447700>!ssib<a name='663'></font>
     &amp;        ,swnirdir=grid%swnirdir, swnirdif=grid%swnirdif            &amp; <font color=#447700>!ssib <a name='664'></font>
     &amp;        ,ssib_br=grid%ssib_br,  ssib_fm=grid%ssib_fm               &amp; <font color=#447700>!ssib<a name='665'></font>
     &amp;        ,ssib_fh=grid%ssib_fh,  ssib_cm=grid%ssib_cm               &amp; <font color=#447700>!ssib<a name='666'></font>
     &amp;        ,ssibxdd=grid%ssibxdd,  ssib_lhf=grid%ssib_lhf             &amp; <font color=#447700>!ssib<a name='667'></font>
     &amp;        ,ssib_shf=grid%ssib_shf, ssib_ghf=grid%ssib_ghf            &amp; <font color=#447700>!ssib<a name='668'></font>
     &amp;        ,ssib_egs=grid%ssib_egs, ssib_eci=grid%ssib_eci            &amp; <font color=#447700>!ssib<a name='669'></font>
     &amp;        ,ssib_ect=grid%ssib_ect, ssib_egi=grid%ssib_egi            &amp; <font color=#447700>!ssib<a name='670'></font>
     &amp;        ,ssib_egt=grid%ssib_egt, ssib_sdn=grid%ssib_sdn            &amp; <font color=#447700>!ssib<a name='671'></font>
     &amp;        ,ssib_sup=grid%ssib_sup, ssib_ldn=grid%ssib_ldn            &amp; <font color=#447700>!ssib<a name='672'></font>
     &amp;        ,ssib_lup=grid%ssib_lup, ssib_wat=grid%ssib_wat            &amp; <font color=#447700>!ssib<a name='673'></font>
     &amp;        ,ssib_shc=grid%ssib_shc, ssib_shg=grid%ssib_shg            &amp; <font color=#447700>!ssib<a name='674'></font>
     &amp;        ,ssib_lai=grid%ssib_lai, ssib_vcf=grid%ssib_vcf            &amp; <font color=#447700>!ssib<a name='675'></font>
     &amp;        ,ssib_z00=grid%ssib_z00, ssib_veg=grid%ssib_veg            &amp; <font color=#447700>!ssib<a name='676'></font>
     &amp;        ,cldfra=grid%cldfra                                        &amp; <font color=#447700>!ssib<a name='677'></font>
     &amp;        ,ISNOW=grid%isnow, SWE=grid%swe, SNOWDEN=grid%snowden      &amp; <font color=#447700>!ssib snow<a name='678'></font>
     &amp;        ,SNOWDEPTH=grid%snowdepth, TKAIR=grid%tkair                &amp; <font color=#447700>!ssib snow<a name='679'></font>
     &amp;        ,DZO1=grid%dzo1, WO1=grid%wo1, TSSN1=grid%tssn1, TSSNO1=grid%tssno1     &amp; <font color=#447700>!ssib snow<a name='680'></font>
     &amp;        ,BWO1=grid%bwo1, BTO1=grid%bto1, CTO1=grid%cto1, FIO1=grid%fio1         &amp; <font color=#447700>!ssib snow<a name='681'></font>
     &amp;        ,FLO1=grid%flo1, BIO1=grid%bio1, BLO1=grid%blo1, HO1=grid%ho1           &amp; <font color=#447700>!ssib snow<a name='682'></font>
     &amp;        ,DZO2=grid%dzo2, WO2=grid%wo2, TSSN2=grid%tssn2, TSSNO2=grid%tssno2     &amp; <font color=#447700>!ssib snow<a name='683'></font>
     &amp;        ,BWO2=grid%bwo2, BTO2=grid%bto2, CTO2=grid%cto2, FIO2=grid%fio2         &amp; <font color=#447700>!ssib snow<a name='684'></font>
     &amp;        ,FLO2=grid%flo2, BIO2=grid%bio2, BLO2=grid%blo2, HO2=grid%ho2           &amp; <font color=#447700>!ssib snow<a name='685'></font>
     &amp;        ,DZO3=grid%dzo3, WO3=grid%wo3, TSSN3=grid%tssn3, TSSNO3=grid%tssno3     &amp; <font color=#447700>!ssib snow<a name='686'></font>
     &amp;        ,BWO3=grid%bwo3, BTO3=grid%bto3, CTO3=grid%cto3, FIO3=grid%fio3         &amp; <font color=#447700>!ssib snow<a name='687'></font>
     &amp;        ,FLO3=grid%flo3, BIO3=grid%bio3, BLO3=grid%blo3, HO3=grid%ho3           &amp; <font color=#447700>!ssib snow<a name='688'></font>
     &amp;        ,DZO4=grid%dzo4, WO4=grid%wo4, TSSN4=grid%tssn4, TSSNO4=grid%tssno4     &amp; <font color=#447700>!ssib snow<a name='689'></font>
     &amp;        ,BWO4=grid%bwo4, BTO4=grid%bto4, CTO4=grid%cto4, FIO4=grid%fio4         &amp; <font color=#447700>!ssib snow<a name='690'></font>
     &amp;        ,FLO4=grid%flo4, BIO4=grid%bio4, BLO4=grid%blo4, HO4=grid%ho4           &amp; <font color=#447700>!ssib snow<a name='691'></font>
     &amp;        ,RA_SW_PHYSICS=config_flags%ra_sw_physics                  &amp; <font color=#447700>!ssib<a name='692'></font>
<font color=#447700>!------------------------------------------------------------------------------<a name='693'></font>
           <font color=#447700>! Optional PX LSM nudging<a name='694'></font>
     &amp;        ,t2_ndg_old=grid%t2_ndg_old                  &amp;<a name='695'>
     &amp;        ,q2_ndg_old=grid%q2_ndg_old                  &amp;<a name='696'>
     &amp;        ,t2_ndg_new=grid%t2_ndg_new                  &amp;<a name='697'>
     &amp;        ,q2_ndg_new=grid%q2_ndg_new                  &amp;<a name='698'>
     &amp;        ,sn_ndg_old=grid%sn_ndg_old                  &amp;<a name='699'>
     &amp;        ,sn_ndg_new=grid%sn_ndg_new                  &amp;<a name='700'>
<font color=#447700>! for Noah-MP LSM<a name='701'></font>
     &amp;        ,idveg=config_flags%dveg,         iopt_crs=config_flags%opt_crs &amp;<a name='702'>
     &amp;        ,iopt_btr=config_flags%opt_btr,   iopt_run=config_flags%opt_run &amp;<a name='703'>
     &amp;        ,iopt_sfc=config_flags%opt_sfc,   iopt_frz=config_flags%opt_frz &amp;<a name='704'>
     &amp;        ,iopt_inf=config_flags%opt_inf,   iopt_rad=config_flags%opt_rad &amp;<a name='705'>
     &amp;        ,iopt_alb=config_flags%opt_alb,   iopt_snf=config_flags%opt_snf &amp;<a name='706'>
     &amp;        ,iopt_tbot=config_flags%opt_tbot, iopt_stc=config_flags%opt_stc &amp; <a name='707'>
     &amp;        ,iopt_gla=config_flags%opt_gla,   iopt_rsf=config_flags%opt_rsf &amp; <a name='708'>
     &amp;        , isnowxy=grid%isnowxy  ,    tvxy=grid%tvxy    ,    tgxy=grid%tgxy     &amp;<a name='709'>
     &amp;        ,canicexy=grid%canicexy ,canliqxy=grid%canliqxy,   eahxy=grid%eahxy    &amp;<a name='710'>
     &amp;        ,   tahxy=grid%tahxy    ,    cmxy=grid%cmxy    ,    chxy=grid%chxy     &amp;<a name='711'>
     &amp;        ,  fwetxy=grid%fwetxy   ,sneqvoxy=grid%sneqvoxy,alboldxy=grid%alboldxy &amp;<a name='712'>
     &amp;        , qsnowxy=grid%qsnowxy  ,wslakexy=grid%wslakexy,   zwtxy=grid%zwtxy    &amp;<a name='713'>
     &amp;        ,    waxy=grid%waxy     ,    wtxy=grid%wtxy    ,  tsnoxy=grid%tsnoxy   &amp;<a name='714'>
     &amp;        , zsnsoxy=grid%zsnsoxy  , snicexy=grid%snicexy , snliqxy=grid%snliqxy  &amp;<a name='715'>
     &amp;        ,lfmassxy=grid%lfmassxy ,rtmassxy=grid%rtmassxy,stmassxy=grid%stmassxy &amp;<a name='716'>
     &amp;        ,  woodxy=grid%woodxy   ,stblcpxy=grid%stblcpxy,fastcpxy=grid%fastcpxy &amp;<a name='717'>
     &amp;        , grainxy=grid%grainxy  ,   gddxy=grid%gddxy   ,   pgsxy=grid%pgsxy    &amp;<a name='718'>
     &amp;        , cropcat=grid%cropcat                                                 &amp;<a name='719'>
     &amp;        ,planting=grid%planting , harvest=grid%harvest ,season_gdd=grid%season_gdd  &amp;<a name='720'>
     &amp;        ,  xsaixy=grid%xsaixy   , taussxy=grid%taussxy                         &amp;<a name='721'>
     &amp;        ,  t2mvxy=grid%t2mvxy   ,  t2mbxy=grid%t2mbxy                          &amp;<a name='722'>
     &amp;        ,  q2mvxy=grid%q2mvxy   ,  q2mbxy=grid%q2mbxy                          &amp; <a name='723'>
     &amp;        ,  tradxy=grid%tradxy   ,   neexy=grid%neexy   ,   gppxy=grid%gppxy    &amp;<a name='724'>
     &amp;        ,   nppxy=grid%nppxy    ,  fvegxy=grid%fvegxy  , runsfxy=grid%runsfxy  &amp;<a name='725'>
     &amp;        , runsbxy=grid%runsbxy  ,  ecanxy=grid%ecanxy  ,  edirxy=grid%edirxy   &amp;<a name='726'>
     &amp;        , etranxy=grid%etranxy  ,   fsaxy=grid%fsaxy   ,  firaxy=grid%firaxy   &amp;<a name='727'>
     &amp;        ,  aparxy=grid%aparxy   ,   psnxy=grid%psnxy   ,   savxy=grid%savxy    &amp;<a name='728'>
     &amp;        ,   sagxy=grid%sagxy    , rssunxy=grid%rssunxy , rsshaxy=grid%rsshaxy  &amp;<a name='729'>
     &amp;        ,  bgapxy=grid%bgapxy   ,  wgapxy=grid%wgapxy  ,   tgvxy=grid%tgvxy    &amp;<a name='730'>
     &amp;        ,   tgbxy=grid%tgbxy    ,   chvxy=grid%chvxy   ,   chbxy=grid%chbxy    &amp;<a name='731'>
     &amp;        ,   shgxy=grid%shgxy    ,   shcxy=grid%shcxy   ,   shbxy=grid%shbxy    &amp;<a name='732'>
     &amp;        ,   evgxy=grid%evgxy    ,   evbxy=grid%evbxy   ,   ghvxy=grid%ghvxy    &amp;<a name='733'>
     &amp;        ,   ghbxy=grid%ghbxy    ,   irgxy=grid%irgxy   ,   ircxy=grid%ircxy    &amp;<a name='734'>
     &amp;        ,   irbxy=grid%irbxy    ,    trxy=grid%trxy    ,   evcxy=grid%evcxy    &amp;<a name='735'>
     &amp;        ,chleafxy=grid%chleafxy ,  chucxy=grid%chucxy                          &amp;                       <a name='736'>
     &amp;        ,  chv2xy=grid%chv2xy   ,  chb2xy=grid%chb2xy , chstarxy=grid%chstarxy &amp;                       <a name='737'>
           <font color=#447700>!Optional hydro variables in NOAHMP<a name='738'></font>
     &amp;        ,smcwtdxy=grid%smcwtdxy ,rechxy=grid%rechxy ,deeprechxy=grid%deeprechxy &amp;<a name='739'>
     &amp;        ,fdepthxy=grid%fdepthxy, areaxy=grid%areaxy, rivercondxy=grid%rivercondxy  &amp;<a name='740'>
     &amp;        ,riverbedxy=grid%riverbedxy, eqzwt=grid%eqzwt, pexpxy=grid%pexpxy &amp;<a name='741'>
     &amp;        ,qrfxy=grid%qrfxy, qspringxy=grid%qspringxy, qslatxy=grid%qslatxy, qrfsxy=grid%qrfsxy &amp;<a name='742'>
     &amp;        ,qspringsxy=grid%qspringsxy, smoiseq=grid%smoiseq, wtddt=config_flags%wtddt, stepwtd=grid%stepwtd &amp;<a name='743'>
           <font color=#447700>! Noah UA changes<a name='744'></font>
     &amp;        ,ua_phys=config_flags%ua_phys,flx4=grid%flx4,fvb=grid%fvb       &amp;<a name='745'>
     &amp;        ,fbur=grid%fbur,fgsn=grid%fgsn                                  &amp;<a name='746'>
           <font color=#447700>! Indexes<a name='747'></font>
     &amp;        ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde          &amp;<a name='748'>
     &amp;        ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme          &amp;<a name='749'>
     &amp;        ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe          &amp;<a name='750'>
     &amp;        , I_START=grid%i_start,I_END=min(grid%i_end, ide-1)         &amp;<a name='751'>
     &amp;        , J_START=grid%j_start,J_END=min(grid%j_end, jde-1)         &amp;<a name='752'>
     &amp;        , KTS=k_start, KTE=min(k_end,kde-1)                         &amp;<a name='753'>
     &amp;        , NUM_TILES=grid%num_tiles                                  &amp;<a name='754'>
          <font color=#447700>! Variables required by TEMF PBL - WA 1/7/09<a name='755'></font>
              ,te_temf=grid%te_temf,hd_temf=grid%hd_temf                  &amp;<a name='756'>
              ,fCor=grid%f,exch_temf=exch_temf,wm_temf=grid%wm_temf       &amp;<a name='757'>
          <font color=#447700>! Variables required by IDEAL SCM sfc scheme - WA 1/6/10<a name='758'></font>
              ,hfx_force=grid%hfx_force,lh_force=grid%lh_force            &amp;<a name='759'>
              ,tsk_force=grid%tsk_force                                   &amp;<a name='760'>
              ,hfx_force_tend=grid%hfx_force_tend                         &amp;<a name='761'>
              ,lh_force_tend=grid%lh_force_tend                           &amp;<a name='762'>
              ,tsk_force_tend=grid%tsk_force_tend                         &amp;<a name='763'>
           <font color=#447700>! Optional<a name='764'></font>
     &amp;        ,QV_CURR=moist(ims,kms,jms,P_QV), F_QV=F_QV                 &amp;<a name='765'>
     &amp;        ,QC_CURR=moist(ims,kms,jms,P_QC), F_QC=F_QC                 &amp;<a name='766'>
     &amp;        ,QR_CURR=moist(ims,kms,jms,P_QR), F_QR=F_QR                 &amp;<a name='767'>
     &amp;        ,QI_CURR=moist(ims,kms,jms,P_QI), F_QI=F_QI                 &amp;<a name='768'>
     &amp;        ,QS_CURR=moist(ims,kms,jms,P_QS), F_QS=F_QS                 &amp;<a name='769'>
     &amp;        ,QG_CURR=moist(ims,kms,jms,P_QG), F_QG=F_QG                 &amp;<a name='770'>
     &amp;        ,CAPG=grid%capg, EMISS=grid%emiss, HOL=hol,MOL=grid%mol     &amp;<a name='771'>
     &amp;        ,T2OBS=grid%t2obs, Q2OBS=grid%q2obs                         &amp;<a name='772'>
     &amp;        ,RAINBL=grid%rainbl,SR=grid%sr,RAINSHV=grid%rainshv         &amp;<a name='773'>
     &amp;        ,GRAUPELNCV=grid%graupelncv, HAILNCV=grid%hailncv           &amp;<a name='774'>
     &amp;        ,RAINNCV=grid%rainncv,REGIME=grid%regime,T2=grid%t2,THC=grid%thc            &amp;<a name='775'>
     &amp;        ,QSG=grid%qsg,QVG=grid%qvg,QCG=grid%qcg,SOILT1=grid%soilt1,TSNAV=grid%tsnav &amp; <font color=#447700>! ruc lsm<a name='776'></font>
     &amp;        ,SMFR3D=grid%smfr3d,KEEPFR3DFLAG=grid%keepfr3dflag,DEW=grid%dew             &amp; <font color=#447700>! ruc lsm<a name='777'></font>
     &amp;        ,POTEVP=grid%POTEVP, SNOPCX=grid%SNOPCX, SOILTB=grid%SOILTB                 &amp; <font color=#447700>! ruc lsm<a name='778'></font>
     &amp;        ,rhosnf=grid%rhosnf ,precipfr=grid%precipfr                 &amp;   <font color=#447700>! RUC LSM<a name='779'></font>
     &amp;        ,snowfallac=grid%snowfallac                                 &amp;   <font color=#447700>! RUC LSM<a name='780'></font>
     &amp;        ,MOSAIC_LU=config_flags%mosaic_lu                           &amp; <font color=#447700>! RUC LSM<a name='781'></font>
     &amp;        ,MOSAIC_SOIL=config_flags%mosaic_soil                       &amp;   <font color=#447700>! RUC LSM<a name='782'></font>
     &amp;        ,ISURBAN=isurban, MMINLU=TRIM(mminlu)                       &amp;<a name='783'>
     &amp;        ,SNOTIME = grid%SNOTIME                                     &amp;<a name='784'>
     &amp;        ,RDLAI2D=config_flags%rdlai2d                               &amp;<a name='785'>
     &amp;        ,usemonalb=config_flags%usemonalb                           &amp;<a name='786'>
     &amp;        ,NOAHRES=grid%noahres                                       &amp;<a name='787'>
     &amp;        ,TSK_SAVE=grid%tsk_save                                     &amp;<a name='788'>
     &amp;        ,ch=grid%ch,tsq=grid%tsq,qsq=grid%qsq,cov=grid%cov          &amp; <font color=#447700>!MYNN - MP<a name='789'></font>
     &amp;        ,Sh3d=grid%sh3d,EL_PBL=grid%el_pbl                          &amp; <font color=#447700>!JOE- MYNN cloudpdf<a name='790'></font>
     &amp;        ,bl_mynn_cloudpdf=config_flags%bl_mynn_cloudpdf             &amp; <font color=#447700>!JOE- MYNN cloudpdf<a name='791'></font>
     &amp;        ,icloud_bl=config_flags%icloud_bl                           &amp; <font color=#447700>!JOE- subgrid cloud<a name='792'></font>
     &amp;        ,qc_bl=grid%qc_bl,cldfra_bl=grid%cldfra_bl                  &amp; <font color=#447700>!JOE- subgrid cloud<a name='793'></font>
     &amp;        ,fgdp=grid%fgdp,dfgdp=grid%dfgdp,vdfg=grid%vdfg             &amp; <font color=#447700>!Katata - fogdes<a name='794'></font>
     &amp;        ,grav_settling=config_flags%grav_settling                   &amp; <font color=#447700>!Katata - fogdes<a name='795'></font>
     &amp;        ,OM_TMP=grid%om_tmp, OM_S=grid%om_s, OM_U=grid%om_u, OM_V=grid%om_v   &amp; <font color=#447700>!cyl:3DPWP<a name='796'></font>
     &amp;        ,OM_DEPTH=grid%om_depth, OM_ML=grid%OM_ML, OM_LON=grid%om_lon         &amp; <font color=#447700>!cyl:3DPWP<a name='797'></font>
     &amp;        ,OM_LAT=grid%om_lat                                                  &amp; <font color=#447700>!cy:3DPWP<a name='798'></font>
     &amp;        , okms = 1, okme=config_flags%ocean_levels                  &amp; <font color=#447700>! cyl:3DPWP<a name='799'></font>
     &amp;        ,rdx=grid%rdx, rdy=grid%rdy,msfu=grid%msfu,msfv=grid%msfv,msft=grid%msft &amp;<font color=#447700>!cyl: 3DPWP<a name='800'></font>
     &amp;        ,XTIME=grid%xtime,OM_TINI=grid%om_tini,OM_SINI=grid%om_sini,id=grid%id,omdt=config_flags%omdt &amp;<font color=#447700>!cyl: 3DPWP <a name='801'></font>
     &amp;        ,sf_surface_mosaic=config_flags%sf_surface_mosaic,  mosaic_cat=config_flags%mosaic_cat    &amp;<a name='802'>
     &amp;        ,mosaic_cat_index=grid%mosaic_cat_index                                                   &amp;  <font color=#447700>!danli mosaic<a name='803'></font>
     &amp;        ,landusef2=grid%landusef2,TSK_mosaic=grid%TSK_mosaic,QSFC_mosaic=grid%QSFC_mosaic         &amp;<a name='804'>
     &amp;        ,TSLB_mosaic=grid%TSLB_mosaic,SMOIS_mosaic=grid%SMOIS_mosaic,SH2O_mosaic=grid%SH2O_mosaic &amp;  <font color=#447700>!danli mosaic<a name='805'></font>
     &amp;        ,CANWAT_mosaic=grid%CANWAT_mosaic,SNOW_mosaic=grid%SNOW_mosaic                            &amp;<a name='806'>
     &amp;        ,SNOWH_mosaic=grid%SNOWH_mosaic,SNOWC_mosaic=grid%SNOWC_mosaic                            &amp;  <font color=#447700>!danli mosaic<a name='807'></font>
     &amp;        ,ALBEDO_mosaic=grid%ALBEDO_mosaic,ALBBCK_mosaic=grid%ALBBCK_mosaic                        &amp;<a name='808'>
     &amp;        ,EMISS_mosaic=grid%EMISS_mosaic, EMBCK_mosaic=grid%EMBCK_mosaic                           &amp;<a name='809'>
     &amp;        ,ZNT_mosaic=grid%ZNT_mosaic, Z0_mosaic=grid%Z0_mosaic                                     &amp;  <font color=#447700>!danli mosaic<a name='810'></font>
     &amp;        ,HFX_mosaic=grid%HFX_mosaic,QFX_mosaic=grid%QFX_mosaic, LH_mosaic=grid%LH_mosaic          &amp;<a name='811'>
     &amp;        ,GRDFLX_mosaic=grid%GRDFLX_mosaic,SNOTIME_mosaic=grid%SNOTIME_mosaic                      &amp;  <font color=#447700>!danli mosaic<a name='812'></font>
     &amp;        ,TR_URB2D_mosaic=grid%TR_URB2D_mosaic,TB_URB2D_mosaic=grid%TB_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic <a name='813'></font>
     &amp;        ,TG_URB2D_mosaic=grid%TG_URB2D_mosaic,TC_URB2D_mosaic=grid%TC_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic <a name='814'></font>
     &amp;        ,QC_URB2D_mosaic=grid%QC_URB2D_mosaic,UC_URB2D_mosaic=grid%UC_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic<a name='815'></font>
     &amp;        ,TRL_URB3D_mosaic=grid%TRL_URB3D_mosaic,TBL_URB3D_mosaic=grid%TBL_URB3D_mosaic            &amp;  <font color=#447700>!danli mosaic <a name='816'></font>
     &amp;        ,TGL_URB3D_mosaic=grid%TGL_URB3D_mosaic                                                   &amp;  <font color=#447700>!danli mosaic <a name='817'></font>
     &amp;        ,SH_URB2D_mosaic=grid%SH_URB2D_mosaic,LH_URB2D_mosaic=grid%LH_URB2D_mosaic                &amp;  <font color=#447700>!danli mosaic <a name='818'></font>
     &amp;        ,G_URB2D_mosaic=grid%G_URB2D_mosaic,RN_URB2D_mosaic=grid%RN_URB2D_mosaic                  &amp;  <font color=#447700>!danli mosaic <a name='819'></font>
     &amp;        ,TS_URB2D_mosaic=grid%TS_URB2D_mosaic                                                     &amp;  <font color=#447700>!danli mosaic <a name='820'></font>
     &amp;        ,TS_RUL2D_mosaic=grid%TS_RUL2D_mosaic                                                     &amp;  <font color=#447700>!danli mosaic<a name='821'></font>
     &amp;        ,ZOL=grid%ZOL                                                                             &amp;<a name='822'>
     &amp;        ,SDA_HFX=grid%SDA_HFX, SDA_QFX=grid%SDA_QFX,HFX_BOTH=grid%HFX_BOTH                        &amp;  <font color=#447700>!fasdas<a name='823'></font>
     &amp;        ,QFX_BOTH=grid%QFX_BOTH,QNORM=grid%QNORM,fasdas=config_flags%fasdas                       &amp;  <font color=#447700>!fasdas<a name='824'></font>
     &amp;        ,spp_lsm=config_flags%spp_lsm,pattern_spp_lsm=grid%pattern_spp_lsm     &amp; <font color=#447700>!SPP<a name='825'></font>
     &amp;        ,field_sf=grid%field_sf                                                &amp; <font color=#447700>!SPP<a name='826'></font>
     &amp;        ,spp_pbl=config_flags%spp_pbl,pattern_spp_pbl=grid%pattern_spp_pbl     &amp; <font color=#447700>!SPP<a name='827'></font>
     &amp;                                                           )<a name='828'>
<a name='829'>
#ifdef WRF_HYDRO<a name='830'>
        if(HYDRO_dt .gt. 1 ) call wrf_drv_HYDRO(HYDRO_dt, grid,  &amp;<a name='831'>
     &amp;     grid%i_start(1),min(grid%i_end(1), ide-1),      &amp;<a name='832'>
     &amp;     grid%j_start(1),min(grid%j_end(1), jde-1) )<a name='833'>
#endif<a name='834'>
<a name='835'>
BENCH_END(surf_driver_tim)<a name='836'>
<a name='837'>
<font color=#447700>!*********<a name='838'></font>
<font color=#447700>! pbl<a name='839'></font>
<a name='840'>
      CALL wrf_debug ( 200 , ' call pbl_driver' )<a name='841'>
BENCH_START(pbl_driver_tim)<a name='842'>
      CALL <A href='../../html_code/phys/module_pbl_driver.F.html#PBL_DRIVER'>pbl_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="PBL_DRIVER_1">(                                                              &amp;<a name='843'>
     &amp;         AKHS=grid%akhs          ,AKMS=grid%akms                              &amp;<a name='844'>
     &amp;        ,BL_PBL_PHYSICS=config_flags%bl_pbl_physics                           &amp;<a name='845'>
     &amp;        ,WINDFARM_OPT=config_flags%windfarm_opt,power=grid%power              &amp;<a name='846'>
     &amp;        ,BLDT=grid%bldt, CURR_SECS=curr_secs, ADAPT_STEP_FLAG=adapt_step_flag &amp;<a name='847'>
     &amp;        ,BLDTACTTIME=grid%bldtacttime                               &amp;  <a name='848'>
     &amp;        ,BR=grid%br         ,CHKLOWQ=chklowq    ,CT=grid%ct                   &amp;<a name='849'>
     &amp;        ,DT=grid%dt         ,DX=grid%dx         ,DY=grid%dy                   &amp;<a name='850'>
     &amp;        ,DZ8W=dz8w          &amp;<a name='851'>
     &amp;        ,EXCH_H=grid%exch_h     ,EXCH_M=grid%exch_m                           &amp;<a name='852'>
     &amp;        ,FM=grid%fm         ,FHH=grid%fh                                      &amp;<a name='853'>
     &amp;        ,F=grid%f  ,GRDFLX=grid%grdflx      &amp;<a name='854'>
     &amp;        ,GZ1OZ0=gz1oz0      ,HFX=grid%hfx            ,HT=grid%ht              &amp;<a name='855'>
     &amp;        ,ID=grid%id         ,ITIMESTEP=grid%itimestep     ,KPBL=grid%kpbl          &amp;<a name='856'>
     &amp;        ,LH=grid%lh              ,LOWLYR=grid%lowlyr      ,P8W=grid%p_hyd_w   &amp;<a name='857'>
     &amp;        ,PBLH=grid%pblh          ,PI_PHY=pi_phy      ,PSIH=psih          &amp;<a name='858'>
     &amp;        ,PSIM=psim          ,P_PHY=grid%p_hyd        ,QFX=grid%qfx            &amp;<a name='859'>
     &amp;        ,QSFC=grid%qsfc          ,QZ0=grid%qz0  ,MIXHT=mixht                  &amp;<a name='860'>
     &amp;        ,RA_LW_PHYSICS=config_flags%ra_lw_physics                   &amp;<a name='861'>
     &amp;        ,RHO=grid%rho            ,RQCBLTEN=grid%rqcblten  ,RQIBLTEN=grid%rqiblten  &amp;<a name='862'>
     &amp;        ,RQVBLTEN=grid%rqvblten  ,RTHBLTEN=grid%rthblten  ,RUBLTEN=grid%rublten    &amp;<a name='863'>
     &amp;        ,RVBLTEN=grid%rvblten    ,SNOW=grid%snow          ,STEPBL=grid%stepbl      &amp;<a name='864'>
     &amp;        ,THZ0=grid%thz0          ,TH_PHY=th_phy                               &amp;<a name='865'>
     &amp;        ,TSK=grid%tsk            ,T_PHY=grid%t_phy        ,UST=grid%ust       &amp;<a name='866'>
     &amp;        ,U10=grid%u10 ,UZ0=grid%uz0      ,U_FRAME=grid%u_frame    ,U_PHY=grid%u_phy   &amp;<a name='867'>
     &amp;        ,V10=grid%v10 ,VZ0=grid%vz0      ,V_FRAME=grid%v_frame    ,V_PHY=grid%v_phy   &amp;<a name='868'>
     &amp;        ,W=grid%w_2   ,UOCE=grid%uoce    ,VOCE=grid%voce                              &amp;<a name='869'>
              ,T2=grid%t2 &amp;<a name='870'>
     &amp;        ,WARM_RAIN=grid%warm_rain                    ,WSPD=wspd          &amp;<a name='871'>
     &amp;        ,XICE=grid%xice          ,XLAND=grid%xland        ,Z=grid%z                &amp;<a name='872'>
     &amp;        ,ZNT=grid%znt                                                    &amp;<a name='873'>
     &amp;        ,ysu_topdown_pblmix=config_flags%ysu_topdown_pblmix              &amp;<a name='874'>
     &amp;        ,shinhong_tke_diag=config_flags%shinhong_tke_diag               &amp;<a name='875'>
<font color=#447700>! paj: topo_wind<a name='876'></font>
     &amp;        ,CTOPO=grid%ctopo,CTOPO2=grid%ctopo2                                   &amp;<a name='877'>
<font color=#447700>! variables added for BEP<a name='878'></font>
     &amp;          ,FRC_URB2D=grid%frc_urb2d                                                  &amp;<a name='879'>
     &amp;          ,A_U_BEP=grid%a_u_bep,A_V_BEP=grid%a_v_bep,A_T_BEP=grid%a_t_bep          &amp;<a name='880'>
     &amp;          ,A_Q_BEP=grid%a_q_bep                                                    &amp;<a name='881'>
     &amp;          ,B_U_BEP=grid%b_u_bep,B_V_BEP=grid%b_v_bep,B_T_BEP=grid%b_t_bep          &amp;<a name='882'>
     &amp;          ,B_Q_BEP=grid%b_q_bep                                                    &amp;<a name='883'>
     &amp;          ,SF_BEP=grid%sf_bep,VL_BEP=grid%vl_bep                                   &amp;<a name='884'>
     &amp;          ,A_E_BEP=grid%a_e_bep,B_E_BEP=grid%b_e_bep,DLG_BEP=grid%dlg_bep          &amp;<a name='885'>
     &amp;          ,DL_U_BEP=grid%dl_u_bep                                                  &amp;<a name='886'>
     &amp;          ,SF_SFCLAY_PHYSICS=config_flags%sf_sfclay_physics                        &amp;<a name='887'>
     &amp;          ,SF_URBAN_PHYSICS=config_flags%sf_urban_physics                          &amp;<a name='888'>
<font color=#447700>! Bep changes end<a name='889'></font>
<font color=#447700>! add tke_pbl, and turbulent fluxes<a name='890'></font>
     &amp;          ,TKE_PBL=grid%tke_pbl,EL_PBL=grid%el_pbl,WU_TUR=grid%wu_tur              &amp;<a name='891'>
     &amp;          ,WV_tur=grid%wv_tur,WT_tur=grid%wt_tur,WQ_tur=grid%wq_tur                &amp;<a name='892'>
<font color=#447700>! end add tke_pbl, and turbulent fluxes<a name='893'></font>
<font color=#447700>! GBMPBL change: add exch_tke, rthraten<a name='894'></font>
     &amp;        ,EXCH_TKE=grid%exch_tke, RTHRATEN=grid%rthraten             &amp;<a name='895'>
     &amp;        ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde          &amp;<a name='896'>
     &amp;        ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme          &amp;<a name='897'>
     &amp;        ,I_START=grid%i_start,I_END=min(grid%i_end, ide-1)          &amp;<a name='898'>
     &amp;        ,J_START=grid%j_start,J_END=min(grid%j_end, jde-1)          &amp;<a name='899'>
     &amp;        ,KTS=k_start, KTE=min(k_end,kde-1)                          &amp;<a name='900'>
     &amp;        ,NUM_TILES=grid%num_tiles                                   &amp;<a name='901'>
          <font color=#447700>! Variables Required by ACM PBL  - jp<a name='902'></font>
     &amp;        ,ZNU=grid%znu,ZNW=grid%znw,MUT=grid%mut,P_TOP=grid%p_top    &amp;<a name='903'>
          <font color=#447700>! Variables required by TEMF PBL - WA 9/9/08<a name='904'></font>
              ,te_temf=grid%te_temf                                 &amp;<a name='905'>
              ,kh_temf=grid%kh_temf,km_temf=grid%km_temf            &amp;<a name='906'>
              ,shf_temf=grid%shf_temf,qf_temf=grid%qf_temf          &amp;<a name='907'>
              ,uw_temf=grid%uw_temf,vw_temf=grid%vw_temf            &amp;<a name='908'>
              ,hd_temf=grid%hd_temf,lcl_temf=grid%lcl_temf          &amp;<a name='909'>
              ,wupd_temf=grid%wupd_temf,mf_temf=grid%mf_temf          &amp;<a name='910'>
              ,thup_temf=grid%thup_temf,qtup_temf=grid%qtup_temf          &amp;<a name='911'>
              ,qlup_temf=grid%qlup_temf          &amp;<a name='912'>
              ,cf3d_temf=grid%cf3d_temf,cfm_temf=grid%cfm_temf          &amp;<a name='913'>
              ,hct_temf=grid%hct_temf                               &amp;<a name='914'>
              ,flhc=grid%flhc,flqc=grid%flqc                        &amp;<a name='915'>
              ,exch_temf=exch_temf                      &amp;<a name='916'>
          <font color=#447700>! optional<a name='917'></font>
     &amp;        ,QV_CURR=moist(ims,kms,jms,P_QV), F_QV=F_QV                 &amp;<a name='918'>
     &amp;        ,QC_CURR=moist(ims,kms,jms,P_QC), F_QC=F_QC                 &amp;<a name='919'>
     &amp;        ,QR_CURR=moist(ims,kms,jms,P_QR), F_QR=F_QR                 &amp;<a name='920'>
     &amp;        ,QI_CURR=moist(ims,kms,jms,P_QI), F_QI=F_QI                 &amp;<a name='921'>
     &amp;        ,QS_CURR=moist(ims,kms,jms,P_QS), F_QS=F_QS                 &amp;<a name='922'>
     &amp;        ,QG_CURR=moist(ims,kms,jms,P_QG), F_QG=F_QG                 &amp;<a name='923'>
     &amp;        ,HOL=HOL, MOL=grid%mol, REGIME=grid%REGIME                  &amp;<a name='924'>
<font color=#447700>!mynn mp@<a name='925'></font>
     &amp;        ,QKE=grid%qke, Sh3d=grid%sh3d                               &amp;<a name='926'>
     &amp;        ,QKE_ADV=scalar(ims,kms,jms,P_qke_adv)                      &amp; <font color=#447700>!ACF-QKE advection<a name='927'></font>
     &amp;        ,bl_mynn_tkeadvect=config_flags%bl_mynn_tkeadvect           &amp; <font color=#447700>!ACF-QKE advection<a name='928'></font>
     &amp;        ,tsq=grid%tsq, qsq=grid%qsq, cov=grid%cov                   &amp;<a name='929'>
     &amp;        ,DQKE=grid%dqke,QWT=grid%qWT                                &amp;<a name='930'>
     &amp;        ,QSHEAR=grid%qSHEAR,QBUOY=grid%qBUOY,QDISS=grid%qDISS       &amp;<a name='931'>
     &amp;        ,bl_mynn_tkebudget=config_flags%bl_mynn_tkebudget           &amp;<a name='932'>
     &amp;        ,bl_mynn_cloudpdf=config_flags%bl_mynn_cloudpdf             &amp;<a name='933'>
     &amp;        ,bl_mynn_mixlength=config_flags%bl_mynn_mixlength           &amp;<a name='934'>
     &amp;        ,icloud_bl=config_flags%icloud_bl                           &amp;<a name='935'>
     &amp;        ,qc_bl=grid%qc_bl,cldfra_bl=grid%cldfra_bl                  &amp;<a name='936'>
     &amp;        ,bl_mynn_edmf=config_flags%bl_mynn_edmf                     &amp;<a name='937'>
     &amp;        ,bl_mynn_edmf_mom=config_flags%bl_mynn_edmf_mom             &amp;<a name='938'>
     &amp;        ,bl_mynn_edmf_tke=config_flags%bl_mynn_edmf_tke             &amp;<a name='939'>
     &amp;        ,bl_mynn_edmf_part=config_flags%bl_mynn_edmf_part           &amp;<a name='940'>
     &amp;        ,bl_mynn_cloudmix=config_flags%bl_mynn_cloudmix             &amp;<a name='941'>
     &amp;        ,bl_mynn_mixqt=config_flags%bl_mynn_mixqt                   &amp;<a name='942'>
     &amp;        ,edmf_a=grid%edmf_a,edmf_w=grid%edmf_w                      &amp;<a name='943'>
     &amp;        ,edmf_thl=grid%edmf_thl,edmf_qt=grid%edmf_qt                &amp;<a name='944'>
     &amp;        ,edmf_ent=grid%edmf_ent,edmf_qc=grid%edmf_qc                &amp;<a name='945'>
     &amp;        ,rmol=grid%rmol, ch=grid%ch                                 &amp;<a name='946'>
     &amp;        ,qcg=grid%qcg, grav_settling=config_flags%grav_settling     &amp;<a name='947'>
<font color=#447700>!    &amp;        ,K_m=grid%K_m, K_h=grid%K_h, K_q=grid%K_q                   &amp;<a name='948'></font>
     &amp;        ,vdfg=grid%vdfg                                             &amp;<a name='949'>
     &amp;        ,spp_pbl=config_flags%spp_pbl                               &amp; <font color=#447700>!SPP<a name='950'></font>
     &amp;        ,pattern_spp_pbl=grid%pattern_spp_pbl                       &amp; <font color=#447700>!SPP<a name='951'></font>
<font color=#447700>!GWD for ARW<a name='952'></font>
     &amp;        ,GWD_OPT=config_flags%gwd_opt &amp;<a name='953'>
     &amp;        ,DTAUX3D=grid%dtaux3d,DTAUY3D=grid%dtauy3d &amp;<a name='954'>
     &amp;        ,DUSFCG=grid%dusfcg,DVSFCG=grid%dvsfcg &amp;<a name='955'>
     &amp;        ,VAR2D=grid%var2d,OC12D=grid%oc12d     &amp;<a name='956'>
     &amp;        ,OA1=grid%oa1,OA2=grid%oa2,OA3=grid%oa3,OA4=grid%oa4        &amp;<a name='957'>
     &amp;        ,OL1=grid%ol1,OL2=grid%ol2,OL3=grid%ol3,OL4=grid%ol4        &amp;<a name='958'>
     &amp;        ,MFSHCONV=config_flags%mfshconv                             &amp;<a name='959'>
     &amp;        ,MASSFLUX_EDKF=grid%massflux_EDKF                           &amp; <a name='960'>
     &amp;        ,ENTR_EDKF=grid%entr_EDKF, DETR_EDKF=grid%detr_EDKF         &amp;<a name='961'>
     &amp;        ,THL_UP=grid%thl_up                                         &amp;<a name='962'>
     &amp;        ,THV_UP=grid%thv_up, RT_UP=grid%rt_up ,RV_UP=grid%rv_up     &amp;<a name='963'>
     &amp;        ,RC_UP=grid%rc_up, U_UP=grid% u_up, V_UP=grid%v_up          &amp;<a name='964'>
     &amp;        ,FRAC_UP=grid%frac_up, RC_MF=grid%RC_MF                     &amp;<a name='965'>
<font color=#447700>! For Wind Turbine Drag Parameterizations<a name='966'></font>
     &amp;        ,phb=grid%phb                                               &amp;<a name='967'>
     &amp;        ,XLAT_U=grid%xlat_u,XLONG_U=grid%xlong_u                    &amp;<a name='968'>
<font color=#447700>!Variables required for camuwpbl scheme<a name='969'></font>
     &amp;        ,Z_AT_W=grid%z_at_w,CLDFRA_OLD_MP=grid%cldfra_old_mp        &amp;<a name='970'>
     &amp;        ,CLDFRA=grid%cldfra                                        &amp;<a name='971'>
     &amp;        ,RTHRATENLW=grid%rthratenlw,TAURESX2D=grid%tauresx2d        &amp;<a name='972'>
     &amp;        ,TAURESY2D=grid%tauresy2d                                   &amp;<a name='973'>
     &amp;        ,TPERT2D=grid%tpert2d,QPERT2D=grid%qpert2d                  &amp;<a name='974'>
     &amp;        ,WPERT2D=grid%wpert2d,WSEDL3D=grid%wsedl3d                  &amp;<a name='975'>
     &amp;        ,TURBTYPE3D=grid%turbtype3d,SMAW3D=grid%smaw3d              &amp;<a name='976'>
     &amp;        ,QNC_CURR=scalar(ims,kms,jms,P_QNC), F_QNC=f_qnc            &amp;<a name='977'>
     &amp;        ,QNI_CURR=scalar(ims,kms,jms,P_QNI), F_QNI=f_qni            &amp;<a name='978'>
     &amp;        ,RQNIBLTEN=grid%rqniblten                                   &amp;<a name='979'>
     &amp;        ,XLAT_V=grid%xlat_v,XLONG_V=grid%xlong_v,FNM=grid%fnm       &amp;<a name='980'>
     &amp;        ,FNP=grid%fnp, IS_CAMMGMP_USED = grid%is_CAMMGMP_used       &amp;<a name='981'>
<font color=#447700>! for grims shallow convection with ysupbl<a name='982'></font>
     &amp;        ,WSTAR=grid%wstar_ysu,DELTA=grid%delta_ysu                  &amp;<a name='983'>
<font color=#447700>! for pbl mixing of scalars and tracers<a name='984'></font>
     &amp;        ,SCALAR=scalar,SCALAR_TEND=scalar_tend,NUM_SCALAR=num_scalar&amp;<a name='985'>
     &amp;        ,TRACER=tracer,TRACER_TEND=tracer_tend,NUM_TRACER=num_tracer&amp;<a name='986'>
     &amp;        ,SCALAR_PBLMIX=config_flags%scalar_pblmix                  &amp;<a name='987'>
     &amp;        ,TRACER_PBLMIX=config_flags%tracer_pblmix                  &amp;<a name='988'>
#if (WRF_CHEM == 1)<a name='989'>
     &amp;        ,CHEM=chem,VD=grid%dep_vel                                 &amp;<a name='990'>
     &amp;        ,NCHEM=num_chem,kdvel=config_flags%kdepvel                 &amp;<a name='991'>
     &amp;        ,ndvel=config_flags%ndepvel                                &amp;<a name='992'>
     &amp;        ,NUM_VERT_MIX=grid%num_vert_mix                            &amp;<a name='993'>
#endif<a name='994'>
     &amp;        ,QNORM=grid%QNORM, fasdas=config_flags%fasdas              &amp; <font color=#447700>!fasdas<a name='995'></font>
     &amp;        )<a name='996'>
<a name='997'>
#if (WRF_CHEM == 1)<a name='998'>
#ifdef DM_PARALLEL<a name='999'>
     IF ( num_chem &gt;= PARAM_FIRST_SCALAR .AND. (config_flags%bl_pbl_physics == &amp;<a name='1000'>
     &amp; mynnpblscheme2 .OR. config_flags%bl_pbl_physics == mynnpblscheme3)  ) then<a name='1001'>
         CALL wrf_debug ( 200 , ' call HALO CHEM AFTER PBL' )<a name='1002'>
         IF      ( config_flags%h_sca_adv_order &lt;= 4 ) THEN<a name='1003'>
#      include "<A href='../../html_code/include/HALO_EM_CHEM_E_3.inc.html'>HALO_EM_CHEM_E_3.inc</A>"<A NAME="HALO_EM_CHEM_E_3.inc_4"><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1004'>
         ELSE IF ( config_flags%h_sca_adv_order &lt;= 6 ) THEN<a name='1005'>
#      include "<A href='../../html_code/include/HALO_EM_CHEM_E_5.inc.html'>HALO_EM_CHEM_E_5.inc</A>"<A NAME="HALO_EM_CHEM_E_5.inc_5"><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1006'>
         ELSE<a name='1007'>
              WRITE(message,*)'solve_em: invalid h_mom_adv_order = ',&amp;<a name='1008'>
              &amp; config_flags%h_mom_adv_order<a name='1009'>
        ENDIF<a name='1010'>
     ENDIF<a name='1011'>
#endif<a name='1012'>
#endif<a name='1013'>
<a name='1014'>
BENCH_END(pbl_driver_tim)<a name='1015'>
<a name='1016'>
<font color=#447700>!*****<a name='1017'></font>
<font color=#447700>! fire <a name='1018'></font>
<a name='1019'>
<font color=#447700>! Jan Mandel's call to SFIRE<a name='1020'></font>
<a name='1021'>
      IF ((grid%sr_x &gt; 0 .OR. grid%sr_y &gt; 0) .AND. config_flags%ifire == 2) THEN<a name='1022'>
<a name='1023'>
BENCH_START(fire_driver_tim)<a name='1024'>
        if(config_flags%ifire.eq.2)then <a name='1025'>
            <font color=#447700>! initialization moved to start_em:start_domain_em<a name='1026'></font>
<font color=#447700>!            if(grid%initestep.eq.1) &amp;<a name='1027'></font>
<font color=#447700>!            call fire_driver_em_init (  grid , config_flags    &amp;<a name='1028'></font>
<font color=#447700>!            ,ids,ide, kds,kde, jds,jde                              &amp;<a name='1029'></font>
<font color=#447700>!            ,ims,ime, kms,kme, jms,jme                              &amp;<a name='1030'></font>
<font color=#447700>!            ,ips,ipe, kps,kpe, jps,jpe  )<a name='1031'></font>
            <font color=#447700>! one timestep of the fire model<a name='1032'></font>
            call <A href='../../html_code/phys/module_fr_fire_driver_wrf.F.html#FIRE_DRIVER_EM_STEP'>fire_driver_em_step</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FIRE_DRIVER_EM_STEP_1"> (  grid , config_flags    &amp;<a name='1033'>
            ,ids,ide, kds,kde, jds,jde                              &amp;<a name='1034'>
            ,ims,ime, kms,kme, jms,jme                              &amp;<a name='1035'>
            ,ips,ipe, kps,kpe, jps,jpe                              &amp;<a name='1036'>
            ,grid%rho,grid%z_at_w,dz8w)<a name='1037'>
        endif<a name='1038'>
<a name='1039'>
BENCH_END(fire_driver_tim)<a name='1040'>
       ENDIF<a name='1041'>
<a name='1042'>
<a name='1043'>
<font color=#447700>! cumulus para.<a name='1044'></font>
<a name='1045'>
      CALL wrf_debug ( 200 , ' call cumulus_driver' )<a name='1046'>
<a name='1047'>
#if ( WRF_DFI_RADAR == 1 )<a name='1048'>
      do_capsupress=0<a name='1049'>
         if(grid%dfi_stage == DFI_FWD ) do_capsupress=1<a name='1050'>
         if(grid%itimestep &lt;= 31 .and. grid%dfi_stage == DFI_FST ) do_capsupress=1<a name='1051'>
#endif<a name='1052'>
<a name='1053'>
BENCH_START(cu_driver_tim)<a name='1054'>
      CALL <A href='../../html_code/phys/module_cumulus_driver.F.html#CUMULUS_DRIVER'>cumulus_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CUMULUS_DRIVER_1">(grid                                             &amp;<a name='1055'>
                 <font color=#447700>! Prognostic variables<a name='1056'></font>
     &amp;             ,U=grid%u_phy   ,V=grid%v_phy   ,TH=th_phy  ,T=grid%t_phy                  &amp;<a name='1057'>
     &amp;             ,W=grid%w_2     ,P=grid%p_hyd   ,PI=pi_phy  ,RHO=grid%rho             &amp;<a name='1058'>
                 <font color=#447700>! Other arguments<a name='1059'></font>
     &amp;             ,ITIMESTEP=grid%itimestep ,DT=grid%dt      ,DX=grid%dx              &amp;<a name='1060'>
     &amp;             ,CUDT=grid%cudt,CURR_SECS=curr_secs,ADAPT_STEP_FLAG=adapt_step_flag &amp;<a name='1061'>
     &amp;             ,CUDTACTTIME=grid%cudtacttime                                       &amp; <a name='1062'>
     &amp;             ,RAINC=grid%rainc   ,RAINCV=grid%raincv   ,PRATEC=grid%pratec       &amp;<a name='1063'>
     &amp;             ,NCA=grid%nca                                                       &amp;<a name='1064'>
     &amp;             ,CLDFRA_DP=grid%cldfra_dp  ,CLDFRA_SH=grid%cldfra_sh,W_UP=grid%w_up &amp; <font color=#447700>! ckay for subgrid cloud<a name='1065'></font>
     &amp;             ,QC_CU=grid%QC_CU ,QI_CU=grid%QI_CU                                 &amp;<a name='1066'>
     &amp;             ,UDR_KF=grid%udr_kf,DDR_KF=grid%ddr_kf                              &amp; <font color=#447700>! kf_edrates<a name='1067'></font>
     &amp;             ,UER_KF=grid%uer_kf,DER_KF=grid%der_kf,TIMEC_KF=grid%timec_kf       &amp;<a name='1068'>
     &amp;             ,KF_EDRATES=config_flags%kf_edrates                                 &amp;<a name='1069'>
     &amp;             ,HTOP=grid%cutop     ,HBOT=grid%cubot       ,KPBL=grid%kpbl         &amp;<a name='1070'>
     &amp;             ,Z=grid%z ,Z_AT_W=grid%z_at_w ,MAVAIL=grid%mavail ,PBLH=grid%pblh   &amp;<a name='1071'>
     &amp;             ,DZ8W=dz8w     ,P8W=grid%p_hyd_w, PSFC=grid%psfc, TSK=grid%tsk      &amp;<a name='1072'>
     &amp;             ,TKE_PBL=grid%tke_pbl, UST=grid%ust                                 &amp;<a name='1073'>
     &amp;             ,W0AVG=grid%w0avg   ,STEPCU=grid%stepcu                             &amp;<a name='1074'>
     &amp;             ,CLDEFI=grid%cldefi ,LOWLYR=grid%lowlyr ,XLAND=grid%xland           &amp;<a name='1075'>
     &amp;             ,APR_GR=grid%apr_gr ,APR_W=grid%apr_w   ,APR_MC=grid%apr_mc         &amp;<a name='1076'>
     &amp;             ,APR_ST=grid%apr_st ,APR_AS=grid%apr_as ,APR_CAPMA=grid%apr_capma   &amp;<a name='1077'>
     &amp;             ,APR_CAPME=grid%apr_capme          ,APR_CAPMI=grid%apr_capmi     &amp;<a name='1078'>
     &amp;             ,MASS_FLUX=grid%mass_flux          ,XF_ENS=grid%xf_ens           &amp;<a name='1079'>
     &amp;             ,PR_ENS=grid%pr_ens ,HT=grid%ht,EDT_OUT=grid%edt_out             &amp;<a name='1080'>
     &amp;             ,imomentum=grid%imomentum,clos_choice=grid%clos_choice           &amp;<a name='1081'>
     &amp;             ,ishallow=config_flags%ishallow                                  &amp;<a name='1082'>
     &amp;             ,cugd_tten=grid%cugd_tten,cugd_qvten=grid%cugd_qvten,cugd_qcten=grid%cugd_qcten   &amp;<a name='1083'>
     &amp;             ,cugd_ttens=grid%cugd_ttens,cugd_qvtens=grid%cugd_qvtens   &amp;<a name='1084'>
     &amp;             ,ENSDIM=config_flags%ensdim ,MAXIENS=config_flags%maxiens ,MAXENS=config_flags%maxens         &amp;<a name='1085'>
     &amp;             ,MAXENS2=config_flags%maxens2 ,MAXENS3=config_flags%maxens3       &amp;<a name='1086'>
     &amp;             ,CU_ACT_FLAG=cu_act_flag   ,WARM_RAIN=grid%warm_rain   &amp;<a name='1087'>
     &amp;             ,HFX=grid%hfx, QFX=grid%qfx                            &amp;<a name='1088'>
     &amp;             ,CLDFRA=grid%cldfra,CLDFRA_MP_ALL=grid%cldfra_mp_all  &amp;<a name='1089'>
     &amp;             ,TPERT2D=grid%tpert2d                                 &amp;<a name='1090'>
     &amp;             ,GSW=grid%gsw,cugd_avedx=config_flags%cugd_avedx       &amp;<a name='1091'>
     <font color=#447700>!BSINGH - For WRFCuP scheme<a name='1092'></font>
     &amp;             ,AKPBL=grid%akpbl,BR=grid%br, REGIME=grid%regime, T2=grid%t2, Q2=grid%q2   &amp; <font color=#447700>!CuP, wig 3-Aug-2006<a name='1093'></font>
     &amp;             ,SLOPESFC=grid%slopeSfc, SLOPEEZ=grid%slopeEZ                    &amp; <font color=#447700>!CuP, wig 7-Aug-2006<a name='1094'></font>
     &amp;             ,SIGMASFC=grid%sigmaSfc, SIGMAEZ=grid%sigmaEZ                    &amp; <font color=#447700>!CuP, wig 7-Aug-2006<a name='1095'></font>
     &amp;             ,CUPFLAG=grid%cupflag                                       &amp; <font color=#447700>!CuP, wig 9-Oct-2006<a name='1096'></font>
     &amp;             ,CLDFRA_CUP=grid%cldfra_cup, CLDFRATEND_CUP=grid%cldfratend_cup  &amp; <font color=#447700>!CuP, wig 18-Sep-2006<a name='1097'></font>
     &amp;             ,SHALL=grid%shall, TAUCLOUD=grid%taucloud, TACTIVE=grid%tactive       &amp; <font color=#447700>!CuP, wig 18-Sep-2006<a name='1098'></font>
     &amp;             ,TSTAR=grid%tstar, LNTERMS=grid%lnterms, LNINT=grid%lnint             &amp; <font color=#447700>!CuP, wig 4-Oct-2006<a name='1099'></font>
     &amp;             ,ACTIVEFRAC=grid%activeFrac                                 &amp; <font color=#447700>!CuP, lkb<a name='1100'></font>
     &amp;             ,NUMBINS=config_flags%numBins                               &amp; <font color=#447700>!CuP, wig<a name='1101'></font>
     &amp;             ,THBINSIZE=config_flags%thBinSize                           &amp; <font color=#447700>!CuP, wig<a name='1102'></font>
     &amp;             ,RBINSIZE=config_flags%rBinSize                             &amp; <font color=#447700>!CuP, wig<a name='1103'></font>
     &amp;             ,MINDEEPFREQ=config_flags%minDeepFreq                       &amp; <font color=#447700>!CuP, wig<a name='1104'></font>
     &amp;             ,MINSHALLOWFREQ=config_flags%minShallowFreq                 &amp; <font color=#447700>!CuP, wig<a name='1105'></font>
     &amp;             ,WCLOUDBASE=grid%wCloudBase                                 &amp; <font color=#447700>!CuP, lkb<a name='1106'></font>
     &amp;             ,WACT_CUP=grid%wact_cup                                     &amp; <font color=#447700>!CuP, rce 25-aug-2011<a name='1107'></font>
     &amp;             ,WULCL_CUP=grid%wulcl_cup                                   &amp; <font color=#447700>!CuP, rce 23-jan-2012<a name='1108'></font>
     &amp;             ,WUP_CUP=grid%wup_cup                                       &amp; <font color=#447700>!CuP, rce 15-mar-2013 !BSINGH(12/05/2013)<a name='1109'></font>
     &amp;             ,QC_IC_CUP=grid%qc_ic_cup                                   &amp; <font color=#447700>!CuP, rce 29-aug-2011<a name='1110'></font>
     &amp;             ,QNDROP_IC_CUP=grid%qndrop_ic_cup                           &amp; <font color=#447700>!CuP, rce 29-aug-2011<a name='1111'></font>
     &amp;             ,QC_IU_CUP=grid%qc_iu_cup                                   &amp; <font color=#447700>!CuP, rce 08-feb-2012<a name='1112'></font>
     &amp;             ,FCVT_QC_TO_PR_CUP=grid%fcvt_qc_to_pr_cup                   &amp; <font color=#447700>!CuP, rce 12-apr-2012<a name='1113'></font>
     &amp;             ,FCVT_QC_TO_QI_CUP=grid%fcvt_qc_to_qi_cup                   &amp; <font color=#447700>!CuP, rce 12-apr-2012<a name='1114'></font>
     &amp;             ,FCVT_QI_TO_PR_CUP=grid%fcvt_qi_to_pr_cup                   &amp; <font color=#447700>!CuP, rce 12-apr-2012<a name='1115'></font>
     &amp;             ,MFUP_CUP=grid%mfup_cup                                     &amp; <font color=#447700>!CuP, rce 23-jan-2012<a name='1116'></font>
     &amp;             ,MFUP_ENT_CUP=grid%mfup_ent_cup                             &amp; <font color=#447700>!CuP, rce 23-jan-2012<a name='1117'></font>
     &amp;             ,MFDN_CUP=grid%mfdn_cup                                     &amp; <font color=#447700>!CuP, rce 12-apr-2012<a name='1118'></font>
     &amp;             ,MFDN_ENT_CUP=grid%mfdn_ent_cup                             &amp; <font color=#447700>!CuP, rce 12-apr-2012<a name='1119'></font>
     &amp;             ,UPDFRA_CUP=grid%updfra_cup                                 &amp; <font color=#447700>!CuP, rce 23-jan-2012<a name='1120'></font>
     &amp;             ,TCLOUD_CUP=grid%tcloud_cup                                 &amp; <font color=#447700>!CuP, rce 06-feb-2012<a name='1121'></font>
     <font color=#447700>!BSINGH -ENDS<a name='1122'></font>
     &amp;             ,k22_shallow=grid%k22_shallow,kbcon_shallow=grid%kbcon_shallow &amp;<a name='1123'>
     &amp;             ,ktop_shallow=grid%ktop_shallow,xmb_shallow=grid%xmb_shallow   &amp;<a name='1124'>
     &amp;             ,ktop_deep=grid%ktop_deep                              &amp;<a name='1125'>
     &amp;             ,PERIODIC_X=(config_flags%polar .OR. config_flags%periodic_x)  &amp;<a name='1126'>
     &amp;             ,PERIODIC_Y=config_flags%periodic_y                    &amp;<a name='1127'>
     &amp;             ,IS_CAMMGMP_USED = grid%is_CAMMGMP_used  &amp; <font color=#447700>!BSINGH - TKE at the interfaces for Zhang-McFarlane Scheme <a name='1128'></font>
                 <font color=#447700>! Zhang-McFarlane outputs<a name='1129'></font>
     &amp;             ,EVAPCDP3D=grid%evapcdp3d, ICWMRDP3D=grid%icwmrdp3d    &amp; <font color=#447700>!Balwinder.Singh@pnnl.gov: For CAM's wetscavenging<a name='1130'></font>
     &amp;             ,RPRDDP3D=grid%rprddp3d                                &amp; <a name='1131'>
     &amp;             ,CAPE=grid%cape ,ZMMU=grid%zmmu ,ZMMD=grid%zmmd        &amp;<a name='1132'>
     &amp;             ,ZMDT=grid%zmdt ,ZMDQ=grid%zmdq                        &amp;<a name='1133'>
     &amp;             ,DLF=grid%dlf, RLIQ=grid%rliq                          &amp;<a name='1134'>
     &amp;             ,PCONVB=grid%pconvb, PCONVT=grid%pconvt                &amp;<a name='1135'>
     &amp;             ,EVAPTZM=grid%evaptzm, FZSNTZM=grid%fzsntzm, EVSNTZM=grid%evsntzm     &amp;<a name='1136'>
     &amp;             ,EVAPQZM=grid%evapqzm, ZMFLXPRC=grid%zmflxprc          &amp;<a name='1137'>
     &amp;             ,ZMFLXSNW=grid%zmflxsnw, ZMNTPRPD=grid%zmntprpd        &amp;<a name='1138'>
     &amp;             ,ZMNTSNPD=grid%zmntsnpd, ZMEIHEAT=grid%zmeiheat        &amp;<a name='1139'>
     &amp;             ,CMFMC=grid%cmfmc, CMFMCDZM=grid%cmfmcdzm              &amp;<a name='1140'>
     &amp;             ,PRECCDZM=grid%preccdzm, PRECZ=grid%precz              &amp;<a name='1141'>
     &amp;             ,ZMMTU=grid%zmmtu, ZMMTV=grid%zmmtv  &amp;<a name='1142'>
     &amp;             ,ZMUPGU=grid%zmupgu, ZMUPGD=grid%zmupgd                &amp;<a name='1143'>
     &amp;             ,ZMVPGU=grid%zmvpgu, ZMVPGD=grid%zmvpgd                &amp;<a name='1144'>
     &amp;             ,ZMICUU=grid%zmicuu, ZMICUD=grid%zmicud                &amp;<a name='1145'>
     &amp;             ,ZMICVU=grid%zmicvu, ZMICVD=grid%zmicvd                &amp;<a name='1146'>
     &amp;             ,ZMDICE=grid%zmdice, ZMDLIQ=grid%zmdliq                &amp;<a name='1147'>
     &amp;             ,dp3d=grid%dp3d, du3d=grid%du3d, ed3d=grid%ed3d        &amp;<a name='1148'>
     &amp;             ,eu3d=grid%eu3d, md3d=grid%md3d, mu3d=grid%mu3d        &amp;<a name='1149'>
     &amp;             ,dsubcld2d=grid%dsubcld2d,ideep2d=grid%ideep2d         &amp;<a name='1150'>
     &amp;             ,jt2d=grid%jt2d,maxg2d=grid%maxg2d                     &amp;<a name='1151'>
     &amp;             ,lengath2d=grid%lengath2d                              &amp;<a name='1152'>
                 <font color=#447700>! Selection flag<a name='1153'></font>
     &amp;             ,pgcon=config_flags%sas_pgcon                          &amp;<a name='1154'>
     &amp;             ,CU_PHYSICS=config_flags%cu_physics                    &amp;<a name='1155'>
     &amp;             ,BL_PBL_PHYSICS=config_flags%bl_pbl_physics            &amp;<a name='1156'>
     &amp;             ,SF_SFCLAY_PHYSICS=config_flags%sf_sfclay_physics      &amp;<a name='1157'>
     <font color=#447700>!BSINGH - For WRFCuP scheme<a name='1158'></font>
     &amp;             ,SHCU_AEROSOLS_OPT=config_flags%shcu_aerosols_opt           &amp; <font color=#447700>!CuP, rce 22-aug-2011<a name='1159'></font>
     <font color=#447700>!BSINGH -ENDS<a name='1160'></font>
     &amp;             ,KFETA_TRIGGER=config_flags%kfeta_trigger              &amp;<a name='1161'>
     &amp;             ,NSAS_DX_FACTOR=config_flags%nsas_dx_factor            &amp;<a name='1162'>
                 <font color=#447700>! Dimension arguments<a name='1163'></font>
     &amp;             ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde     &amp;<a name='1164'>
     &amp;             ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme     &amp;<a name='1165'>
     &amp;             ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe     &amp;<a name='1166'>
     &amp;             ,I_START=grid%i_start,I_END=min(grid%i_end, ide-1)     &amp;<a name='1167'>
     &amp;             ,J_START=grid%j_start,J_END=min(grid%j_end, jde-1)     &amp;<a name='1168'>
     &amp;             ,KTS=k_start, KTE=min(k_end,kde-1)                     &amp;<a name='1169'>
     &amp;             ,NUM_TILES=grid%num_tiles                              &amp;<a name='1170'>
                 <font color=#447700>! Moisture tendency arguments<a name='1171'></font>
     &amp;             ,RQVCUTEN=grid%rqvcuten , RQCCUTEN=grid%rqccuten       &amp;<a name='1172'>
     &amp;             ,RQSCUTEN=grid%rqscuten , RQICUTEN=grid%rqicuten       &amp;<a name='1173'>
     &amp;             ,RQRCUTEN=grid%rqrcuten , RQCNCUTEN=grid%rqcncuten     &amp;<a name='1174'>
     &amp;             ,RQINCUTEN=grid%rqincuten                              &amp;<a name='1175'>
     &amp;             ,RQVBLTEN=grid%rqvblten , RQVFTEN=grid%rqvften         &amp;<a name='1176'>
                 <font color=#447700>! Other tendency arguments<a name='1177'></font>
     &amp;             ,RTHRATEN=grid%rthraten , RTHBLTEN=grid%rthblten       &amp;<a name='1178'>
     &amp;             ,RUCUTEN=grid%rucuten   , RVCUTEN=grid%rvcuten         &amp;<a name='1179'>
     &amp;             ,RTHCUTEN=grid%rthcuten , RTHFTEN=grid%rthften         &amp;<a name='1180'>
                 <font color=#447700>! Moisture tracer arguments<a name='1181'></font>
     &amp;             ,QV_CURR=moist(ims,kms,jms,P_QV), F_QV=F_QV            &amp;<a name='1182'>
     &amp;             ,QC_CURR=moist(ims,kms,jms,P_QC), F_QC=F_QC            &amp;<a name='1183'>
     &amp;             ,QR_CURR=moist(ims,kms,jms,P_QR), F_QR=F_QR            &amp;<a name='1184'>
     &amp;             ,QI_CURR=moist(ims,kms,jms,P_QI), F_QI=F_QI            &amp;<a name='1185'>
     &amp;             ,QS_CURR=moist(ims,kms,jms,P_QS), F_QS=F_QS            &amp;<a name='1186'>
     &amp;             ,QG_CURR=moist(ims,kms,jms,P_QG), F_QG=F_QG            &amp;<a name='1187'>
     &amp;             ,ZOL=grid%ZOL,WSTAR=grid%wstar_ysu                     &amp; <font color=#447700>!ckay<a name='1188'></font>
<font color=#447700>! Variables for Tiedtke and NSAS schemes<a name='1189'></font>
     &amp;             ,ZNU=grid%znu                                          &amp;<a name='1190'>
     &amp;             ,MP_PHYSICS=config_flags%mp_physics                    &amp;<a name='1191'>
     &amp;             ,GD_CLOUD=grid%GD_CLOUD,GD_CLOUD2=grid%GD_CLOUD2       &amp;<a name='1192'>
#if (WRF_CHEM == 1)<a name='1193'>
     &amp;             ,CHEM_OPT=config_flags%chem_opt                             &amp; <font color=#447700>!CuP, rce 22-aug-2011 !BSINGH - For WRFCuP scheme<a name='1194'></font>
#endif<a name='1195'>
<a name='1196'>
#if ( WRF_DFI_RADAR == 1 )<a name='1197'>
     &amp;             ,DO_CAPSUPPRESS=do_capsupress                          &amp;<a name='1198'>
#endif<a name='1199'>
     &amp;             ,cfu1=grid%cfu1,cfd1=grid%cfd1,dfu1=grid%dfu1,efu1=grid%efu1,dfd1=grid%dfd1,efd1=grid%efd1,f_flux=l_flux)<a name='1200'>
BENCH_END(cu_driver_tim)<a name='1201'>
<font color=#447700>!<a name='1202'></font>
<font color=#447700>! this for calculating (G3 scheme only)  time averaged variables for online (WRF-CHem) or offline (other models) chem runs<a name='1203'></font>
<font color=#447700>!<a name='1204'></font>
     if(config_flags%cu_diag.eq.1)then<a name='1205'>
      <font color=#447700>!$OMP PARALLEL DO   &amp;<a name='1206'></font>
      <font color=#447700>!$OMP PRIVATE ( ij )<a name='1207'></font>
      DO ij = 1 , grid%num_tiles<a name='1208'>
           call <A href='../../html_code/dyn_em/module_convtrans_prep.F.html#CONVTRANS_PREP'>convtrans_prep</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CONVTRANS_PREP_1">(grid%gd_cloud,grid%gd_cloud2,grid%gd_cloud_a,&amp;<a name='1209'>
     &amp;          grid%QC_CU,grid%raincv,grid%raincv_a,grid%raincv_b,     &amp;<a name='1210'>
     &amp;          grid%gd_cldfr,moist,p_QV,p_QC,p_qi,T_PHY,P_PHY,num_moist,    &amp;<a name='1211'>
     &amp;          grid%gd_cloud2_a,grid%QI_CU,grid%convtrans_avglen_m,&amp;<a name='1212'>
     &amp;          adapt_step_flag,curr_secs,                &amp;<a name='1213'>
     &amp;          grid%itimestep,grid%dt,                                      &amp;<a name='1214'>
     &amp;          config_flags%cu_physics,                                     &amp;<a name='1215'>
     &amp;          ids,ide, jds,jde, kds,kde,                                   &amp;<a name='1216'>
     &amp;          ims,ime, jms,jme, kms,kme                                    &amp;<a name='1217'>
     &amp;          ,ITS=grid%i_start(ij),ITE=min(grid%i_end(ij), ide-1)                 &amp;<a name='1218'>
     &amp;          ,JTS=grid%j_start(ij),JTE=min(grid%j_end(ij), jde-1)                 &amp;<a name='1219'>
     &amp;          ,KTS=k_start, KTE=min(k_end,kde-1))<a name='1220'>
      ENDDO<a name='1221'>
      <font color=#447700>!$OMP END PARALLEL DO<a name='1222'></font>
     endif<a name='1223'>
<a name='1224'>
<font color=#447700>! shallow cumulus parameterization<a name='1225'></font>
      CALL wrf_debug ( 200 , ' call shallow_cumulus_driver' )<a name='1226'>
<a name='1227'>
BENCH_START(shcu_driver_tim)<a name='1228'>
      CALL <A href='../../html_code/phys/module_shallowcu_driver.F.html#SHALLOWCU_DRIVER'>shallowcu_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SHALLOWCU_DRIVER_1">(                                              &amp;<a name='1229'>
     &amp;              IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde     &amp;<a name='1230'>
     &amp;             ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme     &amp;<a name='1231'>
     &amp;             ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe     &amp;<a name='1232'>
     &amp;             ,I_START=grid%i_start, I_END=min(grid%i_end, ide-1)    &amp;<a name='1233'>
     &amp;             ,J_START=grid%j_start, J_END=min(grid%j_end, jde-1)    &amp;<a name='1234'>
     &amp;             ,KTS=k_start, KTE=min(k_end, kde-1)                    &amp;<a name='1235'>
     &amp;             ,NUM_TILES=grid%num_tiles                              &amp;<a name='1236'>
     &amp;             ,U=grid%u_phy, V=grid%v_phy, TH=th_phy, T=t_phy        &amp;<a name='1237'>
     &amp;             ,P=grid%p_hyd, PI=pi_phy, RHO=grid%rho, MOIST=moist    &amp;<a name='1238'>
     &amp;             ,NUM_MOIST=num_moist                                   &amp;<a name='1239'>
     &amp;             ,ITIMESTEP=grid%itimestep, DT=grid%dt, DX=grid%dx      &amp;<a name='1240'>
     &amp;             ,CUDT=grid%cudt                                        &amp;<a name='1241'>
     &amp;             ,CURR_SECS=curr_secs, ADAPT_STEP_FLAG=adapt_step_flag  &amp;<a name='1242'>
     &amp;             ,RAINSH=grid%rainsh, PRATESH=grid%pratesh, NCA=grid%nca&amp;<a name='1243'>
     &amp;             ,RAINSHV=grid%rainshv                                  &amp;<a name='1244'>
     &amp;             ,Z=grid%z, Z_AT_W=grid%z_at_w, DZ8W=dz8w               &amp;<a name='1245'>
     &amp;             ,MAVAIL=grid%mavail, PBLH=grid%pblh, P8W=grid%p_hyd_w  &amp;<a name='1246'>
     &amp;             ,TKE_PBL=grid%tke_pbl                                  &amp;<a name='1247'>
     &amp;             ,CLDFRA=grid%cldfra, CLDFRA_OLD=grid%cldfra_old        &amp;<a name='1248'>
     &amp;             ,CLDFRA_OLD_MP=grid%cldfra_old_mp                      &amp;<a name='1249'>
     &amp;             ,CLDFRA_CONV=grid%cldfra_conv                          &amp;<a name='1250'>
     &amp;             ,CLDFRASH=grid%cldfrash, HTOP=grid%htop, HBOT=grid%hbot&amp;<a name='1251'>
     &amp;             ,SHCU_PHYSICS=grid%shcu_physics                        &amp;<a name='1252'>
     &amp;             ,QV_CURR=moist(ims,kms,jms,P_QV)                       &amp;<a name='1253'>
     &amp;             ,QC_CURR=moist(ims,kms,jms,P_QC)                       &amp;<a name='1254'>
     &amp;             ,QR_CURR=moist(ims,kms,jms,P_QR)                       &amp;<a name='1255'>
     &amp;             ,QI_CURR=moist(ims,kms,jms,P_QI)                       &amp;<a name='1256'>
     &amp;             ,QS_CURR=moist(ims,kms,jms,P_QS)                       &amp;<a name='1257'>
     &amp;             ,QG_CURR=moist(ims,kms,jms,P_QG)                       &amp;<a name='1258'>
     &amp;             ,QNC_CURR=scalar(ims,kms,jms,P_QNC)                    &amp; <font color=#447700>!BSINGH - Neede for UWSHCU scheme<a name='1259'></font>
     &amp;             ,QNI_CURR=scalar(ims,kms,jms,P_QNI)                    &amp; <font color=#447700>!BSINGH - Neede for UWSHCU schem <a name='1260'></font>
#if (WRF_CHEM == 1)<a name='1261'>
     &amp;             ,CHEM=chem,chem_opt=config_flags%chem_opt              &amp;<a name='1262'>
#endif<a name='1263'>
     &amp;             ,DLF=grid%dlf, RLIQ=grid%rliq, RLIQ2=grid%rliq2        &amp;<a name='1264'>
     &amp;             ,DLF2=grid%dlf2                                        &amp; <font color=#447700>! Required for CAMMGMP microphysics scheme<a name='1265'></font>
     &amp;             ,CMFMC=grid%cmfmc, CMFMC2=grid%cmfmc2                  &amp;<a name='1266'>
     &amp;             ,CUSH=grid%cush, SNOWSH=grid%snowsh                    &amp;<a name='1267'>
     &amp;             ,ICWMRSH=grid%icwmrsh, RPRDSH=grid%rprdsh              &amp;<a name='1268'>
     &amp;             ,CBMF=grid%cbmf_cu, CMFSL=grid%cmfsl, CMFLQ=grid%cmflq &amp;<a name='1269'>
     &amp;             ,EVAPCSH=grid%evapcsh                                  &amp;<a name='1270'>
     &amp;             ,RQVSHTEN=grid%rqvshten, RQCSHTEN=grid%rqcshten        &amp;<a name='1271'>
     &amp;             ,RQRSHTEN=grid%rqrshten, RQISHTEN=grid%rqishten        &amp;<a name='1272'>
     &amp;             ,RQSSHTEN=grid%rqsshten, RQGSHTEN=grid%rqgshten        &amp;<a name='1273'>
     &amp;             ,RQCNSHTEN=grid%rqcnshten, RQINSHTEN=grid%rqinshten    &amp;  <a name='1274'>
     &amp;             ,RQVBLTEN=grid%rqvblten, RQVFTEN=grid%rqvften          &amp;<a name='1275'>
     &amp;             ,RUSHTEN=grid%rushten, RVSHTEN=grid%rvshten            &amp;<a name='1276'>
     &amp;             ,RTHSHTEN=grid%rthshten, RTHRATEN=grid%rthraten        &amp;<a name='1277'>
     &amp;             ,RTHBLTEN=grid%rthblten, RTHFTEN=grid%rthften          &amp;<a name='1278'>
     &amp;             ,F_QV=f_qv,F_QC=f_qc,F_QR=f_qr                         &amp;<a name='1279'>
     &amp;             ,F_QI=f_qi,F_QS=f_qs,F_QG=f_qg                         &amp;<a name='1280'>
     &amp;             ,HT=grid%ht                                            &amp;<a name='1281'>
     &amp;             ,SHFRC3D=grid%shfrc3d                                  &amp; <font color=#447700>!Balwinder.Singh@pnnl.gov: For CAM's wetscavenging<a name='1282'></font>
     &amp;             ,IS_CAMMGMP_USED = grid%is_CAMMGMP_used                &amp;<a name='1283'>
     &amp;             ,WSTAR=grid%wstar_ysu,DELTA=grid%delta_ysu             &amp;<a name='1284'>
     &amp;             ,KPBL=grid%kpbl,ZNU=grid%znu                           &amp;<a name='1285'>
     &amp;             ,RAINCV=grid%raincv                                    &amp;<a name='1286'>
     &amp;                                                                    )<a name='1287'>
<a name='1288'>
#if (WRF_CHEM == 1)<a name='1289'>
#ifdef DM_PARALLEL<a name='1290'>
      IF( config_flags%shcu_physics == CAMUWSHCUSCHEME ) THEN<a name='1291'>
         CALL wrf_debug ( 200 , ' call HALO CHEM AFTER SHALLOW CUMULUS' )<a name='1292'>
         IF      ( config_flags%h_mom_adv_order &lt;= 4 ) THEN<a name='1293'>
#      include "<A href='../../html_code/include/HALO_EM_CHEM_E_3.inc.html'>HALO_EM_CHEM_E_3.inc</A>"<A NAME="HALO_EM_CHEM_E_3.inc_6"><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1294'>
         ELSE IF ( config_flags%h_mom_adv_order &lt;= 6 ) THEN<a name='1295'>
#      include "<A href='../../html_code/include/HALO_EM_CHEM_E_5.inc.html'>HALO_EM_CHEM_E_5.inc</A>"<A NAME="HALO_EM_CHEM_E_5.inc_7"><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1296'>
         ELSE<a name='1297'>
            WRITE(message,*)'module_first_rk_step_part1: invalid h_mom_adv_order = ',config_flags%h_mom_adv_order<a name='1298'>
            CALL <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_23">(TRIM(message))<a name='1299'>
         ENDIF<a name='1300'>
      ENDIF<a name='1301'>
#endif<a name='1302'>
#endif<a name='1303'>
BENCH_END(shcu_driver_tim)<a name='1304'>
<a name='1305'>
<font color=#447700>! JPH call force_scm to update bl tendencies<a name='1306'></font>
      CALL <A href='../../html_code/dyn_em/module_force_scm.F.html#FORCE_SCM'>force_scm</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FORCE_SCM_1">(itimestep=grid%itimestep,dt=grid%dt                  &amp;<a name='1307'>
     &amp;             ,scm_force=config_flags%scm_force                      &amp;<a name='1308'>
     &amp;             ,dx=config_flags%scm_force_dx                          &amp;<a name='1309'>
     &amp;             ,num_force_layers=grid%num_force_layers                &amp;<a name='1310'>
     &amp;             ,scm_th_adv=config_flags%scm_th_adv                    &amp;<a name='1311'>
     &amp;             ,scm_qv_adv=config_flags%scm_qv_adv                    &amp;<a name='1312'>
     &amp;             ,scm_ql_adv=config_flags%scm_ql_adv                    &amp;<a name='1313'>
     &amp;             ,scm_wind_adv=config_flags%scm_wind_adv                &amp;<a name='1314'>
     &amp;             ,scm_vert_adv=config_flags%scm_vert_adv                &amp;<a name='1315'>
     &amp;             ,scm_th_t_tend=config_flags%scm_th_t_tend              &amp;<a name='1316'>
     &amp;             ,scm_qv_t_tend=config_flags%scm_qv_t_tend              &amp;<a name='1317'>
     &amp;             ,scm_soilT_force=config_flags%scm_soilT_force          &amp;<a name='1318'>
     &amp;             ,scm_soilQ_force=config_flags%scm_soilQ_force          &amp;<a name='1319'>
     &amp;      ,scm_force_th_largescale=config_flags%scm_force_th_largescale &amp;<a name='1320'>
     &amp;      ,scm_force_qv_largescale=config_flags%scm_force_qv_largescale &amp;<a name='1321'>
     &amp;      ,scm_force_ql_largescale=config_flags%scm_force_ql_largescale &amp;<a name='1322'>
     &amp;      ,scm_force_wind_largescale=config_flags%scm_force_wind_largescale &amp;<a name='1323'>
     &amp;             ,u_base=grid%u_base,v_base=grid%v_base                 &amp;<a name='1324'>
     &amp;             ,z_base=grid%z_base                                    &amp;<a name='1325'>
     &amp;             ,z_force=grid%z_force,z_force_tend=grid%z_force_tend   &amp;<a name='1326'>
     &amp;             ,u_g=grid%u_g,v_g=grid%v_g                             &amp;<a name='1327'>
     &amp;             ,u_g_tend=grid%u_g_tend,v_g_tend=grid%v_g_tend         &amp;<a name='1328'>
     &amp;             ,w_subs=grid%w_subs, w_subs_tend=grid%w_subs_tend      &amp;<a name='1329'>
     &amp;             ,th_upstream_x=grid%th_upstream_x                      &amp;<a name='1330'>
     &amp;             ,th_upstream_x_tend=grid%th_upstream_x_tend            &amp;<a name='1331'>
     &amp;             ,th_upstream_y=grid%th_upstream_y                      &amp;<a name='1332'>
     &amp;             ,th_upstream_y_tend=grid%th_upstream_y_tend            &amp;<a name='1333'>
     &amp;             ,qv_upstream_x=grid%qv_upstream_x                      &amp;<a name='1334'>
     &amp;             ,qv_upstream_x_tend=grid%qv_upstream_x_tend            &amp;<a name='1335'>
     &amp;             ,qv_upstream_y=grid%qv_upstream_y                      &amp;<a name='1336'>
     &amp;             ,qv_upstream_y_tend=grid%qv_upstream_y_tend            &amp;<a name='1337'>
     &amp;             ,ql_upstream_x=grid%ql_upstream_x                      &amp;<a name='1338'>
     &amp;             ,ql_upstream_x_tend=grid%ql_upstream_x_tend            &amp;<a name='1339'>
     &amp;             ,ql_upstream_y=grid%ql_upstream_y                      &amp;<a name='1340'>
     &amp;             ,ql_upstream_y_tend=grid%ql_upstream_y_tend            &amp;<a name='1341'>
     &amp;             ,u_upstream_x=grid%u_upstream_x                        &amp;<a name='1342'>
     &amp;             ,u_upstream_x_tend=grid%u_upstream_x_tend              &amp;<a name='1343'>
     &amp;             ,u_upstream_y=grid%u_upstream_y                        &amp;<a name='1344'>
     &amp;             ,u_upstream_y_tend=grid%u_upstream_y_tend              &amp;<a name='1345'>
     &amp;             ,v_upstream_x=grid%v_upstream_x                        &amp;<a name='1346'>
     &amp;             ,v_upstream_x_tend=grid%v_upstream_x_tend              &amp;<a name='1347'>
     &amp;             ,v_upstream_y=grid%v_upstream_y                        &amp;<a name='1348'>
     &amp;             ,v_upstream_y_tend=grid%v_upstream_y_tend              &amp;<a name='1349'>
     &amp;             ,th_t_tend=grid%th_t_tend                              &amp;<a name='1350'>
     &amp;             ,qv_t_tend=grid%qv_t_tend                              &amp;<a name='1351'>
     &amp;             ,tau_x=grid%tau_x                                      &amp;<a name='1352'>
     &amp;             ,tau_x_tend=grid%tau_x_tend                            &amp;<a name='1353'>
     &amp;             ,tau_y=grid%tau_y                                      &amp;<a name='1354'>
     &amp;             ,tau_y_tend=grid%tau_y_tend                            &amp;<a name='1355'>
     &amp;             ,th_largescale=grid%th_largescale                      &amp;<a name='1356'>
     &amp;             ,th_largescale_tend=grid%th_largescale_tend            &amp;<a name='1357'>
     &amp;             ,qv_largescale=grid%qv_largescale                      &amp;<a name='1358'>
     &amp;             ,qv_largescale_tend=grid%qv_largescale_tend            &amp;<a name='1359'>
     &amp;             ,ql_largescale=grid%ql_largescale                      &amp;<a name='1360'>
     &amp;             ,ql_largescale_tend=grid%ql_largescale_tend            &amp;<a name='1361'>
     &amp;             ,u_largescale=grid%u_largescale                      &amp;<a name='1362'>
     &amp;             ,u_largescale_tend=grid%u_largescale_tend            &amp;<a name='1363'>
     &amp;             ,v_largescale=grid%v_largescale                      &amp;<a name='1364'>
     &amp;             ,v_largescale_tend=grid%v_largescale_tend            &amp;<a name='1365'>
     &amp;             ,tau_largescale=grid%tau_largescale                    &amp;<a name='1366'>
     &amp;             ,tau_largescale_tend=grid%tau_largescale_tend          &amp;<a name='1367'>
     &amp;             ,num_force_soil_layers=config_flags%num_force_soil_layers &amp;<a name='1368'>
     &amp;             ,num_soil_layers=config_flags%num_soil_layers          &amp;<a name='1369'>
     &amp;             ,soil_depth_force=grid%soil_depth_force                &amp;<a name='1370'>
     &amp;             ,zs=grid%zs                                            &amp;<a name='1371'>
     &amp;             ,tslb=grid%tslb,smois=grid%smois                       &amp;<a name='1372'>
     &amp;             ,t_soil_forcing_val=grid%t_soil_forcing_val            &amp;<a name='1373'>
     &amp;             ,t_soil_forcing_tend=grid%t_soil_forcing_tend          &amp;<a name='1374'>
     &amp;             ,q_soil_forcing_val=grid%q_soil_forcing_val            &amp;<a name='1375'>
     &amp;             ,q_soil_forcing_tend=grid%q_soil_forcing_tend          &amp;<a name='1376'>
     &amp;             ,tau_soil=grid%tau_soil                                &amp;<a name='1377'>
     &amp;             ,z=grid%z,z_at_w=grid%z_at_w                           &amp;<a name='1378'>
     &amp;             ,th=th_phy, qv=moist(ims,kms,jms,P_QV)                 &amp;<a name='1379'>
     &amp;             ,ql=moist(ims,kms,jms,P_QC)                            &amp;<a name='1380'>
     &amp;             ,u=grid%u_phy, v=grid%v_phy                                      &amp;<a name='1381'>
     &amp;             ,thten=grid%rthblten, qvten=grid%rqvblten              &amp;<a name='1382'>
     &amp;             ,qlten=grid%rqcblten                                   &amp;<a name='1383'>
     &amp;             ,uten=grid%rublten, vten=grid%rvblten                  &amp;<a name='1384'>
     &amp;             ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde     &amp;<a name='1385'>
     &amp;             ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme     &amp;<a name='1386'>
     &amp;             ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe     &amp;<a name='1387'>
     &amp;             ,KTS=k_start, KTE=min(k_end,kde-1)                     &amp;<a name='1388'>
     &amp;              )<a name='1389'>
<a name='1390'>
#ifdef DM_PARALLEL<a name='1391'>
#     include "<A href='../../html_code/include/HALO_EM_FDDA_SFC.inc.html'>HALO_EM_FDDA_SFC.inc</A>"<A NAME="HALO_EM_FDDA_SFC.inc_8"><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1392'>
#endif<a name='1393'>
      CALL wrf_debug ( 200 , ' call fddagd_driver' )<a name='1394'>
<a name='1395'>
BENCH_START(fdda_driver_tim)<a name='1396'>
      CALL <A href='../../html_code/phys/module_fddagd_driver.F.html#FDDAGD_DRIVER'>fddagd_driver</A><A href='../../html_code/dyn_em/module_first_rk_step_part1.F.html#FIRST_RK_STEP_PART1' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FDDAGD_DRIVER_1">(itimestep=grid%itimestep,dt=grid%dt,xtime=grid%XTIME,      &amp;<a name='1397'>
                  id=grid%id,                                                       &amp;<a name='1398'>
                  RUNDGDTEN=grid%rundgdten,RVNDGDTEN=grid%rvndgdten,                &amp;<a name='1399'>
                  RTHNDGDTEN=grid%rthndgdten,RPHNDGDTEN=grid%rphndgdten,            &amp;<a name='1400'>
                  RQVNDGDTEN=grid%rqvndgdten,RMUNDGDTEN=grid%rmundgdten,            &amp;<a name='1401'>
<font color=#447700>!<a name='1402'></font>
<font color=#447700>! FASDAS<a name='1403'></font>
<font color=#447700>!<a name='1404'></font>
                  SDA_HFX=grid%SDA_HFX, SDA_QFX=grid%SDA_QFX,      &amp;<a name='1405'>
                  HFX_FDDA=grid%HFX_FDDA,  &amp; <a name='1406'>
<font color=#447700>!<a name='1407'></font>
<font color=#447700>! END FASDAS<a name='1408'></font>
<font color=#447700>!<a name='1409'></font>
                  u_ndg_old=fdda3d(ims,kms,jms,P_u_ndg_old),                        &amp;<a name='1410'>
                  v_ndg_old=fdda3d(ims,kms,jms,P_v_ndg_old),                        &amp;<a name='1411'>
                  t_ndg_old=fdda3d(ims,kms,jms,P_t_ndg_old),                        &amp;<a name='1412'>
                  ph_ndg_old=fdda3d(ims,kms,jms,P_ph_ndg_old),                      &amp;<a name='1413'>
                  q_ndg_old=fdda3d(ims,kms,jms,P_q_ndg_old),                        &amp;<a name='1414'>
                  mu_ndg_old=fdda2d(ims,1,jms,P_mu_ndg_old),                        &amp;<a name='1415'>
                  u_ndg_new=fdda3d(ims,kms,jms,P_u_ndg_new),                        &amp;<a name='1416'>
                  v_ndg_new=fdda3d(ims,kms,jms,P_v_ndg_new),                        &amp;<a name='1417'>
                  t_ndg_new=fdda3d(ims,kms,jms,P_t_ndg_new),                        &amp;<a name='1418'>
                  ph_ndg_new=fdda3d(ims,kms,jms,P_ph_ndg_new),                      &amp;<a name='1419'>
                  q_ndg_new=fdda3d(ims,kms,jms,P_q_ndg_new),                        &amp;<a name='1420'>
                  mu_ndg_new=fdda2d(ims,1,jms,P_mu_ndg_new),                        &amp;<a name='1421'>
                  u3d=grid%u_2,v3d=grid%v_2,th_phy=th_phy,                          &amp;<a name='1422'>
                  ph=grid%ph_2,rho=grid%rho,moist=moist,                            &amp;<a name='1423'>
                  p_phy=p_phy,pi_phy=pi_phy,p8w=p8w,t_phy=grid%t_phy,               &amp;<a name='1424'>
                  dz8w=dz8w,z=grid%z,z_at_w=grid%z_at_w,                            &amp;<a name='1425'>
                  grid=grid,config_flags=config_flags,dx=grid%DX,n_moist=num_moist, &amp;<a name='1426'>
                  STEPFG=grid%STEPFG,                                               &amp;<a name='1427'>
                  pblh=grid%pblh,ht=grid%ht,REGIME=grid%regime,ZNT=grid%znt         &amp;<a name='1428'>
                   ,IDS=ids,IDE=ide, JDS=jds,JDE=jde, KDS=kds,KDE=kde               &amp;<a name='1429'>
                   ,IMS=ims,IME=ime, JMS=jms,JME=jme, KMS=kms,KME=kme               &amp;<a name='1430'>
                   ,I_START=grid%i_start,I_END=min(grid%i_end, ide-1)               &amp;<a name='1431'>
                   ,J_START=grid%j_start,J_END=min(grid%j_end, jde-1)               &amp;<a name='1432'>
                   ,KTS=k_start, KTE=min(k_end,kde-1)                               &amp;<a name='1433'>
                   , num_tiles=grid%num_tiles,                                      &amp;<a name='1434'>
                   u10=grid%u10, v10=grid%v10, th2=grid%th2, q2=grid%q2,            &amp;<a name='1435'>
                   u10_ndg_old=grid%u10_ndg_old,                    &amp;<a name='1436'>
                   v10_ndg_old=grid%v10_ndg_old,                    &amp;<a name='1437'>
                   t2_ndg_old=grid%t2_ndg_old,                      &amp;<a name='1438'>
                   th2_ndg_old=grid%th2_ndg_old,                    &amp;<a name='1439'>
                   q2_ndg_old=grid%q2_ndg_old,                      &amp;<a name='1440'>
                   rh_ndg_old=grid%rh_ndg_old,                      &amp;<a name='1441'>
                   psl_ndg_old=grid%psl_ndg_old,                    &amp;<a name='1442'>
                   ps_ndg_old=grid%ps_ndg_old,                      &amp;<a name='1443'>
                   tob_ndg_old=grid%tob_ndg_old,                                    &amp;<a name='1444'>
                   odis_ndg_old=grid%odis_ndg_old,                                  &amp;<a name='1445'>
                   u10_ndg_new=grid%u10_ndg_new,                    &amp;<a name='1446'>
                   v10_ndg_new=grid%v10_ndg_new,                    &amp;<a name='1447'>
                   t2_ndg_new=grid%t2_ndg_new,                      &amp;<a name='1448'>
                   th2_ndg_new=grid%th2_ndg_new,                    &amp;<a name='1449'>
                   q2_ndg_new=grid%q2_ndg_new,                      &amp;<a name='1450'>
                   rh_ndg_new=grid%rh_ndg_new,                      &amp;<a name='1451'>
                   psl_ndg_new=grid%psl_ndg_new,                    &amp;<a name='1452'>
                   ps_ndg_new=grid%ps_ndg_new,                      &amp;<a name='1453'>
                   tob_ndg_new=grid%tob_ndg_new,                                    &amp;<a name='1454'>
                   odis_ndg_new=grid%odis_ndg_new                                   &amp;<a name='1455'>
                   ,IPS=ips,IPE=ipe, JPS=jps,JPE=jpe, KPS=kps,KPE=kpe               &amp;<a name='1456'>
                   ,IMSX=imsx,IMEX=imex,JMSX=jmsx,JMEX=jmex,KMSX=kmsx,KMEX=kmex     &amp;<a name='1457'>
                   ,IPSX=ipsx,IPEX=ipex,JPSX=jpsx,JPEX=jpex,KPSX=kpsx,KPEX=kpex     &amp;<a name='1458'>
                   ,IMSY=imsy,IMEY=imey,JMSY=jmsy,JMEY=jmey,KMSY=kmsy,KMEY=kmey     &amp;<a name='1459'>
                   ,IPSY=ipsy,IPEY=ipey,JPSY=jpsy,JPEY=jpey,KPSY=kpsy,KPEY=kpey     )<a name='1460'>
<a name='1461'>
BENCH_END(fdda_driver_tim)<a name='1462'>
<a name='1463'>
  END SUBROUTINE first_rk_step_part1<a name='1464'>
<a name='1465'>
END MODULE module_first_rk_step_part1<a name='1466'>
</pre></body></html>