<HTML> <BODY BGCOLOR=#bbccdd LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<font color=#447700>!*------------------------------------------------------------------------------<a name='2'></font>
<font color=#447700>!*  Standard Disclaimer<a name='3'></font>
<font color=#447700>!*<a name='4'></font>
<font color=#447700>!*  Forecast Systems Laboratory<a name='5'></font>
<font color=#447700>!*  NOAA/OAR/ERL/FSL<a name='6'></font>
<font color=#447700>!*  325 Broadway<a name='7'></font>
<font color=#447700>!*  Boulder, CO     80303<a name='8'></font>
<font color=#447700>!*<a name='9'></font>
<font color=#447700>!*  AVIATION DIVISION<a name='10'></font>
<font color=#447700>!*  ADVANCED COMPUTING BRANCH<a name='11'></font>
<font color=#447700>!*  SMS/NNT Version: 2.0.0 <a name='12'></font>
<font color=#447700>!*<a name='13'></font>
<font color=#447700>!*  This software and its documentation are in the public domain and<a name='14'></font>
<font color=#447700>!*  are furnished "as is".  The United States government, its <a name='15'></font>
<font color=#447700>!*  instrumentalities, officers, employees, and agents make no <a name='16'></font>
<font color=#447700>!*  warranty, express or implied, as to the usefulness of the software <a name='17'></font>
<font color=#447700>!*  and documentation for any purpose.  They assume no <a name='18'></font>
<font color=#447700>!*  responsibility (1) for the use of the software and documentation; <a name='19'></font>
<font color=#447700>!*  or (2) to provide technical support to users.<a name='20'></font>
<font color=#447700>!* <a name='21'></font>
<font color=#447700>!*  Permission to use, copy, modify, and distribute this software is<a name='22'></font>
<font color=#447700>!*  hereby granted, provided that this disclaimer notice appears in <a name='23'></font>
<font color=#447700>!*  all copies.  All modifications to this software must be clearly<a name='24'></font>
<font color=#447700>!*  documented, and are solely the responsibility of the agent making<a name='25'></font>
<font color=#447700>!*  the modification.  If significant modifications or enhancements<a name='26'></font>
<font color=#447700>!*  are made to this software, the SMS Development team<a name='27'></font>
<font color=#447700>!*  (sms-info@fsl.noaa.gov) should be notified.<a name='28'></font>
<font color=#447700>!*<a name='29'></font>
<font color=#447700>!*----------------------------------------------------------------------------<a name='30'></font>
<font color=#447700>!*<a name='31'></font>
<font color=#447700>!*  WRF NetCDF I/O<a name='32'></font>
<font color=#447700>!   Author:  Jacques Middlecoff jacquesm@fsl.noaa.gov<a name='33'></font>
<font color=#447700>!*  Date:    October 6, 2000<a name='34'></font>
<font color=#447700>!*<a name='35'></font>
<font color=#447700>!*----------------------------------------------------------------------------<a name='36'></font>
<a name='37'>
<A NAME='WRF_DATA'><A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='38'>
<font color=#993300>module </font><font color=#cc0000>wrf_data</font> <A href='../../call_to/WRF_DATA.html' TARGET='index'>48</A><a name='39'>
<a name='40'>
  integer                , parameter      :: FATAL            = 1<a name='41'>
  integer                , parameter      :: WARN             = 1<a name='42'>
  integer                , parameter      :: WrfDataHandleMax = 99<a name='43'>
  integer                , parameter      :: MaxDims          = 2000 <font color=#447700>! = NF_MAX_VARS<a name='44'></font>
#if(WRF_CHEM == 1)<a name='45'>
  integer                , parameter      :: MaxVars          = 10000<a name='46'>
#else<a name='47'>
  integer                , parameter      :: MaxVars          = 3000<a name='48'>
#endif<a name='49'>
  integer                , parameter      :: MaxTimes         = 10000<a name='50'>
  integer                , parameter      :: DateStrLen       = 19<a name='51'>
  integer                , parameter      :: VarNameLen       = 31<a name='52'>
  integer                , parameter      :: NO_DIM           = 0<a name='53'>
  integer                , parameter      :: NVarDims         = 4<a name='54'>
  integer                , parameter      :: NMDVarDims       = 2<a name='55'>
  character (8)          , parameter      :: NO_NAME          = 'NULL'<a name='56'>
  character (DateStrLen) , parameter      :: ZeroDate = '0000-00-00-00:00:00'<a name='57'>
<a name='58'>
#include "<A href='../../html_code/include/wrf_io_flags.h.html'>wrf_io_flags.h</A>"<A NAME="wrf_io_flags.h_1"><A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='59'>
<a name='60'>
  character (256)                         :: msg<a name='61'>
  logical                                 :: WrfIOnotInitialized = .true.<a name='62'>
<a name='63'>
  type :: wrf_data_handle<a name='64'>
    character (255)                       :: FileName<a name='65'>
    integer                               :: FileStatus<a name='66'>
    integer                               :: Comm<a name='67'>
    integer                               :: NCID<a name='68'>
    logical                               :: Free<a name='69'>
    logical                               :: Write<a name='70'>
    character (5)                         :: TimesName<a name='71'>
    integer                               :: TimeIndex<a name='72'>
    integer                               :: CurrentTime  <font color=#447700>!Only used for read<a name='73'></font>
    integer                               :: NumberTimes  <font color=#447700>!Only used for read<a name='74'></font>
    character (DateStrLen), pointer       :: Times(:)<a name='75'>
    integer                               :: TimesVarID<a name='76'>
    integer               , pointer       :: DimLengths(:)<a name='77'>
    integer               , pointer       :: DimIDs(:)<a name='78'>
    character (31)        , pointer       :: DimNames(:)<a name='79'>
    integer                               :: DimUnlimID<a name='80'>
    character (9)                         :: DimUnlimName<a name='81'>
    integer       , dimension(NVarDims)   :: DimID<a name='82'>
    integer       , dimension(NVarDims)   :: Dimension<a name='83'>
    integer               , pointer       :: MDVarIDs(:)<a name='84'>
    integer               , pointer       :: MDVarDimLens(:)<a name='85'>
    character (80)        , pointer       :: MDVarNames(:)<a name='86'>
    integer               , pointer       :: VarIDs(:)<a name='87'>
    integer               , pointer       :: VarDimLens(:,:)<a name='88'>
    character (VarNameLen), pointer       :: VarNames(:)<a name='89'>
    integer                               :: CurrentVariable  <font color=#447700>!Only used for read<a name='90'></font>
    integer                               :: NumVars<a name='91'>
<font color=#447700>! first_operation is set to .TRUE. when a new handle is allocated <a name='92'></font>
<font color=#447700>! or when open-for-write or open-for-read are committed.  It is set <a name='93'></font>
<font color=#447700>! to .FALSE. when the first field is read or written.  <a name='94'></font>
    logical                               :: first_operation<a name='95'>
    logical                               :: R4OnOutput<a name='96'>
    logical                               :: nofill<a name='97'>
    logical                               :: use_netcdf_classic<a name='98'>
  end type wrf_data_handle<a name='99'>
  type(wrf_data_handle),target            :: WrfDataHandles(WrfDataHandleMax)<a name='100'>
end module wrf_data<a name='101'>
<a name='102'>
<A NAME='EXT_NCD_SUPPORT_ROUTINES'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='103'>
<font color=#993300>module </font><font color=#cc0000>ext_ncd_support_routines</font> <A href='../../call_to/EXT_NCD_SUPPORT_ROUTINES.html' TARGET='index'>29</A><a name='104'>
<a name='105'>
  implicit none<a name='106'>
<a name='107'>
CONTAINS<a name='108'>
<a name='109'>
<A NAME='ALLOCHANDLE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='110'>
<font color=#993300>subroutine </font><font color=#cc0000>allocHandle</font>(DataHandle,DH,Comm,Status) <A href='../../call_to/ALLOCHANDLE.html' TARGET='index'>3</A>,<A href='../../call_from/ALLOCHANDLE.html' TARGET='index'>13</A><a name='111'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_9"><a name='112'>
  include 'wrf_status_codes.h'<a name='113'>
  integer              ,intent(out) :: DataHandle<a name='114'>
  type(wrf_data_handle),pointer     :: DH<a name='115'>
  integer              ,intent(IN)  :: Comm<a name='116'>
  integer              ,intent(out) :: Status<a name='117'>
  integer                           :: i<a name='118'>
  integer                           :: stat<a name='119'>
<a name='120'>
  do i=1,WrfDataHandleMax<a name='121'>
    if(WrfDataHandles(i)%Free) then<a name='122'>
      DH =&gt; WrfDataHandles(i)<a name='123'>
      DataHandle = i<a name='124'>
      allocate(DH%Times(MaxTimes), STAT=stat)<a name='125'>
      if(stat/= 0) then<a name='126'>
        Status = WRF_ERR_FATAL_ALLOCATION_ERROR<a name='127'>
        write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='128'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1335"> ( FATAL , msg)<a name='129'>
        return<a name='130'>
      endif<a name='131'>
      allocate(DH%DimLengths(MaxDims), STAT=stat)<a name='132'>
      if(stat/= 0) then<a name='133'>
        Status = WRF_ERR_FATAL_ALLOCATION_ERROR<a name='134'>
        write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='135'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1336"> ( FATAL , msg)<a name='136'>
        return<a name='137'>
      endif<a name='138'>
      allocate(DH%DimIDs(MaxDims), STAT=stat)<a name='139'>
      if(stat/= 0) then<a name='140'>
        Status = WRF_ERR_FATAL_ALLOCATION_ERROR<a name='141'>
        write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='142'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1337"> ( FATAL , msg)<a name='143'>
        return<a name='144'>
      endif<a name='145'>
      allocate(DH%DimNames(MaxDims), STAT=stat)<a name='146'>
      if(stat/= 0) then<a name='147'>
        Status = WRF_ERR_FATAL_ALLOCATION_ERROR<a name='148'>
        write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='149'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1338"> ( FATAL , msg)<a name='150'>
        return<a name='151'>
      endif<a name='152'>
      allocate(DH%MDVarIDs(MaxVars), STAT=stat)<a name='153'>
      if(stat/= 0) then<a name='154'>
        Status = WRF_ERR_FATAL_ALLOCATION_ERROR<a name='155'>
        write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='156'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1339"> ( FATAL , msg)<a name='157'>
        return<a name='158'>
      endif<a name='159'>
      allocate(DH%MDVarDimLens(MaxVars), STAT=stat)<a name='160'>
      if(stat/= 0) then<a name='161'>
        Status = WRF_ERR_FATAL_ALLOCATION_ERROR<a name='162'>
        write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='163'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1340"> ( FATAL , msg)<a name='164'>
        return<a name='165'>
      endif<a name='166'>
      allocate(DH%MDVarNames(MaxVars), STAT=stat)<a name='167'>
      if(stat/= 0) then<a name='168'>
        Status = WRF_ERR_FATAL_ALLOCATION_ERROR<a name='169'>
        write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='170'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1341"> ( FATAL , msg)<a name='171'>
        return<a name='172'>
      endif<a name='173'>
      allocate(DH%VarIDs(MaxVars), STAT=stat)<a name='174'>
      if(stat/= 0) then<a name='175'>
        Status = WRF_ERR_FATAL_ALLOCATION_ERROR<a name='176'>
        write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='177'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1342"> ( FATAL , msg)<a name='178'>
        return<a name='179'>
      endif<a name='180'>
      allocate(DH%VarDimLens(NVarDims-1,MaxVars), STAT=stat)<a name='181'>
      if(stat/= 0) then<a name='182'>
        Status = WRF_ERR_FATAL_ALLOCATION_ERROR<a name='183'>
        write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='184'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1343"> ( FATAL , msg)<a name='185'>
        return<a name='186'>
      endif<a name='187'>
      allocate(DH%VarNames(MaxVars), STAT=stat)<a name='188'>
      if(stat/= 0) then<a name='189'>
        Status = WRF_ERR_FATAL_ALLOCATION_ERROR<a name='190'>
        write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='191'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1344"> ( FATAL , msg)<a name='192'>
        return<a name='193'>
      endif<a name='194'>
      exit<a name='195'>
    endif<a name='196'>
    if(i==WrfDataHandleMax) then<a name='197'>
      Status = WRF_WARN_TOO_MANY_FILES<a name='198'>
      write(msg,*) 'Warning TOO MANY FILES in ',__FILE__,', line', __LINE__ <a name='199'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1345"> ( WARN , TRIM(msg))<a name='200'>
      write(msg,*) 'Did you call ext_ncd_ioinit?'<a name='201'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1346"> ( WARN , TRIM(msg))<a name='202'>
      return<a name='203'>
    endif<a name='204'>
  enddo<a name='205'>
  DH%Free      =.false.<a name='206'>
  DH%Comm      = Comm<a name='207'>
  DH%Write     =.false.<a name='208'>
  DH%first_operation  = .TRUE.<a name='209'>
  DH%R4OnOutput = .false.<a name='210'>
  DH%nofill = .false.<a name='211'>
  Status = WRF_NO_ERR<a name='212'>
end subroutine allocHandle<a name='213'>
<a name='214'>
<A NAME='DEALLOCHANDLE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='215'>
<font color=#993300>subroutine </font><font color=#cc0000>deallocHandle</font>(DataHandle, Status) <A href='../../call_to/DEALLOCHANDLE.html' TARGET='index'>2</A>,<A href='../../call_from/DEALLOCHANDLE.html' TARGET='index'>11</A><a name='216'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_10"><a name='217'>
  include 'wrf_status_codes.h'<a name='218'>
  integer              ,intent(in) :: DataHandle<a name='219'>
  integer              ,intent(out) :: Status<a name='220'>
  type(wrf_data_handle),pointer     :: DH<a name='221'>
  integer                           :: i<a name='222'>
  integer                           :: stat<a name='223'>
<a name='224'>
  IF ( DataHandle .GE. 1 .AND. DataHandle .LE. WrfDataHandleMax ) THEN<a name='225'>
    if(.NOT. WrfDataHandles(DataHandle)%Free) then<a name='226'>
      DH =&gt; WrfDataHandles(DataHandle)<a name='227'>
      deallocate(DH%Times, STAT=stat)<a name='228'>
      if(stat/= 0) then<a name='229'>
        Status = WRF_ERR_FATAL_DEALLOCATION_ERR<a name='230'>
        write(msg,*) 'Fatal DEALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='231'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1347"> ( FATAL , msg)<a name='232'>
        return<a name='233'>
      endif<a name='234'>
      deallocate(DH%DimLengths, STAT=stat)<a name='235'>
      if(stat/= 0) then<a name='236'>
        Status = WRF_ERR_FATAL_DEALLOCATION_ERR<a name='237'>
        write(msg,*) 'Fatal DEALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='238'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1348"> ( FATAL , msg)<a name='239'>
        return<a name='240'>
      endif<a name='241'>
      deallocate(DH%DimIDs, STAT=stat)<a name='242'>
      if(stat/= 0) then<a name='243'>
        Status = WRF_ERR_FATAL_DEALLOCATION_ERR<a name='244'>
        write(msg,*) 'Fatal DEALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='245'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1349"> ( FATAL , msg)<a name='246'>
        return<a name='247'>
      endif<a name='248'>
      deallocate(DH%DimNames, STAT=stat)<a name='249'>
      if(stat/= 0) then<a name='250'>
        Status = WRF_ERR_FATAL_DEALLOCATION_ERR<a name='251'>
        write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='252'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1350"> ( FATAL , msg)<a name='253'>
        return<a name='254'>
      endif<a name='255'>
      deallocate(DH%MDVarIDs, STAT=stat)<a name='256'>
      if(stat/= 0) then<a name='257'>
        Status = WRF_ERR_FATAL_DEALLOCATION_ERR<a name='258'>
        write(msg,*) 'Fatal DEALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='259'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1351"> ( FATAL , msg)<a name='260'>
        return<a name='261'>
      endif<a name='262'>
      deallocate(DH%MDVarDimLens, STAT=stat)<a name='263'>
      if(stat/= 0) then<a name='264'>
        Status = WRF_ERR_FATAL_DEALLOCATION_ERR<a name='265'>
        write(msg,*) 'Fatal DEALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='266'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1352"> ( FATAL , msg)<a name='267'>
        return<a name='268'>
      endif<a name='269'>
      deallocate(DH%MDVarNames, STAT=stat)<a name='270'>
      if(stat/= 0) then<a name='271'>
        Status = WRF_ERR_FATAL_DEALLOCATION_ERR<a name='272'>
        write(msg,*) 'Fatal DEALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='273'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1353"> ( FATAL , msg)<a name='274'>
        return<a name='275'>
      endif<a name='276'>
      deallocate(DH%VarIDs, STAT=stat)<a name='277'>
      if(stat/= 0) then<a name='278'>
        Status = WRF_ERR_FATAL_DEALLOCATION_ERR<a name='279'>
        write(msg,*) 'Fatal DEALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='280'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1354"> ( FATAL , msg)<a name='281'>
        return<a name='282'>
      endif<a name='283'>
      deallocate(DH%VarDimLens, STAT=stat)<a name='284'>
      if(stat/= 0) then<a name='285'>
        Status = WRF_ERR_FATAL_DEALLOCATION_ERR<a name='286'>
        write(msg,*) 'Fatal DEALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='287'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1355"> ( FATAL , msg)<a name='288'>
        return<a name='289'>
      endif<a name='290'>
      deallocate(DH%VarNames, STAT=stat)<a name='291'>
      if(stat/= 0) then<a name='292'>
        Status = WRF_ERR_FATAL_DEALLOCATION_ERR<a name='293'>
        write(msg,*) 'Fatal DEALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='294'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1356"> ( FATAL , msg)<a name='295'>
        return<a name='296'>
      endif<a name='297'>
      DH%Free      =.TRUE.<a name='298'>
    endif<a name='299'>
  ENDIF<a name='300'>
  Status = WRF_NO_ERR<a name='301'>
end subroutine deallocHandle<a name='302'>
<a name='303'>
<A NAME='GETDH'><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='304'>
<font color=#993300>subroutine </font><font color=#cc0000>GetDH</font>(DataHandle,DH,Status) <A href='../../call_to/GETDH.html' TARGET='index'>17</A>,<A href='../../call_from/GETDH.html' TARGET='index'>1</A><a name='305'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_11"><a name='306'>
  include 'wrf_status_codes.h'<a name='307'>
  integer               ,intent(in)     :: DataHandle<a name='308'>
  type(wrf_data_handle) ,pointer        :: DH<a name='309'>
  integer               ,intent(out)    :: Status<a name='310'>
<a name='311'>
  if(DataHandle &lt; 1 .or. DataHandle &gt; WrfDataHandleMax) then<a name='312'>
    Status = WRF_WARN_BAD_DATA_HANDLE<a name='313'>
    return<a name='314'>
  endif<a name='315'>
  DH =&gt; WrfDataHandles(DataHandle)<a name='316'>
  if(DH%Free) then<a name='317'>
    Status = WRF_WARN_BAD_DATA_HANDLE<a name='318'>
    return<a name='319'>
  endif<a name='320'>
  Status = WRF_NO_ERR<a name='321'>
  return<a name='322'>
end subroutine GetDH<a name='323'>
<a name='324'>
<A NAME='DATECHECK'><A href='../../html_code/io_netcdf/wrf_io.F90.html#DATECHECK' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='325'>
<font color=#993300>subroutine </font><font color=#cc0000>DateCheck</font>(Date,Status) <A href='../../call_to/DATECHECK.html' TARGET='index'>4</A>,<A href='../../call_from/DATECHECK.html' TARGET='index'>1</A><a name='326'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#DATECHECK' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_12"><a name='327'>
  include 'wrf_status_codes.h'<a name='328'>
  character*(*) ,intent(in)      :: Date<a name='329'>
  integer       ,intent(out)     :: Status<a name='330'>
  <a name='331'>
  if(len(Date) /= DateStrLen) then<a name='332'>
    Status = WRF_WARN_DATESTR_BAD_LENGTH<a name='333'>
  else  <a name='334'>
    Status = WRF_NO_ERR<a name='335'>
  endif<a name='336'>
  return<a name='337'>
end subroutine DateCheck<a name='338'>
<a name='339'>
<A NAME='GETNAME'><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETNAME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='340'>
<font color=#993300>subroutine </font><font color=#cc0000>GetName</font>(Element,Var,Name,Status),<A href='../../call_from/GETNAME.html' TARGET='index'>1</A><a name='341'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETNAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_13"><a name='342'>
  include 'wrf_status_codes.h'<a name='343'>
  character*(*) ,intent(in)     :: Element<a name='344'>
  character*(*) ,intent(in)     :: Var<a name='345'>
  character*(*) ,intent(out)    :: Name<a name='346'>
  integer       ,intent(out)    :: Status<a name='347'>
  character (VarNameLen)        :: VarName<a name='348'>
  character (1)                 :: c<a name='349'>
  integer                       :: i<a name='350'>
  integer, parameter            ::  upper_to_lower =IACHAR('a')-IACHAR('A')<a name='351'>
<a name='352'>
  VarName = Var<a name='353'>
  Name = 'MD___'//trim(Element)//VarName<a name='354'>
  do i=1,len(Name)<a name='355'>
    c=Name(i:i)<a name='356'>
    if('A'&lt;=c .and. c &lt;='Z') Name(i:i)=achar(iachar(c)+upper_to_lower)<a name='357'>
    if(c=='-'.or.c==':') Name(i:i)='_'<a name='358'>
  enddo<a name='359'>
  Status = WRF_NO_ERR<a name='360'>
  return<a name='361'>
end subroutine GetName<a name='362'>
<a name='363'>
<A NAME='GETTIMEINDEX'><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETTIMEINDEX' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='364'>
<font color=#993300>subroutine </font><font color=#cc0000>GetTimeIndex</font>(IO,DataHandle,DateStr,TimeIndex,Status) <A href='../../call_to/GETTIMEINDEX.html' TARGET='index'>1</A>,<A href='../../call_from/GETTIMEINDEX.html' TARGET='index'>7</A><a name='365'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETTIMEINDEX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_14"><a name='366'>
  include 'wrf_status_codes.h'<a name='367'>
  include 'netcdf.inc'<a name='368'>
  character (*)         ,intent(in)     :: IO<a name='369'>
  integer               ,intent(in)     :: DataHandle<a name='370'>
  character*(*)         ,intent(in)     :: DateStr<a name='371'>
  integer               ,intent(out)    :: TimeIndex<a name='372'>
  integer               ,intent(out)    :: Status<a name='373'>
  type(wrf_data_handle) ,pointer        :: DH<a name='374'>
  integer                               :: VStart(2)<a name='375'>
  integer                               :: VCount(2)<a name='376'>
  integer                               :: stat<a name='377'>
  integer                               :: i<a name='378'>
<a name='379'>
  DH =&gt; WrfDataHandles(DataHandle)<a name='380'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#DATECHECK'>DateCheck</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETTIMEINDEX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DATECHECK_1">(DateStr,Status)<a name='381'>
  if(Status /= WRF_NO_ERR) then<a name='382'>
    Status =  WRF_WARN_DATESTR_ERROR<a name='383'>
    write(msg,*) 'Warning DATE STRING ERROR in ',__FILE__,', line', __LINE__ <a name='384'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETTIMEINDEX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1357"> ( WARN , TRIM(msg))<a name='385'>
    return<a name='386'>
  endif<a name='387'>
  if(IO == 'write') then<a name='388'>
    TimeIndex = DH%TimeIndex<a name='389'>
    if(TimeIndex &lt;= 0) then<a name='390'>
      TimeIndex = 1<a name='391'>
    elseif(DateStr == DH%Times(TimeIndex)) then<a name='392'>
      Status = WRF_NO_ERR<a name='393'>
      return<a name='394'>
    else<a name='395'>
      TimeIndex = TimeIndex +1<a name='396'>
      if(TimeIndex &gt; MaxTimes) then<a name='397'>
        Status = WRF_WARN_TIME_EOF<a name='398'>
        write(msg,*) 'Warning TIME EOF in ',__FILE__,', line', __LINE__ <a name='399'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETTIMEINDEX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1358"> ( WARN , TRIM(msg))<a name='400'>
        return<a name='401'>
      endif<a name='402'>
    endif<a name='403'>
    DH%TimeIndex        = TimeIndex<a name='404'>
    DH%Times(TimeIndex) = DateStr<a name='405'>
    VStart(1) = 1<a name='406'>
    VStart(2) = TimeIndex<a name='407'>
    VCount(1) = DateStrLen<a name='408'>
    VCount(2) = 1<a name='409'>
    stat = NF_PUT_VARA_TEXT(DH%NCID,DH%TimesVarID,VStart,VCount,DateStr)<a name='410'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETTIMEINDEX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_5">(stat,Status)<a name='411'>
    if(Status /= WRF_NO_ERR) then<a name='412'>
      write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__ <a name='413'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETTIMEINDEX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1359"> ( WARN , TRIM(msg))<a name='414'>
      return<a name='415'>
    endif<a name='416'>
  else<a name='417'>
    do i=1,MaxTimes<a name='418'>
      if(DH%Times(i)==DateStr) then<a name='419'>
        Status = WRF_NO_ERR<a name='420'>
        TimeIndex = i<a name='421'>
        exit<a name='422'>
      endif<a name='423'>
      if(i==MaxTimes) then<a name='424'>
        Status = WRF_WARN_TIME_NF<a name='425'>
        write(msg,*) 'Warning TIME ',DateStr,' NOT FOUND in ',__FILE__,', line', __LINE__ <a name='426'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETTIMEINDEX' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1360"> ( WARN , TRIM(msg))<a name='427'>
        return<a name='428'>
      endif<a name='429'>
    enddo<a name='430'>
  endif<a name='431'>
  return<a name='432'>
end subroutine GetTimeIndex<a name='433'>
<a name='434'>
<A NAME='GETDIM'><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDIM' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='435'>
<font color=#993300>subroutine </font><font color=#cc0000>GetDim</font>(MemoryOrder,NDim,Status) <A href='../../call_to/GETDIM.html' TARGET='index'>7</A>,<A href='../../call_from/GETDIM.html' TARGET='index'>1</A><a name='436'>
  include 'wrf_status_codes.h'<a name='437'>
  character*(*) ,intent(in)  :: MemoryOrder<a name='438'>
  integer       ,intent(out) :: NDim<a name='439'>
  integer       ,intent(out) :: Status<a name='440'>
  character*3                :: MemOrd<a name='441'>
<a name='442'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#LOWERCASE'>LowerCase</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDIM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LOWERCASE_1">(MemoryOrder,MemOrd)<a name='443'>
  select case (MemOrd)<a name='444'>
    case ('xyz','xzy','yxz','yzx','zxy','zyx','xsz','xez','ysz','yez')<a name='445'>
      NDim = 3<a name='446'>
    case ('xy','yx','xs','xe','ys','ye','cc')<a name='447'>
      NDim = 2<a name='448'>
    case ('z','c')<a name='449'>
      NDim = 1<a name='450'>
    case ('0')  <font color=#447700>! NDim=0 for scalars.  TBH:  20060502<a name='451'></font>
      NDim = 0<a name='452'>
    case default<a name='453'>
      Status = WRF_WARN_BAD_MEMORYORDER<a name='454'>
      return<a name='455'>
  end select<a name='456'>
  Status = WRF_NO_ERR<a name='457'>
  return<a name='458'>
end subroutine GetDim<a name='459'>
<a name='460'>
#ifdef USE_NETCDF4_FEATURES<a name='461'>
<A NAME='SET_CHUNKING'><A href='../../html_code/io_netcdf/wrf_io.F90.html#SET_CHUNKING' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='462'>
<font color=#993300>subroutine </font><font color=#cc0000>set_chunking</font>(MemoryOrder,need_chunking) <A href='../../call_to/SET_CHUNKING.html' TARGET='index'>1</A>,<A href='../../call_from/SET_CHUNKING.html' TARGET='index'>1</A><a name='463'>
  include 'wrf_status_codes.h'<a name='464'>
  character*(*) ,intent(in)  :: MemoryOrder<a name='465'>
  logical       ,intent(out) :: need_chunking<a name='466'>
  character*3                :: MemOrd<a name='467'>
<a name='468'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#LOWERCASE'>LowerCase</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#SET_CHUNKING' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LOWERCASE_2">(MemoryOrder,MemOrd)<a name='469'>
  if(len(MemOrd) &gt;= 2) then<a name='470'>
     select case (MemOrd)<a name='471'>
        case ('xyz','xzy','yxz','yzx','zxy','zyx','xsz','xez','ysz','yez')<a name='472'>
             need_chunking = .true.<a name='473'>
        case ('xy','yx')<a name='474'>
             need_chunking = .true.<a name='475'>
        case default<a name='476'>
             need_chunking = .false.<a name='477'>
             return<a name='478'>
      end select<a name='479'>
  endif<a name='480'>
end subroutine set_chunking<a name='481'>
#endif<a name='482'>
<a name='483'>
<A NAME='GETINDICES'><A href='../../html_code/io_netcdf/wrf_io.F90.html#GETINDICES' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='484'>
<font color=#993300>subroutine </font><font color=#cc0000>GetIndices</font>(NDim,Start,End,i1,i2,j1,j2,k1,k2) <A href='../../call_to/GETINDICES.html' TARGET='index'>6</A><a name='485'>
  integer              ,intent(in)  :: NDim<a name='486'>
  integer ,dimension(*),intent(in)  :: Start,End<a name='487'>
  integer              ,intent(out) :: i1,i2,j1,j2,k1,k2<a name='488'>
<a name='489'>
  i1=1<a name='490'>
  i2=1<a name='491'>
  j1=1<a name='492'>
  j2=1<a name='493'>
  k1=1<a name='494'>
  k2=1<a name='495'>
  if(NDim == 0) return  <font color=#447700>! NDim=0 for scalars.  TBH:  20060502<a name='496'></font>
  i1 = Start(1)<a name='497'>
  i2 = End  (1)<a name='498'>
  if(NDim == 1) return<a name='499'>
  j1 = Start(2)<a name='500'>
  j2 = End  (2)<a name='501'>
  if(NDim == 2) return<a name='502'>
  k1 = Start(3)<a name='503'>
  k2 = End  (3)<a name='504'>
  return<a name='505'>
end subroutine GetIndices<a name='506'>
<a name='507'>
<A NAME='ZEROLENGTHHORZDIM'><A href='../../html_code/io_netcdf/wrf_io.F90.html#ZEROLENGTHHORZDIM' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='508'>
logical <font color=#993300>function </font><font color=#cc0000>ZeroLengthHorzDim</font>(MemoryOrder,Vector,Status),<A href='../../call_from/ZEROLENGTHHORZDIM.html' TARGET='index'>3</A><a name='509'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ZEROLENGTHHORZDIM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_15"><a name='510'>
  include 'wrf_status_codes.h'<a name='511'>
  character*(*)              ,intent(in)    :: MemoryOrder<a name='512'>
  integer,dimension(*)       ,intent(in)    :: Vector<a name='513'>
  integer                    ,intent(out)   :: Status<a name='514'>
  integer                                   :: NDim<a name='515'>
  integer,dimension(NVarDims)               :: temp<a name='516'>
  character*3                               :: MemOrd<a name='517'>
  logical zero_length<a name='518'>
<a name='519'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDIM'>GetDim</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ZEROLENGTHHORZDIM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDIM_1">(MemoryOrder,NDim,Status)<a name='520'>
  temp(1:NDim) = Vector(1:NDim)<a name='521'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#LOWERCASE'>LowerCase</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#ZEROLENGTHHORZDIM' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LOWERCASE_3">(MemoryOrder,MemOrd)<a name='522'>
  zero_length = .false.<a name='523'>
  select case (MemOrd)<a name='524'>
    case ('xsz','xez','ysz','yez','xs','xe','ys','ye','z','c')<a name='525'>
      continue<a name='526'>
    case ('0')<a name='527'>
      continue  <font color=#447700>! NDim=0 for scalars.  TBH:  20060502<a name='528'></font>
    case ('xzy','yzx')<a name='529'>
      zero_length = temp(1) .lt. 1 .or. temp(3) .lt. 1<a name='530'>
    case ('xy','yx','xyz','yxz')<a name='531'>
      zero_length = temp(1) .lt. 1 .or. temp(2) .lt. 1<a name='532'>
    case ('zxy','zyx')<a name='533'>
      zero_length = temp(2) .lt. 1 .or. temp(3) .lt. 1<a name='534'>
    case default<a name='535'>
      Status = WRF_WARN_BAD_MEMORYORDER<a name='536'>
      ZeroLengthHorzDim = .true.<a name='537'>
      return<a name='538'>
  end select<a name='539'>
  Status = WRF_NO_ERR<a name='540'>
  ZeroLengthHorzDim = zero_length<a name='541'>
  return<a name='542'>
end function ZeroLengthHorzDim<a name='543'>
<a name='544'>
<A NAME='EXTORDER'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXTORDER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='545'>
<font color=#993300>subroutine </font><font color=#cc0000>ExtOrder</font>(MemoryOrder,Vector,Status) <A href='../../call_to/EXTORDER.html' TARGET='index'>2</A>,<A href='../../call_from/EXTORDER.html' TARGET='index'>3</A><a name='546'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXTORDER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_16"><a name='547'>
  include 'wrf_status_codes.h'<a name='548'>
  character*(*)              ,intent(in)    :: MemoryOrder<a name='549'>
  integer,dimension(*)       ,intent(inout) :: Vector<a name='550'>
  integer                    ,intent(out)   :: Status<a name='551'>
  integer                                   :: NDim<a name='552'>
  integer,dimension(NVarDims)               :: temp<a name='553'>
  character*3                               :: MemOrd<a name='554'>
<a name='555'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDIM'>GetDim</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXTORDER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDIM_2">(MemoryOrder,NDim,Status)<a name='556'>
  temp(1:NDim) = Vector(1:NDim)<a name='557'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#LOWERCASE'>LowerCase</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXTORDER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LOWERCASE_4">(MemoryOrder,MemOrd)<a name='558'>
  select case (MemOrd)<a name='559'>
<a name='560'>
    case ('xyz','xsz','xez','ysz','yez','xy','xs','xe','ys','ye','z','c')<a name='561'>
      continue<a name='562'>
    case ('0')<a name='563'>
      continue  <font color=#447700>! NDim=0 for scalars.  TBH:  20060502<a name='564'></font>
    case ('xzy')<a name='565'>
      Vector(2) = temp(3)<a name='566'>
      Vector(3) = temp(2)<a name='567'>
    case ('yxz')<a name='568'>
      Vector(1) = temp(2)<a name='569'>
      Vector(2) = temp(1)<a name='570'>
    case ('yzx')<a name='571'>
      Vector(1) = temp(3)<a name='572'>
      Vector(2) = temp(1)<a name='573'>
      Vector(3) = temp(2)<a name='574'>
    case ('zxy')<a name='575'>
      Vector(1) = temp(2)<a name='576'>
      Vector(2) = temp(3)<a name='577'>
      Vector(3) = temp(1)<a name='578'>
    case ('zyx')<a name='579'>
      Vector(1) = temp(3)<a name='580'>
      Vector(3) = temp(1)<a name='581'>
    case ('yx')<a name='582'>
      Vector(1) = temp(2)<a name='583'>
      Vector(2) = temp(1)<a name='584'>
    case default<a name='585'>
      Status = WRF_WARN_BAD_MEMORYORDER<a name='586'>
      return<a name='587'>
  end select<a name='588'>
  Status = WRF_NO_ERR<a name='589'>
  return<a name='590'>
end subroutine ExtOrder<a name='591'>
<a name='592'>
<A NAME='EXTORDERSTR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXTORDERSTR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='593'>
<font color=#993300>subroutine </font><font color=#cc0000>ExtOrderStr</font>(MemoryOrder,Vector,ROVector,Status) <A href='../../call_to/EXTORDERSTR.html' TARGET='index'>1</A>,<A href='../../call_from/EXTORDERSTR.html' TARGET='index'>3</A><a name='594'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXTORDERSTR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_17"><a name='595'>
  include 'wrf_status_codes.h'<a name='596'>
  character*(*)                    ,intent(in)    :: MemoryOrder<a name='597'>
  character*(*),dimension(*)       ,intent(in)    :: Vector<a name='598'>
  character(80),dimension(NVarDims),intent(out)   :: ROVector<a name='599'>
  integer                          ,intent(out)   :: Status<a name='600'>
  integer                                         :: NDim<a name='601'>
  character*3                                     :: MemOrd<a name='602'>
<a name='603'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDIM'>GetDim</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXTORDERSTR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDIM_3">(MemoryOrder,NDim,Status)<a name='604'>
  ROVector(1:NDim) = Vector(1:NDim)<a name='605'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#LOWERCASE'>LowerCase</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXTORDERSTR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LOWERCASE_5">(MemoryOrder,MemOrd)<a name='606'>
  select case (MemOrd)<a name='607'>
<a name='608'>
    case ('xyz','xsz','xez','ysz','yez','xy','xs','xe','ys','ye','z','c')<a name='609'>
      continue<a name='610'>
    case ('0')<a name='611'>
      continue  <font color=#447700>! NDim=0 for scalars.  TBH:  20060502<a name='612'></font>
    case ('xzy')<a name='613'>
      ROVector(2) = Vector(3)<a name='614'>
      ROVector(3) = Vector(2)<a name='615'>
    case ('yxz')<a name='616'>
      ROVector(1) = Vector(2)<a name='617'>
      ROVector(2) = Vector(1)<a name='618'>
    case ('yzx')<a name='619'>
      ROVector(1) = Vector(3)<a name='620'>
      ROVector(2) = Vector(1)<a name='621'>
      ROVector(3) = Vector(2)<a name='622'>
    case ('zxy')<a name='623'>
      ROVector(1) = Vector(2)<a name='624'>
      ROVector(2) = Vector(3)<a name='625'>
      ROVector(3) = Vector(1)<a name='626'>
    case ('zyx')<a name='627'>
      ROVector(1) = Vector(3)<a name='628'>
      ROVector(3) = Vector(1)<a name='629'>
    case ('yx')<a name='630'>
      ROVector(1) = Vector(2)<a name='631'>
      ROVector(2) = Vector(1)<a name='632'>
    case default<a name='633'>
      Status = WRF_WARN_BAD_MEMORYORDER<a name='634'>
      return<a name='635'>
  end select<a name='636'>
  Status = WRF_NO_ERR<a name='637'>
  return<a name='638'>
end subroutine ExtOrderStr<a name='639'>
<a name='640'>
<a name='641'>
<A NAME='LOWERCASE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#LOWERCASE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='642'>
<font color=#993300>subroutine </font><font color=#cc0000>LowerCase</font>(MemoryOrder,MemOrd) <A href='../../call_to/LOWERCASE.html' TARGET='index'>8</A><a name='643'>
  character*(*) ,intent(in)  :: MemoryOrder<a name='644'>
  character*(*) ,intent(out) :: MemOrd<a name='645'>
  character*1                :: c<a name='646'>
  integer       ,parameter   :: upper_to_lower =IACHAR('a')-IACHAR('A')<a name='647'>
  integer                    :: i,N<a name='648'>
<a name='649'>
  MemOrd = ' '<a name='650'>
  N = len(MemoryOrder)<a name='651'>
  MemOrd(1:N) = MemoryOrder(1:N)<a name='652'>
  do i=1,N<a name='653'>
    c = MemoryOrder(i:i)<a name='654'>
    if('A'&lt;=c .and. c &lt;='Z') MemOrd(i:i)=achar(iachar(c)+upper_to_lower)<a name='655'>
  enddo<a name='656'>
  return<a name='657'>
end subroutine LowerCase<a name='658'>
<a name='659'>
<A NAME='UPPERCASE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#UPPERCASE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='660'>
<font color=#993300>subroutine </font><font color=#cc0000>UpperCase</font>(MemoryOrder,MemOrd) <A href='../../call_to/UPPERCASE.html' TARGET='index'>1</A><a name='661'>
  character*(*) ,intent(in)  :: MemoryOrder<a name='662'>
  character*(*) ,intent(out) :: MemOrd<a name='663'>
  character*1                :: c<a name='664'>
  integer     ,parameter     :: lower_to_upper =IACHAR('A')-IACHAR('a')<a name='665'>
  integer                    :: i,N<a name='666'>
<a name='667'>
  MemOrd = ' '<a name='668'>
  N = len(MemoryOrder)<a name='669'>
  MemOrd(1:N) = MemoryOrder(1:N)<a name='670'>
  do i=1,N<a name='671'>
    c = MemoryOrder(i:i)<a name='672'>
    if('a'&lt;=c .and. c &lt;='z') MemOrd(i:i)=achar(iachar(c)+lower_to_upper)<a name='673'>
  enddo<a name='674'>
  return<a name='675'>
end subroutine UpperCase<a name='676'>
<a name='677'>
<A NAME='NETCDF_ERR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='678'>
<font color=#993300>subroutine </font><font color=#cc0000>netcdf_err</font>(err,Status) <A href='../../call_to/NETCDF_ERR.html' TARGET='index'>48</A>,<A href='../../call_from/NETCDF_ERR.html' TARGET='index'>2</A><a name='679'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_18"><a name='680'>
  include 'wrf_status_codes.h'<a name='681'>
  include 'netcdf.inc'<a name='682'>
  integer  ,intent(in)  :: err<a name='683'>
  integer  ,intent(out) :: Status<a name='684'>
  character(len=80)     :: errmsg<a name='685'>
  integer               :: stat<a name='686'>
<a name='687'>
  if( err==NF_NOERR )then<a name='688'>
    Status = WRF_NO_ERR<a name='689'>
  else<a name='690'>
    errmsg = NF_STRERROR(err) <a name='691'>
    write(msg,*) 'NetCDF error: ',errmsg<a name='692'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1361"> ( WARN , TRIM(msg))<a name='693'>
    Status = WRF_WARN_NETCDF<a name='694'>
  endif<a name='695'>
  return<a name='696'>
end subroutine netcdf_err<a name='697'>
<a name='698'>
<A NAME='FIELDIO'><A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='699'>
<font color=#993300>subroutine </font><font color=#cc0000>FieldIO</font>(IO,DataHandle,DateStr,Length,MemoryOrder &amp; <A href='../../call_to/FIELDIO.html' TARGET='index'>2</A>,<A href='../../call_from/FIELDIO.html' TARGET='index'>10</A><a name='700'>
                     ,FieldType,NCID,VarID,XField,Status)<a name='701'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_19"><a name='702'>
  include 'wrf_status_codes.h'<a name='703'>
  include 'netcdf.inc'<a name='704'>
  character (*)              ,intent(in)    :: IO<a name='705'>
  integer                    ,intent(in)    :: DataHandle<a name='706'>
  character*(*)              ,intent(in)    :: DateStr<a name='707'>
  integer,dimension(NVarDims),intent(in)    :: Length<a name='708'>
  character*(*)              ,intent(in)    :: MemoryOrder<a name='709'>
  integer                    ,intent(in)    :: FieldType<a name='710'>
  integer                    ,intent(in)    :: NCID<a name='711'>
  integer                    ,intent(in)    :: VarID<a name='712'>
  integer,dimension(*)       ,intent(inout) :: XField<a name='713'>
  integer                    ,intent(out)   :: Status<a name='714'>
  integer                                   :: TimeIndex<a name='715'>
  integer                                   :: NDim<a name='716'>
  integer,dimension(NVarDims)               :: VStart<a name='717'>
  integer,dimension(NVarDims)               :: VCount<a name='718'>
<a name='719'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETTIMEINDEX'>GetTimeIndex</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETTIMEINDEX_1">(IO,DataHandle,DateStr,TimeIndex,Status)<a name='720'>
  if(Status /= WRF_NO_ERR) then<a name='721'>
    write(msg,*) 'Warning in ',__FILE__,', line', __LINE__<a name='722'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1362"> ( WARN , TRIM(msg))<a name='723'>
    write(msg,*) '  Bad time index for DateStr = ',DateStr<a name='724'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1363"> ( WARN , TRIM(msg))<a name='725'>
    return<a name='726'>
  endif<a name='727'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDIM'>GetDim</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDIM_4">(MemoryOrder,NDim,Status)<a name='728'>
  VStart(:) = 1<a name='729'>
  VCount(:) = 1<a name='730'>
  VStart(1:NDim) = 1<a name='731'>
  VCount(1:NDim) = Length(1:NDim)<a name='732'>
  VStart(NDim+1) = TimeIndex<a name='733'>
  VCount(NDim+1) = 1<a name='734'>
<a name='735'>
  <font color=#447700>! Do not use SELECT statement here as sometimes WRF_REAL=WRF_DOUBLE<a name='736'></font>
  IF (FieldType == WRF_REAL) THEN<a name='737'>
    call <A href='../../html_code/io_netcdf/field_routines.F90.html#EXT_NCD_REALFIELDIO'>ext_ncd_RealFieldIO</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_REALFIELDIO_1">    (IO,NCID,VarID,VStart,VCount,XField,Status)<a name='738'>
  ELSE IF (FieldType == WRF_DOUBLE) THEN<a name='739'>
    call <A href='../../html_code/io_netcdf/field_routines.F90.html#EXT_NCD_DOUBLEFIELDIO'>ext_ncd_DoubleFieldIO</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_DOUBLEFIELDIO_1">  (IO,NCID,VarID,VStart,VCount,XField,Status)<a name='740'>
  ELSE IF (FieldType == WRF_INTEGER) THEN<a name='741'>
    call <A href='../../html_code/io_netcdf/field_routines.F90.html#EXT_NCD_INTFIELDIO'>ext_ncd_IntFieldIO</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_INTFIELDIO_1">     (IO,NCID,VarID,VStart,VCount,XField,Status)<a name='742'>
  ELSE IF (FieldType == WRF_LOGICAL) THEN<a name='743'>
    call <A href='../../html_code/io_netcdf/field_routines.F90.html#EXT_NCD_LOGICALFIELDIO'>ext_ncd_LogicalFieldIO</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_LOGICALFIELDIO_1"> (IO,NCID,VarID,VStart,VCount,XField,Status)<a name='744'>
    if(Status /= WRF_NO_ERR) return<a name='745'>
  ELSE<a name='746'>
<font color=#447700>!for wrf_complex, double_complex<a name='747'></font>
      Status = WRF_WARN_DATA_TYPE_NOT_FOUND<a name='748'>
      write(msg,*) 'Warning DATA TYPE NOT FOUND in ',__FILE__,', line', __LINE__<a name='749'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1364"> ( WARN , TRIM(msg))<a name='750'>
      return<a name='751'>
  END IF<a name='752'>
<a name='753'>
  return<a name='754'>
end subroutine FieldIO<a name='755'>
<a name='756'>
<A NAME='TRANSPOSE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='757'>
<font color=#993300>subroutine </font><font color=#cc0000>Transpose</font>(IO,MemoryOrder,di, Field,l1,l2,m1,m2,n1,n2 &amp; <A href='../../call_to/TRANSPOSE.html' TARGET='index'>2</A>,<A href='../../call_from/TRANSPOSE.html' TARGET='index'>1</A><a name='758'>
                                      ,XField,x1,x2,y1,y2,z1,z2 &amp;<a name='759'>
                                             ,i1,i2,j1,j2,k1,k2 )<a name='760'>
  character*(*)     ,intent(in)    :: IO<a name='761'>
  character*(*)     ,intent(in)    :: MemoryOrder<a name='762'>
  integer           ,intent(in)    :: l1,l2,m1,m2,n1,n2<a name='763'>
  integer           ,intent(in)    :: di<a name='764'>
  integer           ,intent(in)    :: x1,x2,y1,y2,z1,z2<a name='765'>
  integer           ,intent(in)    :: i1,i2,j1,j2,k1,k2<a name='766'>
  integer           ,intent(inout) ::  Field(di,l1:l2,m1:m2,n1:n2)<a name='767'>
<font color=#447700>!jm 010827  integer           ,intent(inout) :: XField(di,x1:x2,y1:y2,z1:z2)<a name='768'></font>
  integer           ,intent(inout) :: XField(di,(i2-i1+1)*(j2-j1+1)*(k2-k1+1))<a name='769'>
  character*3                      :: MemOrd<a name='770'>
  character*3                      :: MemO<a name='771'>
  integer           ,parameter     :: MaxUpperCase=IACHAR('Z')<a name='772'>
  integer                          :: i,j,k,ix,jx,kx<a name='773'>
<a name='774'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#LOWERCASE'>LowerCase</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LOWERCASE_6">(MemoryOrder,MemOrd)<a name='775'>
  select case (MemOrd)<a name='776'>
<a name='777'>
<font color=#447700>!#define XDEX(A,B,C) A-A ## 1+1+(A ## 2-A ## 1+1)*((B-B ## 1)+(C-C ## 1)*(B ## 2-B ## 1+1))<a name='778'></font>
<font color=#447700>! define(`XDEX',($1-``$1''1+1+(``$1''2-``$1''1+1)*(($2-``$2''1)+($3-``$3''1)*(``$2''2-``$2''1+1))))<a name='779'></font>
<a name='780'>
    case ('xzy')<a name='781'>
#undef  DFIELD<a name='782'>
#define DFIELD XField(1:di,XDEX(i,k,j))<a name='783'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_2"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='784'>
    case ('xyz','xsz','xez','ysz','yez','xy','xs','xe','ys','ye','z','c','0')<a name='785'>
#undef  DFIELD<a name='786'>
#define DFIELD XField(1:di,XDEX(i,j,k))<a name='787'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_3"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='788'>
    case ('yxz')<a name='789'>
#undef  DFIELD<a name='790'>
#define DFIELD XField(1:di,XDEX(j,i,k))<a name='791'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_4"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='792'>
    case ('zxy')<a name='793'>
#undef  DFIELD<a name='794'>
#define DFIELD XField(1:di,XDEX(k,i,j))<a name='795'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_5"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='796'>
    case ('yzx')<a name='797'>
#undef  DFIELD<a name='798'>
#define DFIELD XField(1:di,XDEX(j,k,i))<a name='799'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_6"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='800'>
    case ('zyx')<a name='801'>
#undef  DFIELD<a name='802'>
#define DFIELD XField(1:di,XDEX(k,j,i))<a name='803'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_7"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='804'>
    case ('yx')<a name='805'>
#undef  DFIELD<a name='806'>
#define DFIELD XField(1:di,XDEX(j,i,k))<a name='807'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_8"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='808'>
  end select<a name='809'>
  return<a name='810'>
end subroutine Transpose<a name='811'>
<a name='812'>
<A NAME='REORDER'><A href='../../html_code/io_netcdf/wrf_io.F90.html#REORDER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='813'>
<font color=#993300>subroutine </font><font color=#cc0000>reorder</font> (MemoryOrder,MemO) <A href='../../call_to/REORDER.html' TARGET='index'>1</A>,<A href='../../call_from/REORDER.html' TARGET='index'>1</A><a name='814'>
  character*(*)     ,intent(in)    :: MemoryOrder<a name='815'>
  character*3       ,intent(out)   :: MemO<a name='816'>
  character*3                      :: MemOrd<a name='817'>
  integer                          :: N,i,i1,i2,i3<a name='818'>
<a name='819'>
  MemO = MemoryOrder<a name='820'>
  N = len_trim(MemoryOrder)<a name='821'>
  if(N == 1) return<a name='822'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#LOWERCASE'>lowercase</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#REORDER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LOWERCASE_7">(MemoryOrder,MemOrd)<a name='823'>
<font color=#447700>! never invert the boundary codes<a name='824'></font>
  select case ( MemOrd )<a name='825'>
     case ( 'xsz','xez','ysz','yez' )<a name='826'>
       return<a name='827'>
     case default<a name='828'>
       continue<a name='829'>
  end select<a name='830'>
  i1 = 1<a name='831'>
  i3 = 1<a name='832'>
  do i=2,N<a name='833'>
    if(ichar(MemOrd(i:i)) &lt; ichar(MemOrd(i1:i1))) I1 = i<a name='834'>
    if(ichar(MemOrd(i:i)) &gt; ichar(MemOrd(i3:i3))) I3 = i<a name='835'>
  enddo<a name='836'>
  if(N == 2) then<a name='837'>
    i2=i3<a name='838'>
  else<a name='839'>
    i2 = 6-i1-i3<a name='840'>
  endif<a name='841'>
  MemO(1:1) = MemoryOrder(i1:i1)<a name='842'>
  MemO(2:2) = MemoryOrder(i2:i2)<a name='843'>
  if(N == 3) MemO(3:3) = MemoryOrder(i3:i3)<a name='844'>
  if(MemOrd(i1:i1) == 's' .or. MemOrd(i1:i1) == 'e') then<a name='845'>
    MemO(1:N-1) = MemO(2:N)<a name='846'>
    MemO(N:N  ) = MemoryOrder(i1:i1)<a name='847'>
  endif<a name='848'>
  return<a name='849'>
end subroutine reorder<a name='850'>
  <a name='851'>
<font color=#447700>! Returns .TRUE. iff it is OK to write time-independent domain metadata to the <a name='852'></font>
<font color=#447700>! file referenced by DataHandle.  If DataHandle is invalid, .FALSE. is <a name='853'></font>
<font color=#447700>! returned.  <a name='854'></font>
<A NAME='NCD_OK_TO_PUT_DOM_TI'><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_OK_TO_PUT_DOM_TI' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='855'>
LOGICAL <font color=#993300>FUNCTION </font><font color=#cc0000>ncd_ok_to_put_dom_ti</font>( DataHandle ),<A href='../../call_from/NCD_OK_TO_PUT_DOM_TI.html' TARGET='index'>4</A><a name='856'>
    USE <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_OK_TO_PUT_DOM_TI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_20"><a name='857'>
    include 'wrf_status_codes.h'<a name='858'>
    INTEGER, INTENT(IN) :: DataHandle <a name='859'>
    CHARACTER*80 :: fname<a name='860'>
    INTEGER :: filestate<a name='861'>
    INTEGER :: Status<a name='862'>
    LOGICAL :: dryrun, first_output, retval<a name='863'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRE_FILENAME'>ext_ncd_inquire_filename</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_OK_TO_PUT_DOM_TI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_INQUIRE_FILENAME_10">( DataHandle, fname, filestate, Status )<a name='864'>
    IF ( Status /= WRF_NO_ERR ) THEN<a name='865'>
      write(msg,*) 'Warning Status = ',Status,' in ',__FILE__, &amp;<a name='866'>
                   ', line', __LINE__<a name='867'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_OK_TO_PUT_DOM_TI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1365"> ( WARN , TRIM(msg) )<a name='868'>
      retval = .FALSE.<a name='869'>
    ELSE<a name='870'>
      dryrun       = ( filestate .EQ. WRF_FILE_OPENED_NOT_COMMITTED )<a name='871'>
      first_output = <A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_IS_FIRST_OPERATION'>ncd_is_first_operation</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_OK_TO_PUT_DOM_TI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NCD_IS_FIRST_OPERATION_1">( DataHandle )<a name='872'>
      retval = .NOT. dryrun .AND. first_output<a name='873'>
    ENDIF<a name='874'>
    ncd_ok_to_put_dom_ti = retval<a name='875'>
    RETURN<a name='876'>
END FUNCTION ncd_ok_to_put_dom_ti<a name='877'>
<a name='878'>
<font color=#447700>! Returns .TRUE. iff it is OK to read time-independent domain metadata from the <a name='879'></font>
<font color=#447700>! file referenced by DataHandle.  If DataHandle is invalid, .FALSE. is <a name='880'></font>
<font color=#447700>! returned.  <a name='881'></font>
<A NAME='NCD_OK_TO_GET_DOM_TI'><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_OK_TO_GET_DOM_TI' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='882'>
LOGICAL <font color=#993300>FUNCTION </font><font color=#cc0000>ncd_ok_to_get_dom_ti</font>( DataHandle ),<A href='../../call_from/NCD_OK_TO_GET_DOM_TI.html' TARGET='index'>3</A><a name='883'>
    USE <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_OK_TO_GET_DOM_TI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_21"><a name='884'>
    include 'wrf_status_codes.h'<a name='885'>
    INTEGER, INTENT(IN) :: DataHandle <a name='886'>
    CHARACTER*80 :: fname<a name='887'>
    INTEGER :: filestate<a name='888'>
    INTEGER :: Status<a name='889'>
    LOGICAL :: dryrun, retval<a name='890'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRE_FILENAME'>ext_ncd_inquire_filename</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_OK_TO_GET_DOM_TI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_INQUIRE_FILENAME_11">( DataHandle, fname, filestate, Status )<a name='891'>
    IF ( Status /= WRF_NO_ERR ) THEN<a name='892'>
      write(msg,*) 'Warning Status = ',Status,' in ',__FILE__, &amp;<a name='893'>
                   ', line', __LINE__<a name='894'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_OK_TO_GET_DOM_TI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1366"> ( WARN , TRIM(msg) )<a name='895'>
      retval = .FALSE.<a name='896'>
    ELSE<a name='897'>
      dryrun       = ( filestate .EQ. WRF_FILE_OPENED_NOT_COMMITTED )<a name='898'>
      retval = .NOT. dryrun<a name='899'>
    ENDIF<a name='900'>
    ncd_ok_to_get_dom_ti = retval<a name='901'>
    RETURN<a name='902'>
END FUNCTION ncd_ok_to_get_dom_ti<a name='903'>
<a name='904'>
<font color=#447700>! Returns .TRUE. iff nothing has been read from or written to the file <a name='905'></font>
<font color=#447700>! referenced by DataHandle.  If DataHandle is invalid, .FALSE. is returned.  <a name='906'></font>
<A NAME='NCD_IS_FIRST_OPERATION'><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_IS_FIRST_OPERATION' TARGET='top_target'><IMG SRC="../../gif/bar_green.gif" border=0></A><a name='907'>
LOGICAL <font color=#993300>FUNCTION </font><font color=#cc0000>ncd_is_first_operation</font>( DataHandle ) <A href='../../call_to/NCD_IS_FIRST_OPERATION.html' TARGET='index'>1</A>,<A href='../../call_from/NCD_IS_FIRST_OPERATION.html' TARGET='index'>3</A><a name='908'>
    USE <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_IS_FIRST_OPERATION' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_22"><a name='909'>
    INCLUDE 'wrf_status_codes.h'<a name='910'>
    INTEGER, INTENT(IN) :: DataHandle <a name='911'>
    TYPE(wrf_data_handle) ,POINTER :: DH<a name='912'>
    INTEGER :: Status<a name='913'>
    LOGICAL :: retval<a name='914'>
    CALL <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_IS_FIRST_OPERATION' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_1">( DataHandle, DH, Status )<a name='915'>
    IF ( Status /= WRF_NO_ERR ) THEN<a name='916'>
      write(msg,*) 'Warning Status = ',Status,' in ',__FILE__, &amp;<a name='917'>
                   ', line', __LINE__<a name='918'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#NCD_IS_FIRST_OPERATION' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1367"> ( WARN , TRIM(msg) )<a name='919'>
      retval = .FALSE.<a name='920'>
    ELSE<a name='921'>
      retval = DH%first_operation<a name='922'>
    ENDIF<a name='923'>
    ncd_is_first_operation = retval<a name='924'>
    RETURN<a name='925'>
END FUNCTION ncd_is_first_operation<a name='926'>
<a name='927'>
<A NAME='UPGRADE_FILENAME'><A href='../../html_code/io_netcdf/wrf_io.F90.html#UPGRADE_FILENAME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='928'>
<font color=#993300>subroutine </font><font color=#cc0000>upgrade_filename</font>(FileName)<a name='929'>
  implicit none<a name='930'>
<a name='931'>
  character*(*), intent(inout) :: FileName<a name='932'>
  integer :: i<a name='933'>
<a name='934'>
  do i = 1, len(trim(FileName))<a name='935'>
     if(FileName(i:i) == '-') then<a name='936'>
        FileName(i:i) = '_'<a name='937'>
     else if(FileName(i:i) == ':') then<a name='938'>
         FileName(i:i) = '_'<a name='939'>
     endif<a name='940'>
  enddo<a name='941'>
<a name='942'>
end subroutine upgrade_filename<a name='943'>
<a name='944'>
end module ext_ncd_support_routines<a name='945'>
<a name='946'>
<A NAME='TRANSPOSETOR4'><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSETOR4' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='947'>
<font color=#993300>subroutine </font><font color=#cc0000>TransposeToR4</font>(IO,MemoryOrder,di, Field,l1,l2,m1,m2,n1,n2 &amp; <A href='../../call_to/TRANSPOSETOR4.html' TARGET='index'>1</A>,<A href='../../call_from/TRANSPOSETOR4.html' TARGET='index'>2</A><a name='948'>
                                      ,XField,x1,x2,y1,y2,z1,z2 &amp;<a name='949'>
                                             ,i1,i2,j1,j2,k1,k2 )<a name='950'>
<a name='951'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSETOR4' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_5"> <a name='952'>
<a name='953'>
  character*(*)     ,intent(in)    :: IO<a name='954'>
  character*(*)     ,intent(in)    :: MemoryOrder<a name='955'>
  integer           ,intent(in)    :: l1,l2,m1,m2,n1,n2<a name='956'>
  integer           ,intent(in)    :: di<a name='957'>
  integer           ,intent(in)    :: x1,x2,y1,y2,z1,z2<a name='958'>
  integer           ,intent(in)    :: i1,i2,j1,j2,k1,k2<a name='959'>
  real*8            ,intent(inout) :: Field(di,l1:l2,m1:m2,n1:n2)<a name='960'>
  real*4            ,intent(inout) :: XField(di,(i2-i1+1)*(j2-j1+1)*(k2-k1+1))<a name='961'>
  character*3                      :: MemOrd<a name='962'>
  character*3                      :: MemO<a name='963'>
  integer           ,parameter     :: MaxUpperCase=IACHAR('Z')<a name='964'>
  integer                          :: i,j,k,ix,jx,kx<a name='965'>
<a name='966'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#LOWERCASE'>LowerCase</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSETOR4' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="LOWERCASE_8">(MemoryOrder,MemOrd)<a name='967'>
  select case (MemOrd)<a name='968'>
<a name='969'>
<font color=#447700>!#define XDEX(A,B,C) A-A ## 1+1+(A ## 2-A ## 1+1)*((B-B ## 1)+(C-C ## 1)*(B ## 2-B ## 1+1))<a name='970'></font>
<font color=#447700>! define(`XDEX',($1-``$1''1+1+(``$1''2-``$1''1+1)*(($2-``$2''1)+($3-``$3''1)*(``$2''2-``$2''1+1))))<a name='971'></font>
<a name='972'>
    case ('xzy')<a name='973'>
#undef  DFIELD<a name='974'>
#define DFIELD XField(1:di,XDEX(i,k,j))<a name='975'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_9"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSETOR4' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='976'>
    case ('xyz','xsz','xez','ysz','yez','xy','xs','xe','ys','ye','z','c','0')<a name='977'>
#undef  DFIELD<a name='978'>
#define DFIELD XField(1:di,XDEX(i,j,k))<a name='979'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_10"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSETOR4' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='980'>
    case ('yxz')<a name='981'>
#undef  DFIELD<a name='982'>
#define DFIELD XField(1:di,XDEX(j,i,k))<a name='983'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_11"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSETOR4' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='984'>
    case ('zxy')<a name='985'>
#undef  DFIELD<a name='986'>
#define DFIELD XField(1:di,XDEX(k,i,j))<a name='987'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_12"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSETOR4' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='988'>
    case ('yzx')<a name='989'>
#undef  DFIELD<a name='990'>
#define DFIELD XField(1:di,XDEX(j,k,i))<a name='991'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_13"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSETOR4' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='992'>
    case ('zyx')<a name='993'>
#undef  DFIELD<a name='994'>
#define DFIELD XField(1:di,XDEX(k,j,i))<a name='995'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_14"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSETOR4' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='996'>
    case ('yx')<a name='997'>
#undef  DFIELD<a name='998'>
#define DFIELD XField(1:di,XDEX(j,i,k))<a name='999'>
#include "<A href='../../html_code/include/transpose.code.html'>transpose.code</A>"<A NAME="transpose.code_15"><A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSETOR4' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1000'>
  end select<a name='1001'>
  return<a name='1002'>
end subroutine TransposeToR4<a name='1003'>
<a name='1004'>
<A NAME='EXT_NCD_OPEN_FOR_READ'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1005'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_open_for_read</font>(DatasetName, Comm1, Comm2, SysDepInfo, DataHandle, Status) <A href='../../call_to/EXT_NCD_OPEN_FOR_READ.html' TARGET='index'>6</A>,<A href='../../call_from/EXT_NCD_OPEN_FOR_READ.html' TARGET='index'>4</A><a name='1006'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_23"><a name='1007'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_6"><a name='1008'>
  implicit none<a name='1009'>
  include 'wrf_status_codes.h'<a name='1010'>
  include 'netcdf.inc'<a name='1011'>
  character *(*), INTENT(IN)   :: DatasetName<a name='1012'>
  integer       , INTENT(IN)   :: Comm1, Comm2<a name='1013'>
  character *(*), INTENT(IN)   :: SysDepInfo<a name='1014'>
  integer       , INTENT(OUT)  :: DataHandle<a name='1015'>
  integer       , INTENT(OUT)  :: Status<a name='1016'>
  DataHandle = 0   <font color=#447700>! dummy setting to quiet warning message<a name='1017'></font>
  CALL <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN'>ext_ncd_open_for_read_begin</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_OPEN_FOR_READ_BEGIN_2">( DatasetName, Comm1, Comm2, SysDepInfo, DataHandle, Status )<a name='1018'>
  IF ( Status .EQ. WRF_NO_ERR ) THEN<a name='1019'>
    CALL <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_COMMIT'>ext_ncd_open_for_read_commit</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_OPEN_FOR_READ_COMMIT_2">( DataHandle, Status )<a name='1020'>
  ENDIF<a name='1021'>
  return<a name='1022'>
end subroutine ext_ncd_open_for_read<a name='1023'>
<a name='1024'>
<font color=#447700>!ends training phase; switches internal flag to enable input<a name='1025'></font>
<font color=#447700>!must be paired with call to ext_ncd_open_for_read_begin<a name='1026'></font>
<A NAME='EXT_NCD_OPEN_FOR_READ_COMMIT'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_COMMIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1027'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_open_for_read_commit</font>(DataHandle, Status) <A href='../../call_to/EXT_NCD_OPEN_FOR_READ_COMMIT.html' TARGET='index'>2</A>,<A href='../../call_from/EXT_NCD_OPEN_FOR_READ_COMMIT.html' TARGET='index'>5</A><a name='1028'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_24"><a name='1029'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_7"><a name='1030'>
  implicit none<a name='1031'>
  include 'wrf_status_codes.h'<a name='1032'>
  include 'netcdf.inc'<a name='1033'>
  integer, intent(in) :: DataHandle<a name='1034'>
  integer, intent(out) :: Status<a name='1035'>
  type(wrf_data_handle) ,pointer         :: DH<a name='1036'>
<a name='1037'>
  if(WrfIOnotInitialized) then<a name='1038'>
    Status = WRF_IO_NOT_INITIALIZED<a name='1039'>
    write(msg,*) 'ext_ncd_ioinit was not called ',__FILE__,', line', __LINE__<a name='1040'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1368"> ( FATAL , msg)<a name='1041'>
    return<a name='1042'>
  endif<a name='1043'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_2">(DataHandle,DH,Status)<a name='1044'>
  if(Status /= WRF_NO_ERR) then<a name='1045'>
    write(msg,*) 'Warning Status = ',Status,' in ',__FILE__,', line', __LINE__<a name='1046'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1369"> ( WARN , TRIM(msg))<a name='1047'>
    return<a name='1048'>
  endif<a name='1049'>
  DH%FileStatus      = WRF_FILE_OPENED_FOR_READ<a name='1050'>
  DH%first_operation  = .TRUE.<a name='1051'>
  Status = WRF_NO_ERR<a name='1052'>
  return<a name='1053'>
end subroutine ext_ncd_open_for_read_commit<a name='1054'>
<a name='1055'>
<A NAME='EXT_NCD_OPEN_FOR_READ_BEGIN'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1056'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_open_for_read_begin</font>( FileName, Comm, IOComm, SysDepInfo, DataHandle, Status) <A href='../../call_to/EXT_NCD_OPEN_FOR_READ_BEGIN.html' TARGET='index'>2</A>,<A href='../../call_from/EXT_NCD_OPEN_FOR_READ_BEGIN.html' TARGET='index'>24</A><a name='1057'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_25"><a name='1058'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_8"><a name='1059'>
  implicit none<a name='1060'>
  include 'wrf_status_codes.h'<a name='1061'>
  include 'netcdf.inc'<a name='1062'>
  character*(*)         ,intent(INOUT)   :: FileName<a name='1063'>
  integer               ,intent(IN)      :: Comm<a name='1064'>
  integer               ,intent(IN)      :: IOComm<a name='1065'>
  character*(*)         ,intent(in)      :: SysDepInfo<a name='1066'>
  integer               ,intent(out)     :: DataHandle<a name='1067'>
  integer               ,intent(out)     :: Status<a name='1068'>
  type(wrf_data_handle) ,pointer         :: DH<a name='1069'>
  integer                                :: XType<a name='1070'>
  integer                                :: stat<a name='1071'>
  integer               ,allocatable     :: Buffer(:)<a name='1072'>
  integer                                :: VarID<a name='1073'>
  integer                                :: StoredDim<a name='1074'>
  integer                                :: NAtts<a name='1075'>
  integer                                :: DimIDs(2)<a name='1076'>
  integer                                :: VStart(2)<a name='1077'>
  integer                                :: VLen(2)<a name='1078'>
  integer                                :: TotalNumVars<a name='1079'>
  integer                                :: NumVars<a name='1080'>
  integer                                :: i<a name='1081'>
  character (NF_MAX_NAME)                :: Name<a name='1082'>
<a name='1083'>
#ifdef USE_NETCDF4_FEATURES<a name='1084'>
  integer                                :: open_mode<a name='1085'>
#endif<a name='1086'>
<a name='1087'>
  <font color=#447700>!call upgrade_filename(FileName)<a name='1088'></font>
<a name='1089'>
  if(WrfIOnotInitialized) then<a name='1090'>
    Status = WRF_IO_NOT_INITIALIZED <a name='1091'>
    write(msg,*) 'ext_ncd_ioinit was not called ',__FILE__,', line', __LINE__<a name='1092'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1370"> ( FATAL , msg)<a name='1093'>
    return<a name='1094'>
  endif<a name='1095'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE'>allocHandle</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ALLOCHANDLE_1">(DataHandle,DH,Comm,Status)<a name='1096'>
  if(Status /= WRF_NO_ERR) then<a name='1097'>
    write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__ <a name='1098'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1371"> ( WARN , TRIM(msg))<a name='1099'>
    return<a name='1100'>
  endif<a name='1101'>
<a name='1102'>
  stat = NF_OPEN(FileName, NF_NOWRITE, DH%NCID)<a name='1103'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_6">(stat,Status)<a name='1104'>
  if(Status /= WRF_NO_ERR) then<a name='1105'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1106'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1372"> ( WARN , TRIM(msg))<a name='1107'>
    return<a name='1108'>
  endif<a name='1109'>
  stat = NF_INQ_VARID(DH%NCID,DH%TimesName,VarID)<a name='1110'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_7">(stat,Status)<a name='1111'>
  if(Status /= WRF_NO_ERR) then<a name='1112'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1113'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1373"> ( WARN , TRIM(msg))<a name='1114'>
    return<a name='1115'>
  endif<a name='1116'>
  stat = NF_INQ_VAR(DH%NCID,VarID,DH%TimesName, XType, StoredDim, DimIDs, NAtts)<a name='1117'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_8">(stat,Status)<a name='1118'>
  if(Status /= WRF_NO_ERR) then<a name='1119'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1120'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1374"> ( WARN , TRIM(msg))<a name='1121'>
    return<a name='1122'>
  endif<a name='1123'>
  if(XType/=NF_CHAR) then<a name='1124'>
    Status = WRF_WARN_TYPE_MISMATCH<a name='1125'>
    write(msg,*) 'Warning TYPE MISMATCH in ',__FILE__,', line', __LINE__<a name='1126'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1375"> ( WARN , TRIM(msg))<a name='1127'>
    return<a name='1128'>
  endif<a name='1129'>
  stat = NF_INQ_DIMLEN(DH%NCID,DimIDs(1),VLen(1))  <a name='1130'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_9">(stat,Status)<a name='1131'>
  if(Status /= WRF_NO_ERR) then<a name='1132'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1133'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1376"> ( WARN , TRIM(msg))<a name='1134'>
    return<a name='1135'>
  endif<a name='1136'>
  if(VLen(1) /= DateStrLen) then<a name='1137'>
    Status = WRF_WARN_DATESTR_BAD_LENGTH<a name='1138'>
    write(msg,*) 'Warning DATESTR BAD LENGTH in ',__FILE__,', line', __LINE__<a name='1139'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1377"> ( WARN , TRIM(msg))<a name='1140'>
    return<a name='1141'>
  endif<a name='1142'>
  stat = NF_INQ_DIMLEN(DH%NCID,DimIDs(2),VLen(2))<a name='1143'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_10">(stat,Status)<a name='1144'>
  if(Status /= WRF_NO_ERR) then<a name='1145'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1146'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1378"> ( WARN , TRIM(msg))<a name='1147'>
    return<a name='1148'>
  endif<a name='1149'>
  if(VLen(2) &gt; MaxTimes) then<a name='1150'>
    Status = WRF_ERR_FATAL_TOO_MANY_TIMES<a name='1151'>
    write(msg,*) 'Fatal TOO MANY TIME VALUES in ',__FILE__,', line', __LINE__<a name='1152'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1379"> ( FATAL , TRIM(msg))<a name='1153'>
    return<a name='1154'>
  endif<a name='1155'>
  VStart(1) = 1<a name='1156'>
  VStart(2) = 1<a name='1157'>
  stat = NF_GET_VARA_TEXT(DH%NCID,VarID,VStart,VLen,DH%Times)<a name='1158'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_11">(stat,Status)<a name='1159'>
  if(Status /= WRF_NO_ERR) then<a name='1160'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1161'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1380"> ( WARN , TRIM(msg))<a name='1162'>
    return<a name='1163'>
  endif<a name='1164'>
  stat = NF_INQ_NVARS(DH%NCID,TotalNumVars)<a name='1165'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_12">(stat,Status)<a name='1166'>
  if(Status /= WRF_NO_ERR) then<a name='1167'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1168'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1381"> ( WARN , TRIM(msg))<a name='1169'>
    return<a name='1170'>
  endif<a name='1171'>
  NumVars = 0<a name='1172'>
  do i=1,TotalNumVars<a name='1173'>
    stat = NF_INQ_VARNAME(DH%NCID,i,Name)<a name='1174'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_13">(stat,Status)<a name='1175'>
    if(Status /= WRF_NO_ERR) then<a name='1176'>
      write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1177'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_READ_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1382"> ( WARN , TRIM(msg))<a name='1178'>
      return<a name='1179'>
    elseif(Name(1:5) /= 'md___' .and. Name /= DH%TimesName) then<a name='1180'>
      NumVars              = NumVars+1<a name='1181'>
      DH%VarNames(NumVars) = Name<a name='1182'>
      DH%VarIDs(NumVars)   = i<a name='1183'>
    endif      <a name='1184'>
  enddo<a name='1185'>
  DH%NumVars         = NumVars<a name='1186'>
  DH%NumberTimes     = VLen(2)<a name='1187'>
  DH%FileStatus      = WRF_FILE_OPENED_NOT_COMMITTED<a name='1188'>
  DH%FileName        = trim(FileName)<a name='1189'>
  DH%CurrentVariable = 0<a name='1190'>
  DH%CurrentTime     = 0<a name='1191'>
  DH%TimesVarID      = VarID<a name='1192'>
  DH%TimeIndex       = 0<a name='1193'>
  return<a name='1194'>
end subroutine ext_ncd_open_for_read_begin<a name='1195'>
<a name='1196'>
<A NAME='EXT_NCD_OPEN_FOR_UPDATE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1197'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_open_for_update</font>( FileName, Comm, IOComm, SysDepInfo, DataHandle, Status),<A href='../../call_from/EXT_NCD_OPEN_FOR_UPDATE.html' TARGET='index'>24</A><a name='1198'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_26"><a name='1199'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_9"><a name='1200'>
  implicit none<a name='1201'>
  include 'wrf_status_codes.h'<a name='1202'>
  include 'netcdf.inc'<a name='1203'>
  character*(*)         ,intent(INOUT)   :: FileName<a name='1204'>
  integer               ,intent(IN)      :: Comm<a name='1205'>
  integer               ,intent(IN)      :: IOComm<a name='1206'>
  character*(*)         ,intent(in)      :: SysDepInfo<a name='1207'>
  integer               ,intent(out)     :: DataHandle<a name='1208'>
  integer               ,intent(out)     :: Status<a name='1209'>
  type(wrf_data_handle) ,pointer         :: DH<a name='1210'>
  integer                                :: XType<a name='1211'>
  integer                                :: stat<a name='1212'>
  integer               ,allocatable     :: Buffer(:)<a name='1213'>
  integer                                :: VarID<a name='1214'>
  integer                                :: StoredDim<a name='1215'>
  integer                                :: NAtts<a name='1216'>
  integer                                :: DimIDs(2)<a name='1217'>
  integer                                :: VStart(2)<a name='1218'>
  integer                                :: VLen(2)<a name='1219'>
  integer                                :: TotalNumVars<a name='1220'>
  integer                                :: NumVars<a name='1221'>
  integer                                :: i<a name='1222'>
  character (NF_MAX_NAME)                :: Name<a name='1223'>
<a name='1224'>
#ifdef USE_NETCDF4_FEATURES<a name='1225'>
  integer                                :: open_mode<a name='1226'>
#endif<a name='1227'>
<a name='1228'>
  <font color=#447700>!call upgrade_filename(FileName)<a name='1229'></font>
<a name='1230'>
  if(WrfIOnotInitialized) then<a name='1231'>
    Status = WRF_IO_NOT_INITIALIZED <a name='1232'>
    write(msg,*) 'ext_ncd_ioinit was not called ',__FILE__,', line', __LINE__<a name='1233'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1383"> ( FATAL , msg)<a name='1234'>
    return<a name='1235'>
  endif<a name='1236'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE'>allocHandle</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ALLOCHANDLE_2">(DataHandle,DH,Comm,Status)<a name='1237'>
  if(Status /= WRF_NO_ERR) then<a name='1238'>
    write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__ <a name='1239'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1384"> ( WARN , TRIM(msg))<a name='1240'>
    return<a name='1241'>
  endif<a name='1242'>
  stat = NF_OPEN(FileName, NF_WRITE, DH%NCID)<a name='1243'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_14">(stat,Status)<a name='1244'>
  if(Status /= WRF_NO_ERR) then<a name='1245'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1246'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1385"> ( WARN , TRIM(msg))<a name='1247'>
    return<a name='1248'>
  endif<a name='1249'>
  stat = NF_INQ_VARID(DH%NCID,DH%TimesName,VarID)<a name='1250'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_15">(stat,Status)<a name='1251'>
  if(Status /= WRF_NO_ERR) then<a name='1252'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1253'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1386"> ( WARN , TRIM(msg))<a name='1254'>
    return<a name='1255'>
  endif<a name='1256'>
  stat = NF_INQ_VAR(DH%NCID,VarID,DH%TimesName, XType, StoredDim, DimIDs, NAtts)<a name='1257'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_16">(stat,Status)<a name='1258'>
  if(Status /= WRF_NO_ERR) then<a name='1259'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1260'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1387"> ( WARN , TRIM(msg))<a name='1261'>
    return<a name='1262'>
  endif<a name='1263'>
  if(XType/=NF_CHAR) then<a name='1264'>
    Status = WRF_WARN_TYPE_MISMATCH<a name='1265'>
    write(msg,*) 'Warning TYPE MISMATCH in ',__FILE__,', line', __LINE__<a name='1266'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1388"> ( WARN , TRIM(msg))<a name='1267'>
    return<a name='1268'>
  endif<a name='1269'>
  stat = NF_INQ_DIMLEN(DH%NCID,DimIDs(1),VLen(1))  <a name='1270'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_17">(stat,Status)<a name='1271'>
  if(Status /= WRF_NO_ERR) then<a name='1272'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1273'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1389"> ( WARN , TRIM(msg))<a name='1274'>
    return<a name='1275'>
  endif<a name='1276'>
  if(VLen(1) /= DateStrLen) then<a name='1277'>
    Status = WRF_WARN_DATESTR_BAD_LENGTH<a name='1278'>
    write(msg,*) 'Warning DATESTR BAD LENGTH in ',__FILE__,', line', __LINE__<a name='1279'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1390"> ( WARN , TRIM(msg))<a name='1280'>
    return<a name='1281'>
  endif<a name='1282'>
  stat = NF_INQ_DIMLEN(DH%NCID,DimIDs(2),VLen(2))<a name='1283'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_18">(stat,Status)<a name='1284'>
  if(Status /= WRF_NO_ERR) then<a name='1285'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1286'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1391"> ( WARN , TRIM(msg))<a name='1287'>
    return<a name='1288'>
  endif<a name='1289'>
  if(VLen(2) &gt; MaxTimes) then<a name='1290'>
    Status = WRF_ERR_FATAL_TOO_MANY_TIMES<a name='1291'>
    write(msg,*) 'Fatal TOO MANY TIME VALUES in ',__FILE__,', line', __LINE__<a name='1292'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1392"> ( FATAL , TRIM(msg))<a name='1293'>
    return<a name='1294'>
  endif<a name='1295'>
  VStart(1) = 1<a name='1296'>
  VStart(2) = 1<a name='1297'>
  stat = NF_GET_VARA_TEXT(DH%NCID,VarID,VStart,VLen,DH%Times)<a name='1298'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_19">(stat,Status)<a name='1299'>
  if(Status /= WRF_NO_ERR) then<a name='1300'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1301'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1393"> ( WARN , TRIM(msg))<a name='1302'>
    return<a name='1303'>
  endif<a name='1304'>
  stat = NF_INQ_NVARS(DH%NCID,TotalNumVars)<a name='1305'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_20">(stat,Status)<a name='1306'>
  if(Status /= WRF_NO_ERR) then<a name='1307'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1308'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1394"> ( WARN , TRIM(msg))<a name='1309'>
    return<a name='1310'>
  endif<a name='1311'>
  NumVars = 0<a name='1312'>
  do i=1,TotalNumVars<a name='1313'>
    stat = NF_INQ_VARNAME(DH%NCID,i,Name)<a name='1314'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_21">(stat,Status)<a name='1315'>
    if(Status /= WRF_NO_ERR) then<a name='1316'>
      write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1317'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_UPDATE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1395"> ( WARN , TRIM(msg))<a name='1318'>
      return<a name='1319'>
    elseif(Name(1:5) /= 'md___' .and. Name /= DH%TimesName) then<a name='1320'>
      NumVars              = NumVars+1<a name='1321'>
      DH%VarNames(NumVars) = Name<a name='1322'>
      DH%VarIDs(NumVars)   = i<a name='1323'>
    endif      <a name='1324'>
  enddo<a name='1325'>
  DH%NumVars         = NumVars<a name='1326'>
  DH%NumberTimes     = VLen(2)<a name='1327'>
  DH%FileStatus      = WRF_FILE_OPENED_FOR_UPDATE<a name='1328'>
  DH%FileName        = trim(FileName)<a name='1329'>
  DH%CurrentVariable = 0<a name='1330'>
  DH%CurrentTime     = 0<a name='1331'>
  DH%TimesVarID      = VarID<a name='1332'>
  DH%TimeIndex       = 0<a name='1333'>
  return<a name='1334'>
end subroutine ext_ncd_open_for_update<a name='1335'>
<a name='1336'>
<a name='1337'>
<A NAME='EXT_NCD_OPEN_FOR_WRITE_BEGIN'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1338'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_ncd_open_for_write_begin</font>(FileName,Comm,IOComm,SysDepInfo,DataHandle,Status) <A href='../../call_to/EXT_NCD_OPEN_FOR_WRITE_BEGIN.html' TARGET='index'>6</A>,<A href='../../call_from/EXT_NCD_OPEN_FOR_WRITE_BEGIN.html' TARGET='index'>14</A><a name='1339'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_27"><a name='1340'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_10"><a name='1341'>
  implicit none<a name='1342'>
  include 'wrf_status_codes.h'<a name='1343'>
  include 'netcdf.inc'<a name='1344'>
  character*(*)        ,intent(inout) :: FileName<a name='1345'>
  integer              ,intent(in)  :: Comm<a name='1346'>
  integer              ,intent(in)  :: IOComm<a name='1347'>
  character*(*)        ,intent(in)  :: SysDepInfo<a name='1348'>
  integer              ,intent(out) :: DataHandle<a name='1349'>
  integer              ,intent(out) :: Status<a name='1350'>
  type(wrf_data_handle),pointer     :: DH<a name='1351'>
  integer                           :: i<a name='1352'>
  integer                           :: stat<a name='1353'>
  character (7)                     :: Buffer<a name='1354'>
  integer                           :: VDimIDs(2)<a name='1355'>
<a name='1356'>
#ifdef USE_NETCDF4_FEATURES<a name='1357'>
  integer                           :: create_mode<a name='1358'>
  integer, parameter                :: cache_size = 32, &amp;<a name='1359'>
                                       cache_nelem = 37, &amp;<a name='1360'>
                                       cache_preemption = 100<a name='1361'>
#endif<a name='1362'>
<a name='1363'>
  <font color=#447700>!call upgrade_filename(FileName)<a name='1364'></font>
<a name='1365'>
  if(WrfIOnotInitialized) then<a name='1366'>
    Status = WRF_IO_NOT_INITIALIZED <a name='1367'>
    write(msg,*) 'ext_ncd_open_for_write_begin: ext_ncd_ioinit was not called ',__FILE__,', line', __LINE__<a name='1368'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1396"> ( FATAL , msg)<a name='1369'>
    return<a name='1370'>
  endif<a name='1371'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#ALLOCHANDLE'>allocHandle</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="ALLOCHANDLE_3">(DataHandle,DH,Comm,Status)<a name='1372'>
  if(Status /= WRF_NO_ERR) then<a name='1373'>
    write(msg,*) 'Fatal ALLOCATION ERROR in ext_ncd_open_for_write_begin ',__FILE__,', line', __LINE__<a name='1374'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1397"> ( FATAL , TRIM(msg))<a name='1375'>
    return<a name='1376'>
  endif<a name='1377'>
  DH%TimeIndex = 0<a name='1378'>
  DH%Times     = ZeroDate<a name='1379'>
#ifdef USE_NETCDF4_FEATURES<a name='1380'>
<font color=#447700>! create_mode = IOR(nf_netcdf4, nf_classic_model)<a name='1381'></font>
  if ( DH%use_netcdf_classic ) then<a name='1382'>
  write(msg,*) 'output will be in classic NetCDF format'<a name='1383'>
  call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1398"> ( WARN , TRIM(msg))<a name='1384'>
#ifdef WRFIO_NCD_NO_LARGE_FILE_SUPPORT<a name='1385'>
  stat = NF_CREATE(FileName, NF_CLOBBER, DH%NCID)<a name='1386'>
#else<a name='1387'>
  stat = NF_CREATE(FileName, IOR(NF_CLOBBER,NF_64BIT_OFFSET), DH%NCID)<a name='1388'>
#endif<a name='1389'>
  else<a name='1390'>
  create_mode = nf_netcdf4<a name='1391'>
  stat = NF_CREATE(FileName, create_mode, DH%NCID)<a name='1392'>
  stat = NF_SET_CHUNK_CACHE(cache_size, cache_nelem, cache_preemption)<a name='1393'>
  endif<a name='1394'>
#else<a name='1395'>
#ifdef WRFIO_NCD_NO_LARGE_FILE_SUPPORT<a name='1396'>
  stat = NF_CREATE(FileName, NF_CLOBBER, DH%NCID)<a name='1397'>
#else<a name='1398'>
  stat = NF_CREATE(FileName, IOR(NF_CLOBBER,NF_64BIT_OFFSET), DH%NCID)<a name='1399'>
#endif<a name='1400'>
#endif<a name='1401'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_22">(stat,Status)<a name='1402'>
  if(Status /= WRF_NO_ERR) then<a name='1403'>
    write(msg,*) 'NetCDF error in ext_ncd_open_for_write_begin ',__FILE__,', line', __LINE__<a name='1404'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1399"> ( WARN , TRIM(msg))<a name='1405'>
    return<a name='1406'>
  endif<a name='1407'>
  DH%FileStatus  = WRF_FILE_OPENED_NOT_COMMITTED<a name='1408'>
  DH%FileName    = trim(FileName)<a name='1409'>
  stat = NF_DEF_DIM(DH%NCID,DH%DimUnlimName,NF_UNLIMITED,DH%DimUnlimID)<a name='1410'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_23">(stat,Status)<a name='1411'>
  if(Status /= WRF_NO_ERR) then<a name='1412'>
    write(msg,*) 'NetCDF error in ext_ncd_open_for_write_begin ',__FILE__,', line', __LINE__<a name='1413'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1400"> ( WARN , TRIM(msg))<a name='1414'>
    return<a name='1415'>
  endif<a name='1416'>
  DH%VarNames  (1:MaxVars) = NO_NAME<a name='1417'>
  DH%MDVarNames(1:MaxVars) = NO_NAME<a name='1418'>
  do i=1,MaxDims<a name='1419'>
    write(Buffer,FMT="('DIM',i4.4)") i<a name='1420'>
    DH%DimNames  (i) = Buffer<a name='1421'>
    DH%DimLengths(i) = NO_DIM<a name='1422'>
  enddo<a name='1423'>
  DH%DimNames(1) = 'DateStrLen'<a name='1424'>
  stat = NF_DEF_DIM(DH%NCID,DH%DimNames(1),DateStrLen,DH%DimIDs(1))<a name='1425'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_24">(stat,Status)<a name='1426'>
  if(Status /= WRF_NO_ERR) then<a name='1427'>
    write(msg,*) 'NetCDF error in ext_ncd_open_for_write_begin ',__FILE__,', line', __LINE__<a name='1428'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1401"> ( WARN , TRIM(msg))<a name='1429'>
    return<a name='1430'>
  endif<a name='1431'>
  VDimIDs(1) = DH%DimIDs(1)<a name='1432'>
  VDimIDs(2) = DH%DimUnlimID<a name='1433'>
  stat = NF_DEF_VAR(DH%NCID,DH%TimesName,NF_CHAR,2,VDimIDs,DH%TimesVarID)<a name='1434'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_25">(stat,Status)<a name='1435'>
  if(Status /= WRF_NO_ERR) then<a name='1436'>
    write(msg,*) 'NetCDF error in ext_ncd_open_for_write_begin ',__FILE__,', line', __LINE__<a name='1437'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_BEGIN' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1402"> ( WARN , TRIM(msg))<a name='1438'>
    return<a name='1439'>
  endif<a name='1440'>
  DH%DimLengths(1) = DateStrLen<a name='1441'>
<a name='1442'>
  if (index(SysDepInfo,'REAL_OUTPUT_SIZE=4') /= 0) then<a name='1443'>
     DH%R4OnOutput = .true.<a name='1444'>
  end if<a name='1445'>
<font color=#447700>!toggle on nofill mode<a name='1446'></font>
  if (index(SysDepInfo,'NOFILL=.TRUE.') /= 0) then<a name='1447'>
     DH%nofill = .true.<a name='1448'>
  end if<a name='1449'>
<a name='1450'>
  return<a name='1451'>
end subroutine ext_ncd_open_for_write_begin<a name='1452'>
<a name='1453'>
<font color=#447700>!stub<a name='1454'></font>
<font color=#447700>!opens a file for writing or coupler datastream for sending messages.<a name='1455'></font>
<font color=#447700>!no training phase for this version of the open stmt.<a name='1456'></font>
<A NAME='EXT_NCD_OPEN_FOR_WRITE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1457'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_open_for_write</font> (DatasetName, Comm1, Comm2, &amp;,<A href='../../call_from/EXT_NCD_OPEN_FOR_WRITE.html' TARGET='index'>2</A><a name='1458'>
                                   SysDepInfo, DataHandle, Status)<a name='1459'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_28"><a name='1460'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_11"><a name='1461'>
  implicit none<a name='1462'>
  include 'wrf_status_codes.h'<a name='1463'>
  include 'netcdf.inc'<a name='1464'>
  character *(*), intent(in)  ::DatasetName<a name='1465'>
  integer       , intent(in)  ::Comm1, Comm2<a name='1466'>
  character *(*), intent(in)  ::SysDepInfo<a name='1467'>
  integer       , intent(out) :: DataHandle<a name='1468'>
  integer       , intent(out) :: Status<a name='1469'>
  Status=WRF_WARN_NOOP<a name='1470'>
  DataHandle = 0    <font color=#447700>! dummy setting to quiet warning message<a name='1471'></font>
  return<a name='1472'>
end subroutine ext_ncd_open_for_write<a name='1473'>
<a name='1474'>
<A NAME='EXT_NCD_OPEN_FOR_WRITE_COMMIT'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_COMMIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1475'>
<font color=#993300>SUBROUTINE </font><font color=#cc0000>ext_ncd_open_for_write_commit</font>(DataHandle, Status) <A href='../../call_to/EXT_NCD_OPEN_FOR_WRITE_COMMIT.html' TARGET='index'>5</A>,<A href='../../call_from/EXT_NCD_OPEN_FOR_WRITE_COMMIT.html' TARGET='index'>9</A><a name='1476'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_29"><a name='1477'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_12"><a name='1478'>
  implicit none<a name='1479'>
  include 'wrf_status_codes.h'<a name='1480'>
  include 'netcdf.inc'<a name='1481'>
  integer              ,intent(in)  :: DataHandle<a name='1482'>
  integer              ,intent(out) :: Status<a name='1483'>
  type(wrf_data_handle),pointer     :: DH<a name='1484'>
  integer                           :: i<a name='1485'>
  integer                           :: stat<a name='1486'>
  integer                           :: oldmode  <font color=#447700>! for nf_set_fill, not used<a name='1487'></font>
<a name='1488'>
  if(WrfIOnotInitialized) then<a name='1489'>
    Status = WRF_IO_NOT_INITIALIZED <a name='1490'>
    write(msg,*) 'ext_ncd_open_for_write_commit: ext_ncd_ioinit was not called ',__FILE__,', line', __LINE__<a name='1491'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1403"> ( FATAL , msg)<a name='1492'>
    return<a name='1493'>
  endif<a name='1494'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_3">(DataHandle,DH,Status)<a name='1495'>
  if(Status /= WRF_NO_ERR) then<a name='1496'>
    write(msg,*) 'Warning Status = ',Status,' in ext_ncd_open_for_write_commit ',__FILE__,', line', __LINE__<a name='1497'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1404"> ( WARN , TRIM(msg)) <a name='1498'>
    return<a name='1499'>
  endif<a name='1500'>
  if ( DH%nofill ) then<a name='1501'>
    Status = NF_SET_FILL(DH%NCID,NF_NOFILL, oldmode )<a name='1502'>
    if(Status /= WRF_NO_ERR) then<a name='1503'>
      write(msg,*) 'Warning Status = ',Status,' from NF_SET_FILL ',__FILE__,', line', __LINE__<a name='1504'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1405"> ( WARN , TRIM(msg)) <a name='1505'>
      return<a name='1506'>
    endif<a name='1507'>
    write(msg,*) 'Information: NOFILL being set for writing to ',TRIM(DH%FileName)<a name='1508'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1406"> ( WARN , TRIM(msg)) <a name='1509'>
  endif<a name='1510'>
  stat = NF_ENDDEF(DH%NCID)<a name='1511'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_26">(stat,Status)<a name='1512'>
  if(Status /= WRF_NO_ERR) then<a name='1513'>
    write(msg,*) 'NetCDF error in ext_ncd_open_for_write_commit ',__FILE__,', line', __LINE__<a name='1514'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_OPEN_FOR_WRITE_COMMIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1407"> ( WARN , TRIM(msg))<a name='1515'>
    return<a name='1516'>
  endif<a name='1517'>
  DH%FileStatus  = WRF_FILE_OPENED_FOR_WRITE<a name='1518'>
  DH%first_operation  = .TRUE.<a name='1519'>
  return<a name='1520'>
end subroutine ext_ncd_open_for_write_commit<a name='1521'>
<a name='1522'>
<A NAME='EXT_NCD_IOCLOSE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOCLOSE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1523'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_ioclose</font>(DataHandle, Status) <A href='../../call_to/EXT_NCD_IOCLOSE.html' TARGET='index'>6</A>,<A href='../../call_from/EXT_NCD_IOCLOSE.html' TARGET='index'>10</A><a name='1524'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_30"><a name='1525'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_13"><a name='1526'>
  implicit none<a name='1527'>
  include 'wrf_status_codes.h'<a name='1528'>
  include 'netcdf.inc'<a name='1529'>
  integer              ,intent(in)  :: DataHandle<a name='1530'>
  integer              ,intent(out) :: Status<a name='1531'>
  type(wrf_data_handle),pointer     :: DH<a name='1532'>
  integer                           :: stat<a name='1533'>
<a name='1534'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_4">(DataHandle,DH,Status)<a name='1535'>
  if(Status /= WRF_NO_ERR) then<a name='1536'>
    write(msg,*) 'Warning Status = ',Status,' in ext_ncd_ioclose ',__FILE__,', line', __LINE__<a name='1537'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1408"> ( WARN , TRIM(msg))<a name='1538'>
    return<a name='1539'>
  endif<a name='1540'>
  if(DH%FileStatus == WRF_FILE_NOT_OPENED) then<a name='1541'>
    Status = WRF_WARN_FILE_NOT_OPENED<a name='1542'>
    write(msg,*) 'Warning FILE NOT OPENED in ext_ncd_ioclose ',__FILE__,', line', __LINE__<a name='1543'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1409"> ( WARN , TRIM(msg))<a name='1544'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_NOT_COMMITTED) then<a name='1545'>
    Status = WRF_WARN_DRYRUN_CLOSE<a name='1546'>
    write(msg,*) 'Warning TRY TO CLOSE DRYRUN in ext_ncd_ioclose ',__FILE__,', line', __LINE__<a name='1547'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1410"> ( WARN , TRIM(msg))<a name='1548'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_WRITE) then<a name='1549'>
    continue    <a name='1550'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_READ) then<a name='1551'>
    continue<a name='1552'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_UPDATE) then<a name='1553'>
    continue<a name='1554'>
  else<a name='1555'>
    Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='1556'>
    write(msg,*) 'Fatal error BAD FILE STATUS in ext_ncd_ioclose ',__FILE__,', line', __LINE__<a name='1557'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1411"> ( FATAL , TRIM(msg))<a name='1558'>
    return<a name='1559'>
  endif<a name='1560'>
<a name='1561'>
  stat = NF_CLOSE(DH%NCID)<a name='1562'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_27">(stat,Status)<a name='1563'>
  if(Status /= WRF_NO_ERR) then<a name='1564'>
    write(msg,*) 'NetCDF error in ext_ncd_ioclose ',__FILE__,', line', __LINE__<a name='1565'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1412"> ( WARN , TRIM(msg))<a name='1566'>
    return<a name='1567'>
  endif<a name='1568'>
  CALL <A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE'>deallocHandle</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOCLOSE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEALLOCHANDLE_1">( DataHandle, Status )<a name='1569'>
  DH%Free=.true.<a name='1570'>
  return<a name='1571'>
end subroutine ext_ncd_ioclose<a name='1572'>
<a name='1573'>
<A NAME='EXT_NCD_IOSYNC'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOSYNC' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1574'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_iosync</font>( DataHandle, Status) <A href='../../call_to/EXT_NCD_IOSYNC.html' TARGET='index'>3</A>,<A href='../../call_from/EXT_NCD_IOSYNC.html' TARGET='index'>9</A><a name='1575'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOSYNC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_31"><a name='1576'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOSYNC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_14"><a name='1577'>
  implicit none<a name='1578'>
  include 'wrf_status_codes.h'<a name='1579'>
  include 'netcdf.inc'<a name='1580'>
  integer              ,intent(in)  :: DataHandle<a name='1581'>
  integer              ,intent(out) :: Status<a name='1582'>
  type(wrf_data_handle),pointer     :: DH<a name='1583'>
  integer                           :: stat<a name='1584'>
<a name='1585'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOSYNC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_5">(DataHandle,DH,Status)<a name='1586'>
  if(Status /= WRF_NO_ERR) then<a name='1587'>
    write(msg,*) 'Warning Status = ',Status,' in ext_ncd_iosync ',__FILE__,', line', __LINE__<a name='1588'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOSYNC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1413"> ( WARN , TRIM(msg))<a name='1589'>
    return<a name='1590'>
  endif<a name='1591'>
  if(DH%FileStatus == WRF_FILE_NOT_OPENED) then<a name='1592'>
    Status = WRF_WARN_FILE_NOT_OPENED<a name='1593'>
    write(msg,*) 'Warning FILE NOT OPENED in ext_ncd_iosync ',__FILE__,', line', __LINE__<a name='1594'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOSYNC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1414"> ( WARN , TRIM(msg))<a name='1595'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_NOT_COMMITTED) then<a name='1596'>
    Status = WRF_WARN_FILE_NOT_COMMITTED<a name='1597'>
    write(msg,*) 'Warning FILE NOT COMMITTED in ext_ncd_iosync ',__FILE__,', line', __LINE__<a name='1598'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOSYNC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1415"> ( WARN , TRIM(msg))<a name='1599'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_WRITE) then<a name='1600'>
    continue<a name='1601'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_READ) then<a name='1602'>
    continue<a name='1603'>
  else<a name='1604'>
    Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='1605'>
    write(msg,*) 'Fatal error BAD FILE STATUS in ext_ncd_iosync ',__FILE__,', line', __LINE__<a name='1606'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOSYNC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1416"> ( FATAL , TRIM(msg))<a name='1607'>
    return<a name='1608'>
  endif<a name='1609'>
  stat = NF_SYNC(DH%NCID)<a name='1610'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOSYNC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_28">(stat,Status)<a name='1611'>
  if(Status /= WRF_NO_ERR) then<a name='1612'>
    write(msg,*) 'NetCDF error in ext_ncd_iosync ',__FILE__,', line', __LINE__<a name='1613'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOSYNC' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1417"> ( WARN , TRIM(msg))<a name='1614'>
    return<a name='1615'>
  endif<a name='1616'>
  return<a name='1617'>
end subroutine ext_ncd_iosync<a name='1618'>
<a name='1619'>
<a name='1620'>
<a name='1621'>
<A NAME='EXT_NCD_REDEF'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_REDEF' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1622'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_redef</font>( DataHandle, Status),<A href='../../call_from/EXT_NCD_REDEF.html' TARGET='index'>10</A><a name='1623'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_REDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_32"><a name='1624'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_REDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_15"><a name='1625'>
  implicit none<a name='1626'>
  include 'wrf_status_codes.h'<a name='1627'>
  include 'netcdf.inc'<a name='1628'>
  integer              ,intent(in)  :: DataHandle<a name='1629'>
  integer              ,intent(out) :: Status<a name='1630'>
  type(wrf_data_handle),pointer     :: DH<a name='1631'>
  integer                           :: stat<a name='1632'>
<a name='1633'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_REDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_6">(DataHandle,DH,Status)<a name='1634'>
  if(Status /= WRF_NO_ERR) then<a name='1635'>
    write(msg,*) 'Warning Status = ',Status,' in ',__FILE__,', line', __LINE__<a name='1636'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_REDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1418"> ( WARN , TRIM(msg))<a name='1637'>
    return<a name='1638'>
  endif<a name='1639'>
  if(DH%FileStatus == WRF_FILE_NOT_OPENED) then<a name='1640'>
    Status = WRF_WARN_FILE_NOT_OPENED<a name='1641'>
    write(msg,*) 'Warning FILE NOT OPENED in ',__FILE__,', line', __LINE__<a name='1642'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_REDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1419"> ( WARN , TRIM(msg))<a name='1643'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_NOT_COMMITTED) then<a name='1644'>
    Status = WRF_WARN_FILE_NOT_COMMITTED<a name='1645'>
    write(msg,*) 'Warning FILE NOT COMMITTED in ',__FILE__,', line', __LINE__<a name='1646'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_REDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1420"> ( WARN , TRIM(msg))<a name='1647'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_WRITE) then<a name='1648'>
    continue<a name='1649'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_UPDATE) then<a name='1650'>
    continue<a name='1651'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_READ) then<a name='1652'>
    Status = WRF_WARN_FILE_OPEN_FOR_READ<a name='1653'>
    write(msg,*) 'Warning FILE OPEN FOR READ in ',__FILE__,', line', __LINE__<a name='1654'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_REDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1421"> ( WARN , TRIM(msg))<a name='1655'>
  else<a name='1656'>
    Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='1657'>
    write(msg,*) 'Fatal error BAD FILE STATUS in ',__FILE__,', line', __LINE__<a name='1658'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_REDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1422"> ( FATAL , TRIM(msg))<a name='1659'>
    return<a name='1660'>
  endif<a name='1661'>
  stat = NF_REDEF(DH%NCID)<a name='1662'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_REDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_29">(stat,Status)<a name='1663'>
  if(Status /= WRF_NO_ERR) then<a name='1664'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1665'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_REDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1423"> ( WARN , TRIM(msg))<a name='1666'>
    return<a name='1667'>
  endif<a name='1668'>
  DH%FileStatus  = WRF_FILE_OPENED_NOT_COMMITTED<a name='1669'>
  return<a name='1670'>
end subroutine ext_ncd_redef<a name='1671'>
<a name='1672'>
<A NAME='EXT_NCD_ENDDEF'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ENDDEF' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1673'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_enddef</font>( DataHandle, Status),<A href='../../call_from/EXT_NCD_ENDDEF.html' TARGET='index'>10</A><a name='1674'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ENDDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_33"><a name='1675'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ENDDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_16"><a name='1676'>
  implicit none<a name='1677'>
  include 'wrf_status_codes.h'<a name='1678'>
  include 'netcdf.inc'<a name='1679'>
  integer              ,intent(in)  :: DataHandle<a name='1680'>
  integer              ,intent(out) :: Status<a name='1681'>
  type(wrf_data_handle),pointer     :: DH<a name='1682'>
  integer                           :: stat<a name='1683'>
<a name='1684'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ENDDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_7">(DataHandle,DH,Status)<a name='1685'>
  if(Status /= WRF_NO_ERR) then<a name='1686'>
    write(msg,*) 'Warning Status = ',Status,' in ',__FILE__,', line', __LINE__<a name='1687'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ENDDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1424"> ( WARN , TRIM(msg))<a name='1688'>
    return<a name='1689'>
  endif<a name='1690'>
  if(DH%FileStatus == WRF_FILE_NOT_OPENED) then<a name='1691'>
    Status = WRF_WARN_FILE_NOT_OPENED<a name='1692'>
    write(msg,*) 'Warning FILE NOT OPENED in ',__FILE__,', line', __LINE__<a name='1693'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ENDDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1425"> ( WARN , TRIM(msg))<a name='1694'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_NOT_COMMITTED) then<a name='1695'>
    Status = WRF_WARN_FILE_NOT_COMMITTED<a name='1696'>
    write(msg,*) 'Warning FILE NOT COMMITTED in ',__FILE__,', line', __LINE__<a name='1697'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ENDDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1426"> ( WARN , TRIM(msg))<a name='1698'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_WRITE) then<a name='1699'>
    continue<a name='1700'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_READ) then<a name='1701'>
    Status = WRF_WARN_FILE_OPEN_FOR_READ<a name='1702'>
    write(msg,*) 'Warning FILE OPEN FOR READ in ',__FILE__,', line', __LINE__<a name='1703'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ENDDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1427"> ( WARN , TRIM(msg))<a name='1704'>
  else<a name='1705'>
    Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='1706'>
    write(msg,*) 'Fatal error BAD FILE STATUS in ',__FILE__,', line', __LINE__<a name='1707'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ENDDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1428"> ( FATAL , TRIM(msg))<a name='1708'>
    return<a name='1709'>
  endif<a name='1710'>
  stat = NF_ENDDEF(DH%NCID)<a name='1711'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ENDDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_30">(stat,Status)<a name='1712'>
  if(Status /= WRF_NO_ERR) then<a name='1713'>
    write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='1714'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ENDDEF' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1429"> ( WARN , TRIM(msg))<a name='1715'>
    return<a name='1716'>
  endif<a name='1717'>
  DH%FileStatus  = WRF_FILE_OPENED_FOR_WRITE<a name='1718'>
  return<a name='1719'>
end subroutine ext_ncd_enddef<a name='1720'>
<a name='1721'>
<A NAME='EXT_NCD_IOINIT'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOINIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1722'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_ioinit</font>(SysDepInfo, Status) <A href='../../call_to/EXT_NCD_IOINIT.html' TARGET='index'>7</A>,<A href='../../call_from/EXT_NCD_IOINIT.html' TARGET='index'>1</A><a name='1723'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOINIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_34"><a name='1724'>
  implicit none<a name='1725'>
  include 'wrf_status_codes.h'<a name='1726'>
  CHARACTER*(*), INTENT(IN) :: SysDepInfo<a name='1727'>
  INTEGER ,INTENT(INOUT)    :: Status<a name='1728'>
<a name='1729'>
  WrfIOnotInitialized                             = .false.<a name='1730'>
  WrfDataHandles(1:WrfDataHandleMax)%Free         = .true.<a name='1731'>
  WrfDataHandles(1:WrfDataHandleMax)%TimesName    = 'Times'<a name='1732'>
  WrfDataHandles(1:WrfDataHandleMax)%DimUnlimName = 'Time'<a name='1733'>
  WrfDataHandles(1:WrfDataHandleMax)%FileStatus   = WRF_FILE_NOT_OPENED<a name='1734'>
  if(trim(SysDepInfo) == "use_netcdf_classic" ) then<a name='1735'>
     WrfDataHandles(1:WrfDataHandleMax)%use_netcdf_classic = .true.<a name='1736'>
  else<a name='1737'>
     WrfDataHandles(1:WrfDataHandleMax)%use_netcdf_classic = .false.<a name='1738'>
  endif<a name='1739'>
  Status = WRF_NO_ERR<a name='1740'>
  return<a name='1741'>
end subroutine ext_ncd_ioinit<a name='1742'>
<a name='1743'>
<a name='1744'>
<A NAME='EXT_NCD_INQUIRY'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRY' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1745'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_inquiry</font> (Inquiry, Result, Status),<A href='../../call_from/EXT_NCD_INQUIRY.html' TARGET='index'>1</A><a name='1746'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRY' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_35"><a name='1747'>
  implicit none<a name='1748'>
  include 'wrf_status_codes.h'<a name='1749'>
  character *(*), INTENT(IN)    :: Inquiry<a name='1750'>
  character *(*), INTENT(OUT)   :: Result<a name='1751'>
  integer        ,INTENT(INOUT) :: Status<a name='1752'>
  SELECT CASE (Inquiry)<a name='1753'>
  CASE ("RANDOM_WRITE","RANDOM_READ","SEQUENTIAL_WRITE","SEQUENTIAL_READ")<a name='1754'>
        Result='ALLOW'<a name='1755'>
  CASE ("OPEN_READ","OPEN_COMMIT_WRITE")<a name='1756'>
        Result='REQUIRE'<a name='1757'>
  CASE ("OPEN_WRITE","OPEN_COMMIT_READ","PARALLEL_IO")<a name='1758'>
        Result='NO'<a name='1759'>
  CASE ("SELF_DESCRIBING","SUPPORT_METADATA","SUPPORT_3D_FIELDS")<a name='1760'>
        Result='YES'<a name='1761'>
  CASE ("MEDIUM")<a name='1762'>
        Result ='FILE'<a name='1763'>
  CASE DEFAULT<a name='1764'>
      Result = 'No Result for that inquiry<font color=#447700>!'<a name='1765'></font>
  END SELECT<a name='1766'>
  Status=WRF_NO_ERR<a name='1767'>
  return<a name='1768'>
end subroutine ext_ncd_inquiry<a name='1769'>
<a name='1770'>
<a name='1771'>
<a name='1772'>
<a name='1773'>
<A NAME='EXT_NCD_IOEXIT'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOEXIT' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1774'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_ioexit</font>(Status) <A href='../../call_to/EXT_NCD_IOEXIT.html' TARGET='index'>5</A>,<A href='../../call_from/EXT_NCD_IOEXIT.html' TARGET='index'>4</A><a name='1775'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOEXIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_36"><a name='1776'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOEXIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_17"><a name='1777'>
  implicit none<a name='1778'>
  include 'wrf_status_codes.h'<a name='1779'>
  include 'netcdf.inc'<a name='1780'>
  integer       , INTENT(INOUT)     ::Status<a name='1781'>
  integer                           :: error<a name='1782'>
  type(wrf_data_handle),pointer     :: DH<a name='1783'>
  integer                           :: i<a name='1784'>
  integer                           :: stat<a name='1785'>
  if(WrfIOnotInitialized) then<a name='1786'>
    Status = WRF_IO_NOT_INITIALIZED <a name='1787'>
    write(msg,*) 'ext_ncd_ioinit was not called ',__FILE__,', line', __LINE__<a name='1788'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOEXIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1430"> ( FATAL , msg)<a name='1789'>
    return<a name='1790'>
  endif<a name='1791'>
  do i=1,WrfDataHandleMax<a name='1792'>
    CALL <A href='../../html_code/io_netcdf/wrf_io.F90.html#DEALLOCHANDLE'>deallocHandle</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_IOEXIT' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DEALLOCHANDLE_2">( i , stat ) <a name='1793'>
  enddo<a name='1794'>
  return<a name='1795'>
end subroutine ext_ncd_ioexit<a name='1796'>
<a name='1797'>
<A NAME='EXT_NCD_GET_DOM_TI_REAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TI_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1798'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_dom_ti_real</font>(DataHandle,Element,Data,Count,OutCount,Status)<a name='1799'>
#define ROUTINE_TYPE 'REAL'<a name='1800'>
#define TYPE_DATA real,intent(out) :: Data(*)<a name='1801'>
#define TYPE_COUNT integer,intent(in) :: Count<a name='1802'>
#define TYPE_OUTCOUNT integer,intent(out) :: OutCOunt<a name='1803'>
#define TYPE_BUFFER  real,allocatable :: Buffer(:)<a name='1804'>
#define NF_TYPE NF_FLOAT<a name='1805'>
#define NF_ROUTINE NF_GET_ATT_REAL <a name='1806'>
#define COPY   Data(1:min(Len,Count)) = Buffer(1:min(Len,Count))<a name='1807'>
#include "<A href='../../html_code/include/ext_ncd_get_dom_ti.code.html'>ext_ncd_get_dom_ti.code</A>"<A NAME="ext_ncd_get_dom_ti.code_16"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1808'>
end subroutine ext_ncd_get_dom_ti_real<a name='1809'>
<a name='1810'>
<A NAME='EXT_NCD_GET_DOM_TI_INTEGER'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TI_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1811'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_dom_ti_integer</font>(DataHandle,Element,Data,Count,OutCount,Status) <A href='../../call_to/EXT_NCD_GET_DOM_TI_INTEGER.html' TARGET='index'>3</A><a name='1812'>
#undef ROUTINE_TYPE <a name='1813'>
#undef TYPE_DATA <a name='1814'>
#undef TYPE_BUFFER<a name='1815'>
#undef NF_TYPE<a name='1816'>
#undef NF_ROUTINE<a name='1817'>
#undef COPY<a name='1818'>
#define ROUTINE_TYPE 'INTEGER'<a name='1819'>
#define TYPE_DATA integer,intent(out) :: Data(*)<a name='1820'>
#define TYPE_BUFFER  integer,allocatable :: Buffer(:)<a name='1821'>
#define NF_TYPE NF_INT<a name='1822'>
#define NF_ROUTINE NF_GET_ATT_INT<a name='1823'>
#define COPY   Data(1:min(Len,Count)) = Buffer(1:min(Len,Count))<a name='1824'>
#include "<A href='../../html_code/include/ext_ncd_get_dom_ti.code.html'>ext_ncd_get_dom_ti.code</A>"<A NAME="ext_ncd_get_dom_ti.code_17"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1825'>
end subroutine ext_ncd_get_dom_ti_integer<a name='1826'>
<a name='1827'>
<A NAME='EXT_NCD_GET_DOM_TI_DOUBLE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TI_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1828'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_dom_ti_double</font>(DataHandle,Element,Data,Count,OutCount,Status)<a name='1829'>
#undef ROUTINE_TYPE <a name='1830'>
#undef TYPE_DATA <a name='1831'>
#undef TYPE_BUFFER<a name='1832'>
#undef NF_TYPE<a name='1833'>
#undef NF_ROUTINE<a name='1834'>
#undef COPY<a name='1835'>
#define ROUTINE_TYPE 'DOUBLE'<a name='1836'>
#define TYPE_DATA real*8,intent(out) :: Data(*)<a name='1837'>
#define TYPE_BUFFER  real*8,allocatable :: Buffer(:)<a name='1838'>
#define NF_TYPE NF_DOUBLE<a name='1839'>
#define NF_ROUTINE NF_GET_ATT_DOUBLE<a name='1840'>
#define COPY   Data(1:min(Len,Count)) = Buffer(1:min(Len,Count))<a name='1841'>
#include "<A href='../../html_code/include/ext_ncd_get_dom_ti.code.html'>ext_ncd_get_dom_ti.code</A>"<A NAME="ext_ncd_get_dom_ti.code_18"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1842'>
end subroutine ext_ncd_get_dom_ti_double<a name='1843'>
<a name='1844'>
<A NAME='EXT_NCD_GET_DOM_TI_LOGICAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TI_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1845'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_dom_ti_logical</font>(DataHandle,Element,Data,Count,OutCount,Status)<a name='1846'>
#undef ROUTINE_TYPE <a name='1847'>
#undef TYPE_DATA <a name='1848'>
#undef TYPE_BUFFER<a name='1849'>
#undef NF_TYPE<a name='1850'>
#undef NF_ROUTINE<a name='1851'>
#undef COPY<a name='1852'>
#define ROUTINE_TYPE 'LOGICAL'<a name='1853'>
#define TYPE_DATA logical,intent(out) :: Data(*)<a name='1854'>
#define TYPE_BUFFER  integer,allocatable :: Buffer(:)<a name='1855'>
#define NF_TYPE NF_INT<a name='1856'>
#define NF_ROUTINE NF_GET_ATT_INT<a name='1857'>
#define COPY   Data(1:min(Len,Count)) = Buffer(1:min(Len,Count))==1<a name='1858'>
#include "<A href='../../html_code/include/ext_ncd_get_dom_ti.code.html'>ext_ncd_get_dom_ti.code</A>"<A NAME="ext_ncd_get_dom_ti.code_19"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1859'>
end subroutine ext_ncd_get_dom_ti_logical<a name='1860'>
<a name='1861'>
<A NAME='EXT_NCD_GET_DOM_TI_CHAR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TI_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1862'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_dom_ti_char</font>(DataHandle,Element,Data,Status)<a name='1863'>
#undef ROUTINE_TYPE<a name='1864'>
#undef TYPE_DATA<a name='1865'>
#undef TYPE_COUNT<a name='1866'>
#undef TYPE_OUTCOUNT<a name='1867'>
#undef TYPE_BUFFER<a name='1868'>
#undef NF_TYPE<a name='1869'>
#define ROUTINE_TYPE 'CHAR'<a name='1870'>
#define TYPE_DATA character*(*),intent(out) :: Data<a name='1871'>
#define TYPE_COUNT<a name='1872'>
#define TYPE_OUTCOUNT<a name='1873'>
#define TYPE_BUFFER<a name='1874'>
#define NF_TYPE NF_CHAR<a name='1875'>
#define CHAR_TYPE<a name='1876'>
#include "<A href='../../html_code/include/ext_ncd_get_dom_ti.code.html'>ext_ncd_get_dom_ti.code</A>"<A NAME="ext_ncd_get_dom_ti.code_20"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1877'>
#undef CHAR_TYPE<a name='1878'>
end subroutine ext_ncd_get_dom_ti_char<a name='1879'>
<a name='1880'>
<A NAME='EXT_NCD_PUT_DOM_TI_REAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TI_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1881'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_dom_ti_real</font>(DataHandle,Element,Data,Count,Status) <A href='../../call_to/EXT_NCD_PUT_DOM_TI_REAL.html' TARGET='index'>4</A><a name='1882'>
#undef ROUTINE_TYPE <a name='1883'>
#undef TYPE_DATA <a name='1884'>
#undef TYPE_COUNT<a name='1885'>
#undef NF_ROUTINE<a name='1886'>
#undef ARGS<a name='1887'>
#undef LOG<a name='1888'>
#define ROUTINE_TYPE 'REAL'<a name='1889'>
#define TYPE_DATA  real   ,intent(in) :: Data(*)<a name='1890'>
#define TYPE_COUNT integer,intent(in) :: Count<a name='1891'>
#define NF_ROUTINE NF_PUT_ATT_REAL<a name='1892'>
#define ARGS NF_FLOAT,Count,Data<a name='1893'>
#include "<A href='../../html_code/include/ext_ncd_put_dom_ti.code.html'>ext_ncd_put_dom_ti.code</A>"<A NAME="ext_ncd_put_dom_ti.code_21"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1894'>
end subroutine ext_ncd_put_dom_ti_real<a name='1895'>
<a name='1896'>
<A NAME='EXT_NCD_PUT_DOM_TI_INTEGER'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TI_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1897'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_dom_ti_integer</font>(DataHandle,Element,Data,Count,Status) <A href='../../call_to/EXT_NCD_PUT_DOM_TI_INTEGER.html' TARGET='index'>4</A><a name='1898'>
#undef ROUTINE_TYPE <a name='1899'>
#undef TYPE_DATA<a name='1900'>
#undef TYPE_COUNT<a name='1901'>
#undef NF_ROUTINE<a name='1902'>
#undef ARGS<a name='1903'>
#undef LOG<a name='1904'>
#define ROUTINE_TYPE 'INTEGER'<a name='1905'>
#define TYPE_DATA  integer,intent(in) :: Data(*)<a name='1906'>
#define TYPE_COUNT integer,intent(in) :: Count<a name='1907'>
#define NF_ROUTINE NF_PUT_ATT_INT<a name='1908'>
#define ARGS NF_INT,Count,Data<a name='1909'>
#include "<A href='../../html_code/include/ext_ncd_put_dom_ti.code.html'>ext_ncd_put_dom_ti.code</A>"<A NAME="ext_ncd_put_dom_ti.code_22"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1910'>
end subroutine ext_ncd_put_dom_ti_integer<a name='1911'>
<a name='1912'>
<A NAME='EXT_NCD_PUT_DOM_TI_DOUBLE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TI_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1913'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_dom_ti_double</font>(DataHandle,Element,Data,Count,Status)<a name='1914'>
#undef ROUTINE_TYPE <a name='1915'>
#undef TYPE_DATA<a name='1916'>
#undef TYPE_COUNT<a name='1917'>
#undef NF_ROUTINE<a name='1918'>
#undef ARGS<a name='1919'>
#undef LOG<a name='1920'>
#define ROUTINE_TYPE 'DOUBLE'<a name='1921'>
#define TYPE_DATA  real*8 ,intent(in) :: Data(*)<a name='1922'>
#define TYPE_COUNT integer,intent(in) :: Count<a name='1923'>
#define NF_ROUTINE NF_PUT_ATT_DOUBLE<a name='1924'>
#define ARGS NF_DOUBLE,Count,Data<a name='1925'>
#include "<A href='../../html_code/include/ext_ncd_put_dom_ti.code.html'>ext_ncd_put_dom_ti.code</A>"<A NAME="ext_ncd_put_dom_ti.code_23"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1926'>
end subroutine ext_ncd_put_dom_ti_double<a name='1927'>
<a name='1928'>
<A NAME='EXT_NCD_PUT_DOM_TI_LOGICAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TI_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1929'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_dom_ti_logical</font>(DataHandle,Element,Data,Count,Status)<a name='1930'>
#undef ROUTINE_TYPE <a name='1931'>
#undef TYPE_DATA<a name='1932'>
#undef TYPE_COUNT<a name='1933'>
#undef NF_ROUTINE<a name='1934'>
#undef ARGS<a name='1935'>
#define ROUTINE_TYPE 'LOGICAL'<a name='1936'>
#define TYPE_DATA  logical,intent(in) :: Data(*)<a name='1937'>
#define TYPE_COUNT integer,intent(in) :: Count<a name='1938'>
#define NF_ROUTINE NF_PUT_ATT_INT<a name='1939'>
#define ARGS NF_INT,Count,Buffer<a name='1940'>
#define LOG<a name='1941'>
#include "<A href='../../html_code/include/ext_ncd_put_dom_ti.code.html'>ext_ncd_put_dom_ti.code</A>"<A NAME="ext_ncd_put_dom_ti.code_24"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1942'>
end subroutine ext_ncd_put_dom_ti_logical<a name='1943'>
<a name='1944'>
<A NAME='EXT_NCD_PUT_DOM_TI_CHAR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TI_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1945'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_dom_ti_char</font>(DataHandle,Element,Data,Status) <A href='../../call_to/EXT_NCD_PUT_DOM_TI_CHAR.html' TARGET='index'>4</A><a name='1946'>
#undef ROUTINE_TYPE <a name='1947'>
#undef TYPE_DATA<a name='1948'>
#undef TYPE_COUNT<a name='1949'>
#undef NF_ROUTINE<a name='1950'>
#undef ARGS<a name='1951'>
#undef LOG<a name='1952'>
#define ROUTINE_TYPE 'CHAR'<a name='1953'>
#define TYPE_DATA  character*(*),intent(in) :: Data<a name='1954'>
#define TYPE_COUNT integer,parameter :: Count=1<a name='1955'>
#define NF_ROUTINE NF_PUT_ATT_TEXT<a name='1956'>
#define ARGS len_trim(Data),Data<a name='1957'>
#include "<A href='../../html_code/include/ext_ncd_put_dom_ti.code.html'>ext_ncd_put_dom_ti.code</A>"<A NAME="ext_ncd_put_dom_ti.code_25"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1958'>
end subroutine ext_ncd_put_dom_ti_char<a name='1959'>
<a name='1960'>
<A NAME='EXT_NCD_PUT_VAR_TI_REAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TI_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1961'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_var_ti_real</font>(DataHandle,Element,Var,Data,Count,Status)<a name='1962'>
#undef ROUTINE_TYPE<a name='1963'>
#undef TYPE_DATA<a name='1964'>
#undef TYPE_COUNT<a name='1965'>
#undef NF_ROUTINE<a name='1966'>
#undef ARGS<a name='1967'>
#undef LOG<a name='1968'>
#define ROUTINE_TYPE 'REAL'<a name='1969'>
#define TYPE_DATA  real    ,intent(in) :: Data(*)<a name='1970'>
#define TYPE_COUNT integer ,intent(in) :: Count<a name='1971'>
#define NF_ROUTINE NF_PUT_ATT_REAL<a name='1972'>
#define ARGS NF_FLOAT,Count,Data<a name='1973'>
#include "<A href='../../html_code/include/ext_ncd_put_var_ti.code.html'>ext_ncd_put_var_ti.code</A>"<A NAME="ext_ncd_put_var_ti.code_26"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1974'>
end subroutine ext_ncd_put_var_ti_real<a name='1975'>
<a name='1976'>
<A NAME='EXT_NCD_PUT_VAR_TD_REAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1977'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_var_td_real</font>(DataHandle,Element,DateStr,Var,Data,Count,Status) <A href='../../call_to/EXT_NCD_PUT_VAR_TD_REAL.html' TARGET='index'>1</A><a name='1978'>
#undef ROUTINE_TYPE<a name='1979'>
#undef TYPE_DATA<a name='1980'>
#undef TYPE_COUNT<a name='1981'>
#undef NF_ROUTINE<a name='1982'>
#undef NF_TYPE<a name='1983'>
#undef LENGTH<a name='1984'>
#undef ARG<a name='1985'>
#undef LOG<a name='1986'>
#define ROUTINE_TYPE 'REAL'<a name='1987'>
#define TYPE_DATA  real    ,intent(in) :: Data(*)<a name='1988'>
#define TYPE_COUNT integer ,intent(in) :: Count<a name='1989'>
#define NF_ROUTINE NF_PUT_VARA_REAL<a name='1990'>
#define NF_TYPE NF_FLOAT<a name='1991'>
#define LENGTH Count<a name='1992'>
#define ARG <a name='1993'>
#include "<A href='../../html_code/include/ext_ncd_put_var_td.code.html'>ext_ncd_put_var_td.code</A>"<A NAME="ext_ncd_put_var_td.code_27"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1994'>
end subroutine ext_ncd_put_var_td_real<a name='1995'>
<a name='1996'>
<A NAME='EXT_NCD_PUT_VAR_TI_DOUBLE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TI_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1997'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_var_ti_double</font>(DataHandle,Element,Var,Data,Count,Status)<a name='1998'>
#undef ROUTINE_TYPE<a name='1999'>
#undef TYPE_DATA<a name='2000'>
#undef TYPE_COUNT<a name='2001'>
#undef NF_ROUTINE<a name='2002'>
#undef ARGS<a name='2003'>
#undef LOG<a name='2004'>
#define ROUTINE_TYPE 'DOUBLE'<a name='2005'>
#define TYPE_DATA  real*8 ,intent(in) :: Data(*)<a name='2006'>
#define TYPE_COUNT integer ,intent(in) :: Count<a name='2007'>
#define NF_ROUTINE NF_PUT_ATT_DOUBLE<a name='2008'>
#define ARGS NF_DOUBLE,Count,Data<a name='2009'>
#include "<A href='../../html_code/include/ext_ncd_put_var_ti.code.html'>ext_ncd_put_var_ti.code</A>"<A NAME="ext_ncd_put_var_ti.code_28"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2010'>
end subroutine ext_ncd_put_var_ti_double<a name='2011'>
<a name='2012'>
<A NAME='EXT_NCD_PUT_VAR_TD_DOUBLE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2013'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_var_td_double</font>(DataHandle,Element,DateStr,Var,Data,Count,Status) <A href='../../call_to/EXT_NCD_PUT_VAR_TD_DOUBLE.html' TARGET='index'>1</A><a name='2014'>
#undef ROUTINE_TYPE<a name='2015'>
#undef TYPE_DATA<a name='2016'>
#undef TYPE_COUNT<a name='2017'>
#undef NF_ROUTINE<a name='2018'>
#undef NF_TYPE<a name='2019'>
#undef LENGTH<a name='2020'>
#undef ARG<a name='2021'>
#undef LOG<a name='2022'>
#define ROUTINE_TYPE 'DOUBLE'<a name='2023'>
#define TYPE_DATA  real*8,intent(in) :: Data(*)<a name='2024'>
#define TYPE_COUNT integer ,intent(in) :: Count<a name='2025'>
#define NF_ROUTINE NF_PUT_VARA_DOUBLE<a name='2026'>
#define NF_TYPE NF_DOUBLE<a name='2027'>
#define LENGTH Count<a name='2028'>
#define ARG <a name='2029'>
#include "<A href='../../html_code/include/ext_ncd_put_var_td.code.html'>ext_ncd_put_var_td.code</A>"<A NAME="ext_ncd_put_var_td.code_29"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2030'>
end subroutine ext_ncd_put_var_td_double<a name='2031'>
<a name='2032'>
<A NAME='EXT_NCD_PUT_VAR_TI_INTEGER'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TI_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2033'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_var_ti_integer</font>(DataHandle,Element,Var,Data,Count,Status)<a name='2034'>
#undef ROUTINE_TYPE<a name='2035'>
#undef TYPE_DATA<a name='2036'>
#undef TYPE_COUNT<a name='2037'>
#undef NF_ROUTINE<a name='2038'>
#undef ARGS<a name='2039'>
#undef LOG<a name='2040'>
#define ROUTINE_TYPE 'INTEGER'<a name='2041'>
#define TYPE_DATA  integer ,intent(in) :: Data(*)<a name='2042'>
#define TYPE_COUNT integer ,intent(in) :: Count<a name='2043'>
#define NF_ROUTINE NF_PUT_ATT_INT<a name='2044'>
#define ARGS NF_INT,Count,Data <a name='2045'>
#include "<A href='../../html_code/include/ext_ncd_put_var_ti.code.html'>ext_ncd_put_var_ti.code</A>"<A NAME="ext_ncd_put_var_ti.code_30"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2046'>
end subroutine ext_ncd_put_var_ti_integer<a name='2047'>
<a name='2048'>
<A NAME='EXT_NCD_PUT_VAR_TD_INTEGER'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2049'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_var_td_integer</font>(DataHandle,Element,DateStr,Var,Data,Count,Status) <A href='../../call_to/EXT_NCD_PUT_VAR_TD_INTEGER.html' TARGET='index'>1</A><a name='2050'>
#undef ROUTINE_TYPE<a name='2051'>
#undef TYPE_DATA<a name='2052'>
#undef TYPE_COUNT<a name='2053'>
#undef NF_ROUTINE<a name='2054'>
#undef NF_TYPE<a name='2055'>
#undef LENGTH<a name='2056'>
#undef ARG<a name='2057'>
#undef LOG<a name='2058'>
#define ROUTINE_TYPE 'INTEGER'<a name='2059'>
#define TYPE_DATA  integer ,intent(in) :: Data(*)<a name='2060'>
#define TYPE_COUNT integer ,intent(in) :: Count<a name='2061'>
#define NF_ROUTINE NF_PUT_VARA_INT<a name='2062'>
#define NF_TYPE NF_INT<a name='2063'>
#define LENGTH Count<a name='2064'>
#define ARG <a name='2065'>
#include "<A href='../../html_code/include/ext_ncd_put_var_td.code.html'>ext_ncd_put_var_td.code</A>"<A NAME="ext_ncd_put_var_td.code_31"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2066'>
end subroutine ext_ncd_put_var_td_integer<a name='2067'>
<a name='2068'>
<A NAME='EXT_NCD_PUT_VAR_TI_LOGICAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TI_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2069'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_var_ti_logical</font>(DataHandle,Element,Var,Data,Count,Status)<a name='2070'>
#undef ROUTINE_TYPE<a name='2071'>
#undef TYPE_DATA<a name='2072'>
#undef TYPE_COUNT<a name='2073'>
#undef NF_ROUTINE<a name='2074'>
#undef ARGS <a name='2075'>
#define ROUTINE_TYPE 'LOGICAL'<a name='2076'>
#define TYPE_DATA  logical ,intent(in) :: Data(*)<a name='2077'>
#define TYPE_COUNT integer ,intent(in) :: Count<a name='2078'>
#define NF_ROUTINE NF_PUT_ATT_INT<a name='2079'>
#define LOG<a name='2080'>
#define ARGS NF_INT,Count,Buffer<a name='2081'>
#include "<A href='../../html_code/include/ext_ncd_put_var_ti.code.html'>ext_ncd_put_var_ti.code</A>"<A NAME="ext_ncd_put_var_ti.code_32"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2082'>
end subroutine ext_ncd_put_var_ti_logical<a name='2083'>
<a name='2084'>
<A NAME='EXT_NCD_PUT_VAR_TD_LOGICAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2085'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_var_td_logical</font>(DataHandle,Element,DateStr,Var,Data,Count,Status) <A href='../../call_to/EXT_NCD_PUT_VAR_TD_LOGICAL.html' TARGET='index'>1</A><a name='2086'>
#undef ROUTINE_TYPE<a name='2087'>
#undef TYPE_DATA<a name='2088'>
#undef TYPE_COUNT<a name='2089'>
#undef NF_ROUTINE<a name='2090'>
#undef NF_TYPE<a name='2091'>
#undef LENGTH<a name='2092'>
#undef ARG<a name='2093'>
#define ROUTINE_TYPE 'LOGICAL'<a name='2094'>
#define TYPE_DATA  logical ,intent(in) :: Data(*)<a name='2095'>
#define TYPE_COUNT integer ,intent(in) :: Count<a name='2096'>
#define NF_ROUTINE NF_PUT_VARA_INT<a name='2097'>
#define NF_TYPE NF_INT<a name='2098'>
#define LOG<a name='2099'>
#define LENGTH Count<a name='2100'>
#define ARG <a name='2101'>
#include "<A href='../../html_code/include/ext_ncd_put_var_td.code.html'>ext_ncd_put_var_td.code</A>"<A NAME="ext_ncd_put_var_td.code_33"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2102'>
end subroutine ext_ncd_put_var_td_logical<a name='2103'>
<a name='2104'>
<A NAME='EXT_NCD_PUT_VAR_TI_CHAR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TI_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2105'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_var_ti_char</font>(DataHandle,Element,Var,Data,Status) <A href='../../call_to/EXT_NCD_PUT_VAR_TI_CHAR.html' TARGET='index'>4</A><a name='2106'>
#undef ROUTINE_TYPE<a name='2107'>
#undef TYPE_DATA<a name='2108'>
#undef TYPE_COUNT<a name='2109'>
#undef NF_ROUTINE<a name='2110'>
#undef ARGS<a name='2111'>
#undef LOG<a name='2112'>
#define ROUTINE_TYPE 'CHAR'<a name='2113'>
#define TYPE_DATA  character*(*) ,intent(in) :: Data<a name='2114'>
#define TYPE_COUNT <a name='2115'>
#define NF_ROUTINE NF_PUT_ATT_TEXT<a name='2116'>
#define ARGS len_trim(Data),trim(Data)<a name='2117'>
#define CHAR_TYPE<a name='2118'>
#include "<A href='../../html_code/include/ext_ncd_put_var_ti.code.html'>ext_ncd_put_var_ti.code</A>"<A NAME="ext_ncd_put_var_ti.code_34"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2119'>
#undef CHAR_TYPE<a name='2120'>
end subroutine ext_ncd_put_var_ti_char<a name='2121'>
<a name='2122'>
<A NAME='EXT_NCD_PUT_VAR_TD_CHAR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2123'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_var_td_char</font>(DataHandle,Element,DateStr,Var,Data,Status) <A href='../../call_to/EXT_NCD_PUT_VAR_TD_CHAR.html' TARGET='index'>1</A><a name='2124'>
#undef ROUTINE_TYPE<a name='2125'>
#undef TYPE_DATA<a name='2126'>
#undef TYPE_COUNT<a name='2127'>
#undef NF_ROUTINE<a name='2128'>
#undef NF_TYPE<a name='2129'>
#undef LENGTH<a name='2130'>
#undef ARG<a name='2131'>
#undef LOG<a name='2132'>
#define ROUTINE_TYPE 'CHAR'<a name='2133'>
#define TYPE_DATA  character*(*) ,intent(in) :: Data<a name='2134'>
#define TYPE_COUNT <a name='2135'>
#define NF_ROUTINE NF_PUT_VARA_TEXT<a name='2136'>
#define NF_TYPE NF_CHAR<a name='2137'>
#define LENGTH len(Data)<a name='2138'>
#include "<A href='../../html_code/include/ext_ncd_put_var_td.code.html'>ext_ncd_put_var_td.code</A>"<A NAME="ext_ncd_put_var_td.code_35"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2139'>
end subroutine ext_ncd_put_var_td_char<a name='2140'>
<a name='2141'>
<A NAME='EXT_NCD_GET_VAR_TI_REAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TI_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2142'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_var_ti_real</font>(DataHandle,Element,Var,Data,Count,OutCount,Status)<a name='2143'>
#undef ROUTINE_TYPE<a name='2144'>
#undef TYPE_DATA<a name='2145'>
#undef TYPE_BUFFER<a name='2146'>
#undef TYPE_COUNT<a name='2147'>
#undef TYPE_OUTCOUNT<a name='2148'>
#undef NF_TYPE<a name='2149'>
#undef NF_ROUTINE<a name='2150'>
#undef COPY<a name='2151'>
#define ROUTINE_TYPE 'REAL'<a name='2152'>
#define TYPE_DATA     real   ,intent(out) :: Data(*)<a name='2153'>
#define TYPE_BUFFER   real   ,allocatable :: Buffer(:)<a name='2154'>
#define TYPE_COUNT    integer,intent(in)  :: Count<a name='2155'>
#define TYPE_OUTCOUNT integer,intent(out) :: OutCount<a name='2156'>
#define NF_TYPE NF_FLOAT<a name='2157'>
#define NF_ROUTINE NF_GET_ATT_REAL<a name='2158'>
#define COPY   Data(1:min(XLen,Count)) = Buffer(1:min(XLen,Count))<a name='2159'>
#include "<A href='../../html_code/include/ext_ncd_get_var_ti.code.html'>ext_ncd_get_var_ti.code</A>"<A NAME="ext_ncd_get_var_ti.code_36"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TI_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2160'>
end subroutine ext_ncd_get_var_ti_real<a name='2161'>
<a name='2162'>
<A NAME='EXT_NCD_GET_VAR_TD_REAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2163'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_var_td_real</font>(DataHandle,Element,DateStr,Var,Data,Count,OutCount,Status) <A href='../../call_to/EXT_NCD_GET_VAR_TD_REAL.html' TARGET='index'>1</A><a name='2164'>
#undef ROUTINE_TYPE<a name='2165'>
#undef TYPE_DATA<a name='2166'>
#undef TYPE_BUFFER<a name='2167'>
#undef TYPE_COUNT<a name='2168'>
#undef TYPE_OUTCOUNT<a name='2169'>
#undef NF_TYPE<a name='2170'>
#undef NF_ROUTINE<a name='2171'>
#undef LENGTH<a name='2172'>
#undef COPY<a name='2173'>
#define ROUTINE_TYPE 'REAL'<a name='2174'>
#define TYPE_DATA     real   ,intent(out) :: Data(*)<a name='2175'>
#define TYPE_BUFFER real<a name='2176'>
#define TYPE_COUNT    integer,intent(in)  :: Count<a name='2177'>
#define TYPE_OUTCOUNT integer,intent(out) :: OutCount<a name='2178'>
#define NF_TYPE NF_FLOAT<a name='2179'>
#define NF_ROUTINE NF_GET_VARA_REAL<a name='2180'>
#define LENGTH min(Count,Len1)<a name='2181'>
#define COPY   Data(1:min(Len1,Count)) = Buffer(1:min(Len1,Count))<a name='2182'>
#include "<A href='../../html_code/include/ext_ncd_get_var_td.code.html'>ext_ncd_get_var_td.code</A>"<A NAME="ext_ncd_get_var_td.code_37"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2183'>
end subroutine ext_ncd_get_var_td_real<a name='2184'>
<a name='2185'>
<A NAME='EXT_NCD_GET_VAR_TI_DOUBLE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TI_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2186'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_var_ti_double</font>(DataHandle,Element,Var,Data,Count,OutCount,Status)<a name='2187'>
#undef ROUTINE_TYPE<a name='2188'>
#undef TYPE_DATA<a name='2189'>
#undef TYPE_BUFFER<a name='2190'>
#undef TYPE_COUNT<a name='2191'>
#undef TYPE_OUTCOUNT<a name='2192'>
#undef NF_TYPE<a name='2193'>
#undef NF_ROUTINE<a name='2194'>
#undef COPY<a name='2195'>
#define ROUTINE_TYPE 'DOUBLE'<a name='2196'>
#define TYPE_DATA     real*8 ,intent(out) :: Data(*)<a name='2197'>
#define TYPE_BUFFER   real*8 ,allocatable :: Buffer(:)<a name='2198'>
#define TYPE_COUNT    integer,intent(in)  :: Count<a name='2199'>
#define TYPE_OUTCOUNT integer,intent(out) :: OutCount<a name='2200'>
#define NF_TYPE NF_DOUBLE<a name='2201'>
#define NF_ROUTINE NF_GET_ATT_DOUBLE<a name='2202'>
#define COPY   Data(1:min(XLen,Count)) = Buffer(1:min(XLen,Count))<a name='2203'>
#include "<A href='../../html_code/include/ext_ncd_get_var_ti.code.html'>ext_ncd_get_var_ti.code</A>"<A NAME="ext_ncd_get_var_ti.code_38"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TI_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2204'>
end subroutine ext_ncd_get_var_ti_double<a name='2205'>
<a name='2206'>
<A NAME='EXT_NCD_GET_VAR_TD_DOUBLE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2207'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_var_td_double</font>(DataHandle,Element,DateStr,Var,Data,Count,OutCount,Status) <A href='../../call_to/EXT_NCD_GET_VAR_TD_DOUBLE.html' TARGET='index'>1</A><a name='2208'>
#undef ROUTINE_TYPE<a name='2209'>
#undef TYPE_DATA<a name='2210'>
#undef TYPE_BUFFER<a name='2211'>
#undef TYPE_COUNT<a name='2212'>
#undef TYPE_OUTCOUNT<a name='2213'>
#undef NF_TYPE<a name='2214'>
#undef NF_ROUTINE<a name='2215'>
#undef LENGTH<a name='2216'>
#undef COPY<a name='2217'>
#define ROUTINE_TYPE 'DOUBLE'<a name='2218'>
#define TYPE_DATA     real*8 ,intent(out) :: Data(*)<a name='2219'>
#define TYPE_BUFFER real*8<a name='2220'>
#define TYPE_COUNT    integer,intent(in)  :: Count<a name='2221'>
#define TYPE_OUTCOUNT integer,intent(out) :: OutCount<a name='2222'>
#define NF_TYPE NF_DOUBLE<a name='2223'>
#define NF_ROUTINE NF_GET_VARA_DOUBLE<a name='2224'>
#define LENGTH min(Count,Len1)<a name='2225'>
#define COPY   Data(1:min(Len1,Count)) = Buffer(1:min(Len1,Count))<a name='2226'>
#include "<A href='../../html_code/include/ext_ncd_get_var_td.code.html'>ext_ncd_get_var_td.code</A>"<A NAME="ext_ncd_get_var_td.code_39"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2227'>
end subroutine ext_ncd_get_var_td_double<a name='2228'>
<a name='2229'>
<A NAME='EXT_NCD_GET_VAR_TI_INTEGER'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TI_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2230'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_var_ti_integer</font>(DataHandle,Element,Var,Data,Count,OutCount,Status)<a name='2231'>
#undef ROUTINE_TYPE<a name='2232'>
#undef TYPE_DATA<a name='2233'>
#undef TYPE_BUFFER<a name='2234'>
#undef TYPE_COUNT<a name='2235'>
#undef TYPE_OUTCOUNT<a name='2236'>
#undef NF_TYPE<a name='2237'>
#undef NF_ROUTINE<a name='2238'>
#undef COPY<a name='2239'>
#define ROUTINE_TYPE 'INTEGER'<a name='2240'>
#define TYPE_DATA     integer,intent(out) :: Data(*)<a name='2241'>
#define TYPE_BUFFER   integer,allocatable :: Buffer(:)<a name='2242'>
#define TYPE_COUNT    integer,intent(in)  :: Count<a name='2243'>
#define TYPE_OUTCOUNT integer,intent(out) :: OutCount<a name='2244'>
#define NF_TYPE NF_INT<a name='2245'>
#define NF_ROUTINE NF_GET_ATT_INT<a name='2246'>
#define COPY   Data(1:min(XLen,Count)) = Buffer(1:min(XLen,Count))<a name='2247'>
#include "<A href='../../html_code/include/ext_ncd_get_var_ti.code.html'>ext_ncd_get_var_ti.code</A>"<A NAME="ext_ncd_get_var_ti.code_40"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TI_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2248'>
end subroutine ext_ncd_get_var_ti_integer<a name='2249'>
<a name='2250'>
<A NAME='EXT_NCD_GET_VAR_TD_INTEGER'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2251'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_var_td_integer</font>(DataHandle,Element,DateStr,Var,Data,Count,OutCount,Status) <A href='../../call_to/EXT_NCD_GET_VAR_TD_INTEGER.html' TARGET='index'>1</A><a name='2252'>
#undef ROUTINE_TYPE<a name='2253'>
#undef TYPE_DATA<a name='2254'>
#undef TYPE_BUFFER<a name='2255'>
#undef TYPE_COUNT<a name='2256'>
#undef TYPE_OUTCOUNT<a name='2257'>
#undef NF_TYPE<a name='2258'>
#undef NF_ROUTINE<a name='2259'>
#undef LENGTH<a name='2260'>
#undef COPY<a name='2261'>
#define ROUTINE_TYPE 'INTEGER'<a name='2262'>
#define TYPE_DATA     integer,intent(out) :: Data(*)<a name='2263'>
#define TYPE_BUFFER integer<a name='2264'>
#define TYPE_COUNT    integer,intent(in)  :: Count<a name='2265'>
#define TYPE_OUTCOUNT integer,intent(out) :: OutCount<a name='2266'>
#define NF_TYPE NF_INT<a name='2267'>
#define NF_ROUTINE NF_GET_VARA_INT<a name='2268'>
#define LENGTH min(Count,Len1)<a name='2269'>
#define COPY   Data(1:min(Len1,Count)) = Buffer(1:min(Len1,Count))<a name='2270'>
#include "<A href='../../html_code/include/ext_ncd_get_var_td.code.html'>ext_ncd_get_var_td.code</A>"<A NAME="ext_ncd_get_var_td.code_41"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2271'>
end subroutine ext_ncd_get_var_td_integer<a name='2272'>
<a name='2273'>
<A NAME='EXT_NCD_GET_VAR_TI_LOGICAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TI_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2274'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_var_ti_logical</font>(DataHandle,Element,Var,Data,Count,OutCount,Status)<a name='2275'>
#undef ROUTINE_TYPE<a name='2276'>
#undef TYPE_DATA<a name='2277'>
#undef TYPE_BUFFER<a name='2278'>
#undef TYPE_COUNT<a name='2279'>
#undef TYPE_OUTCOUNT<a name='2280'>
#undef NF_TYPE<a name='2281'>
#undef NF_ROUTINE<a name='2282'>
#undef COPY<a name='2283'>
#define ROUTINE_TYPE 'LOGICAL'<a name='2284'>
#define TYPE_DATA     logical,intent(out) :: Data(*)<a name='2285'>
#define TYPE_BUFFER   integer,allocatable :: Buffer(:)<a name='2286'>
#define TYPE_COUNT    integer,intent(in)  :: Count<a name='2287'>
#define TYPE_OUTCOUNT integer,intent(out) :: OutCount<a name='2288'>
#define NF_TYPE NF_INT<a name='2289'>
#define NF_ROUTINE NF_GET_ATT_INT<a name='2290'>
#define COPY   Data(1:min(XLen,Count)) = Buffer(1:min(XLen,Count))==1<a name='2291'>
#include "<A href='../../html_code/include/ext_ncd_get_var_ti.code.html'>ext_ncd_get_var_ti.code</A>"<A NAME="ext_ncd_get_var_ti.code_42"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TI_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2292'>
end subroutine ext_ncd_get_var_ti_logical<a name='2293'>
<a name='2294'>
<A NAME='EXT_NCD_GET_VAR_TD_LOGICAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2295'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_var_td_logical</font>(DataHandle,Element,DateStr,Var,Data,Count,OutCount,Status) <A href='../../call_to/EXT_NCD_GET_VAR_TD_LOGICAL.html' TARGET='index'>1</A><a name='2296'>
#undef ROUTINE_TYPE<a name='2297'>
#undef TYPE_DATA<a name='2298'>
#undef TYPE_BUFFER<a name='2299'>
#undef TYPE_COUNT<a name='2300'>
#undef TYPE_OUTCOUNT<a name='2301'>
#undef NF_TYPE<a name='2302'>
#undef NF_ROUTINE<a name='2303'>
#undef LENGTH<a name='2304'>
#undef COPY<a name='2305'>
#define ROUTINE_TYPE 'LOGICAL'<a name='2306'>
#define TYPE_DATA     logical,intent(out) :: Data(*)<a name='2307'>
#define TYPE_BUFFER   integer<a name='2308'>
#define TYPE_COUNT    integer,intent(in)  :: Count<a name='2309'>
#define TYPE_OUTCOUNT integer,intent(out) :: OutCount<a name='2310'>
#define NF_TYPE NF_INT<a name='2311'>
#define NF_ROUTINE NF_GET_VARA_INT<a name='2312'>
#define LENGTH min(Count,Len1)<a name='2313'>
#define COPY   Data(1:min(Len1,Count)) = Buffer(1:min(Len1,Count))==1<a name='2314'>
#include "<A href='../../html_code/include/ext_ncd_get_var_td.code.html'>ext_ncd_get_var_td.code</A>"<A NAME="ext_ncd_get_var_td.code_43"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2315'>
end subroutine ext_ncd_get_var_td_logical<a name='2316'>
<a name='2317'>
<A NAME='EXT_NCD_GET_VAR_TI_CHAR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TI_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2318'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_var_ti_char</font>(DataHandle,Element,Var,Data,Status)<a name='2319'>
#undef ROUTINE_TYPE<a name='2320'>
#undef TYPE_DATA<a name='2321'>
#undef TYPE_BUFFER<a name='2322'>
#undef TYPE_COUNT<a name='2323'>
#undef TYPE_OUTCOUNT<a name='2324'>
#undef NF_TYPE<a name='2325'>
#undef NF_ROUTINE<a name='2326'>
#undef COPY<a name='2327'>
#define ROUTINE_TYPE 'CHAR'<a name='2328'>
#define TYPE_DATA   character*(*) ,intent(out) :: Data<a name='2329'>
#define TYPE_BUFFER<a name='2330'>
#define TYPE_COUNT integer :: Count = 1<a name='2331'>
#define TYPE_OUTCOUNT<a name='2332'>
#define NF_TYPE NF_CHAR<a name='2333'>
#define NF_ROUTINE NF_GET_ATT_TEXT<a name='2334'>
#define COPY <a name='2335'>
#define CHAR_TYPE<a name='2336'>
#include "<A href='../../html_code/include/ext_ncd_get_var_ti.code.html'>ext_ncd_get_var_ti.code</A>"<A NAME="ext_ncd_get_var_ti.code_44"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TI_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2337'>
#undef CHAR_TYPE<a name='2338'>
end subroutine ext_ncd_get_var_ti_char<a name='2339'>
<a name='2340'>
<A NAME='EXT_NCD_GET_VAR_TD_CHAR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2341'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_var_td_char</font>(DataHandle,Element,DateStr,Var,Data,Status) <A href='../../call_to/EXT_NCD_GET_VAR_TD_CHAR.html' TARGET='index'>1</A><a name='2342'>
#undef ROUTINE_TYPE<a name='2343'>
#undef TYPE_DATA<a name='2344'>
#undef TYPE_BUFFER<a name='2345'>
#undef TYPE_COUNT<a name='2346'>
#undef TYPE_OUTCOUNT<a name='2347'>
#undef NF_TYPE<a name='2348'>
#undef NF_ROUTINE<a name='2349'>
#undef LENGTH<a name='2350'>
#define ROUTINE_TYPE 'CHAR'<a name='2351'>
#define TYPE_DATA character*(*) ,intent(out)    :: Data<a name='2352'>
#define TYPE_BUFFER character (80)<a name='2353'>
#define TYPE_COUNT integer :: Count = 1<a name='2354'>
#define TYPE_OUTCOUNT<a name='2355'>
#define NF_TYPE NF_CHAR<a name='2356'>
#define NF_ROUTINE NF_GET_VARA_TEXT<a name='2357'>
#define LENGTH Len1<a name='2358'>
#define CHAR_TYPE<a name='2359'>
#include "<A href='../../html_code/include/ext_ncd_get_var_td.code.html'>ext_ncd_get_var_td.code</A>"<A NAME="ext_ncd_get_var_td.code_45"><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='2360'>
#undef CHAR_TYPE<a name='2361'>
end subroutine ext_ncd_get_var_td_char<a name='2362'>
<a name='2363'>
<A NAME='EXT_NCD_PUT_DOM_TD_REAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TD_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2364'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_dom_td_real</font>(DataHandle,Element,DateStr,Data,Count,Status) <A href='../../call_to/EXT_NCD_PUT_DOM_TD_REAL.html' TARGET='index'>4</A>,<A href='../../call_from/EXT_NCD_PUT_DOM_TD_REAL.html' TARGET='index'>1</A><a name='2365'>
  integer               ,intent(in)     :: DataHandle<a name='2366'>
  character*(*)         ,intent(in)     :: Element<a name='2367'>
  character*(*)         ,intent(in)     :: DateStr<a name='2368'>
  real                  ,intent(in)     :: Data(*)<a name='2369'>
  integer               ,intent(in)     :: Count<a name='2370'>
  integer               ,intent(out)    :: Status<a name='2371'>
<a name='2372'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_REAL'>ext_ncd_put_var_td_real</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_PUT_VAR_TD_REAL_1">(DataHandle,Element,DateStr, &amp;<a name='2373'>
       'E_X_T_D_O_M_A_I_N_M_E_T_A_DATA_' ,Data,Count,Status)<a name='2374'>
  return<a name='2375'>
end subroutine ext_ncd_put_dom_td_real<a name='2376'>
<a name='2377'>
<A NAME='EXT_NCD_PUT_DOM_TD_INTEGER'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TD_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2378'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_dom_td_integer</font>(DataHandle,Element,DateStr,Data,Count,Status) <A href='../../call_to/EXT_NCD_PUT_DOM_TD_INTEGER.html' TARGET='index'>4</A>,<A href='../../call_from/EXT_NCD_PUT_DOM_TD_INTEGER.html' TARGET='index'>1</A><a name='2379'>
  integer               ,intent(in)     :: DataHandle<a name='2380'>
  character*(*)         ,intent(in)     :: Element<a name='2381'>
  character*(*)         ,intent(in)     :: DateStr<a name='2382'>
  integer               ,intent(in)     :: Data(*)<a name='2383'>
  integer               ,intent(in)     :: Count<a name='2384'>
  integer               ,intent(out)    :: Status<a name='2385'>
<a name='2386'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_INTEGER'>ext_ncd_put_var_td_integer</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_PUT_VAR_TD_INTEGER_1">(DataHandle,Element,DateStr, &amp;<a name='2387'>
       'E_X_T_D_O_M_A_I_N_M_E_T_A_DATA_'    ,Data,Count,Status)<a name='2388'>
  return<a name='2389'>
end subroutine ext_ncd_put_dom_td_integer<a name='2390'>
<a name='2391'>
<A NAME='EXT_NCD_PUT_DOM_TD_DOUBLE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TD_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2392'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_dom_td_double</font>(DataHandle,Element,DateStr,Data,Count,Status),<A href='../../call_from/EXT_NCD_PUT_DOM_TD_DOUBLE.html' TARGET='index'>1</A><a name='2393'>
  integer               ,intent(in)     :: DataHandle<a name='2394'>
  character*(*)         ,intent(in)     :: Element<a name='2395'>
  character*(*)         ,intent(in)     :: DateStr<a name='2396'>
  real*8                ,intent(in)     :: Data(*)<a name='2397'>
  integer               ,intent(in)     :: Count<a name='2398'>
  integer               ,intent(out)    :: Status<a name='2399'>
<a name='2400'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_DOUBLE'>ext_ncd_put_var_td_double</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_PUT_VAR_TD_DOUBLE_1">(DataHandle,Element,DateStr, &amp;<a name='2401'>
       'E_X_T_D_O_M_A_I_N_M_E_T_A_DATA_'   ,Data,Count,Status)<a name='2402'>
  return<a name='2403'>
end subroutine ext_ncd_put_dom_td_double<a name='2404'>
<a name='2405'>
<A NAME='EXT_NCD_PUT_DOM_TD_LOGICAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TD_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2406'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_dom_td_logical</font>(DataHandle,Element,DateStr,Data,Count,Status),<A href='../../call_from/EXT_NCD_PUT_DOM_TD_LOGICAL.html' TARGET='index'>1</A><a name='2407'>
  integer               ,intent(in)     :: DataHandle<a name='2408'>
  character*(*)         ,intent(in)     :: Element<a name='2409'>
  character*(*)         ,intent(in)     :: DateStr<a name='2410'>
  logical               ,intent(in)     :: Data(*)<a name='2411'>
  integer               ,intent(in)     :: Count<a name='2412'>
  integer               ,intent(out)    :: Status<a name='2413'>
<a name='2414'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_LOGICAL'>ext_ncd_put_var_td_logical</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_PUT_VAR_TD_LOGICAL_1">(DataHandle,Element,DateStr, &amp;<a name='2415'>
       'E_X_T_D_O_M_A_I_N_M_E_T_A_DATA_'    ,Data,Count,Status)<a name='2416'>
  return<a name='2417'>
end subroutine ext_ncd_put_dom_td_logical<a name='2418'>
<a name='2419'>
<A NAME='EXT_NCD_PUT_DOM_TD_CHAR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TD_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2420'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_put_dom_td_char</font>(DataHandle,Element,DateStr,Data,Status),<A href='../../call_from/EXT_NCD_PUT_DOM_TD_CHAR.html' TARGET='index'>1</A><a name='2421'>
  integer               ,intent(in)     :: DataHandle<a name='2422'>
  character*(*)         ,intent(in)     :: Element<a name='2423'>
  character*(*)         ,intent(in)     :: DateStr<a name='2424'>
  character*(*)         ,intent(in)     :: Data<a name='2425'>
  integer               ,intent(out)    :: Status<a name='2426'>
<a name='2427'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_VAR_TD_CHAR'>ext_ncd_put_var_td_char</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_PUT_DOM_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_PUT_VAR_TD_CHAR_1">(DataHandle,Element,DateStr, &amp;<a name='2428'>
       'E_X_T_D_O_M_A_I_N_M_E_T_A_DATA_' ,Data,Status)<a name='2429'>
  return<a name='2430'>
end subroutine ext_ncd_put_dom_td_char<a name='2431'>
<a name='2432'>
<A NAME='EXT_NCD_GET_DOM_TD_REAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TD_REAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2433'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_dom_td_real</font>(DataHandle,Element,DateStr,Data,Count,OutCount,Status),<A href='../../call_from/EXT_NCD_GET_DOM_TD_REAL.html' TARGET='index'>1</A><a name='2434'>
  integer               ,intent(in)     :: DataHandle<a name='2435'>
  character*(*)         ,intent(in)     :: Element<a name='2436'>
  character*(*)         ,intent(in)     :: DateStr<a name='2437'>
  real                  ,intent(out)    :: Data(*)<a name='2438'>
  integer               ,intent(in)     :: Count<a name='2439'>
  integer               ,intent(out)    :: OutCount<a name='2440'>
  integer               ,intent(out)    :: Status<a name='2441'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_REAL'>ext_ncd_get_var_td_real</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TD_REAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_GET_VAR_TD_REAL_1">(DataHandle,Element,DateStr,          &amp;<a name='2442'>
       'E_X_T_D_O_M_A_I_N_M_E_T_A_DATA_' ,Data,Count,OutCount,Status)<a name='2443'>
  return<a name='2444'>
end subroutine ext_ncd_get_dom_td_real<a name='2445'>
<a name='2446'>
<A NAME='EXT_NCD_GET_DOM_TD_INTEGER'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TD_INTEGER' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2447'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_dom_td_integer</font>(DataHandle,Element,DateStr,Data,Count,OutCount,Status),<A href='../../call_from/EXT_NCD_GET_DOM_TD_INTEGER.html' TARGET='index'>1</A><a name='2448'>
  integer               ,intent(in)     :: DataHandle<a name='2449'>
  character*(*)         ,intent(in)     :: Element<a name='2450'>
  character*(*)         ,intent(in)     :: DateStr<a name='2451'>
  integer               ,intent(out)    :: Data(*)<a name='2452'>
  integer               ,intent(in)     :: Count<a name='2453'>
  integer               ,intent(out)    :: OutCount<a name='2454'>
  integer               ,intent(out)    :: Status<a name='2455'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_INTEGER'>ext_ncd_get_var_td_integer</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TD_INTEGER' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_GET_VAR_TD_INTEGER_1">(DataHandle,Element,DateStr,          &amp;<a name='2456'>
       'E_X_T_D_O_M_A_I_N_M_E_T_A_DATA_'    ,Data,Count,OutCount,Status)<a name='2457'>
  return<a name='2458'>
end subroutine ext_ncd_get_dom_td_integer<a name='2459'>
<a name='2460'>
<A NAME='EXT_NCD_GET_DOM_TD_DOUBLE'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TD_DOUBLE' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2461'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_dom_td_double</font>(DataHandle,Element,DateStr,Data,Count,OutCount,Status),<A href='../../call_from/EXT_NCD_GET_DOM_TD_DOUBLE.html' TARGET='index'>1</A><a name='2462'>
  integer               ,intent(in)     :: DataHandle<a name='2463'>
  character*(*)         ,intent(in)     :: Element<a name='2464'>
  character*(*)         ,intent(in)     :: DateStr<a name='2465'>
  real*8                ,intent(out)    :: Data(*)<a name='2466'>
  integer               ,intent(in)     :: Count<a name='2467'>
  integer               ,intent(out)    :: OutCount<a name='2468'>
  integer               ,intent(out)    :: Status<a name='2469'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_DOUBLE'>ext_ncd_get_var_td_double</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TD_DOUBLE' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_GET_VAR_TD_DOUBLE_1">(DataHandle,Element,DateStr,          &amp;<a name='2470'>
       'E_X_T_D_O_M_A_I_N_M_E_T_A_DATA_'   ,Data,Count,OutCount,Status)<a name='2471'>
  return<a name='2472'>
end subroutine ext_ncd_get_dom_td_double<a name='2473'>
<a name='2474'>
<A NAME='EXT_NCD_GET_DOM_TD_LOGICAL'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TD_LOGICAL' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2475'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_dom_td_logical</font>(DataHandle,Element,DateStr,Data,Count,OutCount,Status),<A href='../../call_from/EXT_NCD_GET_DOM_TD_LOGICAL.html' TARGET='index'>1</A><a name='2476'>
  integer               ,intent(in)     :: DataHandle<a name='2477'>
  character*(*)         ,intent(in)     :: Element<a name='2478'>
  character*(*)         ,intent(in)     :: DateStr<a name='2479'>
  logical               ,intent(out)    :: Data(*)<a name='2480'>
  integer               ,intent(in)     :: Count<a name='2481'>
  integer               ,intent(out)    :: OutCount<a name='2482'>
  integer               ,intent(out)    :: Status<a name='2483'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_LOGICAL'>ext_ncd_get_var_td_logical</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TD_LOGICAL' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_GET_VAR_TD_LOGICAL_1">(DataHandle,Element,DateStr,          &amp;<a name='2484'>
       'E_X_T_D_O_M_A_I_N_M_E_T_A_DATA_'    ,Data,Count,OutCount,Status)<a name='2485'>
  return<a name='2486'>
end subroutine ext_ncd_get_dom_td_logical<a name='2487'>
<a name='2488'>
<A NAME='EXT_NCD_GET_DOM_TD_CHAR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TD_CHAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2489'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_dom_td_char</font>(DataHandle,Element,DateStr,Data,Status),<A href='../../call_from/EXT_NCD_GET_DOM_TD_CHAR.html' TARGET='index'>1</A><a name='2490'>
  integer               ,intent(in)     :: DataHandle<a name='2491'>
  character*(*)         ,intent(in)     :: Element<a name='2492'>
  character*(*)         ,intent(in)     :: DateStr<a name='2493'>
  character*(*)         ,intent(out)    :: Data<a name='2494'>
  integer               ,intent(out)    :: Status<a name='2495'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_TD_CHAR'>ext_ncd_get_var_td_char</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_DOM_TD_CHAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_GET_VAR_TD_CHAR_1">(DataHandle,Element,DateStr,          &amp;<a name='2496'>
       'E_X_T_D_O_M_A_I_N_M_E_T_A_DATA_' ,Data,Status)<a name='2497'>
  return<a name='2498'>
end subroutine ext_ncd_get_dom_td_char<a name='2499'>
<a name='2500'>
<A NAME='EXT_NCD_WRITE_FIELD'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2501'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_write_field</font>(DataHandle,DateStr,Var,Field,FieldTypeIn,  &amp; <A href='../../call_to/EXT_NCD_WRITE_FIELD.html' TARGET='index'>6</A>,<A href='../../call_from/EXT_NCD_WRITE_FIELD.html' TARGET='index'>50</A><a name='2502'>
  Comm, IOComm, DomainDesc, MemoryOrdIn, Stagger,  DimNames,              &amp;<a name='2503'>
  DomainStart,DomainEnd,MemoryStart,MemoryEnd,PatchStart,PatchEnd,Status)<a name='2504'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_37"><a name='2505'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_18"><a name='2506'>
  implicit none<a name='2507'>
  include 'wrf_status_codes.h'<a name='2508'>
  include 'netcdf.inc'<a name='2509'>
  integer                       ,intent(in)    :: DataHandle<a name='2510'>
  character*(*)                 ,intent(in)    :: DateStr<a name='2511'>
  character*(*)                 ,intent(in)    :: Var<a name='2512'>
  integer                       ,intent(inout) :: Field(*)<a name='2513'>
  integer                       ,intent(in)    :: FieldTypeIn<a name='2514'>
  integer                       ,intent(inout) :: Comm<a name='2515'>
  integer                       ,intent(inout) :: IOComm<a name='2516'>
  integer                       ,intent(in)    :: DomainDesc<a name='2517'>
  character*(*)                 ,intent(in)    :: MemoryOrdIn<a name='2518'>
  character*(*)                 ,intent(in)    :: Stagger <font color=#447700>! Dummy for now<a name='2519'></font>
  character*(*) ,dimension(*)   ,intent(in)    :: DimNames<a name='2520'>
  integer       ,dimension(*)   ,intent(in)    :: DomainStart, DomainEnd<a name='2521'>
  integer       ,dimension(*)   ,intent(in)    :: MemoryStart, MemoryEnd<a name='2522'>
  integer       ,dimension(*)   ,intent(in)    :: PatchStart,  PatchEnd<a name='2523'>
  integer                       ,intent(out)   :: Status<a name='2524'>
  integer                                      :: FieldType<a name='2525'>
  character (3)                                :: MemoryOrder<a name='2526'>
  type(wrf_data_handle)         ,pointer       :: DH<a name='2527'>
  integer                                      :: NCID<a name='2528'>
  integer                                      :: NDim<a name='2529'>
  character (VarNameLen)                       :: VarName<a name='2530'>
  character (3)                                :: MemO<a name='2531'>
  character (3)                                :: UCMemO<a name='2532'>
  integer                                      :: VarID<a name='2533'>
  integer      ,dimension(NVarDims)            :: Length<a name='2534'>
  integer      ,dimension(NVarDims)            :: VDimIDs<a name='2535'>
  character(80),dimension(NVarDims)            :: RODimNames<a name='2536'>
  integer      ,dimension(NVarDims)            :: StoredStart<a name='2537'>
  integer      ,dimension(:,:,:,:),allocatable :: XField<a name='2538'>
  integer                                      :: stat<a name='2539'>
  integer                                      :: NVar<a name='2540'>
  integer                                      :: i,j<a name='2541'>
  integer                                      :: i1,i2,j1,j2,k1,k2<a name='2542'>
  integer                                      :: x1,x2,y1,y2,z1,z2<a name='2543'>
  integer                                      :: l1,l2,m1,m2,n1,n2<a name='2544'>
  integer                                      :: XType<a name='2545'>
  integer                                      :: di<a name='2546'>
  character (80)                               :: NullName<a name='2547'>
  logical                                      :: NotFound<a name='2548'>
<a name='2549'>
#ifdef USE_NETCDF4_FEATURES<a name='2550'>
  integer, parameter                           :: cache_size = 32000000<a name='2551'>
  integer,dimension(NVarDims)                  :: chunks<a name='2552'>
  logical                                      :: need_chunking<a name='2553'>
  integer                                      :: compression_level<a name='2554'>
  integer                                      :: block_size<a name='2555'>
#endif<a name='2556'>
<a name='2557'>
  MemoryOrder = trim(adjustl(MemoryOrdIn))<a name='2558'>
  NullName=char(0)<a name='2559'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDIM'>GetDim</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDIM_5">(MemoryOrder,NDim,Status)<a name='2560'>
  if(Status /= WRF_NO_ERR) then<a name='2561'>
    write(msg,*) 'Warning BAD MEMORY ORDER |',MemoryOrder,'| in ',__FILE__,', line', __LINE__<a name='2562'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1431"> ( WARN , TRIM(msg))<a name='2563'>
    return<a name='2564'>
  endif<a name='2565'>
<a name='2566'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#DATECHECK'>DateCheck</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DATECHECK_2">(DateStr,Status)<a name='2567'>
  if(Status /= WRF_NO_ERR) then<a name='2568'>
    write(msg,*) 'Warning DATE STRING ERROR |',DateStr,'| in ',__FILE__,', line', __LINE__ <a name='2569'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1432"> ( WARN , TRIM(msg))<a name='2570'>
    return<a name='2571'>
  endif<a name='2572'>
  VarName = Var<a name='2573'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_8">(DataHandle,DH,Status)<a name='2574'>
  if(Status /= WRF_NO_ERR) then<a name='2575'>
    write(msg,*) 'Warning Status = ',Status,' in ',__FILE__,', line', __LINE__<a name='2576'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1433"> ( WARN , TRIM(msg))<a name='2577'>
    return<a name='2578'>
  endif<a name='2579'>
  NCID = DH%NCID<a name='2580'>
<a name='2581'>
#ifdef USE_NETCDF4_FEATURES<a name='2582'>
if ( .not. DH%use_netcdf_classic ) then<a name='2583'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#SET_CHUNKING'>set_chunking</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="SET_CHUNKING_1">(MemoryOrder,need_chunking)<a name='2584'>
  compression_level = 2<a name='2585'>
else<a name='2586'>
  need_chunking = .false.<a name='2587'>
endif<a name='2588'>
#endif<a name='2589'>
<a name='2590'>
  if ( DH%R4OnOutput .and. FieldTypeIn == WRF_DOUBLE ) then<a name='2591'>
     FieldType = WRF_REAL<a name='2592'>
  else<a name='2593'>
     FieldType = FieldTypeIn<a name='2594'>
  end if<a name='2595'>
<a name='2596'>
  write(msg,*)'ext_ncd_write_field: called for ',TRIM(Var)<a name='2597'>
<a name='2598'>
<font color=#447700>!jm 010827  Length(1:NDim) = DomainEnd(1:NDim)-DomainStart(1:NDim)+1<a name='2599'></font>
<a name='2600'>
  Length(1:NDim) = PatchEnd(1:NDim)-PatchStart(1:NDim)+1<a name='2601'>
<a name='2602'>
  IF ( ZeroLengthHorzDim(MemoryOrder,Length,Status) ) THEN<a name='2603'>
     write(msg,*)'ext_ncd_write_field: zero length dimension in ',TRIM(Var),'. Ignoring'<a name='2604'>
     call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1434"> ( WARN , TRIM(msg))<a name='2605'>
     return<a name='2606'>
  ENDIF<a name='2607'>
<a name='2608'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXTORDER'>ExtOrder</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXTORDER_1">(MemoryOrder,Length,Status)<a name='2609'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXTORDERSTR'>ExtOrderStr</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXTORDERSTR_1">(MemoryOrder,DimNames,RODimNames,Status)<a name='2610'>
  if(DH%FileStatus == WRF_FILE_NOT_OPENED) then<a name='2611'>
    Status = WRF_WARN_FILE_NOT_OPENED<a name='2612'>
    write(msg,*) 'Warning FILE NOT OPENED in ',__FILE__,', line', __LINE__ <a name='2613'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1435"> ( WARN , TRIM(msg))<a name='2614'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_READ) then<a name='2615'>
    Status = WRF_WARN_WRITE_RONLY_FILE<a name='2616'>
    write(msg,*) 'Warning WRITE READ ONLY FILE in ',__FILE__,', line', __LINE__ <a name='2617'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1436"> ( WARN , TRIM(msg))<a name='2618'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_NOT_COMMITTED) then<a name='2619'>
    do NVar=1,MaxVars<a name='2620'>
      if(DH%VarNames(NVar) == VarName ) then<a name='2621'>
        Status = WRF_WARN_2DRYRUNS_1VARIABLE<a name='2622'>
        write(msg,*) 'Warning 2 DRYRUNS 1 VARIABLE in ',__FILE__,', line', __LINE__ <a name='2623'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1437"> ( WARN , TRIM(msg))<a name='2624'>
        return<a name='2625'>
      elseif(DH%VarNames(NVar) == NO_NAME) then<a name='2626'>
        DH%VarNames(NVar) = VarName<a name='2627'>
        DH%NumVars        = NVar<a name='2628'>
        exit<a name='2629'>
      elseif(NVar == MaxVars) then<a name='2630'>
        Status = WRF_WARN_TOO_MANY_VARIABLES<a name='2631'>
        write(msg,*) 'Warning TOO MANY VARIABLES in ',__FILE__,', line', __LINE__ <a name='2632'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1438"> ( WARN , TRIM(msg))<a name='2633'>
        return<a name='2634'>
      endif<a name='2635'>
    enddo<a name='2636'>
    do j = 1,NDim<a name='2637'>
      if(RODimNames(j) == NullName .or. RODimNames(j) == '') then<a name='2638'>
        do i=1,MaxDims<a name='2639'>
          if(DH%DimLengths(i) == Length(j)) then<a name='2640'>
            exit<a name='2641'>
          elseif(DH%DimLengths(i) == NO_DIM) then<a name='2642'>
            stat = NF_DEF_DIM(NCID,DH%DimNames(i),Length(j),DH%DimIDs(i))<a name='2643'>
            call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_31">(stat,Status)<a name='2644'>
            if(Status /= WRF_NO_ERR) then<a name='2645'>
              write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='2646'>
              call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1439"> ( WARN , TRIM(msg))<a name='2647'>
              return<a name='2648'>
            endif<a name='2649'>
            DH%DimLengths(i) = Length(j)<a name='2650'>
            exit<a name='2651'>
          elseif(i == MaxDims) then<a name='2652'>
            Status = WRF_WARN_TOO_MANY_DIMS<a name='2653'>
            write(msg,*) 'Warning TOO MANY DIMENSIONS in ',__FILE__,', line', __LINE__ <a name='2654'>
            call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1440"> ( WARN , TRIM(msg))<a name='2655'>
            return<a name='2656'>
          endif<a name='2657'>
        enddo<a name='2658'>
      else <font color=#447700>!look for input name and check if already defined<a name='2659'></font>
        NotFound = .true.<a name='2660'>
        do i=1,MaxDims<a name='2661'>
          if (DH%DimNames(i) == RODimNames(j)) then<a name='2662'>
            if (DH%DimLengths(i) == Length(j)) then<a name='2663'>
              NotFound = .false.<a name='2664'>
              exit<a name='2665'>
            else<a name='2666'>
              Status = WRF_WARN_DIMNAME_REDEFINED<a name='2667'>
              write(msg,*) 'Warning DIM ',i,', NAME ',TRIM(DH%DimNames(i)),' REDEFINED  by var ', &amp;<a name='2668'>
                           TRIM(Var),' ',DH%DimLengths(i),Length(j) ,' in ', __FILE__ ,' line', __LINE__ <a name='2669'>
              call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1441"> ( WARN , TRIM(msg))<a name='2670'>
              return<a name='2671'>
            endif<a name='2672'>
          endif<a name='2673'>
        enddo<a name='2674'>
        if (NotFound) then<a name='2675'>
          do i=1,MaxDims<a name='2676'>
            if (DH%DimLengths(i) == NO_DIM) then<a name='2677'>
              DH%DimNames(i) = RODimNames(j)<a name='2678'>
              stat = NF_DEF_DIM(NCID,DH%DimNames(i),Length(j),DH%DimIDs(i))<a name='2679'>
              call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_32">(stat,Status)<a name='2680'>
              if(Status /= WRF_NO_ERR) then<a name='2681'>
                write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__<a name='2682'>
                call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1442"> ( WARN , TRIM(msg))<a name='2683'>
                return<a name='2684'>
              endif<a name='2685'>
              DH%DimLengths(i) = Length(j)<a name='2686'>
              exit<a name='2687'>
            elseif(i == MaxDims) then<a name='2688'>
              Status = WRF_WARN_TOO_MANY_DIMS<a name='2689'>
              write(msg,*) 'Warning TOO MANY DIMENSIONS in ',__FILE__,', line', __LINE__ <a name='2690'>
              call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1443"> ( WARN , TRIM(msg))<a name='2691'>
              return<a name='2692'>
            endif<a name='2693'>
          enddo<a name='2694'>
        endif<a name='2695'>
      endif<a name='2696'>
      VDimIDs(j) = DH%DimIDs(i)<a name='2697'>
      DH%VarDimLens(j,NVar) = Length(j)<a name='2698'>
    enddo<a name='2699'>
    VDimIDs(NDim+1) = DH%DimUnlimID<a name='2700'>
<a name='2701'>
    <font color=#447700>! Do not use SELECT statement here as sometimes WRF_REAL=WRF_DOUBLE<a name='2702'></font>
    IF (FieldType == WRF_REAL) THEN<a name='2703'>
      XType = NF_FLOAT<a name='2704'>
    ELSE IF (FieldType == WRF_DOUBLE) THEN<a name='2705'>
      Xtype = NF_DOUBLE<a name='2706'>
    ELSE IF (FieldType == WRF_INTEGER) THEN<a name='2707'>
      XType = NF_INT<a name='2708'>
    ELSE IF (FieldType == WRF_LOGICAL) THEN<a name='2709'>
      XType = NF_INT<a name='2710'>
    ELSE<a name='2711'>
        Status = WRF_WARN_DATA_TYPE_NOT_FOUND<a name='2712'>
        write(msg,*) 'Warning DATA TYPE NOT FOUND in ',__FILE__,', line', __LINE__ <a name='2713'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1444"> ( WARN , TRIM(msg))<a name='2714'>
        return<a name='2715'>
    END IF<a name='2716'>
<a name='2717'>
    stat = NF_DEF_VAR(NCID,VarName,XType,NDim+1,VDimIDs,VarID)<a name='2718'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_33">(stat,Status)<a name='2719'>
    if(Status /= WRF_NO_ERR) then<a name='2720'>
      write(msg,*) 'ext_ncd_write_field: NetCDF error for ',TRIM(VarName),' in ',__FILE__,', line', __LINE__<a name='2721'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1445"> ( WARN , TRIM(msg))<a name='2722'>
      return<a name='2723'>
    endif<a name='2724'>
<a name='2725'>
#ifdef USE_NETCDF4_FEATURES<a name='2726'>
  if(need_chunking) then<a name='2727'>
     chunks(1:NDim) = Length(1:NDim)<a name='2728'>
     chunks(NDim+1) = 1<a name='2729'>
     chunks(1) = (Length(1) + 1)/2<a name='2730'>
     chunks(2) = (Length(2) + 1)/2<a name='2731'>
<a name='2732'>
     block_size = 1<a name='2733'>
     do i = 1, NDim<a name='2734'>
        block_size = block_size * chunks(i)<a name='2735'>
     end do<a name='2736'>
<a name='2737'>
     do while (block_size &gt; cache_size)<a name='2738'>
        chunks(1) = (chunks(1) + 1)/2<a name='2739'>
        chunks(2) = (chunks(2) + 1)/2<a name='2740'>
<a name='2741'>
        block_size = 1<a name='2742'>
        do i = 1, NDim<a name='2743'>
           block_size = block_size * chunks(i)<a name='2744'>
        end do<a name='2745'>
     end do<a name='2746'>
<a name='2747'>
<font color=#447700>!    write(unit=0, fmt='(2x, 3a,i6)')  'file: ', __FILE__, ', line: ', __LINE__<a name='2748'></font>
<font color=#447700>!    write(unit=0, fmt='(2x, 3a)') TRIM(VarName),':'<a name='2749'></font>
<font color=#447700>!    write(unit=0, fmt='(10x, 2(a,i6))') 'length 1 = ', Length(1), ', chunk 1 = ', chunks(1)<a name='2750'></font>
<font color=#447700>!    write(unit=0, fmt='(10x, 2(a,i6))') 'length 2 = ', Length(2), ', chunk 2 = ', chunks(2)<a name='2751'></font>
<font color=#447700>!    write(unit=0, fmt='(10x, 2(a,i6))') 'length NDim+1 = ', Length(NDim+1), ', chunk NDim+1 = ', chunks(NDim+1)<a name='2752'></font>
<font color=#447700>!    write(unit=0, fmt='(10x, a,i6)')    'compression_level = ', compression_level<a name='2753'></font>
<a name='2754'>
     stat = NF_DEF_VAR_CHUNKING(NCID, VarID, NF_CHUNKED, chunks(1:NDim+1))<a name='2755'>
     call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_34">(stat,Status)<a name='2756'>
     if(Status /= WRF_NO_ERR) then<a name='2757'>
       write(msg,*) 'ext_ncd_write_field: NetCDF def chunking error for ',TRIM(VarName),' in ',__FILE__,', line', __LINE__<a name='2758'>
       call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1446"> ( WARN , TRIM(msg))<a name='2759'>
       return<a name='2760'>
     endif<a name='2761'>
<a name='2762'>
      stat = NF_DEF_VAR_DEFLATE(NCID, VarID, 1, 1, compression_level)<a name='2763'>
      call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_35">(stat,Status)<a name='2764'>
      if(Status /= WRF_NO_ERR) then<a name='2765'>
         write(msg,*) 'ext_ncd_write_field: NetCDF def compression  error for ',TRIM(VarName),' in ',__FILE__,', line', __LINE__<a name='2766'>
         call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1447"> ( WARN , TRIM(msg))<a name='2767'>
         return<a name='2768'>
      endif<a name='2769'>
  endif<a name='2770'>
#endif<a name='2771'>
<a name='2772'>
    DH%VarIDs(NVar) = VarID<a name='2773'>
    stat = NF_PUT_ATT_INT(NCID,VarID,'FieldType',NF_INT,1,FieldType)<a name='2774'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_36">(stat,Status)<a name='2775'>
    if(Status /= WRF_NO_ERR) then<a name='2776'>
      write(msg,*) 'ext_ncd_write_field: NetCDF error in ',__FILE__,', line', __LINE__ <a name='2777'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1448"> ( WARN , TRIM(msg))<a name='2778'>
      return<a name='2779'>
    endif<a name='2780'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#REORDER'>reorder</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="REORDER_1">(MemoryOrder,MemO)<a name='2781'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#UPPERCASE'>uppercase</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="UPPERCASE_1">(MemO,UCMemO)<a name='2782'>
    stat = NF_PUT_ATT_TEXT(NCID,VarID,'MemoryOrder',3,UCMemO)<a name='2783'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_37">(stat,Status)<a name='2784'>
    if(Status /= WRF_NO_ERR) then<a name='2785'>
      write(msg,*) 'ext_ncd_write_field: NetCDF error in ',__FILE__,', line', __LINE__ <a name='2786'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1449"> ( WARN , TRIM(msg))<a name='2787'>
      return<a name='2788'>
    endif<a name='2789'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_WRITE .OR. DH%FileStatus == WRF_FILE_OPENED_FOR_UPDATE) then<a name='2790'>
    do NVar=1,DH%NumVars<a name='2791'>
      if(DH%VarNames(NVar) == VarName) then<a name='2792'>
        exit<a name='2793'>
      elseif(NVar == DH%NumVars) then<a name='2794'>
        Status = WRF_WARN_VAR_NF<a name='2795'>
        write(msg,*) 'Warning VARIABLE NOT FOUND in ',__FILE__,', line', __LINE__ <a name='2796'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1450"> ( WARN , TRIM(msg))<a name='2797'>
        return<a name='2798'>
      endif<a name='2799'>
    enddo<a name='2800'>
    VarID = DH%VarIDs(NVar)<a name='2801'>
    do j=1,NDim<a name='2802'>
      if(Length(j) /= DH%VarDimLens(j,NVar) .AND. DH%FileStatus /= WRF_FILE_OPENED_FOR_UPDATE ) then<a name='2803'>
        Status = WRF_WARN_WRTLEN_NE_DRRUNLEN<a name='2804'>
        write(msg,*) 'Warning LENGTH <font color=#447700>!= DRY RUN LENGTH for |',   &amp;<a name='2805'></font>
                     VarName,'| dim ',j,' in ',__FILE__,', line', __LINE__ <a name='2806'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1451"> ( WARN , TRIM(msg))<a name='2807'>
        write(msg,*) '   LENGTH ',Length(j),' DRY RUN LENGTH ',DH%VarDimLens(j,NVar)<a name='2808'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1452"> ( WARN , TRIM(msg))<a name='2809'>
        return<a name='2810'>
<font color=#447700>!jm 010825      elseif(DomainStart(j) &lt; MemoryStart(j)) then<a name='2811'></font>
      elseif(PatchStart(j) &lt; MemoryStart(j)) then<a name='2812'>
        Status = WRF_WARN_DIMENSION_ERROR<a name='2813'>
        write(msg,*) 'Warning DIMENSION ERROR for |',VarName,    &amp;<a name='2814'>
                     '| in ',__FILE__,', line', __LINE__ <a name='2815'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1453"> ( WARN , TRIM(msg))<a name='2816'>
        return<a name='2817'>
      endif<a name='2818'>
    enddo<a name='2819'>
    StoredStart = 1<a name='2820'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETINDICES'>GetIndices</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETINDICES_1">(NDim,MemoryStart,MemoryEnd,l1,l2,m1,m2,n1,n2)<a name='2821'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETINDICES'>GetIndices</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETINDICES_2">(NDim,StoredStart,Length   ,x1,x2,y1,y2,z1,z2)<a name='2822'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETINDICES'>GetIndices</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETINDICES_3">(NDim,PatchStart, PatchEnd ,i1,i2,j1,j2,k1,k2)<a name='2823'>
    di=1<a name='2824'>
    if(FieldType == WRF_DOUBLE) di=2<a name='2825'>
    allocate(XField(di,x1:x2,y1:y2,z1:z2), STAT=stat)<a name='2826'>
    if(stat/= 0) then<a name='2827'>
      Status = WRF_ERR_FATAL_ALLOCATION_ERROR<a name='2828'>
      write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='2829'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1454"> ( FATAL , TRIM(msg))<a name='2830'>
      return<a name='2831'>
    endif<a name='2832'>
    if (DH%R4OnOutput .and. FieldTypeIn == WRF_DOUBLE) then<a name='2833'>
       call <A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSETOR4'>TransposeToR4</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRANSPOSETOR4_1">('write',MemoryOrder,di, Field,l1,l2,m1,m2,n1,n2 &amp;<a name='2834'>
                                                ,XField,x1,x2,y1,y2,z1,z2 &amp;<a name='2835'>
                                                   ,i1,i2,j1,j2,k1,k2 )<a name='2836'>
    else<a name='2837'>
       call <A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSE'>Transpose</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRANSPOSE_1">('write',MemoryOrder,di, Field,l1,l2,m1,m2,n1,n2 &amp;<a name='2838'>
                                            ,XField,x1,x2,y1,y2,z1,z2 &amp;<a name='2839'>
                                                   ,i1,i2,j1,j2,k1,k2 )<a name='2840'>
    end if<a name='2841'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO'>FieldIO</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FIELDIO_1">('write',DataHandle,DateStr,Length,MemoryOrder, &amp;<a name='2842'>
                  FieldType,NCID,VarID,XField,Status)<a name='2843'>
    if(Status /= WRF_NO_ERR) then<a name='2844'>
      write(msg,*) 'Warning Status = ',Status,' in ',__FILE__,', line', __LINE__ <a name='2845'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1455"> ( WARN , TRIM(msg))<a name='2846'>
      return<a name='2847'>
    endif<a name='2848'>
    deallocate(XField, STAT=stat)<a name='2849'>
    if(stat/= 0) then<a name='2850'>
      Status = WRF_ERR_FATAL_DEALLOCATION_ERR<a name='2851'>
      write(msg,*) 'Fatal DEALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='2852'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1456"> ( FATAL , TRIM(msg))<a name='2853'>
      return<a name='2854'>
    endif<a name='2855'>
  else<a name='2856'>
    Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='2857'>
    write(msg,*) 'Fatal error BAD FILE STATUS in ',__FILE__,', line', __LINE__ <a name='2858'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WRITE_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1457"> ( FATAL , TRIM(msg))<a name='2859'>
  endif<a name='2860'>
  DH%first_operation  = .FALSE.<a name='2861'>
  return<a name='2862'>
end subroutine ext_ncd_write_field<a name='2863'>
<a name='2864'>
<A NAME='EXT_NCD_READ_FIELD'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='2865'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_read_field</font>(DataHandle,DateStr,Var,Field,FieldType,Comm,  &amp; <A href='../../call_to/EXT_NCD_READ_FIELD.html' TARGET='index'>8</A>,<A href='../../call_from/EXT_NCD_READ_FIELD.html' TARGET='index'>38</A><a name='2866'>
  IOComm, DomainDesc, MemoryOrdIn, Stagger, DimNames,                       &amp;<a name='2867'>
  DomainStart,DomainEnd,MemoryStart,MemoryEnd,PatchStart,PatchEnd,Status)<a name='2868'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_38"><a name='2869'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_19"><a name='2870'>
  implicit none<a name='2871'>
  include 'wrf_status_codes.h'<a name='2872'>
  include 'netcdf.inc'<a name='2873'>
  integer                       ,intent(in)    :: DataHandle<a name='2874'>
  character*(*)                 ,intent(in)    :: DateStr<a name='2875'>
  character*(*)                 ,intent(in)    :: Var<a name='2876'>
  integer                       ,intent(out)   :: Field(*)<a name='2877'>
  integer                       ,intent(in)    :: FieldType<a name='2878'>
  integer                       ,intent(inout) :: Comm<a name='2879'>
  integer                       ,intent(inout) :: IOComm<a name='2880'>
  integer                       ,intent(in)    :: DomainDesc<a name='2881'>
  character*(*)                 ,intent(in)    :: MemoryOrdIn<a name='2882'>
  character*(*)                 ,intent(in)    :: Stagger <font color=#447700>! Dummy for now<a name='2883'></font>
  character*(*) , dimension (*) ,intent(in)    :: DimNames<a name='2884'>
  integer ,dimension(*)         ,intent(in)    :: DomainStart, DomainEnd<a name='2885'>
  integer ,dimension(*)         ,intent(in)    :: MemoryStart, MemoryEnd<a name='2886'>
  integer ,dimension(*)         ,intent(in)    :: PatchStart,  PatchEnd<a name='2887'>
  integer                       ,intent(out)   :: Status<a name='2888'>
  character (3)                                :: MemoryOrder<a name='2889'>
  character (NF_MAX_NAME)                      :: dimname<a name='2890'>
  type(wrf_data_handle)         ,pointer       :: DH<a name='2891'>
  integer                                      :: NDim<a name='2892'>
  integer                                      :: NCID<a name='2893'>
  character (VarNameLen)                       :: VarName<a name='2894'>
  integer                                      :: VarID<a name='2895'>
  integer ,dimension(NVarDims)                 :: VCount<a name='2896'>
  integer ,dimension(NVarDims)                 :: VStart<a name='2897'>
  integer ,dimension(NVarDims)                 :: Length<a name='2898'>
  integer ,dimension(NVarDims)                 :: VDimIDs<a name='2899'>
  integer ,dimension(NVarDims)                 :: MemS<a name='2900'>
  integer ,dimension(NVarDims)                 :: MemE<a name='2901'>
  integer ,dimension(NVarDims)                 :: StoredStart<a name='2902'>
  integer ,dimension(NVarDims)                 :: StoredLen<a name='2903'>
  integer ,dimension(:,:,:,:)   ,allocatable   :: XField<a name='2904'>
  integer                                      :: NVar<a name='2905'>
  integer                                      :: j<a name='2906'>
  integer                                      :: i1,i2,j1,j2,k1,k2<a name='2907'>
  integer                                      :: x1,x2,y1,y2,z1,z2<a name='2908'>
  integer                                      :: l1,l2,m1,m2,n1,n2<a name='2909'>
  character (VarNameLen)                       :: Name<a name='2910'>
  integer                                      :: XType<a name='2911'>
  integer                                      :: StoredDim<a name='2912'>
  integer                                      :: NAtts<a name='2913'>
  integer                                      :: Len<a name='2914'>
  integer                                      :: stat<a name='2915'>
  integer                                      :: di<a name='2916'>
  integer                                      :: FType<a name='2917'>
<a name='2918'>
  MemoryOrder = trim(adjustl(MemoryOrdIn))<a name='2919'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDIM'>GetDim</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDIM_6">(MemoryOrder,NDim,Status)<a name='2920'>
  if(Status /= WRF_NO_ERR) then<a name='2921'>
    write(msg,*) 'Warning BAD MEMORY ORDER |',TRIM(MemoryOrder),'| for |', &amp;<a name='2922'>
                 TRIM(Var),'| in ext_ncd_read_field ',__FILE__,', line', __LINE__<a name='2923'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1458"> ( WARN , TRIM(msg))<a name='2924'>
    return<a name='2925'>
  endif<a name='2926'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#DATECHECK'>DateCheck</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DATECHECK_3">(DateStr,Status)<a name='2927'>
  if(Status /= WRF_NO_ERR) then<a name='2928'>
    write(msg,*) 'Warning DATE STRING ERROR |',TRIM(DateStr),'| for |',TRIM(Var), &amp;<a name='2929'>
                 '| in ext_ncd_read_field ',__FILE__,', line', __LINE__ <a name='2930'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1459"> ( WARN , TRIM(msg))<a name='2931'>
    return<a name='2932'>
  endif<a name='2933'>
  VarName = Var<a name='2934'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_9">(DataHandle,DH,Status)<a name='2935'>
  if(Status /= WRF_NO_ERR) then<a name='2936'>
    write(msg,*) 'Warning Status = ',Status,' in ext_ncd_read_field ',__FILE__,', line', __LINE__<a name='2937'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1460"> ( WARN , TRIM(msg))<a name='2938'>
    return<a name='2939'>
  endif<a name='2940'>
  if(DH%FileStatus == WRF_FILE_NOT_OPENED) then<a name='2941'>
    Status = WRF_WARN_FILE_NOT_OPENED<a name='2942'>
    write(msg,*) 'Warning FILE NOT OPENED in ',__FILE__,', line', __LINE__ <a name='2943'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1461"> ( WARN , TRIM(msg))<a name='2944'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_NOT_COMMITTED) then<a name='2945'>
<font color=#447700>! jm it is okay to have a dry run read. means read is called between ofrb and ofrc. Just return.<a name='2946'></font>
<font color=#447700>!    Status = WRF_WARN_DRYRUN_READ<a name='2947'></font>
<font color=#447700>!    write(msg,*) 'Warning DRYRUN READ in ',__FILE__,', line', __LINE__ <a name='2948'></font>
<font color=#447700>!    call wrf_debug ( WARN , TRIM(msg))<a name='2949'></font>
    Status = WRF_NO_ERR<a name='2950'>
    RETURN<a name='2951'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_WRITE) then<a name='2952'>
    Status = WRF_WARN_READ_WONLY_FILE<a name='2953'>
    write(msg,*) 'Warning READ WRITE ONLY FILE in ',__FILE__,', line', __LINE__ <a name='2954'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1462"> ( WARN , TRIM(msg))<a name='2955'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_READ .OR. DH%FileStatus == WRF_FILE_OPENED_FOR_UPDATE ) then<a name='2956'>
    NCID = DH%NCID<a name='2957'>
<a name='2958'>
<font color=#447700>!jm    Length(1:NDim) = DomainEnd(1:NDim)-DomainStart(1:NDim)+1<a name='2959'></font>
    Length(1:NDim) = PatchEnd(1:NDim)-PatchStart(1:NDim)+1<a name='2960'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXTORDER'>ExtOrder</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXTORDER_2">(MemoryOrder,Length,Status)<a name='2961'>
    stat = NF_INQ_VARID(NCID,VarName,VarID)<a name='2962'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_38">(stat,Status)<a name='2963'>
    if(Status /= WRF_NO_ERR) then<a name='2964'>
      write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__,' Varname ',Varname<a name='2965'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1463"> ( WARN , TRIM(msg))<a name='2966'>
      return<a name='2967'>
    endif<a name='2968'>
    stat = NF_INQ_VAR(NCID,VarID,Name,XType,StoredDim,VDimIDs,NAtts)<a name='2969'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_39">(stat,Status)<a name='2970'>
    if(Status /= WRF_NO_ERR) then<a name='2971'>
      write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__ <a name='2972'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1464"> ( WARN , TRIM(msg))<a name='2973'>
      return<a name='2974'>
    endif<a name='2975'>
    stat = NF_GET_ATT_INT(NCID,VarID,'FieldType',FType)<a name='2976'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_40">(stat,Status)<a name='2977'>
    if(Status /= WRF_NO_ERR) then<a name='2978'>
      write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__ <a name='2979'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1465"> ( WARN , TRIM(msg))<a name='2980'>
      return<a name='2981'>
    endif<a name='2982'>
<font color=#447700>! allow coercion between double and single prec real<a name='2983'></font>
<font color=#447700>!jm    if(FieldType /= Ftype) then<a name='2984'></font>
    if( (FieldType == WRF_REAL .OR. FieldType == WRF_DOUBLE) ) then<a name='2985'>
      if ( .NOT. (Ftype     == WRF_REAL .OR. Ftype     == WRF_DOUBLE ))  then<a name='2986'>
        Status = WRF_WARN_TYPE_MISMATCH<a name='2987'>
        write(msg,*) 'Warning TYPE MISMATCH in ',__FILE__,', line', __LINE__<a name='2988'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1466"> ( WARN , TRIM(msg))<a name='2989'>
        return<a name='2990'>
      endif<a name='2991'>
    else if(FieldType /= Ftype) then<a name='2992'>
      Status = WRF_WARN_TYPE_MISMATCH<a name='2993'>
      write(msg,*) 'Warning TYPE MISMATCH in ',__FILE__,', line', __LINE__<a name='2994'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1467"> ( WARN , TRIM(msg))<a name='2995'>
      return<a name='2996'>
    endif      <a name='2997'>
      <a name='2998'>
    <font color=#447700>! Do not use SELECT statement here as sometimes WRF_REAL=WRF_DOUBLE<a name='2999'></font>
    IF (FieldType == WRF_REAL) THEN<a name='3000'>
<font color=#447700>! allow coercion between double and single prec real<a name='3001'></font>
        if(.NOT. (XType == NF_FLOAT .OR. XType == NF_DOUBLE) )  then<a name='3002'>
          Status = WRF_WARN_TYPE_MISMATCH<a name='3003'>
          write(msg,*) 'Warning REAL TYPE MISMATCH in ',__FILE__,', line', __LINE__<a name='3004'>
        endif<a name='3005'>
    ELSE IF (FieldType == WRF_DOUBLE) THEN<a name='3006'>
<font color=#447700>! allow coercion between double and single prec real<a name='3007'></font>
        if(.NOT. (XType == NF_FLOAT .OR. XType == NF_DOUBLE) )  then<a name='3008'>
          Status = WRF_WARN_TYPE_MISMATCH<a name='3009'>
          write(msg,*) 'Warning DOUBLE TYPE MISMATCH in ',__FILE__,', line', __LINE__<a name='3010'>
        endif<a name='3011'>
    ELSE IF (FieldType == WRF_INTEGER) THEN<a name='3012'>
        if(XType /= NF_INT)  then <a name='3013'>
          Status = WRF_WARN_TYPE_MISMATCH<a name='3014'>
          write(msg,*) 'Warning INTEGER TYPE MISMATCH in ',__FILE__,', line', __LINE__<a name='3015'>
        endif<a name='3016'>
    ELSE IF (FieldType == WRF_LOGICAL) THEN<a name='3017'>
        if(XType /= NF_INT)  then<a name='3018'>
          Status = WRF_WARN_TYPE_MISMATCH<a name='3019'>
          write(msg,*) 'Warning LOGICAL TYPE MISMATCH in ',__FILE__,', line', __LINE__<a name='3020'>
        endif<a name='3021'>
    ELSE<a name='3022'>
        Status = WRF_WARN_DATA_TYPE_NOT_FOUND<a name='3023'>
        write(msg,*) 'Warning DATA TYPE NOT FOUND in ',__FILE__,', line', __LINE__<a name='3024'>
    END IF<a name='3025'>
<a name='3026'>
    if(Status /= WRF_NO_ERR) then<a name='3027'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1468"> ( WARN , TRIM(msg))<a name='3028'>
      return<a name='3029'>
    endif<a name='3030'>
    <font color=#447700>! NDim=0 for scalars.  Handle read of old NDim=1 files.  TBH:  20060502<a name='3031'></font>
    IF ( ( NDim == 0 ) .AND. ( StoredDim == 2 ) ) THEN<a name='3032'>
      stat = NF_INQ_DIMNAME(NCID,VDimIDs(1),dimname)<a name='3033'>
      call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_41">(stat,Status)<a name='3034'>
      if(Status /= WRF_NO_ERR) then<a name='3035'>
        write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__ <a name='3036'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1469"> ( WARN , TRIM(msg))<a name='3037'>
        return<a name='3038'>
      endif<a name='3039'>
      IF ( dimname(1:10) == 'ext_scalar' ) THEN<a name='3040'>
        NDim = 1<a name='3041'>
        Length(1) = 1<a name='3042'>
      ENDIF<a name='3043'>
    ENDIF<a name='3044'>
    if(StoredDim /= NDim+1) then<a name='3045'>
      Status = WRF_ERR_FATAL_BAD_VARIABLE_DIM<a name='3046'>
      write(msg,*) 'Fatal error BAD VARIABLE DIMENSION in ext_ncd_read_field ',TRIM(Var),TRIM(DateStr)<a name='3047'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1470"> ( FATAL , msg)<a name='3048'>
      write(msg,*) '  StoredDim ', StoredDim, ' .NE. NDim+1 ', NDim+1<a name='3049'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1471"> ( FATAL , msg)<a name='3050'>
      return<a name='3051'>
    endif<a name='3052'>
    do j=1,NDim<a name='3053'>
      stat = NF_INQ_DIMLEN(NCID,VDimIDs(j),StoredLen(j))<a name='3054'>
      call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_42">(stat,Status)<a name='3055'>
      if(Status /= WRF_NO_ERR) then<a name='3056'>
        write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__ <a name='3057'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1472"> ( WARN , TRIM(msg))<a name='3058'>
        return<a name='3059'>
      endif<a name='3060'>
      if(Length(j) &gt; StoredLen(j)) then<a name='3061'>
        Status = WRF_WARN_READ_PAST_EOF<a name='3062'>
        write(msg,*) 'Warning READ PAST EOF in ext_ncd_read_field of ',TRIM(Var),Length(j),'&gt;',StoredLen(j)<a name='3063'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1473"> ( WARN , TRIM(msg))<a name='3064'>
        return<a name='3065'>
      elseif(Length(j) &lt;= 0) then<a name='3066'>
        Status = WRF_WARN_ZERO_LENGTH_READ<a name='3067'>
        write(msg,*) 'Warning ZERO LENGTH READ in ',__FILE__,', line', __LINE__<a name='3068'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1474"> ( WARN , TRIM(msg))<a name='3069'>
        return<a name='3070'>
      elseif(DomainStart(j) &lt; MemoryStart(j)) then<a name='3071'>
        Status = WRF_WARN_DIMENSION_ERROR<a name='3072'>
        write(msg,*) 'Warning dim ',j,' DomainStart (',DomainStart(j), &amp;<a name='3073'>
                     ') &lt; MemoryStart (',MemoryStart(j),') in ',__FILE__,', line', __LINE__<a name='3074'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1475"> ( WARN , TRIM(msg))<a name='3075'>
<font color=#447700>!        return<a name='3076'></font>
      endif<a name='3077'>
    enddo<a name='3078'>
<a name='3079'>
    StoredStart = 1<a name='3080'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETINDICES'>GetIndices</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETINDICES_4">(NDim,MemoryStart,MemoryEnd,l1,l2,m1,m2,n1,n2)<a name='3081'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETINDICES'>GetIndices</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETINDICES_5">(NDim,StoredStart,StoredLen,x1,x2,y1,y2,z1,z2)<a name='3082'>
<font color=#447700>!jm    call GetIndices(NDim,DomainStart,DomainEnd,i1,i2,j1,j2,k1,k2)<a name='3083'></font>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETINDICES'>GetIndices</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETINDICES_6">(NDim,PatchStart,PatchEnd,i1,i2,j1,j2,k1,k2)<a name='3084'>
<a name='3085'>
    di=1<a name='3086'>
    if(FieldType == WRF_DOUBLE) di=2<a name='3087'>
    allocate(XField(di,x1:x2,y1:y2,z1:z2), STAT=stat)<a name='3088'>
    if(stat/= 0) then<a name='3089'>
      Status = WRF_ERR_FATAL_ALLOCATION_ERROR<a name='3090'>
      write(msg,*) 'Fatal ALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='3091'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1476"> ( FATAL , msg)<a name='3092'>
      return<a name='3093'>
    endif<a name='3094'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#FIELDIO'>FieldIO</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="FIELDIO_2">('read',DataHandle,DateStr,Length,MemoryOrder, &amp;<a name='3095'>
                  FieldType,NCID,VarID,XField,Status)<a name='3096'>
    if(Status /= WRF_NO_ERR) then<a name='3097'>
      write(msg,*) 'Warning Status = ',Status,' in ',__FILE__,', line', __LINE__ <a name='3098'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1477"> ( WARN , TRIM(msg))<a name='3099'>
      return<a name='3100'>
    endif<a name='3101'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#TRANSPOSE'>Transpose</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="TRANSPOSE_2">('read',MemoryOrder,di, Field,l1,l2,m1,m2,n1,n2 &amp;<a name='3102'>
                                        ,XField,x1,x2,y1,y2,z1,z2 &amp;<a name='3103'>
                                               ,i1,i2,j1,j2,k1,k2 )<a name='3104'>
    deallocate(XField, STAT=stat)<a name='3105'>
    if(stat/= 0) then<a name='3106'>
      Status = WRF_ERR_FATAL_DEALLOCATION_ERR<a name='3107'>
      write(msg,*) 'Fatal DEALLOCATION ERROR in ',__FILE__,', line', __LINE__<a name='3108'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1478"> ( FATAL , msg)<a name='3109'>
      return<a name='3110'>
    endif<a name='3111'>
  else<a name='3112'>
    Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='3113'>
    write(msg,*) 'Fatal error BAD FILE STATUS in ',__FILE__,', line', __LINE__ <a name='3114'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_READ_FIELD' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1479"> ( FATAL , msg)<a name='3115'>
  endif<a name='3116'>
  DH%first_operation  = .FALSE.<a name='3117'>
  return<a name='3118'>
end subroutine ext_ncd_read_field<a name='3119'>
<a name='3120'>
<A NAME='EXT_NCD_INQUIRE_OPENED'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRE_OPENED' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3121'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_inquire_opened</font>( DataHandle, FileName , FileStatus, Status ) <A href='../../call_to/EXT_NCD_INQUIRE_OPENED.html' TARGET='index'>1</A>,<A href='../../call_from/EXT_NCD_INQUIRE_OPENED.html' TARGET='index'>3</A><a name='3122'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRE_OPENED' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_39"><a name='3123'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRE_OPENED' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_20"><a name='3124'>
  implicit none<a name='3125'>
  include 'wrf_status_codes.h'<a name='3126'>
  integer               ,intent(in)     :: DataHandle<a name='3127'>
  character*(*)         ,intent(inout)  :: FileName<a name='3128'>
  integer               ,intent(out)    :: FileStatus<a name='3129'>
  integer               ,intent(out)    :: Status<a name='3130'>
  type(wrf_data_handle) ,pointer        :: DH<a name='3131'>
<a name='3132'>
  <font color=#447700>!call upgrade_filename(FileName)<a name='3133'></font>
<a name='3134'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRE_OPENED' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_10">(DataHandle,DH,Status)<a name='3135'>
  if(Status /= WRF_NO_ERR) then<a name='3136'>
    FileStatus = WRF_FILE_NOT_OPENED<a name='3137'>
    return<a name='3138'>
  endif<a name='3139'>
  if(trim(FileName) /= trim(DH%FileName)) then<a name='3140'>
    FileStatus = WRF_FILE_NOT_OPENED<a name='3141'>
  else<a name='3142'>
    FileStatus = DH%FileStatus<a name='3143'>
  endif<a name='3144'>
  Status = WRF_NO_ERR<a name='3145'>
  return<a name='3146'>
end subroutine ext_ncd_inquire_opened<a name='3147'>
<a name='3148'>
<A NAME='EXT_NCD_INQUIRE_FILENAME'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRE_FILENAME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3149'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_inquire_filename</font>( Datahandle, FileName,  FileStatus, Status ) <A href='../../call_to/EXT_NCD_INQUIRE_FILENAME.html' TARGET='index'>11</A>,<A href='../../call_from/EXT_NCD_INQUIRE_FILENAME.html' TARGET='index'>4</A><a name='3150'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRE_FILENAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_40"><a name='3151'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRE_FILENAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_21"><a name='3152'>
  implicit none<a name='3153'>
  include 'wrf_status_codes.h'<a name='3154'>
  integer               ,intent(in)     :: DataHandle<a name='3155'>
  character*(*)         ,intent(out)    :: FileName<a name='3156'>
  integer               ,intent(out)    :: FileStatus<a name='3157'>
  integer               ,intent(out)    :: Status<a name='3158'>
  type(wrf_data_handle) ,pointer        :: DH<a name='3159'>
  FileStatus = WRF_FILE_NOT_OPENED<a name='3160'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRE_FILENAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_11">(DataHandle,DH,Status)<a name='3161'>
  if(Status /= WRF_NO_ERR) then<a name='3162'>
    write(msg,*) 'Warning Status = ',Status,' in ',__FILE__,', line', __LINE__<a name='3163'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_INQUIRE_FILENAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1480"> ( WARN , TRIM(msg))<a name='3164'>
    return<a name='3165'>
  endif<a name='3166'>
  FileName = trim(DH%FileName)<a name='3167'>
  FileStatus = DH%FileStatus<a name='3168'>
  Status = WRF_NO_ERR<a name='3169'>
  return<a name='3170'>
end subroutine ext_ncd_inquire_filename<a name='3171'>
<a name='3172'>
<A NAME='EXT_NCD_SET_TIME'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SET_TIME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3173'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_set_time</font>(DataHandle, DateStr, Status) <A href='../../call_to/EXT_NCD_SET_TIME.html' TARGET='index'>1</A>,<A href='../../call_from/EXT_NCD_SET_TIME.html' TARGET='index'>10</A><a name='3174'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_41"><a name='3175'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_22"><a name='3176'>
  implicit none<a name='3177'>
  include 'wrf_status_codes.h'<a name='3178'>
  integer               ,intent(in)     :: DataHandle<a name='3179'>
  character*(*)         ,intent(in)     :: DateStr<a name='3180'>
  integer               ,intent(out)    :: Status<a name='3181'>
  type(wrf_data_handle) ,pointer        :: DH<a name='3182'>
  integer                               :: i<a name='3183'>
<a name='3184'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#DATECHECK'>DateCheck</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="DATECHECK_4">(DateStr,Status)<a name='3185'>
  if(Status /= WRF_NO_ERR) then<a name='3186'>
    write(msg,*) 'Warning DATE STRING ERROR in ',__FILE__,', line', __LINE__ <a name='3187'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1481"> ( WARN , TRIM(msg))<a name='3188'>
    return<a name='3189'>
  endif<a name='3190'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_12">(DataHandle,DH,Status)<a name='3191'>
  if(Status /= WRF_NO_ERR) then<a name='3192'>
    write(msg,*) 'Warning Status = ',Status,' in ',__FILE__,', line', __LINE__<a name='3193'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1482"> ( WARN , TRIM(msg))<a name='3194'>
    return<a name='3195'>
  endif<a name='3196'>
  if(DH%FileStatus == WRF_FILE_NOT_OPENED) then<a name='3197'>
    Status = WRF_WARN_FILE_NOT_OPENED<a name='3198'>
    write(msg,*) 'Warning FILE NOT OPENED in ',__FILE__,', line', __LINE__ <a name='3199'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1483"> ( WARN , TRIM(msg))<a name='3200'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_NOT_COMMITTED) then<a name='3201'>
    Status = WRF_WARN_FILE_NOT_COMMITTED<a name='3202'>
    write(msg,*) 'Warning FILE NOT COMMITTED in ',__FILE__,', line', __LINE__<a name='3203'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1484"> ( WARN , TRIM(msg))<a name='3204'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_WRITE) then<a name='3205'>
    Status = WRF_WARN_READ_WONLY_FILE<a name='3206'>
    write(msg,*) 'Warning READ WRITE ONLY FILE in ',__FILE__,', line', __LINE__ <a name='3207'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1485"> ( WARN , TRIM(msg))<a name='3208'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_READ) then<a name='3209'>
    do i=1,MaxTimes<a name='3210'>
      if(DH%Times(i)==DateStr) then<a name='3211'>
        DH%CurrentTime = i<a name='3212'>
        exit<a name='3213'>
      endif<a name='3214'>
      if(i==MaxTimes) then<a name='3215'>
        Status = WRF_WARN_TIME_NF<a name='3216'>
        return<a name='3217'>
      endif<a name='3218'>
    enddo<a name='3219'>
    DH%CurrentVariable = 0<a name='3220'>
    Status = WRF_NO_ERR<a name='3221'>
  else<a name='3222'>
    Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='3223'>
    write(msg,*) 'Fatal error BAD FILE STATUS in ',__FILE__,', line', __LINE__ <a name='3224'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SET_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1486"> ( FATAL , msg)<a name='3225'>
  endif<a name='3226'>
  return<a name='3227'>
end subroutine ext_ncd_set_time<a name='3228'>
<a name='3229'>
<A NAME='EXT_NCD_GET_NEXT_TIME'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_TIME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3230'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_next_time</font>(DataHandle, DateStr, Status) <A href='../../call_to/EXT_NCD_GET_NEXT_TIME.html' TARGET='index'>9</A>,<A href='../../call_from/EXT_NCD_GET_NEXT_TIME.html' TARGET='index'>9</A><a name='3231'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_42"><a name='3232'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_23"><a name='3233'>
  implicit none<a name='3234'>
  include 'wrf_status_codes.h'<a name='3235'>
  integer               ,intent(in)     :: DataHandle<a name='3236'>
  character*(*)         ,intent(out)    :: DateStr<a name='3237'>
  integer               ,intent(out)    :: Status<a name='3238'>
  type(wrf_data_handle) ,pointer        :: DH<a name='3239'>
<a name='3240'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_13">(DataHandle,DH,Status)<a name='3241'>
  if(Status /= WRF_NO_ERR) then<a name='3242'>
    write(msg,*) 'Warning Status = ',Status,' in ',__FILE__,', line', __LINE__<a name='3243'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1487"> ( WARN , TRIM(msg))<a name='3244'>
    return<a name='3245'>
  endif<a name='3246'>
  if(DH%FileStatus == WRF_FILE_NOT_OPENED) then<a name='3247'>
    Status = WRF_WARN_FILE_NOT_OPENED<a name='3248'>
    write(msg,*) 'Warning FILE NOT OPENED in ',__FILE__,', line', __LINE__ <a name='3249'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1488"> ( WARN , TRIM(msg))<a name='3250'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_NOT_COMMITTED) then<a name='3251'>
    Status = WRF_WARN_DRYRUN_READ<a name='3252'>
    write(msg,*) 'Warning DRYRUN READ in ',__FILE__,', line', __LINE__ <a name='3253'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1489"> ( WARN , TRIM(msg))<a name='3254'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_WRITE) then<a name='3255'>
    Status = WRF_WARN_READ_WONLY_FILE<a name='3256'>
    write(msg,*) 'Warning READ WRITE ONLY FILE in ',__FILE__,', line', __LINE__ <a name='3257'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1490"> ( WARN , TRIM(msg))<a name='3258'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_READ .OR. DH%FileStatus == WRF_FILE_OPENED_FOR_UPDATE ) then<a name='3259'>
    if(DH%CurrentTime &gt;= DH%NumberTimes) then<a name='3260'>
      Status = WRF_WARN_TIME_EOF<a name='3261'>
      return<a name='3262'>
    endif<a name='3263'>
    DH%CurrentTime     = DH%CurrentTime +1<a name='3264'>
    DateStr            = DH%Times(DH%CurrentTime)<a name='3265'>
    DH%CurrentVariable = 0<a name='3266'>
    Status = WRF_NO_ERR<a name='3267'>
  else<a name='3268'>
    Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='3269'>
    write(msg,*) 'DH%FileStatus ',DH%FileStatus<a name='3270'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1491"> ( FATAL , msg)<a name='3271'>
    write(msg,*) 'Fatal error BAD FILE STATUS in ',__FILE__,', line', __LINE__ <a name='3272'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1492"> ( FATAL , msg)<a name='3273'>
  endif<a name='3274'>
  return<a name='3275'>
end subroutine ext_ncd_get_next_time<a name='3276'>
<a name='3277'>
<A NAME='EXT_NCD_GET_PREVIOUS_TIME'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_PREVIOUS_TIME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3278'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_previous_time</font>(DataHandle, DateStr, Status) <A href='../../call_to/EXT_NCD_GET_PREVIOUS_TIME.html' TARGET='index'>1</A>,<A href='../../call_from/EXT_NCD_GET_PREVIOUS_TIME.html' TARGET='index'>8</A><a name='3279'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_PREVIOUS_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_43"><a name='3280'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_PREVIOUS_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_24"><a name='3281'>
  implicit none<a name='3282'>
  include 'wrf_status_codes.h'<a name='3283'>
  integer               ,intent(in)     :: DataHandle<a name='3284'>
  character*(*)         ,intent(out)    :: DateStr<a name='3285'>
  integer               ,intent(out)    :: Status<a name='3286'>
  type(wrf_data_handle) ,pointer        :: DH<a name='3287'>
<a name='3288'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_PREVIOUS_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_14">(DataHandle,DH,Status)<a name='3289'>
  if(Status /= WRF_NO_ERR) then<a name='3290'>
    write(msg,*) 'Warning Status = ',Status,' in ',__FILE__,', line', __LINE__<a name='3291'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_PREVIOUS_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1493"> ( WARN , TRIM(msg))<a name='3292'>
    return<a name='3293'>
  endif<a name='3294'>
  if(DH%FileStatus == WRF_FILE_NOT_OPENED) then<a name='3295'>
    Status = WRF_WARN_FILE_NOT_OPENED<a name='3296'>
    write(msg,*) 'Warning FILE NOT OPENED in ',__FILE__,', line', __LINE__ <a name='3297'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_PREVIOUS_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1494"> ( WARN , TRIM(msg))<a name='3298'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_NOT_COMMITTED) then<a name='3299'>
    Status = WRF_WARN_DRYRUN_READ<a name='3300'>
    write(msg,*) 'Warning DRYRUN READ in ',__FILE__,', line', __LINE__ <a name='3301'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_PREVIOUS_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1495"> ( WARN , TRIM(msg))<a name='3302'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_WRITE) then<a name='3303'>
    Status = WRF_WARN_READ_WONLY_FILE<a name='3304'>
    write(msg,*) 'Warning READ WRITE ONLY FILE in ',__FILE__,', line', __LINE__ <a name='3305'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_PREVIOUS_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1496"> ( WARN , TRIM(msg))<a name='3306'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_READ) then<a name='3307'>
    if(DH%CurrentTime.GT.0) then<a name='3308'>
      DH%CurrentTime     = DH%CurrentTime -1<a name='3309'>
    endif<a name='3310'>
    DateStr            = DH%Times(DH%CurrentTime)<a name='3311'>
    DH%CurrentVariable = 0<a name='3312'>
    Status = WRF_NO_ERR<a name='3313'>
  else<a name='3314'>
    Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='3315'>
    write(msg,*) 'Fatal error BAD FILE STATUS in ',__FILE__,', line', __LINE__ <a name='3316'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_PREVIOUS_TIME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1497"> ( FATAL , msg)<a name='3317'>
  endif<a name='3318'>
  return<a name='3319'>
end subroutine ext_ncd_get_previous_time<a name='3320'>
<a name='3321'>
<A NAME='EXT_NCD_GET_NEXT_VAR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_VAR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3322'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_next_var</font>(DataHandle, VarName, Status) <A href='../../call_to/EXT_NCD_GET_NEXT_VAR.html' TARGET='index'>6</A>,<A href='../../call_from/EXT_NCD_GET_NEXT_VAR.html' TARGET='index'>8</A><a name='3323'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_VAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_44"><a name='3324'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_VAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_25"><a name='3325'>
  implicit none<a name='3326'>
  include 'wrf_status_codes.h'<a name='3327'>
  include 'netcdf.inc'<a name='3328'>
  integer               ,intent(in)     :: DataHandle<a name='3329'>
  character*(*)         ,intent(out)    :: VarName<a name='3330'>
  integer               ,intent(out)    :: Status<a name='3331'>
  type(wrf_data_handle) ,pointer        :: DH<a name='3332'>
  integer                               :: stat<a name='3333'>
  character (80)                        :: Name<a name='3334'>
<a name='3335'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_VAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_15">(DataHandle,DH,Status)<a name='3336'>
  if(Status /= WRF_NO_ERR) then<a name='3337'>
    write(msg,*) 'Warning Status = ',Status,' in ',__FILE__,', line', __LINE__<a name='3338'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_VAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1498"> ( WARN , TRIM(msg))<a name='3339'>
    return<a name='3340'>
  endif<a name='3341'>
  if(DH%FileStatus == WRF_FILE_NOT_OPENED) then<a name='3342'>
    Status = WRF_WARN_FILE_NOT_OPENED<a name='3343'>
    write(msg,*) 'Warning FILE NOT OPENED in ',__FILE__,', line', __LINE__ <a name='3344'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_VAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1499"> ( WARN , TRIM(msg))<a name='3345'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_NOT_COMMITTED) then<a name='3346'>
    Status = WRF_WARN_DRYRUN_READ<a name='3347'>
    write(msg,*) 'Warning DRYRUN READ in ',__FILE__,', line', __LINE__ <a name='3348'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_VAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1500"> ( WARN , TRIM(msg))<a name='3349'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_WRITE) then<a name='3350'>
    Status = WRF_WARN_READ_WONLY_FILE<a name='3351'>
    write(msg,*) 'Warning READ WRITE ONLY FILE in ',__FILE__,', line', __LINE__ <a name='3352'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_VAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1501"> ( WARN , TRIM(msg))<a name='3353'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_READ .OR. DH%FileStatus == WRF_FILE_OPENED_FOR_UPDATE) then<a name='3354'>
<a name='3355'>
    DH%CurrentVariable = DH%CurrentVariable +1<a name='3356'>
    if(DH%CurrentVariable &gt; DH%NumVars) then<a name='3357'>
      Status = WRF_WARN_VAR_EOF<a name='3358'>
      return<a name='3359'>
    endif<a name='3360'>
    VarName = DH%VarNames(DH%CurrentVariable)<a name='3361'>
    Status  = WRF_NO_ERR<a name='3362'>
  else<a name='3363'>
    Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='3364'>
    write(msg,*) 'Fatal error BAD FILE STATUS in ',__FILE__,', line', __LINE__ <a name='3365'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_NEXT_VAR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1502"> ( FATAL , msg)<a name='3366'>
  endif<a name='3367'>
  return<a name='3368'>
end subroutine ext_ncd_get_next_var<a name='3369'>
<a name='3370'>
<A NAME='EXT_NCD_END_OF_FRAME'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_END_OF_FRAME' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3371'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_end_of_frame</font>(DataHandle, Status),<A href='../../call_from/EXT_NCD_END_OF_FRAME.html' TARGET='index'>3</A><a name='3372'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_END_OF_FRAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_45"><a name='3373'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_END_OF_FRAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_26"><a name='3374'>
  implicit none<a name='3375'>
  include 'netcdf.inc'<a name='3376'>
  include 'wrf_status_codes.h'<a name='3377'>
  integer               ,intent(in)     :: DataHandle<a name='3378'>
  integer               ,intent(out)    :: Status<a name='3379'>
  type(wrf_data_handle) ,pointer        :: DH<a name='3380'>
<a name='3381'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_END_OF_FRAME' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_16">(DataHandle,DH,Status)<a name='3382'>
  return<a name='3383'>
end subroutine ext_ncd_end_of_frame<a name='3384'>
<a name='3385'>
<font color=#447700>! NOTE:  For scalar variables NDim is set to zero and DomainStart and <a name='3386'></font>
<font color=#447700>! NOTE:  DomainEnd are left unmodified.  <a name='3387'></font>
<A NAME='EXT_NCD_GET_VAR_INFO'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3388'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_get_var_info</font>(DataHandle,Name,NDim,MemoryOrder,Stagger,DomainStart,DomainEnd,WrfType,Status) <A href='../../call_to/EXT_NCD_GET_VAR_INFO.html' TARGET='index'>5</A>,<A href='../../call_from/EXT_NCD_GET_VAR_INFO.html' TARGET='index'>29</A><a name='3389'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_46"><a name='3390'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_27"><a name='3391'>
  implicit none<a name='3392'>
  include 'netcdf.inc'<a name='3393'>
  include 'wrf_status_codes.h'<a name='3394'>
  integer               ,intent(in)     :: DataHandle<a name='3395'>
  character*(*)         ,intent(in)     :: Name<a name='3396'>
  integer               ,intent(out)    :: NDim<a name='3397'>
  character*(*)         ,intent(out)    :: MemoryOrder<a name='3398'>
  character*(*)                         :: Stagger <font color=#447700>! Dummy for now<a name='3399'></font>
  integer ,dimension(*) ,intent(out)    :: DomainStart, DomainEnd<a name='3400'>
  integer               ,intent(out)    :: WrfType<a name='3401'>
  integer               ,intent(out)    :: Status<a name='3402'>
  type(wrf_data_handle) ,pointer        :: DH<a name='3403'>
  integer                               :: VarID<a name='3404'>
  integer ,dimension(NVarDims)          :: VDimIDs<a name='3405'>
  integer                               :: j<a name='3406'>
  integer                               :: stat<a name='3407'>
  integer                               :: XType<a name='3408'>
<a name='3409'>
  call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDH'>GetDH</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDH_17">(DataHandle,DH,Status)<a name='3410'>
  if(Status /= WRF_NO_ERR) then<a name='3411'>
    write(msg,*) 'Warning Status = ',Status,' in ',__FILE__,', line', __LINE__<a name='3412'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1503"> ( WARN , TRIM(msg))<a name='3413'>
    return<a name='3414'>
  endif<a name='3415'>
  if(DH%FileStatus == WRF_FILE_NOT_OPENED) then<a name='3416'>
    Status = WRF_WARN_FILE_NOT_OPENED<a name='3417'>
    write(msg,*) 'Warning FILE NOT OPENED in ',__FILE__,', line', __LINE__ <a name='3418'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1504"> ( WARN , TRIM(msg))<a name='3419'>
    return<a name='3420'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_NOT_COMMITTED) then<a name='3421'>
    Status = WRF_WARN_DRYRUN_READ<a name='3422'>
    write(msg,*) 'Warning DRYRUN READ in ',__FILE__,', line', __LINE__ <a name='3423'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1505"> ( WARN , TRIM(msg))<a name='3424'>
    return<a name='3425'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_WRITE) then<a name='3426'>
    Status = WRF_WARN_READ_WONLY_FILE<a name='3427'>
    write(msg,*) 'Warning READ WRITE ONLY FILE in ',__FILE__,', line', __LINE__ <a name='3428'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1506"> ( WARN , TRIM(msg))<a name='3429'>
    return<a name='3430'>
  elseif(DH%FileStatus == WRF_FILE_OPENED_FOR_READ .OR. DH%FileStatus == WRF_FILE_OPENED_FOR_UPDATE) then<a name='3431'>
    stat = NF_INQ_VARID(DH%NCID,Name,VarID)<a name='3432'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_43">(stat,Status)<a name='3433'>
    if(Status /= WRF_NO_ERR) then<a name='3434'>
      write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__ <a name='3435'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1507"> ( WARN , TRIM(msg))<a name='3436'>
      return<a name='3437'>
    endif<a name='3438'>
    stat = NF_INQ_VARTYPE(DH%NCID,VarID,XType)<a name='3439'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_44">(stat,Status)<a name='3440'>
    if(Status /= WRF_NO_ERR) then<a name='3441'>
      write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__ <a name='3442'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1508"> ( WARN , TRIM(msg))<a name='3443'>
      return<a name='3444'>
    endif<a name='3445'>
    stat = NF_GET_ATT_INT(DH%NCID,VarID,'FieldType',WrfType)<a name='3446'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_45">(stat,Status)<a name='3447'>
    if(Status /= WRF_NO_ERR) then<a name='3448'>
      write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__ <a name='3449'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1509"> ( WARN , TRIM(msg))<a name='3450'>
      return<a name='3451'>
    endif<a name='3452'>
    select case (XType)<a name='3453'>
      case (NF_BYTE)<a name='3454'>
        Status = WRF_WARN_BAD_DATA_TYPE<a name='3455'>
        write(msg,*) 'Warning BYTE IS BAD DATA TYPE in ',__FILE__,', line', __LINE__ <a name='3456'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1510"> ( WARN , TRIM(msg))<a name='3457'>
        return<a name='3458'>
      case (NF_CHAR)<a name='3459'>
        Status = WRF_WARN_BAD_DATA_TYPE<a name='3460'>
        write(msg,*) 'Warning CHAR IS BAD DATA TYPE in ',__FILE__,', line', __LINE__ <a name='3461'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1511"> ( WARN , TRIM(msg))<a name='3462'>
        return<a name='3463'>
      case (NF_SHORT)<a name='3464'>
        Status = WRF_WARN_BAD_DATA_TYPE<a name='3465'>
        write(msg,*) 'Warning SHORT IS BAD DATA TYPE in ',__FILE__,', line', __LINE__ <a name='3466'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1512"> ( WARN , TRIM(msg))<a name='3467'>
        return<a name='3468'>
      case (NF_INT)<a name='3469'>
        if(WrfType /= WRF_INTEGER .and. WrfType /= WRF_LOGICAL) then<a name='3470'>
          Status = WRF_WARN_BAD_DATA_TYPE<a name='3471'>
          write(msg,*) 'Warning BAD DATA TYPE in ',__FILE__,', line', __LINE__ <a name='3472'>
          call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1513"> ( WARN , TRIM(msg))<a name='3473'>
          return<a name='3474'>
        endif<a name='3475'>
      case (NF_FLOAT)<a name='3476'>
        if(WrfType /= WRF_REAL) then<a name='3477'>
          Status = WRF_WARN_BAD_DATA_TYPE<a name='3478'>
          write(msg,*) 'Warning BAD DATA TYPE in ',__FILE__,', line', __LINE__ <a name='3479'>
          call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1514"> ( WARN , TRIM(msg))<a name='3480'>
          return<a name='3481'>
        endif<a name='3482'>
      case (NF_DOUBLE)<a name='3483'>
        if(WrfType /= WRF_DOUBLE) then<a name='3484'>
          Status = WRF_WARN_BAD_DATA_TYPE<a name='3485'>
          write(msg,*) 'Warning BAD DATA TYPE in ',__FILE__,', line', __LINE__ <a name='3486'>
          call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1515"> ( WARN , TRIM(msg))<a name='3487'>
          return<a name='3488'>
        endif<a name='3489'>
      case default<a name='3490'>
        Status = WRF_WARN_DATA_TYPE_NOT_FOUND<a name='3491'>
        write(msg,*) 'Warning DATA TYPE NOT FOUND in ',__FILE__,', line', __LINE__ <a name='3492'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1516"> ( WARN , TRIM(msg))<a name='3493'>
        return<a name='3494'>
    end select<a name='3495'>
<a name='3496'>
    stat = NF_GET_ATT_TEXT(DH%NCID,VarID,'MemoryOrder',MemoryOrder)<a name='3497'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_46">(stat,Status)<a name='3498'>
    if(Status /= WRF_NO_ERR) then<a name='3499'>
      write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__ <a name='3500'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1517"> ( WARN , TRIM(msg))<a name='3501'>
      return<a name='3502'>
    endif<a name='3503'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#GETDIM'>GetDim</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GETDIM_7">(MemoryOrder,NDim,Status)<a name='3504'>
    if(Status /= WRF_NO_ERR) then<a name='3505'>
      write(msg,*) 'Warning BAD MEMORY ORDER ',TRIM(MemoryOrder),' in ',__FILE__,', line', __LINE__<a name='3506'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1518"> ( WARN , TRIM(msg))<a name='3507'>
      return<a name='3508'>
    endif<a name='3509'>
    stat = NF_INQ_VARDIMID(DH%NCID,VarID,VDimIDs)<a name='3510'>
    call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_47">(stat,Status)<a name='3511'>
    if(Status /= WRF_NO_ERR) then<a name='3512'>
      write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__ <a name='3513'>
      call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1519"> ( WARN , TRIM(msg))<a name='3514'>
      return<a name='3515'>
    endif<a name='3516'>
    do j = 1, NDim<a name='3517'>
      DomainStart(j) = 1<a name='3518'>
      stat = NF_INQ_DIMLEN(DH%NCID,VDimIDs(j),DomainEnd(j))<a name='3519'>
      call <A href='../../html_code/io_netcdf/wrf_io.F90.html#NETCDF_ERR'>netcdf_err</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="NETCDF_ERR_48">(stat,Status)<a name='3520'>
      if(Status /= WRF_NO_ERR) then<a name='3521'>
        write(msg,*) 'NetCDF error in ',__FILE__,', line', __LINE__ <a name='3522'>
        call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1520"> ( WARN , TRIM(msg))<a name='3523'>
        return<a name='3524'>
      endif<a name='3525'>
    enddo<a name='3526'>
  else<a name='3527'>
    Status = WRF_ERR_FATAL_BAD_FILE_STATUS<a name='3528'>
    write(msg,*) 'Fatal error BAD FILE STATUS in ',__FILE__,', line', __LINE__ <a name='3529'>
    call <A href='../../html_code/frame/wrf_debug.F.html#WRF_DEBUG'>wrf_debug</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_GET_VAR_INFO' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DEBUG_1521"> ( FATAL , msg)<a name='3530'>
  endif<a name='3531'>
  return<a name='3532'>
end subroutine ext_ncd_get_var_info<a name='3533'>
<a name='3534'>
<A NAME='EXT_NCD_WARNING_STR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WARNING_STR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3535'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_warning_str</font>( Code, ReturnString, Status),<A href='../../call_from/EXT_NCD_WARNING_STR.html' TARGET='index'>2</A><a name='3536'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WARNING_STR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_47"><a name='3537'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_WARNING_STR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_28"><a name='3538'>
  implicit none<a name='3539'>
  include 'netcdf.inc'<a name='3540'>
  include 'wrf_status_codes.h'<a name='3541'>
  <a name='3542'>
  integer  , intent(in)  ::Code<a name='3543'>
  character *(*), intent(out) :: ReturnString<a name='3544'>
  integer, intent(out) ::Status<a name='3545'>
  <a name='3546'>
  SELECT CASE (Code)<a name='3547'>
  CASE (0)<a name='3548'>
      ReturnString='No error'<a name='3549'>
      Status=WRF_NO_ERR<a name='3550'>
      return<a name='3551'>
  CASE (-1)<a name='3552'>
      ReturnString= 'File not found (or file is incomplete)'<a name='3553'>
      Status=WRF_NO_ERR<a name='3554'>
      return<a name='3555'>
  CASE (-2)<a name='3556'>
      ReturnString='Metadata not found'<a name='3557'>
      Status=WRF_NO_ERR<a name='3558'>
      return<a name='3559'>
  CASE (-3)<a name='3560'>
      ReturnString= 'Timestamp not found'<a name='3561'>
      Status=WRF_NO_ERR<a name='3562'>
      return<a name='3563'>
  CASE (-4)<a name='3564'>
      ReturnString= 'No more timestamps'<a name='3565'>
      Status=WRF_NO_ERR<a name='3566'>
      return<a name='3567'>
  CASE (-5)<a name='3568'>
      ReturnString= 'Variable not found'<a name='3569'>
      Status=WRF_NO_ERR<a name='3570'>
      return<a name='3571'>
  CASE (-6)<a name='3572'>
      ReturnString= 'No more variables for the current time'<a name='3573'>
      Status=WRF_NO_ERR<a name='3574'>
      return<a name='3575'>
  CASE (-7)<a name='3576'>
      ReturnString= 'Too many open files'<a name='3577'>
      Status=WRF_NO_ERR<a name='3578'>
      return<a name='3579'>
  CASE (-8)<a name='3580'>
      ReturnString= 'Data type mismatch'<a name='3581'>
      Status=WRF_NO_ERR<a name='3582'>
      return<a name='3583'>
  CASE (-9)<a name='3584'>
      ReturnString= 'Attempt to write read-only file'<a name='3585'>
      Status=WRF_NO_ERR<a name='3586'>
      return<a name='3587'>
  CASE (-10)<a name='3588'>
      ReturnString= 'Attempt to read write-only file'<a name='3589'>
      Status=WRF_NO_ERR<a name='3590'>
      return<a name='3591'>
  CASE (-11)<a name='3592'>
      ReturnString= 'Attempt to access unopened file'<a name='3593'>
      Status=WRF_NO_ERR<a name='3594'>
      return<a name='3595'>
  CASE (-12)<a name='3596'>
      ReturnString= 'Attempt to do 2 trainings for 1 variable'<a name='3597'>
      Status=WRF_NO_ERR<a name='3598'>
      return<a name='3599'>
  CASE (-13)<a name='3600'>
      ReturnString= 'Attempt to read past EOF'<a name='3601'>
      Status=WRF_NO_ERR<a name='3602'>
      return<a name='3603'>
  CASE (-14)<a name='3604'>
      ReturnString= 'Bad data handle'<a name='3605'>
      Status=WRF_NO_ERR<a name='3606'>
      return<a name='3607'>
  CASE (-15)<a name='3608'>
      ReturnString= 'Write length not equal to training length'<a name='3609'>
      Status=WRF_NO_ERR<a name='3610'>
      return<a name='3611'>
  CASE (-16)<a name='3612'>
      ReturnString= 'More dimensions requested than training'<a name='3613'>
      Status=WRF_NO_ERR<a name='3614'>
      return<a name='3615'>
  CASE (-17)<a name='3616'>
      ReturnString= 'Attempt to read more data than exists'<a name='3617'>
      Status=WRF_NO_ERR<a name='3618'>
      return<a name='3619'>
  CASE (-18)<a name='3620'>
      ReturnString= 'Input dimensions inconsistent'<a name='3621'>
      Status=WRF_NO_ERR<a name='3622'>
      return<a name='3623'>
  CASE (-19)<a name='3624'>
      ReturnString= 'Input MemoryOrder not recognized'<a name='3625'>
      Status=WRF_NO_ERR<a name='3626'>
      return<a name='3627'>
  CASE (-20)<a name='3628'>
      ReturnString= 'A dimension name with 2 different lengths'<a name='3629'>
      Status=WRF_NO_ERR<a name='3630'>
      return<a name='3631'>
  CASE (-21)<a name='3632'>
      ReturnString= 'String longer than provided storage'<a name='3633'>
      Status=WRF_NO_ERR<a name='3634'>
      return<a name='3635'>
  CASE (-22)<a name='3636'>
      ReturnString= 'Function not supportable'<a name='3637'>
      Status=WRF_NO_ERR<a name='3638'>
      return<a name='3639'>
  CASE (-23)<a name='3640'>
      ReturnString= 'Package implements this routine as NOOP'<a name='3641'>
      Status=WRF_NO_ERR<a name='3642'>
      return<a name='3643'>
<a name='3644'>
<font color=#447700>!netcdf-specific warning messages<a name='3645'></font>
  CASE (-1007)<a name='3646'>
      ReturnString= 'Bad data type'<a name='3647'>
      Status=WRF_NO_ERR<a name='3648'>
      return<a name='3649'>
  CASE (-1008)<a name='3650'>
      ReturnString= 'File not committed'<a name='3651'>
      Status=WRF_NO_ERR<a name='3652'>
      return<a name='3653'>
  CASE (-1009)<a name='3654'>
      ReturnString= 'File is opened for reading'<a name='3655'>
      Status=WRF_NO_ERR<a name='3656'>
      return<a name='3657'>
  CASE (-1011)<a name='3658'>
      ReturnString= 'Attempt to write metadata after open commit'<a name='3659'>
      Status=WRF_NO_ERR<a name='3660'>
      return<a name='3661'>
  CASE (-1010)<a name='3662'>
      ReturnString= 'I/O not initialized'<a name='3663'>
      Status=WRF_NO_ERR<a name='3664'>
      return<a name='3665'>
  CASE (-1012)<a name='3666'>
     ReturnString=  'Too many variables requested'<a name='3667'>
      Status=WRF_NO_ERR<a name='3668'>
      return<a name='3669'>
  CASE (-1013)<a name='3670'>
     ReturnString=  'Attempt to close file during a dry run'<a name='3671'>
      Status=WRF_NO_ERR<a name='3672'>
      return<a name='3673'>
  CASE (-1014)<a name='3674'>
      ReturnString= 'Date string not 19 characters in length'<a name='3675'>
      Status=WRF_NO_ERR<a name='3676'>
      return<a name='3677'>
  CASE (-1015)<a name='3678'>
      ReturnString= 'Attempt to read zero length words'<a name='3679'>
      Status=WRF_NO_ERR<a name='3680'>
      return<a name='3681'>
  CASE (-1016)<a name='3682'>
      ReturnString= 'Data type not found'<a name='3683'>
      Status=WRF_NO_ERR<a name='3684'>
      return<a name='3685'>
  CASE (-1017)<a name='3686'>
      ReturnString= 'Badly formatted date string'<a name='3687'>
      Status=WRF_NO_ERR<a name='3688'>
      return<a name='3689'>
  CASE (-1018)<a name='3690'>
      ReturnString= 'Attempt at read during a dry run'<a name='3691'>
      Status=WRF_NO_ERR<a name='3692'>
      return<a name='3693'>
  CASE (-1019)<a name='3694'>
      ReturnString= 'Attempt to get zero words'<a name='3695'>
      Status=WRF_NO_ERR<a name='3696'>
      return<a name='3697'>
  CASE (-1020)<a name='3698'>
      ReturnString= 'Attempt to put zero length words'<a name='3699'>
      Status=WRF_NO_ERR<a name='3700'>
      return<a name='3701'>
  CASE (-1021)<a name='3702'>
      ReturnString= 'NetCDF error'<a name='3703'>
      Status=WRF_NO_ERR<a name='3704'>
      return<a name='3705'>
  CASE (-1022)<a name='3706'>
      ReturnString= 'Requested length &lt;= 1'<a name='3707'>
      Status=WRF_NO_ERR<a name='3708'>
      return<a name='3709'>
  CASE (-1023)<a name='3710'>
      ReturnString= 'More data available than requested'<a name='3711'>
      Status=WRF_NO_ERR<a name='3712'>
      return<a name='3713'>
  CASE (-1024)<a name='3714'>
      ReturnString= 'New date less than previous date'<a name='3715'>
      Status=WRF_NO_ERR<a name='3716'>
      return<a name='3717'>
<a name='3718'>
  CASE DEFAULT<a name='3719'>
      ReturnString= 'This warning code is not supported or handled directly by WRF and NetCDF. &amp;<a name='3720'>
      &amp; Might be an erroneous number, or specific to an i/o package other than NetCDF; you may need &amp;<a name='3721'>
      &amp; to be calling a package-specific routine to return a message for this warning code.'<a name='3722'>
      Status=WRF_NO_ERR<a name='3723'>
  END SELECT<a name='3724'>
<a name='3725'>
  return<a name='3726'>
end subroutine ext_ncd_warning_str<a name='3727'>
<a name='3728'>
<font color=#447700>!returns message string for all WRF and netCDF warning/error status codes<a name='3729'></font>
<font color=#447700>!Other i/o packages must  provide their own routines to return their own status messages<a name='3730'></font>
<A NAME='EXT_NCD_ERROR_STR'><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ERROR_STR' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='3731'>
<font color=#993300>subroutine </font><font color=#cc0000>ext_ncd_error_str</font>( Code, ReturnString, Status),<A href='../../call_from/EXT_NCD_ERROR_STR.html' TARGET='index'>2</A><a name='3732'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#WRF_DATA'>wrf_data</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ERROR_STR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_DATA_48"><a name='3733'>
  use <A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_SUPPORT_ROUTINES'>ext_ncd_support_routines</A><A href='../../html_code/io_netcdf/wrf_io.F90.html#EXT_NCD_ERROR_STR' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="EXT_NCD_SUPPORT_ROUTINES_29"><a name='3734'>
  implicit none<a name='3735'>
  include 'netcdf.inc'<a name='3736'>
  include 'wrf_status_codes.h'<a name='3737'>
<a name='3738'>
  integer  , intent(in)  ::Code<a name='3739'>
  character *(*), intent(out) :: ReturnString<a name='3740'>
  integer, intent(out) ::Status<a name='3741'>
<a name='3742'>
  SELECT CASE (Code)<a name='3743'>
  CASE (-100)<a name='3744'>
      ReturnString= 'Allocation Error'<a name='3745'>
      Status=WRF_NO_ERR<a name='3746'>
      return<a name='3747'>
  CASE (-101)<a name='3748'>
      ReturnString= 'Deallocation Error'<a name='3749'>
      Status=WRF_NO_ERR<a name='3750'>
      return<a name='3751'>
  CASE (-102)<a name='3752'>
      ReturnString= 'Bad File Status'<a name='3753'>
      Status=WRF_NO_ERR<a name='3754'>
      return<a name='3755'>
  CASE (-1004)<a name='3756'>
      ReturnString= 'Variable on disk is not 3D'<a name='3757'>
      Status=WRF_NO_ERR<a name='3758'>
      return<a name='3759'>
  CASE (-1005)<a name='3760'>
      ReturnString= 'Metadata on disk is not 1D'<a name='3761'>
      Status=WRF_NO_ERR<a name='3762'>
      return<a name='3763'>
  CASE (-1006)<a name='3764'>
      ReturnString= 'Time dimension too small'<a name='3765'>
      Status=WRF_NO_ERR<a name='3766'>
      return<a name='3767'>
  CASE DEFAULT<a name='3768'>
      ReturnString= 'This error code is not supported or handled directly by WRF and NetCDF. &amp;<a name='3769'>
      &amp; Might be an erroneous number, or specific to an i/o package other than NetCDF; you may need &amp; <a name='3770'>
      &amp; to be calling a package-specific routine to return a message for this error code.'<a name='3771'>
      Status=WRF_NO_ERR<a name='3772'>
  END SELECT<a name='3773'>
<a name='3774'>
  return<a name='3775'>
end subroutine ext_ncd_error_str<a name='3776'>
</pre></body></html>