<HTML> <BODY BGCOLOR=#bbeeee LINK=#0000aa VLINK=#0000ff ALINK=#ff0000 ><BASE TARGET="bottom_target"><PRE><a name='1'>
<A NAME='MODULE_SI_IO_NMM'><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#MODULE_SI_IO_NMM' TARGET='top_target'><IMG SRC="../../gif/bar_purple.gif" border=0></A><a name='2'>
<font color=#993300>MODULE </font><font color=#cc0000>module_si_io_nmm</font> <A href='../../call_to/MODULE_SI_IO_NMM.html' TARGET='index'>2</A><a name='3'>
<a name='4'>
   USE <A href='../../html_code/share/module_optional_input.F.html#MODULE_OPTIONAL_INPUT'>module_optional_input</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#module_si_io_nmm.F' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_OPTIONAL_INPUT_2"><a name='5'>
<font color=#447700>!   USE, intrinsic :: iso_c_binding, only: c_int32_t<a name='6'></font>
<font color=#447700>!   USE module_io_int_idx<a name='7'></font>
<a name='8'>
   IMPLICIT NONE<a name='9'>
<font color=#447700>!! FROM MODULE_KINDS<a name='10'></font>
<a name='11'>
<font color=#447700>!   The numerical data types defined in this module are:<a name='12'></font>
<font color=#447700>!      i_byte    - specification kind for byte (1-byte) integer variable<a name='13'></font>
<font color=#447700>!      i_short   - specification kind for short (2-byte) integer variable<a name='14'></font>
<font color=#447700>!      i_long    - specification kind for long (4-byte) integer variable<a name='15'></font>
<font color=#447700>!      i_llong   - specification kind for double long (8-byte) integer variable<a name='16'></font>
<font color=#447700>!      r_single  - specification kind for single precision (4-byte) real variable<a name='17'></font>
<font color=#447700>!      r_double  - specification kind for double precision (8-byte) real variable<a name='18'></font>
<font color=#447700>!      r_quad    - specification kind for quad precision (16-byte) real variable<a name='19'></font>
<font color=#447700>!<a name='20'></font>
<font color=#447700>!      i_kind    - generic specification kind for default integer<a name='21'></font>
<font color=#447700>!      r_kind    - generic specification kind for default floating point<a name='22'></font>
<font color=#447700>!<a name='23'></font>
<font color=#447700>!<a name='24'></font>
<font color=#447700>! Integer type definitions below<a name='25'></font>
<a name='26'>
<font color=#447700>! Integer types<a name='27'></font>
  integer, parameter, public  :: i_byte  = selected_int_kind(1)      <font color=#447700>! byte  integer<a name='28'></font>
  integer, parameter, public  :: i_short = selected_int_kind(4)      <font color=#447700>! short integer<a name='29'></font>
  integer, parameter, public  :: i_long  = selected_int_kind(8)      <font color=#447700>! long  integer<a name='30'></font>
  integer, parameter, private :: llong_t = selected_int_kind(16)     <font color=#447700>! llong integer<a name='31'></font>
  integer, parameter, public  :: i_llong = max( llong_t, i_long )<a name='32'>
<a name='33'>
<font color=#447700>! Expected 8-bit byte sizes of the integer kinds<a name='34'></font>
  integer, parameter, public :: num_bytes_for_i_byte  = 1<a name='35'>
  integer, parameter, public :: num_bytes_for_i_short = 2<a name='36'>
  integer, parameter, public :: num_bytes_for_i_long  = 4<a name='37'>
  integer, parameter, public :: num_bytes_for_i_llong = 8<a name='38'>
<a name='39'>
<font color=#447700>! Define arrays for default definition<a name='40'></font>
  integer, parameter, private :: num_i_kinds = 4<a name='41'>
  integer, parameter, dimension( num_i_kinds ), private :: integer_types = (/ &amp;<a name='42'>
       i_byte, i_short, i_long,  i_llong  /)<a name='43'>
  integer, parameter, dimension( num_i_kinds ), private :: integer_byte_sizes = (/ &amp;<a name='44'>
       num_bytes_for_i_byte, num_bytes_for_i_short, &amp;<a name='45'>
       num_bytes_for_i_long, num_bytes_for_i_llong  /)<a name='46'>
<a name='47'>
<font color=#447700>! Default values<a name='48'></font>
<font color=#447700>! **** CHANGE THE FOLLOWING TO CHANGE THE DEFAULT INTEGER TYPE KIND ***<a name='49'></font>
  integer, parameter, private :: default_integer = 2  <font color=#447700>! 1=byte,<a name='50'></font>
                                                      <font color=#447700>! 2=short,<a name='51'></font>
                                                      <font color=#447700>! 3=long,<a name='52'></font>
                                                      <font color=#447700>! 4=llong<a name='53'></font>
  integer, parameter, public  :: i_kind = integer_types( default_integer )<a name='54'>
  integer, parameter, public  :: num_bytes_for_i_kind = &amp;<a name='55'>
       integer_byte_sizes( default_integer )<a name='56'>
<a name='57'>
<a name='58'>
<font color=#447700>! Real definitions below<a name='59'></font>
<a name='60'>
<font color=#447700>! Real types<a name='61'></font>
  integer, parameter, public  :: r_single = selected_real_kind(6)  <font color=#447700>! single precision<a name='62'></font>
  integer, parameter, public  :: r_double = selected_real_kind(15) <font color=#447700>! double precision<a name='63'></font>
  integer, parameter, private :: quad_t   = selected_real_kind(20) <font color=#447700>! quad precision<a name='64'></font>
  integer, parameter, public  :: r_quad   = max( quad_t, r_double )<a name='65'>
<a name='66'>
<font color=#447700>! Expected 8-bit byte sizes of the real kinds<a name='67'></font>
  integer, parameter, public :: num_bytes_for_r_single = 4<a name='68'>
  integer, parameter, public :: num_bytes_for_r_double = 8<a name='69'>
  integer, parameter, public :: num_bytes_for_r_quad   = 16<a name='70'>
<a name='71'>
<font color=#447700>! Define arrays for default definition<a name='72'></font>
  integer, parameter, private :: num_r_kinds = 3<a name='73'>
  integer, parameter, dimension( num_r_kinds ), private :: real_kinds = (/ &amp;<a name='74'>
       r_single, r_double, r_quad    /)<a name='75'>
  integer, parameter, dimension( num_r_kinds ), private :: real_byte_sizes = (/ &amp;<a name='76'>
       num_bytes_for_r_single, num_bytes_for_r_double, &amp;<a name='77'>
       num_bytes_for_r_quad    /)<a name='78'>
<a name='79'>
<font color=#447700>! Default values<a name='80'></font>
<font color=#447700>! **** CHANGE THE FOLLOWING TO CHANGE THE DEFAULT REAL TYPE KIND ***<a name='81'></font>
  integer, parameter, private :: default_real = 2  <font color=#447700>! 1=single,<a name='82'></font>
                                                   <font color=#447700>! 2=double,<a name='83'></font>
<font color=#447700>!! END FROM MODULE_KINDS<a name='84'></font>
<a name='85'>
      <font color=#447700>!  Input 3D meteorological fields.<a name='86'></font>
<a name='87'>
      REAL , DIMENSION(:,:,:) , ALLOCATABLE :: u_input , v_input , &amp;<a name='88'>
                                               q_input , t_input<a name='89'>
<a name='90'>
      <font color=#447700>!  Input 3D LSM fields.<a name='91'></font>
<a name='92'>
      REAL , DIMENSION(:,:,:) , ALLOCATABLE :: landuse_frac_input , &amp;<a name='93'>
                                               soil_top_cat_input , &amp;<a name='94'>
                                               soil_bot_cat_input<a name='95'>
<a name='96'>
      REAL, ALLOCATABLE:: htm_in(:,:,:),vtm_in(:,:,:)<a name='97'>
<a name='98'>
      <font color=#447700>!  Input 2D surface fields.<a name='99'></font>
<a name='100'>
      REAL , DIMENSION(:,:)   , ALLOCATABLE,save :: soilt010_input , soilt040_input , &amp;<a name='101'>
                                               soilt100_input , soilt200_input , &amp;<a name='102'>
                                               soilm010_input , soilm040_input , &amp;<a name='103'>
                                               soilm100_input , soilm200_input , &amp;<a name='104'>
                                               psfc_in,pmsl<a name='105'>
<a name='106'>
      REAL , DIMENSION(:,:)   , ALLOCATABLE :: lat_wind, lon_wind <a name='107'>
<a name='108'>
      REAL , DIMENSION(:)     , ALLOCATABLE :: DETA_in, AETA_in, ETAX_in<a name='109'>
      REAL , DIMENSION(:)     , ALLOCATABLE :: DETA1_in, AETA1_in, ETA1_in<a name='110'>
      REAL , DIMENSION(:)     , ALLOCATABLE :: DETA2_in, AETA2_in, ETA2_in, DFL_in<a name='111'>
<a name='112'>
      REAL , DIMENSION(:,:,:), ALLOCATABLE,save :: st_inputx , sm_inputx, sw_inputx<a name='113'>
<a name='114'>
      <font color=#447700>!  Local input arrays<a name='115'></font>
<a name='116'>
      REAL,DIMENSION(:,:),ALLOCATABLE :: dum2d<a name='117'>
      INTEGER,DIMENSION(:,:),ALLOCATABLE :: idum2d<a name='118'>
      REAL,DIMENSION(:,:,:),ALLOCATABLE :: dum3d<a name='119'>
<a name='120'>
      LOGICAL , SAVE :: first_time_in = .TRUE.<a name='121'>
<a name='122'>
      INTEGER :: flag_soilt010 , flag_soilt100 , flag_soilt200 , &amp;<a name='123'>
        	 flag_soilm010 , flag_soilm100 , flag_soilm200<a name='124'>
<a name='125'>
<font color=#447700>!   Some constants to allow simple dimensions in the defined types<a name='126'></font>
<font color=#447700>!   given below.<a name='127'></font>
<a name='128'>
      INTEGER, PARAMETER          :: var_maxdims = 5<a name='129'>
      INTEGER, PARAMETER          :: max_staggers_xy_new = 4<a name='130'>
      INTEGER, PARAMETER          :: max_staggers_xy_old = 3<a name='131'>
      INTEGER, PARAMETER          :: max_staggers_z = 2<a name='132'>
      INTEGER, PARAMETER          :: max_standard_lats = 4<a name='133'>
      INTEGER, PARAMETER          :: max_standard_lons = 4  <a name='134'>
      INTEGER, PARAMETER          :: max_fg_variables = 200<a name='135'>
      INTEGER, PARAMETER          :: max_vertical_levels = 2000<a name='136'>
<a name='137'>
<font color=#447700>!   This module defines the items needed for the WRF metadata<a name='138'></font>
<font color=#447700>!   which is broken up into three levels:  <a name='139'></font>
<font color=#447700>!      Global metadata:  Those things which apply to the<a name='140'></font>
<font color=#447700>!                        entire simulation that are <a name='141'></font>
<font color=#447700>!                        independent of time, domain, or<a name='142'></font>
<font color=#447700>!                        variable<a name='143'></font>
<font color=#447700>!<a name='144'></font>
<font color=#447700>!      Domain metadata:  Those things which apply to <a name='145'></font>
<font color=#447700>!                        a single domain (this may<a name='146'></font>
<font color=#447700>!                        or may not be time dependent)<a name='147'></font>
<font color=#447700>!<a name='148'></font>
<font color=#447700>!      Variable metadata: Those things which apply to <a name='149'></font>
<font color=#447700>!                        a specific variable at a <a name='150'></font>
<font color=#447700>!                        specific time<a name='151'></font>
<font color=#447700>!<a name='152'></font>
<font color=#447700>!      The variable names and definitions can be <a name='153'></font>
<font color=#447700>!      found in the wrf_metadata spec, which is still<a name='154'></font>
<font color=#447700>!      a living document as coding goes on.   The names<a name='155'></font>
<font color=#447700>!      may not match exactly, but you should be able <a name='156'></font>
<font color=#447700>!      to figure things out.  <a name='157'></font>
<font color=#447700>!<a name='158'></font>
<a name='159'>
      TYPE wrf_var_metadata<a name='160'>
	 CHARACTER (LEN=8)         :: name <a name='161'>
	 CHARACTER (LEN=16)        :: units<a name='162'>
	 CHARACTER (LEN=80)        :: description<a name='163'>
	 INTEGER                   :: domain_id<a name='164'>
	 INTEGER                   :: ndim<a name='165'>
	 INTEGER                   :: dim_val (var_maxdims)<a name='166'>
	 CHARACTER(LEN=4)          :: dim_desc (var_maxdims)<a name='167'>
	 INTEGER                   :: start_index(var_maxdims)<a name='168'>
	 INTEGER                   :: stop_index(var_maxdims)<a name='169'>
	 INTEGER                   :: h_stagger_index<a name='170'>
	 INTEGER                   :: v_stagger_index<a name='171'>
	 CHARACTER(LEN=8)          :: array_order<a name='172'>
	 CHARACTER(LEN=4)          :: field_type<a name='173'>
	 CHARACTER(LEN=8)          :: field_source_prog<a name='174'>
	 CHARACTER(LEN=80)         :: source_desc<a name='175'>
	 CHARACTER(LEN=8)          :: field_time_type<a name='176'>
	 INTEGER                   :: vt_date_start<a name='177'>
	 REAL                      :: vt_time_start<a name='178'>
	 INTEGER                   :: vt_date_stop<a name='179'>
	 REAL                      :: vt_time_stop<a name='180'>
      END TYPE wrf_var_metadata<a name='181'>
<a name='182'>
      TYPE(wrf_var_metadata)  :: var_meta , var_info<a name='183'>
<a name='184'>
      TYPE wrf_domain_metadata<a name='185'>
	 INTEGER                   :: id<a name='186'>
	 INTEGER                   :: parent_id<a name='187'>
	 CHARACTER(LEN=8)          :: dyn_init_src<a name='188'>
	 CHARACTER(LEN=8)          :: static_init_src <a name='189'>
	 INTEGER                   :: vt_date<a name='190'>
	 REAL                      :: vt_time<a name='191'>
	 INTEGER                   :: origin_parent_x<a name='192'>
	 INTEGER                   :: origin_parent_y<a name='193'>
	 INTEGER                   :: ratio_to_parent<a name='194'>
	 REAL                      :: delta_x<a name='195'>
	 REAL                      :: delta_y<a name='196'>
	 REAL                      :: top_level<a name='197'>
	 INTEGER                   :: origin_parent_z<a name='198'>
	 REAL                      :: corner_lats_new(4,max_staggers_xy_new)<a name='199'>
	 REAL                      :: corner_lons_new(4,max_staggers_xy_new)<a name='200'>
	 REAL                      :: corner_lats_old(4,max_staggers_xy_old)<a name='201'>
	 REAL                      :: corner_lons_old(4,max_staggers_xy_old)<a name='202'>
	 INTEGER                   :: xdim<a name='203'>
	 INTEGER                   :: ydim<a name='204'>
	 INTEGER                   :: zdim<a name='205'>
      END TYPE wrf_domain_metadata<a name='206'>
      TYPE(wrf_domain_metadata) :: dom_meta<a name='207'>
<a name='208'>
      TYPE wrf_global_metadata<a name='209'>
	 CHARACTER(LEN=80)         :: simulation_name<a name='210'>
	 CHARACTER(LEN=80)         :: user_desc<a name='211'>
	 INTEGER                   :: si_version<a name='212'>
	 INTEGER                   :: analysis_version  <a name='213'>
	 INTEGER                   :: wrf_version<a name='214'>
	 INTEGER                   :: post_version<a name='215'>
	 CHARACTER(LEN=32)         :: map_projection<a name='216'>
	 REAL                      :: moad_known_lat<a name='217'>
	 REAL                      :: moad_known_lon<a name='218'>
	 CHARACTER(LEN=8)          :: moad_known_loc<a name='219'>
	 REAL                      :: moad_stand_lats(max_standard_lats)<a name='220'>
	 REAL                      :: moad_stand_lons(max_standard_lons)<a name='221'>
	 REAL                      :: moad_delta_x<a name='222'>
	 REAL                      :: moad_delta_y<a name='223'>
	 CHARACTER(LEN=4)          :: horiz_stagger_type<a name='224'>
	 INTEGER                   :: num_stagger_xy<a name='225'>
	 REAL                      :: stagger_dir_x_new(max_staggers_xy_new)<a name='226'>
	 REAL                      :: stagger_dir_y_new(max_staggers_xy_new)<a name='227'>
	 REAL                      :: stagger_dir_x_old(max_staggers_xy_old)<a name='228'>
	 REAL                      :: stagger_dir_y_old(max_staggers_xy_old)<a name='229'>
	 INTEGER                   :: num_stagger_z    <a name='230'>
	 REAL                      :: stagger_dir_z(max_staggers_z)<a name='231'>
	 CHARACTER(LEN=8)          :: vertical_coord<a name='232'>
	 INTEGER                   :: num_domains<a name='233'>
	 INTEGER                   :: init_date<a name='234'>
	 REAL                      :: init_time<a name='235'>
	 INTEGER                   :: end_date<a name='236'>
	 REAL                      :: end_time<a name='237'>
	 CHARACTER(LEN=4)          :: lu_source<a name='238'>
	 INTEGER                   :: lu_water<a name='239'>
	 INTEGER                   :: lu_ice  <a name='240'>
      END TYPE wrf_global_metadata<a name='241'>
      TYPE(wrf_global_metadata)   :: global_meta<a name='242'>
<a name='243'>
CONTAINS<a name='244'>
<a name='245'>
<A NAME='READ_SI'><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='246'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>read_si</font> ( grid, file_date_string ) <A href='../../call_to/READ_SI.html' TARGET='index'>2</A>,<A href='../../call_from/READ_SI.html' TARGET='index'>20</A><a name='247'>
<a name='248'>
      USE <A href='../../html_code/share/module_soil_pre.F.html#MODULE_SOIL_PRE'>module_soil_pre</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SOIL_PRE_2"><a name='249'>
      USE <A href='../../html_code/frame/module_domain.F.html#MODULE_DOMAIN'>module_domain</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DOMAIN_44"><a name='250'>
<a name='251'>
      IMPLICIT NONE<a name='252'>
<a name='253'>
      TYPE(domain) , INTENT(INOUT)  :: grid<a name='254'>
      CHARACTER (LEN=19) , INTENT(IN) :: file_date_string<a name='255'>
<a name='256'>
      INTEGER :: ids,ide,jds,jde,kds,kde           &amp;<a name='257'>
                ,ims,ime,jms,jme,kms,kme           &amp;<a name='258'>
                ,its,ite,jts,jte,kts,kte<a name='259'>
<a name='260'>
      INTEGER :: i , j , k , loop, IMAX, JMAX<a name='261'>
<a name='262'>
      REAL :: dummy<a name='263'>
<a name='264'>
      CHARACTER (LEN= 8) :: dummy_char<a name='265'>
      CHARACTER (LEN=256) :: dummy_char_256<a name='266'>
<a name='267'>
      INTEGER :: ok , map_proj , ok_open<a name='268'>
      REAL :: pt<a name='269'>
      INTEGER :: num_veg_cat , num_soil_top_cat , num_soil_bot_cat<a name='270'>
<a name='271'>
      SELECT CASE ( model_data_order )<a name='272'>
         CASE ( DATA_ORDER_ZXY )<a name='273'>
            kds = grid%sd31 ; kde = grid%ed31 ;<a name='274'>
            ids = grid%sd32 ; ide = grid%ed32 ;<a name='275'>
            jds = grid%sd33 ; jde = grid%ed33 ;<a name='276'>
<a name='277'>
            kms = grid%sm31 ; kme = grid%em31 ;<a name='278'>
            ims = grid%sm32 ; ime = grid%em32 ;<a name='279'>
            jms = grid%sm33 ; jme = grid%em33 ;<a name='280'>
<a name='281'>
            kts = grid%sp31 ; kte = grid%ep31 ; <font color=#447700>! tile is entire patch<a name='282'></font>
            its = grid%sp32 ; ite = grid%ep32 ; <font color=#447700>! tile is entire patch<a name='283'></font>
            jts = grid%sp33 ; jte = grid%ep33 ; <font color=#447700>! tile is entire patch<a name='284'></font>
<a name='285'>
         CASE ( DATA_ORDER_XYZ )<a name='286'>
            ids = grid%sd31 ; ide = grid%ed31 ;<a name='287'>
            jds = grid%sd32 ; jde = grid%ed32 ;<a name='288'>
            kds = grid%sd33 ; kde = grid%ed33 ;<a name='289'>
<a name='290'>
            ims = grid%sm31 ; ime = grid%em31 ;<a name='291'>
            jms = grid%sm32 ; jme = grid%em32 ;<a name='292'>
            kms = grid%sm33 ; kme = grid%em33 ;<a name='293'>
<a name='294'>
            its = grid%sp31 ; ite = grid%ep31 ; <font color=#447700>! tile is entire patch<a name='295'></font>
            jts = grid%sp32 ; jte = grid%ep32 ; <font color=#447700>! tile is entire patch<a name='296'></font>
            kts = grid%sp33 ; kte = grid%ep33 ; <font color=#447700>! tile is entire patch<a name='297'></font>
<a name='298'>
         CASE ( DATA_ORDER_XZY )<a name='299'>
            ids = grid%sd31 ; ide = grid%ed31 ;<a name='300'>
            kds = grid%sd32 ; kde = grid%ed32 ;<a name='301'>
            jds = grid%sd33 ; jde = grid%ed33 ;<a name='302'>
<a name='303'>
            ims = grid%sm31 ; ime = grid%em31 ;<a name='304'>
            kms = grid%sm32 ; kme = grid%em32 ;<a name='305'>
            jms = grid%sm33 ; jme = grid%em33 ;<a name='306'>
<a name='307'>
            its = grid%sp31 ; ite = grid%ep31 ; <font color=#447700>! tile is entire patch<a name='308'></font>
            kts = grid%sp32 ; kte = grid%ep32 ; <font color=#447700>! tile is entire patch<a name='309'></font>
            jts = grid%sp33 ; jte = grid%ep33 ; <font color=#447700>! tile is entire patch<a name='310'></font>
<a name='311'>
      END SELECT<a name='312'>
<a name='313'>
      <font color=#447700>!  Initialize what soil temperature and moisture is available.<a name='314'></font>
<a name='315'>
<font color=#447700>!      write(0,*) 'dum3d I allocs: ', ids,ide-1<a name='316'></font>
<font color=#447700>!      write(0,*) 'dum3d J allocs: ', jds,jde-1<a name='317'></font>
<font color=#447700>!      write(0,*) 'dum3d K allocs: ', kds,kde-1<a name='318'></font>
<a name='319'>
      flag_st000010 = 0<a name='320'>
      flag_st010040 = 0<a name='321'>
      flag_st040100 = 0<a name='322'>
      flag_st100200 = 0<a name='323'>
      flag_sm000010 = 0 <a name='324'>
      flag_sm010040 = 0<a name='325'>
      flag_sm040100 = 0<a name='326'>
      flag_sm100200 = 0<a name='327'>
      flag_st010200 = 0<a name='328'>
      flag_sm010200 = 0<a name='329'>
<a name='330'>
      flag_soilt010 = 0<a name='331'>
      flag_soilt040 = 0<a name='332'>
      flag_soilt100 = 0<a name='333'>
      flag_soilt200 = 0 <a name='334'>
      flag_soilm010 = 0 <a name='335'>
      flag_soilm040 = 0<a name='336'>
      flag_soilm100 = 0<a name='337'>
      flag_soilm200 = 0<a name='338'>
<a name='339'>
      flag_sst      = 0<a name='340'>
      flag_toposoil = 0<a name='341'>
<a name='342'>
      <font color=#447700>!  How many soil levels have we found?  Well, right now, none.<a name='343'></font>
<a name='344'>
      num_st_levels_input = 0<a name='345'>
      num_sm_levels_input = 0<a name='346'>
      st_levels_input = -1<a name='347'>
      sm_levels_input = -1<a name='348'>
<a name='349'>
      <font color=#447700>!  Get the space for the data if this is the first time here.<a name='350'></font>
<a name='351'>
        write(6,*) 'enter read_si...first_time_in:: ', first_time_in<a name='352'>
<a name='353'>
      IF ( first_time_in ) THEN<a name='354'>
<a name='355'>
         CLOSE(12)<a name='356'>
         OPEN ( FILE   = 'real_input_nm.global.metadata' , &amp;<a name='357'>
                UNIT   = 12                              , &amp;<a name='358'>
                STATUS = 'OLD'                           , &amp;<a name='359'>
                ACCESS = 'SEQUENTIAL'                    , &amp;<a name='360'>
                FORM   = 'UNFORMATTED'                   , &amp;<a name='361'>
                IOSTAT = ok_open                           )<a name='362'>
<a name='363'>
         IF ( ok_open .NE. 0 ) THEN<a name='364'>
            PRINT '(A)','You asked for WRF SI data, but no real_input_nm.global.metadata file exists.'<a name='365'>
            STOP 'No_real_input_nm.global.metadata_exists'<a name='366'>
         END IF<a name='367'>
<a name='368'>
         READ(12) global_meta%simulation_name, global_meta%user_desc, &amp;<a name='369'>
                  global_meta%si_version, global_meta%analysis_version, &amp;<a name='370'>
                  global_meta%wrf_version, global_meta%post_version<a name='371'>
   <a name='372'>
         REWIND (12)<a name='373'>
<a name='374'>
         IF      ( global_meta%si_version .EQ. 1 ) THEN<a name='375'>
            READ(12) global_meta%simulation_name, global_meta%user_desc, &amp;<a name='376'>
                     global_meta%si_version, global_meta%analysis_version, &amp;<a name='377'>
                     global_meta%wrf_version, global_meta%post_version, &amp;<a name='378'>
                     global_meta%map_projection, global_meta%moad_known_lat, &amp;<a name='379'>
                     global_meta%moad_known_lon, global_meta%moad_known_loc, &amp;<a name='380'>
                     global_meta%moad_stand_lats, global_meta%moad_stand_lons, &amp;<a name='381'>
                     global_meta%moad_delta_x, global_meta%moad_delta_y, &amp;<a name='382'>
                     global_meta%horiz_stagger_type, global_meta%num_stagger_xy, &amp;<a name='383'>
                     global_meta%stagger_dir_x_old, global_meta%stagger_dir_y_old, &amp;<a name='384'>
                     global_meta%num_stagger_z, global_meta%stagger_dir_z, &amp;<a name='385'>
                     global_meta%vertical_coord, global_meta%num_domains, &amp;<a name='386'>
                     global_meta%init_date, global_meta%init_time, &amp;<a name='387'>
                     global_meta%end_date, global_meta%end_time<a name='388'>
         ELSE IF ( global_meta%si_version .EQ. 2 ) THEN<a name='389'>
            READ(12) global_meta%simulation_name, global_meta%user_desc, &amp;<a name='390'>
                     global_meta%si_version, global_meta%analysis_version, &amp;<a name='391'>
                     global_meta%wrf_version, global_meta%post_version, &amp;<a name='392'>
                     global_meta%map_projection, global_meta%moad_known_lat, &amp;<a name='393'>
                     global_meta%moad_known_lon, global_meta%moad_known_loc, &amp;<a name='394'>
                     global_meta%moad_stand_lats, global_meta%moad_stand_lons, &amp;<a name='395'>
                     global_meta%moad_delta_x, global_meta%moad_delta_y, &amp;<a name='396'>
                     global_meta%horiz_stagger_type, global_meta%num_stagger_xy, &amp;<a name='397'>
                     global_meta%stagger_dir_x_new, global_meta%stagger_dir_y_new, &amp;<a name='398'>
                     global_meta%num_stagger_z, global_meta%stagger_dir_z, &amp;<a name='399'>
                     global_meta%vertical_coord, global_meta%num_domains, &amp;<a name='400'>
                     global_meta%init_date, global_meta%init_time, &amp;<a name='401'>
                     global_meta%end_date, global_meta%end_time , &amp;<a name='402'>
                     global_meta%lu_source, global_meta%lu_water, global_meta%lu_ice<a name='403'>
         END IF<a name='404'>
         CLOSE (12)<a name='405'>
   <a name='406'>
         print *,'GLOBAL METADATA'<a name='407'>
         print *,'global_meta%simulation_name', global_meta%simulation_name<a name='408'>
         print *,'global_meta%user_desc', global_meta%user_desc<a name='409'>
         print *,'global_meta%user_desc', global_meta%user_desc<a name='410'>
         print *,'global_meta%si_version', global_meta%si_version<a name='411'>
         print *,'global_meta%analysis_version', global_meta%analysis_version<a name='412'>
         print *,'global_meta%wrf_version', global_meta%wrf_version<a name='413'>
         print *,'global_meta%post_version', global_meta%post_version<a name='414'>
         print *,'global_meta%map_projection', global_meta%map_projection<a name='415'>
         print *,'global_meta%moad_known_lat', global_meta%moad_known_lat<a name='416'>
         print *,'global_meta%moad_known_lon', global_meta%moad_known_lon<a name='417'>
         print *,'global_meta%moad_known_loc', global_meta%moad_known_loc<a name='418'>
         print *,'global_meta%moad_stand_lats', global_meta%moad_stand_lats<a name='419'>
         print *,'global_meta%moad_stand_lons', global_meta%moad_stand_lons<a name='420'>
         print *,'global_meta%moad_delta_x', global_meta%moad_delta_x<a name='421'>
         print *,'global_meta%moad_delta_y', global_meta%moad_delta_y<a name='422'>
         print *,'global_meta%horiz_stagger_type', global_meta%horiz_stagger_type<a name='423'>
         print *,'global_meta%num_stagger_xy', global_meta%num_stagger_xy<a name='424'>
         IF      ( global_meta%si_version .EQ. 1 ) THEN<a name='425'>
            print *,'global_meta%stagger_dir_x', global_meta%stagger_dir_x_old<a name='426'>
            print *,'global_meta%stagger_dir_y', global_meta%stagger_dir_y_old<a name='427'>
         ELSE IF ( global_meta%si_version .EQ. 2 ) THEN<a name='428'>
            print *,'global_meta%stagger_dir_x', global_meta%stagger_dir_x_new<a name='429'>
            print *,'global_meta%stagger_dir_y', global_meta%stagger_dir_y_new<a name='430'>
         END IF<a name='431'>
         print *,'global_meta%num_stagger_z', global_meta%num_stagger_z<a name='432'>
         print *,'global_meta%stagger_dir_z', global_meta%stagger_dir_z<a name='433'>
         print *,'global_meta%vertical_coord', global_meta%vertical_coord<a name='434'>
         print *,'global_meta%num_domains', global_meta%num_domains<a name='435'>
         print *,'global_meta%init_date', global_meta%init_date<a name='436'>
         print *,'global_meta%init_time', global_meta%init_time<a name='437'>
         print *,'global_meta%end_date', global_meta%end_date<a name='438'>
         print *,'global_meta%end_time', global_meta%end_time<a name='439'>
         IF ( global_meta%si_version .EQ. 2 ) THEN<a name='440'>
            print *,'global_meta%lu_source', global_meta%lu_source<a name='441'>
            print *,'global_meta%lu_water', global_meta%lu_water<a name='442'>
            print *,'global_meta%lu_ice', global_meta%lu_ice<a name='443'>
         END IF<a name='444'>
         print *,' '<a name='445'>
<a name='446'>
         <font color=#447700>!  1D - this is the definition of the vertical coordinate.<a name='447'></font>
<a name='448'>
        IF (.NOT. ALLOCATED (DETA_in)) ALLOCATE(DETA_in(kds:kde-1))<a name='449'>
        IF (.NOT. ALLOCATED (AETA_in)) ALLOCATE(AETA_in(kds:kde-1))<a name='450'>
        IF (.NOT. ALLOCATED (ETAX_in)) ALLOCATE(ETAX_in(kds:kde))<a name='451'>
<a name='452'>
        IF (.NOT. ALLOCATED (DETA1_in)) ALLOCATE(DETA1_in(kds:kde-1))<a name='453'>
        IF (.NOT. ALLOCATED (AETA1_in)) ALLOCATE(AETA1_in(kds:kde-1))<a name='454'>
        IF (.NOT. ALLOCATED (ETA1_in))  ALLOCATE(ETA1_in(kds:kde))<a name='455'>
<a name='456'>
        IF (.NOT. ALLOCATED (DETA2_in)) ALLOCATE(DETA2_in(kds:kde-1))<a name='457'>
        IF (.NOT. ALLOCATED (AETA2_in)) ALLOCATE(AETA2_in(kds:kde-1))<a name='458'>
        IF (.NOT. ALLOCATED (ETA2_in)) ALLOCATE(ETA2_in(kds:kde))<a name='459'>
<a name='460'>
        IF (.NOT. ALLOCATED (DFL_in)) ALLOCATE(DFL_in(kds:kde))<a name='461'>
<a name='462'>
         <font color=#447700>!  3D met<a name='463'></font>
<a name='464'>
        IF (.NOT. ALLOCATED (u_input)  ) ALLOCATE ( u_input(its:ite,jts:jte,kts:kte) )<a name='465'>
        IF (.NOT. ALLOCATED (v_input)  ) ALLOCATE ( v_input(its:ite,jts:jte,kts:kte) )<a name='466'>
        IF (.NOT. ALLOCATED (q_input)  ) ALLOCATE ( q_input(its:ite,jts:jte,kts:kte) )<a name='467'>
        IF (.NOT. ALLOCATED (t_input)  ) ALLOCATE ( t_input(its:ite,jts:jte,kts:kte) )<a name='468'>
        IF (.NOT. ALLOCATED (htm_in)  ) ALLOCATE ( htm_in(its:ite,jts:jte,kts:kte) )<a name='469'>
        IF (.NOT. ALLOCATED (vtm_in)  ) ALLOCATE ( vtm_in(its:ite,jts:jte,kts:kte) )<a name='470'>
<a name='471'>
        <font color=#447700>!  2D pressure fields<a name='472'></font>
<a name='473'>
        IF (.NOT. ALLOCATED (pmsl)              ) ALLOCATE ( pmsl(its:ite,jts:jte) )<a name='474'>
        IF (.NOT. ALLOCATED (psfc_in)           ) ALLOCATE ( psfc_in(its:ite,jts:jte) )<a name='475'>
<a name='476'>
        <font color=#447700>!  2D - for LSM, these are computed from the categorical precentage values.<a name='477'></font>
<a name='478'>
        <font color=#447700>!  2D - for LSM, the various soil temperature and moisture levels that are available.<a name='479'></font>
<a name='480'>
        IF (.NOT. ALLOCATED (st_inputx)) ALLOCATE (st_inputx(its:ite,jts:jte,num_st_levels_alloc))<a name='481'>
        IF (.NOT. ALLOCATED (sm_inputx)) ALLOCATE (sm_inputx(its:ite,jts:jte,num_st_levels_alloc))<a name='482'>
        IF (.NOT. ALLOCATED (sw_inputx)) ALLOCATE (sw_inputx(its:ite,jts:jte,num_st_levels_alloc))<a name='483'>
<a name='484'>
        IF (.NOT. ALLOCATED (soilt010_input)    ) ALLOCATE ( soilt010_input(its:ite,jts:jte) )<a name='485'>
        IF (.NOT. ALLOCATED (soilt040_input)    ) ALLOCATE ( soilt040_input(its:ite,jts:jte) )<a name='486'>
        IF (.NOT. ALLOCATED (soilt100_input)    ) ALLOCATE ( soilt100_input(its:ite,jts:jte) )<a name='487'>
        IF (.NOT. ALLOCATED (soilt200_input)    ) ALLOCATE ( soilt200_input(its:ite,jts:jte) )<a name='488'>
        IF (.NOT. ALLOCATED (soilm010_input)    ) ALLOCATE ( soilm010_input(its:ite,jts:jte) )<a name='489'>
        IF (.NOT. ALLOCATED (soilm040_input)    ) ALLOCATE ( soilm040_input(its:ite,jts:jte) )<a name='490'>
        IF (.NOT. ALLOCATED (soilm100_input)    ) ALLOCATE ( soilm100_input(its:ite,jts:jte) )<a name='491'>
        IF (.NOT. ALLOCATED (soilm200_input)    ) ALLOCATE ( soilm200_input(its:ite,jts:jte) )<a name='492'>
<a name='493'>
        IF (.NOT. ALLOCATED (lat_wind)          ) ALLOCATE (lat_wind(its:ite,jts:jte))<a name='494'>
        IF (.NOT. ALLOCATED (lon_wind)          ) ALLOCATE (lon_wind(its:ite,jts:jte))<a name='495'>
<a name='496'>
        <font color=#447700>!  Local arrays<a name='497'></font>
        IF (.NOT. ALLOCATED (dum2d)             ) ALLOCATE (dum2d(IDS:IDE-1,JDS:JDE-1))<a name='498'>
        IF (.NOT. ALLOCATED (idum2d)            ) ALLOCATE (idum2d(IDS:IDE-1,JDS:JDE-1))<a name='499'>
        IF (.NOT. ALLOCATED (dum3d)             ) ALLOCATE (dum3d(IDS:IDE-1,JDS:JDE-1,KDS:KDE-1))<a name='500'>
<a name='501'>
<a name='502'>
      END IF<a name='503'>
<a name='504'>
      CLOSE(13)<a name='505'>
<a name='506'>
      write(6,*) 'file_date_string: ', file_date_string<a name='507'>
      write(6,*) 'opening real_input_nm.d01.'//file_date_string//' as unit 13'<a name='508'>
      OPEN ( FILE   = 'real_input_nm.d01.'//file_date_string , &amp;<a name='509'>
             UNIT   = 13                                     , &amp;<a name='510'>
             STATUS = 'OLD'                                  , &amp;<a name='511'>
             ACCESS = 'SEQUENTIAL'                           , &amp;<a name='512'>
             FORM   = 'UNFORMATTED'                            )<a name='513'>
<a name='514'>
      IF      ( global_meta%si_version .EQ. 1 ) THEN<a name='515'>
         READ (13) dom_meta%id,dom_meta%parent_id,dom_meta%dyn_init_src,&amp;<a name='516'>
                   dom_meta%static_init_src, dom_meta%vt_date, dom_meta%vt_time, &amp;<a name='517'>
                   dom_meta%origin_parent_x, dom_meta%origin_parent_y, &amp;<a name='518'>
                   dom_meta%ratio_to_parent, dom_meta%delta_x, dom_meta%delta_y, &amp;<a name='519'>
                   dom_meta%top_level, dom_meta%origin_parent_z, &amp;<a name='520'>
                   dom_meta%corner_lats_old, dom_meta%corner_lons_old, dom_meta%xdim, &amp;<a name='521'>
                   dom_meta%ydim, dom_meta%zdim<a name='522'>
      ELSE IF ( global_meta%si_version .EQ. 2 ) THEN<a name='523'>
         READ (13) dom_meta%id,dom_meta%parent_id,dom_meta%dyn_init_src,&amp;<a name='524'>
                   dom_meta%static_init_src, dom_meta%vt_date, dom_meta%vt_time, &amp;<a name='525'>
                   dom_meta%origin_parent_x, dom_meta%origin_parent_y, &amp;<a name='526'>
                   dom_meta%ratio_to_parent, dom_meta%delta_x, dom_meta%delta_y, &amp;<a name='527'>
                   dom_meta%top_level, dom_meta%origin_parent_z, &amp;<a name='528'>
                   dom_meta%corner_lats_new, dom_meta%corner_lons_new, dom_meta%xdim, &amp;<a name='529'>
                   dom_meta%ydim, dom_meta%zdim<a name='530'>
      END IF<a name='531'>
<a name='532'>
      print *,'DOMAIN METADATA'<a name='533'>
      print *,'dom_meta%id=', dom_meta%id<a name='534'>
      print *,'dom_meta%parent_id=', dom_meta%parent_id<a name='535'>
      print *,'dom_meta%dyn_init_src=', dom_meta%dyn_init_src<a name='536'>
      print *,'dom_meta%static_init_src=', dom_meta%static_init_src<a name='537'>
      print *,'dom_meta%vt_date=', dom_meta%vt_date<a name='538'>
      print *,'dom_meta%vt_time=', dom_meta%vt_time<a name='539'>
      print *,'dom_meta%origin_parent_x=', dom_meta%origin_parent_x<a name='540'>
      print *,'dom_meta%origin_parent_y=', dom_meta%origin_parent_y<a name='541'>
      print *,'dom_meta%ratio_to_parent=', dom_meta%ratio_to_parent<a name='542'>
      print *,'dom_meta%delta_x=', dom_meta%delta_x<a name='543'>
      print *,'dom_meta%delta_y=', dom_meta%delta_y<a name='544'>
      print *,'dom_meta%top_level=', dom_meta%top_level<a name='545'>
      print *,'dom_meta%origin_parent_z=', dom_meta%origin_parent_z<a name='546'>
      IF      ( global_meta%si_version .EQ. 1 ) THEN<a name='547'>
         print *,'dom_meta%corner_lats=', dom_meta%corner_lats_old<a name='548'>
         print *,'dom_meta%corner_lons=', dom_meta%corner_lons_old<a name='549'>
      ELSE IF ( global_meta%si_version .EQ. 2 ) THEN<a name='550'>
         print *,'dom_meta%corner_lats=', dom_meta%corner_lats_new<a name='551'>
         print *,'dom_meta%corner_lons=', dom_meta%corner_lons_new<a name='552'>
      END IF<a name='553'>
      print *,'dom_meta%xdim=', dom_meta%xdim<a name='554'>
      print *,'dom_meta%ydim=', dom_meta%ydim<a name='555'>
      print *,'dom_meta%zdim=', dom_meta%zdim<a name='556'>
      print *,' '<a name='557'>
<a name='558'>
      <font color=#447700>!  A simple domain size test.<a name='559'></font>
    <a name='560'>
<a name='561'>
<font color=#447700>!!        relax constraint, as model namelist has +1 for i and j, while<a name='562'></font>
<font color=#447700>!!        si data has true dimensions<a name='563'></font>
<a name='564'>
      IF (  abs(dom_meta%xdim - (ide-1)) .gt. 1 &amp;<a name='565'>
       .OR. abs(dom_meta%ydim - (jde-1)) .gt. 1 &amp;<a name='566'>
       .OR. abs(dom_meta%zdim - (kde-1)) .gt. 1) THEN<a name='567'>
         PRINT '(A)','Namelist does not match the input data.'<a name='568'>
         PRINT '(A,3I5,A)','Namelist dimensions =',ide-1,jde-1,kde-1,'.'<a name='569'>
         PRINT '(A,3I5,A)','Input data dimensions =',dom_meta%xdim,dom_meta%ydim,dom_meta%zdim,'.'<a name='570'>
         STOP 'Wrong_data_size'<a name='571'>
      END IF<a name='572'>
<a name='573'>
      <font color=#447700>! How about the grid distance?  Is it the same as in the namelist?<a name='574'></font>
<a name='575'>
      IF        ( global_meta%si_version .EQ. 1 ) THEN<a name='576'>
         CALL nl_set_cen_lat ( grid%id , ( dom_meta%corner_lats_old(1,1) + dom_meta%corner_lats_old(2,1) +        &amp;<a name='577'>
                                        dom_meta%corner_lats_old(3,1) + dom_meta%corner_lats_old(4,1) ) * 0.25 ) <a name='578'>
      ELSE IF ( ( global_meta%si_version .EQ. 2 ) .AND. ( global_meta%moad_known_loc(1:6) .EQ. 'CENTER' ) ) THEN<a name='579'>
         CALL nl_set_cen_lat ( grid%id , global_meta%moad_known_lat )<a name='580'>
      ELSE IF   ( global_meta%si_version .EQ. 2 ) THEN<a name='581'>
         CALL nl_set_cen_lat ( grid%id , ( dom_meta%corner_lats_new(1,1) + dom_meta%corner_lats_new(2,1) +        &amp;<a name='582'>
                                        dom_meta%corner_lats_new(3,1) + dom_meta%corner_lats_new(4,1) ) * 0.25 ) <a name='583'>
      END IF<a name='584'>
<a name='585'>
<a name='586'>
<font color=#447700>!!!        might be trouble here<a name='587'></font>
<a name='588'>
      CALL nl_set_cen_lon ( grid%id , global_meta%moad_stand_lons(1) )<a name='589'>
<font color=#447700>!!!!!<a name='590'></font>
      write(6,*) 'set_cen_lat... global_meta%moad_stand_lats(1): ', global_meta%moad_stand_lats(1)<a name='591'>
      CALL nl_set_cen_lat ( grid%id , global_meta%moad_stand_lats(1) )<a name='592'>
<font color=#447700>!!!!!<a name='593'></font>
      CALL nl_set_truelat1 ( grid%id , global_meta%moad_stand_lats(1) )<a name='594'>
      CALL nl_set_truelat2 ( grid%id , global_meta%moad_stand_lats(2) )<a name='595'>
<a name='596'>
      pt = dom_meta%top_level<a name='597'>
<a name='598'>
      IF      ( global_meta%map_projection(1:17) .EQ. 'LAMBERT CONFORMAL'   ) THEN<a name='599'>
         map_proj = 1<a name='600'>
      ELSE IF ( global_meta%map_projection(1:19) .EQ. 'POLAR STEREOGRAPHIC' ) THEN<a name='601'>
         map_proj = 2<a name='602'>
      ELSE IF ( global_meta%map_projection(1: 8) .EQ. 'MERCATOR'            ) THEN<a name='603'>
         map_proj = 3<a name='604'>
      ELSE IF ( global_meta%map_projection(1:14) .EQ. 'ROTATED LATLON' ) THEN<a name='605'>
         map_proj = 203 <font color=#447700>!?<a name='606'></font>
      ELSE<a name='607'>
         PRINT '(A,A,A)','Undefined map projection: ',TRIM(global_meta%map_projection(1:20)),'.'<a name='608'>
         STOP 'Undefined_map_proj_si'<a name='609'>
      END IF<a name='610'>
      CALL nl_set_map_proj ( grid%id , map_proj ) <a name='611'>
     <a name='612'>
<font color=#447700>!      write(0,*) 'global_meta%si_version: ', global_meta%si_version<a name='613'></font>
<font color=#447700>!      write(0,*) 'global_meta%lu_source: ', global_meta%lu_source<a name='614'></font>
<font color=#447700>!      write(0,*) 'global_meta%lu_water: ', global_meta%lu_water<a name='615'></font>
      IF      ( global_meta%si_version .EQ. 1 ) THEN<a name='616'>
         CALL nl_set_mminlu (grid%id, 'USGS' )<a name='617'>
         CALL nl_set_iswater (grid%id, 16 )<a name='618'>
      ELSE IF ( global_meta%si_version .EQ. 2 ) THEN<a name='619'>
         CALL nl_set_mminlu ( grid%id, global_meta%lu_source )<a name='620'>
         CALL nl_set_iswater (grid%id, global_meta%lu_water )<a name='621'>
         CALL nl_set_isice (grid%id, global_meta%lu_ice )<a name='622'>
      END IF<a name='623'>
<a name='624'>
      CALL nl_set_gmt (grid%id, dom_meta%vt_time / 3600. )<a name='625'>
      CALL nl_set_julyr (grid%id, dom_meta%vt_date / 1000 )<a name='626'>
      CALL nl_set_julday (grid%id, dom_meta%vt_date - ( dom_meta%vt_date / 1000 ) * 1000 )<a name='627'>
<a name='628'>
      write(6,*) 'start reading from unit 13'<a name='629'>
      read_all_the_data : DO<a name='630'>
<a name='631'>
         READ (13,IOSTAT=OK) var_info%name, var_info%units, &amp;<a name='632'>
                             var_info%description, var_info%domain_id, var_info%ndim, &amp;<a name='633'>
                             var_info%dim_val, var_info%dim_desc, var_info%start_index, &amp;<a name='634'>
                             var_info%stop_index, var_info%h_stagger_index, var_info%v_stagger_index,&amp;<a name='635'>
                             var_info%array_order, var_info%field_type, var_info%field_source_prog, &amp;<a name='636'>
                             var_info%source_desc, var_info%field_time_type, var_info%vt_date_start, &amp;<a name='637'>
                             var_info%vt_time_start, var_info%vt_date_stop, var_info%vt_time_stop<a name='638'>
<a name='639'>
         IF ( OK .NE. 0 ) THEN<a name='640'>
            PRINT '(A,A,A)','End of file found for real_input_nm.d01.',file_date_string,'.'<a name='641'>
            EXIT read_all_the_data<a name='642'>
         END IF<a name='643'>
<a name='644'>
<font color=#447700>!        print *,'VARIABLE METADATA'<a name='645'></font>
         PRINT '(A,A)','var_info%name=', var_info%name <a name='646'>
<font color=#447700>!        print *,'var_info%units=', var_info%units <a name='647'></font>
<font color=#447700>!        print *,'var_info%description=', var_info%description <a name='648'></font>
<font color=#447700>!        print *,'var_info%domain_id=', var_info%domain_id <a name='649'></font>
<font color=#447700>!        print *,'var_info%ndim=', var_info%ndim <a name='650'></font>
<font color=#447700>!        print *,'var_info%dim_val=', var_info%dim_val <a name='651'></font>
<font color=#447700>!        print *,'var_info%dim_desc=', var_info%dim_desc <a name='652'></font>
<font color=#447700>!        print *,'var_info%start_index=', var_info%start_index <a name='653'></font>
<font color=#447700>!        print *,'var_info%stop_index=', var_info%stop_index <a name='654'></font>
<font color=#447700>!        print *,'var_info%h_stagger_index=', var_info%h_stagger_index <a name='655'></font>
<font color=#447700>!        print *,'var_info%v_stagger_index=', var_info%v_stagger_index<a name='656'></font>
<font color=#447700>!        print *,'var_info%array_order=', var_info%array_order <a name='657'></font>
<font color=#447700>!        print *,'var_info%field_type=', var_info%field_type <a name='658'></font>
<font color=#447700>!        print *,'var_info%field_source_prog=', var_info%field_source_prog <a name='659'></font>
<font color=#447700>!        print *,'var_info%source_desc=', var_info%source_desc <a name='660'></font>
<font color=#447700>!        print *,'var_info%field_time_type=', var_info%field_time_type <a name='661'></font>
<font color=#447700>!        print *,'var_info%vt_date_start=', var_info%vt_date_start <a name='662'></font>
<font color=#447700>!        print *,'var_info%vt_time_start=', var_info%vt_time_start <a name='663'></font>
<font color=#447700>!        print *,'var_info%vt_date_stop=', var_info%vt_date_stop <a name='664'></font>
<font color=#447700>!        print *,'var_info%vt_time_stop=', var_info%vt_time_stop<a name='665'></font>
<a name='666'>
        JMAX=min(JDE-1,JTE)<a name='667'>
        IMAX=min(IDE-1,ITE)<a name='668'>
         <font color=#447700>!  3D meteorological fields.<a name='669'></font>
<a name='670'>
<font color=#447700>!         write(0,*)' read_si var_info%name=',var_info%name(1:8)<a name='671'></font>
<a name='672'>
         IF      ( var_info%name(1:8) .EQ. 'T       ' ) THEN<a name='673'>
            READ (13) dum3d<a name='674'>
            do k=kts,kte-1<a name='675'>
            do j=jts,JMAX<a name='676'>
            do i=its,IMAX<a name='677'>
              t_input(i,j,k)=dum3d(i,j,k)<a name='678'>
            enddo<a name='679'>
            enddo<a name='680'>
            enddo<a name='681'>
<a name='682'>
         ELSE IF      ( var_info%name(1:8) .EQ. 'U       ' ) THEN<a name='683'>
            READ (13) dum3d<a name='684'>
            do k=kts,kte-1<a name='685'>
            do j=jts,JMAX<a name='686'>
            do i=its,IMAX<a name='687'>
              u_input(i,j,k)=dum3d(i,j,k)<a name='688'>
            enddo<a name='689'>
            enddo<a name='690'>
            enddo<a name='691'>
<a name='692'>
         ELSE IF ( var_info%name(1:8) .EQ. 'V       ' ) THEN<a name='693'>
            READ (13) dum3d<a name='694'>
            do k=kts,kte-1<a name='695'>
            do j=jts,JMAX<a name='696'>
            do i=its,IMAX<a name='697'>
              v_input(i,j,k)=dum3d(i,j,k)<a name='698'>
            enddo<a name='699'>
            enddo<a name='700'>
            enddo<a name='701'>
<a name='702'>
         ELSE IF ( var_info%name(1:8) .EQ. 'Q      ' ) THEN<a name='703'>
            READ (13) dum3d<a name='704'>
            do k=kts,kte-1<a name='705'>
            do j=jts,JMAX<a name='706'>
            do i=its,IMAX<a name='707'>
              q_input(i,j,k)=dum3d(i,j,k)<a name='708'>
            enddo<a name='709'>
            enddo<a name='710'>
            enddo<a name='711'>
<a name='712'>
         <font color=#447700>!  3D LSM fields.  Don't know the 3rd dimension until we read it in.<a name='713'></font>
<a name='714'>
         ELSE IF ( var_info%name(1:8) .EQ. 'LANDUSEF' ) THEN<a name='715'>
            IF ( ( first_time_in ) .AND. ( .NOT. ALLOCATED ( landuse_frac_input) ) ) THEN<a name='716'>
               ALLOCATE (landuse_frac_input(its:ite,jts:jte,var_info%dim_val(3)) )<a name='717'>
            END IF<a name='718'>
            READ (13) (((dum3d(i,j,k),i=ids,ide-1),j=jds,jde-1),k=1,var_info%dim_val(3))<a name='719'>
            do k=1,var_info%dim_val(3)<a name='720'>
            do j=jts,JMAX<a name='721'>
            do i=its,IMAX<a name='722'>
              landuse_frac_input(i,j,k)=dum3d(i,j,k)<a name='723'>
            enddo<a name='724'>
            enddo<a name='725'>
            enddo<a name='726'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SOILCTOP' ) THEN<a name='727'>
            IF ( ( first_time_in ) .AND. ( .NOT. ALLOCATED ( soil_top_cat_input) ) ) THEN<a name='728'>
               ALLOCATE (soil_top_cat_input(its:ite,jts:jte,var_info%dim_val(3)) )<a name='729'>
            END IF<a name='730'>
            READ (13) (((dum3d(i,j,k),i=ids,ide-1),j=jds,jde-1),k=1,var_info%dim_val(3))<a name='731'>
            do k=1,var_info%dim_val(3)<a name='732'>
            do j=jts,JMAX<a name='733'>
            do i=its,IMAX<a name='734'>
              soil_top_cat_input(i,j,k)=dum3d(i,j,k)<a name='735'>
            enddo<a name='736'>
            enddo<a name='737'>
            enddo<a name='738'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SOILCBOT' ) THEN<a name='739'>
            IF ( ( first_time_in ) .AND. ( .NOT. ALLOCATED ( soil_bot_cat_input) ) ) THEN<a name='740'>
               ALLOCATE (soil_bot_cat_input(its:ite,jts:jte,var_info%dim_val(3)) )<a name='741'>
            END IF<a name='742'>
            READ (13) (((dum3d(i,j,k),i=ids,ide-1),j=jds,jde-1),k=1,var_info%dim_val(3))<a name='743'>
            do k=1,var_info%dim_val(3)<a name='744'>
            do j=jts,JMAX<a name='745'>
            do i=its,IMAX<a name='746'>
              soil_bot_cat_input(i,j,k)=dum3d(i,j,k)<a name='747'>
            enddo<a name='748'>
            enddo<a name='749'>
            enddo<a name='750'>
<a name='751'>
         <font color=#447700>!  2D dry pressure minus ptop.<a name='752'></font>
<a name='753'>
         ELSE IF ( var_info%name(1:8) .EQ. 'PD      ' ) THEN<a name='754'>
            READ (13) dum2d<a name='755'>
            do j=jts,JMAX<a name='756'>
            do i=its,IMAX<a name='757'>
              grid%pd(i,j)=dum2d(i,j)<a name='758'>
            enddo<a name='759'>
            enddo<a name='760'>
         ELSE IF ( var_info%name(1:8) .EQ. 'PSFC    ' ) THEN<a name='761'>
            READ (13) dum2d<a name='762'>
            do j=jts,JMAX<a name='763'>
            do i=its,IMAX<a name='764'>
              psfc_in(i,j)=dum2d(i,j)<a name='765'>
            enddo<a name='766'>
            enddo<a name='767'>
         ELSE IF ( var_info%name(1:8) .EQ. 'PMSL    ' ) THEN<a name='768'>
            READ (13) dum2d<a name='769'>
            do j=jts,JMAX<a name='770'>
            do i=its,IMAX<a name='771'>
              pmsl(i,j)=dum2d(i,j)<a name='772'>
            enddo<a name='773'>
            enddo<a name='774'>
         ELSE IF ( var_info%name(1:8) .EQ. 'PDTOP   ' ) THEN<a name='775'>
            READ (13) grid%pdtop<a name='776'>
<a name='777'>
         ELSE IF ( var_info%name(1:8) .EQ. 'PT      ' ) THEN<a name='778'>
            READ (13) grid%pt<a name='779'>
<a name='780'>
         <font color=#447700>!  2D surface fields.<a name='781'></font>
<a name='782'>
        ELSE IF ( var_info%name(1:8) .eq. 'GLAT    ' ) THEN<a name='783'>
            READ (13) dum2d<a name='784'>
            do j=jts,JMAX<a name='785'>
            do i=its,IMAX<a name='786'>
              grid%glat(i,j)=dum2d(i,j)<a name='787'>
            enddo<a name='788'>
            enddo<a name='789'>
        ELSE IF ( var_info%name(1:8) .eq. 'GLON    ' ) THEN<a name='790'>
            READ (13) dum2d<a name='791'>
            do j=jts,JMAX<a name='792'>
            do i=its,IMAX<a name='793'>
              grid%glon(i,j)=dum2d(i,j)<a name='794'>
            enddo<a name='795'>
            enddo<a name='796'>
        ELSE IF ( var_info%name(1:8) .eq. 'LAT_V   ' ) THEN<a name='797'>
            READ (13) dum2d<a name='798'>
            do j=jts,JMAX<a name='799'>
            do i=its,IMAX<a name='800'>
              lat_wind(i,j)=dum2d(i,j)<a name='801'>
            enddo<a name='802'>
            enddo<a name='803'>
        ELSE IF ( var_info%name(1:8) .eq. 'LON_V   ' ) THEN<a name='804'>
            READ (13) dum2d<a name='805'>
            do j=jts,JMAX<a name='806'>
            do i=its,IMAX<a name='807'>
              lon_wind(i,j)=dum2d(i,j)<a name='808'>
            enddo<a name='809'>
            enddo<a name='810'>
<a name='811'>
         ELSE IF ( var_info%name(1:8) .EQ. 'ST000010' ) THEN<a name='812'>
            READ (13) dum2d<a name='813'>
            do j=jts,JMAX<a name='814'>
            do i=its,IMAX<a name='815'>
              grid%st000010(i,j)=dum2d(i,j)<a name='816'>
            enddo<a name='817'>
            enddo<a name='818'>
            flag_st000010 = 1<a name='819'>
            num_st_levels_input = num_st_levels_input + 1<a name='820'>
            st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_9">(var_info%name(3:8))<a name='821'>
            do j=jts,JMAX<a name='822'>
            do i=its,IMAX<a name='823'>
              st_inputx(I,J,num_st_levels_input + 1) = grid%st000010(i,j)<a name='824'>
            enddo<a name='825'>
            enddo<a name='826'>
<a name='827'>
         ELSE IF ( var_info%name(1:8) .EQ. 'ST010040' ) THEN<a name='828'>
            READ (13) dum2d<a name='829'>
            do j=jts,JMAX<a name='830'>
            do i=its,IMAX<a name='831'>
              grid%st010040(i,j)=dum2d(i,j)<a name='832'>
            enddo<a name='833'>
            enddo<a name='834'>
            flag_st010040 = 1<a name='835'>
            num_st_levels_input = num_st_levels_input + 1<a name='836'>
            st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_10">(var_info%name(3:8))<a name='837'>
            do j=jts,JMAX<a name='838'>
            do i=its,IMAX<a name='839'>
              st_inputx(I,J,num_st_levels_input + 1) = grid%st010040(i,j)<a name='840'>
            enddo<a name='841'>
            enddo<a name='842'>
<a name='843'>
         ELSE IF ( var_info%name(1:8) .EQ. 'ST040100' ) THEN<a name='844'>
            READ (13) dum2d<a name='845'>
            do j=jts,JMAX<a name='846'>
            do i=its,IMAX<a name='847'>
              grid%st040100(i,j)=dum2d(i,j)<a name='848'>
            enddo<a name='849'>
            enddo<a name='850'>
            flag_st040100 = 1<a name='851'>
            num_st_levels_input = num_st_levels_input + 1<a name='852'>
            st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_11">(var_info%name(3:8))<a name='853'>
            do j=jts,JMAX<a name='854'>
            do i=its,IMAX<a name='855'>
              st_inputx(I,J,num_st_levels_input + 1) = grid%st040100(i,j)<a name='856'>
            enddo<a name='857'>
            enddo<a name='858'>
<a name='859'>
         ELSE IF ( var_info%name(1:8) .EQ. 'ST100200' ) THEN<a name='860'>
            READ (13) dum2d<a name='861'>
            do j=jts,JMAX<a name='862'>
            do i=its,IMAX<a name='863'>
              grid%st100200(i,j)=dum2d(i,j)<a name='864'>
            enddo<a name='865'>
            enddo<a name='866'>
            flag_st100200 = 1<a name='867'>
            num_st_levels_input = num_st_levels_input + 1<a name='868'>
            st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_12">(var_info%name(3:8))<a name='869'>
            do j=jts,JMAX<a name='870'>
            do i=its,IMAX<a name='871'>
              st_inputx(I,J,num_st_levels_input + 1) = grid%st100200(i,j)<a name='872'>
            enddo<a name='873'>
            enddo<a name='874'>
<a name='875'>
         ELSE IF ( var_info%name(1:8) .EQ. 'ST010200' ) THEN<a name='876'>
            READ (13) dum2d<a name='877'>
            do j=jts,JMAX<a name='878'>
            do i=its,IMAX<a name='879'>
              grid%st010200(i,j)=dum2d(i,j)<a name='880'>
            enddo<a name='881'>
            enddo<a name='882'>
            flag_st010200 = 1<a name='883'>
            num_st_levels_input = num_st_levels_input + 1<a name='884'>
            st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_13">(var_info%name(3:8))<a name='885'>
            do j=jts,JMAX<a name='886'>
            do i=its,IMAX<a name='887'>
              st_inputx(I,J,num_st_levels_input + 1) = grid%st010200(i,j)<a name='888'>
            enddo<a name='889'>
            enddo<a name='890'>
<a name='891'>
        ELSE IF ( var_info%name(1:8) .EQ. 'SM000010' ) THEN<a name='892'>
            READ (13) dum2d<a name='893'>
            do j=jts,JMAX<a name='894'>
            do i=its,IMAX<a name='895'>
              grid%sm000010(i,j)=dum2d(i,j)<a name='896'>
            enddo<a name='897'>
            enddo<a name='898'>
            flag_sm000010 = 1<a name='899'>
            num_sm_levels_input = num_sm_levels_input + 1<a name='900'>
            sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_14">(var_info%name(3:8))<a name='901'>
            do j=jts,JMAX<a name='902'>
            do i=its,IMAX<a name='903'>
              sm_inputx(I,J,num_sm_levels_input + 1) = grid%sm000010(i,j)<a name='904'>
            enddo<a name='905'>
            enddo<a name='906'>
<a name='907'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SM010040' ) THEN<a name='908'>
            READ (13) dum2d<a name='909'>
            do j=jts,JMAX<a name='910'>
            do i=its,IMAX<a name='911'>
              grid%sm010040(i,j)=dum2d(i,j)<a name='912'>
            enddo<a name='913'>
            enddo<a name='914'>
            flag_sm010040 = 1<a name='915'>
            num_sm_levels_input = num_sm_levels_input + 1<a name='916'>
            sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_15">(var_info%name(3:8))<a name='917'>
            do j=jts,JMAX<a name='918'>
            do i=its,IMAX<a name='919'>
              sm_inputx(I,J,num_sm_levels_input + 1) = grid%sm010040(i,j)<a name='920'>
            enddo<a name='921'>
            enddo<a name='922'>
<a name='923'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SM040100' ) THEN<a name='924'>
            READ (13) dum2d<a name='925'>
            do j=jts,JMAX<a name='926'>
            do i=its,IMAX<a name='927'>
              grid%sm040100(i,j)=dum2d(i,j)<a name='928'>
            enddo<a name='929'>
            enddo<a name='930'>
            flag_sm040100 = 1<a name='931'>
            num_sm_levels_input = num_sm_levels_input + 1<a name='932'>
            sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_16">(var_info%name(3:8))<a name='933'>
            do j=jts,JMAX<a name='934'>
            do i=its,IMAX<a name='935'>
              sm_inputx(I,J,num_sm_levels_input + 1) = grid%sm040100(i,j)<a name='936'>
            enddo<a name='937'>
            enddo<a name='938'>
<a name='939'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SM100200' ) THEN<a name='940'>
            READ (13) dum2d<a name='941'>
            do j=jts,JMAX<a name='942'>
            do i=its,IMAX<a name='943'>
              grid%sm100200(i,j)=dum2d(i,j)<a name='944'>
            enddo<a name='945'>
            enddo<a name='946'>
            flag_sm100200 = 1<a name='947'>
            num_sm_levels_input = num_sm_levels_input + 1<a name='948'>
            sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_17">(var_info%name(3:8))<a name='949'>
            do j=jts,JMAX<a name='950'>
            do i=its,IMAX<a name='951'>
              sm_inputx(I,J,num_sm_levels_input + 1) = grid%sm100200(i,j)<a name='952'>
            enddo<a name='953'>
            enddo<a name='954'>
<a name='955'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SM010200' ) THEN<a name='956'>
            READ (13) dum2d<a name='957'>
            do j=jts,JMAX<a name='958'>
            do i=its,IMAX<a name='959'>
              grid%sm010200(i,j)=dum2d(i,j)<a name='960'>
            enddo<a name='961'>
            enddo<a name='962'>
            flag_sm010200 = 1<a name='963'>
            num_sm_levels_input = num_sm_levels_input + 1<a name='964'>
            sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_18">(var_info%name(3:8))<a name='965'>
            do j=jts,JMAX<a name='966'>
            do i=its,IMAX<a name='967'>
               sm_inputx(I,J,num_sm_levels_input + 1) = grid%sm010200(i,j)<a name='968'>
            enddo<a name='969'>
            enddo<a name='970'>
<a name='971'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SOILT010' ) THEN<a name='972'>
            READ (13) dum2d<a name='973'>
            do j=jts,JMAX<a name='974'>
            do i=its,IMAX<a name='975'>
              soilt010_input(i,j)=dum2d(i,j)<a name='976'>
            enddo<a name='977'>
            enddo<a name='978'>
            flag_soilt010 = 1<a name='979'>
            num_st_levels_input = num_st_levels_input + 1<a name='980'>
            st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT1'>char2int1</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT1_1">(var_info%name(6:8))<a name='981'>
<font color=#447700>!mp            st_inputx(:,:,num_st_levels_input + 1) = soilt010_input<a name='982'></font>
            do j=jts,JMAX<a name='983'>
            do i=its,IMAX<a name='984'>
              st_inputx(I,J,num_st_levels_input + 1) = soilt010_input(I,J)<a name='985'>
            enddo<a name='986'>
            enddo<a name='987'>
            write(6,*) 'num_st_levels_input=',num_st_levels_input<a name='988'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SOILT040' ) THEN<a name='989'>
            READ (13) dum2d<a name='990'>
            do j=jts,JMAX<a name='991'>
            do i=its,IMAX<a name='992'>
              soilt040_input(i,j)=dum2d(i,j)<a name='993'>
            enddo<a name='994'>
            enddo<a name='995'>
            flag_soilt040 = 1<a name='996'>
            num_st_levels_input = num_st_levels_input + 1<a name='997'>
            st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT1'>char2int1</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT1_2">(var_info%name(6:8))<a name='998'>
<font color=#447700>!mp            st_inputx(:,:,num_st_levels_input + 1) = soilt040_input<a name='999'></font>
            do j=jts,JMAX<a name='1000'>
            do i=its,IMAX<a name='1001'>
              st_inputx(I,J,num_st_levels_input + 1) = soilt040_input(I,J)<a name='1002'>
            enddo<a name='1003'>
            enddo<a name='1004'>
            write(6,*) 'num_st_levels_input=',num_st_levels_input<a name='1005'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SOILT100' ) THEN<a name='1006'>
            READ (13) dum2d<a name='1007'>
            do j=jts,JMAX<a name='1008'>
            do i=its,IMAX<a name='1009'>
              soilt100_input(i,j)=dum2d(i,j)<a name='1010'>
            enddo<a name='1011'>
            enddo<a name='1012'>
            flag_soilt100 = 1<a name='1013'>
            num_st_levels_input = num_st_levels_input + 1<a name='1014'>
            st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT1'>char2int1</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT1_3">(var_info%name(6:8))<a name='1015'>
<font color=#447700>!mp            st_inputx(:,:,num_st_levels_input + 1) = soilt100_input<a name='1016'></font>
            do j=jts,JMAX<a name='1017'>
            do i=its,IMAX<a name='1018'>
              st_inputx(I,J,num_st_levels_input + 1) = soilt100_input(I,J)<a name='1019'>
            enddo<a name='1020'>
            enddo<a name='1021'>
            write(6,*) 'num_st_levels_input=',num_st_levels_input<a name='1022'>
        ELSE IF ( var_info%name(1:8) .EQ. 'SOILT200' ) THEN<a name='1023'>
            READ (13) dum2d<a name='1024'>
            do j=jts,JMAX<a name='1025'>
            do i=its,IMAX<a name='1026'>
              soilt200_input(i,j)=dum2d(i,j)<a name='1027'>
            enddo<a name='1028'>
            enddo<a name='1029'>
            flag_soilt200 = 1<a name='1030'>
            num_st_levels_input = num_st_levels_input + 1<a name='1031'>
            st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT1'>char2int1</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT1_4">(var_info%name(6:8))<a name='1032'>
<font color=#447700>!mp            st_inputx(:,:,num_st_levels_input + 1) = soilt200_input<a name='1033'></font>
            do j=jts,JMAX<a name='1034'>
            do i=its,IMAX<a name='1035'>
              st_inputx(I,J,num_st_levels_input + 1) = soilt200_input(I,J)<a name='1036'>
            enddo<a name='1037'>
            enddo<a name='1038'>
            write(6,*) 'num_st_levels_input=',num_st_levels_input<a name='1039'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SOILM010' ) THEN<a name='1040'>
            READ (13) dum2d<a name='1041'>
            do j=jts,JMAX<a name='1042'>
            do i=its,IMAX<a name='1043'>
              soilm010_input(i,j)=dum2d(i,j)<a name='1044'>
            enddo<a name='1045'>
            enddo<a name='1046'>
            flag_soilm010 = 1<a name='1047'>
            num_sm_levels_input = num_sm_levels_input + 1<a name='1048'>
            sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT1'>char2int1</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT1_5">(var_info%name(6:8))<a name='1049'>
<font color=#447700>!mp            sm_inputx(:,:,num_sm_levels_input + 1) = soilm010_input<a name='1050'></font>
            do j=jts,JMAX<a name='1051'>
            do i=its,IMAX<a name='1052'>
              sm_inputx(I,J,num_sm_levels_input + 1) = soilm010_input(I,J)<a name='1053'>
            enddo<a name='1054'>
            enddo<a name='1055'>
<a name='1056'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SOILM040' ) THEN<a name='1057'>
            READ (13) dum2d<a name='1058'>
            do j=jts,JMAX<a name='1059'>
            do i=its,IMAX<a name='1060'>
              soilm040_input(i,j)=dum2d(i,j)<a name='1061'>
            enddo<a name='1062'>
            enddo<a name='1063'>
            flag_soilm040 = 1<a name='1064'>
            num_sm_levels_input = num_sm_levels_input + 1<a name='1065'>
            sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT1'>char2int1</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT1_6">(var_info%name(6:8))<a name='1066'>
<font color=#447700>!mp            sm_inputx(:,:,num_sm_levels_input + 1) = soilm040_input<a name='1067'></font>
            do j=jts,JMAX<a name='1068'>
            do i=its,IMAX<a name='1069'>
              sm_inputx(I,J,num_sm_levels_input + 1) = soilm040_input(I,J)<a name='1070'>
            enddo<a name='1071'>
            enddo<a name='1072'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SOILM100' ) THEN<a name='1073'>
            READ (13) dum2d<a name='1074'>
            do j=jts,JMAX<a name='1075'>
            do i=its,IMAX<a name='1076'>
              soilm100_input(i,j)=dum2d(i,j)<a name='1077'>
            enddo<a name='1078'>
            enddo<a name='1079'>
            flag_soilm100 = 1<a name='1080'>
            num_sm_levels_input = num_sm_levels_input + 1<a name='1081'>
            sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT1'>char2int1</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT1_7">(var_info%name(6:8))<a name='1082'>
<font color=#447700>!mp            sm_inputx(:,:,num_sm_levels_input + 1) = soilm100_input<a name='1083'></font>
            do j=jts,JMAX<a name='1084'>
            do i=its,IMAX<a name='1085'>
              sm_inputx(I,J,num_sm_levels_input + 1) = soilm100_input(I,J)<a name='1086'>
            enddo<a name='1087'>
            enddo<a name='1088'>
<a name='1089'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SOILM200' ) THEN<a name='1090'>
            READ (13) dum2d<a name='1091'>
            do j=jts,JMAX<a name='1092'>
            do i=its,IMAX<a name='1093'>
              soilm200_input(i,j)=dum2d(i,j)<a name='1094'>
            enddo<a name='1095'>
            enddo<a name='1096'>
            flag_soilm200 = 1<a name='1097'>
            num_sm_levels_input = num_sm_levels_input + 1<a name='1098'>
            sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT1'>char2int1</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_SI' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT1_8">(var_info%name(6:8))<a name='1099'>
<font color=#447700>!mp            sm_inputx(:,:,num_sm_levels_input + 1) = soilm200_input<a name='1100'></font>
            do j=jts,JMAX<a name='1101'>
            do i=its,IMAX<a name='1102'>
              sm_inputx(I,J,num_sm_levels_input + 1) = soilm200_input(I,J)<a name='1103'>
            enddo<a name='1104'>
            enddo<a name='1105'>
<a name='1106'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SEAICE  ' ) THEN<a name='1107'>
            READ (13) dum2d<a name='1108'>
            do j=jts,JMAX<a name='1109'>
            do i=its,IMAX<a name='1110'>
              grid%xice(i,j)=dum2d(i,j)<a name='1111'>
            enddo<a name='1112'>
            enddo<a name='1113'>
         ELSE IF ( var_info%name(1:8) .EQ. 'WEASD   ' ) THEN<a name='1114'>
            READ (13) dum2d<a name='1115'>
            do j=jts,JMAX<a name='1116'>
            do i=its,IMAX<a name='1117'>
              grid%weasd(i,j)=dum2d(i,j)<a name='1118'>
            enddo<a name='1119'>
            enddo<a name='1120'>
         ELSE IF ( var_info%name(1:8) .EQ. 'CANWAT  ' ) THEN<a name='1121'>
            READ (13) dum2d<a name='1122'>
            do j=jts,JMAX<a name='1123'>
            do i=its,IMAX<a name='1124'>
              grid%canwat(i,j)=dum2d(i,j)<a name='1125'>
            enddo<a name='1126'>
            enddo<a name='1127'>
         ELSE IF ( var_info%name(1:8) .EQ. 'LANDMASK' ) THEN<a name='1128'>
            READ (13) dum2d<a name='1129'>
            do j=jts,JMAX<a name='1130'>
            do i=its,IMAX<a name='1131'>
              grid%landmask(i,j)=dum2d(i,j)<a name='1132'>
            enddo<a name='1133'>
            enddo<a name='1134'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SKINTEMP' ) THEN<a name='1135'>
            READ (13) dum2d<a name='1136'>
            do j=jts,JMAX<a name='1137'>
            do i=its,IMAX<a name='1138'>
              grid%nmm_tsk(i,j)=dum2d(i,j)<a name='1139'>
            enddo<a name='1140'>
            enddo<a name='1141'>
         ELSE IF ( var_info%name(1:8) .EQ. 'TGROUND ' ) THEN<a name='1142'>
            READ (13) dum2d<a name='1143'>
            do j=jts,JMAX<a name='1144'>
            do i=its,IMAX<a name='1145'>
             grid%tg(i,j)=dum2d(i,j)<a name='1146'>
            enddo<a name='1147'>
            enddo<a name='1148'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SOILTB  ' ) THEN<a name='1149'>
            READ (13) dum2d<a name='1150'>
            do j=jts,JMAX<a name='1151'>
            do i=its,IMAX<a name='1152'>
             grid%soiltb(i,j)=dum2d(i,j)<a name='1153'>
            enddo<a name='1154'>
            enddo<a name='1155'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SST     ' ) THEN<a name='1156'>
            READ (13) dum2d<a name='1157'>
            do j=jts,JMAX<a name='1158'>
            do i=its,IMAX<a name='1159'>
               grid%sst(i,j)=dum2d(i,j)<a name='1160'>
            enddo<a name='1161'>
            enddo<a name='1162'>
            flag_sst = 1<a name='1163'>
         ELSE IF ( var_info%name(1:8) .EQ. 'GREENFRC' ) THEN<a name='1164'>
            READ (13) dum2d<a name='1165'>
            do j=jts,JMAX<a name='1166'>
            do i=its,IMAX<a name='1167'>
              grid%vegfrc(i,j)=dum2d(i,j)<a name='1168'>
            enddo<a name='1169'>
            enddo<a name='1170'>
         ELSE IF ( var_info%name(1:8) .EQ. 'ISLOPE  ' ) THEN<a name='1171'>
            READ (13) dum2d<a name='1172'>
            do j=jts,JMAX<a name='1173'>
            do i=its,IMAX<a name='1174'>
              grid%islope(i,j)=nint(dum2d(i,j))<a name='1175'>
            enddo<a name='1176'>
            enddo<a name='1177'>
         ELSE IF ( var_info%name(1:8) .EQ. 'GREENMAX' ) THEN<a name='1178'>
            READ (13) dum2d<a name='1179'>
            do j=jts,JMAX<a name='1180'>
            do i=its,IMAX<a name='1181'>
              grid%greenmax(i,j)=dum2d(i,j)<a name='1182'>
            enddo<a name='1183'>
            enddo<a name='1184'>
         ELSE IF ( var_info%name(1:8) .EQ. 'GREENMIN' ) THEN<a name='1185'>
            READ (13) dum2d<a name='1186'>
            do j=jts,JMAX<a name='1187'>
            do i=its,IMAX<a name='1188'>
               grid%greenmin(i,j)=dum2d(i,j)<a name='1189'>
            enddo<a name='1190'>
            enddo<a name='1191'>
         ELSE IF ( var_info%name(1:8) .EQ. 'FIS     ' ) THEN<a name='1192'>
            READ (13) dum2d<a name='1193'>
            do j=jts,JMAX<a name='1194'>
            do i=its,IMAX<a name='1195'>
              grid%fis(i,j)=dum2d(i,j)<a name='1196'>
            enddo<a name='1197'>
            enddo<a name='1198'>
        ELSE IF ( var_info%name(1:8) .EQ. 'Z0      ' ) THEN<a name='1199'>
<font color=#447700>!         ELSE IF ( var_info%name(1:8) .EQ. 'STDEV   ' ) THEN<a name='1200'></font>
            READ (13) dum2d<a name='1201'>
            do j=jts,JMAX<a name='1202'>
            do i=its,IMAX<a name='1203'>
              grid%z0(i,j)=dum2d(i,j)<a name='1204'>
            enddo<a name='1205'>
            enddo<a name='1206'>
         ELSE IF ( var_info%name(1:8) .EQ. 'CMC     ' ) THEN<a name='1207'>
            READ (13) dum2d<a name='1208'>
            do j=jts,JMAX<a name='1209'>
            do i=its,IMAX<a name='1210'>
              grid%cmc(i,j)=dum2d(i,j)<a name='1211'>
            enddo<a name='1212'>
            enddo<a name='1213'>
         ELSE IF ( var_info%name(1:8) .EQ. 'HTM     ' ) THEN<a name='1214'>
            READ (13) dum3d<a name='1215'>
            do k=kts,kte-1<a name='1216'>
            do j=jts,JMAX<a name='1217'>
            do i=its,IMAX<a name='1218'>
              htm_in(i,j,k)=dum3d(i,j,k)<a name='1219'>
            enddo<a name='1220'>
            enddo<a name='1221'>
            enddo<a name='1222'>
         ELSE IF ( var_info%name(1:8) .EQ. 'VTM     ' ) THEN<a name='1223'>
            READ (13) dum3d<a name='1224'>
            do k=kts,kte-1<a name='1225'>
            do j=jts,JMAX<a name='1226'>
            do i=its,IMAX<a name='1227'>
              vtm_in(i,j,k)=dum3d(i,j,k)<a name='1228'>
            enddo<a name='1229'>
            enddo<a name='1230'>
            enddo<a name='1231'>
         ELSE IF ( var_info%name(1:8) .EQ. 'SM      ' ) THEN<a name='1232'>
            READ (13) dum2d<a name='1233'>
            do j=jts,JMAX<a name='1234'>
            do i=its,IMAX<a name='1235'>
              grid%sm(i,j)=dum2d(i,j)<a name='1236'>
            enddo<a name='1237'>
            enddo<a name='1238'>
         ELSE IF ( var_info%name(1:8) .EQ. 'ALBASE  ' ) THEN<a name='1239'>
            READ (13) dum2d<a name='1240'>
            do j=jts,JMAX<a name='1241'>
            do i=its,IMAX<a name='1242'>
              grid%albase(i,j)=dum2d(i,j)<a name='1243'>
            enddo<a name='1244'>
            enddo<a name='1245'>
         ELSE IF ( var_info%name(1:8) .EQ. 'MXSNAL  ' ) THEN<a name='1246'>
            READ (13) dum2d<a name='1247'>
            do j=jts,JMAX<a name='1248'>
            do i=its,IMAX<a name='1249'>
              grid%mxsnal(i,j)=dum2d(i,j)<a name='1250'>
            enddo<a name='1251'>
            enddo<a name='1252'>
<a name='1253'>
         <font color=#447700>!  1D vertical coordinate.<a name='1254'></font>
<a name='1255'>
          ELSE IF ( var_info%name(1:8) .EQ. 'DETA    ' ) THEN<a name='1256'>
             READ(13) DETA_in<a name='1257'>
          ELSE IF ( var_info%name(1:8) .EQ. 'DETA1   ' ) THEN<a name='1258'>
             READ(13) DETA1_in<a name='1259'>
          ELSE IF ( var_info%name(1:8) .EQ. 'DETA2   ' ) THEN<a name='1260'>
             READ(13) DETA2_in<a name='1261'>
          ELSE IF ( var_info%name(1:8) .EQ. 'ETAX    ' ) THEN<a name='1262'>
             READ(13) ETAX_in<a name='1263'>
          ELSE IF ( var_info%name(1:8) .EQ. 'ETA1    ' ) THEN<a name='1264'>
             READ(13) ETA1_in<a name='1265'>
          ELSE IF ( var_info%name(1:8) .EQ. 'ETA2    ' ) THEN<a name='1266'>
             READ(13) ETA2_in<a name='1267'>
          ELSE IF ( var_info%name(1:8) .EQ. 'AETA    ' ) THEN<a name='1268'>
             READ(13) AETA_in<a name='1269'>
          ELSE IF ( var_info%name(1:8) .EQ. 'AETA1   ' ) THEN<a name='1270'>
             READ(13) AETA1_in<a name='1271'>
          ELSE IF ( var_info%name(1:8) .EQ. 'AETA2   ' ) THEN<a name='1272'>
             READ(13) AETA2_in<a name='1273'>
          ELSE IF ( var_info%name(1:8) .EQ. 'DFL     ' ) THEN<a name='1274'>
             READ(13) DFL_in<a name='1275'>
<a name='1276'>
<font color=#447700>!         ELSE IF ( var_info%name(1:8) .EQ. 'ETAPHALF' ) THEN<a name='1277'></font>
<font color=#447700>!            READ (13) etahalf<a name='1278'></font>
<font color=#447700>!         ELSE IF ( var_info%name(1:8) .EQ. 'ETAPFULL' ) THEN<a name='1279'></font>
<font color=#447700>!            READ (13) etafull<a name='1280'></font>
<a name='1281'>
         <font color=#447700>!  wrong input data.<a name='1282'></font>
<a name='1283'>
         ELSE IF ( var_info%name(1:8) .EQ. 'ZETAFULL' ) THEN<a name='1284'>
            PRINT '(A)','Oops, you put in the height data.'<a name='1285'>
            STOP 'this_is_mass_not_height'<a name='1286'>
 <a name='1287'>
<a name='1288'>
         <font color=#447700>!  Stuff that we do not want or need is just skipped over.<a name='1289'></font>
<a name='1290'>
         ELSE<a name='1291'>
print *,'------------------&gt; skipping ', var_info%name(1:8)<a name='1292'>
            READ (13) dummy<a name='1293'>
         END IF<a name='1294'>
<a name='1295'>
      END DO read_all_the_data<a name='1296'>
<a name='1297'>
      CLOSE (13)<a name='1298'>
<a name='1299'>
      first_time_in = .FALSE.<a name='1300'>
<a name='1301'>
<font color=#447700>!new<a name='1302'></font>
        sw_inputx=0.<a name='1303'>
<font color=#447700>!new<a name='1304'></font>
<a name='1305'>
      do k=kts,kte-1<a name='1306'>
      do j=jts,JMAX<a name='1307'>
      do i=its,IMAX<a name='1308'>
        grid%U(I,J,K)=U_input(I,J,K)<a name='1309'>
        grid%V(I,J,K)=V_input(I,J,K)<a name='1310'>
        grid%T(I,J,K)=T_input(I,J,K)<a name='1311'>
        grid%Q(I,J,K)=Q_input(I,J,K)<a name='1312'>
      enddo<a name='1313'>
      enddo<a name='1314'>
      enddo<a name='1315'>
<a name='1316'>
<font color=#447700>!      write(0,*) 'size sw_input: ', size(sw_input,dim=1),size(sw_input,dim=2),size(sw_input,dim=3)<a name='1317'></font>
<font color=#447700>!      write(0,*) 'size sw_inputx: ', size(sw_inputx,dim=1),size(sw_inputx,dim=2),size(sw_inputx,dim=3)<a name='1318'></font>
      sw_input=0.<a name='1319'>
<a name='1320'>
<font color=#447700>!        write(0,*) 'maxval st_inputx(1): ', maxval(st_input(:,:,1))<a name='1321'></font>
<font color=#447700>!        write(0,*) 'maxval st_inputx(2): ', maxval(st_input(:,:,2))<a name='1322'></font>
<font color=#447700>!        write(0,*) 'maxval st_inputx(3): ', maxval(st_input(:,:,3))<a name='1323'></font>
<font color=#447700>!        write(0,*) 'maxval st_inputx(4): ', maxval(st_input(:,:,4))<a name='1324'></font>
<a name='1325'>
<a name='1326'>
        do J=JTS,min(JDE-1,JTE)<a name='1327'>
         do K=1,num_st_levels_alloc<a name='1328'>
          do I=ITS,min(IDE-1,ITE)<a name='1329'>
             st_input(I,K,J)=st_inputx(I,J,K)<a name='1330'>
             sm_input(I,K,J)=sm_inputx(I,J,K)<a name='1331'>
             sw_input(I,K,J)=sw_inputx(I,J,K)<a name='1332'>
          enddo<a name='1333'>
         enddo<a name='1334'>
        enddo<a name='1335'>
<a name='1336'>
<font color=#447700>!        write(0,*) 'maxval st_input(1): ', maxval(st_input(:,1,:))<a name='1337'></font>
<font color=#447700>!        write(0,*) 'maxval st_input(2): ', maxval(st_input(:,2,:))<a name='1338'></font>
<font color=#447700>!        write(0,*) 'maxval st_input(3): ', maxval(st_input(:,3,:))<a name='1339'></font>
<font color=#447700>!        write(0,*) 'maxval st_input(4): ', maxval(st_input(:,4,:))<a name='1340'></font>
<a name='1341'>
<a name='1342'>
         num_veg_cat      = SIZE ( grid%landusef , DIM=2 )<a name='1343'>
         num_soil_top_cat = SIZE ( grid%soilctop , DIM=2 )<a name='1344'>
         num_soil_bot_cat = SIZE ( grid%soilcbot , DIM=2 )<a name='1345'>
<a name='1346'>
        do J=JTS,min(JDE-1,JTE)<a name='1347'>
         do K=1,num_soil_top_cat<a name='1348'>
          do I=ITS,min(IDE-1,ITE)<a name='1349'>
          grid%SOILCTOP(I,K,J)=soil_top_cat_input(I,J,K)<a name='1350'>
          grid%SOILCTOP_gc(I,J,K)=soil_top_cat_input(I,J,K)<a name='1351'>
          enddo<a name='1352'>
         enddo<a name='1353'>
        enddo<a name='1354'>
<a name='1355'>
        do J=JTS,min(JDE-1,JTE)<a name='1356'>
         do K=1,num_soil_bot_cat<a name='1357'>
          do I=ITS,min(IDE-1,ITE)<a name='1358'>
          grid%SOILCBOT(I,K,J)=soil_bot_cat_input(I,J,K)<a name='1359'>
          grid%SOILCBOT_gc(I,J,K)=soil_bot_cat_input(I,J,K)<a name='1360'>
          enddo<a name='1361'>
         enddo<a name='1362'>
        enddo<a name='1363'>
<a name='1364'>
        do J=JTS,min(JDE-1,JTE)<a name='1365'>
         do K=1,num_veg_cat<a name='1366'>
          do I=ITS,min(IDE-1,ITE)<a name='1367'>
          grid%LANDUSEF(I,K,J)=landuse_frac_input(I,J,K)<a name='1368'>
          grid%LANDUSEF_gc(I,J,K)=landuse_frac_input(I,J,K)<a name='1369'>
          enddo<a name='1370'>
         enddo<a name='1371'>
        enddo<a name='1372'>
<a name='1373'>
<a name='1374'>
      do K=KDS,KDE<a name='1375'>
        grid%ETAX(K)=ETAX_in(KDE-K+1)<a name='1376'>
        grid%ETA1(K)=ETA1_in(KDE-K+1)<a name='1377'>
        grid%ETA2(K)=ETA2_in(KDE-K+1)<a name='1378'>
        grid%DFL(K)=DFL_in(KDE-K+1)<a name='1379'>
      enddo<a name='1380'>
<a name='1381'>
      do K=KDS,KDE-1<a name='1382'>
        grid%DETA(K)=DETA_in(KDE-K)<a name='1383'>
        grid%DETA1(K)=DETA1_in(KDE-K)<a name='1384'>
        grid%DETA2(K)=DETA2_in(KDE-K)<a name='1385'>
        grid%AETA(K)=AETA_in(KDE-K)<a name='1386'>
        grid%AETA1(K)=AETA1_in(KDE-K)<a name='1387'>
        grid%AETA2(K)=AETA2_in(KDE-K)<a name='1388'>
      enddo<a name='1389'>
<a name='1390'>
   END SUBROUTINE read_si<a name='1391'>
<a name='1392'>
<font color=#447700>! ------------------------------------------------------------<a name='1393'></font>
<font color=#447700>! ------------------------------------------------------------<a name='1394'></font>
<font color=#447700>! ------------------------------------------------------------<a name='1395'></font>
<font color=#447700>! ------------------------------------------------------------<a name='1396'></font>
<font color=#447700>! ------------------------------------------------------------<a name='1397'></font>
<font color=#447700>! ------------------------------------------------------------<a name='1398'></font>
<a name='1399'>
#if defined ( NO_IEEE_MODULE )<a name='1400'>
<A NAME='READ_WPS'><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1401'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>read_wps</font> ( grid, filename, file_date_string, num_metgrid_levels ) <A href='../../call_to/READ_WPS.html' TARGET='index'>3</A>,<A href='../../call_from/READ_WPS.html' TARGET='index'>120</A><a name='1402'>
<a name='1403'>
      USE <A href='../../html_code/frame/module_domain.F.html#MODULE_DOMAIN'>module_domain</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DOMAIN_45"><a name='1404'>
<a name='1405'>
      IMPLICIT NONE<a name='1406'>
<a name='1407'>
#if defined(DM_PARALLEL) &amp;&amp; <font color=#447700>!defined(STUBMPI)<a name='1408'></font>
      INCLUDE "<A href='../../html_code/include/mpif.h.html'>mpif.h</A>"<A NAME="mpif.h_1"><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1409'>
#endif<a name='1410'>
<a name='1411'>
      TYPE(domain) ,       INTENT(INOUT)  :: grid<a name='1412'>
      CHARACTER (*) ,      INTENT(IN)     :: filename<a name='1413'>
      CHARACTER (LEN=19) , INTENT(IN)     :: file_date_string <font color=#447700>!not used<a name='1414'></font>
      INTEGER ,            INTENT(IN)     :: num_metgrid_levels<a name='1415'>
      <a name='1416'>
   END SUBROUTINE read_wps<a name='1417'>
#else<a name='1418'>
<A NAME='READ_WPS'><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='top_target'><IMG SRC="../../gif/bar_red.gif" border=0></A><a name='1419'>
   <font color=#993300>SUBROUTINE </font><font color=#cc0000>read_wps</font> ( grid, filename, file_date_string, num_metgrid_levels ) <A href='../../call_to/READ_WPS.html' TARGET='index'>3</A>,<A href='../../call_from/READ_WPS.html' TARGET='index'>120</A><a name='1420'>
<a name='1421'>
      USE <A href='../../html_code/share/module_soil_pre.F.html#MODULE_SOIL_PRE'>module_soil_pre</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_SOIL_PRE_3"><a name='1422'>
      USE <A href='../../html_code/frame/module_domain.F.html#MODULE_DOMAIN'>module_domain</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="MODULE_DOMAIN_46"><a name='1423'>
      USE module_io_int_idx, only: io_int_index, r_info<a name='1424'>
      USE module_io_int_read, only: io_int_fetch_data<a name='1425'>
<a name='1426'>
      IMPLICIT NONE<a name='1427'>
<a name='1428'>
#if defined(DM_PARALLEL) &amp;&amp; <font color=#447700>!defined(STUBMPI)<a name='1429'></font>
      INCLUDE "<A href='../../html_code/include/mpif.h.html'>mpif.h</A>"<A NAME="mpif.h_2"><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><a name='1430'>
#endif<a name='1431'>
<a name='1432'>
      TYPE(domain) ,       INTENT(INOUT)  :: grid<a name='1433'>
      CHARACTER (*) ,      INTENT(IN)     :: filename<a name='1434'>
      CHARACTER (LEN=19) , INTENT(IN)     :: file_date_string <font color=#447700>!not used<a name='1435'></font>
      INTEGER ,            INTENT(IN)     :: num_metgrid_levels<a name='1436'>
      CHARACTER (LEN=19)              :: VarName<a name='1437'>
      CHARACTER (LEN=150)             :: chartemp<a name='1438'>
      CHARACTER (LEN=256)             :: mminlu_loc, message<a name='1439'>
<a name='1440'>
      INTEGER :: ids,ide,jds,jde,kds,kde, &amp;<a name='1441'>
                 ims,ime,jms,jme,kms,kme, &amp;<a name='1442'>
                 its,ite,jts,jte,kts,kte<a name='1443'>
<a name='1444'>
      INTEGER :: i , j , k , IMAX, JMAX<a name='1445'>
      INTEGER :: iunit, ierr<a name='1446'>
<a name='1447'>
      REAL    :: garb<a name='1448'>
      INTEGER :: igarb<a name='1449'>
      INTEGER :: num_veg_cat, num_gfrac, &amp;<a name='1450'>
                 num_soil_top_cat , num_soil_bot_cat<a name='1451'>
<a name='1452'>
      type(r_info), pointer :: r(:) =&gt; NULL()<a name='1453'>
<a name='1454'>
<a name='1455'>
      CALL <A href='../../html_code/frame/module_domain.F.html#GET_IJK_FROM_GRID'>get_ijk_from_grid</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="GET_IJK_FROM_GRID_13"> (grid ,                        &amp;<a name='1456'>
                              ids, ide, jds, jde, kds, kde, &amp;<a name='1457'>
                              ims, ime, jms, jme, kms, kme, &amp;<a name='1458'>
                              its, ite, jts, jte, kts, kte  )<a name='1459'>
      IMAX=min(IDE-1,ITE)<a name='1460'>
      JMAX=min(JDE-1,JTE)<a name='1461'>
<a name='1462'>
      mminlu_loc=''<a name='1463'>
<a name='1464'>
      <font color=#447700>!  Initialize what soil temperature and moisture is available.<a name='1465'></font>
      flag_st000010 = 0<a name='1466'>
      flag_st010040 = 0<a name='1467'>
      flag_st010200 = 0<a name='1468'>
      flag_st040100 = 0<a name='1469'>
      flag_st100200 = 0<a name='1470'>
<a name='1471'>
      flag_sm000010 = 0<a name='1472'>
      flag_sm010040 = 0<a name='1473'>
      flag_sm010200 = 0<a name='1474'>
      flag_sm040100 = 0<a name='1475'>
      flag_sm100200 = 0<a name='1476'>
<a name='1477'>
      flag_soilt010 = 0<a name='1478'>
      flag_soilt040 = 0<a name='1479'>
      flag_soilt100 = 0<a name='1480'>
      flag_soilt200 = 0<a name='1481'>
<a name='1482'>
      flag_soilm010 = 0<a name='1483'>
      flag_soilm040 = 0<a name='1484'>
      flag_soilm100 = 0<a name='1485'>
      flag_soilm200 = 0<a name='1486'>
<a name='1487'>
      flag_sst      = 0<a name='1488'>
      flag_toposoil = 0<a name='1489'>
<a name='1490'>
      <font color=#447700>!  How many soil levels have we found?  Well, right now, none.<a name='1491'></font>
      num_st_levels_input = 0<a name='1492'>
      num_sm_levels_input = 0<a name='1493'>
      st_levels_input = -1<a name='1494'>
      sm_levels_input = -1<a name='1495'>
<a name='1496'>
      num_soil_top_cat = SIZE(grid%soilctop_gc, DIM=3)<a name='1497'>
      num_soil_bot_cat = SIZE(grid%soilcbot_gc, DIM=3)<a name='1498'>
      num_gfrac        = SIZE(grid%greenfrac_gc, DIM=3)<a name='1499'>
<a name='1500'>
      <font color=#447700>!  Get the space for the data if this is the first time here.<a name='1501'></font>
<a name='1502'>
      IF (.NOT. ALLOCATED (pmsl)              ) ALLOCATE ( pmsl(its:ite,jts:jte) )<a name='1503'>
      IF (.NOT. ALLOCATED (psfc_in)           ) ALLOCATE ( psfc_in(its:ite,jts:jte) )<a name='1504'>
      IF (.NOT. ALLOCATED (st_inputx)) ALLOCATE (st_inputx(its:ite,jts:jte,num_st_levels_alloc))<a name='1505'>
      IF (.NOT. ALLOCATED (sm_inputx)) ALLOCATE (sm_inputx(its:ite,jts:jte,num_st_levels_alloc))<a name='1506'>
      IF (.NOT. ALLOCATED (sw_inputx)) ALLOCATE (sw_inputx(its:ite,jts:jte,num_st_levels_alloc))<a name='1507'>
      IF (.NOT. ALLOCATED (soilt010_input)    ) ALLOCATE ( soilt010_input(its:ite,jts:jte) )<a name='1508'>
      IF (.NOT. ALLOCATED (soilt040_input)    ) ALLOCATE ( soilt040_input(its:ite,jts:jte) )<a name='1509'>
      IF (.NOT. ALLOCATED (soilt100_input)    ) ALLOCATE ( soilt100_input(its:ite,jts:jte) )<a name='1510'>
      IF (.NOT. ALLOCATED (soilt200_input)    ) ALLOCATE ( soilt200_input(its:ite,jts:jte) )<a name='1511'>
      IF (.NOT. ALLOCATED (soilm010_input)    ) ALLOCATE ( soilm010_input(its:ite,jts:jte) )<a name='1512'>
      IF (.NOT. ALLOCATED (soilm040_input)    ) ALLOCATE ( soilm040_input(its:ite,jts:jte) )<a name='1513'>
      IF (.NOT. ALLOCATED (soilm100_input)    ) ALLOCATE ( soilm100_input(its:ite,jts:jte) )<a name='1514'>
      IF (.NOT. ALLOCATED (soilm200_input)    ) ALLOCATE ( soilm200_input(its:ite,jts:jte) )<a name='1515'>
<a name='1516'>
      <font color=#447700>! Create an index for the file<a name='1517'></font>
      call io_int_index(filename, r, ierr)<a name='1518'>
      if (ierr .ne. 0) then<a name='1519'>
          call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL'>wrf_error_fatal</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL_92">("Error obtaining index")<a name='1520'>
          return<a name='1521'>
      end if<a name='1522'>
<a name='1523'>
#if defined(DM_PARALLEL) &amp;&amp; <font color=#447700>!defined(STUBMPI)<a name='1524'></font>
      call mpi_file_open(mpi_comm_world, trim(filename), &amp;<a name='1525'>
                         mpi_mode_rdonly, mpi_info_null, &amp;<a name='1526'>
                         iunit, ierr)<a name='1527'>
      if (ierr /= 0) then<a name='1528'>
          write(message,*) 'Error opening ', trim(filename), &amp;<a name='1529'>
                           'with MPI IO code: ', ierr<a name='1530'>
          call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL3'>wrf_error_fatal3</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL3_1">(__FILE__, __LINE__, message)<a name='1531'>
      end if<a name='1532'>
#else<a name='1533'>
      iunit = 33<a name='1534'>
      open(unit=iunit, file=trim(filename), iostat=ierr, &amp;<a name='1535'>
           access='stream')<a name='1536'>
      if (ierr /= 0) then<a name='1537'>
          write(message,*) 'Error opening ', trim(filename), &amp;<a name='1538'>
                           'with stream access: ', ierr<a name='1539'>
          call <A href='../../html_code/frame/module_wrf_error.F.html#WRF_ERROR_FATAL3'>wrf_error_fatal3</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="WRF_ERROR_FATAL3_2">(__FILE__, __LINE__, message)<a name='1540'>
      end if<a name='1541'>
#endif<a name='1542'>
<a name='1543'>
      call io_int_fetch_data(iunit, r, 'CEN_LAT', garb, ierr)<a name='1544'>
      call nl_set_cen_lat(grid%id , garb)<a name='1545'>
<a name='1546'>
      call io_int_fetch_data(iunit, r, 'CEN_LON', garb, ierr)<a name='1547'>
      call nl_set_cen_lon(grid%id , garb)<a name='1548'>
      call nl_set_stand_lon(grid%id , garb)<a name='1549'>
<a name='1550'>
      call io_int_fetch_data(iunit, r, 'TRUELAT1', garb, ierr)<a name='1551'>
      call nl_set_truelat1(grid%id , garb)<a name='1552'>
<a name='1553'>
      call io_int_fetch_data(iunit, r, 'TRUELAT2', garb, ierr)<a name='1554'>
      call nl_set_truelat2(grid%id , garb)<a name='1555'>
<a name='1556'>
      call io_int_fetch_data(iunit, r, 'MAP_PROJ', igarb, ierr)<a name='1557'>
      call nl_set_map_proj(grid%id , igarb)<a name='1558'>
<a name='1559'>
      call io_int_fetch_data(iunit, r, 'NUM_LAND_CAT', num_veg_cat, ierr)<a name='1560'>
<a name='1561'>
      call io_int_fetch_data(iunit, r, 'ISWATER', igarb, ierr)<a name='1562'>
      call nl_set_iswater(grid%id, igarb)<a name='1563'>
<a name='1564'>
      call io_int_fetch_data(iunit, r, 'ISICE', igarb, ierr)<a name='1565'>
      call nl_set_isice(grid%id, igarb)<a name='1566'>
<a name='1567'>
      call io_int_fetch_data(iunit, r, 'ISLAKE', igarb, ierr)<a name='1568'>
      call nl_set_islake(grid%id, igarb)<a name='1569'>
<a name='1570'>
      call io_int_fetch_data(iunit, r, 'FLAG_SNOWH', flag_snowh, ierr)<a name='1571'>
<a name='1572'>
      call io_int_fetch_data(iunit, r, 'MMINLU', mminlu_loc, ierr)<a name='1573'>
      call nl_set_mminlu(grid%id, mminlu_loc)<a name='1574'>
<a name='1575'>
<font color=#447700>!      call io_int_fetch_data(iunit, 'NUM_METGRID_SOIL_LEVELS', igarb, ierr)<a name='1576'></font>
<a name='1577'>
      call io_int_fetch_data(iunit, r, 'PRES', &amp;<a name='1578'>
                         grid%p_gc(its:imax, jts:jmax, kts:num_metgrid_levels),&amp;<a name='1579'>
                         ierr)<a name='1580'>
<a name='1581'>
      call io_int_fetch_data(iunit, r, 'GHT', &amp;<a name='1582'>
                       grid%ght_gc(its:imax, jts:jmax, kts:num_metgrid_levels),&amp;<a name='1583'>
                         ierr)<a name='1584'>
<a name='1585'>
      call io_int_fetch_data(iunit, r, 'SNOWH', &amp;<a name='1586'>
                         grid%snowh(its:imax, jts:jmax), &amp;<a name='1587'>
                         ierr)<a name='1588'>
<a name='1589'>
      call io_int_fetch_data(iunit, r, 'SNOW', &amp;<a name='1590'>
                         grid%snow(its:imax, jts:jmax), &amp;<a name='1591'>
                         ierr)<a name='1592'>
<a name='1593'>
      call io_int_fetch_data(iunit, r, 'SKINTEMP', &amp;<a name='1594'>
                         grid%tsk_gc(its:imax, jts:jmax), &amp;<a name='1595'>
                         ierr)<a name='1596'>
<a name='1597'>
      call io_int_fetch_data(iunit, r, 'SOILHGT', &amp;<a name='1598'>
                         grid%toposoil(its:imax, jts:jmax), &amp;<a name='1599'>
                         ierr)<a name='1600'>
<a name='1601'>
      call io_int_fetch_data(iunit, r, 'SEAICE', &amp;<a name='1602'>
                         grid%xice_gc(its:imax, jts:jmax), &amp;<a name='1603'>
                         ierr)<a name='1604'>
<a name='1605'>
      call io_int_fetch_data(iunit, r, 'ST100200', &amp;<a name='1606'>
                         grid%st100200(its:imax, jts:jmax), &amp;<a name='1607'>
                         ierr)<a name='1608'>
<a name='1609'>
      call io_int_fetch_data(iunit, r, 'ST040100', &amp;<a name='1610'>
                         grid%st040100(its:imax, jts:jmax), &amp;<a name='1611'>
                         ierr)<a name='1612'>
<a name='1613'>
      call io_int_fetch_data(iunit, r, 'ST010040', &amp;<a name='1614'>
                         grid%st010040(its:imax, jts:jmax), &amp;<a name='1615'>
                         ierr)<a name='1616'>
<a name='1617'>
      call io_int_fetch_data(iunit, r, 'ST000010', &amp;<a name='1618'>
                         grid%st000010(its:imax, jts:jmax), &amp;<a name='1619'>
                         ierr)<a name='1620'>
<a name='1621'>
      call io_int_fetch_data(iunit, r, 'SM100200', &amp;<a name='1622'>
                         grid%sm100200(its:imax, jts:jmax), &amp;<a name='1623'>
                         ierr)<a name='1624'>
<a name='1625'>
      call io_int_fetch_data(iunit, r, 'SM040100', &amp;<a name='1626'>
                         grid%sm040100(its:imax, jts:jmax), &amp;<a name='1627'>
                         ierr)<a name='1628'>
<a name='1629'>
      call io_int_fetch_data(iunit, r, 'SM010040', &amp;<a name='1630'>
                         grid%sm010040(its:imax, jts:jmax), &amp;<a name='1631'>
                         ierr)<a name='1632'>
<a name='1633'>
      call io_int_fetch_data(iunit, r, 'SM000010', &amp;<a name='1634'>
                         grid%sm000010(its:imax, jts:jmax), &amp;<a name='1635'>
                         ierr)<a name='1636'>
<a name='1637'>
      call io_int_fetch_data(iunit, r, 'PSFC', &amp;<a name='1638'>
                         grid%psfc(its:imax, jts:jmax), &amp;<a name='1639'>
                         ierr)<a name='1640'>
<a name='1641'>
      call io_int_fetch_data(iunit, r, 'RH', &amp;<a name='1642'>
                       grid%rh_gc(its:imax, jts:jmax, kts:num_metgrid_levels),&amp;<a name='1643'>
                         ierr)<a name='1644'>
<a name='1645'>
      call io_int_fetch_data(iunit, r, 'VV', &amp;<a name='1646'>
                       grid%v_gc(its:imax, jts:jmax, kts:num_metgrid_levels),&amp;<a name='1647'>
                         ierr)<a name='1648'>
<a name='1649'>
      call io_int_fetch_data(iunit, r, 'UU', &amp;<a name='1650'>
                       grid%u_gc(its:imax, jts:jmax, kts:num_metgrid_levels),&amp;<a name='1651'>
                         ierr)<a name='1652'>
<a name='1653'>
      call io_int_fetch_data(iunit, r, 'TT', &amp;<a name='1654'>
                       grid%t_gc(its:imax, jts:jmax, kts:num_metgrid_levels),&amp;<a name='1655'>
                         ierr)<a name='1656'>
<a name='1657'>
      call io_int_fetch_data(iunit, r, 'SLOPECAT', &amp;<a name='1658'>
                         grid%slopecat(its:imax, jts:jmax), &amp;<a name='1659'>
                         ierr)<a name='1660'>
<a name='1661'>
      call io_int_fetch_data(iunit, r, 'SNOALB', &amp;<a name='1662'>
                         grid%snoalb(its:imax, jts:jmax), &amp;<a name='1663'>
                         ierr)<a name='1664'>
<a name='1665'>
      call io_int_fetch_data(iunit, r, 'GREENFRAC', &amp;<a name='1666'>
                         grid%greenfrac_gc(its:imax, jts:jmax, kts:num_gfrac), &amp;<a name='1667'>
                         ierr)<a name='1668'>
<a name='1669'>
      call io_int_fetch_data(iunit, r, 'ALBEDO12M', &amp;<a name='1670'>
                         grid%albedo12m_gc(its:imax, jts:jmax, kts:num_gfrac), &amp;<a name='1671'>
                         ierr)<a name='1672'>
<a name='1673'>
      call io_int_fetch_data(iunit, r, 'SOILCBOT', &amp;<a name='1674'>
                  grid%soilcbot_gc(its:imax, jts:jmax, kts:num_soil_bot_cat),&amp;<a name='1675'>
                         ierr)<a name='1676'>
<a name='1677'>
      call io_int_fetch_data(iunit, r, 'SOILCTOP', &amp;<a name='1678'>
                    grid%soilctop_gc(its:imax, jts:jmax, kts:num_soil_bot_cat),&amp;<a name='1679'>
                         ierr)<a name='1680'>
<a name='1681'>
      call io_int_fetch_data(iunit, r, 'SOILTEMP', &amp;<a name='1682'>
                         grid%tmn_gc(its:imax, jts:jmax), &amp;<a name='1683'>
                         ierr)<a name='1684'>
<a name='1685'>
      call io_int_fetch_data(iunit, r, 'HGT_V', &amp;<a name='1686'>
                         grid%htv_gc(its:imax, jts:jmax), &amp;<a name='1687'>
                         ierr)<a name='1688'>
<a name='1689'>
      call io_int_fetch_data(iunit, r, 'HGT_M', &amp;<a name='1690'>
                         grid%ht_gc(its:imax, jts:jmax), &amp;<a name='1691'>
                         ierr)<a name='1692'>
<a name='1693'>
      call io_int_fetch_data(iunit, r, 'HZMAX', &amp;<a name='1694'>
                         grid%hzmax(its:imax, jts:jmax), &amp;<a name='1695'>
                         ierr)<a name='1696'>
<a name='1697'>
      call io_int_fetch_data(iunit, r, 'HANGL', &amp;<a name='1698'>
                         grid%hangl(its:imax, jts:jmax), &amp;<a name='1699'>
                         ierr)<a name='1700'>
<a name='1701'>
      call io_int_fetch_data(iunit, r, 'HSLOP', &amp;<a name='1702'>
                         grid%hslop(its:imax, jts:jmax), &amp;<a name='1703'>
                         ierr)<a name='1704'>
<a name='1705'>
      call io_int_fetch_data(iunit, r, 'HLENNW', &amp;<a name='1706'>
                         grid%hlennw(its:imax, jts:jmax), &amp;<a name='1707'>
                         ierr)<a name='1708'>
<a name='1709'>
      call io_int_fetch_data(iunit, r, 'HLENSW', &amp;<a name='1710'>
                         grid%hlensw(its:imax, jts:jmax), &amp;<a name='1711'>
                         ierr)<a name='1712'>
<a name='1713'>
      call io_int_fetch_data(iunit, r, 'HLENS', &amp;<a name='1714'>
                         grid%hlens(its:imax, jts:jmax), &amp;<a name='1715'>
                         ierr)<a name='1716'>
<a name='1717'>
      call io_int_fetch_data(iunit, r, 'HLENW', &amp;<a name='1718'>
                         grid%hlenw(its:imax, jts:jmax), &amp;<a name='1719'>
                         ierr)<a name='1720'>
<a name='1721'>
      call io_int_fetch_data(iunit, r, 'HASYNW', &amp;<a name='1722'>
                         grid%hasynw(its:imax, jts:jmax), &amp;<a name='1723'>
                         ierr)<a name='1724'>
<a name='1725'>
      call io_int_fetch_data(iunit, r, 'HASYSW', &amp;<a name='1726'>
                         grid%hasysw(its:imax, jts:jmax), &amp;<a name='1727'>
                         ierr)<a name='1728'>
<a name='1729'>
      call io_int_fetch_data(iunit, r, 'HASYS', &amp;<a name='1730'>
                         grid%hasys(its:imax, jts:jmax), &amp;<a name='1731'>
                         ierr)<a name='1732'>
<a name='1733'>
      call io_int_fetch_data(iunit, r, 'HASYW', &amp;<a name='1734'>
                         grid%hasyw(its:imax, jts:jmax), &amp;<a name='1735'>
                         ierr)<a name='1736'>
<a name='1737'>
      call io_int_fetch_data(iunit, r, 'HSTDV', &amp;<a name='1738'>
                         grid%hstdv(its:imax, jts:jmax), &amp;<a name='1739'>
                         ierr)<a name='1740'>
<a name='1741'>
      call io_int_fetch_data(iunit, r, 'HCNVX', &amp;<a name='1742'>
                         grid%hcnvx(its:imax, jts:jmax), &amp;<a name='1743'>
                         ierr)<a name='1744'>
<a name='1745'>
      call io_int_fetch_data(iunit, r, 'LU_INDEX', &amp;<a name='1746'>
                         grid%lu_index(its:imax, jts:jmax), &amp;<a name='1747'>
                         ierr)<a name='1748'>
<a name='1749'>
      call io_int_fetch_data(iunit, r, 'LANDUSEF', &amp;<a name='1750'>
                         grid%landusef_gc(its:imax, jts:jmax, kts:num_veg_cat),&amp;<a name='1751'>
                         ierr)<a name='1752'>
<a name='1753'>
      call io_int_fetch_data(iunit, r, 'LANDMASK', &amp;<a name='1754'>
                         grid%landmask(its:imax, jts:jmax), &amp;<a name='1755'>
                         ierr)<a name='1756'>
<a name='1757'>
      call io_int_fetch_data(iunit, r, 'XLONG_V', &amp;<a name='1758'>
                         grid%vlon_gc(its:imax, jts:jmax), &amp;<a name='1759'>
                         ierr)<a name='1760'>
<a name='1761'>
      call io_int_fetch_data(iunit, r, 'XLAT_V', &amp;<a name='1762'>
                         grid%vlat_gc(its:imax, jts:jmax), &amp;<a name='1763'>
                         ierr)<a name='1764'>
<a name='1765'>
      call io_int_fetch_data(iunit, r, 'XLONG_M', &amp;<a name='1766'>
                         grid%hlon_gc(its:imax, jts:jmax), &amp;<a name='1767'>
                         ierr)<a name='1768'>
<a name='1769'>
      call io_int_fetch_data(iunit, r, 'XLAT_M', &amp;<a name='1770'>
                         grid%hlat_gc(its:imax, jts:jmax), &amp;<a name='1771'>
                         ierr)<a name='1772'>
<a name='1773'>
<font color=#447700>! These variables are NOT in the WPS file....<a name='1774'></font>
<font color=#447700>!      call io_int_fetch_data(iunit, r, 'VEGCAT', &amp;<a name='1775'></font>
<font color=#447700>!                         grid%vegcat(its:imax, jts:jmax), &amp;<a name='1776'></font>
<font color=#447700>!                         ierr)<a name='1777'></font>
<font color=#447700>!<a name='1778'></font>
<font color=#447700>!      call io_int_fetch_data(iunit, r, 'SOIL_CAT', &amp;<a name='1779'></font>
<font color=#447700>!                         grid%input_soil_cat(its:imax, jts:jmax), &amp;<a name='1780'></font>
<font color=#447700>!                         ierr)<a name='1781'></font>
<font color=#447700>!<a name='1782'></font>
<font color=#447700>!      call io_int_fetch_data(iunit, r, 'CANWAT', &amp;<a name='1783'></font>
<font color=#447700>!                         grid%canwat(its:imax, jts:jmax), &amp;<a name='1784'></font>
<font color=#447700>!                         ierr)<a name='1785'></font>
<font color=#447700>!      call io_int_fetch_data(iunit, r, 'SOILCAT', &amp;<a name='1786'></font>
<font color=#447700>!                         grid%soilcat(its:imax, jts:jmax), &amp;<a name='1787'></font>
<font color=#447700>!                         ierr)<a name='1788'></font>
<a name='1789'>
#if defined(DM_PARALLEL) &amp;&amp; <font color=#447700>!defined(STUBMPI)<a name='1790'></font>
      call mpi_file_close(iunit, ierr)<a name='1791'>
#else<a name='1792'>
      close(iunit)<a name='1793'>
#endif<a name='1794'>
<a name='1795'>
       varName='ST000010'<a name='1796'>
       flag_st000010 = 1<a name='1797'>
       num_st_levels_input = num_st_levels_input + 1<a name='1798'>
       st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_19">(varName(3:8))<a name='1799'>
       DO J=JTS,min(JTE,JDE-1)<a name='1800'>
        DO I=ITS,min(ITE,IDE-1)<a name='1801'>
           st_inputx(I,J,num_st_levels_input + 1) = grid%st000010(i,j)<a name='1802'>
        ENDDO<a name='1803'>
       ENDDO<a name='1804'>
<a name='1805'>
       varName='ST010040'<a name='1806'>
       flag_st010040 = 1<a name='1807'>
       num_st_levels_input = num_st_levels_input + 1<a name='1808'>
       st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_20">(varName(3:8))<a name='1809'>
       DO J=JTS,min(JTE,JDE-1)<a name='1810'>
        DO I=ITS,min(ITE,IDE-1)<a name='1811'>
            st_inputx(I,J,num_st_levels_input + 1) = grid%st010040(i,j)<a name='1812'>
        ENDDO<a name='1813'>
       ENDDO<a name='1814'>
<a name='1815'>
       varName='ST040100'<a name='1816'>
       flag_st040100 = 1<a name='1817'>
       num_st_levels_input = num_st_levels_input + 1<a name='1818'>
       st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_21">(varName(3:8))<a name='1819'>
       DO J=JTS,min(JTE,JDE-1)<a name='1820'>
        DO I=ITS,min(ITE,IDE-1)<a name='1821'>
              st_inputx(I,J,num_st_levels_input + 1) = grid%st040100(i,j)<a name='1822'>
        ENDDO<a name='1823'>
       ENDDO<a name='1824'>
<a name='1825'>
       varName='ST100200'<a name='1826'>
       flag_st100200 = 1<a name='1827'>
       num_st_levels_input = num_st_levels_input + 1<a name='1828'>
       st_levels_input(num_st_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_22">(varName(3:8))<a name='1829'>
       DO J=JTS,min(JTE,JDE-1)<a name='1830'>
        DO I=ITS,min(ITE,IDE-1)<a name='1831'>
              st_inputx(I,J,num_st_levels_input + 1) = grid%st100200(i,j)<a name='1832'>
        ENDDO<a name='1833'>
       ENDDO<a name='1834'>
<a name='1835'>
       varName='SM000010'<a name='1836'>
       flag_sm000010 = 1<a name='1837'>
       num_sm_levels_input = num_sm_levels_input + 1<a name='1838'>
       sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_23">(varName(3:8))<a name='1839'>
       DO J=JTS,min(JTE,JDE-1)<a name='1840'>
        DO I=ITS,min(ITE,IDE-1)<a name='1841'>
           sm_inputx(I,J,num_sm_levels_input + 1) = grid%sm000010(i,j)<a name='1842'>
        ENDDO<a name='1843'>
       ENDDO<a name='1844'>
<a name='1845'>
       varName='SM010040'<a name='1846'>
       flag_sm010040 = 1<a name='1847'>
       num_sm_levels_input = num_sm_levels_input + 1<a name='1848'>
       sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_24">(varName(3:8))<a name='1849'>
       DO J=JTS,min(JTE,JDE-1)<a name='1850'>
        DO I=ITS,min(ITE,IDE-1)<a name='1851'>
            sm_inputx(I,J,num_sm_levels_input + 1) = grid%sm010040(i,j)<a name='1852'>
        ENDDO<a name='1853'>
       ENDDO<a name='1854'>
<a name='1855'>
       varName='SM040100'<a name='1856'>
       flag_sm040100 = 1<a name='1857'>
       num_sm_levels_input = num_sm_levels_input + 1<a name='1858'>
       sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_25">(varName(3:8))<a name='1859'>
       DO J=JTS,min(JTE,JDE-1)<a name='1860'>
        DO I=ITS,min(ITE,IDE-1)<a name='1861'>
              sm_inputx(I,J,num_sm_levels_input + 1) = grid%sm040100(i,j)<a name='1862'>
        ENDDO<a name='1863'>
       ENDDO<a name='1864'>
<a name='1865'>
       varName='SM100200'<a name='1866'>
       flag_sm100200 = 1<a name='1867'>
       num_sm_levels_input = num_sm_levels_input + 1<a name='1868'>
       sm_levels_input(num_sm_levels_input) = <A href='../../html_code/share/module_optional_input.F.html#CHAR2INT2'>char2int2</A><A href='../../html_code/dyn_nmm/module_si_io_nmm.F.html#READ_WPS' TARGET='bottom_target'><IMG SRC="../../gif/cyan.gif" border=0></a><A NAME="CHAR2INT2_26">(varName(3:8))<a name='1869'>
       DO J=JTS,min(JTE,JDE-1)<a name='1870'>
        DO I=ITS,min(ITE,IDE-1)<a name='1871'>
              sm_inputx(I,J,num_sm_levels_input + 1) = grid%sm100200(i,j)<a name='1872'>
        ENDDO<a name='1873'>
       ENDDO<a name='1874'>
<a name='1875'>
       flag_sst  = 1<a name='1876'>
       sw_inputx = 0.<a name='1877'>
       sw_input  = 0.<a name='1878'>
<a name='1879'>
<a name='1880'>
        do J=JTS,min(JDE-1,JTE)<a name='1881'>
         do K=1,num_st_levels_alloc<a name='1882'>
          do I=ITS,min(IDE-1,ITE)<a name='1883'>
             st_input(I,K,J)=st_inputx(I,J,K)<a name='1884'>
             sm_input(I,K,J)=sm_inputx(I,J,K)<a name='1885'>
             sw_input(I,K,J)=sw_inputx(I,J,K)<a name='1886'>
          enddo<a name='1887'>
         enddo<a name='1888'>
        enddo<a name='1889'>
<a name='1890'>
     end subroutine read_wps<a name='1891'>
#endif<a name='1892'>
<a name='1893'>
END MODULE module_si_io_nmm<a name='1894'>
</pre></body></html>